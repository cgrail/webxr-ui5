/*!
 * SAPUI5

(c) Copyright 2009-2019 SAP SE. All rights reserved
 */
sap.ui.define(['./ShapeMarker','sap/ui/core/Control','sap/ui/layout/form/SimpleForm','sap/ui/layout/Grid','sap/m/Text','sap/m/ObjectNumber','sap/m/Label','sap/ui/core/TextAlign','../common/utils/ContentUtil','../common/utils/SelectionDetailUtil'],function(S,C,a,G,T,O,L,b,c,d){"use strict";var e=C.extend('sap.viz.ui5.controls.chartpopover.ContentPanel',{metadata:{properties:{'showLine':'boolean'},publicMethods:["setContentData"]},renderer:{render:function(r,o){r.write('<div');r.addClass("viz-controls-chartPopover-contentPanel");r.writeClasses();r.writeControlData(o);r.writeAttribute("aria-labelledby",o._oDimLabel.getId()+" "+o._oForm.getId());r.writeAttribute('tabindex',-1);r.write('>');r.renderControl(o._oShapeLabel);r.renderControl(o._oPanel);r.write('</div>');}}});e.prototype.init=function(){this._measureItemsLen=0;this._maxMeasureLableLen=15;this._maxMeasureValueLen=12;this._oShapeLabel=new S(this._createId('vizShapeMarker'),{}).addStyleClass('viz-controls-chartPopover-dimension-marker');this._oDimLabel=new T(this._createId('vizDimensionLabel'),{}).addStyleClass('viz-controls-chartPopover-dimension-label');this._oForm=new a({editable:false,maxContainerCols:2,layout:"ResponsiveGridLayout",labelSpanL:6,labelSpanM:6,labelSpanS:6,emptySpanL:0,emptySpanM:0,emptySpanS:0,columnsL:2,columnsM:2,content:[]});this._oPanel=new G({width:'100%',defaultSpan:"L12 M12 S12",content:[this._oDimLabel,this._oForm]}).addStyleClass('viz-controls-chartPopover-Vlt');};e.prototype.setContentData=function(f){this._measureItemsLen=0;var v=f.val,g='';if(v){this._oForm.removeAllContent();var h=false;var r=c.setContent("popover",f);var j=r.items;g=r.dims;h=r.isLongMode;for(var i=0;i<j.length;i++){this._renderLabels(h,j[i],f.isTimeSeries);}var k=function(f){var l=false;if(f.selectByTimeAxisGroup&&f.val){var n=0;for(var i=0;i<f.val.length;i++){if(f.val[i].type==='Measure'){n++;}}if(n>1){l=true;}}return l;};if(!k(f)&&typeof f.color==='string'){var m=this._oDimLabel.$().css('margin-left');if(m){m=parseInt(m.substr(0,m.length-2));this._oShapeLabel.setMarkerSize(m);}this._oShapeLabel.setColor(f.color).setType((f.shape?f.shape:'square'));if(this.getShowLine()){this._oShapeLabel.setShowWithLine(f.type).setLineInfo(f.lineInfo);}else{this._oShapeLabel.setShowWithLine(undefined);}if(f.stroke&&f.stroke.visible){this._oShapeLabel.setStroke(f.stroke);}}else{this._oShapeLabel.setType(null);this._oShapeLabel.setShowWithLine(undefined);}if(f.pattern){this._oShapeLabel.setPattern(f.pattern);}else{this._oShapeLabel.setPattern(null);}if(g&&g.length>0){this._oDimLabel.setVisible(true);this._oDimLabel.setText(g);}else{this._oDimLabel.setVisible(false);}this._measureItemsLen=f.val.length;if(this._oShapeLabel._isShowWithLine()){this._oForm.addStyleClass('viz-controls-chartPopover-measure-simpleForm');}else{this._oForm.removeStyleClass('viz-controls-chartPopover-measure-simpleForm');}if(!this._oDimLabel.getVisible()){this._oForm.addStyleClass('viz-controls-chartPopover-measure-simpleForm-withoutDimensionLabel');}else{this._oForm.removeStyleClass('viz-controls-chartPopover-measure-simpleForm-withoutDimensionLabel');}}};e.prototype._renderLabels=function(i,f,g){var v;if(i){this._oForm.setLabelSpanS(12);if(f.name!==''){this._oForm.addContent(new T({text:f.name}).addStyleClass('viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-labels-wrapper-name'));}v=new O({number:f.value,unit:f.unit,textAlign:b.Begin}).addStyleClass('viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-labels-wrapper-value');this._oForm.addContent(v);if(g&&(f.name==='')){v.addStyleClass('viz-controls-chartPopover-timeDayDimValue');}}else{this._oForm.setLabelSpanS(6);this._oForm.addContent(new L({text:f.name}).addStyleClass('viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-name'));if(f.value!==null){v=new O({number:f.value,unit:f.unit,textAlign:b.End}).addStyleClass('viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-value');}else{v=new O({number:this._getNoValueLabel(),textAlign:b.End}).addStyleClass('viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-value');}if(g&&(f.name==='')){v.addStyleClass('viz-controls-chartPopover-timeDayValue');}this._oForm.addContent(v);}};e.prototype.isMultiSelected=function(){return this._measureItemsLen===0;};e.prototype._createId=function(i){return this.getId()+"-"+i;};e.prototype._getNoValueLabel=function(){return sap.viz.extapi.env.Language.getResourceString("IDS_ISNOVALUE");};e.prototype.exit=function(i){if(this._oForm){this._oForm.destroy();this._oForm=null;}if(this._oShapeLabel){this._oShapeLabel.destroy();this._oShapeLabel=null;}if(this._oDimLabel){this._oDimLabel.destroy();this._oDimLabel=null;}if(this._oPanel){this._oPanel.destroy();this._oPanel=null;}};return e;});
