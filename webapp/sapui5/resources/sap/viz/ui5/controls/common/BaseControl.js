/*!
 * SAPUI5

(c) Copyright 2009-2019 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/core/Control','sap/viz/library',"sap/ui/thirdparty/jquery"],function(C,l,q){"use strict";var B=C.extend("sap.viz.ui5.controls.common.BaseControl",{metadata:{library:"sap.viz",properties:{uiConfig:{type:"object",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:'640px'},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:'480px'}}}});B.prototype.init=function(){this._app$=null;this._controls={};this._handlers={'resize':null};this._locale=null;this._pendingRerendering=false;this._resourceLoaded=false;sap.viz._initializeVIZControls(this instanceof sap.viz.ui5.VizContainer,q.proxy(function(s){this._resourceLoaded=s;this.invalidate();setTimeout(function(){if(!this.getUIArea()){this._render();}}.bind(this),0);},this));};B.prototype.exit=function(){this._app$=null;this._deregister();for(var k in this._controls){this._controls[k].destroy();}};B.prototype.onBeforeRendering=function(){this._deregister();};B.prototype.onAfterRendering=function(){this._render();};B.prototype.onThemeChanged=function(){if(this.getDomRef()){this.invalidate();if(!this._pendingRerendering){this._render();}}};B.prototype.onLocalizationChanged=function(){if(this._locale!==sap.ui.getCore().getConfiguration().getLocale()){this._render();}};B.prototype._render=function(){if(this._resourceLoaded&&this.getDomRef()){this._pendingRerendering=false;this._locale=sap.ui.getCore().getConfiguration().getLocale();if(!this._app$){this._app$=q(document.createElement('div')).appendTo(this.getDomRef()).addClass('ui5-viz-controls-app');q(this._app$).attr("data-sap-ui-preserve",true);this._validateSize();this._createChildren();}else{this._app$.appendTo(this.getDomRef());this._validateSize();this._updateChildren();}this._register();}};B.prototype._createChildren=function(){};B.prototype._updateChildren=function(){};B.prototype._deregister=function(){if(this._handlers.resize){sap.ui.core.ResizeHandler.deregister(this._handlers.resize);}this._handlers.resize=null;};B.prototype._register=function(){this._deregister();this._handlers.resize=sap.ui.core.ResizeHandler.register(this.getDomRef(),q.proxy(this._validateSize,this));};B.prototype._validateSize=function(){};B.prototype.invalidate=function(){C.prototype.invalidate.apply(this,arguments);if(this.getUIArea()){this._pendingRerendering=true;}};return B;});
