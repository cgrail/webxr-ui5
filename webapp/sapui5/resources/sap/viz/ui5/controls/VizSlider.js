/*!
 * SAPUI5

(c) Copyright 2009-2019 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/core/Control','./VizFrame','./VizRangeSlider','./common/utils/Constants','sap/ui/Device',"sap/ui/thirdparty/jquery"],function(B,V,a,C,D,q){"use strict";var b={plotArea:{dataLabel:{visible:false}},legend:{visible:false},categoryAxis:{visible:false},valueAxis:{title:{visible:false}},title:{visible:false},interaction:{noninteractiveMode:true},timeAxis:{visible:false}};var c=B.extend("sap.viz.ui5.controls.VizSlider",{metadata:{library:"sap.viz",properties:{vizType:{type:"string",group:"Misc",defaultValue:"column"},uiConfig:{type:"object",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:'800px'},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:'200px'},valueAxisVisible:{type:"boolean",group:"Misc",defaultValue:true},showPercentageLabel:{type:"boolean",group:"Appearance",defaultValue:true},showStartEndLabel:{type:"boolean",group:"Appearance",defaultValue:true}},aggregations:{_vizFrame:{type:"sap.viz.ui5.controls.VizFrame",multiple:false,visibility:"hidden"},_rangeSlider:{type:"sap.viz.ui5.controls.VizRangeSlider",multiple:false,visibility:"hidden"},dataset:{type:"sap.viz.ui5.data.Dataset",multiple:false},feeds:{type:"sap.viz.ui5.controls.common.feeds.FeedItem",multiple:true,singularName:"feed"}},events:{rangeChanged:{}}}});c.prototype.applySettings=function(){B.prototype.applySettings.apply(this,arguments);var v=new V({width:this.getWidth(),height:this.getHeight(),vizType:this.getVizType(),uiConfig:this.getUiConfig(),});v.attachRenderComplete(u.bind(this));var r=new a({visible:false,showAdvancedTooltip:false,showHandleTooltip:false});r.setParentFrame(v);this.setAggregation("_vizFrame",v);this.setAggregation("_rangeSlider",r);r.attachChange(p.bind(this));};var S=["info/column","info/line","info/timeseries_line","info/timeseries_column"];c.prototype.setVizType=function(v){if(v.indexOf("info/")!==0){v="info/"+v;}if(S.indexOf(v)===-1){v="info/null";}this.setProperty('vizType',v);return this;};c.prototype.getDataset=function(d){var v=this._getVizFrame();return(v&&v.getDataset())||this.getAggregation("dataset");};c.prototype.addFeed=function(f){var v=this._getVizFrame();if(v){v.addFeed(f);}else{this.addAggregation("feeds",f);}return this;};c.prototype.removeFeed=function(f){var v=this._getVizFrame();if(v){v.removeFeed(f);}else{this.removeAggregation("feeds",f);}return this;};c.prototype.removeAllFeeds=function(){var v=this._getVizFrame();if(v){v.removeAllFeeds();}else{this.removeAllAggregation("feeds");}return this;};c.prototype.getFeeds=function(){var v=this._getVizFrame();return(v&&v.getFeeds())||this.getAggregation("feeds");};c.prototype.exit=function(){var v=this._getVizFrame();v&&v.detachRenderComplete(u.bind(this),this);var r=this.getAggregation("_rangeSlider");r&&r.detachChange(p.bind(this));};c.prototype._getVizFrame=function(){return this.getAggregation("_vizFrame");};c.prototype._getRangeSlider=function(){return this.getAggregation("_rangeSlider");};c.prototype.onAfterRendering=function(){var v=this._getVizFrame();var d={valueAxis:{visible:this.getProperty("valueAxisVisible")}};d=q.extend(true,{},d,b);v.setVizProperties(d);v.setUiConfig(this.getProperty("uiConfig"));v.setVizType(this.getProperty("vizType"));v.setHeight(this.getProperty("height"));v.setWidth(this.getProperty("width"));var e=this.getAggregation("dataset");if(e){this.removeAggregation("dataset");v.setDataset(e);}var f=this.getAggregation("feeds");if(f){this.removeAllAggregation("feeds");v.removeAllFeeds();for(var i=0;i<f.length;++i){v.addFeed(f[i]);}}var r=this._getRangeSlider();r.setShowStartEndLabel(this.getProperty("showStartEndLabel"));r.setShowPercentageLabel(this.getProperty("showPercentageLabel"));};function u(){var s=this._getVizFrame()._states().plot.sizeInfo;this._curRange=[];var r=this._getRangeSlider();if(s){r.setWidth(s.width+"px");r.setHeight(s.height+"px");r.setLeft(s.x+"px");r.setTop(s.y+"px");r.setVisible(true);r.invalidate();}else{r.setVisible(false);}var v=this._getVizFrame();v._setTitleAria("A noninteractive "+v._getMetadata().name+" with Range Slider ");}function p(e,d){var r=e.getParameters().range;if(this._curRange[0]===r[0]&&this._curRange[1]===r[1]){return;}else{var v=this._getVizFrame();var f=v._getDataRange(r[0],r[1]);this._curRange[0]=r[0];this._curRange[1]=r[1];delete(f.displayValues);this.fireEvent("rangeChanged",{data:f});}}return c;});
