/* SAP CVOM 4.0 Â© <2012-2014> SAP AG. All rights reserved. Build Version PI_bycheckin.1630 */
(function(){var u=sap.viz.moduleloader.define;var A=sap.viz.moduleloader.require.config({context:'vizcontainer'});var B=A;u("jquery",function(){return jQuery;});u('sap/viz/controls/Version',[],function(){var V={};V.VERSION='PI_bycheckin.1630';return V;});u('sap/viz/controls/common/config/GlobalConfig',[],function(){function f(n,s){if(n.length===0)return;if(n.length===1)return s[n[0]];var p=n.shift();if(s[p]!=null)return f(n,s[p]);return;}var m=f("sap/viz/controls/common/config/GlobalConfig".split("/"),this);if(m)return m;var G={};G.DEFAULT_UICONFIG_TYPE_BUILDER='uiconfig-builder';G.DEFAULT_UICONFIG_TYPE_CHART='uiconfig-chart';G.DEFAULT_UICONFIG_TYPE_FEEDING='uiconfig-feeding';G.DEFAULT_UICONFIG_TYPE_FRAME='uiconfig-frame';G.DEFAULT_UICONFIG_TYPE_SWITCHBAR='uiconfig-switchbar';G.DEFAULT_UICONFIG_TYPE_FILTERBAR0='uiconfig-filterbar0';G.DEFAULT_UICONFIG_TYPE_FILTERBAR='uiconfig-filterbar';G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU='uiconfig-contextmenu';G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON='uiconfig-custombutton';G.DEFAULT_UICONFIG_TYPE_ANNOTATION='uiconfig-annotation';G.DEFAULT_UICONFIG_TYPE_ANNOTATIONCONTROL='uiconfig-annotationcontrol';G.DEFAULT_UICONFIG_TYPE_MAPBUILDER='uiconfig-mapbuilder';G.DEFAULT_UICONFIG_TYPE_PROPERTYEDITOR='uiconfig-propertyeditor';var _="../src";var a=false;var b={};var d=function(){if(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getServiceMetadata!==undefined){var s;try{s=sap.bi.framework.getServiceMetadata("sap.viz.controls.common.config");}catch(e){}if(s&&s.customProperties.defaultAssetsRoot){return s.framework.bundleUrl+"/"+s.customProperties.defaultAssetsRoot;}}return undefined;};G.registerUIConfig=function(c,e){if(c!=null){b[c]=e;}};G.defaultUIConfig=function(t){var c={};if(t!=null&&b[t]!=null&&b[t].instance){return b[t].instance();}for(var i in b){if(i&&b[i]&&b[i].instance){c[i]=b[i].instance();}}return c;};G.defaultAssetsRoot=function(p){if(arguments.length>0){_=p;a=true;G._setResourcePath();}else{if(a){return _;}var c=d();if(c){return c;}return _;}};G._setResourcePath=function(){var p=[G.defaultAssetsRoot()+"/locale/"];var c=sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths");var n=c?p.concat(c):p;sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths",n);};return G;});u('sap/viz/controls/common/constants/ChartConst',[],function(){var C={};C.TYPE_COLUMN="viz/column";C.TYPE_STACKED_COLUMN="viz/stacked_column";C.TYPE_DUAL_COLUMN="viz/dual_column";C.TYPE_3D_COLUMN="viz/3d_column";C.TYPE_LINE="viz/line";C.TYPE_AREA="viz/area";C.TYPE_COMBINATION="viz/combination";C.TYPE_DUAL_LINE="viz/dual_line";C.TYPE_DUAL_COMBINATION="viz/dual_combination";C.TYPE_PIE="viz/pie";C.TYPE_DONUT="viz/donut";C.TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";C.TYPE_GEO_BUBBLE="viz/geobubble";C.TYPE_GEO_CHOROPLETH="viz/choropleth";C.TYPE_GEO_PIE="viz/geopie";C.TYPE_GEO_MAP='viz/geomap';C.TYPE_SCATTER="viz/scatter";C.TYPE_BUBBLE="viz/bubble";C.TYPE_SCATTER_MATRIX="viz/scatter_matrix";C.TYPE_HEATMAP="viz/heatmap";C.TYPE_TREEMAP="viz/treemap";C.TYPE_TABLE="viz/ext/table";C.TYPE_CROSSTAB="viz/ext/crosstab";C.TYPE_RADAR="viz/radar";C.TYPE_BOXPLOT="viz/boxplot";C.TYPE_WATERFALL="viz/waterfall";C.TYPE_TAG_CLOUD="viz/tagcloud";C.TYPE_TREE="viz/tree";C.TYPE_NETWORK="viz/network";C.TYPE_FUNNEL='viz/ext/pa/funnel';C.TYPE_PC='viz/ext/pa/pc';C.TYPE_NUMBER='viz/number';C.DIRECTION_HORIZONTAL="horizontal";C.DIRECTION_VERTICAL="vertical";C.STACKING_FULL="full";C.STACKING_NORMAL="normal";C.TYPE_BAR="viz/bar";C.TYPE_STACKED_BAR="viz/stacked_bar";C.TYPE_100_STACKED_COLUMN="viz/100_stacked_column";C.TYPE_100_STACKED_BAR="viz/100_stacked_bar";C.TYPE_DUAL_BAR="viz/dual_bar";C.TYPE_3D_BAR="viz/3d_bar";C.TYPE_HORIZONTAL_LINE="viz/horizontal_line";C.TYPE_HORIZONTAL_AREA="viz/horizontal_area";C.TYPE_100_AREA="viz/100_area";C.TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";C.TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";C.TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";C.TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";C.TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";C.TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";C.FEEDING_PRIMARY_VALUES="primaryValues";C.FEEDING_SECONDARY_VALUES="secondaryValues";C.FEEDING_AXIS_LABELS="axisLabels";C.MEASURE_NAMES_DIMENSION="measureNamesDimension";C.MEASURE_VALUES_GROUP="measureValuesGroup";C.ANALYSIS_AXIS="analysisAxis";C.AXIS_XAXIS="xAxis";C.AXIS_XAXIS1="xAxis1";C.AXIS_XAXIS2="xAxis2";C.AXIS_YAXIS="yAxis";C.AXIS_YAXIS1="yAxis1";C.AXIS_YAXIS2="yAxis2";return C;});u('sap/viz/controls/common/constants/CSSConst',[],function(){var C={};C.PREFIX="viz-controls-";C.COMMON_PREFIX=C.PREFIX+"common-";C.SWITCHBAR_PREFIX=C.PREFIX+"switchbar-";C.FEEDINGPANEL_PREFIX=C.PREFIX+"feeding-";C.PROPERTYEDITOR_PREFIX=C.PREFIX+"propertyeditor-";C.VIZDATAPICKER_PREFIX=C.PREFIX+"datapicker-";C.FRAME_PREFIX=C.PREFIX+"frame-";C.BUILDER_PREFIX=C.PREFIX+"builder-";C.TRELLIS_PREFIX=C.PREFIX+"trellis-";C.MAPBUILDER_PREFIX=C.PREFIX+"mapbuilder-";C.CHART_PREFIX=C.PREFIX+"chart-";C.FILTERBAR0_PREFIX=C.PREFIX+"filterbar0-";C.FILTERBAR_PREFIX=C.PREFIX+"filterbar-";C.CONTEXTMENU_PREFIX=C.PREFIX+"contextmenu-";C.CUSTOMBUTTON_PREFIX=C.PREFIX+"custombutton-";C.ANNOTATION_PREFIX=C.PREFIX+"annotation-";C.PLAYCTRL_PREFIX=C.PREFIX+"playcontrol-";C.FEEDINGSHELF_PREFIX=C.COMMON_PREFIX+"feeding-";return C;});u('sap/viz/controls/common/utils/Utils',[],function(){var c={};var _=0;c.genUID=function(){if(!_){_=0;}return"vcgen_"+(_++);};var d={'[object Boolean]':'boolean','[object Number]':'number','[object String]':'string','[object Function]':'function','[object Array]':'array','[object Date]':'date','[object RegExp]':'regexp','[object Object]':'object'};c.encodingToken="_encoded_";c.applyObjectProperty=function(o,p,a){try{if(c.isFunction(o[p])){o[p](a);}else{o[p]=a;}}catch(e){}};c.applyProperties=function(a,p){if(p){var l=p.length;for(var i=0;i<l;i++){var b=p[i];if(b){c.applyObjectProperty(a,b.name,b.value);}}}};c.getObjectProperty=function(o,p){try{if(c.isFunction(o[p])){return o[p]();}else if(o.hasOwnProperty(p)){return o[p];}}catch(e){}};c.type=function(o){return o==null?String(o):d[Object.prototype.toString.call(o)]||"object";};c.isFunction=function(o){return c.type(o)==="function";};c.isBoolean=function(o){return c.type(o)==="boolean";};c.isString=function(o){return c.type(o)==="string";};c.isArray=function(o){return c.type(o)==="array";};c.isNumber=function(o){return c.type(o)==="number";};c.isRegExp=function(o){return c.type(o)==="regexp";};c.sortArrayOn=function(e,p,f){if(c.isArray(e)&&c.isString(p)){e.sort(function(a,b){return f?(a[p]<b[p])-(a[p]>b[p]):(a[p]>b[p])-(a[p]<b[p]);});}};c.noop=function(){};c.delay=function(h,w){return setTimeout(function(){return h.apply(null);},w);};c.defer=function(h){return c.delay.call(null,h,1);};c.getEventPosition=function(e){var p=null;var a=null;if(e.originalEvent&&e.originalEvent.targetTouches&&e.originalEvent.targetTouches.length!==0){p=e.originalEvent.targetTouches[0].pageX;a=e.originalEvent.targetTouches[0].pageY;}else{p=e.pageX;a=e.pageY;}var b={};b.pageX=p;b.pageY=a;return b;};c.clone=function(a){if(a===null||typeof(a)!=='object'){return a;}var o=a.constructor===Array?[]:{};for(var i in a){if(a.hasOwnProperty(i)){o[i]=arguments.callee.call(null,a[i]);}}return o;};c.toJSON=function(a,p){if(c.isArray(a)){var r=[];for(var i=0;i<a.length;i++){r.push(p.call(null,a[i]));}return r;}else if(a){return p.call(null,a);}else{return null;}};c.fromJSON=function(a,p){if(c.isArray(a)){var r=[];for(var i=0;i<a.length;i++){r.push(p.call(null,a[i]));}return r;}else if(a){return p.call(null,a);}else{return undefined;}};c.updateJSON=function(s,n){var r=c.clone(s);r=r||{};var a=function(b,e){for(var p in e){if(e.hasOwnProperty(p)){var f=e[p];if(f!==undefined){if(typeof(f)!=="object"||f instanceof(Array)||f===null){b[p]=f;}else{var h=b[p];if(!h){if(f===null||f===undefined){h=f;}else{h=b[p]={};}}a(h,f);}}}}};a(r,n);return r;};c.substitute=function(s,r){if(!s)return'';for(var i=1;i<arguments.length;i++){s=s.replace(new RegExp("\\{"+(i-1)+"\\}","g"),arguments[i]);}return s;};c.invert=function(o){var r={};for(var k in o){var v=o[k];r[v]=k;}return r;};c.encode=function(a,s){if(a.indexOf(c.encodingToken)>-1){return a;}else{var e=a+c.encodingToken+s;return e;}};c.decode=function(a){var r=a.split(c.encodingToken);return r;};c.deepEqual=function(s,t){if(typeof s==='object'&&typeof t==='object'&&c.isExist(s)&&c.isExist(t)){var k=null;for(k in s){if(s.hasOwnProperty(k)){if(!t.hasOwnProperty(k)){return false;}else if(!c.deepEqual(s[k],t[k])){return false;}}}for(k in t){if(t.hasOwnProperty(k)){if(!s.hasOwnProperty(k)){return false;}}}return true;}else{return s===t;}};c.hasCommonKeyValue=function(s,t){if(typeof s==='object'&&typeof t==='object'){var k=null;for(k in s){if(s.hasOwnProperty(k)){if(t.hasOwnProperty(k)&&c.deepEqual(s[k],t[k])){return true;}}}return false;}};c.isExist=function(o){if((typeof(o)==='undefined')||(o===null)){return false;}return true;};var g=c.genGetterSetter=function(n){return function(v){if(arguments.length>0){this[n]=v;return this;}else{return this[n];}};};c.genGetterSetters=function(p,n){n.forEach(function(e){p[e.substring(1)]=g(e);});};return c;});u('sap/viz/controls/common/managers/LangManager',[],function(){var L=function(){this.__className="sap.viz.controls.common.managers.LangManager";};L.get=function(n){return sap.viz.lang.langManager.get(n);};return L;});u('sap/viz/controls/common/feeds/AnalyticalType',[],function(){var a={};a.UNIVERSAL='universal';a.MEASURE='measure';a.DIMENSION='dimension';a.HIERARCHY='hierarchy';a.MND='mnd';a.compatible=function(h,c){if(h===a.UNIVERSAL){return true;}else if(h===a.DIMENSION){return c===a.DIMENSION||c===a.HIERARCHY||c===a.MND;}else{return h===c;}};return a;});u('sap/viz/controls/common/utils/JsonUtil',[],function(){var J={};J.AnalysisObjectType='sap.viz.controls.common.feeds.AnalysisObject';J.HierarchyLevelObjectType='sap.viz.controls.common.feeds.HierarchyLevelObject';J.MenuItemType='sap.viz.controls.common.views.menu.MenuItem';J.MenuGroupType='sap.viz.controls.common.views.menu.MenuGroup';J._FuncMap={};J.register=function(t,f,a){var o={fromFunc:f,toFunc:a};J._FuncMap[t]=o;};J.fromJSON=function(t,a){if(J._FuncMap[t]&&J._FuncMap[t].fromFunc){return J._FuncMap[t].fromFunc(a);}else{return null;}};J.toJSON=function(t,o){if(J._FuncMap[t]&&J._FuncMap[t].toFunc){return J._FuncMap[t].toFunc(o);}else{return{};}};return J;});u('sap/viz/controls/common/views/menu/MenuGroup',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(a,J){var M=function(m){this.__className="sap.viz.controls.common.views.menu.MenuGroup";this._menuItems=m;};M.prototype.menuItems=function(){return this._menuItems;};M.prototype.selectedItem=function(){for(var i=0;i<this._menuItems.length;i++){if(this._menuItems[i].selected()){return this._menuItems[i];}}return null;};M.prototype.equal=function(m){if(m==undefined){return false;}var b=this.menuItems()||[];var c=m.menuItems()||[];if(b.length!==c.length){return false;}for(var i=0;i<b.length;i++){var d=b[i];var e=c[i];if(!(d==undefined&&e==undefined)){if(d==undefined){return false;}if(!d.equal(e)){return false;}}}return true;};M.toJSON=function(b){return a.toJSON(b,function(b){return{'menuItems':J.toJSON(J.MenuItemType,b._menuItems)};});};M.fromJSON=function(b){return a.fromJSON(b,function(b){return new M(J.fromJSON(J.MenuItemType,b.menuItems));});};J.register(J.MenuGroupType,M.fromJSON,M.toJSON);return M;});u('sap/viz/controls/common/feeds/HierarchyLevelObject',['require','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(r,a,J){var A=r||A;var H=function(b,n,c){this.__className="sap.viz.controls.common.feeds.HierarchyLevelObject";this._id=b;this._name=n;this._analysis=c;this._selected=false;};H.prototype.id=function(){return this._id;};H.prototype.name=function(v){if(arguments.length>0){this._name=v;return this;}else{return this._name;}};H.prototype.analysis=function(){return this._analysis;};H.prototype.selected=function(v){if(arguments.length>0){this._selected=v;return this;}else{return this._selected;}};H.prototype.clone=function(){var b=null;if(this._analysis){b=this._analysis.clone();}var c=new H(this._id,this._name,b);c.selected(this._selected);return c;};H.toJSON=function(b){return a.toJSON(b,function(b){return{'id':b._id,'name':b._name,'analysis':J.toJSON(J.AnalysisObjectType,b._analysis),'selected':b._selected};});};H.fromJSON=function(b){return a.fromJSON(b,function(b){var c=new H(b.id,b.name,J.fromJSON(J.AnalysisObjectType,b.analysis));c.selected(b.selected);return c;});};J.register(J.HierarchyLevelObjectType,H.fromJSON,H.toJSON);return H;});u('sap/viz/controls/common/feeds/AnalysisObject',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/utils/JsonUtil','sap/viz/controls/common/feeds/HierarchyLevelObject'],function(a,L,b,M,J){var c=function(d,n,t,e,f,g){this.__className="sap.viz.controls.common.feeds.AnalysisObject";this._id=d;this._name=n;this._type=t;this._dataType=e;this._aggregationType=f;this._aggregationTarget=g;this._actions=null;this._hierarchyLevels=null;};c.genMND=function(){return new c('mnd','',b.MND,'string');};a.genGetterSetters(c.prototype,["_id","_name","_actions","_aggregationType","_aggregationTarget","_hierarchyLevels"]);c.prototype.type=function(){return this._type;};c.prototype.dataType=function(){return this._dataType;};c.prototype.selectedHierarchyLevel=function(){if(!this._hierarchyLevels){return;}for(var i=0;i<this._hierarchyLevels.length;i++){if(this._hierarchyLevels[i].selected()){return this._hierarchyLevels[i];}}return;};c.prototype.selectedHierarchyLevelID=function(d){if(!this._hierarchyLevels){return this;}for(var i=0;i<this._hierarchyLevels.length;i++){var l=this._hierarchyLevels[i];l.selected(l.id()===d);}return this;};c.prototype.clone=function(){var d=c.fromJSON(c.toJSON(this));return d;};c.prototype.equal=function(d){if(this.type()===b.MND&&d.type()===b.MND){return true;}if(this.type()!==d.type()||this.name()!==d.name()){return false;}if(this.type()===b.HIERARCHY&&d.type()===b.HIERARCHY){if(this.selectedHierarchyLevel().id()!==d.selectedHierarchyLevel().id()){return false;}var l=this.hierarchyLevels();var e=d.hierarchyLevels();if(!l||!e||l.length!==e.length){return false;}for(var i=0;i<l.length;i++){var f=l[i];var g=e[i];if(f.id()!==g.id()){return false;}if(f.name()!==g.name()){return false;}}}if(this.actions()!=undefined||d.actions()!=undefined){var h=this.actions()||[];var k=d.actions()||[];if(h.length!==k.length){return false;}for(var i=0;i<h.length;i++){var m=h[i];var n=k[i];if(!(m==undefined&&n==undefined)){if(m==undefined){return false;}if(!m.equal(n)){return false;}}}}return true;};c.toJSON=function(d){return a.toJSON(d,function(d){return{'id':d._id,'name':d._name,'type':d._type,'dataType':d._dataType,'actions':M.toJSON(d._actions),'hierarchyLevels':J.toJSON(J.HierarchyLevelObjectType,d._hierarchyLevels),'aggregationType':d._aggregationType,'aggregationTarget':d._aggregationTarget};});};c.fromJSON=function(d){return a.fromJSON(d,function(d){var e=new c(d.id,d.name,d.type,d.dataType,d.aggregationType,d.aggregationTarget);if(d.actions){e.actions(M.fromJSON(d.actions));}if(d.hierarchyLevels){e.hierarchyLevels(J.fromJSON(J.HierarchyLevelObjectType,d.hierarchyLevels));}return e;});};J.register(J.AnalysisObjectType,c.fromJSON,c.toJSON);return c;});u('sap/viz/controls/common/feeds/FeedItem',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/AnalysisObject'],function(a,b){var F=function(c,t,v){this.__className="sap.viz.controls.common.feeds.FeedItem";this._id=c;this._type=t;this._values=v;};F.prototype.type=function(){return this._type;};F.prototype.id=function(){return this._id;};F.prototype.values=function(v){if(arguments.length>0){this._values=v;return this;}else{return this._values;}};F.prototype.hasValues=function(){return(this._values&&this._values.length>0);};F.prototype.clone=function(){return F.fromJSON(F.toJSON(this));};F.toJSON=function(c){return a.toJSON(c,function(c){return{'id':c._id,'type':c._type,'values':b.toJSON(c._values)};});};F.fromJSON=function(c){return a.fromJSON(c,function(c){return new F(c.id,c.type,b.fromJSON(c.values));});};return F;});u('sap/viz/controls/common/feeds/FeedItemType',[],function(){var F=function(){this.__className="sap.viz.controls.common.feeds.FeedItemType";};F.MEASURE='Measure';F.DIMENSION='Dimension';F.SUBTOTAL='Subtotal';F.GEOGRAPHY='Geography';F.ROWS='rows';F.ROW_SUBTOTALS='r_subtotals';F.COLUMNS='columns';F.COLUMNS_SUBTOTALS='c_subtotals';F.CALCULATION='calculation';F.LEVEL='level';F.HIERARCHY='hierarchy';return F;});u('sap/viz/controls/common/feeds/valueobjects/Shelf',[],function(){var S=function(){this.id=null;this.name=null;this.type=null;this.analysisType=null;this.feedItemType=null;this.capacity=0;};S.prototype.equals=function(s){if(null==s){return false;}if(this.id==s.id&&this.name==s.name&&this.type==s.type&&this.analysisType==s.analysisType&&this.feedItemType==s.feedItemType&&this.capacity==s.capacity){return true;}return false;};return S;});u('sap/viz/controls/common/feeds/valueobjects/ShelfType',[],function(){var S=function(){};S.MEASURE='measure';S.ATTRIBUTE='attribute';S.SUBTOTAL='subtotal';S.TRELLIS='trellis';return S;});u('sap/viz/controls/common/constants/DatasetTypeConst',[],function(){var D={};D.FlatTableDataset='FlatTableDataset';D.CrosstableDataset='CrosstableDataset';D.RawDataset='RawDataset';return D;});u('sap/viz/controls/common/utils/PropertyFilterUtil',[],function(){var P={};var F={"viz/bubble":["plotArea.maxBubbleHeight","plotArea.maxBubbleWidth","plotArea.maxPriValue","plotArea.maxSecValue","plotArea.minBubbleHeight","plotArea.minBubbleWidth","plotArea.minSecValue","plotArea.minPriValue"],"viz/geobubble":["plotArea.maxValue","plotArea.minValue"],"info/donut":["plotArea.highlight.highlightContext","plotArea.highlight.unhighlightSliceColor","plotArea.applyUnhighlightSliceColor","plotArea.dataLabel.renderer","plotArea.sliceRenderer","plotArea.highlight.contextInfos"],"info/bar":["valueAxis.layout.maxWidth","plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","categoryAxis.layout.maxWidth","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.markerRenderer"],"info/column":["valueAxis.layout.maxWidth","plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","categoryAxis.layout.maxWidth","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.markerRenderer"],"info/line":["valueAxis.layout.maxWidth","plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","categoryAxis.layout.maxWidth","plotArea.markerRenderer","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.lineRenderer"],"info/horizontal_line":["valueAxis.layout.maxWidth","plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","categoryAxis.layout.maxWidth","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.lineRenderer"]};P.addDefaultProperties=function(p,c){var f=F[c];if(f){f.forEach(function(a){P.addProperty(p,a);});}P.addProperty(p,"interaction.behaviorType");return p;};P.addProperty=function(p,a){if(!a){return p;}p=p||{};var t=p;var b=a.split(".");for(var i=0;i<b.length;i++){if(!t.hasOwnProperty(b[i])){t[b[i]]={};}t=t[b[i]];}return p;};return P;});u('sap/viz/controls/common/utils/VizUtils',['sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/utils/PropertyFilterUtil'],function(D,U,F,a,P){var V={};V.hasFakeData=function(d){var h=true;if(d){h=false;if(U.isFunction(d.hasFakeData)){h=d.hasFakeData();}else{h=d.isFake===true?true:false;}}return h;};V.getDatasetType=function(d){if(d){if(d instanceof sap.viz.api.data.CrosstableDataset){return D.CrosstableDataset;}else if(d instanceof sap.viz.api.data.FlatTableDataset){return D.FlatTableDataset;}else{return D.RawDataset;}}return D.CrosstableDataset;};V.isArrayOfFeedItem=function(o){return V._isArrayOf(o,F);};V.isArrayOfAnalysisObject=function(o){return V._isArrayOf(o,a);};V._isArrayOf=function(o,c){if(U.isArray(o)){for(var i=0;i<o.length;i++){if(!(o[i]instanceof c)){return false;}}return true;}return false;};V._parseProperties=function(p){var r={};for(var n in p){if(p.hasOwnProperty(n)&&p[n]){var c=p[n];var b=c.name||n;if(c.supportedValueType==="Object"){if(c.supportedValues){r[b]=V._parseProperties(c.supportedValues);}}else{r[b]=c.defaultValue;}}}return r;};V._convertProperties=function(b){var r={};for(var m in b){if(b.hasOwnProperty(m)){r[m]=V._parseProperties(b[m])}}return r;};V._getDefaultProperties=function(t){if(!t){return null;}var v=sap.viz.api.manifest.Viz.get(t)[0];if(!v){return null;}var p=v.allProperties();if(!p){return null;}return V._convertProperties(p);};V._propertyExist=function(p,b){if(!b){return false;}var c=b.split(".");var t=p;var r=false;for(var i=0;i<c.length;++i){if(t&&t.hasOwnProperty(c[i])){t=t[c[i]];r=true;}else{r=false;break;}}return r;};V.hasProperties=function(t,p){var r=[];if(!p||p.length==0){return r;}var d=V._getDefaultProperties(t);for(var i=0;i<p.length;++i){if(U.isArray(p[i])){r[i]=false;for(var n=0;n<p[i].length;++n){r[i]=r[i]||V._propertyExist(d,p[i][n]);}}else{r[i]=V._propertyExist(d,p[i]);}}return r;};V._removeProperty=function(p,b){if(!b){return null;}var c=b.split(".");var t=p;for(var i=0;i<c.length;++i){if(t&&t.hasOwnProperty(c[i])){if(i===c.length-1){var r=t[c[i]];delete t[c[i]];return r;}else{t=t[c[i]];}}else{break;}}return null;};V._getProperty=function(p,b){if(!b){return null;}var c=b.split(".");var t=p;for(var i=0;i<c.length;++i){if(t&&t.hasOwnProperty(c[i])){if(i===c.length-1){var r=t[c[i]];return r;}else{t=t[c[i]];}}else{break;}}return null;};V.removeProperties=function(p,r){if(!r||r.length==0){return;}for(var i=0;i<r.length;++i){V._removeProperty(p,r[i]);}};V.getValueAxis=function(t){var m=sap.viz.api.manifest.Viz.get(t)[0];if(!m){return null;}return m.valueAxis;};V.isValueAxis=function(t,b){var v=V.getValueAxis(t);if(v){for(var i=0;i<v.length;i++){if(b===v[i]){return true;}}}return false;};V.convertValueAxisScale=function(p,s,t){if(!p||!s||!t){return;}var b=V.getValueAxis(s);var v=V.getValueAxis(t);if(!b||b.length===0){return;}var c=[];for(var i=0;i<b.length;++i){c[i]=V._removeProperty(p,b[i]+".scale");}if(v&&v.length>0){for(var n=0;n<v.length;++n){if(c[n]){p[v[n]]=p[v[n]]||{};p[v[n]]["scale"]=c[n];}}}};V.getCategoryAxis=function(t){var m=sap.viz.api.manifest.Viz.get(t)[0];if(!m){return null;}return m.categoryAxis;};V.getValidProperties=function(s,t){var d=V._getDefaultProperties(t);d=P.addDefaultProperties(d,t);var r=U.clone(s);V._deleteInvalidProperty(r,d);return r;};V._deleteInvalidProperty=function(s,d){if(!d){return;}var p;for(p in s){if(!d.hasOwnProperty(p)){delete s[p];}else if(U.type(s[p])==='object'){V._deleteInvalidProperty(s[p],d[p]);}}};V.convertProperties=function(s,b,t){if(!s||!b||!t||b===t){return s;}var p=U.clone(s);var c=V.getValueAxis(b);var v=V.getValueAxis(t);if(c&&c.length!==0){var d=[];for(var i=0;i<c.length;++i){d[i]=V._getProperty(s,c[i]);}if(v&&v.length>0){for(var n=0;n<v.length;++n){if(d[n]){p[v[n]]=d[n];}}}}var e=V.getCategoryAxis(b);var f=V.getCategoryAxis(t);if(e&&e.length!==0){var g=[];for(var i=0;i<c.length;++i){g[i]=V._getProperty(s,e[i]);}if(f&&f.length>0){for(var n=0;n<f.length;++n){if(g[n]){p[f[n]]=g[n];}}}}return p;};return V;});u('sap/viz/controls/common/utils/FakeDataUtils',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/Utils'],function($,C,a,F,L,U){var b={};b.buildFakeData=function(v,f,d){var r=d;var c=b.feedItems2feed(f);var e=b._buildRIVFeeding(v,c);return b._buildFake(v,e,r);};b.feedItems2feed=function(f){var c=[];f.forEach(function(d){var v=d.values();if(v.length>0){for(var i=0;i<v.length;++i){var e=v[i];var g={'feed':d.id().indexOf('multiplier')!==-1?d.id().split('.')[0]:d.id()};if(e.type()===a.HIERARCHY){var h=e.hierarchyLevels();for(var j=0;j<h.length;j++){var l=h[j];if(l.selected()){g.objId=l.id();}}if(e.aggregationType()){g.aggregationType=e.aggregationType();}}else{if(e.type()===a.MND){g.objId=null;}else{if(e.aggregationType()){g.aggregationType=e.aggregationType();if(e.aggregationTarget()){g.objId=e.aggregationTarget();}else{g.objId=U.decode(e.id())[0];}}else{g.objId=e.id();}}}c.push(g);}}});return c;};b._buildRIVFeeding=function(v,f){var c=sap.viz.api.manifest.Viz;var d=c.get(v)[0];var e=d.allFeeds();var g=[];var m=[];var h=[];for(var i=0;i<e.length;i++){var l=e[i].id;var n=e[i].type;var o=[];for(var j=0;j<f.length;j++){if(f[j].feed==l){o.push(f[j]);}}if(o.length>0){var p={};p.feedId=l;p.binding=[];var q=0;for(var k=0;k<o.length;k++){if(o[k].objId!=null){if(n===F.DIMENSION){if($.inArray(e[i].aaIndex,g)==-1){p.binding[q]={};p.binding[q].type=C.ANALYSIS_AXIS;p.binding[q].index=e[i].aaIndex;g.push(e[i].aaIndex);q++;}}else{if($.inArray(e[i].mgIndex,m)==-1){p.binding[q]={};p.binding[q].type=C.MEASURE_VALUES_GROUP;p.binding[q].index=e[i].mgIndex;m.push(e[i].mgIndex);q++;}}}else if(n===F.DIMENSION){p.binding[q]={};p.binding[q].type=C.MEASURE_NAMES_DIMENSION;q++;}}h.push(p);}}g.sort();m.sort();b._fillAxesHoles(h,g);b._fillMgHoles(h,m);return h;};b._fillAxesHoles=function(d,c){var j,e;if(c.length>0){e=c[0]-1;if(e>0){for(var j=0;j<d.length;j++){for(var k=0;k<d[j].binding.length;k++){if(d[j].binding[k].type==C.ANALYSIS_AXIS&&d[j].binding[k].index!=null&&d[j].binding[k].index>1){d[j].binding[k].index-=e;}}}for(j=0;j<c.length;j++){c[j]-=e;}}}for(var i=0;i<c.length-1;i++){e=c[i+1]-c[i]-1;if(e>0){for(j=0;j<d.length;j++){for(var k=0;k<d[j].binding.length;k++){if(d[j].binding[k].type==C.ANALYSIS_AXIS&&d[j].binding[k].index!=null&&d[j].binding[k].index>c[i]){d[j].binding[k].index-=e;}}}for(j=i+1;j<c.length;j++){c[j]-=e;}}}};b._fillMgHoles=function(d,m){var j;if(m.length>0){var c=m[0]-1;if(c>0){for(j=0;j<d.length;j++){if(d[j].binding[0].type==C.MEASURE_VALUES_GROUP&&d[j].binding[0].index!=null&&d[j].binding[0].index>1){d[j].binding[0].index-=c;}}for(j=0;j<m.length;j++){m[j]-=c;}}}for(var i=0;i<m.length-1;i++){var c=m[i+1]-m[i]-1;if(c>0){for(j=0;j<d.length;j++){if(d[j].binding[0].type==C.MEASURE_VALUES_GROUP&&d[j].binding[0].index!=null&&d[j].binding[0].index>m[i]){d[j].binding[0].index-=c;}}for(j=i+1;j<m.length;j++){m[j]-=c;}}}};b._getMNDfeed=function(f,c){if(!c)return;var m={priority:-1};for(var i=0;i<f.length;i++){var I=f[i].id;var d=f[i];var e=U.isNumber(d.acceptMND)?Number(d.acceptMND):-1;var g=false;for(var j=0;j<c.length;j++){if(c[j].feedId==I){if(c[j].binding.length>0){for(var k=0;k<c[j].binding.length;k++){if(c[j].binding[k].type==C.MEASURE_NAMES_DIMENSION){return I;}}}if(c[j].binding.length<d.min){if(e>m.priority){m={feedId:I,priority:d.acceptMND};}}g=true;break;}}if(!g){if(d.min>0&&e>=0){m={feedId:I,priority:d.acceptMND};}}}return m.feedId;};b._validateInput=function(f,d){var c=0;if(d&&d.analysisAxis){c=d.analysisAxis.length;}var m=0;if(d&&d.measureValuesGroup){m=d.measureValuesGroup.length;}for(var i=0;i<f.length;i++){var e=f[i];if(e.binding){for(var j=0;j<e.binding.length;j++){var g=e.binding[j].index;var t=e.binding[j].type;if(t==C.ANALYSIS_AXIS&&(g>c)){return false;}else if(t==C.MEASURE_VALUES_GROUP&&(g>m)){return false;}}}}return true;};b._buildFake=function(v,r,c){if(!b._validateInput(r,c)){c.analysisAxis=[];c.measureValuesGroup=[];return{"feeding":r,"dataset":c};}var d=sap.viz.api.manifest.Viz;var e=d.get(v)[0];var f=e.allFeeds();var g=e.id;var m=b._getMNDfeed(f,r);var h=[];var l=[];var i,j;for(i=0;i<f.length;i++){if(f[i].id==m){continue;}var n=b._getFakeToBeBuilt(f[i],r,c);if(n.nb>0){if(n.axisIndex!=null){h.push(n);}else if(n.mgIndex!=null){l.push(n);}}}if(c.analysisAxis==null){c.analysisAxis=[];}for(i=0;i<h.length;i++){var o=h[i];var p=null;for(var j=0;j<c.analysisAxis.length;j++){if(c.analysisAxis[j].index==o.axisIndex){p=c.analysisAxis[j];}}if(p==null){p={};p.data=[];p.index=o.axisIndex;c.analysisAxis.push(p);}var q={};q.type=F.DIMENSION;q.name=L.get('VIZ_COMMON_FAKE_DIMENSION');q.isFake=true;var s=false;for(j=0;j<c.analysisAxis.length;j++){if(c.analysisAxis[j].data[0]!=null&&c.analysisAxis[j].data[0].values.length>0){s=true;}else{s=false;}}if(s||i>0){if(g===C.TYPE_TREE||g===C.TYPE_NETWORK){q.values=b._buildFakeDimensionValues(p.data[0].values.length);}else{q.values=b._buildFakeDimensionValues(1);}}else{var t=10;if(c.measureValuesGroup!=null&&c.measureValuesGroup[0]!=null){t=c.measureValuesGroup[0].data[0].values.length;}q.values=b._buildFakeDimensionValues(t);if(b._isGeoOrNor(v)){q.infos=b._buildFakeGeoInfos(t);}}p.data.push(q);}if(c.measureValuesGroup==null){c.measureValuesGroup=[];}var w=b._sortAxes(f,c,r);if(w){b._swapMeasure(c);}for(i=0;i<l.length;i++){var x=l[i];var y=null;for(j=0;j<c.measureValuesGroup.length;j++){if(c.measureValuesGroup[j].index==x.mgIndex){y=c.measureValuesGroup[j];}}if(y==null){y={};y.data=[];y.index=x.mgIndex;c.measureValuesGroup.push(y);}for(var k=0;k<x.nb;k++){var z={};z.type=F.MEASURE;z.name=L.get('VIZ_COMMON_FAKE_MEASURE')+(i+k+1);z.isFake=true;var D=[];for(j=c.analysisAxis.length-1;j>=0;j--){D.push(c.analysisAxis[j].data[0].values.length);}if(D.length===0){D=[1];}var E=b._buildFakeMeasureValues(D);if(!Array.isArray(E[0])){E=[E];}z.values=E;y.data.push(z);}}return{"feeding":r,"dataset":c};};b._sortAxes=function(f,r,c){var d={};if(r.analysisAxis.length>1){for(var i=0;i<f.length;i++){var e=f[i];if(e.type===F.DIMENSION){for(var j=0;j<c.length;j++){if(c[j].feedId===e.id){var g=e.aaIndex;var h=c[j].binding;for(var m=0;m<h.length;m++){if(h[m]&&h[m].type==C.ANALYSIS_AXIS){var l=h[m].index;for(var n=0;n<r.analysisAxis.length;n++){if(r.analysisAxis[n].index===l){d[n]=g;break;}}}}}}}}}var o=false;for(var i=0;i<r.analysisAxis.length;i++){for(var j=r.analysisAxis.length-1;j>=i+1;j--){if(d[j]<d[j-1]){var p=r.analysisAxis[j];r.analysisAxis[j]=r.analysisAxis[j-1];r.analysisAxis[j-1]=p;o=true;}}}var q=U.clone(c);for(var i=0;i<r.analysisAxis.length;i++){var p=r.analysisAxis[i];var g=i+1;for(var j=0;j<q.length;j++){var h=q[j].binding;for(var k=0;k<h.length;k++){if(h[k]&&h[k].type==C.ANALYSIS_AXIS&&h[k].index==p.index){c[j].binding[k].index=g;}}}p.index=g;}return o;};b._swapMeasure=function(r){var c=r.measureValuesGroup;if(c){for(var m=0;m<c.length;m++){var d=c[m].data;if(d){for(var n=0;n<d.length;n++){var e=d[n];var l=e.values.length;var f=e.values[0].length;var g=new Array(f);for(var j=0;j<f;j++){g[j]=new Array(l);}for(var i=0;i<l;i++){for(var j=0;j<f;j++){g[j][i]=e.values[i][j];}}e.values=g;}}}}};b._getFakeToBeBuilt=function(f,r,c){var d=f.min;if(f.id==="treeNode"||f.id==="link"){d=f.minStackedDims;}if(d==0){return{"nb":0};}var n=0;var i,j,k;for(i=0;i<r.length;i++){var e=null;var m=null;if(f.id==r[i].feedId){if(f.type==F.DIMENSION){var g=r[i].binding;for(k=0;k<g.length;k++){if(g[k].index){e=g[k].index;}}if(e!==null){if(!c.analysisAxis.length){return{"nb":0,"axisIndex":e};}else{for(j=0;j<c.analysisAxis.length;j++){if(c.analysisAxis[j].index==e){n=c.analysisAxis[j].data.length;var h=d-n;if(h<0){h=0;}return{"nb":h,"axisIndex":e};}}}}else{return{"nb":0};}}else if(f.type==F.MEASURE){m=r[i].binding[0].index;for(j=0;j<c.measureValuesGroup.length;j++){if(c.measureValuesGroup[j].index==m){n=c.measureValuesGroup[j].data.length;var h=d-n;if(h<0){h=0;}return{"nb":h,"mgIndex":m};}}return{"nb":0,"mgIndex":m};}}}if(f.type==F.DIMENSION){var l=1;for(i=0;i<r.length;i++){for(k=0;k<r[i].binding.length;k++){if(r[i].binding[k].type==C.ANALYSIS_AXIS&&r[i].binding[k].index>=l){l=r[i].binding[k].index+1;}}}var o={};o.feedId=f.id;o.binding=[];o.binding[0]={};o.binding[0].type=C.ANALYSIS_AXIS;o.binding[0].index=l;r.push(o);return{"nb":d,"axisIndex":l};}else if(f.type==F.MEASURE){var p=1;for(i=0;i<r.length;i++){if(r[i].binding[0].type==C.MEASURE_VALUES_GROUP&&r[i].binding[0].index>=p){p=r[i].binding[0].index+1;}}var o={};o.feedId=f.id;o.binding=[];o.binding[0]={};o.binding[0].type=C.MEASURE_VALUES_GROUP;o.binding[0].index=p;r.push(o);return{"nb":d,"mgIndex":p};}return null;};b._buildFakeMeasureValues=function(c){var v=[];var d=c[0];var i=0;if(c.length==1){for(i=0;i<d;i++){v[i]=Math.round(Math.random()*100);}}else{c.shift();for(i=0;i<d;i++){v[i]=b._buildFakeMeasureValues(c);}}return v;};b._buildFakeDimensionValues=function(n){var d=[];for(var i=0;i<n;i++){d[i]=i.toString();}return d;};b._buildFakeGeoInfos=function(n){var f=[];for(var i=0;i<n;i++){f[i]='';}return f;};b._isGeoOrNor=function(t){if(t.search('geo')==-1&&t.search('choropleth')==-1){return false;}else{return true;}};return b;});u('sap/viz/controls/common/utils/InfoChartUtil',['jquery','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils'],function($,a,b,V){var C={'line':1,'column':1,'bar':1,'donut':1,'horizontal_line':1};var I={getInfoType:function(v){var d=String(v).match(/^viz\/(.*)$/);if(d&&C[d[1]]){var e="info/"+d[1];var f=sap.viz.api.manifest.Viz.get(e);if(f&&f[0]){return e;}}return null;},isInfoChart:function(t){return(/^info\/\w+$/).test(t);},getVizType:function(d){return this.isInfoChart(d)?d.replace('info/','viz/'):null;},buildInfoDataset:function(d){var e=sap.viz.data.utils.CTB2TBConvertUtil.crossTable2FlatTableData(d);return new sap.viz.api.data.FlatTableDataset(e);},buildInfoFeeding:function(f,d){var e={};for(var i=0;i<f.length;i++){var h=f[i];var v=h.values()||[];var l=e[h.id()]=[];for(var j=0;j<v.length;j++){var n=v[j];if(n.type()===a.MND){if(d){l.unshift("MeasureNamesDimension");}else{l.push("MeasureNamesDimension");}}else{if(n.type()===a.HIERARCHY){for(var k=0;k<n.hierarchyLevels().length;k++){var o=n.hierarchyLevels()[k];l.push(o.id());if(o.selected()){break;}}}else{l.push(n.id());}}}}return e;},buildInfoProperties:function(v,d){var e=$.extend(true,{},d);var f=V.getCategoryAxis(v);if(f&&f.length){r(e,f[0],'categoryAxis');if(f.length>1){r(e,f[1],'categoryAxis2');}}var h=V.getValueAxis(v);if(h&&h.length){r(e,h[0],'valueAxis');if(h.length>1){r(e,h[1],'valueAxis2');}}m(e,'dataLabel','plotArea.dataLabel');m(e,'background','plotArea.background');m(e,'plotArea.background.body.color','plotArea.background.color');m(e,'valueAxis.scale','plotArea.primaryScale');m(e,'valueAxis2.scale','plotArea.secondaryScale');m(e,'valueAxis2.gridline','plotArea.gridline');m(e,'valueAxis.gridline','plotArea.gridline');r(e.valueAxis,'axisline','axisLine');r(e.valueAxis2,'axisline','axisLine');r(e.categoryAxis,'axisline','axisLine');r(e.categoryAxis2,'axisline','axisLine');m(e,'valueAxis.lineSize','valueAxis.axisLine.size');m(e,'valueAxis2.lineSize','valueAxis2.axisLine.size');m(e,'categoryAxis.lineSize','categoryAxis.axisLine.size');m(e,'categoryAxis2.lineSize','categoryAxis2.axisLine.size');c(e,'valueAxis.label.formatString');c(e,'valueAxis2.label.formatString');c(e,'plotArea.dataLabel.formatString');c(e,'tooltip.formatString');return e;},buildInfoSeries:function(f,d){var e=f['regionColor'];var h=new Object,k=[];var l,v,n,o,p;if(!e||e.length===0){return null;}var q=f['axisLabels'];var t=f['primaryValues'];var w=false;if(e.indexOf('MeasureNamesDimension')>=0){e.splice(e.indexOf('MeasureNamesDimension'),1);w=true;}if(e.length<=0){var x;t.forEach(function(x){for(i=0;i<d.length;i++){l=d[i];if(l[x]!=null){p=new Object;p['name']=x;o=new Object;o['MeasureNamesDimension']=x;p['seriesData']=o;h[x]=p;break;}}});return h;}for(i=0;i<d.length;i++){l=d[i];v=false;for(j=0;j<t.length;j++){if(l[t[j]]!=null){v=true;break;}}if(v){n=l[e[0]];o=new Object;p=new Object;o[e[0]]=l[e[0]];for(j=1;j<e.length;j++){n=n+" / "+l[e[j]];o[e[j]]=l[e[j]];}if(w){var y,z;for(j=0;j<t.length;j++){if(!l.hasOwnProperty(t[j])){continue;}y=n+" / "+t[j];if(y&&k.indexOf(y)<0){k.push(y);z=b.clone(o);z[t[j]]=l[t[j]];p=new Object;p['name']=y;p['seriesData']=z;h[y]=p;}}}else if(n&&k.indexOf(n)<0){k.push(n);p['name']=n;p['seriesData']=o;h[n]=p;}}}return h;}};function g(d,p){return p?p.split('.').reduce(function(o,e){return o&&typeof o=='object'?o[e]:null;},d):d;}function s(d,p,v){p.split('.').reduce(function(o,e,f,h){if(f<h.length-1){o[e]=o[e]!=null?o[e]:{};}else{o[e]=v;}return o[e];},d);}function m(d,e,t,f){var v=g(d,e);if(v!=null){if(!f){var p=e.split('.');var h=p.pop();var k=p.join('.');delete g(d,k)[h];}s(d,t,v);}}function r(d,o,n){if(d&&o in d){d[n]=d[o];delete d[o];}}function c(d,f){var e=g(d,f);if(!e){return;}if(b.isString(e)){return;}if(b.isArray(e)&&b.isArray(e[0])&&b.isString(e[0][0])){s(d,f,e[0][0]);}}return I;});u('sap/viz/controls/common/utils/TrellisUtils',['sap/viz/controls/common/constants/ChartConst'],function(C){var t={};var T={};T.TRELLIS='trellis';T.MULTIPLE='multi';T._register=function(p,a){if(a){t[a]=p;}else{t['_default']=p;}};T._getProvider=function(a){var p=t[a];if(!p){p=t['_default'];}return p;};T.providerName=function(a){var p=T._getProvider(a);return p.name;};T.isMultipleChart=function(a){if(!a){return false;}var p=T._getProvider(a);return p.isMultipleChart(a);};T.supportMultiChart=function(a){if(!a){return false;}var p=T._getProvider(a);return p.supportMultiChart(a);};T.toSingleChartType=function(a){if(!a){return a;}var p=T._getProvider(a);return p.toSingleChartType(a);};T.toMultiChartType=function(a){if(!a){return a;}var p=T._getProvider(a);if(p.isMultipleChart(a)){return a;}else{return p.toMultiChartType(a);}};function c(n){var v='viz/'+n+'_';var p={name:n};p.isMultipleChart=function(a){if(!a){return false;}return(a.indexOf(v)===0);};p.supportMultiChart=function(a){if(a.indexOf(v)===0){return true;}var m=p.toMultiChartType(a);if(m!==a){return true;}else{return false;}};p.toSingleChartType=function(a){if(p.isMultipleChart(a)){return a.replace(v,'viz/');}return a;};p.toMultiChartType=function(a){var m=a.replace('viz/',v);if(sap.viz.api.manifest.Viz.get(m)[0]){return m;}return a;};return p;}T._register(c(T.MULTIPLE));return T;});u('sap/viz/controls/common/utils/ChartTypeUtil',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/utils/TrellisUtils'],function(C,D,L,I,T){var a={};a._CVOM_TYPE_MAPPING=function(){var m={};var b=function(c,v,d,e){var p={vizType:v};if(d){p.vizDirection=d;}if(e){p.vizStacking=e;}m[c]=p;c=I.getInfoType(c);if(c){m[c]=p;}};b(C.TYPE_STACKED_BAR,C.TYPE_STACKED_BAR,null,C.STACKING_NORMAL);b(C.TYPE_100_STACKED_BAR,C.TYPE_STACKED_BAR,null,C.STACKING_FULL);b(C.TYPE_STACKED_COLUMN,C.TYPE_STACKED_COLUMN,null,C.STACKING_NORMAL);b(C.TYPE_100_STACKED_COLUMN,C.TYPE_STACKED_COLUMN,null,C.STACKING_FULL);b(C.TYPE_3D_BAR,C.TYPE_3D_COLUMN,C.DIRECTION_HORIZONTAL);b(C.TYPE_3D_COLUMN,C.TYPE_3D_COLUMN,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_LINE,C.TYPE_LINE,C.DIRECTION_HORIZONTAL);b(C.TYPE_LINE,C.TYPE_LINE,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_AREA,C.TYPE_AREA,C.DIRECTION_HORIZONTAL,C.STACKING_NORMAL);b(C.TYPE_100_HORIZONTAL_AREA,C.TYPE_AREA,C.DIRECTION_HORIZONTAL,C.STACKING_FULL);b(C.TYPE_AREA,C.TYPE_AREA,C.DIRECTION_VERTICAL,C.STACKING_NORMAL);b(C.TYPE_100_AREA,C.TYPE_AREA,C.DIRECTION_VERTICAL,C.STACKING_FULL);b(C.TYPE_HORIZONTAL_COMBINATION,C.TYPE_COMBINATION,C.DIRECTION_HORIZONTAL);b(C.TYPE_COMBINATION,C.TYPE_COMBINATION,C.DIRECTION_VERTICAL);b(C.TYPE_DUAL_HORIZONTAL_LINE,C.TYPE_DUAL_LINE,C.DIRECTION_HORIZONTAL);b(C.TYPE_DUAL_LINE,C.TYPE_DUAL_LINE,C.DIRECTION_VERTICAL);b(C.TYPE_DUAL_HORIZONTAL_COMBINATION,C.TYPE_DUAL_COMBINATION,C.DIRECTION_HORIZONTAL);b(C.TYPE_DUAL_COMBINATION,C.TYPE_DUAL_COMBINATION,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_BOXPLOT,C.TYPE_BOXPLOT,C.DIRECTION_HORIZONTAL);b(C.TYPE_BOXPLOT,C.TYPE_BOXPLOT,C.DIRECTION_VERTICAL);b(C.TYPE_HORIZONTAL_WATERFALL,C.TYPE_WATERFALL,C.DIRECTION_HORIZONTAL);b(C.TYPE_WATERFALL,C.TYPE_WATERFALL,C.DIRECTION_VERTICAL);return m;};a._VIZ_TYPE_MAPPING=function(){var m={};var b=function(v,c){var n;if(v===C.TYPE_TABLE){n=L.get('VIZ_COMMON_TABLE_TEXT');}else if(v===C.TYPE_CROSSTAB){n=L.get('VIZ_COMMON_CROSSTAB_TEXT');}else{var d=sap.viz.api.manifest.Viz.get(v)[0];n=d?d.name:v;}m[v]={'id':v,'caption':n,'icon':c,'whiteIcon':c+'-white','greyIcon':c+'-grey'};var e=I.getInfoType(v);if(e){m[e]=m[v];}};b(C.TYPE_BAR,'bar');b(C.TYPE_COLUMN,'column');b(C.TYPE_STACKED_BAR,'stacked-bar');b(C.TYPE_STACKED_COLUMN,'stacked-column');b(C.TYPE_DUAL_BAR,'dual-bar');b(C.TYPE_DUAL_COLUMN,'dual-column');b(C.TYPE_3D_COLUMN,'3D-column');b(C.TYPE_LINE,'line');b(C.TYPE_AREA,'area');b(C.TYPE_COMBINATION,'combination');b(C.TYPE_DUAL_LINE,'dual-line');b(C.TYPE_DUAL_COMBINATION,'dual-combination');b(C.TYPE_PIE,'pie');b(C.TYPE_DONUT,'donut');b(C.TYPE_PIE_WITH_DEPTH,'pie-with-depth');b(C.TYPE_GEO_BUBBLE,'geo-bubble');b(C.TYPE_GEO_CHOROPLETH,'geo-choropleth');b(C.TYPE_GEO_PIE,'geo-pie');b(C.TYPE_GEO_MAP,'geo-map');b(C.TYPE_SCATTER,'scatter');b(C.TYPE_BUBBLE,'bubble');b(C.TYPE_SCATTER_MATRIX,'scatter-matrix');b(C.TYPE_HEATMAP,'heatmap');b(C.TYPE_TREEMAP,'treemap');b(C.TYPE_TABLE,'table');b(C.TYPE_CROSSTAB,'crosstab');b(C.TYPE_RADAR,'radar');b(C.TYPE_BOXPLOT,'boxplot');b(C.TYPE_WATERFALL,'waterfall');b(C.TYPE_TAG_CLOUD,'tag-cloud');b(C.TYPE_TREE,'tree');b(C.TYPE_NETWORK,'network');b(C.TYPE_FUNNEL,'funnel');b(C.TYPE_PC,'pc');b(C.TYPE_NUMBER,'number');b('viz/ext/samplesbar','viz/ext/samplesbar');b('viz/ext/flagbar','viz/ext/flagbar');return m;};a.getVizTypeObject=function(v){if(a.VIZ_TYPE__MAPPING==null){a.VIZ_TYPE__MAPPING=a._VIZ_TYPE_MAPPING();}var t=a.VIZ_TYPE__MAPPING[v];if(t){t=JSON.parse(JSON.stringify(t));}return t;};a.toVizProperties=function(c){if(a.CVOM_TYPE_MAPPING==null){a.CVOM_TYPE_MAPPING=a._CVOM_TYPE_MAPPING();}var p=a.CVOM_TYPE_MAPPING[c];if(!p){p={vizType:c};}return p;};a.fromVizProperties=function(t,v,b){if(!v&&!b){return t;}var c=a.toVizProperties(t).vizType;for(var d in a.CVOM_TYPE_MAPPING){if(a.CVOM_TYPE_MAPPING.hasOwnProperty(d)){var p=a.CVOM_TYPE_MAPPING[d];if(p.vizType===c&&(!v||!p.vizDirection||p.vizDirection===v)&&(!b||!p.vizStacking||p.vizStacking===b)){return d;}}}return t;};a.updateType=function(t,o){var n=t;if(o.hasOwnProperty("direction")){n=a.changeDirection(n,o["direction"]);o["direction"]=undefined;}if(o.hasOwnProperty("stacking")){n=a.changeStacking(n,o["stacking"]);o["stacking"]=undefined;}return n;};a.isMultipleChart=function(t){return T.isMultipleChart(t);};a.toMultiChartType=function(t){return T.toMultiChartType(t);};a.toSingleChartType=function(t){return T.toSingleChartType(t);};a.supportMultiChart=function(v){return T.supportMultiChart(v);};a.getDirection=function(t){var c=a.toSingleChartType(t);var b=a.toVizProperties(c);if(b.vizDirection){return b.vizDirection;}return null;};a.getStacking=function(t){var c=a.toSingleChartType(t);var b=a.toVizProperties(c);if(b.vizStacking){return b.vizStacking;}return null;};a.changeDirection=function(t,d){var c=a.toSingleChartType(t);var b=a.getDirection(c);if(b===d||!b){return t;}var s=a.getStacking(c);var n=a.fromVizProperties(c,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(n);}return n;};a.changeStacking=function(t,s){var c=a.toSingleChartType(t);var b=a.getStacking(c);if(b===s||!b){return t;}var d=a.getDirection(c);var n=a.fromVizProperties(c,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(n);}return n;};a.getType=function(t,v){if(!t){return v;}var c=a.toSingleChartType(t);var d=a.getDirection(c);var s=a.getStacking(c);c=a.fromVizProperties(v,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(c);}return c;};a.getVizType=function(t){var c=a.toSingleChartType(t);return a.toVizProperties(c).vizType;};a.getDatasetType=function(t){if(a.isGeo(t)||I.isInfoChart(t)){return D.FlatTableDataset;}else if(a.isTable(t)){return D.RawDataset;}else{return D.CrosstableDataset;}};a.isTable=function(t){return(t===C.TYPE_TABLE||t===C.TYPE_CROSSTAB);};a.isGeo=function(t){return(t===C.TYPE_GEO_MAP);};a.isInfoChart=function(t){if(t&&t.indexOf("info/")==0){return true;}return false;};a.supportTitle=function(t){if(a.isGeo(t)){return false;}else{return true;}};a.isBuildInType=function(t){var m=sap.viz.api.manifest.Viz.get(t)[0]||{};return!!m.isBuiltIn;};a.supportAnimation=function(t){return t===C.TYPE_GEO_BUBBLE||t===C.TYPE_BUBBLE||t===C.TYPE_SCATTER;};a.isEmptyData=function(t,d){var b=a.getDatasetType(t);if(b===D.RawDataset){return false;}else if(b===D.FlatTableDataset){return false;}else{var c=d?(d.data()?d.data().analysisAxis:null):null;var m=d?(d.data()?d.data().measureValuesGroup:null):null;if((!c||c&&c.length===0)&&(!c||m&&m.length===0)){return true;}}return false;};a.getCategoryAxis=function(t){if(t==='info/bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return['yAxis'];}else{return['xAxis'];}};a.getValueAxis=function(t){if(t==='info/bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return['xAxis'];}else{return['yAxis'];}};a.isHorizontal=function(t){if(t==='info/bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return true;}else{return false;}};a.isCategoryAxis=function(t,b){if(t==='info/bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return b==='yAxis'?true:false;}else{return b==='xAxis'?true:false;}};a.isSupportMorphing=function(t){if(t===C.TYPE_TREE||t===C.TYPE_NETWORK||t===C.TYPE_FUNNEL||t===C.TYPE_PC||a.supportAnimation(t)){return false;}else if(!a.isBuildInType(t)){return false;}else{return true;}};a.getChartId=function(t){return a.getVizType(t).replace('viz/','');};return a;});u('sap/viz/controls/common/feeds/FeedUtils',['require','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/FakeDataUtils','sap/viz/controls/common/utils/ChartTypeUtil'],function(r,C,F,b,c,U,d,e){var A=r||A;var f={};f.MultiplierFeedingName='multiplier';f.RowsFeedingName='multiplier.row';f.ColumnsFeedingName='multiplier.column';f.trillisFeeds={'id':'multiplier','row':{id:'multiplier.row',maxStacked:3,minStacked:0,type:b.DIMENSION},'column':{id:'multiplier.column',maxStacked:3,minStacked:0,type:b.DIMENSION}};f.geoFeeds={'id':'geoFeatures'};f.MaxDemensionFeedsCount=2;f._mapFeedItem=function(a,g,t){var h=a.id();var i;var k=null;for(i=0;i<g.length;i++){if(g[i].id===h){k=g[i];break;}}if(k===null){return a;}var l=a.type();var m='aaIndex';if(l!==b.DIMENSION){m='mgIndex';}var n=null;for(i=0;i<t.length;i++){if(t[i][m]===k[m]){n=new F(t[i].id,l,a.values());t.splice(i,1);return n;}}for(i=0;i<t.length;i++){if(l===t[i].type&&t[i].id!==f.MultiplierFeedingName){n=new F(t[i].id,l,a.values());t.splice(i,1);return n;}}return n;};f._idEquals=function(a,g){var h=a.id();var k=false;if(h===g.id){k=true;}else if(g.id===f.MultiplierFeedingName&&(h===f.RowsFeedingName||h===f.ColumnsFeedingName)){k=true;}return k;};f.getVizFeeds=function(v){var a=sap.viz.api.manifest.Viz.get(v)[0];if(a){return a.allFeeds();}else{return null;}};f.mapFeeds=function(a,g,t){if(!t||g===t||(!a)){return{'feeds':a,'feedsChanged':false};}var h=[];if(g&&U.isString(g)){h=f.getVizFeeds(g)||[];}var k=f.getVizFeeds(t);if(!k){return{'feeds':[],'feedsChanged':true};}k=k.slice();var i,n;var l=[];var o=[];var p=false;for(i=0;i<a.length;i++){var q=a[i].id();p=false;for(n=0;n<k.length;n++){if(k[n].id===q){l.push(a[i]);k.splice(n,1);p=true;break;}}if(!p){o.push(a[i]);}}var s;var v=false;for(i=0;i<o.length;i++){s=f._mapFeedItem(o[i],h,k);if(s){l.push(s);}if(s!==o[i]){v=true;}}for(n=0;n<k.length;n++){p=false;for(var m=0;m<l.length;m++){if(f._idEquals(l[m],k[n])){p=true;break;}}if(!p){v=true;if(k[n].id===f.MultiplierFeedingName){l.push(new F(f.RowsFeedingName,k[n].type,[]));l.push(new F(f.ColumnsFeedingName,k[n].type,[]));}else{l.push(new F(k[n].id,k[n].type,[]));}}}if(f.isEmptyFeeds(l)){v=false;}return{'feeds':l,'feedsChanged':v};};f.canAddFeed=function(a,g,h,z){var l=g.id===f.MultiplierFeedingName;var m=0;if(l){m=z?(z==="mainPlot"?2:1):2;}for(var i=0;i<a.length;i++){if(!f._idEquals(a[i],g)){continue;}if((z===f.RowsFeedingName||z===f.ColumnsFeedingName)&&a[i].id()!==z){continue;}var v=a[i].values();for(var j=0;j<v.length;j++){var n=v[j];if(n.id()===h.id()){if(l){if(--m===0){return false;}}else{return false;}}}}var t=h.type();if(t){t=t.toLowerCase();}var o=h.dataType();if(o){o=o.toLowerCase();}var p=g.id===f.geoFeeds.id?b.GEOGRAPHY:g.type;if(!f.feedCompatible(p,t,o)){return false;}else if(f.feedCompatible(t,c.MEASURE,o)){return true;}var q=0;var s=0;for(var k=0;k<a.length;k++){var w=a[k];if(!w.hasValues()){continue;}else if(f._idEquals(w,g)){return true;}else if(w.type()===b.DIMENSION){if(w.id()===f.RowsFeedingName||w.id()===f.ColumnsFeedingName){s=Math.min(1,s+1);}else{q++;}}}return(q+s)<f.MaxDemensionFeedsCount;};f.checkDimensionFeedItemsToLimit=function(a){var n=0;var g=0;for(var i=0;i<a.length;i++){var h=a[i];if(h.type()===b.DIMENSION&&h.hasValues()){if(h.id()===f.RowsFeedingName||h.id()===f.ColumnsFeedingName){g=Math.min(1,g+1);}else{n++;}}}return(g+n)>=f.MaxDemensionFeedsCount;};f.getEmptyFeedItemsId=function(a){var g=[];var h=false;for(var i=0;i<a.length;i++){var k=a[i];if(k.type()===b.DIMENSION){if(k.id()===f.RowsFeedingName||k.id()===f.ColumnsFeedingName){if(k.values().length>0){h=true;}continue;}if(!k.values().length){g.push(k.id());}}}if(!h){g.push(f.RowsFeedingName);g.push(f.ColumnsFeedingName);}return g;};f.hasRowOrColumn=function(a){var _=false;if(!a){return _;}for(var i=0;i<a.length;i++){var g=a[i];if(g.id()===f.RowsFeedingName||g.id()===f.ColumnsFeedingName||g.id()===f.MultiplierFeedingName){if(g.values().length>0){_=true;break;}}}return _;};f.isEmptyFeeds=function(a){if(!a){return true;}for(var i=0;i<a.length;i++){var g=a[i];if(g){var v=g.values();if(v&&v.length>0){return false;}}}return true;};f._toMap=function(a){var m={};for(var i=0;i<a.length;i++){var g=a[i];if(!g){continue;}m[g.id()]={'index':i,'item':g};}return m;};f.isFeedDefinitionEqual=function(t,a){if(t===a){return true;}if(!t||!a){return false;}var g=f.getVizFeeds(t);var h=f.getVizFeeds(a);if(!g||!h){return false;}if(g.length!==h.length){return false;}for(var i=0;i<g.length;i++){var k=g[i];var l=h[i];for(var p in k){if(k.hasOwnProperty(p)){if(k[p]!==l[p]){return false;}}}}return true;};f.equal=function(a,g){var i;var h=f._toMap(a);var k=f._toMap(g);var l;for(l in h){if(h.hasOwnProperty(l)){var m=h[l].item;var n=m.values();var o=k[l]?k[l].item:null;var p=k[l]?o.values():null;delete k[l];if(!o){if(n.length>0){return false;}}else{if(p.length!==n.length){return false;}else{var q;var s=f._toMap(n);var t=f._toMap(p);for(var v in s){if(s.hasOwnProperty(v)){if(t[v]===undefined){return false;}else if(s[v].index!==t[v].index){return false;}else if(!s[v].item.equal(t[v].item)){return false;}}}}}}}for(l in k){if(k.hasOwnProperty(l)){var w=k[l].item;var x=w.values();if(x.length>0){return false;}}}return true;};f.cloneFeeds=function(a){if(!a){return null;}if(a.length===0){return[];}var g=[];for(var i=0;i<a.length;i++){var h=a[i];g.push(h.clone());}return g;};f.feedHasValue=function(n,a){if(!n||!a){return false;}var g=false;var h=a.values();for(var i=0;i<h.length;i++){if(h[i].id()===n.id()){g=true;break;}}return g;};f.buildMNDFeedings=function(a,t){if(!a){return;}var g=sap.viz.api.manifest.Viz;var h=g.get(t)[0];var k=h.allFeeds();var m={feedId:null,index:-1,priority:-1};for(var i=0;i<k.length;i++){var I=k[i].id;var l=k[i];var n=false;for(var j=0;j<a.length;j++){if(a[j].feedId===I){if(a[j].binding.length<l.min){if(f.canAcceptMND(l.acceptMND)){m={feedId:I,index:j,priority:l.acceptMND};}}n=true;break;}}if(!n){if(l.min>0&&f.canAcceptMND(l.acceptMND)){m={feedId:I,index:-1,priority:l.acceptMND};}}}var o=a;if(o&&m.index>=0){o[m.index].binding.push({"type":C.MEASURE_NAMES_DIMENSION});}else if(o&&m.feedId){o.push({binding:[{"type":C.MEASURE_NAMES_DIMENSION}],feedId:m.feedId});}return o;};f._useFullHierarchies=function(a,g,h){var l=true;if(a==="geoFeatures"){l=false;}else if(U.isNumber(g.maxStackedDims)){var s=0;for(var j=0;j<h.length;j++){var m=h[j];if(m.type()===c.HIERARCHY){var n=m.hierarchyLevels();for(var k=0;k<n.length;k++){s++;if(n[k].selected()){break;}}}else if(m.type()===c.DIMENSION){s++;}}if(g.maxStackedDims<s){l=false;}}return l;};f.buildFeedings=function(t,a,g){return f.buildFeedingsWithFakeData(t,a,g);};f._adjustMND=function(a,g){var m=g['multiplier'];if(m){var h=f.getNumberOfDimensionsInColumn(a);var k=m.length-h;if(k>0&&h>0){for(var i=0;i<m.length;i++){if(m[i].type()===c.MND){if(i>0&&i<k+h-1){var l=m[i];if(i<k){m.unshift(l);m.splice(i+1,1);}else{m.push(l);m.splice(i,1);}}break;}}}}};f._findBindingIndex=function(a,g){for(var i=0;i<a.length;i++){var h=a[i];if(h.data.length!==g.length){continue;}var m=true;for(var j=0;j<h.data.length;j++){m=m&&h.data[j].name===g[j];}if(m){a.splice(i,1);return h.index;}}};f.removeRowAndColumnFeedItems=function(a){var g=f.cloneFeeds(a);var l=g.length;while(l){var h=l-1;var k=g[h];if(k.id()===f.RowsFeedingName||k.id()===f.ColumnsFeedingName||k.id()===f.MultiplierFeedingName){g.splice(h,1);}l--;}return g;};f.getNumberOfDimensionsInColumn=function(a){var n=0;a.forEach(function(g){if(g.id()===f.ColumnsFeedingName){var h=g.values();h.forEach(function(k){if(k.type()===c.HIERARCHY){var l=k.hierarchyLevels();for(var i=0;i<l.length;i++){n++;if(l[i].selected()){break;}}}else{n++;}});return;}});return n;};f.buildFeedingsWithFakeData=function(v,a,g){var g=JSON.parse(JSON.stringify(g.data()));var h=d.buildFakeData(v,a,g).feeding;return h;};f.meetMinDimensions=function(t,a){var g;var v=f.getManifestFeedsMap(t);var h=f._getFeedsValuesMap(a);for(g in v){var k=v[g];var l=h[g];var m=k.type.toLowerCase();if(c.compatible(c.DIMENSION,m)){var n=f.countDataContainers(l);if(n<k.min){return false;}}}return true;};f.removeMND=function(a){if(!a){return a;}var g=[];for(var i=0;i<a.length;i++){if(a[i]){var h=a[i].clone();var v=h.values();if(v){for(var j=0;j<v.length;j++){var k=v[j];if(!k){continue;}if(c.compatible(c.MND,k.type())){v.splice(j,1);j--;}}}}g.push(h);}return g;};f.hasMND=function(a){return f.countAnalyses(a,c.MND)>0;};f.countAnalyses=function(a,t){var n=0;for(var i=0;i<a.length;i++){var g=a[i];var v=g.values();for(var j=0;j<v.length;j++){var h=v[j];if(c.compatible(t,h.type())){n++;}}}return n;};f.convertFeedType=function(a){if(a===b.GEOGRAPHY){return b.DIMENSION;}return a;};f.isGeoHierarchyFeed=function(a,g,h){var l=a?a.toLowerCase():null;var k=g?g.toLowerCase():null;var m=h?h.toLowerCase():null;return l===b.GEOGRAPHY.toLowerCase()&&k===c.HIERARCHY&&m===b.GEOGRAPHY.toLowerCase();};f.feedCompatible=function(a,g,h){var l=a?a.toLowerCase():null;var k=g?g.toLowerCase():null;var m=h?h.toLowerCase():null;if(l===b.DIMENSION.toLowerCase()){return k===c.DIMENSION||k===c.HIERARCHY||k===c.MND;}else if(l===b.SUBTOTAL.toLowerCase()){return k===b.DIMENSION.toLowerCase()}else if(l===b.GEOGRAPHY.toLowerCase()){return(k===c.DIMENSION||k===c.HIERARCHY)&&m===b.GEOGRAPHY.toLowerCase();}else{return l===k;}};f.getManifestFeedsMap=function(t){var v=f.getVizFeeds(t);if(!v){return{};}var a={};for(var i=0;i<v.length;i++){a[v[i].id]=v[i];}return a;};f._getFeedsValuesMap=function(a,m){m=m!==false;var g={};for(var i=0;i<a.length;i++){var h=a[i];var k=h.id();if(m&&(k===f.RowsFeedingName||k===f.ColumnsFeedingName)){k='multiplier';}if(!g[k]){g[k]=h.values();}else{g[k]=g[k].concat(h.values());}}return g;};f.countDataContainers=function(v){if(!v){return 0;}var n=0,g=0,h=0;for(var i=0;i<v.length;i++){var a=v[i];if(c.compatible(c.MEASURE,a.type())){n++;}else{if(c.compatible(c.MND,a.type())){h++;}else if(c.compatible(c.DIMENSION,a.type())){g++;}}}return n+Math.min(1,g)+Math.min(1,h);};f.countAAOfFeeds=function(a){var n=0;var g=0;for(var i=0;i<a.length;i++){var h=a[i];if(h.type()===b.DIMENSION&&f.countAAOfFeedItem(h)){if(h.id()===f.RowsFeedingName||h.id()===f.ColumnsFeedingName){g=Math.min(1,g+1);}else{n++;}}}return(g+n);};f.countAAOfValues=function(v){if(!v||!v.length){return 0;}var h=f.hasMNDInValues(v);if(h&&v.length===1){return 0;}return 1;};f.countAAOfFeedItem=function(a){if(!a||!a.hasValues()){return 0;}var v=a.values();return f.countAAOfValues(v);};f.hasMNDInValues=function(v){return(f.indexOfMNDInValues(v)!==-1);};f.indexOfMNDInValues=function(v){if(!v||!v.length){return-1;}var a=-1;for(var i=0;i<v.length;i++){var g=v[i];if(g.type()===c.MND){a=i;break;}}return a;};f._getCapacityOfFeedDef=function(a){var g=0;if(a.type===b.DIMENSION){if(a.id===f.RowsFeedingName||a.id===f.ColumnsFeedingName||a.id===f.MultiplierFeedingName){g=f.trillisFeeds.row.maxStacked;}else{g=a.maxStackedDims?a.maxStackedDims:Number.MAX_VALUE;}}else{g=a.max=='Infinity'?Number.MAX_VALUE:a.max;}return g;};f._getMNDfeed=function(a,g){if(!g)return;var m={priority:-1};for(var i in a){var h=a[i];var I=h.id;var k=U.isNumber(h.acceptMND)?Number(h.acceptMND):-1;var l=false;for(var j=0;j<g.length;j++){if(g[j].id()==I){var n=g[j].values().length;if(n<h.min){if(k>m.priority){m={feedId:I,priority:h.acceptMND};}}l=true;}}if(!l){if(h.min>0&&k>m.priority){m={feedId:I,priority:h.acceptMND};}}}return m.feedId;};f.canAddValue=function(a,s,g,h,k,l){var m=U.clone(g);if(!l){l=s;}if(m[f.MultiplierFeedingName]){m[f.MultiplierFeedingName].min=0;}if(m[f.RowsFeedingName]){m[f.RowsFeedingName].min=0;}if(m[f.ColumnsFeedingName]){m[f.ColumnsFeedingName].min=0;}var n=m[l];if(!n){return false;}var o=f._toMap(a);var p=o[s]?o[s].item:null;var v=p?p.values():[];if(s===f.RowsFeedingName||s===f.ColumnsFeedingName){v=f.getRowAndColumnValues(a);}var q=f._getMNDfeed(m,a);var t=0;var w=0;for(var i=0;i<a.length;i++){var x=a[i];if(x.type()==b.DIMENSION){var y=x.values();for(var j=0;j<y.length;j++){var z=y[j];if(z.type()!='mnd'){t++;if(x.id()===f.RowsFeedingName||x.id()===f.ColumnsFeedingName){w++;}break;}}}}var D;for(var i=0;i<a.length;i++){var x=a[i];if(x.type()==b.DIMENSION){var y=x.values();for(var j=0;j<y.length;j++){var z=y[j];if(z.type()=='mnd'){D=x.id();break;}}}}if(k&&D!=q&&s!=q){t++;}else if(!k&&D&&q&&D!=q&&s!=q){t++;}if(w>0){t-=w-1;}if((s===f.RowsFeedingName||s===f.ColumnsFeedingName)&&w>0){t--;}var E;if(k){E=f.canAcceptMND(n.acceptMND)&&(t<=f.MaxDemensionFeedsCount);}else{E=f._canAddValueAtAALimitaion(a,v,l,m);if(v.length==0||(v.length==1&&v[0].id()==c.MND)){E=E&&(t<=f.MaxDemensionFeedsCount-1);}}if(E){var G=n.max;E=f._canAddValueAtDataContainerLimitaion(v,G,h,k);if(E){var H=f._getCapacityOfFeedDef(n);E=f._canAddValueAtCapacityLimitaion(p,H,h);}}return E;};f._canAddValueAtAALimitaion=function(a,v,g,h){var k=f.countAAOfFeeds(a);var l=(k<=f.MaxDemensionFeedsCount);if(l){var m=f.countAAOfValues(v);if(m===0){var n=0;var o=a.reduce(function(q,s){var t=s.id();var w=t===f.RowsFeedingName||t===f.ColumnsFeedingName;var x=h[t];if(!x&&w){x=h[f.MultiplierFeedingName];}if(x&&t!==g&&x.type===b.DIMENSION&&x.min>0&&!s.values().length){if(w){n++;}return q+1;}return q;},0);if(n>1){o-=n-1;}var p=k+o+1;if(p>f.MaxDemensionFeedsCount){l=false;}}}return l;};f._canAddValueAtDataContainerLimitaion=function(v,m,a,g){var n=f.countDataContainers(v);if(n>m){return false;}var h=(m>0&&(n<=m));if(h&&n===m){var k=f.hasMNDInValues(v);if(g){if(!k){if(n===1){h=false;}else if(n===2){}}else{h=false;}}else{if(!k){if(n===1){h=true;}else if(n===2){}}else{if(n===1){if(a){h=false;}else{h=true;}}else if(n===2){h=true;}}}}return h;};f._canAddValueAtCapacityLimitaion=function(a,g,h){var v=a?a.values().length:0;if(v&&!h&&f.hasMNDInValues(a.values())){v--;}return(v<g);};f.canAcceptMND=function(a){a=U.isNumber(a)?Number(a):-1;return(a>=0);};f.supportMultiChart=function(a,g){if(!a){return true;}var i;var h;var k;var n;var l;for(i=0;i<a.length;i++){h=a[i];k=h.id();if(k===f.RowsFeedingName||k===f.ColumnsFeedingName){l=g[f.MultiplierFeedingName];}else{l=g[k];}n=f.countDataContainers(h.values());if(l&&n>l.max){return false;}}return true;};f.getRowAndColumnValues=function(a){if(!a){return null;}var i;var g;var h;var n;var k=[];for(i=0;i<a.length;i++){g=a[i];h=g.id();if(h===f.RowsFeedingName||h===f.ColumnsFeedingName){k=k.concat(g.values());}}return k;};f.match=function(t,a,s){if(!s&&e.supportMultiChart(t)){var g=e.toSingleChartType(t);var m=e.toMultiChartType(t);return f.match(g,a,true)||f.match(m,a,true);}else{var v=f.getManifestFeedsMap(t);var h=f._getFeedsValuesMap(a);var k;for(k in h){if(h.hasOwnProperty(k)){var l=v[k];if(!l){return false;}}}return true;}};f.buildEmptyFeeds=function(v){var a=[];var t=f.getVizFeeds(v);if(t){for(var i=0;i<t.length;i++){var g=t[i];if(g.id===f.MultiplierFeedingName){a.push(new F(f.RowsFeedingName,g.type,[]));a.push(new F(f.ColumnsFeedingName,g.type,[]));}else{a.push(new F(g.id,g.type,[]));}}}else{}return a;};f.merge=function(h,a){var g=f._getFeedsValuesMap(a,false);for(var i=0;i<h.length;i++){var k=h[i];if(g[k.id()]){k.values(k.values().concat(g[k.id()]));}}return h;};f.getFeed=function(a,g){for(var i=0;i<a.length;i++){var h=a[i];if(h.id()===g){return h;}}return null;};f.supportMND=function(t){var v=f.getVizFeeds(t);for(var i=0;i<v.length;i++){var a=v[i].acceptMND;if(f.canAcceptMND(a)){return true;}}return false;};f.getColumnFeeding=function(a){var g=null;for(var i=0;i<a.length;i++){var h=a[i].id();if(h===f.trillisFeeds.column.id){g=a[i];}}return g;};return f;});u('sap/viz/controls/common/feeds/AutoFeedingUtils',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/valueobjects/Shelf','sap/viz/controls/common/feeds/valueobjects/ShelfType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil'],function(C,F,a,b,L,S,c,U,V,d,e){var f={};f.getInitialShelves=function(t){var g={"measure":[],"attribute":[],"subtotal":[],"trellis":[]};var h=f.getFeedDefsMap(t);if(h){var m=h.measure;var k=f._getSortedIds(m,false);var l;var n;for(var i=0;i<k.length;i++){l=k[i];n=m[l];g["measure"].push(f._getShelfByFeedDef(n,c.MEASURE,t));}var o=h.dimension;var p=f._getSortedIds(o,true);for(var j=0;j<p.length;j++){l=p[j];n=o[l];if(l===d.RowsFeedingName||l===d.ColumnsFeedingName){g["trellis"].push(f._getShelfByFeedDef(n,c.TRELLIS));}else{g["attribute"].push(f._getShelfByFeedDef(n,c.ATTRIBUTE,t));}}var q=h.subtotal;var r=f._getSortedIds(q,false);for(var i=0;i<r.length;i++){l=r[i];n=q[l];g["subtotal"].push(f._getShelfByFeedDef(n,c.SUBTOTAL,t));}if(!e.isMultipleChart(t)&&e.supportMultiChart(t)){g["trellis"].push(f._getShelfByFeedDef(d.trillisFeeds.row,c.TRELLIS));g["trellis"].push(f._getShelfByFeedDef(d.trillisFeeds.column,c.TRELLIS));}}return g;};f._getShelfByFeedDef=function(g,h,t){var v=e.isMultipleChart(t)?e.toSingleChartType(t):t;var k=new S();k.id=g.id;k.type=h;if(k.id===C.FEEDING_PRIMARY_VALUES){var l=V.getValueAxis(v);if(!l){if(v===C.TYPE_3D_BAR){k.name=L.get(s[k.id][1]);}else{k.name=L.get(s[k.id][0]);}}else{if(l.length===1){if(l[0]===C.AXIS_YAXIS){k.name=L.get(s[k.id][0]);}else{k.name=L.get(s[k.id][1]);}}else{for(var i=0;i<l.length;i++){if(l[i]===C.AXIS_YAXIS2){k.name=L.get(s[k.id][2]);break;}else if(l[i]===C.AXIS_XAXIS2){k.name=L.get(s[k.id][3]);break;}else{k.name=L.get(s[k.id][1]);}}}}}else if(k.id===C.FEEDING_SECONDARY_VALUES){var l=V.getValueAxis(v);if(!!l){for(var i=0;i<l.length;i++){if(l[i]===C.AXIS_YAXIS2){k.name=L.get(s[k.id][0]);break;}else if(l[i]===C.AXIS_XAXIS2){k.name=L.get(s[k.id][2]);break;}else{k.name=L.get(s[k.id][1]);}}}}else if(k.id===C.FEEDING_AXIS_LABELS){var m=V.getCategoryAxis(v);if(!m){if(v===C.TYPE_3D_BAR){k.name=L.get(s[k.id][1]);}else{k.name=L.get(s[k.id][0]);}}else{if(m[0]===C.AXIS_XAXIS){k.name=L.get(s[k.id][0]);}else{k.name=L.get(s[k.id][1]);}}}else{k.name=L.get(s[k.id]);}if(!k.name){k.name=g.name;}k.analysisType=g.type.toLowerCase();k.feedItemType=k.id===d.geoFeeds.id?a.GEOGRAPHY:g.type;k.capacity=g.maxStacked;return k;};f.smartFeeding=function(g,h,k,l){return f._autoFeedItems(f._STRATEGY_SMART,g,h,k,l);};f.directFeeding=function(g,h,k){return f._autoFeedItems(f._STRATEGY_DIRECT,g,h,k);};f._STRATEGY_SMART='smart';f._STRATEGY_DIRECT='direct';f._autoFeedItems=function(g,h,t,k,l){h=d.cloneFeeds(h);var m=f.getFeedDefsMap(t);var p=f._prepareData(h);if(!m||!p){return h;}var n={'measure':[],'dimension':[],'subtotal':[]};k=k||[];for(var i=0;i<k.length;i++){var o=k[i];if(b.compatible(b.MEASURE,o.type())){n.measure.push(o);}else{if(b.compatible(b.DIMENSION,o.type())){n.dimension.push(o);}}}if(l){f._addFeedingScope(m.measure,l);f._addFeedingScope(m.dimension,l);}var q=f._mapFeedsProcess(g,p.measure,m.measure,false,n.measure);if(t==="viz/ext/table"&&p.dimension!==undefined&&p.dimension.length>=2&&p.dimension[0].id()==="regionColor"&&p.dimension[1].id()!=="regionShape"){var r=p.dimension[0];p.dimension[0]=p.dimension[1];p.dimension[1]=r;}var v=f._mapFeedsProcess(g,p.dimension,m.dimension,true,n.dimension);var w=f._mapFeedsProcess(g,p.subtotal,m.subtotal,false,n.subtotal);for(var i=0;i<v.length;i++){var x=v[i];var y=x.values();for(var j=0;j<y.length;j++){var z=y[j];if(z.aggregationType()){y.splice(j,1);}}}var D=q.concat(v);D=D.concat(w);return D;};f._addFeedingScope=function(g,h){if(h){for(var k in g){if(h.indexOf(k)===-1){g[k].outOfFeedingScope=true;}}}};f.needAutoFeeding=function(g,h,t){var n=true;if(!t||h===t||(!g)){n=false;}return n;};f.getFeedDefsMap=function(v){var m={'measure':{},'dimension':{},'subtotal':{}};var t=d.getVizFeeds(v);if(t){for(var i=0;i<t.length;i++){var g=t[i];if(g.type===a.MEASURE){m.measure[g.id]=f._addMinAndMaxStackedToFeedDef(g);}else if(g.type===a.DIMENSION){if(g.id===d.MultiplierFeedingName){var r=U.clone(g);r.id=d.RowsFeedingName;m.dimension[d.RowsFeedingName]=f._addMinAndMaxStackedToFeedDef(r,true);var h=U.clone(g);h.id=d.ColumnsFeedingName;m.dimension[d.ColumnsFeedingName]=f._addMinAndMaxStackedToFeedDef(h,true);}else{m.dimension[g.id]=f._addMinAndMaxStackedToFeedDef(g,true);}}else if(g.type===a.SUBTOTAL){m.subtotal[g.id]=f._addMinAndMaxStackedToFeedDef(g);}}}else{return null;}return m;};f._addMinAndMaxStackedToFeedDef=function(g,h){var r=U.clone(g);if(h){if(g.id===d.RowsFeedingName){r.minStacked=d.trillisFeeds.row.minStacked;r.maxStacked=d.trillisFeeds.row.maxStacked;}else if(g.id===d.ColumnsFeedingName){r.minStacked=d.trillisFeeds.column.minStacked;r.maxStacked=d.trillisFeeds.column.maxStacked;}else{var m=0;if(g.min){m=g.minStackedDims?g.minStackedDims:g.min;}r.minStacked=m;var k=g.maxStackedDims?g.maxStackedDims:Number.MAX_VALUE;r.maxStacked=k;}}else{r.minStacked=g.min;r.maxStacked=g.max=='Infinity'?Number.MAX_VALUE:g.max;}return r;};f._prepareData=function(g){var M=[];var D=[];var h=[];if(g.length>0){for(var i=0;i<g.length;i++){var k=g[i];if(k._id===a.ROW_SUBTOTALS){h.push(k);}if(k.type()===a.MEASURE){M.push(k);}else if(k.type()===a.DIMENSION){D.push(k);}}}return{'measure':M,'dimension':D,'subtotal':h};};f._mapFeedsProcess=function(g,h,k,l,p){var r=f._idMapping(h,k);var t=r.feeds;p=r.pool.concat(p||[]);var m=f._getSortedIds(k,l,true);if(l){var n=d.indexOfMNDInValues(p);if(n!==-1){var o=p[n];p.splice(n,1);f._autoFeedMNDValue(m,k,t,o);}if(g===f._STRATEGY_SMART){f._feedGeographyFeedItem(m,k,t,p);}}m.forEach(function(y){t[y]=t[y]||new F(y,k[y].type,[]);});var q=f._precalFeedItemValuesSize(g,m,k,t,p.length,l);var v=f._getSortedIds(k,l);var w=f._locateValuestoFeeds(v,k,t,p,q);var x=f._convertToFeeds(v,w);return x;};f._idMapping=function(g,h){var t={};var p=[];var m;var r=d.getRowAndColumnValues(g);for(var i=0;i<g.length;i++){var k=g[i];var l=k.id();var v=k.values();v=v?v:[];var n=f._getIdByShelfName(l,h);if(n){if(h[n].outOfFeedingScope){t[n]=k;continue;}var o=h[n].maxStacked;var q=d.canAcceptMND(h[n].acceptMND);var w=d.indexOfMNDInValues(v);var x=false;if(!q){x=true;}else{if(w>o){x=true;}else{var y=h[n].max;var z;var D=-1;if(l===d.RowsFeedingName||l===d.ColumnsFeedingName){z=d.countDataContainers(r);D=d.indexOfMNDInValues(r);}else{z=d.countDataContainers(v);}if(z>y){if(l===d.RowsFeedingName||l===d.ColumnsFeedingName){if(D===0){if(w===0){o=1;}else if(w===-1){o=0;}}else{x=true;if(w!==-1&&D!==-1){r.splice(D,1);;}}}else{if(w===0){o=1;}else{x=true;}}}}}if(x&&w!==-1){m=v[w];v.splice(w,1);f._pushFeedItemValuesToPool([m],p);}if(o<v.length){var E=v.slice(o,v.length);f._pushFeedItemValuesToPool(E,p);var G=v.slice(0,o);var H=new F(n,k.type(),G);t[n]=H;}else{t[n]=new F(n,k.type(),v);}}else{f._pushFeedItemValuesToPool(v,p);}}return{'feeds':t,'pool':p};};f._autoFeedMNDValue=function(g,h,k,m){var l=-1;var n;var o=f._convertToFeeds(g,k);for(var i=0;i<g.length;i++){var p=g[i];var q=h[p];var r=true;var t=true;var v=d.canAddValue(o,p,h,r,t);if(v){var w=q.acceptMND;var x=k[p];var y=x?x.values():null;var z=d.countDataContainers(y);var D=h[p].min;if(z<D){w+=10;}if(w>l){l=w;n=p;}}}if(n){var x=k[n];var q=h[n];var y=x?x.values():[];y.push(m);k[n]=new F(q.id,q.type,y);}};f._feedGeographyFeedItem=function(g,h,k,p){var l=h[d.geoFeeds.id];if(!l){return;}var m=k[d.geoFeeds.id];if(!m){m=new F(d.geoFeeds.id,l.type,[]);}var v=m.values();if(v.length>0){return;}var _=function(x){var y=-1;for(var i=0;i<x.length;i++){var z=x[i];if(z.dataType()&&z.dataType().toLowerCase()===a.GEOGRAPHY.toLowerCase()){y=i;break;}}return y;};var n;var o=_(p);if(o!==-1){n=p[o];p.splice(o,1);}else{var q,r,t,w;for(var i=0;i<g.length;i++){q=g[i];r=h[q];t=k[q];if(q===d.geoFeeds.id||!t){continue;}w=t.values();if(w.length>1&&w.length>r.minStacked){o=_(w);if(o!==-1){n=w[o];w.splice(o,1);break;}}}}if(n){v.push(n);k[d.geoFeeds.id]=m;}};f._getIdByShelfName=function(g,h){if(h[g]){return g;}var k=s[g];for(var l in h){if(h.hasOwnProperty(l)){var m=h[l];var t=s[l];if(k===t){return l;}}}return null;};f._locateValuestoFeeds=function(g,h,k,p,l){var i,m,n,v,o;for(i=0;i<g.length;i++){m=g[i];n=k[m];if(n){v=n.values();o=l[m];if(v.length>o){var q=d.indexOfMNDInValues(v);if(q!==-1&&q>=o){var r=v[q];v.splice(q,1);v.splice(o-1,0,r);}var t=v.slice(o,v.length);f._pushFeedItemValuesToPool(t,p);}}}for(i=0;i<g.length;i++){m=g[i];n=k[m];if(!n){n=new F(m,h[m].type,[]);k[m]=n;}var w=false;o=l[m];v=n.values();if(o<v.length){w=true;v=v.slice(0,o);}else if(o>v.length&&p.length>0){w=true;var x=[];var y=false;if(v.length>1&&v[v.length-1].type()===b.MND){y=true;}while(p.length>0&&o>v.length){var z=p.shift();if(!d.feedHasValue(z,n)){if(y){v.splice(v.length-1,0,z);}else{v.push(z);}}else{x.push(z);}}if(x.length>0){p=p.concat(x);}}if(w){k[m]=new F(m,h[m].type,v);}}return k;};f._pushFeedItemValuesToPool=function(g,p){for(var i=0;i<g.length;i++){var h=g[i];p.push(h);}};f._precalFeedItemValuesSize=function(g,h,k,l,p,m){var n=f._initializeId2Size(h,l);var o;if(m){o=f._getFeedsStatus(h,k,l);}var q=f._getNeedToFillFeedsId(h,n,k);var r=!q.length;var t=0;var v;var i;var w;var x;var y;var z;if(!r&&p>0){v=true;for(i=0;i<q.length;i++){t=i;w=q[i];if(m&&!o[w]){continue;}x=n[w];y=k[w].minStacked;z=y-x;if(p<z){z=p;v=false;}n[w]=x+z;p-=z;if(!p){break;}}r=v&&(t==q.length-1);}else if(!r){if(g===f._STRATEGY_SMART){var D=f._getOverMinFeedsId(h,n,k);if(D.length>0){v=true;var E=[];var G=0;var H;for(i=0;i<D.length;i++){H=D[i];var I=n[H];var J=k[H].minStacked;var K=I-J;E[H]=K;G+=K;}var M=t;for(i=t;i<q.length;i++){M=i;w=q[i];if(m&&!o[w]){continue;}x=n[w];y=k[w].minStacked;z=y-x;var N=z;for(var O in E){if(E.hasOwnProperty(O)){var K=E[O];if(K<N){N-=K;n[H]-=K;}else{E[H]-=N;n[H]-=N;N=0;break;}}}if(N>0){z-=N;v=false;}n[w]=x+z;G-=z;if(!G){break;}}r=v&&(M==q.length-1);}}return n;}if(r&&p>0){var P=f._getEmptyFeedsId(h,n);for(i=0;i<P.length;i++){w=P[i];if(m&&!o[w]){continue;}p--;n[w]=1;if(!p){if(i<P.length){r=false;}break;}}}if(r&&p>0){var Q=f._getNotFullFeedsId(h,n,k);for(i=0;i<Q.length;i++){w=Q[i];if(m&&!o[w]){continue;}x=n[w];var R=k[w].maxStacked;z=R-x;if(p<z){z=p;}n[w]=x+z;p-=z;if(!p){break;}}}return n;};f._convertToFeeds=function(g,h){var t=[];for(var i=0;i<g.length;i++){var k=g[i];var l=h[k];if(l){t.push(l);}}return t;};f._getSortedIds=function(g,h,k){var l=[];var m=[];for(var n in g){var o=g[n];var p=h?o.aaIndex:o.mgIndex;if(n===d.RowsFeedingName||n===d.ColumnsFeedingName){p=1000+o.aaIndex;}m.push({id:n,priority:p});};m.sort(function(r,t){return r.priority-t.priority;});for(var i=0;i<m.length;i++){var q=m[i].id;if(k&&g[q].outOfFeedingScope){continue;}l.push(q);};return l;};f._initializeId2Size=function(g,h){var k={};for(var i=0;i<g.length;i++){var l=g[i];if(l===a.ROW_SUBTOTALS||l===a.COLUMNS_SUBTOTALS){continue;}var m=0;var n=h[l];if(n){m=n.values().length;}k[l]=m;}return k;};f._getNeedToFillFeedsId=function(g,h,k){var l=[];for(var i=0;i<g.length;i++){var m=g[i];var n=k[m];var o=n.minStacked;var p=h[m];if(p<o){l.push(m);}}return l;};f._getNotFullFeedsId=function(g,h,k){var l=[];for(var i=0;i<g.length;i++){var m=g[i];var n=k[m];var o=n.maxStacked;var p=h[m];if(p<o){l.push(m);}}return l;};f._getOverMinFeedsId=function(g,h,k){var l=[];for(var i=0;i<g.length;i++){var m=g[i];var n=k[m];var o=n.minStacked;var p=h[m];if(p>1&&p>o){l.push(m);}}return l;};f._getEmptyFeedsId=function(g,h){var k=[];for(var i=0;i<g.length;i++){var l=g[i];var m=h[l];if(m===0){k.push(l);}}return k;};f._getFeedsStatus=function(g,h,k){var l={};var m;var _=function(z){var D=0;if(z===d.RowsFeedingName||z===d.ColumnsFeedingName){if(m!==undefined){var E=k[d.RowsFeedingName]?k[d.RowsFeedingName].item:null;var G=k[d.ColumnsFeedingName]?k[d.ColumnsFeedingName].item:null;var H=E?E.values():[];var I=G?G.values():[];var J=H.concat(I);D=d.countAAOfValues(J);m=D;}else{D=m;}}else{var K=k[z];D=d.countAAOfFeedItem(K);}return D;};var n=f._getSortedIds(h,true);var o=f._convertToFeeds(n,k);var p=d.countAAOfFeeds(o);var q=(p<=d.MaxDemensionFeedsCount);var r=true;var t=false;for(var i=0;i<g.length;i++){var v=false;if(q){var w=g[i];if(w===d.geoFeeds.id){l[w]=false;continue;}var x=h[w];v=d.canAddValue(o,w,h,r,t);if(v){var y=_(w);if(y===0){p++;if(p>d.MaxDemensionFeedsCount){v=false;p--;}else if(w===d.RowsFeedingName){p--;}}q=(p<=d.MaxDemensionFeedsCount);}}l[w]=v;}return l;};var s={"primaryValues":['VIZ_COMMON_YAXIS','VIZ_COMMON_XAXIS','VIZ_COMMON_PRIMARY_YAXIS','VIZ_COMMON_PRIMARY_XAXIS'],"secondaryValues":['VIZ_COMMON_SECONDARY_YAXIS','VIZ_COMMON_YAXIS','VIZ_COMMON_SECONDARY_XAXIS'],"pieSectorSize":'VIZ_COMMON_PIE_SECTORS',"pieDepthSize":'VIZ_COMMON_PIE_DEPTH',"featureValues":'VIZ_COMMON_FEATUREVALUES',"bubbleWidth":'VIZ_COMMON_BUBBLE_WIDTH',"bubbleHeight":'VIZ_COMMON_BUBBLE_HEIGHT',"rectangleColor":'VIZ_COMMON_RECTANGLECOLOR',"rectangleWeight":'VIZ_COMMON_RECTANGLEWEIGHT',"regionColor":'VIZ_COMMON_REGIONCOLOR',"axisLabels":['VIZ_COMMON_XAXIS','VIZ_COMMON_YAXIS'],"pieSectorColor":'VIZ_COMMON_REGIONCOLOR',"geoFeatures":'VIZ_COMMON_GEO_FEATURES',"featureAnalysis":'VIZ_COMMON_FEATUREANALYSIS',"regionShape":'VIZ_COMMON_REGIONSHAPE',"rectangleTitle":'VIZ_COMMON_AREANAME',"mainLabelAxis":'VIZ_COMMON_AREANAME',"secondaryLabelAxis":'VIZ_COMMON_SECONDARY_AREANAME',"radarAxesValues":'VIZ_COMMON_YAXIS',"radarAxes":'VIZ_COMMON_RADAR_AXES',"tagWeight":'VIZ_COMMON_TAGWEIGHT',"tagFamily":'VIZ_COMMON_TAGFAMILY',"tagName":'VIZ_COMMON_TAGNAME',"multiplier.column":'VIZ_COMMON_COLUMNS',"multiplier.row":'VIZ_COMMON_ROWS',"treeNode":'VIZ_COMMON_TREENODE',"link":'VIZ_COMMON_LINK',"rows":'VIZ_COMMON_TABLE_DIMENSION',"values":'VIZ_COMMON_TABLE_MEASURE',"r_subtotals":'VIZ_COMMON_TABLE_ROWS_SUBTOTALS',"cols":'VIZ_COMMON_TABLE_COLUMNS_AXIS',"c_subtotals":'VIZ_COMMON_TABLE_COLUMNS_SUBTOTALS'};return f;});u('sap/viz/controls/common/filter/AbstractFilter',[],function(){var a=function(t,o,b){this.__className="sap.viz.controls.common.filter.AbstractFilter";this.filterType=t;this.filteredObjectId=o;this.filteredObjectName=b;this.isReverse=true;this._isGlobalFilter=false;};a.VALUE_TYPE="VALUE_FILTER_TYPE";a.NUMERIC_RANGE_TYPE="NUMERIC_RANGE_TYPE";a.DATE_RANGE_TYPE="DATE_RANGE_TYPE";a.prototype.getType=function(){return this.filterType;};a.prototype.getFilteredObjectId=function(){return this.filteredObjectId;};a.prototype.getFilteredObjectName=function(){return this.filteredObjectName;};a.prototype.setReverseSelection=function(r){this.isReverse=r;};a.prototype.isReverseSelection=function(){return this.isReverse;};a.prototype.isEmpty=function(){return false;};a.prototype.toJSON=function(){var b={};b.filteredObjectId=this.filteredObjectId;b.filteredObjectName=this.filteredObjectName;b.filterType=this.filterType;b.isReverse=this.isReverse;b.isGlobalFilter=this._isGlobalFilter;return b;};a.prototype.analysisObjectId=function(){return this.getFilteredObjectId();};a.prototype.id=function(){return this.getFilteredObjectId();};a.prototype.filterName=function(){return this.getFilteredObjectName();};a.prototype.isExcluded=function(b){if(arguments.length>0){this.isReverse=!b;}else{return!this.isReverse;}};a.prototype.isGlobalFilter=function(b){if(arguments.length>0){this._isGlobalFilter=b;return this;}else{return this._isGlobalFilter;}};a.prototype.filterTitle=function(){return this.filteredObjectName;};a.prototype.filterContent=function(){return this.filteredObjectName;};return a;});u('sap/viz/controls/common/utils/OOUtil',[],function(){var a;var O={};O.extend=function(s,b){var c=s.prototype;s.superclass=b.prototype;var F=function(){};F.prototype=b.prototype;s.prototype=new F();for(var p in c){if(c.hasOwnProperty(p)){s.prototype[p]=c[p];}}s.prototype.constructor=s;if(b.prototype.constructor==Object.prototype.constructor){b.prototype.constructor=b;}return s;};return O;});u('sap/viz/controls/common/filter/DateRangeFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function(O,a,L){var D=function(o,b){var c=[];c.push(a.DATE_RANGE_TYPE);c.push(o);c.push(b);D.superclass.constructor.apply(this,c);this.__className="sap.viz.controls.common.filter.DateRangeFilter";this.minDate=null;this.maxDate=null;this.excludeNull=false;};O.extend(D,a);D.prototype.isEmpty=function(){if(this.minDate===null&&this.maxDate===null){return true;}return false;};D.prototype.getMin=function(){return this.minDate;};D.prototype.getMax=function(){return this.maxDate;};D.prototype.isExcludeNull=function(){return this.excludeNull;};D.prototype.setMin=function(m){this.minDate=m;};D.prototype.setMax=function(m){this.maxDate=m;};D.prototype.setExcludeNull=function(e){this.excludeNull=e;};D.prototype.toJSON=function(){var b=D.superclass.toJSON.apply(this,arguments);b.minDate=this.minDate;b.maxDate=this.maxDate;b.excludeNull=this.excludeNull;return b;};D.fromJSON=function(f){var b=new D(f.filteredObjectId,f.filteredObjectName);b.setReverseSelection(f.isReverse);b.isGlobalFilter(f.isGlobalFilter);b.minDate=f.minDate;b.maxDate=f.maxDate;b.excludeNull=f.excludeNull;return b;};D.prototype.clone=function(){var b=this.toJSON();return D.fromJSON(b);};D.prototype.filterTitle=function(){return this.filteredObjectName+'('+L.get('VIZ_COMMON_BETWEEN')+')';};D.prototype.filterContent=function(){return'('+this.minDate+'  -  '+this.maxDate+')';};return D;});u('sap/viz/controls/common/filter/NumericRangeFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function(O,a,L){var N=function(o,b){var c=[];c.push(a.NUMERIC_RANGE_TYPE);c.push(o);c.push(b);N.superclass.constructor.apply(this,c);this.__className="sap.viz.controls.common.filter.NumericRangeFilter";this.minValue=null;this.maxValue=null;this.excludeNull=false;};O.extend(N,a);N.prototype.isEmpty=function(){if(this.minValue===null&&this.maxValue===null){return true;}return false;};N.prototype.getMin=function(){return this.minValue;};N.prototype.getMax=function(){return this.maxValue;};N.prototype.isExcludeNull=function(){return this.excludeNull;};N.prototype.setMin=function(m){this.minValue=m;};N.prototype.setMax=function(m){this.maxValue=m;};N.prototype.setExcludeNull=function(e){this.excludeNull=e;};N.prototype.toJSON=function(){var b=N.superclass.toJSON.apply(this,arguments);b.minValue=this.minValue;b.maxValue=this.maxValue;b.excludeNull=this.excludeNull;return b;};N.fromJSON=function(f){var b=new N(f.filteredObjectId,f.filteredObjectName);b.setReverseSelection(f.isReverse);b.isGlobalFilter(f.isGlobalFilter);b.minValue=f.minValue;b.maxValue=f.maxValue;b.excludeNull=f.excludeNull;return b;};N.prototype.clone=function(){var b=this.toJSON();return N.fromJSON(b);};N.prototype.filterTitle=function(){return this.filteredObjectName+'('+L.get('VIZ_COMMON_BETWEEN')+')';};N.prototype.filterContent=function(){return'('+this.minValue+'  -  '+this.maxValue+')';};return N;});u('sap/viz/controls/common/filter/ValueFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter'],function(O,a){var V=function(o,b){V.superclass.constructor.apply(this,[a.VALUE_TYPE,o,b]);this.__className="sap.viz.controls.common.filter.ValueFilter";this.hierarchyLevelId=null;this.filteredValues=[];};O.extend(V,a);V.prototype.getValues=function(){return this.filteredValues;};V.prototype.isEmpty=function(){if(this.filteredValues&&this.filteredValues.length>0){return false;}else{return true;}};V.prototype.removeAllValues=function(){this.filteredValues.length=0;};V.prototype.addValue=function(v){return this.filteredValues.push(v);};V.prototype.removeValue=function(v){for(var i=0;i<this.filteredValues.length;i++){if(this.filteredValues[i].key===v.key&&this.filteredValues[i].value===v.value){this.filteredValues.splice(i,1);}}};V.prototype.toJSON=function(){var b=V.superclass.toJSON.apply(this,arguments);b.filteredValues=this.filteredValues;if(this.hierarchyLevelId){b.hierarchyLevelId=this.hierarchyLevelId;}return b;};V.fromJSON=function(f){var b=new V(f.filteredObjectId,f.filteredObjectName);b.setReverseSelection(f.isReverse);b.isGlobalFilter(f.isGlobalFilter);b.filteredValues=f.filteredValues;if(f.hierarchyLevelId){b.hierarchyLevelId=f.hierarchyLevelId;}return b;};V.prototype.clone=function(){var b=this.toJSON();return V.fromJSON(b);};V.prototype.values=function(){return this.filteredValues;};V.prototype.updateValues=function(v){return this.filteredValues=v;};V.prototype.filterTitle=function(){return this.filteredObjectName+' ('+this.filteredValues.length+')';};V.prototype.filterContent=function(){var v="";for(var i=0,l=this.filteredValues.length;i<l;i++){if(v){v+=", "+this.filteredValues[i].value;}else{v=this.filteredValues[i].value;}}return v;};return V;});u('sap/viz/controls/common/events/EventDispatcher',['sap/viz/controls/common/utils/Utils'],function(a){var E=function(){this.__className="sap.viz.controls.common.events.EventDispatcher";this._enableDispatchEvent=true;};E.prototype.addEventListener=function(t,l,s,p){if(!p){p=0;}var e=this._findEventListener(t,l,s);if(e){return;}e={type:t,scope:s,listener:l,priority:p};var b=this.listeners()[t];if(!b){this.listeners()[t]=b=[e];}else{var c=false;for(var n=0;n<b.length;++n){var d=b[n];if(p>d.priority){b.splice(n,0,e);c=true;break;}}if(c===false){b.push(e);}}};E.prototype.removeEventListener=function(t,l,s){var e=this._findEventListener(t,l,s);if(e){var b=this.listeners()[t];b.splice(b.indexOf(e),1);}};E.prototype.removeEventListeners=function(t){this.listeners()[t]=[];};E.prototype.removeAllEventListeners=function(){this._listeners={};};E.prototype.hasEventListener=function(t,l,s){var e=this._findEventListener(t,l,s);return e!==null;};E.prototype.hasEventListeners=function(t){var l=this.listeners()[t];if(l){return l.length>0;}return false;};E.prototype._dispatchEvent=function(e){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true;}if(this._enableDispatchEvent){var t=e.type();var l=this.listeners()[t];if(l){var c=l.slice(0);for(var n=0;n<c.length;++n){var b=c[n];b.listener.call(b.scope,e);}}}};E.prototype.enableDispatchEvent=function(v){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true;}if(arguments.length>=1){if(a.isBoolean(v)){this._enableDispatchEvent=v;}return this;}else{return this._enableDispatchEvent;}};E.prototype._findEventListener=function(t,l,s){var b=this.listeners()[t];if(!b){return null;}for(var n=0;n<b.length;++n){var e=b[n];if(e.listener===l&&e.scope===s){return e;}}return null;};E.prototype.listeners=function(){if(this._listeners===undefined){this._listeners={};}return this._listeners;};return E;});u('sap/viz/controls/common/UIControl',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/utils/Utils'],function($,O,E,a){var U=function U(d,b){U.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.UIControl";this._dom=d;this._dom$=$(d);this._uiConfig=b;this._uid=a.genUID();};O.extend(U,E);U.prototype.size=function(v){if(arguments.length>0){if(v.width!=null){this._dom$.width(v.width);}if(v.height!=null){this._dom$.height(v.height);}this._validateSize();return this;}else{return{'width':this._dom$.width(),'height':this._dom$.height()};}};U.prototype._validateSize=function(){};U.prototype.visible=function(v){this._dom$.css("visibility",v?"visible":"hidden");return this;};U.prototype.hide=function(){this._dom$.hide();return this;};U.prototype.show=function(){this._dom$.show();return this;};U.prototype.destroy=function(){this._dom$.removeData().off().find('*').removeData().off();this._dom$.empty();this._dom=null;};return U;});u('sap/viz/controls/common/views/drag/DropAction',[],function(){var D={};D.ACCEPT='accept';D.ACCEPT_AS_REPLACEMENT='acceptAsReplacement';D.ACCEPT_AS_COPY='acceptAsCopy';D.DENY='deny';D.AS_TRASH='asTrash';return D;});u('sap/viz/controls/common/views/drag/AnalysisToken',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction'],function($,C,O,a,U,D){var b=function(d,c,e){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.AnalysisToken";this._domHelper$=$(d);this._domDraggable$=$(c);this._fixDragingPosition();this._defaultAction=D.DENY;this.analysisObject=e;this.playDefaultAction();};O.extend(b,U);b.prototype._fixDragingPosition=function(){var d=this._domDraggable$;var c=$.proxy(function(f,g){g.position.top=g.offset.top;g.position.left=g.offset.left;g.helper.trigger('sap.viz.controls.analysisDrag.events.drag',[f.pageX,f.pageY]);},this);var e=$.proxy(function(f,g){o();},this);var o=function(){d.off('drag',c);d.off('dragstop',e);};o();d.on('drag',c);d.on('dragstop',e);};b.prototype.defaultAction=function(v){if(arguments.length>0){this._defaultAction=v;return this;}else{return this._defaultAction;}};b.prototype.killRevertAnimation=function(){var d=this._domDraggable$;if(d){var o=d.draggable('option','revertDuration');d.draggable('option','revertDuration',0);a.defer(function(){try{d.draggable('option','revertDuration',o);}catch(e){}});}};b.prototype.dropTarget=function(v){};b.prototype.currentAction=function(v){if(arguments.length>0){this._domHelper$.data('sap.viz.controls.analysisDrag.action',v);this._domHelper$.trigger('sap.viz.controls.analysisDrag.events.dropAction',[v]);return this;}else{return this._domHelper$.data('sap.viz.controls.analysisDrag.action');}};b.prototype.playDefaultAction=function(){this.currentAction(this._defaultAction);};b.prototype.showWarn=function(w){};return b;});u('sap/viz/controls/common/views/drag/DefaultAnalysisToken',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/AnalysisToken','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/utils/Utils'],function($,C,a,O,U,b,D,c){var d=function(e,f,g){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.DefaultAnalysisToken";this._dom$=$(e);this._icon$=null;this._warn$=null;this._warnspan$=null;this._dropTarget=null;this._createChildren();this._dom$.appendTo(document.body);this.currentAction(this._defaultAction);d._instance=this;};O.extend(d,b);d._ACTION_TO_CLASS=(function(){var m={};var p=C.COMMON_PREFIX;var e=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-'+'icon-dropAccepted';m[D.ACCEPT]=e;m[D.ACCEPT_AS_COPY]=e;e=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-icon-dropAcceptedAsReplacement';m[D.ACCEPT_AS_REPLACEMENT]=e;e=p+'havanaVXTabSprite16 '+p+'analysisDraggingToken-'+'icon-dropDenied';m[D.DENY]=e;e=p+'havanaSharedSprite16 '+p+'analysisDraggingToken-icon-dropAsTrash';m[D.AS_TRASH]=e;return m;})();d.prototype.dropTarget=function(v){if(arguments.length>0){this._dropTarget=v;return this;}else{return this._dropTarget;}};d.prototype.currentAction=function(v){if(this._icon$){if(arguments.length>0){this._icon$.removeClass(d._ACTION_TO_CLASS[D.ACCEPT]);this._icon$.removeClass(d._ACTION_TO_CLASS[D.ACCEPT_AS_COPY]);this._icon$.removeClass(d._ACTION_TO_CLASS[D.ACCEPT_AS_REPLACEMENT]);this._icon$.removeClass(d._ACTION_TO_CLASS[D.DENY]);this._icon$.removeClass(d._ACTION_TO_CLASS[D.AS_TRASH]);this._icon$.addClass(d._ACTION_TO_CLASS[v]);}}return d.superclass.currentAction.apply(this,arguments);};d.prototype.showWarn=function(w){if(w){if(!this._warn$){this._warn$=$(document.createElement('div')).addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn').appendTo(this._dom$);this._warnspan$=$(document.createElement('span')).addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text').appendTo(this._warn$);}this._warnspan$.text(w);this._layoutWarn();this._dom$.bind("mousemove",$.proxy(function(e){this._layoutWarn();},this));}else{if(this._warn$){this._warn$.hide(0);this._dom$.unbind("mousemove");}}};d.prototype._layoutWarn=function(){this._warn$.removeClass(C.COMMON_PREFIX+'analysisDraggingToken-warn');this._warn$.addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn');this._warnspan$.removeClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text');this._warnspan$.addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text');this._warn$.css({'maxWidth':$(window).width()+'px'});var e=this._dom$.outerWidth();var f=this._dom$.outerHeight();var l=this._dom$.offset().left-document.body.scrollLeft;var r=$(window).width()-this._dom$.offset().left-e;var w=false;var m=0;var g=0;var h=e;var k=this._warnspan$.outerWidth();this._warn$.hide(0);if(r>=k){m=-f;g=e;h=k;}else if(l>=k){g=-k;}else if(r>=h){w=true;m=-f;g=e;h=r;}else if(l>=h){w=true;g=-l;k=l;}else{w=true;g=-l;}h=Math.min(h,$(window).width());k=Math.min(k,$(window).width());this._warn$.css({'marginTop':m+'px','marginLeft':g+'px','minWidth':h+'px','maxWidth':k+'px'});if(w){this._warnspan$.css({'whiteSpace':'pre-line'});}this._warn$.show(0);};d.prototype._createChildren=function(){this._dom$.addClass(C.COMMON_PREFIX+'analysisDraggingToken');var n=this.analysisObject.name();if(this.analysisObject.type()===a.HIERARCHY){var s=this.analysisObject.selectedHierarchyLevel();n=s.name();}var e=$(document.createElement('span')).appendTo(this._dom$).text(n);e.addClass(C.COMMON_PREFIX+'text-ellipsis');var f=this._icon$=$(document.createElement('input')).appendTo(this._dom$);f.addClass(C.COMMON_PREFIX+'analysisDraggingToken-icon');};return d;});u('sap/viz/controls/common/managers/DragManager',['jquery','sap/viz/controls/common/views/drag/DefaultAnalysisToken','sap/viz/controls/common/views/drag/AnalysisToken','sap/viz/controls/common/views/drag/DropAction'],function($,D,a,b){var c=function(){this.__className="sap.viz.controls.common.managers.DragManager";};c._instance=null;c.instance=function(){if(!c._instance){c._instance=new c();}return c._instance;};c.enableDraggableFeeding=function(d,e,f){var g=$(d);g.off('dragstart',c._feedingDragStartHandler);g.on('dragstart',c._feedingDragStartHandler);g.addClass(c.DRAGGABLE_CLASS_ANALYSIS);g.data(c._KEY_ANALYSIS,e);g.data(c._KEY_BACKUPAOS,f);};c.disableDraggableFeeding=function(d){var e=$(d);e.off('dragstart',c._feedingDragStartHandler);e.removeClass(c.DRAGGABLE_CLASS_ANALYSIS);e.removeData(c._KEY_ANALYSIS);e.removeData(c._KEY_BACKUPAOS);};c.getDefaultHelper=function(d){var e=$(d);var f=e.data(c._KEY_ANALYSIS);if(!f){return null;}var h=document.createElement('div');var t=new D(h,d,f);var g=e.data(c._KEY_BACKUPAOS);if(g){t.backupAOs=g;}$(h).data(c._KEY_TOKEN,t);return h;};c._feedingDragStartHandler=function(e,d){var f=$(e.currentTarget);d.helper.data(c._KEY_ANALYSIS,f.data(c._KEY_ANALYSIS));d.helper.data(c._KEY_DRAGGABLE,f[0]);};c.DRAGGABLE_CLASS_ANALYSIS='viz-controls-common-analysisDraggable';c._KEY_ANALYSIS='sap.viz.controls.reserved.draggableFeeding.analysisObject';c._KEY_BACKUPAOS='sap.viz.controls.reserved.draggableFeeding.backupAnalysisObjects';c._KEY_TOKEN='sap.viz.controls.reserved.draggableFeeding.analysisToken';c._KEY_DRAGGABLE='sap.viz.controls.reserved.draggableFeeding.domDraggable';c.prototype.getAnalysisToken=function(h){var t=h.data(c._KEY_TOKEN);if(t){return t;}else{var d=h.data(c._KEY_ANALYSIS);if(d){t=new a(h[0],h.data(c._KEY_DRAGGABLE),d);h.data(c._KEY_TOKEN,t);return t;}else{return null;}}};return c;});u('sap/viz/controls/common/utils/DatasetUtil',['sap/viz/controls/common/utils/Utils'],function(U){var D={};D.findAAIndex=function(f,a){for(var i=0;i<a.length;i++){if(a[i].feedId===f){var b=a[i].binding;for(var j=0;j<b.length;j++){var c=b[j];if(c.index!=null){return c.index;}}}}return-1;};D.getValue=function(d,a,b,c,e){var v=null;D._searchDimension(function(f,c,g){v=f.values[e]},d,a,b,c);return v;};D.getInfoValue=function(d,a,b,c,e,f){var g;if(a&&a.length){g=D._getInfoValue(d,a,b,c,e,f);}return g;};D._getInfoValue=function(d,a,b,c,e,f){for(var i=0;i<a.length;i++){var g=a[i];if(g.type!=='additionalData'){continue;}var h=g.info;var k=null;D._searchDimension(function(l,e,m){k=h[m].infoValues[f];},d,b,c,e);return k;}return null;};D._searchDimension=function(c,d,a,b,e){var f=d.analysisAxis;var g=0;for(var i=0;i<f.length;i++){var h=f[i];if(a===h.index){for(var j=0;j<h.data.length;j++){var k=h.data[j];var m=isNaN(e)?k.name===b:e===j;if(m){c(k,j,g);}g++;}}else{g+=h.data.length;}}};D._hasNegativeValue=function(a){var r=false;for(var i=0;i<a.length;i++){if(U.isNumber(a[i])&&a[i]<0){r=true;break;}}return r;};var S={'viz/bubble':['bubbleWidth','bubbleHeight'],'viz/geobubble':['featureValues'],'viz/multi_geobubble':['featureValues'],'viz/multi_bubble':['bubbleWidth','bubbleHeight']};D.hasNegativeMeasureValue=function(c,a){var m=U.clone(S[a]);if(!m||!c){return false;}var d=c.data();if(!d){return false;}var b=d.measureValuesGroup;if(!sap.viz.api.manifest.Viz.get(a)[0]){return;}var f=sap.viz.api.manifest.Viz.get(a)[0].allFeeds(true);var e=[];for(var i=0;i<f.length;i++){if(m.length<=0){break;}for(var j=0;j<m.length;j++){if(f[i].id===m[j]){e.push(f[i].mgIndex);m.splice(j,1);break;}}}for(i=0;i<b.length;i++){var g=b[i];if(!g||!U.isArray(g.data)){continue;}if(e.indexOf(b[i].index)<0){continue;}for(j=0;j<g.data.length;j++){var h=g.data[j];if(!h||!U.isArray(h.values)){continue;}for(var k=0;k<h.values.length;k++){var v=h.values[k];if(!U.isArray(v)){continue;}if(this._hasNegativeValue(v)){return true;}}}}return false;};return D;});u('sap/viz/controls/common/filter/FilterHelper',['jquery','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter'],function($,a,D,b,F,c,d,e,N,V){var f={};f.getMapFilterItems=function(s,g,h,k){if(!s||s.length<1||!k||k.length<1){return h;}var p=[];for(var i=0;i<s.length;++i){var l=s[i].layerIndex;var o=k[l];if(!o||o.length<1){continue;}for(var q in s[i].data){if(!s[i].data.hasOwnProperty(q)){continue;}var r=f._getAnalysisObject(q,o);if(!r){continue;}var t=f.getFilterInfo(r);var v={'value':s[i].data[q]};var w=false;for(var n=0;n<p.length;++n){if(p[n].filterInfo.id===t.id&&p[n].filterInfo.hierarchyLevelId===t.hierarchyLevelId){w=true;p[n].values.push(v);break;}}if(!w){p.push({filterInfo:t,values:[v]});}}}var x=h.slice(0);for(var m=0;m<p.length;m++){var y=f._getFilter(x,p[m].filterInfo.id,p[m].filterInfo.hierarchyLevelId);if(y){x=f._updateFilterItem(x,y,p[m].values,g);}else{x=f._addFilterItem(x,p[m].filterInfo,p[m].values,g);}}return x;};f._getAnalysisObject=function(g,h){for(var i=0;i<h.length;i++){if(h[i].type()!==F.DIMENSION){continue;}var k=h[i].values();for(var j=0;j<k.length;j++){if(k[j].id()===g){return k[j];}}}return null;};f.getFilterInfo=function(g){var n=g.name();var h=g.id();if(g.type()===b.HIERARCHY){var s=g.selectedHierarchyLevel();n=s.name();h=s.analysis().id();return{name:n,id:h,hierarchyLevelId:s.id(),hierarchyInfo:f._buildFilterHierarchyInfo(g)};}return{name:n,id:h};};f._buildFilterHierarchyInfo=function(g){var h=null;if(g.type()===b.HIERARCHY){h={hierarchyId:g.id(),levels:f._buildFilterHierarchyLevels(g.hierarchyLevels())};}return h;};f.getFilterItems=function(s,g,h,k,l,m){if(!s||s.length===0){return h;}var n=l.data();var o=l.info('additionalData');var i;var p=c.cloneFeeds(k);var q=false;for(i=0;i<m.length;i++){if(m[i].feedId===c.MultiplierFeedingName&&m[i].binding.length>0){q=true;break;}}if(q){p=f._getFilterFeeds(p);}var r=[],t=[],v=[];for(i=0;i<p.length;i++){if(p[i].type()!==F.DIMENSION){continue;}var w=D.findAAIndex(p[i].id(),m);var x=p[i].values();var y=0;for(var j=0;j<x.length;j++){r.push(f.getFilterInfo(x[j]));if(x[j].type()===b.MND){t.push(-1);v.push(-1);}else{t.push(w);v.push(y);y++;}}}h=h.slice(0);var z={};for(i=0;i<r.length;i++){var C=r[i];var w=t[i];if(w<0){continue;}if(!z[w]){z[w]=0;}var E=f._pathsIndex(C.hierarchyInfo);var G=f._getAADataLength(n,w);if(E>0&&E<G){z[w]+=E;}var H=f._getFilterValues(n,o,s,w,C.name,v[i]+z[w],C.hierarchyInfo);if(!H||H.length===0){continue;}var I=f._getFilter(h,C.id,C.hierarchyLevelId);if(I){h=f._updateFilterItem(h,I,H,g);}else{h=f._addFilterItem(h,C,H,g);}}return h;};f._getFilterFeeds=function(g){var n;var v=[];for(var i=g.length-1;i>=0;i--){if(g[i].id().indexOf(c.MultiplierFeedingName)===0){v=v.concat(g[i].values().reverse());n=g[i];g.splice(i,1);}}n.values(v.reverse());n._id=c.MultiplierFeedingName;g.push(n);return g;};f._excludeFilterValues=function(g,v){var h=g.values().slice(0);var i,n;if(g.isExcluded()){for(i=0;i<v.length;i++){var k=false;for(n=0;n<h.length;n++){if(f._filterValueEquals(v[i],h[n])){k=true;break;}}if(!k){h.push(v[i]);}}}else{for(i=0;i<v.length;i++){for(n=0;n<h.length;n++){if(f._filterValueEquals(v[i],h[n])){h.splice(n,1);break;}}}}g.updateValues(h);};f._updateFilterItem=function(g,h,v,k){if(k){f._excludeFilterValues(h,v);}else{h.isExcluded(k);h.updateValues(v);}if(h.isEmpty()){var l=g.indexOf(h);g.splice(l,1);}return g;};f._getFilterValues=function(g,h,s,k,l,m,n){var v=[];for(var i in s){var o=s[i];var p=o.ctx[0]['dii_a'+k];var q=D.getValue(g,k,l,m,p);if(!q){continue;}var r=D.getInfoValue(g,h,k,l,m,p);var t;t={'value':q,'infoValue':r};if(!f._isValueExisted(v,t)){v.push(t);}}return v;};f._getAADataLength=function(g,h){var l=0;var r=g;var k=h-1;if(r&&r.analysisAxis&&r.analysisAxis[k]){var m=r.analysisAxis[k].data;if(m){l=m.length;}}return l;};f._pathsIndex=function(h){if(h&&h.levels){var l=h.levels;for(var i in l){if(l[i].selected===true){return Number(i);}}}return-1;};f._addFilterItem=function(g,h,v,k){var l=new V(h.id,h.name);l.hierarchyLevelId=h.hierarchyLevelId;l.updateValues(v);l.isExcluded(k);g.push(l);return g;};f._buildFilterHierarchyLevels=function(h){var l=[];if(h&&h.length>0){for(var i in h){var g={id:h[i].id(),name:h[i].name(),selected:h[i].selected()};l.push(g);}}return l;};f._filterValueEquals=function(v,g){if(!v&&!g){return true;}if((!v&&g)||(v&&!g)){return false;}if(v.value!==g.value){return false;}if(v.infoValue===g.infoValue){return true;}if(v.infoValue==null||g.infoValue==null){return true;}if(a.isFunction(v.infoValue.equals)){return v.infoValue.equals(g.infoValue);}else if(v.infoValue.hasOwnProperty('key')){return v.infoValue.key===g.infoValue.key;}else{return true;}};f._isValueExisted=function(g,h){var v=h.value;var k=h.infoValue;var l=false;if(!g||g.length===0){return l;}for(var i=0;i<g.length;i++){if(g[i]){l=f._filterValueEquals(g[i],h);if(l===true){break;}}}return l;};f._getFilter=function(g,h,k){var r=null;for(var i=0;i<g.length;i++){var l=g[i];if(!l.isGlobalFilter()&&l.id()===h&&(l.hierarchyLevelId==k)){r=l;break;}}return r;};f.isFilterItemExisted=function(m,g,h){var k=f._getFilter(m.filterItems(),g,h);if(k){return true;}else{return false;}};f.toJSON=function(g){return a.toJSON(g,function(g){return g.toJSON();});};f.fromJSON=function(g){return a.fromJSON(g,function(g){var h=g.filterType;var k;switch(h){case d.VALUE_TYPE:k=V.fromJSON(g);break;case d.NUMERIC_RANGE_TYPE:k=N.fromJSON(g);break;case d.DATE_RANGE_TYPE:k=e.fromJSON(g);break;}return k;});};return f;});u('sap/viz/controls/services/FakeDataService',['sap/viz/controls/common/utils/FakeDataUtils'],function(F){var a=function(v,r,f){this._createChart(v,r,f);};a.feedItems2feed=function(f){return F.feedItems2feed(f);};a.prototype.getVizType=function(){return this._vizType;};a.prototype.getVizDataset=function(){return this._vizDataset;};a.prototype._createChart=function(v,r,f){this._vizType=v;var b=F.buildFakeData(v,f,r);this._vizDataset=b.dataset;this._vizFeeding=b.feeding;};return a;});u('sap/viz/controls/common/utils/IncompleteGhost',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/services/FakeDataService'],function(C,a,F){var I={};I.getDataset=function(t){if(!sap.viz.api.manifest.Viz.get(t)[0]){var d=new sap.viz.api.data.CrosstableDataset();return d;}else if((!a.isBuildInType(t))&&t!==C.TYPE_PC&&t!==C.TYPE_FUNNEL&&!a.isTable(t)){var f=new F(t,{},[]);var d=new sap.viz.api.data.CrosstableDataset();var b=f.getVizDataset();d.data(b);return d;}else{var b=I._DATA_BY_TYPE[t]?I._DATA_BY_TYPE[t]:I._DATA_COMMON;if(a.isTable(t)){return b;}else{var d=new sap.viz.api.data.CrosstableDataset();d.data(b);return d;}}};I._DATA_COMMON={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9']}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{'index':3,'data':[{'isFake':true,'type':'Measure','name':'Margin','values':[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};I._DATA_BY_TYPE={};I._DATA_BY_TYPE[C.TYPE_NUMBER]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[null]]}]}]};I._DATA_BY_TYPE[C.TYPE_COMBINATION]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9']}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]},{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]}]};I._DATA_BY_TYPE[C.TYPE_GEO_BUBBLE]=I._DATA_BY_TYPE[C.TYPE_GEO_CHOROPLETH]=I._DATA_BY_TYPE[C.TYPE_GEO_PIE]=I._DATA_BY_TYPE[C.TYPE_GEO_MAP]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Region','values':['United Kingdom','Italy','United States','New Zealand','Germany','China','Russia','Canada','Brazil'],'infos':[{'featureId':'UK,NAVTEQ','latLong':undefined},{'featureId':'20110484,NAVTEQ','latLong':undefined},{'featureId':'21000001,NAVTEQ','latLong':undefined},{'featureId':'23060936,NAVTEQ','latLong':undefined},{'featureId':'20147700,NAVTEQ','latLong':undefined},{'featureId':'22928332,NAVTEQ','latLong':undefined},{'featureId':'20485579,NAVTEQ','latLong':undefined},{'featureId':'21041602,NAVTEQ','latLong':undefined},{'featureId':'23028911,NAVTEQ','latLong':undefined}]}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 2','Product 3','Product 4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':'Cost','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{'index':3,'data':[{'isFake':true,'type':'Measure','name':'Margin','values':[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};I._DATA_BY_TYPE[C.TYPE_SCATTER_MATRIX]={"analysisAxis":[{"index":1,"data":[{'isFake':true,'type':'Dimension',"name":"Country","values":["Country 1","Country 1","Country 2","Country 2"]},{'isFake':true,'type':'Dimension',"name":"Product","values":['Product 1','Product 2','Product 3','Product 4']}]}],"measureValuesGroup":[{"index":1,"data":[{'isFake':true,'type':'Measure',"name":"Revenue","values":[[43,31,43,41]]},{'isFake':true,'type':'Measure',"name":"Cost","values":[[252,124,370,170]]}]}]};I._DATA_BY_TYPE[C.TYPE_TREE]=I._DATA_BY_TYPE[C.TYPE_NETWORK]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4','Country 1','Country 2','Country 3','Country 4']},{'isFake':true,'type':'Dimension','name':'Product','values':['Product 1','Product 1','Product 1','Product 1','Product 2','Product 2','Product 2','Product 2','Product 3','Product 3','Product 3','Product 3','Product 4','Product 4','Product 4','Product 4']}]}],'measureValuesGroup':[]};I._DATA_BY_TYPE[C.TYPE_PC]={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':'Country','values':['Country 1','Country 1','Country 1','Country 2','Country 2','Country 3','Country 4','Country 4','Country 4','Country 5','Country 6','Country 7','Country 8','Country 9','Country 9']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':'Revenue','values':[[5.1,4.9,4.7,4.6,5,7,6.4,6.9,5.5,6.5,6.3,5.8,7.1,6.3,6.5]]},{'isFake':true,'type':'Measure','name':'Cost','values':[[3.1,8.9,2.7,6.6,5,5,6.6,6.9,7.5,2.5,2.3,5.8,8.1,1.3,2.5]]}]}]};I._DATA_BY_TYPE[C.TYPE_TABLE]=I._DATA_BY_TYPE[C.TYPE_CROSSTAB]={"isFake":true,"queryResponse":[{"dimAxes":{"rowsDim":{"count":0,"values":[]}},"metadata":{"dictionary":{"rowsDim":[],"measures":[]}},"valueAxes":[],"ranges":{"cellsDim":[{"marksNum":[]}]},"executionStatus":{"status":"ok"}},{"valueAxes":[],"executionStatus":{"status":"ok"}}]};return I;});u('sap/viz/controls/common/utils/Serialization',['sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/managers/LangManager','sap/viz/controls/Version','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/InfoChartUtil'],function(F,a,b,c,d,V,G,I,L,e,f,C,g){var S={};S.TypeConst={FlatTableDataset:'FlatTable',CrosstableDataset:'Crosstable',RawDataset:'JSON'};S.migrate=function(v){var r=d.clone(v);var h;var k=r['version'];if(k==='1.0'){var l=S.migrateVizFrame(r);r={};r['vizFrame']=l;}else{var l=r['vizFrame'];if(l){r['vizFrame']=S.migrateVizFrame(l);}if(r['vizBuilder']){var m=r['vizBuilder']['feedingPanel'];if(m){r['vizBuilder']['feedingPanel']=S.migrateFeedingPanel(m);}}}return r;};S.migrateVizFrame=function(v){var r=d.clone(v);var h=r['version'];if(h==='1.0'){var k={chart:{}};if(r['chart']){var m=r['chart']['vizModel'];if(m){k['chart']['type']=m['vizType'];k['chart']['feedingItems']=m['feedingItems'];k['filterBar']={};k['filterBar']['filterItems']=m['filterItems'];k['contextMenu']={};k['contextMenu']['isMNDVisible']=m['isMNDVisible'];}var l=r['chart']['vizInstance'];if(l){k['chart']['vizInstance']=l;}}var n=r['comments'];if(n){k['annotation']=n;}k['version']=e.VERSION;r=k;}if(r['chart']){var t=r['chart']['type'];var o=r['contextMenu']?r['contextMenu']['isMNDVisible']:null;S._migrateFeeds(r['chart'],t,o);}return r;};S.migrateFeedingPanel=function(v){var r=d.clone(v);var t=r.type;var h=r['mndVisible'];S._migrateFeeds(r,t,h);return r;};S._migrateFeeds=function(v,h,k){if(k===false){var l=S._getFeedsFromInnerControl(v);if(C.isGeo(h)){for(var i=0;i<l.length;i++){l=f.removeMND(l[i]);}}else{l=f.removeMND(l);}S._updateFeedsToInnerControl(v,l);}};S.getFeeds=function(v){var h=null;var k=S._getValue(v,['vizFrame','chart','feedingItems']);var l=S._getValue(v,['vizBuilder','feedingPanel','feedingItems']);var m;if(k){h=k;var n=S._getValue(v,['vizFrame','contextMenu']);if(n){m=n.isMNDVisible;}}else if(l){h=l;var o=S._getValue(v,['vizBuilder','feedingPanel']);if(o){m=o.mndVisible;}}if(h==null){return[];}var p=F.fromJSON(h);if(m===false){p=f.removeMND(p);}return p;};S._getFeedsFromInnerControl=function(v){var h=null;var k=S._getValue(v,['feedingItems']);if(k){h=k;}if(h==null){return[];}var l=F.fromJSON(h);return l;};S.updateFeeds=function(v,h){var k=F.toJSON(h);S._setValue(v,['vizFrame','chart','feedingItems'],k);S._setValue(v,['vizBuilder','feedingPanel','feedingItems'],k);return v;};S._updateFeedsToInnerControl=function(v,h){var k=F.toJSON(h);S._setValue(v,['feedingItems'],k);return v;};S.getFilters=function(v){var h=S._getValue(v,['vizFrame','filterBar','filterItems']);if(h==null){return[];}var k=c.fromJSON(h);return k;};S.updateFilters=function(v,h){var k=c.toJSON(h);S._setValue(v,['vizFrame','filterBar','filterItems'],k);return v;};S.removeDataset=function(v){var h=S._getValue(v,['vizFrame','chart','vizInstance']);if(h){delete h['data'];}return v;};S.emptyDataset=function(v){var h=S._getValue(v,['vizFrame','chart','vizInstance','data']);if(h){S._emptyDataset(h);}var s=S._getValue(v,['vizFrame','playControl','slicedData']);if(s){s.measuresInfo=[];s.slices=[];}return v;};S._emptyDataset=function(h){if(!h){return;}if(h instanceof Array){for(var i=0;i<h.length;i++){S._emptyDataset(h[i]);}}else{var t=h['type'];var k=h['val'];var l={};var m={};if(t===S.TypeConst.CrosstableDataset){l=new sap.viz.api.data.CrosstableDataset();l.data(k);m=l.toJSON({emptyDataset:true}).data;}else if(t===S.TypeConst.FlatTableDataset){l=new sap.viz.api.data.FlatTableDataset(feedData);m=l.toJSON({emptyDataset:true}).data;}else if(t===S.TypeConst.RawDataset){m={};}else{throw L.get('VIZ_COMMON_SERIALIZATION_FAILED')+L.get('VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE');}h['val']=m;}};S.updateDataset=function(v,h){var k=S._getValue(v,['vizFrame','chart','vizInstance']);if(k){k['data']={};if(g.isInfoChart(k.type)&&(h instanceof sap.viz.api.data.CrosstableDataset)){h=g.buildInfoDataset(h);}S._updateDataset(k['data'],h);}return v;};S._updateDataset=function(h,k){if(!h||!k){return;}if(k instanceof Array){for(var i=0;i<k.length;i++){var l=k[i];S._updateDataset(h[i],l);}}else if(k instanceof sap.viz.api.data.CrosstableDataset){h['type']=S.TypeConst.CrosstableDataset;h['val']=k.data();}else if(k instanceof sap.viz.api.data.FlatTableDataset){h['type']=S.TypeConst.FlatTableDataset;h['val']=k.data();}else{h['type']=S.TypeConst.RawDataset;h['val']=k;}};S.convertToVizSerialization=function(v){var h=S._getValue(v,['vizFrame','vizInstance']);if(h){return d.clone(h);}return null;};S.updateProperties=function(v,p){S._setValue(v,['vizFrame','chart','vizInstance','properties'],p);return v;};S.getProperties=function(v){var p=S._getValue(v,['vizFrame','chart','vizInstance','properties']);return p||{};};S.updateAnalysisObjectLabels=function(v,h){if(!h){return v;}var l=S.getFeeds(v)||[];var m=S.getFilters(v)||[];var s=S._getSliceDimension(v);function n(k){var q={};k.forEach(function(z){if(z){q[z.id()]=z;}});return q;}function o(k){var z={};var q=k.slice();while(q.length){var D=q.shift();if(D){var E=D.hierarchyLevels()||[];z[D.id()]={ao:D,hlHash:n(E)};q=q.concat(E.map(function(H){return H._analysis;}));}}return z;}var p=o(h);l.forEach(function(k){var q=k.values();if(q){var z=o(q);for(var D in z){var E=z[D];var r=p[D];if(r){E.ao.name(r.ao.name());for(var w in E.hlHash){var H=E.hlHash[w];var J=r.hlHash[w];if(J){H._name=J.name();}}}}}});m.forEach(function(q){if(q){var z=q.getType();if(z===b.NUMERIC_RANGE_TYPE||z===b.DATE_RANGE_TYPE||(z===b.VALUE_TYPE&&!q.hierarchyLevelId)){var r=p[q.getFilteredObjectId()];if(r){q.filteredObjectName=r.ao.name();}}else if(z===b.VALUE_TYPE&&q.hierarchyLevelId){for(var j=0;j<h.length;j++){var D=h[j].hierarchyLevels();if(D){for(var k=0;k<D.length;k++){var y=D[k];if(y&&y.id()===q.hierarchyLevelId){q.filteredObjectName=y.name();break;}}}}}}});if(s){var r=p[s.id()];if(r){s.name(r.ao.name());var t=n(s.hierarchyLevels()||[]);for(var w in t){var x=t[w];var y=r.hlHash[w];if(y){x._name=y.name();if(x._analysis&&y._analysis&&x._analysis.id()===y._analysis.id()){x._analysis.name(y._analysis.name());}}}}}S.updateFeeds(v,l);S.updateFilters(v,m);S._updateSliceDimension(v,s);return v;};S.defaultIncompletePackage=function(t){var h=G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_CHART);var p;if(t){var k=C.getChartId(t);if(h&&h.hasOwnProperty('specificProperties')){p=d.updateJSON(h.defaultProperties,h.specificProperties[k]);}else{p=h?h.defaultProperties:{};}p=V.convertProperties(p,C.getVizType(t),t);}else{p={};}var l=I.getDataset(t);var m;if(C.isTable(t)){m={type:S.TypeConst.RawDataset,val:l}}else{m={type:S.TypeConst.CrosstableDataset,val:l.data()}}return{vizFrame:{version:e.VERSION,chart:{vizInstance:{data:m,properties:p,type:t},vizTitleMode:"auto"},contextMenu:{}}};};S.updateCustomData=function(v,p){S._setValue(v,['customData'],p);return v;};S.getCustomData=function(v){return S._getValue(v,['customData'])||{};};S.updateControlSettings=function(v,h,s,k){var t=S._getValue(v,['vizFrame','chart','type']);if(C.supportAnimation(t)&&h==='playControl'){if(s==='slicedData'){S._updateSlicedData(v,k);}else if(s==='sliceDimension'){S._updateSliceDimension(v,k);}else if(s==='value'){S._setValue(v,['vizFrame','playControl','value'],k);}}};S.getControlSettings=function(v,h,s){if(h==='playControl'){if(s==='slicedData'){return S._getSlicedData(v);}else if(s==='sliceDimension'){return S._getSliceDimension(v);}if(s==='value'){return S._getValue(v,['vizFrame','playControl','value']);}}else{return null;}};S.getChartType=function(v){return S._getValue(v,['vizFrame','chart','type']);};S.updateCss=function(v,h){S._setValue(v,['vizFrame','chart','vizInstance','css'],h);return v;};S._updateSliceDimension=function(v,h){if(d.isArray(h)){return;}var k=a.toJSON(h);S._setValue(v,['vizFrame','playControl','sliceDimension'],k);};S._getSliceDimension=function(v){var h=S._getValue(v,['vizFrame','playControl','sliceDimension']);if(h){return a.fromJSON(h);}else{return null;}};S._updateSlicedData=function(v,s){var r={};r.measuresInfo=s.measuresInfo;if(d.isArray(s.slices)){r.slices=[];for(var i=0;i<s.slices.length;i++){r.slices.push({data:s.slices[i].data.toJSON(),dimensionMember:s.slices[i].dimensionMember});}}S._setValue(v,['vizFrame','playControl','slicedData'],r);};S._getSlicedData=function(v){var s=S._getValue(v,['vizFrame','playControl','slicedData']);if(s){var r={};r.measuresInfo=s.measuresInfo;r.slices=[];var h=s.slices;if(h){for(var i=0;i<h.length;i++){var k=h[i];r.slices.push({data:sap.viz.api.data.CrosstableDataset.fromJSON(k.data),dimensionMemeber:k.dimensionMemeber});}}return r;}else{return null;}};S._getValue=function(r,p){if(!r||!p||!p.length){return null;}var n=r;for(var i=0;i<p.length;i++){if(!n[p[i]]){return null;}n=n[p[i]];}return n;};S._setValue=function(r,p,v){if(!r||!p||!p.length){return null;}var n=r;for(var i=0;i<p.length-1;i++){if(!n[p[i]]){return;}n=n[p[i]];}var l=p[p.length-1];n[l]=v;};return S;});u('sap/viz/controls/common/views/menu/MenuItem',['require','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(r,a,J){var A=r||A;var M=function(b,n,s){this.__className="sap.viz.controls.common.views.menu.MenuItem";this._id=b;this._name=n;this._enabled=true;this._selected=false;this._subMenuGroups=s;};M.prototype.id=function(){return this._id;};M.prototype.name=function(){return this._name;};M.prototype.icon=function(){return this._icon;};M.prototype.subMenuGroups=function(){return this._subMenuGroups;};M.prototype.enabled=function(v){if(arguments.length>0){this._enabled=v;return this;}else{return this._enabled;}};M.prototype.selected=function(v){if(arguments.length>0){this._selected=v;return this;}else{return this._selected;}};M.prototype.equal=function(m){if(m==undefined){return false;}if(this.id()!==m.id()){return false;}if(this.name()!==m.name()){return false;}if(this.enabled()!==m.enabled()){return false;}if(this.selected()!==m.selected()){return false;}var s=this.subMenuGroups()||[];var b=m.subMenuGroups()||[];if(s.length!==b.length){return false;}for(var i=0;i<s.length;i++){var c=s[i];var d=b[i];if(!(c==undefined&&d==undefined)){if(c==undefined){return false;}if(!c.equal(d)){return false;}}}return true;};M.toJSON=function(b){return a.toJSON(b,function(b){return{'id':b._id,'name':b._name,'subMenuGroups':J.toJSON(J.MenuGroupType,b._subMenuGroups),'enabled':b._enabled,'selected':b._selected};});};M.fromJSON=function(b){return a.fromJSON(b,function(b){var m=new M(b.id,b.name,J.fromJSON(J.MenuGroupType,b.subMenuGroups));m.enabled(b.enabled);m.selected(b.selected);return m;});};J.register(J.MenuItemType,M.fromJSON,M.toJSON);return M;});u('sap/viz/controls/common/events/Event',[],function(){var E=function(t,a,d){this.__className="sap.viz.controls.common.events.Event";this._type=t;this._target=a;this.data=d;};E.prototype.type=function(){return this._type;};E.prototype.target=function(){return this._target;};return E;});u('sap/viz/controls/common/events/FeedEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.events.FeedEvent";};O.extend(F,E);F.FEED_READY="feedReady";F.REQUEST_FEED="requestFeed";F.FEEDS_CHANGED="feedsChanged";return F;});u('sap/viz/controls/runtime/Runtime',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function(O,E,a){var R=function(){this._models={};this._modelRefs={};};O.extend(R,a);R.prototype.registerModel=function(b,m){this._models[b]=m;this._modelRefs[b]=1;};R.prototype.addModelRef=function(b){this._modelRefs[b]++;};R.prototype.removeModelRef=function(b){this._modelRefs[b]--;if(this._modelRefs[b]===0){this._models[b]=null;}};R.prototype.getModel=function(b){return this._models[b];};return R;});u('sap/viz/controls/runtime/RuntimeManager',['sap/viz/controls/runtime/Runtime'],function(R){var _=null;var a={};a.getRuntime=function(){if(_===null){_=new R();}return _;};return a;});u('sap/viz/controls/common/services/BVRService',['sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils'],function(F,a,C,U){var b={};b.VERSION='1.0';b.switchFeeds=function(n,c,f){if(!a.needAutoFeeding(f,c,n)){return{'vizType':n,'feeds':f};}if(n&&F.isEmptyFeeds(f)){var e=F.buildEmptyFeeds(n);if(!e.length){}return{'vizType':n,'feeds':e};}var t;if(C.toSingleChartType(U.clone(n))===C.toSingleChartType(U.clone(c))){t=a.directFeeding(f,n);}else{t=a.smartFeeding(f,n);}return{'vizType':n,'feeds':t};};b.suggestFeeds=function(t,c,d,e){var f,g,h;if(arguments.length===2){f=[];g=c;}else if(arguments.length>=3){f=c;g=d;h=e;}return{'vizType':t,'feeds':a.smartFeeding(f,t,g,h)};};b.suggestChartWithFeeds=function(c){};return b;});u('sap/viz/controls/common/helpers/MapLayers',['sap/viz/controls/common/utils/Utils'],function(U){var M={};M.toJSON=function(a){return U.toJSON(a,function(a){return a;});};M.fromJSON=function(a){return U.fromJSON(a,function(a){return a;});};return M;});u('sap/viz/controls/runtime/ModelHandler',['sap/viz/controls/common/utils/ChartTypeUtil'],function(C){var M=function(v){this.__className="sap.viz.controls.runtime.ModelHandler";this._vizModel=v;this._isMNDVisibleChanged=false;this._feedingItemsChanged=false;};M.prototype._type=function(v){if(arguments.length>0){this._vizModel._type=v;return this;}else{return this._vizModel._type;}};M.prototype._feedingItems=function(v){if(arguments.length>0){this._vizModel._feedingItems=v;return this;}else{return this._vizModel._feedingItems;}};M.prototype._filterItems=function(v){if(arguments.length>0){this._vizModel._filterItems=v;return this;}else{return this._vizModel._filterItems;}};M.prototype.explicitFeedingItems=function(o){return this._vizModel.feedingItems();};M.prototype.deactive=function(){};M.prototype.postLoad=function(){};M.prototype.feedingItemsChanged=function(v,e){};M.prototype.isMNDVisibleChanged=function(v){};M.prototype._setIsMNDVisible=function(v){};M.prototype.vizModelChanged=function(o){};M.prototype._restorePlayerFieldHistory=function(n){if(!C.supportAnimation(n)){var p=this._vizModel.playerField()?this._vizModel.playerField().clone():null;this._vizModel.playerField(null);if(p){this._vizModel._playerFieldHistory=p;}}else{if(!this._vizModel.playerField()){this._vizModel.playerField(this._vizModel._playerFieldHistory);}}};M.prototype.propertiesChanged=function(t,a){};M.prototype.getFilterItems=function(s,a,v,f){};M.prototype.cloneFeeds=function(f){};M.prototype.clone=function(c){};return M;});u('sap/viz/controls/runtime/InfoModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,a,E,b,C,c,d,e,H,F,f,M,g,h,k,l,m){var I=function(v){I.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.InfoModelHandler";};O.extend(I,m);I.prototype.feedingItemsChanged=function(v,n){this._feedingItems(v||[]);};I.prototype.vizModelChanged=function(o){var n=false;var p=this._type();if(o.type){this._type(o.type);}var q=this._type();if(q!==p){this._restorePlayerFieldHistory(q);}var n=false;if(o.feedingItems){n=true;this._feedingItems(o.feedingItems);}var r=false;if(o.filterItems){this._filterItems(o.filterItems);r=true;}var s={'vizTypeChanged':p!==q,'feedingItemsChanged':this._feedingItemsChanged||n,'filterChanged':r};this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(s);};I.prototype.propertiesChanged=function(t,n){var v=this._type();if(!v){return;}var o={'vizTypeChanged':n};if(o.vizTypeChanged){this._restorePlayerFieldHistory(t);}this._vizModel.dispatchPropertiesChangedEvent(o);};I.prototype.getFilterItems=function(s,n,v,o){return l.getFilterItems(s,n,this._filterItems(),this._feedingItems(),v,o);};I.prototype.clone=function(n){var r=n;r._type=this._type();var o=this._feedingItems();if(o&&o.length>0){for(var i=0;i<o.length;i++){r._feedingItems[i]=o[i].clone();}}var p=this._filterItems();if(p&&p.length>0){for(var j=0;j<p.length;j++){r._filterItems[j]=p[j].clone();}}return r;};return I;});u('sap/viz/controls/runtime/MapModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,a,E,b,C,c,d,e,H,F,f,M,g,h,k,l,m){var o=function(v){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.MapModelHandler";};O.extend(o,m);o.prototype.feedingItemsChanged=function(v,n){if(n!==false){var p=[];var q=this._feedingItems();for(var i=0;i<v.length;i++){if(q[i]!==v[i]){if(q[i]&&v[i]&&f.equal(q[i],v[i])){continue;}else{p.push(i);}}}this._feedingItems(v);if(p.length>0){this._vizModel._feedingItemsHistory=null;var r={'feedingItemsChanged':true,feedsChangedInfo:{items:p}};this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(r);}}else{this._feedingItems(v);}};o.prototype.isMNDVisibleChanged=function(v){this._vizModel._feedingItemsHistory=null;};o.prototype._setIsMNDVisible=function(v){if(this._vizModel.isMNDVisible()!==v){this._vizModel._isMNDVisible=v;this._isMNDVisibleChanged=true;}};o.prototype.vizModelChanged=function(n){var p=false;var q=this._type();if(n.type){this._type(n.type);}var r=this._type();if(r!==q){this._restorePlayerFieldHistory(r);}if(n.feedingItems){var s=this._feedingItems();if(s.length!=n.feedingItems.length){p=true;}else{for(var i=0;i<s.length;i++){if(!f.equal(s[i],n.feedingItems[i])){p=true;break;}}}if(p){this._vizModel._feedingItemsHistory=null;this._feedingItems(n.feedingItems);this._vizModel.extensionValues({map:{feeding:n.feedingItems}});}}var t=false;if(n.filterItems){this._filterItems(n.filterItems);t=true;}var v={'vizTypeChanged':q!==r,'feedingItemsChanged':this._feedingItemsChanged||p,'filterChanged':t};this._type(r);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(v);};o.prototype.propertiesChanged=function(t,n){var v=this._type();if(!v){return;}var p=v;var q={'vizTypeChanged':n||(v!==t)};this._type(p);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;if(q.vizTypeChanged){this._restorePlayerFieldHistory(p);}this._vizModel.dispatchPropertiesChangedEvent(q);};o.prototype.getFilterItems=function(s,n,v,p){return l.getMapFilterItems(s,n,this._filterItems(),this._feedingItems());};o.prototype.clone=function(p){var r=p;r._type=this._type();var q=this._feedingItems();if(q&&q.length>0){for(var i=0;i<q.length;i++){r._feedingItems[i]=[];for(var n=0;n<q[i].length;n++){r._feedingItems[i][n]=q[i][n].clone();}}}var s=this._filterItems();if(s&&s.length>0){for(var j=0;j<s.length;j++){r._filterItems[j]=s[j].clone();}}return r;};return o;});u('sap/viz/controls/runtime/VizModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,a,E,b,C,c,d,e,H,F,f,M,g,h,k,l,m){var V=function(v){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModelHandler";};O.extend(V,m);V.prototype.explicitFeedingItems=function(q){q=q||{};var r=this._feedingItems();var t=this._type();if(!k.isMultipleChart(t)){r=f.removeRowAndColumnFeedItems(r);}var w=q.withMND!=null?q.withMND===true:this._vizModel.isMNDVisible();if(!w){r=f.removeMND(r);}var s=f.buildEmptyFeeds(t);r=f.merge(s,r);return r;};V.prototype.deactive=function(){this._vizModel._feedingItemsHistory=f.cloneFeeds(this._feedingItems());this._vizModel._playerFieldHistory=this._vizModel.playerField()?this._vizModel.playerField().clone():null;};V.prototype.postLoad=function(){var q=this._feedingItems();this._vizModel._feedingItemsHistory=f.cloneFeeds(q);this._vizModel._playerFieldHistory=this._vizModel.playerField()?this._vizModel.playerField().clone():null;var t=this._type();var r=f.hasMND(q);this._vizModel._isMNDVisible=r;if(!r){var s=_(t,q,r);this._feedingItems(s.feeds);}};V.prototype.feedingItemsChanged=function(v,q){var r=this._vizModel.extensionValues();q=r.feedingPanel?r.feedingPanel.enableTrellis:q;if(q===false){v=f.removeRowAndColumnFeedItems(v);}this._setIsMNDVisible(f.hasMND(v));this._feedingItemsChanged=!f.equal(v,this._feedingItems());if(this._feedingItemsChanged){this._feedingItems(v||[]);this._vizModel._feedingItemsHistory=null;var s=f.hasRowOrColumn(this._feedingItems());var t=this._type();var w;if(s&&!k.isMultipleChart(t)){w=k.toMultiChartType(t);this._vizModel.type(w);}else if(!s&&k.isMultipleChart(t)){w=k.toSingleChartType(t);this._vizModel.type(w);}else{this.propertiesChanged(t,false);}this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null;}};V.prototype.isMNDVisibleChanged=function(v){this._isMNDVisibleChanged=true;this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null;this.propertiesChanged(this._type(),false);this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null;};V.prototype._setIsMNDVisible=function(v){var q=(v===true);if(this._vizModel.isMNDVisible()!==q){this._vizModel._isMNDVisible=q;this._isMNDVisibleChanged=true;}};V.prototype.vizModelChanged=function(q){var r=false;if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=f.cloneFeeds(this._feedingItems());}var s=this._vizModel.isMNDVisible();var t=this._type();if(q.type){this._type(q.type);}var v=this._type();if(v!==t){this._restorePlayerFieldHistory(v);}var w;if(q.feedingItems){if(f.supportMND(v)){s=f.hasMND(q.feedingItems);this._setIsMNDVisible(s);}if(f.match(v,q.feedingItems,false)){w=_(v,q.feedingItems,s);v=w.vizType;q.feedingItems=w.feeds;}r=!f.equal(this._feedingItems(),q.feedingItems);if(r){this._feedingItems(q.feedingItems);this._vizModel._feedingItemsHistory=f.cloneFeeds(q.feedingItems);}}var x=this._vizModel._feedingItemsHistory;s=this._vizModel.isMNDVisible();v=p(v,x,s);if(!r){var y;if(v!==t){y=g.switchFeeds(v,t,x).feeds;w=_(v,y,s);v=w.vizType;y=w.feeds;}if(y){this._feedingItems(y);if(f.isEmptyFeeds(this._feedingItems())&&f.isEmptyFeeds(y)){r=false;}else{r=!f.isFeedDefinitionEqual(t,v)||!f.equal(this._feedingItems(),y);}}}var z=false;if(q.filterItems){this._filterItems(q.filterItems);z=true;}var D={'vizTypeChanged':t!==v,'feedingItemsChanged':this._feedingItemsChanged||r,'filterChanged':z};this._type(v);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(D);};V.prototype.propertiesChanged=function(t,q){var v=this._type();if(!v){return;}var r=this._feedingItems();if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=f.cloneFeeds(r);}if(t!=="viz/number"){this._saveSubtotals(r,this._vizModel);}var s=v;var w=t;var x=this._vizModel._feedingItemsHistory;var y=this._vizModel.isMNDVisible();s=p(s,x,y);var z;if(f.match(s,x,false)){z=_(s,x,y);s=z.vizType;x=z.feeds;}var D=g.switchFeeds(s,w,x).feeds;z=_(s,D,y);s=z.vizType;D=z.feeds;var G=true;if(f.isEmptyFeeds(r)&&f.isEmptyFeeds(D)){G=false;}else{G=!f.isFeedDefinitionEqual(w,s)||!f.equal(r,D);}var I={'vizTypeChanged':q||(w!==s),'feedingItemsChanged':this._feedingItemsChanged||G,'isMNDVisibleChanged':this._isMNDVisibleChanged};this._type(s);this._feedingItems(D);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;if(I.vizTypeChanged){this._restorePlayerFieldHistory(s);}this._vizModel.dispatchPropertiesChangedEvent(I);};V.prototype._saveSubtotals=function(q,r){var s=[];var t=false;var w=false;for(var i=0;i<q.length;i++){if(q[i].type()==="calculation"){r.savedSubtotals(q[i]);}if(r.savedSubtotals()!==null&&q[i].type()==="Dimension"){t=true;for(var v=0;v<q[i].values().length;v++){for(var x=0;x<r.savedSubtotals().values().length;x++){if(q[i].values()[v].id()===r.savedSubtotals().values()[x].aggregationTarget()){s.push(r.savedSubtotals().values()[x]);w=true;}}}}}if((t===false||w===false)&&r.savedSubtotals()!==null){r.savedSubtotals().values([]);}if(r.savedSubtotals()!==null&&s[0]){r.savedSubtotals().values(s);var y=false;for(var i=0;i<r.feedingItemsHistory().length;i++){if(r.feedingItemsHistory()[i].type()==="calculation"){var z=r.savedSubtotals();r.feedingItemsHistory()[i]=z;y=true;}}if(y===false){r.feedingItemsHistory().push(r.savedSubtotals());}}};V.prototype.getFilterItems=function(s,q,v,r){return l.getFilterItems(s,q,this._filterItems(),this._feedingItems(),v,r);};V.prototype.clone=function(q){var r=q;r._type=this._type();var s=this._feedingItems();if(s&&s.length>0){for(var i=0;i<s.length;i++){r._feedingItems[i]=s[i].clone();}}var t=this._filterItems();if(t&&t.length>0){for(var j=0;j<t.length;j++){r._filterItems[j]=t[j].clone();}}return r;};function n(t,q){var r=k;if(r.supportMultiChart(t)){if(f.hasRowOrColumn(q)){return r.toMultiChartType(t);}else{return r.toSingleChartType(t);}}else{return t;}}function o(t){var q=k;if(q.supportMultiChart(t)){var r=q.toMultiChartType(t);if(t!==r&&!f.supportMND(t)&&f.supportMND(r)){return r;}else{return t;}}else{return t;}}function p(t,q,r){var s=n(t,q);if(r){s=o(s);}return s;}function _(t,q,r){if(r){t=o(t);if(!f.hasMND(q)){q=e.directFeeding(q,t,[c.genMND()]);}}else{q=f.removeMND(q);t=n(t,q);if(!f.isEmptyFeeds(q)){if(!f.meetMinDimensions(t,q)){q=e.directFeeding(q,t,[c.genMND()]);}}}if(f.countAnalyses(q,d.MEASURE)===0){q=f.removeMND(q);}t=n(t,q);return{'vizType':t,'feeds':q};}return V;});u('sap/viz/controls/runtime/VizModel',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/runtime/InfoModelHandler','sap/viz/controls/runtime/MapModelHandler','sap/viz/controls/runtime/VizModelHandler'],function(O,a,E,b,C,c,d,I,M,V){var e=function(){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModel";this._type=null;this._isMNDVisible=false;this._feedingItems=[];this._feedingItemsHistory=null;this._savedSubtotals=null;this._filterItems=[];this._playerFieldHistory=null;this._playerField=null;this._extensionValues={};this._handler=this._vizModelHandler=new V(this);};O.extend(e,b);e.PropertiesChangedEvent='propertiesChangedEvent';e.prototype._updateHandler=function(t){var n=this._vizModelHandler;if(C.TYPE_GEO_MAP===t){if(!this._mapModelHandler){this._mapModelHandler=new M(this);}n=this._mapModelHandler;}else if(d.isInfoChart(t)){if(!this._infoModelHandler){this._infoModelHandler=new I(this);}n=this._infoModelHandler;}if(n!==this._handler){this._handler.deactive();this._handler=n;this._feedingItems=[];}};e.prototype.load=function(o){if(!o){return;}var t=false;var f=false;var g=false;if(o.type&&o.type!==this._type){this._type=o.type;this._updateHandler(this._type);t=true;}if(o.feedingItems){this._feedingItems=o.feedingItems;f=true;}else{this._feedingItems=[];}var h=this._isMNDVisible;this._handler.postLoad();g=(h!==this._isMNDVisible);if(t||f){var k={'vizTypeChanged':t,'isMNDVisibleChanged':g,'feedingItemsChanged':f,};this.dispatchPropertiesChangedEvent(k);}};e.prototype.filterItems=function(v){if(arguments.length>0){this._filterItems=v;var f={filterChanged:true};var g=new E(e.PropertiesChangedEvent,this,f);this._dispatchEvent(g);return this;}else{return this._filterItems;}};e.prototype.explicitFeedingItems=function(o){return this._handler.explicitFeedingItems(o);};e.prototype.feedingItems=function(v,f){if(arguments.length>0){this._handler.feedingItemsChanged(v,f);return this;}else{return this._feedingItems.slice(0);}};e.prototype.savedSubtotals=function(v){if(arguments.length>0){this._savedSubtotals=v;return this;}else{return this._savedSubtotals;}};e.prototype.feedingItemsHistory=function(v){if(arguments.length>0){this._feedingItemsHistory=v;return this;}else{return this._feedingItemsHistory;}};e.prototype.type=function(v){if(arguments.length>0){if(this._type!==v){var o=this._type;this._type=v;this._updateHandler(this._type);this._handler.propertiesChanged(o,true);}return this;}else{return this._type;}};e.prototype.playerField=function(v){if(arguments.length>0){var f;if(v){if(!this._playerField||!this._playerField.equal(v)){this._playerField=v;f={'sliceDimensionChanged':true};this.dispatchPropertiesChangedEvent(f);}}else{if(this._playerField){this._playerField=null;f={'sliceDimensionChanged':true};this.dispatchPropertiesChangedEvent(f);}}return this;}else{return this._playerField;}};e.prototype.isMNDVisible=function(v){if(arguments.length>0){var f=(v===true);if(this._isMNDVisible!==f){this._isMNDVisible=f;this._handler.isMNDVisibleChanged();}return this;}else{return this._isMNDVisible;}};e.prototype.vizModelChanged=function(o){if(o.type){this._updateHandler(o.type);}this._handler.vizModelChanged(o);};e.prototype.updateFilterItems=function(s,f,v,g){var n=this._handler.getFilterItems(s,f,v,g);this.filterItems(n);};e.prototype.clone=function(){var r=new e();this._handler.clone(r);return r;};e.prototype.extensionValues=function(f){if(arguments.length>0){var g={};if(f){if(this._extensionValues!==f){this._extensionValues=f;g={'extensionValuesChanged':true};}}var h=new E(e.PropertiesChangedEvent,this,g);this._dispatchEvent(h);return this;}else{return this._extensionValues;}};e.prototype.dispatchPropertiesChangedEvent=function(f){var p=new E(e.PropertiesChangedEvent,this,f);this._dispatchEvent(p);};e.prototype.dispatchEvent=function(f){this._dispatchEvent(f);};return e;});u('sap/viz/controls/common/ProxyBase',[],function(){var P=function P(c){this.__className="sap.viz.controls.runtime.ProxyBase";this.__client=c;};P.prototype._client=function(){return this.__client;};P.prototype.updateClient=function(c){this.__client=c;};return P;});u('sap/viz/controls/runtime/VizProxy',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/ProxyBase','sap/viz/controls/common/events/Event'],function($,O,P,E){var V=function V(v){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizProxy";};O.extend(V,P);V.VizProxyEvent='VizProxy.VizProxyEvent';V.GetTitleZoneOperation='getTitleZoneOperation';V.GetTitleTextOperation='getTitleTextOperation';V.SetTitleTextOperation='setTitleTextOperation';V.GetTitleTextByFeedingOperation='getTitleTextByFeedingOperation';V.RestoreTitleTextOperation='restoreTitleTextOperation';V.IsFakeChartOperation='isFakeChartOperation';V.IsTitleCustomizedOperation='isTitleCustomizedOperation';V.GetPropertiesOperation='getPropertiesOperation';V.SetPropertiesOperation='setPropertiesOperation';V.SetDatasetOperation='SetDatasetOperation';V.GetSelectionOperation='getSelectionOperation';V.SetTitleModeOperation='setTitleModeOperation';V.GetPropertyZonesOperation='getPropertyZonesOperation';V.SetPropertyZonesOperation='setPropertyZonesOperation';V.GetDatasetOperation='GetDatasetOperation';V.QueryPropertiesOperation='queryPropertiesOperation';V.UpdatePropertiesOperation='updatePropertiesOperation';V.AddEventListenerOperation='addEventListenerOperation';V.RemoveEventListenerOperation='removeEventListenerOperation';V.SetAxisScaleOperation='setAxisScaleOperation';V.GetTypeOperation='getTypeOperation';V.GetDataPointsPosition='getDataPointsPosition';V.OnOperation='onOperation';V.OffOperation='offOperation';V.GetSizeOperation='getSizeOperation';V.SetSizeOperation='setSizeOperation';V.GetVizFeedingOperation='getVizFeedingOperation';V.prototype._model=function(){return this._client();};V.prototype._doOperation=function(o,d){d=d||{};d.operation=o;var e=new E(V.VizProxyEvent,this._model(),d);this._model().dispatchEvent(e);return e.data.result;};V.prototype.getTitleZone=function(){return this._doOperation(V.GetTitleZoneOperation);};V.prototype.getTitleText=function(){return this._doOperation(V.GetTitleTextOperation);};V.prototype.setTitleText=function(t){var d={args:arguments};this._doOperation(V.SetTitleTextOperation,d);};V.prototype.getTitleTextByFeeding=function(){return this._doOperation(V.GetTitleTextByFeedingOperation);};V.prototype.restoreTitleText=function(){this._doOperation(V.RestoreTitleTextOperation);};V.prototype.SetDataset=function(d){var a={args:arguments};this._doOperation(V.SetDatasetOperation,a);};V.prototype.setTitleMode=function(m){var d={args:arguments};this._doOperation(V.SetTitleModeOperation,d);};V.prototype.isFakeChart=function(){return this._doOperation(V.IsFakeChartOperation);};V.prototype.isTitleCustomized=function(){return this._doOperation(V.IsTitleCustomizedOperation);};V.prototype.getProperties=function(){return this._doOperation(V.GetPropertiesOperation);};V.prototype.setProperties=function(n){var d={args:arguments};this._doOperation(V.SetPropertiesOperation,d);};V.prototype.getSelection=function(){return this._doOperation(V.GetSelectionOperation);};V.prototype.getType=function(){return this._doOperation(V.GetTypeOperation);};V.prototype.getPropertyZones=function(){return this._doOperation(V.GetPropertyZonesOperation);};V.prototype.setPropertyZones=function(p){var d={args:arguments};this._doOperation(V.SetPropertyZonesOperation,d);};V.prototype.queryProperties=function(o){var d={args:arguments};return this._doOperation(V.QueryPropertiesOperation,d);};V.prototype.updateProperties=function(o){var d={args:arguments};this._doOperation(V.UpdatePropertiesOperation,d);};V.prototype.getDataset=function(){return this._doOperation(V.GetDatasetOperation);};V.prototype.setAxisScale=function(a){var d={args:arguments};return this._doOperation(V.SetAxisScaleOperation,d);};V.prototype.addEventListener=function(t,l,s,p){var d={args:arguments};this._doOperation(V.AddEventListenerOperation,d);};V.prototype.removeEventListener=function(t,l,s){var d={args:arguments};this._doOperation(V.RemoveEventListenerOperation,d);};V.prototype.getDataPointsPosition=function(d){var a={args:arguments};return this._doOperation(V.GetDataPointsPosition,a);};V.prototype.on=function(e,c){this._doOperation(V.OnOperation,{'args':arguments});};V.prototype.off=function(e){this._doOperation(V.OffOperation,{'args':arguments});};V.prototype.getSize=function(){return this._doOperation(V.GetSizeOperation);};V.prototype.setSize=function(s){var d={args:arguments};this._doOperation(V.SetSizeOperation,d);};V.prototype.getVizFeeding=function(){return this._doOperation(V.GetVizFeedingOperation);};return V;});u('sap/viz/controls/common/VizControlBase',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/UIControl','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/runtime/VizModel','sap/viz/controls/runtime/VizProxy'],function(O,E,U,R,V,a){var b=function b(d,c,p){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlBase";sap.viz.base.utils.log.Analyzer.pnrContext('sap.viz.controls performance log context');this._vizUid=null;if(p){this._parent=p;this.__vizModel=p._vizModel();}else{this.__vizModel=this._createModel();}this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this._updatingProperty=0;this.__vizProxy=new a(this.__vizModel);};O.extend(b,U);b.prototype.connect=function(v){if(this._vizUid===v){return;}this._vizUid=v;var r=R.getRuntime();var m=r.getModel(v);var c=false;if(!m){r.registerModel(v,this.__vizModel);}else{if(this.__vizModel!==m){c=true;this.__vizModel.removeEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel=m;this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);}r.addModelRef(v);}this._onConnect(v,c);};b.prototype._vizModel=function(){return this.__vizModel;};b.prototype._vizProxy=function(){return this.__vizProxy;};b.prototype._onVizModelChanged=function(e){};b.prototype._createModel=function(){return new V();};b.prototype._onConnect=function(v,m){this._vizProxy().updateClient(this.__vizModel);};b.prototype._onDisconnect=function(){};b.prototype._onAfterDisconnect=function(){};b.prototype.disconnect=function(){this._removeSharedModel(true);};b.prototype._removeSharedModel=function(n){var v=this._vizUid;if(v){var m=R.getRuntime().getModel(v);if(m){if(n){this._onDisconnect();}m.removeEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel=m.clone();this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);R.getRuntime().removeModelRef(v);}if(n){this._onAfterDisconnect();}this._vizUid=null;}};b.prototype.destroy=function(){this._removeSharedModel(false);b.superclass.destroy.apply(this,arguments);};b.prototype._beginUpdateProperty=function(){this._updatingProperty++;};b.prototype._inUpdatingProperty=function(){return this._updatingProperty>0;};b.prototype._endUpdateProperty=function(){this._updatingProperty--;};b.prototype._dispatchPropertyEvent=function(e){if(!this._updatingProperty){b.superclass._dispatchEvent.apply(this,arguments);}};b.prototype._dispatchEvent=function(e){if(!e.data){e.data={};}e.data.token=this._vizUid;b.superclass._dispatchEvent.apply(this,arguments);};b.prototype.save=function(){return{};};b.prototype.load=function(v){};return b;});u('sap/viz/controls/common/VizControlHost',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/VizControlBase'],function(O,E,V){var a=function a(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlHost";this._children=[];};O.extend(a,V);a.prototype._onConnect=function(v){a.superclass._onConnect.apply(this,arguments);for(var i=0;i<this._children.length;i++){this._children[i].connect(v);}};a.prototype._onDisconnect=function(){a.superclass._onDisconnect.apply(this,arguments);for(var i=0;i<this._children.length;i++){this._children[i].disconnect();}};a.prototype._addChild=function(c,f,e){if(!c){return;}this._children.push(c);var _=this;f&&f.forEach(function(n){_[n]=function(){return c[n].apply(c,arguments);};});e&&e.forEach(function(b){c.addEventListener(b,function(d){_._dispatchEvent(d);});});};a.prototype.destroy=function(){var c;while(c=this._children.shift()){try{c.destroy();}catch(e){}}a.superclass.destroy.apply(this,arguments);};return a;});u('sap/viz/controls/common/views/feed/FeedingShelfEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedingShelfEvent";};O.extend(F,E);F.CLICK_ADD_FEEDING="clickAddFeeding";F.ACTION_CHANGED="actionChanged";F.FEEDING_CHANGED="feedingChanged";F.FEEDING_EMPTY_CHANGED="feedingEmptyChanged";F.FEEDING_DROP_DENY="feedingDropDeny";return F;});u('sap/viz/controls/feeding/FeedingPanelConfig',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/config/GlobalConfig'],function(C,G){var F={};F.instance=function(){return{'useBuildInFeedList':true,"defaultVizType":C.TYPE_COLUMN,'enableTrellis':true};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_FEEDING,F);return F;});u('sap/viz/controls/mapbuilder/MapBuilderConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var M={};M.instance=function(){return{basemap:{providers:["ESRI","CVOM","NAVTEQ"],changeable:true,selected:"ESRI"},feedMap:{actionGroups:[]},feedingPanel:{}};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_MAPBUILDER,M);return M;});u('sap/viz/controls/switchbar/SwitchBarConfig',['sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager'],function(G,C,L){var S={};S.instance=function(){return{"visible":true,"defaultVizType":C.TYPE_BAR,"groups":[{"name":L.get("VIZ_SWITCHBAR_BAR_COLUMN_CHARTS"),"types":[{"id":C.TYPE_BAR},{"id":C.TYPE_COLUMN},{"id":C.TYPE_STACKED_BAR},{"id":C.TYPE_STACKED_COLUMN},{"id":C.TYPE_DUAL_BAR},{"id":C.TYPE_DUAL_COLUMN},{"id":C.TYPE_3D_COLUMN}]},{"name":L.get("VIZ_SWITCHBAR_LINE_CHARTS"),"types":[{"id":C.TYPE_LINE},{"id":C.TYPE_AREA},{"id":C.TYPE_COMBINATION},{"id":C.TYPE_DUAL_LINE},{"id":C.TYPE_DUAL_COMBINATION}]},{"name":L.get("VIZ_SWITCHBAR_PIE_CHARTS"),"types":[{"id":C.TYPE_PIE},{"id":C.TYPE_DONUT},{"id":C.TYPE_PIE_WITH_DEPTH}]},{"name":L.get("VIZ_SWITCHBAR_GEO_CHARTS"),"types":[{"id":C.TYPE_GEO_BUBBLE},{"id":C.TYPE_GEO_CHOROPLETH},{"id":C.TYPE_GEO_PIE}]},{"name":L.get("VIZ_SWITCHBAR_SCATTER_CHARTS"),"types":[{"id":C.TYPE_SCATTER},{"id":C.TYPE_BUBBLE},{"id":C.TYPE_SCATTER_MATRIX}]},{"name":L.get("VIZ_SWITCHBAR_MAP_CHARTS"),"types":[{"id":C.TYPE_HEATMAP},{"id":C.TYPE_TREEMAP}]},{"name":L.get("VIZ_SWITCHBAR_TABLES"),"types":[{"id":C.TYPE_TABLE}]},{"name":L.get("VIZ_SWITCHBAR_NUMBER_CHARTS"),"types":[{"id":C.TYPE_NUMBER}]},{"name":L.get("VIZ_SWITCHBAR_OTHER_CHARTS"),"types":[{"id":C.TYPE_BOXPLOT},{"id":C.TYPE_FUNNEL},{"id":C.TYPE_NETWORK},{"id":C.TYPE_PC},{"id":C.TYPE_RADAR},{"id":C.TYPE_TAG_CLOUD},{"id":C.TYPE_TREE},{"id":C.TYPE_WATERFALL}]}]};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_SWITCHBAR,S);return S;});u('sap/viz/controls/builder/VizBuilderConfig',['sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/feeding/FeedingPanelConfig','sap/viz/controls/mapbuilder/MapBuilderConfig','sap/viz/controls/switchbar/SwitchBarConfig'],function(G,C,F,M,S){var V={};V.instance=function(){return{"defaultVizType":C.TYPE_COLUMN,"header":{"visible":true},"controls":{"switchBar":S.instance(),"feedingPanel":F.instance(),"mapBuilder":M.instance()}};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_BUILDER,V);return V;});u('sap/viz/controls/builder/VizBuilderEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var V=function(t,a,d){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.builder.VizBuilderEvent";};O.extend(V,E);return V;});u('sap/viz/controls/mapbuilder/constants/Const',[],function(){var C={};C.VIZ_TYPE_CHOROPLETH="choropleth";C.VIZ_TYPE_MARKER="marker";C.VIZ_TYPE_BUBBLE="bubble";return C;});u('sap/viz/controls/mapbuilder/components/PropertyTriangle',['jquery','sap/viz/controls/common/constants/CSSConst'],function($,C){var P=function(){this.__className="sap.viz.controls.geo.compnents.PropertyTriangle";};P.prototype.createTriangle=function(){var a=document.createElement('DIV');this.turnToExpandTriangle(a);return a;};P.prototype.turnToExpandTriangle=function(a){if(a){$(a).removeClass(C.MAPBUILDER_PREFIX+"section-expand");$(a).addClass(C.MAPBUILDER_PREFIX+"section-collapse");$(a).removeClass(C.MAPBUILDER_PREFIX+"header-collapse");$(a).addClass(C.MAPBUILDER_PREFIX+"header-expand");}};P.prototype.turnToShrinkTriangle=function(a){if(a){$(a).removeClass(C.MAPBUILDER_PREFIX+"section-collapse");$(a).addClass(C.MAPBUILDER_PREFIX+"section-expand");$(a).removeClass(C.MAPBUILDER_PREFIX+"header-expand");$(a).addClass(C.MAPBUILDER_PREFIX+"header-collapse");}};return P;});u('sap/viz/controls/mapbuilder/events/GeoEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var G=function(t,a,d){G.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.events.GeoEvent";};O.extend(G,E);G.ADD_LAYER="addLayer";G.SHOW_LAYER="showLayer";G.HIDE_LAYER="hideLayer";G.EXPAND_SECTION="expandSection";G.HIDE_SECTION="hideSection";G.DELETE_LAYER="deleteLayer";G.REORDER_LAYER="reorderLayer";G.CHANGE_LAYER_VIZTYPE="changeLayerVizType";G.CHANGE_BASEMAP_PROVIDER="changeBasemapProvider";G.UPDATE_LAYER_DATA="updateLayerData";G.RENAME_LAYER="renameLayer";G.DISPLAY_SETTINGMENU="displaySettingMenu";G.SHOW_LEGEND="showLegend";G.HIDE_LEGEND="hideLegend";G.CHANGE_VIZ_PROPERITIES="changeVizProperties";G.CHANGE_BASEMAP_TYPE="changeBaseMapType";G.ACTION_CHANGED="actionChanged";return G;});u('sap/viz/controls/mapbuilder/sections/SectionBase',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/mapbuilder/components/PropertyTriangle","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/constants/Const",],function($,O,U,V,C,P,G,a){var S=function(d,c){S.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.SectionBase";this._config=c;this._checkable=this._config.checkable;this._configable=this._config.configable;this._sortable=this._config.sortable;this._isExpand=false;this._isChecked=true;this._instanceDom=this._dom;this._checkBoxDom=null;this._symbolDom=null;this._headerDom=null;this._iconDom=null;this._labelDom=null;this._configDom$=null;this._controlPanel=null;this._childControls=[];this._isMouseDown=false;this._selected=false;this._propertyTriangle=new P();this._availableControls=[];this._createCompoment();};O.extend(S,V);S.prototype._createCompoment=function(){if(this._isCreated){return;}this._titleString=this._config.title?this._config.title:null;this._childControlDom=[];this._createSection();this._attachEventHandler();this._isCreated=true;$(this._instanceDom).prepend($(this._sectionDom));};S.prototype._createSection=function(){this._sectionDom=document.createElement('div');this._headerDom=document.createElement('div');$(this._sectionDom).addClass(C.MAPBUILDER_PREFIX+"section");$(this._headerDom).addClass(C.MAPBUILDER_PREFIX+"section-header");this._checkBoxDom=document.createElement('input');this._checkBoxDom.type='checkbox';this._checkBoxDom.checked=this._isChecked;$(this._checkBoxDom).addClass(C.MAPBUILDER_PREFIX+"section-block");if(!this._checkable){this._checkBoxDom.disabled=true;}this._symbolDom=this._propertyTriangle.createTriangle();$(this._symbolDom).addClass(C.MAPBUILDER_PREFIX+"section-expand");this._headerDom.appendChild(this._symbolDom);this._headerDom.appendChild(this._checkBoxDom);this._labelDom=document.createElement('div');$(this._labelDom).addClass(C.MAPBUILDER_PREFIX+"section-title");this._labelDom.innerText=this._titleString?this._titleString:'';this._headerDom.appendChild(this._labelDom);this._iconDom=$('<div/>').addClass(C.MAPBUILDER_PREFIX+"section-icon");this._iconDom.appendTo($(this._headerDom));this.showIcon(false);if(this._config.vizType){this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon");if(this._config.vizType===a.VIZ_TYPE_CHOROPLETH){this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");}else if(this._config.vizType===a.VIZ_TYPE_MARKER){this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-marker");}else if(this._config.vizType===a.VIZ_TYPE_BUBBLE){this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");}this.showIcon(true);}if(this._configable){this._configDom$=$('<div/>').addClass(C.MAPBUILDER_PREFIX+"section-setting");this._configDom$.appendTo($(this._headerDom));}this._sectionDom.appendChild(this._headerDom);};S.prototype._attachEventHandler=function(){$(this._symbolDom).bind('tap click',function(e){e.stopPropagation();e.preventDefault();this._dispatchEvent(new G(this._isExpand?G.HIDE_SECTION:G.EXPAND_SECTION,this,{sectionIdx:this.getSectionIdx()}));}.bind(this));$(this._headerDom).bind('tap click',function(e){e.stopPropagation();e.preventDefault();this._dispatchEvent(new G(this._isExpand?G.HIDE_SECTION:G.EXPAND_SECTION,this,{sectionIdx:this.getSectionIdx()}));}.bind(this));if(this._configable){this._configDom$.bind('tap click',function(e){this._dispatchEvent(new G(G.DISPLAY_SETTINGMENU,this,{sectionIdx:this.getSectionIdx()}));e.stopPropagation();e.preventDefault();}.bind(this));}$(this._checkBoxDom).bind('click tap',function(e){e.stopPropagation();e.preventDefault();});$(this._checkBoxDom).bind('mousedown',function(e){this._isMouseDown=true;}.bind(this));$(this._checkBoxDom).bind('mouseup',function(e){if(this._isMouseDown){this._isChecked=!this._isChecked;e.target.checked=this._isChecked;e.stopPropagation();e.preventDefault();this._isMouseDown=false;this._selected=true;this._dispatchEvent(new G(this._isChecked?G.SHOW_LAYER:G.HIDE_LAYER,this,{sectionIdx:this.getSectionIdx()}));}}.bind(this));if(this._sortable){$(this._instanceDom).sortable({start:function(e,b){b.item.data("__origIdx",b.item.index());},update:function(e,b){this._dispatchEvent(new G(G.REORDER_LAYER,this,{from:b.item.data("__origIdx"),to:b.item.index()}));}.bind(this)});}};S.prototype._hideSectionHandler=function(){var _=this;if(this._controlPanel!=null){$(this._controlPanel).hide();}$(this._sectionDom).removeClass(C.MAPBUILDER_PREFIX+"section-header-expand");this._propertyTriangle.turnToExpandTriangle(this._symbolDom);$(this._headerDom).bind("mouseover",function(){_._configDom$.show();}).bind("mouseout",function(){_._configDom$.hide();});this._isExpand=false;};S.prototype._expandSectionHandler=function(){this._propertyTriangle.turnToShrinkTriangle(this._symbolDom);$(this._sectionDom).addClass(C.MAPBUILDER_PREFIX+"section-header-expand");this._configDom$.show();$(this._headerDom).unbind("mouseover").unbind("mouseout");if(this._controlPanel!=null){$(this._controlPanel).show();}else{this._controlPanel=$('<div/>').appendTo($(this._sectionDom));this._createChildControlPanel(this._controlPanel);}this._isExpand=true;};S.prototype.getSectionIdx=function(){return $(this._sectionDom).index();};S.prototype.getSectionDom=function(){return $(this._sectionDom);};S.prototype.title=function(t,c){if(!arguments.length){return this._labelDom.innerText;}else{if(c){this._titleString=t;this._labelDom.innerText=this._titleString;}else{if(this._titleString!=null){this._titleString=t;this._labelDom.innerText=this._titleString;}else{this._labelDom.innerText=t;}}}};S.prototype.showIcon=function(f){if(!arguments.length){return this._showIconDom;}if(f){this._iconDom.css('visibility','');this._showIconDom=true;}else{this._iconDom.css('visibility','hidden');this._showIconDom=false;}};return S;});u('sap/viz/controls/mapbuilder/widgets/WidgetBase',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/VizControlBase"],function($,O,V){var W=function(r,c){W.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetBase";this._config=c;};O.extend(W,V);return W;});u('sap/viz/controls/mapbuilder/widgets/WidgetTitle',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/mapbuilder/widgets/WidgetBase"],function($,O,C,W){var a=function(d,c){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetTitle";this._title$=null;this._creatControls();};O.extend(a,W);a.prototype._creatControls=function(){var r=$(this._dom);this._title$=$('<div/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+"section-category-title");var b=$('<div/>').appendTo(this._title$).addClass(C.MAPBUILDER_PREFIX+"section-category-title-text");b.text(this._config.title);};a.prototype.show=function(){this._title$.show();};a.prototype.hide=function(){this._title$.hide();};return a;});u('sap/viz/controls/mapbuilder/widgets/WidgetDataPoint',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/widgets/WidgetBase"],function($,O,C,L,G,a,W){var I=C.MAPBUILDER_PREFIX+"inline-block";var T=C.MAPBUILDER_PREFIX+"viztype-selected";var b=function(d,c){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetDataPoint";this._vizTypeButton$={};this._creatControls();this._addEventListeners();};O.extend(b,W);b.prototype.update=function(c){var v=c.vizType;if(v){for(var k in this._vizTypeButton$){if(this._vizTypeButton$.hasOwnProperty(k)){this._vizTypeButton$[k].removeClass(T);}}this._vizTypeButton$[v].addClass(T);}};b.prototype._creatControls=function(){var r=$(this._dom);var c=$('<button/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+"viztype").addClass(I);$("<div/>").addClass(C.MAPBUILDER_PREFIX+'viztype-choropleth').addClass(C.MAPBUILDER_PREFIX+'viztype-icon').appendTo(c);c.data("__viztype","choropleth");c.attr("title",L.get('VIZ_MAPBUILDER_CHOROPLETH'));this._vizTypeButton$['choropleth']=c;c=$('<button/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+"viztype").addClass(I);$("<div/>").addClass(C.MAPBUILDER_PREFIX+'viztype-bubble').addClass(C.MAPBUILDER_PREFIX+'viztype-icon').appendTo(c);c.data("__viztype","bubble");c.attr("title",L.get('VIZ_MAPBUILDER_BUBBLE'));this._vizTypeButton$['bubble']=c;c=$('<button/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+"viztype").addClass(I);$("<div/>").addClass(C.MAPBUILDER_PREFIX+'viztype-marker').addClass(C.MAPBUILDER_PREFIX+'viztype-icon').appendTo(c);c.data("__viztype","marker");c.attr("title",L.get('VIZ_MAPBUILDER_MARKER'));this._vizTypeButton$['marker']=c;this._vizTypeButton$[this._config.selected].addClass(T);};b.prototype._addEventListeners=function(){var _=this;for(var k in this._vizTypeButton$){if(this._vizTypeButton$.hasOwnProperty(k)){this._vizTypeButton$[k].bind('click tap',function(e){for(var k in _._vizTypeButton$){if(_._vizTypeButton$.hasOwnProperty(k)){_._vizTypeButton$[k].removeClass(T);}}$(this).addClass(T);_._dispatchEvent(new G(G.CHANGE_LAYER_VIZTYPE,this,{vizType:$(this).data("__viztype")}));});}}};return b;});u('sap/viz/controls/common/helpers/Rectangle',[],function(){var R=function(l,t,w,h){this._left=l;this._top=t;this._width=w;this._height=h;};R.parseDOM=function(d){var o=d.offset();return new R(o.left,o.top,d.outerWidth(),d.outerHeight());};R.prototype.left=function(v){if(arguments.length>0){this._left=v;}else{return this._left;}};R.prototype.top=function(v){if(arguments.length>0){this._top=v;}else{return this._top;}};R.prototype.right=function(v){if(arguments.length>0){this.left(v-this.width());}else{return this.left()+this.width();}};R.prototype.bottom=function(v){if(arguments.length>0){this.top(v-this.height());}else{return this.top()+this.height();}};R.prototype.width=function(){return this._width;};R.prototype.height=function(){return this._height;};R.prototype.hCenter=function(){return this.left()+this.width()/2;};R.prototype.vCenter=function(){return this.top()+this.height()/2;};R.prototype.hContains=function(t){return this.left()<=t.left()&&this.right()>=t.right();};R.prototype.vContains=function(t){return this.top()<=t.top()&&this.bottom()>=t.bottom();};R.prototype.contains=function(t){return this.hContains(t)&&this.vContains(t);};R.toJSON=function(a){return{'left':a.left(),'top':a.top(),'width':a.width(),'height':a.height()};};return R;});u('sap/viz/controls/common/views/menu/PopUpMenuEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var P=function(t,a,d){P.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.common.views.PopUpMenuEvent';};O.extend(P,E);P.OPENED='opened';P.CLOSED='closed';P.ITEM_SELECTED='itemSelected';return P;});u('sap/viz/controls/common/views/menu/DockStrategy',[],function(){var D={};D.RIGHT='right';D.RIGHT_WITH_ARROW='rightWithArrow';D.LEFT='left';D.LEFT_WITH_ARROW='leftWithArrow';D.DOWN='down';D.DOWN_WITH_ARROW='downWithArrow';D.UP='up';D.UP_WITH_ARROW='upWithArrow';D._oppsosite=(function(){var o={};o[D.RIGHT]=D.LEFT;o[D.RIGHT_WITH_ARROW]=D.LEFT_WITH_ARROW;o[D.DOWN]=D.UP;o[D.DOWN_WITH_ARROW]=D.UP_WITH_ARROW;return o;})();D.oppsosite=function(s){for(var p in D._oppsosite){if(D._oppsosite.hasOwnProperty(p)){var n=D._oppsosite[p];if(p===s){return n;}else if(n===s){return p;}}}};D.arrow=function(s){return s===D.RIGHT_WITH_ARROW||s===D.LEFT_WITH_ARROW||s===D.DOWN_WITH_ARROW||s===D.UP_WITH_ARROW;};D.up=function(s){return s===D.UP||s===D.UP_WITH_ARROW;};D.down=function(s){return s===D.DOWN||s===D.DOWN_WITH_ARROW;};D.left=function(s){return s===D.LEFT||s===D.LEFT_WITH_ARROW;};D.right=function(s){return s===D.RIGHT||s===D.RIGHT_WITH_ARROW;};D.horizontal=function(s){return D.left(s)||D.right(s);};D.vertical=function(s){return D.up(s)||D.down(s);};return D;});u('sap/viz/controls/common/views/menu/PopUpMenu',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/common/views/menu/PopUpMenuEvent','sap/viz/controls/common/views/menu/DockStrategy'],function($,C,O,a,U,R,P,D){var c=C.COMMON_PREFIX;var b=function(d,m){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.menu.PopUpMenu";this._menuGroups=m;this._dock$=null;this._preferredDockStrategy=null;this._dockStrategy=null;this._hOffset=null;this._vOffset=null;this._subMenu=null;this._documentHandler=null;this._createChildren();this._dom$.appendTo($('body'));};O.extend(b,U);b.prototype.open=function(d,p,h,o){this._dock$=d;this._preferredDockStrategy=p;this._hOffset=h?h:0;this._vOffset=o?o:0;this._locate(this._preferredDockStrategy);this._dispatchEvent(new P(P.OPENED,this));this._documentHandler=$.proxy(function(e){var f=this._dock$[0];if(!$.contains(this._dom,e.target)&&((!this._subMenu&&(!$.contains(f,e.target)||f.nodeName!=='LI'))||(this._subMenu&&!$.contains(this._subMenu._dom,e.target)))){this.close();}},this);document.addEventListener("mousedown",this._documentHandler,true);$(window).on('blur',this._documentHandler);};b.prototype.close=function(){var d=this._dom$;document.removeEventListener("mousedown",this._documentHandler,true);$(window).off('blur',this._documentHandler);this._dispatchEvent(new P(P.CLOSED,this));this.removeAllEventListeners();a.delay(function(){d.removeClass(c+'menu-transition');d.detach();},240);this._dom$.css('opacity',0).addClass(c+'menu-transition');this.destroy();};b.prototype._createChildren=function(){var i,j;var d=this._dom$;d.addClass(c+'menu');var l=$('<div/>').addClass([c+'menu-list',C.COMMON_PREFIX+'scrollable',C.COMMON_PREFIX+'scrollable-y'].join(' ')).appendTo(d);var e=$('<ul/>').appendTo(l);for(i=0;i<this._menuGroups.length;i++){var m=this._menuGroups[i];for(j=0;j<m.menuItems().length;j++){var f=m.menuItems()[j];var g=$('<li/>').appendTo(e);g.addClass(c+'menu-list-prefix-icon-x1');g.data('item',f);if(m.selectedItem()===f){g.addClass(c+'menu-list-selected');}g.on('mouseenter',function(n){$('li',e).each(function(){var g=$(this);if(this===n.currentTarget){g.addClass(c+'menu-list-hovered');}else{g.removeClass(c+'menu-list-hovered');}});}).on('mouseleave',function(n){});g.on('click',$.proxy(function(n){var g=$(n.currentTarget);var f=g.data('item');if(f.subMenuGroups()){return;}else{this._dispatchEvent(new P(P.ITEM_SELECTED,this,{'selectedItem':f}));this.close();}},this));var h=$('<div/>').addClass([c+'menu-list-caption',c+'text-ellipsis'].join(' ')).appendTo(g);h.text(f.name());var k=false;g.on('mouseenter',$.proxy(function(n){this._closeSubMenu();},this)).on('mouseleave',$.proxy(function(n){var g=$(n.currentTarget);var f=g.data('item');a.defer($.proxy(function(){if(!k){this._closeSubMenu();}},this));},this));if(f.subMenuGroups()){g.addClass(c+'menu-list-suffix-icon-x1');$('<div/>').addClass([c+'menu-list-suffix-icon-submenu',c+'havanaSharedSprite16'].join(' ')).appendTo(g);g.on('mouseenter',$.proxy(function(n){var g=$(n.currentTarget);var f=g.data('item');k=f.subMenuGroups().length>0;if(f.subMenuGroups().length>0){this._subMenu=new b(document.createElement('div'),f.subMenuGroups());this._subMenu.addEventListener(P.ITEM_SELECTED,function(n){this._dispatchEvent(n);this.close();},this);this._subMenu.open(g,D.RIGHT,-6,6);$(this._subMenu._dom).on('mouseenter',$.proxy(function(n){k=true;},this));}},this));}}if(i!==this._menuGroups.length-1){var s=$('<div/>').addClass(c+'menu-list-group-splitter').appendTo(e);}}};b.prototype._closeSubMenu=function(){if(this._subMenu){$(this._subMenu._dom).off('mouseenter');this._subMenu.close();this._subMenu=null;}};b.prototype._locate=function(d){var e=(d===this._preferredDockStrategy);var f=false;var t={'from':{'visibility':'hidden','opacity':0},'to':{'visibility':'','opacity':1}};var g=6;var h=6;var k=R.parseDOM(this._dock$);var m=R.parseDOM(this._dom$);var l=R.parseDOM($('body'));var w=D.arrow(d);if(D.horizontal(d)){if(D.left(d)){h*=-1;g*=-1;m.right(k.left()+g-this._hOffset);}else if(D.right(d)){m.left(k.right()+g+this._hOffset);}m.top(k.top()+this._vOffset);f=!l.hContains(m);t.from.left=m.left()-h+'px';t.to.left=m.left()+'px';t.from.top=t.to.top=m.top()+'px';}else if(D.vertical(d)){if(w){m.left(k.hCenter()-m.width()*3/4+this._hOffset);}else{m.left(k.left()+this._hOffset);}if(D.up(d)){h*=-1;g*=-1;m.bottom(k.top()+g+this._vOffset);}else if(D.down(d)){m.top(k.bottom()+g+this._vOffset);}f=!l.vContains(m);t.from.left=t.to.left=m.left()+'px';t.from.top=m.top()-h+'px';t.to.top=m.top()+'px';}if(e&&f){this._locate(D.oppsosite(d));}else{this._dockStrategy=d;if(t){this._dom$.css(t.from);a.defer($.proxy(function(){this._dom$.css(t.to).addClass(c+'menu-transition');},this));a.delay($.proxy(function(){this._dom$.removeClass(c+'menu-transition');},this),240);}}};return b;});u('sap/viz/controls/common/feeds/SubtotalItemType',['sap/viz/controls/common/managers/LangManager'],function(L){var S=function(){this.__className="sap.viz.controls.common.feeds.SubtotalItemType";};S.action='addSubTotal';S.TOTAL='default';S.SUM='sum';S.MIN='min';S.MAX='max';S.COUNT='count';S.AVG='average';S.getAggregationType=function(t){if(t.indexOf(S.TOTAL)!==-1){return S.TOTAL;}else if(t.indexOf(S.SUM)!==-1){return S.SUM;}else if(t.indexOf(S.MIN)!==-1){return S.MIN;}else if(t.indexOf(S.MAX)!==-1){return S.MAX;}else if(t.indexOf(S.COUNT)!==-1){return S.COUNT;}else if(t.indexOf(S.AVG)!==-1){return S.AVG;}return null;};S.getSubTotalsAggregationDisplayType=function(a){switch(a){case S.SUM:return L.get('VIZ_COMMON_SUM_OF');case S.MIN:return L.get('VIZ_COMMON_MIN_OF');case S.MAX:return L.get('VIZ_COMMON_MAX_OF');case S.COUNT:return L.get('VIZ_COMMON_COUNT_OF');case S.AVG:return L.get('VIZ_COMMON_AVERAGE_OF');case S.TOTAL:return L.get('VIZ_COMMON_TOTAL_OF');default:return" ";}};S.sanitizeAnalysisObjects=function(a){for(var i=0;i<a.length;i++){var t=a[i].name();if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.TOTAL))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.TOTAL),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.SUM))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.SUM),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.MIN))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.MIN),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.MAX))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.MAX),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.COUNT))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.COUNT),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.AVG))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.AVG),a[i]);}}return a;};S.removeSubtotalItemTokenFromName=function(t,a){var b=t.length;var c=a.name().substr(b+1);a.name(c);};return S;});u('sap/viz/controls/common/menu/MenuExtensionBuilder',[],function(){var _=null;var M=function(){this.__className="sap.viz.controls.common.menu.MenuExtensionBuilder";};var a=function(g){if(g&&(g.indexOf("http://")===0||g.indexOf("https://")===0||g.indexOf("/")===0)){return true;}return false;};var b=function(g){var h=g.split("?");var l=h[0];var p={};if(h.length>1){var k=h[1].split("&");for(var i=0;i<k.length;i++){var m=k[i];var n=m.split("=");if(n.length===2){p[n[0]]=n[1];}}}return{location:l,parameters:p};};var c=function(m,g){if(m&&sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getServiceMetadata!==undefined){var h=[];if(g){h=sap.bi.framework.getServiceMetadata("*sap.bi.framework.ui.menugroup");}else{h=sap.bi.framework.getServiceMetadata("*sap.bi.framework.ui.menuitem");}for(var i=0;i<h.length;i++){var k=h[i];if(k.framework&&k.id===m){return k.framework.bundleUrl;}}}return null;};var d=function(g,n){g.push(n);var h=g.slice(0);for(var i=0;i<h.length;i++){var k=h[i];if(k._locationBefore||k._locationAfter){for(var j=0;j<g.length;j++){var l=g[j];if(l.id===k._locationBefore){var m=g.indexOf(k);g.splice(m,1);g.splice(j,0,k);break;}else if(l.id===k._locationAfter){var m=g.indexOf(k);g.splice(m,1);g.splice(j+1,0,k);break;}}}}};var e=function(){var g=[];if(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getService!==undefined){var m=sap.bi.framework.getService("*","*sap.bi.framework.ui.menugroup");var h=sap.bi.framework.getService("*","*sap.bi.framework.ui.menuitem");m=JSON.parse(JSON.stringify(m));h=JSON.parse(JSON.stringify(h));for(var i=0;i<m.length;i++){var k=m[i];if(k&&k.location){var l=b(k.location);var p=l.location;k._locationBefore=l.parameters["before"];k._locationAfter=l.parameters["after"];if(!k.subMenuItems){k.subMenuItems=[];}if(k.icon&&k.icon.url&&a(k.icon.url)===false){var n=c(k.id);if(n){k.icon.url=n+"/"+k.icon.url;}}for(var j=0;j<m.length;j++){var o=m[j];if(o!==k&&o.id===p){k.parentMenuGroup=o;if(!o.subMenuItems){o.subMenuItems=[];}d(subMenuItems,k);break;}}if(!k.parentMenuGroup){g.push(k);}}}for(var i=0;i<h.length;i++){var q=h[i];if(q&&q.location){var l=b(q.location);var p=l.location;q._locationBefore=l.parameters["before"];q._locationAfter=l.parameters["after"];if(q.icon&&q.icon.url&&a(q.icon.url)===false){var n=c(q.id);if(n){q.icon.url=n+"/"+q.icon.url;}}for(var j=0;j<m.length;j++){var o=m[j];if(o.id===p){q.parentMenuGroup=o;if(!o.subMenuItems){o.subMenuItems=[];}d(subMenuItems,q);break;}}}}}return g;};var f=function(m,l){for(var i=0;i<m.length;i++){var g=m[i];if(g.id===l){return g;}else if(g.subMenuItems&&g.subMenuItems.length>0){g=f(g.subMenuItems,l);if(g){return g;}}}return null;};M.getMenu=function(l){if(!_){_=e();}return f(_,l).subMenuItems;};M.clearCache=function(){_=null;};return M;});u('sap/viz/controls/common/views/feed/FeedingShelf',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/UIControl','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/FeedingShelfEvent','sap/viz/controls/common/views/menu/PopUpMenu','sap/viz/controls/common/views/menu/PopUpMenuEvent','sap/viz/controls/common/views/menu/DockStrategy','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/views/menu/MenuItem','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/SubtotalItemType','sap/viz/controls/common/menu/MenuExtensionBuilder'],function($,O,U,C,a,D,b,F,P,c,d,M,e,L,f,g,h,k,H,S,l){var m=function(n,s){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedingShelf";this._dom$.addClass(C.FEEDINGSHELF_PREFIX+"view");this._list$=null;this._ghostCard$=null;this._draggingCard$=null;this._addIndicator$=null;this._addIcon$=null;this._activeHandler=$.proxy(this._active,this);this._dropIndicator$=$(document.createElement('hr')).addClass(C.FEEDINGSHELF_PREFIX+'drop-indicator');this._shelf=s;this._lastCardRemoved=null;this._lastAnalysisObjectRemoved=null;this._lastTwinAnalysisObjectRemoved=null;this._lastHierarchyOjbectUpdated=null;this._createChildren();this._droppable();this._enableFeeding=true;};O.extend(m,a);m.CARD_HEIGHT=24;m.prototype.shelf=function(){return this._shelf;};m.prototype.popUpDock=function(){var _=this;return function(){var o=_._list$.offset();return{'x':o.left,'y':o.top+m.CARD_HEIGHT/2,'shelfWidth':_._list$.outerWidth()};}};m.prototype.analyses=function(v){if(arguments.length>0){var i;var n={};for(i=0;i<v.length;){if(!n[v[i].id()]){n[v[i].id()]=true;i++;}else{v.splice(i,1);}}this._traversalCards(function(){$(this).remove();},true,true);for(i=0;i<v.length;i++){this._addCardAt(v[i],-1);}this._analysesChanged();return this;}else{var o=[];this._traversalCards(function(p){var q=$(this);var r=q.data('__analysis');if(r){o.push(r);}},true,true);return o;}};m.prototype._numCards=function(){var n=0;this._traversalCards(function(o){n++;},true,true);return n;};m.prototype.addAnalysis=function(n){return this._addAnalysisAt(n,-1);};m.prototype._addAnalysisAt=function(n,o){this._lastCardRemoved=null;this._lastAnalysisObjectRemoved=null;var p=this._addCardAt(n,o);this._analysesChanged();return p;};m.prototype.lastAnalysisObjectRemoved=function(n){if(arguments.length>0){this._lastAnalysisObjectRemoved=n;}else{return this._lastAnalysisObjectRemoved;}};m.prototype.lastCardRemoved=function(n){if(arguments.length>0){this._lastCardRemoved=n;}else{return this._lastCardRemoved;}};m.prototype.lastTwinAnalysisObjectRemoved=function(n){if(arguments.length>0){this._lastTwinAnalysisObjectRemoved=n;}else{return this._lastTwinAnalysisObjectRemoved;}};m.prototype.lastHierarchyOjbectUpdated=function(n){if(arguments.length>0){this._lastHierarchyOjbectUpdated=n;}else{return this._lastHierarchyOjbectUpdated;}};m.prototype.destroy=function(){this.removeAllEventListeners();$('body').off('mouseup',this._activeHandler);m.superclass.destroy.apply(this,arguments);};m.prototype._createChildren=function(){var n=$(document.createElement('div')).appendTo(this._dom$).addClass(C.FEEDINGSHELF_PREFIX+'item');var o=$(document.createElement('div')).appendTo(n).addClass(C.FEEDINGSHELF_PREFIX+'item-title');o.text(this._shelf.name);var p=$(document.createElement('div')).appendTo(n).addClass(C.FEEDINGSHELF_PREFIX+'item-content');var q=this._list$=$(document.createElement('div')).appendTo(p).addClass(C.FEEDINGSHELF_PREFIX+'item-list');var r=this._addIndicator$=$(document.createElement('div')).appendTo(q);r.addClass(C.FEEDINGSHELF_PREFIX+'item-ph');var s=$(document.createElement('a')).appendTo(r);s.addClass(C.FEEDINGSHELF_PREFIX+'item-ph-text');var t=this._addIcon$=$(document.createElement('div')).appendTo(p).addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');t.addClass(C.FEEDINGSHELF_PREFIX+'item-add-icon');var v=$.proxy(this._dispatchAddFeedingEvent,this);r.on('mousedown',this._activeHandler).on('mouseenter',this._activeHandler).on('mouseleave',this._activeHandler).on('click',v);t.on('mousedown',this._activeHandler).on('mouseenter',this._activeHandler).on('mouseleave',this._activeHandler).on('click',v);$('body').on('mouseup',this._activeHandler);};m.prototype._dispatchAddFeedingEvent=function(){if(this.enableFeeding()){this._dispatchEvent(new F(F.CLICK_ADD_FEEDING,this));}};m.prototype._active=function(n){if(this._enableFeeding){if(n.type==='mouseup'||n.type==='mouseleave'){this._list$.removeClass(C.FEEDINGSHELF_PREFIX+'item-list_active');this._addIcon$.removeClass(C.FEEDINGSHELF_PREFIX+'item-add-icon_active');}else if(n.type==='mousedown'||n.type==='mouseenter'){this._list$.addClass(C.FEEDINGSHELF_PREFIX+'item-list_active');this._addIcon$.addClass(C.FEEDINGSHELF_PREFIX+'item-add-icon_active');}}};m.prototype._isValidToken=function(n){if(this._draggingCard$){return true;}if(n.aggregationTarget()!==undefined){return false;}var t=n.type();var o=n.dataType();var p=t?t.toLowerCase():t;var q=o?o.toLowerCase():o;var s=this._shelf.feedItemType;var v=h.feedCompatible(s,p,q);if(v){var r=this.analyses();for(var i=0;i<r.length;i++){if(r[i].id()===n.id()||r[i].aggregationTarget()===n.id()){v=false;break;}}}return v;};m.prototype._droppable=function(){var _=this;var n;var o;var p;var q=function(s,t){t.killRevertAnimation();if(n){t.currentAction(b.ACCEPT_AS_REPLACEMENT);$(n).detach();}else{t.currentAction(b.ACCEPT);}_._addAnalysisAt(s,o);};var r=function(s,t,v){if(_._numCards()===0){t.off('sap.viz.controls.analysisDrag.events.drag');if(!_._enableFeeding){v.currentAction(b.DENY);var w=L.get('VIZ_COMMON_DIMENSION_LIMITATION_WARN');v.showWarn(w);return;}else{_._ghostCard$=_._addGhostAnalysisAt(s,0);v.currentAction(b.ACCEPT);}}else{t.on('sap.viz.controls.analysisDrag.events.drag',function(x,y,z){var E=[];var G=-1;_._traversalCards(function(N){if(_._draggingCard$&&_._draggingCard$[0]===this){G=N;}E.push({'card':this,'offset':$(this).offset()});},false,true);o=-1;n=null;for(var i=0;i<E.length;i++){var I=E[i].offset.top;if(z<I+m.CARD_HEIGHT-6){o=i;if(z>=I+2){}break;}}if(o===-1){o=E.length;}if(s.type===f.MND){o=(o<E.length/2)?0:E.length;}if(!_._draggingCard$&&_._numCards()===_._shelf.capacity){n=E[o===E.length?o-1:o].card;}var J=G!==-1;var K=J&&(G===o||(G+1===o&&!n));if(J){n=null;}_._dropIndicator$.detach();if(n){v.currentAction(b.ACCEPT_AS_REPLACEMENT);}else{if(!_._enableFeeding){v.currentAction(b.DENY);var w=L.get('VIZ_COMMON_DIMENSION_LIMITATION_WARN');v.showWarn(w);}else{v.currentAction(b.ACCEPT);if(!K){_._addElementAt(_._list$,_._dropIndicator$,o);}}}});}};this._list$.droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,activate:function(s,t){},deactivate:$.proxy(function(s,t){if(this._ghostCard$){this._ghostCard$.remove();}if(this._dropIndicator$){this._dropIndicator$.detach();}},this),drop:$.proxy(function(s,t){var v=t.helper;var w=D.instance().getAnalysisToken(v);var x=w.analysisObject;if(w.currentAction()!==b.DENY&&this._isValidToken(x)){q(x,w);}else if(w.currentAction()!==b.DENY&&U.isArray(w.backupAOs)){var y=false;for(var i=0;i<w.backupAOs.length;i++){if(this._isValidToken(w.backupAOs[i])){q(w.backupAOs[i],w);y=true;break;}}if(!y){w.currentAction(b.DENY);}}else{w.currentAction(b.DENY);}w.dropTarget(this._shelf);if(this._ghostCard$){this._ghostCard$.remove();}this._dropIndicator$.detach();},this),over:function(s,t){var v=t.helper;p='over';U.defer(function(){if(p!='over'){return;}var w=D.instance().getAnalysisToken(v);var x=w.analysisObject;if(_._isValidToken(x)){r(x,v,w);}else if(U.isArray(w.backupAOs)){var y=false;for(var i=0;i<w.backupAOs.length;i++){if(_._isValidToken(w.backupAOs[i])){r(w.backupAOs[i],v,w);y=true;break;}}if(!y){w.currentAction(b.DENY);}}else{w.currentAction(b.DENY);}});},out:$.proxy(function(s,t){var v=t.helper;p='out';v.off('sap.viz.controls.analysisDrag.events.drag');var w=D.instance().getAnalysisToken(v);w.playDefaultAction();if(this._ghostCard$){this._ghostCard$.remove();}this._dropIndicator$.detach();w.showWarn();},this)});};m.prototype._traversalCards=function(n,o,p){var q=this._list$.children();var r=0;for(var i=0;i<q.length;i++){var s=q[i];if(this._addIndicator$&&this._addIndicator$[0]===s){continue;}if(this._dropIndicator$&&this._dropIndicator$[0]===s){continue;}if(o&&this._draggingCard$&&this._draggingCard$[0]===s){continue;}if(p&&this._ghostCard$&&this._ghostCard$[0]===s){continue;}n.call(s,r);r++;}};m.prototype._addGhostAnalysisAt=function(n,o){var p=this._addCardAt(n,o);p.addClass(C.FEEDINGSHELF_PREFIX+'card-ghost');return p;};m.prototype.removeCard=function(n){if(n.data){this._lastAnalysisObjectRemoved=n.data('__analysis');}this._lastCardRemoved=n;n.remove();this._analysesChanged();};m.prototype._analysesChanged=function(){var n=this._numCards();if(n>=1){this._addIndicator$.addClass(C.FEEDINGSHELF_PREFIX+'item-ph-half');}else{this._addIndicator$.removeClass(C.FEEDINGSHELF_PREFIX+'item-ph-half');}if(n>=this._shelf.capacity){this._addIcon$.css('display','none');this._addIndicator$.detach();}else{this._addIcon$.css('display','');this._addIndicator$.appendTo(this._list$);}this._dispatchEvent(new F(F.FEEDING_CHANGED,this));};m.prototype._updateCard=function(n,o){var p;if(o.type()===f.HIERARCHY){p=o.selectedHierarchyLevel().name();this._lastHierarchyOjbectUpdated=o;}else{p=o.name();}n.data('__analysis',o);n.attr('title',p);var t=$('.'+C.FEEDINGSHELF_PREFIX+'card-text',n);t.text(p);};m.prototype._genHierarchyMenuGroups=function(n){var o=[];var p=n.hierarchyLevels();if(n.aggregationType()!==undefined){S.sanitizeAnalysisObjects(p);}for(var i=0;i<p.length;i++){var q=p[i];var r=new e(q.id(),q.name());r.selected(q.selected());o.push(r);}var s=[new M(o,true)];var t=n.actions();if(t){for(var i=0;i<t.length;i++){var v=t[i];s.push(v);}}return s;};m.prototype._genMenuGroups=function(n){return n.actions();};m.prototype._addCardAt=function(n,o){var p=$(document.createElement('div')).addClass(C.FEEDINGSHELF_PREFIX+'card');p.attr('id',n.id());var q=0;var i,j;var r,s,t,v;if(n.type()===f.HIERARCHY){var w=$(document.createElement('span')).appendTo(p);w.addClass([C.FEEDINGSHELF_PREFIX+'hierarchy-card-icon',C.COMMON_PREFIX+'UVBSharedSprite'].join(' '));this._createCardAction(p,this._genHierarchyMenuGroups,$.proxy(function(E){var G=E.data.selectedItem.id();var I=false;var J=n.hierarchyLevels();for(i=0;i<J.length;i++){if(J[i].id()===G){I=true;break;}}if(I){n=n.clone();n.selectedHierarchyLevelID(E.data.selectedItem.id());this._updateCard(p,n);this._dispatchEvent(new F(F.FEEDING_CHANGED,this));}else{this._dispatchEvent(new F(F.ACTION_CHANGED,this,{'feedItemID':this._shelf.id,'analysisObjectID':n.id(),'actionID':E.data.selectedItem.id()}));}},this),n);q++;}else if(n.actions()&&n.actions().length>0){this._createCardAction(p,this._genMenuGroups,$.proxy(function(E){this._dispatchEvent(new F(F.ACTION_CHANGED,this,{'feedItemID':this._shelf.id,'analysisObjectID':n.id(),'actionID':E.data.selectedItem.id()}));},this),n);q++;}var x=$(document.createElement('div')).appendTo(p);x.attr('style','width:19px; height:22px;');x.addClass(C.FEEDINGSHELF_PREFIX+'card-operation-div');var y=$(document.createElement('span')).appendTo(x);y.addClass(C.FEEDINGSHELF_PREFIX+'card-operation '+C.COMMON_PREFIX+'havanaSharedSprite16');x.click($.proxy(function(){this.removeCard(p);},this));q++;var z=$(document.createElement('div')).appendTo(p);z.addClass([C.FEEDINGSHELF_PREFIX+'card-text',C.FEEDINGSHELF_PREFIX+'card-text-with-icon-'+q].join(' '));z.addClass(C.COMMON_PREFIX+'text-ellipsis');this._updateCard(p,n);this._addElementAt(this._list$,p,o);this._draggable(p);return p;};m.prototype.getCardFromAnalysisObject=function(n){var o;var t=this._list$[0];if(n.dataType()===k.LEVEL||n.dataType()===k.HIERARCHY){var p=n.hierarchyLevels();for(var i=0;i<p.length;i++){var q=p[i];if(q.selected()){o=q._name;}}}else{o=n.name();}for(var i=0;i<t.childNodes.length;i++){var r=t.childNodes[i];if(r.innerText.indexOf(o)!==-1){return $(r);}else if(r.textContent&&r.textContent.indexOf(o)!==-1){return $(r);}}return null;};m.prototype._createCardAction=function(n,o,p,q){var r=$(document.createElement('div')).appendTo(n);r.attr('style','width:19px; height:22px;');r.addClass(C.FEEDINGSHELF_PREFIX+'action-icon-div');var s=$(document.createElement('span')).appendTo(r);if(q.type()===f.HIERARCHY){n.addClass(C.FEEDINGSHELF_PREFIX+'card-hierarchy');s.addClass([C.FEEDINGSHELF_PREFIX+'action-icon-hierarchy',C.COMMON_PREFIX+'UVBSharedSprite'].join(' '));}if(q.actions()){n.addClass(C.FEEDINGSHELF_PREFIX+'card-measure');s.addClass([C.FEEDINGSHELF_PREFIX+'action-icon-measure',C.COMMON_PREFIX+'havanaSharedSprite16'].join(' '));}r.on('click',$.proxy(function(){var t=new P(document.createElement('div'),o.call(this,n.data('__analysis')));t.addEventListener(c.ITEM_SELECTED,p,this);t.open(r,d.DOWN_WITH_ARROW);},this));return r;};m.prototype._addElementAt=function(n,o,p){var q=n.children();if(p!==-1&&p<q.length){$(q[p]).before(o);}else{n.append(o);}};m.prototype._draggable=function(n){var _=this;D.enableDraggableFeeding(n[0],n.data('__analysis'));n.draggable({containment:'document',revert:'valid',helper:function(o){var p=D.getDefaultHelper(this);var t=D.instance().getAnalysisToken($(p));t.defaultAction(b.AS_TRASH);return p;},start:$.proxy(function(o,p){this._draggingCard$=$(this);this._draggingCard$.addClass(C.FEEDINGSHELF_PREFIX+'card-ghost');var q=p.helper;var t=D.instance().getAnalysisToken(q);var r=t.analysisObject;var s={'analysisObject':r,'feedId':this._shelf.id};this._dispatchEvent(new F(F.FEEDING_EMPTY_CHANGED,this,s));},this),stop:function(o,p){var q=p.helper;if(_._draggingCard$){_._draggingCard$.removeClass(C.FEEDINGSHELF_PREFIX+'card-ghost');_._draggingCard$=null;}var t=D.instance().getAnalysisToken(q);if(!t.dropTarget()||t.currentAction()===b.ACCEPT||t.currentAction()===b.ACCEPT_AS_REPLACEMENT){_.removeCard($(this));}else{var r={'analysisObject':t.analysisObject,'feedId':_._shelf.id};_._dispatchEvent(new F(F.FEEDING_DROP_DENY,this,r));}},drag:function(o,p){}});};m.prototype.enableFeeding=function(n){if(arguments.length>0){this._enableFeeding=n;this._updateFeedingEnabled(n);}else{return this._enableFeeding;}};m.prototype._updateFeedingEnabled=function(n){if(n){this._list$.css('cursor','pointer');this._addIcon$.css('display','block');}else{this._list$.css('cursor','default');this._addIcon$.css('display','none');}};m.prototype.resetLastRemoved=function(){this._lastAnalysisObjectRemoved=null;this._lastCardRemoved=null;};m.prototype.resetTwinAnalysisObject=function(){this._lastTwinAnalysisObjectRemoved=null;};m.langProps={'changeCalculation':'VIZ_COMMON_CHANGE_CALCULATION','sum':'VIZ_COMMON_SUM','average':'VIZ_COMMON_AVERAGE','min':'VIZ_COMMON_MIN','max':'VIZ_COMMON_MAX','countDistinct':'VIZ_COMMON_COUNT_DISTINCT','countAll':'VIZ_COMMON_COUNT_ALL','none':'VIZ_COMMON_NONE','sum_short':'VIZ_COMMON_SUM_SHORT','average_short':'VIZ_COMMON_AVERAGE_SHORT','min_short':'VIZ_COMMON_MIN_SHORT','max_short':'VIZ_COMMON_MAX_SHORT','countDistinct_short':'VIZ_COMMON_COUNT_DISTINCT_SHORT','countAll_short':'VIZ_COMMON_COUNT_ALL_SHORT','none_short':'VIZ_COMMON_NONE_SHORT'};return m;});u('sap/viz/controls/common/views/feed/FeedListEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedListEvent";};O.extend(F,E);F.DROP_DOWN_OPENED="dropDownOpened";F.DROP_DOWN_CLOSED="dropDownClosed";F.ITEM_SELECTED="itemSelected";return F;});u('sap/viz/controls/common/constants/KeyboardEventConst',[],function(){var K={};K.UP=38;K.DOWN=40;K.ENTER=13;K.SPACE=32;K.ESC=27;K.SUBTRACT=45;K.DECIMAL=46;K.NUM_0=48;K.NUM_9=57;return K;});u('sap/viz/controls/common/views/feed/FeedList',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/constants/KeyboardEventConst'],function($,C,a,O,U,F,L,b,c,d,K){var e=function(g,h,k,l){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedList";this._dom$=$(g);this._analyses=h;this._feedingType=k;this._dataProvider=[];var i,j;var m=function(o){for(var i=0;i<l.length;i++){if(l[i].id()===o){return true;}}return false;};if(h){for(i=0;i<h.length;i++){var n=h[i];if(m(n.id())){continue;}if(d.feedCompatible(this._feedingType,n.type(),n.dataType())){this._dataProvider.push({'label':n.name(),'analysis':n});}}}this._header={'label':L.get(e.langProps[this._feedingType]),'suffix':this._dataProvider.length};this._container$=null;this._content$=null;this._header$=null;this._ul$=null;this._arrow$=null;this._createChildren();this._dock=null;this._calDockPosFun=null;this._resizeHandler=null;this._documentHandler=null;this._keyDownHandlerProvider=$.proxy(this._keyDownHandler,this);this._mouseMoveHandlerProvider=$.proxy(this._mouseMoveHandler,this);};O.extend(e,U);e.langProps={'Measure':'VIZ_COMMON_MEASURES','Dimension':'VIZ_COMMON_DIMENSIONS','Geography':'VIZ_COMMON_DIMENSIONS','Subtotal':'VIZ_COMMON_SUBTOTALS'};var S='down';var f='up';e.prototype.locate=function(g,o){var h=this._dom$;var k=this._ul$;var l=k.outerHeight();var m=Math.max($(document.body).height(),$(window).height());var n=m-this._header$.outerHeight()-15;if(l>n){l=n;}k.outerHeight(l);var p=l+this._header$.outerHeight()+5;var q=Math.max(k.outerWidth(),this._header$.outerWidth());var r=this._arrow$.outerWidth();var s='left';if(o==='left'||o==='right'){s=o;}else if(q+r*3/4>g.x){s='right';}var t=8;var v=this._arrow$.outerHeight()+18;var w=Math.max(0,g.y-m+v/2+t);g.y=Math.min(g.y,m-v/2-t);var x=Math.max(g.y-w+v/2+t-p,5);var y=Math.min(g.y-x-12,m-v-t-x-w);var z=2;if(s==='right'){this._container$.addClass(C.COMMON_PREFIX+'feedlist-container-right');h.css({"left":g.x+g.shelfWidth+r*3/4,"top":x});this._arrow$.css({"left":-r/2+z,"top":y});}else if(s==='left'){this._container$.addClass(C.COMMON_PREFIX+'feedlist-container-left');h.css({"left":g.x-q-r*3/4,"top":x});this._arrow$.css({"left":q-r/2-z,"top":y});}this._content$.css({'width':q+'px','height':p+'px'});this._container$.css({'width':q+2+'px','height':p+'px'});};e.prototype.open=function(g){if(typeof(g)==='function'){this._dock=g();this._calDockPosFun=g;}else{this._dock=g;}var h=this._dom$;h.appendTo($("body"));this._dispatchEvent(new F(F.DROP_DOWN_OPENED,this));this.locate(this._dock);this._documentHandler=$.proxy(function(k){if(!$.contains(this._dom,k.target)){this.close();}},this);this._addEventListeners();document.addEventListener("mousedown",this._documentHandler,true);document.addEventListener("keydown",this._keyDownHandlerProvider,true);$(window).on('blur',this._documentHandler);this._cursorShowed=true;};e.prototype.close=function(){var g=this._dom$;var h=1;if(this._classVisible){g.removeClass(this._classVisible);h=2000;}setTimeout(function(){g.detach();},h);document.removeEventListener("mousedown",this._documentHandler,true);document.removeEventListener("keydown",this._keyDownHandlerProvider,true);document.removeEventListener("mousemove",this._mouseMoveHandlerProvider,true);$(window).off('blur',this._documentHandler);$(window).off('resize',this._resizeHandler);this._dispatchEvent(new F(F.DROP_DOWN_CLOSED,this));if(!this._cursorShowed){$('.'+C.COMMON_PREFIX+'hide-cursor').removeClass(C.COMMON_PREFIX+'hide-cursor');}this._calDockPosFun=null;this.destroy();};e.prototype._createChildren=function(g){this._dom$.addClass(C.COMMON_PREFIX+'feedlist');var _=this;var h=this._container$=$(document.createElement('div')).appendTo(this._dom$);h.addClass(C.COMMON_PREFIX+'feedlist-container');var k=this._arrow$=$(document.createElement('div')).appendTo(h);k.addClass(C.COMMON_PREFIX+'feedlist-arrow');k.addClass(C.PREFIX+'feedlist');var l=this._content$=$(document.createElement('div')).appendTo(h);l.addClass(C.COMMON_PREFIX+'feedlist-content');var m=this._header$=$(document.createElement('div')).appendTo(l).text(this._header.label);m.addClass(C.COMMON_PREFIX+'feedlist-content-header');var n=this._ul$=$(document.createElement('ul')).appendTo(l);n.addClass(C.COMMON_PREFIX+'scrollable');n.addClass(C.COMMON_PREFIX+'scrollable-y');var i;var o;for(i=0;i<this._dataProvider.length;i++){var p=$(document.createElement('li')).appendTo(n);var q=$(document.createElement('a')).appendTo(p);o=this._dataProvider[i];var r,s;var t=o.analysis.dataType();var v=d.isGeoHierarchyFeed(this._feedingType,o.analysis.type(),t);if((this._feedingType===c.DIMENSION&&o.analysis.type()===b.HIERARCHY)||v){var w=this._setHierarchyAnalysis(o.analysis.clone(),0);p.data('__item',w);r=$(document.createElement('div')).appendTo(p);r.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-indicator');s=$(document.createElement('div')).appendTo(r);s.addClass(C.COMMON_PREFIX+'UVBSharedSprite');if(t&&t.toLowerCase()===c.GEOGRAPHY.toLowerCase()){s.addClass(C.COMMON_PREFIX+'geography');}else{s.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-Icon');}var x=$(document.createElement('div')).appendTo(p);x.data('__items',o.analysis);x.addClass(C.COMMON_PREFIX+'feedlist-li-button');var y=$(document.createElement('div')).appendTo(x);y.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-plus-icon');x.attr('command','open');x.click(function(z){z.stopPropagation();_._expandButtonHandler(z);});p.click($.proxy(this._analysisSelectedHandler,this));}else{if(t&&t.toLowerCase()===c.GEOGRAPHY.toLowerCase()){r=$(document.createElement('div')).appendTo(p);r.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-indicator');s=$(document.createElement('div')).appendTo(r);s.addClass(C.COMMON_PREFIX+'geography');}p.data('__item',o.analysis);p.click($.proxy(this._analysisSelectedHandler,this));}p.hover($.proxy(function(z){this._highlightItem($(z.currentTarget));},this),$.proxy(function(z){this._unhighlightItem($(z.currentTarget));},this));q.text(o.label);q.addClass(C.COMMON_PREFIX+'text-ellipsis');if(o.suffix){q.addClass(C.COMMON_PREFIX+'feedlist-li-a_suffix').attr('__suffix',o.suffix);}if(o.icon){}}};e.prototype._expandButtonHandler=function(g){var h=$(g.currentTarget);if(h.attr('command')==='open'){this._openHierarchyItem(h);}else{this._closeHierarchyItem(h);}};e.prototype._setHierarchyAnalysis=function(h,i){var g=h.hierarchyLevels();for(var j=0;j<g.length;j++){var l=g[j];if(j===i){l.selected(true);}else{l.selected(false);}}return h;};e.prototype._analysisSelectedHandler=function(g){var _=this;var l=$(g.currentTarget);var h=l.data('__item');_._dispatchEvent(new F(F.ITEM_SELECTED,_,{'selectedItem':h}));_.close();};e.prototype._keyDownHandler=function(g){var k=g.keyCode;if(!g.ctrlKey&&(k===K.DOWN||k===K.UP)){if(this._cursorShowed){$("*").addClass(C.COMMON_PREFIX+'hide-cursor');this._cursorShowed=false;setTimeout($.proxy(function(){document.addEventListener('mousemove',this._mouseMoveHandlerProvider,true);},this),200);}}var l=$('.'+C.COMMON_PREFIX+'feedlist-li-highlight',this._ul$);switch(k){case K.UP:if(g.ctrlKey){var m=$('.'+C.COMMON_PREFIX+'feedlist-li-minus-icon',l);if(m[0]){this._closeHierarchyItem(m.parent());}}else if(l[0]!=this._ul$[0].firstChild){this._unhighlightItem(l);this._highlightItem(l.prev());if(l.offset().top-this._ul$.offset().top<l.height()){this._updateScrollBarPosition(l,f);}}break;case K.DOWN:if(g.ctrlKey){var p=$('.'+C.COMMON_PREFIX+'feedlist-li-plus-icon',l);if(p[0]){this._openHierarchyItem(p.parent());}}else{if(!l[0]){this._highlightItem($(this._ul$[0].firstChild));}else if(l[0]!=this._ul$[0].lastChild){this._unhighlightItem(l);this._highlightItem(l.next());if(l.offset().top+l.height()>this._ul$.offset().top+this._ul$.height()){this._updateScrollBarPosition(l,S);}}}break;case K.ENTER:case K.SPACE:if(l[0]){this._selectItem(l);}break;case K.ESC:this.close();break;}};e.prototype._validateSize=function(){if(!!this._calDockPosFun&&typeof(this._calDockPosFun)==='function'){this.locate(this._calDockPosFun());}};e.prototype._resizer=function(g){var _=this;if(!g.data.invalidateSize){setTimeout(function(){g.data.invalidateSize=false;_._validateSize();},1000/24);}g.data.invalidateSize=true;};e.prototype._addEventListeners=function(){this._resizeHandler=$.proxy(this._resizer,this);$(window).resize({'invalidateSize':false},this._resizeHandler);};e.prototype._mouseMoveHandler=function(g){if(!this._cursorShowed){$('.'+C.COMMON_PREFIX+'hide-cursor').removeClass(C.COMMON_PREFIX+'hide-cursor');this._cursorShowed=true;document.removeEventListener('mousemove',this._mouseMoveHandlerProvider,true);var l=$('.'+C.COMMON_PREFIX+'feedlist-li-highlight',this._ul$);this._unhighlightItem(l);}};e.prototype._highlightItem=function(l){l.addClass(C.COMMON_PREFIX+'feedlist-li-highlight');};e.prototype._unhighlightItem=function(l){l.removeClass(C.COMMON_PREFIX+'feedlist-li-highlight');};e.prototype._selectItem=function(l){var g=l.data('__item');this._dispatchEvent(new F(F.ITEM_SELECTED,this,{'selectedItem':g}));this.close();};e.prototype._openHierarchyItem=function(g){var h=g.data('__items');var k=h.hierarchyLevels();var l=g.parent();for(var i=0;i<k.length;i++){var m=$(document.createElement('li'));$(l).after(m);l=m;var s=$(document.createElement('span')).appendTo(m);var n=this._setHierarchyAnalysis(h.clone(),i);m.data('__item',n);s.text(k[i].name());s.addClass(C.COMMON_PREFIX+'text-ellipsis');m.click($.proxy(this._analysisSelectedHandler,this));m.hover($.proxy(function(o){this._highlightItem($(o.currentTarget));},this),$.proxy(function(o){this._unhighlightItem($(o.currentTarget));},this));}g.attr('command','close');g.addClass(C.COMMON_PREFIX+'feedlist-li-button-close');g.children().attr('class',C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-minus-icon');this._updateAllExpandButtons();};e.prototype._closeHierarchyItem=function(g){var h=g.data('__items');var k=h.hierarchyLevels();for(var j=0;j<k.length;j++){g.parent().next().remove();}g.attr('command','open');g.removeClass(C.COMMON_PREFIX+'feedlist-li-button-close');g.children().attr('class',C.COMMON_PREFIX+'havanaVXTabSprite16 '+C.COMMON_PREFIX+'feedlist-li-plus-icon');this._updateAllExpandButtons();};e.prototype._updateAllExpandButtons=function(){var h=this._ul$[0].scrollHeight>this._ul$.outerHeight();$('.'+C.COMMON_PREFIX+'feedlist-li-button').each(function(){$(this).removeClass(C.COMMON_PREFIX+'feedlist-li-button-offset');if(h){$(this).addClass(C.COMMON_PREFIX+'feedlist-li-button-offset');};});};e.prototype._updateScrollBarPosition=function(l,g){var h=this._ul$.scrollTop();if(g===S){var n=l.nextAll();var k=l.height()*n.length;if(k<=this._ul$.height()){h+=k;}else{h+=(this._ul$.scrollHeight()/l.height());}}else{var p=l.prevAll();var m=l.height()*p.length;if(m<=this._ul$.height()){h=0;}else{h-=(this._ul$.scrollHeight()/l.height());}}this._cursorShowed=true;this._ul$.scrollTop(h);setTimeout($.proxy(function(){this._cursorShowed=false;},this),500);};return e;});u('sap/viz/controls/mapbuilder/widgets/WidgetFeeding',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/views/feed/FeedingShelf","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils",'sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/events/FeedEvent',"sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/events/GeoEvent"],function($,O,U,C,L,F,a,b,c,d,f,g,h,k,W,l,G){var m={id:"location",name:"VIZ_MAPBUILDER_GEO",capacity:1,analysisType:"dimension",feedItemType:c.GEOGRAPHY};var P={id:"color",name:"VIZ_MAPBUILDER_GEO_COLOR",capacity:1,analysisType:"measure",feedItemType:c.MEASURE};var n={id:"color",name:"VIZ_MAPBUILDER_GEO_COLOR",capacity:1,analysisType:"dimension",feedItemType:c.DIMENSION};var o={id:"size",name:"VIZ_MAPBUILDER_GEO_SIZE",capacity:1,analysisType:"measure",feedItemType:c.MEASURE};var p=function(e,q){p.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetFeeding";this._feedMap=this._config.feedMap;this._measures=null;this._attributes=null;this._measures$=null;this._attributes$=null;this._feedingSelves={};this._feedingPanel$=$("<div/>").appendTo(e);this._vizType=this._config.vizType!=null?this._config.vizType:k.VIZ_TYPE_CHOROPLETH;this._titleMeasure=null;this._creatControls();this.update({feeding:this._config.feeding});};O.extend(p,W);p.prototype._prepareFeeding=function(v){if(v==k.VIZ_TYPE_CHOROPLETH){this._measures=[U.clone(P)];this._attributes=[U.clone(m)];}else if(v==k.VIZ_TYPE_BUBBLE){this._measures=[U.clone(o),U.clone(n)];this._attributes=[U.clone(m)];}else if(v==k.VIZ_TYPE_MARKER){this._measures=[];this._attributes=[U.clone(m)];}else{throw L.get('VIZ_MAPBUILDER_NOT_SUPPORT_ERROR');}var q=function(e){var w=e.target();this._uiShelf=w;if(this._config.feedingPanel&&this._config.feedingPanel.useBuildInFeedList===true){var x=w.shelf();var y=document.createElement('div');var z=this._getFeed(x.id);var D=z?z.values():[];var E=new f(y,this._allAnalyses,x.feedItemType,D);E.addEventListener(g.ITEM_SELECTED,function(H){var I=H.data.selectedItem;w.addAnalysis(I);},this);E.open(w.popUpDock());}else{this._dispatchEvent(new h(h.REQUEST_FEED,this,{'feedId':w.shelf().id,'fieldLocalPosition':w.popUpDock()}));}};if(this._measures.length>0){this._measures$.show();for(var i=0;i<this._measures.length;i++){var r=L.get(this._measures[i].name);this._measures[i].name=r?r:"Color";var s=new F(this._measures$,this._measures[i],this._feedMap);s.addEventListener(a.FEEDING_CHANGED,function(e){this._dispatchEvent(e);},this);s.addEventListener(a.CLICK_ADD_FEEDING,q,this);this._feedingSelves[this._measures[i].id]=s;s.addEventListener(a.ACTION_CHANGED,this._actionChangedHandler,this);}}else{this._measures$.hide();}if(this._attributes.length>0){for(var j=0;j<this._attributes.length;j++){this._attributes[j].name=L.get(this._attributes[j].name);var t=new F(this._attributes$,this._attributes[j],this._feedMap);t.addEventListener(a.FEEDING_CHANGED,function(e){this._dispatchEvent(e);},this);t.addEventListener(a.CLICK_ADD_FEEDING,q,this);this._feedingSelves[this._attributes[j].id]=t;t.addEventListener(a.ACTION_CHANGED,this._actionChangedHandler,this);}}};p.prototype._creatControls=function(){var r=$(this._dom);this._attributes$=$('<div/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+'feeding-container');this._measures$=$('<div/>').appendTo(r).addClass(C.MAPBUILDER_PREFIX+'feeding-container');this._prepareFeeding(this._vizType);};p.prototype.update=function(e){var q=e.feeding;if(q){for(var i=0;i<q.length;i++){var r=q[i];if(r){this._feedingSelves[r.id()].enableDispatchEvent(false);this._feedingSelves[r.id()].analyses(r.values());this._feedingSelves[r.id()].enableDispatchEvent(true);}}}};p.prototype.changeFeeding=function(t){this._measures$.empty();for(var e in this._feedingSelves){if(this._feedingSelves.hasOwnProperty(e)){this._feedingSelves[e].removeAllEventListeners();}}this._feedingSelves={};this._attributes$.empty();this._prepareFeeding(t);};p.prototype.getFeeds=function(){var e=[];for(var q in this._feedingSelves){if(this._feedingSelves.hasOwnProperty(q)){var s=this._feedingSelves[q].shelf();e.push(new b(s.id,d.convertFeedType(s.feedItemType),this._feedingSelves[q].analyses()));}}return e;};p.prototype._getFeed=function(e){var q=this.getFeeds();for(var i=0;i<q.length;i++){var r=q[i];if(r.id()===e){return r;}}return null;};p.prototype.save=function(){var e=[];for(var i=0;i<this.getFeeds().length;i++){e[i]=b.toJSON(this.getFeeds()[i]);}var q={feeding:e};return q;};p.prototype.feedingFromJson=function(e){if(!e){return;}var q=[];for(var i=0;i<e.feeding.length;i++){q[i]=b.fromJSON(e.feeding[i]);}return q;};p.prototype._analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e;}else{return this._allAnalyses;}};p.prototype._actionChangedHandler=function(e){this._dispatchEvent(new G(G.ACTION_CHANGED,this,{'feedItemID':e.data.feedItemID,'analysisObjectID':e.data.analysisObjectID,'actionID':e.data.actionID}));};return p;});u('sap/viz/controls/mapbuilder/widgets/WidgetProperties',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/events/GeoEvent"],function($,O,C,L,W,G){var a=function(d,c){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetProperties";this._properties=this._config.properties;this._settings=this._config.settings;this._settings$={};this._creatControls();};O.extend(a,W);a.prototype._creatSettings=function(){var r=$(this._dom);for(var i=0;i<this._settings.length;i++){var s=this._settings[i];var b;if(s.type==="check"){b=$("<div/>").appendTo(r);var c=$("<input type=\"checkbox\"></input>").appendTo(b).addClass(C.MAPBUILDER_PREFIX+"inline-block");var n=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"inline-block").html(L.get(s.name)).addClass(C.MAPBUILDER_PREFIX+"inline-block").addClass(C.MAPBUILDER_PREFIX+"property-text").appendTo(b);c.on("click",$.proxy(this._clickCheckBoxHandler,c,s,this));c.attr("checked",s.value);this._settings$[s.id]=c;if((i===0)&&!(this._config.showLegend)){b.hide();}}}};a.prototype._creatControls=function(){this._creatSettings();};a.prototype._clickCheckBoxHandler=function(s,p,e){if(s.checkedEvent&&s.uncheckedEvent){if(this.attr("checked")){p._dispatchEvent(new G(s.checkedEvent,this));}else{p._dispatchEvent(new G(s.uncheckedEvent,this));}}if(s.event){p._dispatchEvent(new G(s.event,this,{id:s.id,value:this[0].checked}));}};a.prototype.update=function(c){$.each(c,function(i,n){if(this.settings[n].type==="check"){this.setting$[n].attr("checked",c[n]);}});};a.prototype.changeSetting=function(s){this._settings=s;$(this._dom).empty();this._settings$={};this._creatSettings();};return a;});u('sap/viz/controls/mapbuilder/utils/UIHelper',['sap/viz/controls/common/managers/LangManager',"sap/viz/controls/common/utils/Utils","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/events/GeoEvent"],function(L,U,C,G){var P={id:"legendVisible",name:"VIZ_MAPBUILDER_SHOW_LEGEND",type:"check",value:true,checkedEvent:G.SHOW_LEGEND,uncheckedEvent:G.HIDE_LEGEND};var a={id:"markerCluster",name:"VIZ_MAPBUILDER_MARKER_CLUSTER",type:"check",value:false,event:G.CHANGE_VIZ_PROPERITIES};var b={id:"bubbleCluster",name:"VIZ_MAPBUILDER_BUBBLE_CLUSTER",type:"check",value:false,event:G.CHANGE_VIZ_PROPERITIES};var c=function(){this.__className="sap.viz.controls.geo.utils.UIHelper";};c.getAvailableSettings=function(v){if(v===C.VIZ_TYPE_CHOROPLETH){return[U.clone(P)];}else if(v===C.VIZ_TYPE_MARKER){return[U.clone(P),U.clone(a)];}else if(v===C.VIZ_TYPE_BUBBLE){return[U.clone(P),U.clone(b)];}else{throw L.get('VIZ_MAPBUILDER_NOT_SUPPORT_ERROR');}};return c;});u('sap/viz/controls/mapbuilder/sections/GeoVizLayerSection',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/sections/SectionBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/widgets/WidgetDataPoint","sap/viz/controls/mapbuilder/widgets/WidgetFeeding","sap/viz/controls/mapbuilder/widgets/WidgetProperties","sap/viz/controls/mapbuilder/utils/UIHelper"],function($,O,C,F,L,a,b,c,d,f,G,S,W,g,h,k,U){var l=function(e,m){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.GeoVizLayerSection";this._feedMap=this._config.feedMap;this._feeding=null;this._dataType=null;this._properties=null;this._vizType=this._config.vizType?this._config.vizType:f.VIZ_TYPE_CHOROPLETH;this._lableTitle=null;this._lableText=null;this._geoLocationFeedId="";this._geoFeatureColorFeedId="";this._geoFeatureSizeFeedId="";this._geoLocationFeedName="";this._geoFeatureColorFeedName="";this._geoFeatureSizeFeedName="";this._geoLocationFeedValues=[];this._geoFeatureColorFeedValues=[];this._geoFeatureSizeFeedValues=[];this._colorAnalysisType="";this._locationLength="";this._colorMeasureLength="";this._colorDimensionLength="";this._sizeLength="";this._showIconDom=false;this._clusterChecked=false;this._lableTitleText=L.get("VIZ_MAPBUILDER_CHOROPLETH");this._allAnalyses=null;};O.extend(l,S);l.prototype.update=function(e){if(e.vizType){this._feeding.changeFeeding(e.vizType);}if(e.feeding){this._feeding.update({feeding:e.feeding});}if(e.title){this.title(e.title,true);}if(e.properties){this._properties.update(e.properties);}};l.prototype._createChildControl=function(e){var t=new W(e,{title:L.get("VIZ_MAPBUILDER_DATA_POINTS")+": "});this._lableTitle=$(document.createElement("div")).appendTo(e).addClass(C.MAPBUILDER_PREFIX+"chartType-icon-title");this._lableText=$('<div/>').appendTo(this._lableTitle).addClass(C.MAPBUILDER_PREFIX+"chartType-icon-title-text");this._lableText.text(this._lableTitleText);var m=$(document.createElement("div")).appendTo(e).addClass(C.MAPBUILDER_PREFIX+"datapointchooser");this._dataType=new g(m,{title:L.get("VIZ_MAPBUILDER_TYPE")+": ",selected:this._vizType});var n=$(document.createElement("div")).appendTo(e);this._feeding=new h(n,{feedMap:this._feedMap,vizType:this._vizType,feeding:this._config.feeding?this._config.feeding:[],feedingPanel:this._config.feedingPanel});this._feeding._analysisObjectsForPicker(this._allAnalyses);var p=$(document.createElement("div")).appendTo(e).addClass(C.MAPBUILDER_PREFIX+"properites");this._properties=new k(p,{properites:this._config.properties,settings:U.getAvailableSettings(this._vizType),showLegend:this._config.showLegend});};l.prototype._addEventHandler=function(){this._feeding.addEventListener(F.FEEDING_CHANGED,function(e){this._dispatchEvent(new F(F.FEEDING_CHANGED,this,{sectionIdx:this.getSectionIdx()}));},this);this._feeding.addEventListener(G.ACTION_CHANGED,function(e){this._dispatchEvent(new G(G.ACTION_CHANGED,this,{feedItemID:e.data.feedItemID,analysisObjectID:e.data.analysisObjectID,actionID:e.data.actionID,sectionIdx:this.getSectionIdx()}));},this);this._dataType.addEventListener(G.CHANGE_LAYER_VIZTYPE,function(e){this._changeVizType(e.data.vizType);},this);if(this._config.showLegend){this._properties.addEventListener(G.SHOW_LEGEND,function(e){this._dispatchEvent(new G(G.SHOW_LEGEND,this,{sectionIdx:this.getSectionIdx()}));},this);this._properties.addEventListener(G.HIDE_LEGEND,function(e){this._dispatchEvent(new G(G.HIDE_LEGEND,this,{sectionIdx:this.getSectionIdx()}));},this);}this._properties.addEventListener(G.CHANGE_VIZ_PROPERITIES,function(e){this._clusterChecked=e.data.value;this._dispatchEvent(new G(G.CHANGE_VIZ_PROPERITIES,this,{sectionIdx:this.getSectionIdx(),id:e.data.id,value:this._clusterChecked}));},this);};l.prototype._createChildControlPanel=function(e){this._createChildControl(e);this._addEventHandler();};l.prototype.getFeeds=function(){return this._feeding.getFeeds();};l.prototype.destroy=function(){this.getSectionDom().detach();};l.prototype._changeVizType=function(v){var o=this._vizType;this._vizType=v;var e=[];var m=this.getFeeds();var n;for(var i=0;i<m.length;i++){n=m[i];var p=n.values().length;if(n.id()==="location"){this._locationLength=p;}else if(n.id()==="color"){if(n.type()===b.MEASURE){this._colorMeasureLength=p;}else{this._colorDimensionLength=p;}}else if(n.id()==="size"){this._sizeLength=p;}for(var j=0;j<p;j++){var q=n.values()[j].id();var r=n.values()[j].name();var s=n.values();if(n.id()==="location"){this._geoLocationFeedName=r;this._geoLocationFeedId=q;this._geoLocationFeedValues=s;}else if(n.id()==="color"){this._geoFeatureColorFeedName=r;this._geoFeatureColorFeedId=q;this._geoFeatureColorFeedValues=s;this._colorAnalysisType=n.type();}else if(n.id()==="size"){this._geoFeatureSizeFeedName=r;this._geoFeatureSizeFeedId=q;this._geoFeatureSizeFeedValues=s;}}}if(this._vizType===f.VIZ_TYPE_CHOROPLETH){this.title("",false);this.showIcon(false);this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-marker");this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");this._lableTitleText=L.get("VIZ_MAPBUILDER_CHOROPLETH");if(this._geoLocationFeedId&&this._locationLength>0){e[0]=new a("location",b.DIMENSION,this._geoLocationFeedValues);this.title(this._geoLocationFeedName,false);this.showIcon(true);}if(this._geoFeatureColorFeedId&&this._colorAnalysisType===b.MEASURE&&this._colorMeasureLength>0){e[1]=new a("color",b.MEASURE,this._geoFeatureColorFeedValues);this.title(this._geoFeatureColorFeedName,false);this.showIcon(true);}if(this._geoFeatureSizeFeedId&&this._sizeLength>0){e[1]=new a("color",b.MEASURE,this._geoFeatureSizeFeedValues);this.title(this._geoFeatureSizeFeedName,false);this.showIcon(true);}}else if(this._vizType===f.VIZ_TYPE_MARKER){this.title("",false);this.showIcon(false);this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-marker");this._lableTitleText=L.get("VIZ_MAPBUILDER_MARKER");if(this._geoLocationFeedId&&this._locationLength>0){e[0]=new a("location",b.DIMENSION,this._geoLocationFeedValues);this.title(this._geoLocationFeedName,false);this.showIcon(true);}}else if(this._vizType===f.VIZ_TYPE_BUBBLE){this.title("",false);this.showIcon(false);this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");this._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-marker");this._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");this._lableTitleText=L.get("VIZ_MAPBUILDER_BUBBLE");if(this._geoLocationFeedId&&this._locationLength>0){e[0]=new a("location",b.DIMENSION,this._geoLocationFeedValues);this.title(this._geoLocationFeedName,false);this.showIcon(true);}if(this._geoFeatureSizeFeedId&&this._sizeLength>0){if(this._colorDimensionLength===0&&this._geoFeatureSizeFeedName===this._geoFeatureColorFeedName&&this._geoFeatureSizeFeedId===this._geoFeatureColorFeedId){}else{e[1]=new a("size",b.MEASURE,this._geoFeatureSizeFeedValues);if(e[0]){this.title(this._geoFeatureSizeFeedName,false);this.showIcon(true);}}}if(this._geoFeatureColorFeedId&&this._colorMeasureLength>0&&this._colorAnalysisType===b.MEASURE){e[1]=new a("size",b.MEASURE,this._geoFeatureColorFeedValues);if(e[0]){this.title(this._geoFeatureColorFeedName,false);this.showIcon(true);}}if(this._geoFeatureColorFeedId&&this._colorAnalysisType===b.DIMENSION&&this._colorDimensionLength>0){e[2]=new a("color",b.DIMENSION,this._geoFeatureColorFeedValues);}}this._lableText.text(this._lableTitleText);this._feeding.changeFeeding(this._vizType);this.update({feeding:e});this._properties.changeSetting(U.getAvailableSettings(this._vizType));this._dispatchEvent(new G(G.CHANGE_LAYER_VIZTYPE,this,{sectionIdx:this.getSectionIdx(),vizType:this._vizType,feeding:((e.length===1&&this._geoLocationFeedId&&this._locationLength>0)||o===this._vizType)?null:e}));this._dispatchEvent(new F(F.FEEDING_CHANGED,this,{sectionIdx:this.getSectionIdx()}));if(o===this._vizType&&this._clusterChecked){if(this._vizType===f.VIZ_TYPE_BUBBLE){this._properties._settings$.bubbleCluster[0].checked=this._clusterChecked;this._dispatchEvent(new G(G.CHANGE_VIZ_PROPERITIES,this,{sectionIdx:this.getSectionIdx(),id:"bubbleCluster",value:this._clusterChecked}));}else if(this._vizType===f.VIZ_TYPE_MARKER){this._properties._settings$.markerCluster[0].checked=this._clusterChecked;this._dispatchEvent(new G(G.CHANGE_VIZ_PROPERITIES,this,{sectionIdx:this.getSectionIdx(),id:"markerCluster",value:this._clusterChecked}));}}};l.prototype._analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e;if(this._feeding){this._feeding._analysisObjectsForPicker(this._allAnalyses);}}else{return this._allAnalyses;}};l.prototype.save=function(){var s={vizType:this._vizType,feedMap:this._feedMap,feeding:this._feeding.save(),title:this.title(),checked:this._isChecked,checkable:this._checkable,configable:this._configable,expand:this._isExpand,sortable:this._sortable,titleText:this._lableTitleText,clusterChecked:this._vizType===f.VIZ_TYPE_CHOROPLETH?null:this._clusterChecked,showLegend:this._config.showLegend,showIconDom:this._showIconDom};return s;};return l;});u('sap/viz/controls/mapbuilder/models/Analysis',[],function(){var a=function(){this.__className="sap.viz.controls.geo.models.Analysis";this.id=null;this.name=null;this.type=null;};return a;});u('sap/viz/controls/mapbuilder/models/VizLayer',[],function(){var V=function(){this.__className="sap.viz.controls.geo.models.VizLayer";this._feedItems=[];};V.prototype.feedItems=function(_){if(!arguments.length){return this._feedItems;}else{this._feedItems=_;}};return V;});u('sap/viz/controls/mapbuilder/widgets/WidgetESRIMapStyle',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/events/GeoEvent"],function($,O,C,L,W,a,G){var E=[{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_MAP",type:"topo"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_SATELLITE",type:"satellite"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_TERRAIN",type:"national-geographic"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_STREETS",type:"streets"}];var b=function(d,c){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetESRIMapStyle";this._creatControls();};O.extend(b,W);b.prototype._creatControls=function(){var r=$(this._dom).addClass(C.MAPBUILDER_PREFIX+"map-styles");var t=new a(r,{title:"STYLES"});var c=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-styles-container").appendTo(r);for(var i=0;i<E.length;i++){var s=E[i];var d=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-style").appendTo(c);var e=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-style-title").appendTo(d);e.html(L.get(s.name)+": ");var f=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-style-esri-"+s.type).appendTo(d);f.addClass(C.MAPBUILDER_PREFIX+"map-style-esri-icon");f.data("__basemapType",s.type);var _=this;f.on("click tap",function(){$("."+C.MAPBUILDER_PREFIX+"map-style-esri-icon").removeClass(C.MAPBUILDER_PREFIX+"map-style-esri-icon-selected");$(this).addClass(C.MAPBUILDER_PREFIX+"map-style-esri-icon-selected");_._dispatchEvent(new G(G.CHANGE_BASEMAP_TYPE,this,{basemapType:$(this).data("__basemapType")}));});}};return b;});u('sap/viz/controls/mapbuilder/sections/GeoBasemapLayerSection',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/sections/SectionBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/widgets/WidgetESRIMapStyle"],function($,O,C,L,G,S,W,a){var b="<select id=\"combobox\"><select>";var c=function(d,e){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.GeoBasemapLayerSection";this._config=e;this._providers=this._config.providers;this._changable=this._config.changable;this._$providerSelector=null;this._esriMapStyle=null;this._esriMapStyle$=null;};O.extend(c,S);c.prototype._createChildControl=function(d){var t=new W(d,{title:L.get("VIZ_MAPBUILDER_MAP")});var p=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"map-provider").appendTo(d);$(document.createElement("div")).html(L.get("VIZ_MAPBUILDER_PROVIDERS")+":").addClass(C.MAPBUILDER_PREFIX+"section-sub-title-text").appendTo(p);this._$providerSelector=$(b).appendTo(p);var e=0;for(var i=0;i<this._providers.length;i++){var o;if(this._config.defaultProvider==this._providers[i]){o="<option selected=\"selected\" value=\""+this._providers[i]+"\">"+this._providers[i]+"</option>";}else{o="<option value=\""+this._providers[i]+"\">"+this._providers[i]+"</option>";}$(o).appendTo(this._$providerSelector);}this._esriMapStyle$=$(document.createElement("div")).appendTo(d);this._esriMapStyle=new a(this._esriMapStyle$);if(this._config.defaultProvider!=="ESRI"){this._esriMapStyle$.hide();}};c.prototype._addEventHandler=function(){this._$providerSelector.change(function(){this._dispatchEvent(new G(G.CHANGE_BASEMAP_PROVIDER,this,{basemapProvider:this._$providerSelector.val()}));if(this._$providerSelector.val()!=="ESRI"){this._esriMapStyle$.hide();}else{this._esriMapStyle$.show();}}.bind(this));this._esriMapStyle.addEventListener(G.CHANGE_BASEMAP_TYPE,function(e){this._dispatchEvent(e);},this);};c.prototype._createChildControlPanel=function(d){this._createChildControl(d);this._addEventHandler();};return c;});u('sap/viz/controls/mapbuilder/widgets/WidgetContextMenu',["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/events/GeoEvent"],function($,O,C,L,W,G){var M={iconClass:C.MAPBUILDER_PREFIX+"contextmenu-delete",actionType:G.DELETE_LAYER,name:"VIZ_MAPBUILDER_DELETE"};var a={iconClass:C.MAPBUILDER_PREFIX+"contextmenu-moveup",actionType:G.REORDER_LAYER,name:"VIZ_MAPBUILDER_MOVEUP"};var b={iconClass:C.MAPBUILDER_PREFIX+"contextmenu-movedown",actionType:G.REORDER_LAYER,name:"VIZ_MAPBUILDER_MOVEDOWN"};var c=function(d,e){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetContextMenu";this._menu$=null;this._text$=null;this._buttonCancel$=null;this._buttonOk$=null;this._actionType="";this._container$=null;this._layerName=null;this._moveName=null;this._layerIndex=null;this._layerCount=null;this._instanceDom=null;this._beforeInstanceDom=null;this._afterInstanceDom=null;this._firstInstanceDom=null;this._showHideMenu=null;this._showHideMenuItem=null;this._actionContainer$=null;this._warning$=null;this._creatControls();};O.extend(c,W);c.prototype._creatControls=function(){var r=$(document.createElement("div")).appendTo($(this._dom)).addClass(C.MAPBUILDER_PREFIX+"contextmenu-container");this._container$=r;var m=document.createElement("ul");this._menu$=$(m).addClass(C.MAPBUILDER_PREFIX+"contextmenu");this._createMenuItem(this._menu$,a);this._createMenuItem(this._menu$,b);this._createMenuItem(this._menu$,M);this._menu$.appendTo(r);this._actionContainer$=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-container").appendTo(r);this._warning$=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-warning").appendTo(this._actionContainer$);var d=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-title").appendTo(this._actionContainer$);this._text$=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-name").appendTo(d);var e=$(document.createElement("div")).addClass(C.MAPBUILDER_PREFIX+"contextmenu-action").appendTo(r);this._buttonCancel$=$("<button type=\"button\"></button>").addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-cancel").appendTo(e);this._buttonOk$=$("<button type=\"button\"></button>").addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-button").addClass(C.MAPBUILDER_PREFIX+"contextmenu-action-ok").appendTo(e);this._actionContainer$.hide();this._text$.hide();this._buttonCancel$.hide();this._buttonOk$.hide();this._warning$.hide();this._buttonOk$.click(function(){if(this._actionType==G.DELETE_LAYER){this._dispatchEvent(new G(G.DELETE_LAYER,this));}this._close();}.bind(this));this._buttonCancel$.click(function(){this._close();}.bind(this));};c.prototype._createMenuItem=function(m,d){var e=$(document.createElement("li")).addClass(C.MAPBUILDER_PREFIX+"menuitem");$(document.createElement("div")).appendTo(e).addClass(d.iconClass);var f=$(document.createElement("div")).appendTo(e).addClass(C.MAPBUILDER_PREFIX+"menutext");f.text(L.get(d.name));e.appendTo(m);e.data("actionType",d.actionType);e.click($.proxy(this._clickHanlder,this));};c.prototype._clickHanlder=function(e){var _=this;this._actionType=$(e.currentTarget).data('actionType');this._moveName=e.currentTarget.children[1].innerText;this._menu$.hide();this._actionContainer$.show();this._warning$.hide();this._text$.show();if(this._actionType===G.DELETE_LAYER){this._warning$.show();this._text$.html(L.get('VIZ_MAPBUILDER_DELETE_GEO_LAYER')+"?");this._buttonCancel$.show();this._buttonOk$.show();this._container$.removeClass(C.MAPBUILDER_PREFIX+"contextmenu-container");this._container$.addClass(C.MAPBUILDER_PREFIX+"configmenu-container");var r=$(this._dom);r.css({top:this._container$.offset().top,left:this._container$.offset().left-35,position:"absolute"});}else if(this._actionType===G.REORDER_LAYER){var f=this._layerIndex;var t;if(this._moveName===L.get('VIZ_MAPBUILDER_MOVEUP')){t=f+1;this._instanceDom.insertBefore(this._beforeInstanceDom);}else if(this._moveName===L.get('VIZ_MAPBUILDER_MOVEDOWN')){t=f-1;this._instanceDom.insertAfter(this._afterInstanceDom);}this._dispatchEvent(new G(G.REORDER_LAYER,this,{from:f,to:t}));this._close();}};c.prototype._mouseDownHandler=function(e){if(!$.contains(this._dom,e.srcElement)){this._close();}};c.prototype.show=function(o){var r=$(this._dom);r.css({top:o.top,left:o.left+85,position:"absolute"});r.appendTo($("body"));if(this._layerCount>0){if(this._layerCount===1){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="none";this._menu$[0].children[1].style.display="none";this._menu$[0].children[2].style.display="block";}else if(this._layerCount>1&&this._layerIndex===this._layerCount-1){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="none";this._menu$[0].children[1].style.display="block";this._menu$[0].children[2].style.display="block";}else if(this._layerCount>1&&this._layerIndex===0){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="block";this._menu$[0].children[1].style.display="none";this._menu$[0].children[2].style.display="block";}else{this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="block";this._menu$[0].children[1].style.display="block";this._menu$[0].children[2].style.display="block";}}this._text$.hide();this._buttonCancel$.hide();this._buttonOk$.hide();this._warning$.hide();this._actionContainer$.hide();document.addEventListener("mousedown",$.proxy(this._mouseDownHandler,this),true);$(window).on('blur',$.proxy(this._mouseDownHandler,this));this._container$.removeClass(C.MAPBUILDER_PREFIX+"configmenu-container");this._container$.addClass(C.MAPBUILDER_PREFIX+"contextmenu-container");};c.prototype._close=function(){$(this._dom).detach();document.removeEventListener("mousedown",$.proxy(this._mouseDownHandler,this),true);$(window).off('blur',$.proxy(this._mouseDownHandler,this));};c.prototype.setLayerIdx=function(_){this._layerIndex=_;};c.prototype.setLayerCount=function(_){this._layerCount=_;};c.prototype.setInstanceDom=function(_){this._instanceDom=_;};c.prototype.setBeforeInstanceDom=function(_){this._beforeInstanceDom=_;};c.prototype.setAfterInstanceDom=function(_){this._afterInstanceDom=_;};c.prototype.setFirstInstanceDom=function(_){this._firstInstanceDom=_;};return c;});u('sap/viz/controls/mapbuilder/MapBuilder',["jquery",'sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/constants/CSSConst',"sap/viz/controls/mapbuilder/constants/Const",'sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/mapbuilder/MapBuilderConfig','sap/viz/controls/mapbuilder/sections/SectionBase','sap/viz/controls/mapbuilder/sections/GeoVizLayerSection','sap/viz/controls/mapbuilder/models/Analysis','sap/viz/controls/mapbuilder/models/VizLayer','sap/viz/controls/common/views/feed/FeedingShelfEvent','sap/viz/controls/mapbuilder/sections/GeoBasemapLayerSection','sap/viz/controls/mapbuilder/events/GeoEvent','sap/viz/controls/mapbuilder/widgets/WidgetContextMenu'],function($,O,U,V,F,a,C,b,L,c,M,S,G,d,f,g,h,k,l){var r=function(e,n,t){e.splice(t,0,e.splice(n,1)[0]);};var m=function(e,n){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.MapBuilder";this._uiConfig=n;this._feedMap=!this._uiConfig.feedMap?{}:this._uiConfig.feedMap;this._$mapBuilder=null;this._$controller=null;this._$header=null;this._$headerPlus=null;this._$headerText=null;this._vizSectionsContainer=null;this._vizSections=[];this._vizLayers=[];this._baseMapSection=null;this._contextMenu=null;this._$footer=null;this._$footerText=null;this._createChildren();this._currentSettingLayer=-1;this._loadConfig();};O.extend(m,V);m.prototype.config=function(e,n){this._vizSections[n].update(e);};m.prototype._createHeader=function(){this._$header=$("<div/>").appendTo(this._$controller).addClass(C.MAPBUILDER_PREFIX+"header");this._$headerPlus=$("<div><div/>").appendTo(this._$header).addClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerText=$("<div></div>").appendTo(this._$header).addClass(C.MAPBUILDER_PREFIX+"header-text").html(L.get("VIZ_MAPBUILDER_ADD_NEW_LAYER"));this._$headerPlus.bind('tap click',this._addHeaderEventHandler.bind(this));this._$headerText.bind('tap click',this._addHeaderEventHandler.bind(this));};m.prototype._createFooter=function(){this._$footer=$("<div/>").appendTo(this._$controller).addClass(C.MAPBUILDER_PREFIX+"footer");this._$footerText=$("<div></div>").appendTo(this._$footer).addClass(C.MAPBUILDER_PREFIX+"footer-text").html(L.get("VIZ_MAPBUILDER_IMPORT_ESRI_CUSTOM_SERVICE"));this._$footerRadio=$(document.createElement("input")).attr("type","checkbox").addClass(C.MAPBUILDER_PREFIX+"footer-radio").appendTo(this._$footer).on("click tap",function(){if(this._$footerRadio.prop("checked")){this._$footerRadioText.removeClass('disable');this._notifyModelChange({mapBuilder:{mapservice:{action:'enable'}}});}else{this._$footerRadioText.addClass('disable');this._notifyModelChange({mapBuilder:{mapservice:{action:'disable'}}});}}.bind(this));this._$footerRadio.hide();this._$footerRadioText=$("<div></div").html(L.get("VIZ_MAPBUILDER_ESRI_CUSTOM_SERVICE")).addClass(C.MAPBUILDER_PREFIX+"footer-radio-text").appendTo(this._$footer);this._$footerRadioText.hide();this._$footerText.bind('tap click',this._footerClickEventHandler.bind(this));this._$footerRadioText.bind('tap click',this._footerClickTextEventHandler.bind(this));};m.prototype._addHeaderEventHandler=function(e){if(this._vizLayers.length>=5){this._$header.disabled=true;this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6");}else if(this._vizLayers.length<5){this._$header.disabled=false;this._$headerText.css("color","#008fd3");this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"header-plus");if(this._vizLayers.length===4){this._addVizSection();this._$header.disabled=true;this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6");}else{this._addVizSection();}e.stopPropagation();e.preventDefault();}};m.prototype._footerClickEventHandler=function(e){this._notifyModelChange({mapBuilder:{mapservice:{action:'choose'}}});};m.prototype._footerClickTextEventHandler=function(e){if(this._$footerRadio.prop("checked")){this._notifyModelChange({mapBuilder:{mapservice:{action:'choose'}}});}};m.prototype._hide=function(){this._$mapBuilder.hide();};m.prototype._show=function(){this._$mapBuilder.show()};m.prototype.reset=function(){for(var i=0;i<this._vizSections.length;i++){this._vizSections[i].destroy();}this._vizSections.length=0;this._vizLayers.length=0;};m.prototype._createChildren=function(){var n=$("<div/>").appendTo(this._dom).addClass(C.PREFIX+"mapbuilder");this._$controller=$("<div/>").appendTo(n).addClass(C.MAPBUILDER_PREFIX+"area");this._createHeader();this._createFooter();var s=document.createElement('div');$(s).addClass(C.MAPBUILDER_PREFIX+"section-container");var o=document.createElement('div');this._vizSectionsContainer=document.createElement('div');if(this._uiConfig.showBaseMap){this._baseMapSection=new h(o,{title:L.get('VIZ_MAPBUILDER_BASE_MAP_NAME'),providers:this._uiConfig.basemap.providers,changeable:this._uiConfig.basemap.changable,checkable:false,sortable:false,configable:false,defaultProvider:this._uiConfig.basemap.selected});this._baseMapSection.addEventListener(k.CHANGE_BASEMAP_PROVIDER,function(e){this._dispatchEvent(e);},this);this._baseMapSection.addEventListener(k.CHANGE_BASEMAP_TYPE,function(e){this._dispatchEvent(e);},this);}s.appendChild(this._vizSectionsContainer);s.appendChild(o);$(s).appendTo(this._$controller);this._contextMenu=new l(document.createElement("div"),{});this._contextMenu.addEventListener(k.DELETE_LAYER,function(e){this._removeLayer(this._currentSettingLayer);},this);this._contextMenu.addEventListener(k.REORDER_LAYER,function(e){this._reorderLayer(e.data.from,e.data.to);},this);this._$mapBuilder=n;this._hide();};m.prototype._loadConfig=function(){var e=this._uiConfig.layers;if(e){for(var i=0;i<e.length;i++){var n=e[i];var s=this._createVizLayerSection({vizType:n.vizType,feeding:n.feeding,title:n.title,showLegend:this._uiConfig.showLegend});}}};m.prototype.save=function(){var e=[];for(var i=0;i<this._vizSections.length;i++){var v=this._vizSections[i];if(v){var s=v.save();e.push(s);}}return e;};m.prototype.load=function(e){if(!e){return;}this.reset();for(var i=0;i<e.length;i++){var s=e[i];var n=[];for(var j=0;j<s.feeding.feeding.length;j++){n[j]=F.fromJSON(s.feeding.feeding[j]);}var o=this._createVizLayerSection({feedMap:s.feedMap,vizType:s.vizType,feeding:n,title:s.title,checkable:s.checkable,configable:s.configable,sortable:s.sortable,showLegend:s.showLegend});if(s.showIconDom){o.showIcon(true);if(s.vizType===b.VIZ_TYPE_CHOROPLETH){o._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-marker");o._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");o._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");}else if(s.vizType===b.VIZ_TYPE_BUBBLE){o._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-marker");o._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");o._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");}else if(s.vizType===b.VIZ_TYPE_MARKER){o._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-bubble");o._iconDom.removeClass(C.MAPBUILDER_PREFIX+"section-icon-choropleth");o._iconDom.addClass(C.MAPBUILDER_PREFIX+"section-icon-marker");}}o._lableText.text(s.titleText);o._lableTitleText=s.titleText;if(!s.checked){o._checkBoxDom.checked=s.checked;o._isChecked=s.checked;$(o._labelDom).css("color","#a6a6a6");}if(!s.expand){o._isExpand=s.expand;}if(s.clusterChecked){o._clusterChecked=true;if(s.vizType===b.VIZ_TYPE_MARKER){o._properties._settings$.markerCluster[0].checked=true;}else{o._properties._settings$.bubbleCluster[0].checked=true;}}}if(e.length>=5){this._$header.disabled=true;this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6");}for(var j=0;j<e.length;j++){if(e[j].expand&&e[j].checked){this._vizSections[j]._expandSectionHandler();}else{this._vizSections[j]._hideSectionHandler();}}};m.prototype._getLayerCount=function(){return this._vizLayers.length;};m.prototype._createVizLayerSection=function(n){var v=new G(this._vizSectionsContainer,{feedMap:this._feedMap,title:n.title,checkable:n.checkable?n.checkable:true,configable:n.configable?n.configable:true,sortable:n.sortable?n.sortable:true,vizType:n.vizType,feeding:n.feeding,showLegend:n.showLegend,feedingPanel:this._uiConfig.feedingPanel});v._analysisObjectsForPicker(this._allAnalyses);v._expandSectionHandler();if(v._sortable){$(v._instanceDom).sortable("disable");}v.addEventListener(g.FEEDING_CHANGED,function(e){this._layerFeedChange(this._getLayerIdxBySectionIdx(e.data.sectionIdx));},this);v.addEventListener(k.ACTION_CHANGED,function(e){this._dispatchEvent(new k(k.ACTION_CHANGED,this,{feedItemID:e.data.feedItemID,analysisObjectID:e.data.analysisObjectID,actionID:e.data.actionID,layerIdx:this._getLayerIdxBySectionIdx(e.data.sectionIdx)}));},this);v.addEventListener(k.EXPAND_SECTION,function(e){var p=this._getLayerIdxBySectionIdx(e.data.sectionIdx);this._dispatchEvent(new k(k.EXPAND_SECTION,this,{layerIdx:p}));if(this._vizSections.length>=1){for(var i=0;i<this._vizSections.length;i++){if(i===p&&!(v._isExpand)&&v._isChecked){this._vizSections[i]._expandSectionHandler();}else{if(v._isChecked){this._vizSections[i]._hideSectionHandler();}}if(this._vizSections[i]._sortable){$(this._vizSections[i]._instanceDom).sortable("disable");}}}},this);v.addEventListener(k.HIDE_SECTION,function(e){var p=this._getLayerIdxBySectionIdx(e.data.sectionIdx);this._dispatchEvent(new k(k.HIDE_SECTION,this,{layerIdx:p}));if(this._vizSections.length>=1){for(var i=0;i<this._vizSections.length;i++){if(i===p&&v._isExpand){this._vizSections[i]._hideSectionHandler();}if(this._vizSections[i]._sortable){$(this._vizSections[i]._instanceDom).sortable("enable");}}}},this);v.addEventListener(k.SHOW_LAYER,function(e){var p=this._getLayerIdxBySectionIdx(e.data.sectionIdx);this._notifyModelChange({mapBuilder:{layer:{action:'show',idx:p}}});this._dispatchEvent(new k(k.SHOW_LAYER,this,{layerIdx:p}));if(v._isChecked){$(v._labelDom).css("color","#333333");for(var i=0;i<this._vizSections.length;i++){if(i===p&&v._isChecked){this._vizSections[i]._expandSectionHandler();}else{this._vizSections[i]._hideSectionHandler();}if(this._vizSections[i]._sortable){$(this._vizSections[i]._instanceDom).sortable("disable");}}}},this);v.addEventListener(k.HIDE_LAYER,function(e){var p=this._getLayerIdxBySectionIdx(e.data.sectionIdx);this._notifyModelChange({mapBuilder:{layer:{action:'hide',idx:p}}});this._dispatchEvent(new k(k.HIDE_LAYER,this,{layerIdx:p}));if(!v._isChecked){$(v._labelDom).css("color","#a6a6a6");v._hideSectionHandler();$(v._instanceDom).sortable("enable");}},this);v.addEventListener(k.DISPLAY_SETTINGMENU,function(e){this._displaySettingMenu(this._getLayerIdxBySectionIdx(e.data.sectionIdx),e.data.position);},this);v.addEventListener(k.REORDER_LAYER,function(e){this._reorderLayer(this._getLayerIdxBySectionIdx(e.data.from),this._getLayerIdxBySectionIdx(e.data.to));},this);v.addEventListener(k.CHANGE_LAYER_VIZTYPE,function(e){var p=this._getLayerIdxBySectionIdx(e.data.sectionIdx);var q=e.data.vizType;var s=e.data.feeding;this._notifyModelChange({mapBuilder:{layer:{action:'changeVizType',idx:p,vizType:q,feeding:s}}});this._dispatchEvent(new k(k.CHANGE_LAYER_VIZTYPE,this,{layerIdx:p,vizType:q,feeding:s}));},this);v.addEventListener(k.CHANGE_VIZ_PROPERITIES,function(e){var p=this._getLayerIdxBySectionIdx(e.data.sectionIdx);var q=e.data.id;var s=e.data.value;this._notifyModelChange({mapBuilder:{layer:{action:'changeProperties',idx:p,propKey:q,propValue:s}}});this._dispatchEvent(new k(k.CHANGE_VIZ_PROPERITIES,this,{layerIdx:p,id:q,value:s}));},this);this._vizSections.push(v);if(this._vizSections.length>1){for(var i=0;i<this._vizSections.length;i++){if(i===this._vizSections.length-1){this._vizSections[i]._expandSectionHandler();}else{this._vizSections[i]._hideSectionHandler();}}}if(n.title){v.title(n.title,true);}else{var o=this._vizSections.length;}this._vizLayers.push(new f());return v;};m.prototype._addVizSection=function(){var s=this._createVizLayerSection({showLegend:this._uiConfig.showLegend});this._notifyModelChange({mapBuilder:{layer:{action:'add',feeds:s.getFeeds()}}});this._dispatchEvent(new k(k.ADD_LAYER,this,{layerIdx:this._vizSections.length-1}));};m.prototype._getLayerIdxBySectionIdx=function(s){return this._vizSections.length-s-1;};m.prototype._createAnalysis=function(e,n,t){var o=new d();o.id=e;o.name=n;o.type=t;this._feedMap[e]=o;return o;};m.prototype._layerFeedChange=function(e){var n=this._vizLayers[e];var s=this._vizSections[e];var v=s._vizType;var o=s.getFeeds();n.feedItems(o);var p,q,t,w,x;for(var i=0;i<o.length;i++){var y=o[i];for(var j=0;j<y.values().length;j++){p=y.values()[j].name();if(y.id()==="location"){q=p;}else if(y.id()==="color"){t=p;x=y.type();}else if(y.id()==="size"){w=p;}}}if(v===b.VIZ_TYPE_CHOROPLETH){s.title("",false);s.showIcon(false);if(q!=undefined){if(t!=undefined&&x===a.MEASURE){s.title(t,false);}else{s.title(q,false);}s.showIcon(true);}}else if(v===b.VIZ_TYPE_BUBBLE){s.title("",false);s.showIcon(false);if(q!=undefined){if(w!=undefined){s.title(w,false);}else{s.title(q,false);}s.showIcon(true);}}else if(v===b.VIZ_TYPE_MARKER){s.title("",false);s.showIcon(false);if(q!=undefined){s.title(q,false);s.showIcon(true);}}var z=this._vizModel().feedingItems();z[e]=o;this._vizModel().feedingItems(z);this._dispatchEvent(new k(k.UPDATE_LAYER_DATA,this,{"feedItems":o,"layerIdx":e}));};m.prototype._removeLayer=function(e){this._vizSections[e].destroy();this._vizSections.splice(e,1);this._vizLayers.splice(e,1);this._notifyModelChange({mapBuilder:{layer:{action:'delete',idx:e}}});this._dispatchEvent(new k(k.DELETE_LAYER,this,{layerIdx:e}));if(this._vizLayers.length<5){this._$header.disabled=false;this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerText.css("color","#008fd3");}else if(this._vizLayers.length>=5){this._$header.disabled=true;this._$headerText.css("color","#a6a6a6");this._$headerPlus.removeClass(C.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(C.MAPBUILDER_PREFIX+"disable-header-plus");}};m.prototype._reorderLayer=function(e,t){r(this._vizSections,e,t);r(this._vizLayers,e,t);this._notifyModelChange({mapBuilder:{layer:{action:'reorder',from:e,to:t}}});this._dispatchEvent(new k(k.REORDER_LAYER,this,{from:e,to:t}));};m.prototype._notifyModelChange=function(e){this._vizModel().extensionValues(e);};m.prototype._displaySettingMenu=function(e,p){this._currentSettingLayer=e;var s=this._vizSections[this._currentSettingLayer].getSectionDom();var n,o;if(this._vizSections.length>0){if(this._vizSections.length===1){n=null;o=null;}else if(this._vizSections.length>1&&this._currentSettingLayer===this._vizSections.length-1){n=null;o=this._vizSections[this._currentSettingLayer-1].getSectionDom();}else if(this._vizSections.length>1&&this._currentSettingLayer===0){n=this._vizSections[this._currentSettingLayer+1].getSectionDom();;o=null;}else{n=this._vizSections[this._currentSettingLayer+1].getSectionDom();o=this._vizSections[this._currentSettingLayer-1].getSectionDom();}}var q=s.offset();this._contextMenu.setLayerIdx(this._currentSettingLayer);this._contextMenu.setLayerCount(this._vizSections.length);this._contextMenu.setInstanceDom(s);this._contextMenu.setBeforeInstanceDom(n);this._contextMenu.setAfterInstanceDom(o);this._contextMenu.show(q);};m.prototype._onVizModelChanged=function(e){if(e.data.extensionValuesChanged){var v=this._vizModel().extensionValues();if(v.mapBuilder){if(v.mapBuilder.status){this._show();this.load(v.mapBuilder.status);}else if(v.mapBuilder.mapservice&&v.mapBuilder.mapservice.showRadio){this._show();this._$footerText.hide();this._$footerRadio.show();this._$footerRadioText.show();this._$footerRadio.prop("checked",v.mapBuilder.mapservice.checked);if(!v.mapBuilder.mapservice.checked){this._$footerRadioText.addClass("disable");}else{this._$footerRadioText.removeClass("disable");}}}if(v.map){if(v.map.created){this._show();this.reset();this._addVizSection();}else if(v.map.logOnFail){this._hide();}if(v.map.feeding){for(var i=0;i<v.map.feeding.length;i++){this._vizSections[i].update({feeding:v.map.feeding[i]});}}}}};m.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e;for(var i=0;i<this._vizSections.length;i++){this._vizSections[i]._analysisObjectsForPicker(this._allAnalyses);}}else{return this._allAnalyses;}};return m;});u('sap/viz/controls/switchbar/SwitchBarEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','jquery'],function(O,E,$){var S=function(t,a,d){S.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.SwitchBarEvent";};O.extend(S,E);S.VIZ_TYPE_CHANGED="vizTypeChanged";return S;});u('sap/viz/controls/switchbar/views/SwitcherEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var S=function(t,a,d){S.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.SwitcherEvent";};O.extend(S,E);S.TYPE_CHANGED="typeChanged";return S;});u('sap/viz/controls/switchbar/views/DropDownListEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var D=function(t,a,d){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.DropDownListEvent";};O.extend(D,E);D.DROP_DOWN_OPENED="dropDownOpened";D.DROP_DOWN_CLOSED="dropDownClosed";D.ITEM_SELECTED="itemSelected";return D;});u('sap/viz/controls/switchbar/views/DropDownList',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/UIControl','sap/viz/controls/switchbar/views/DropDownListEvent'],function($,C,a,b,O,c,U,D){var d=a.SWITCHBAR_PREFIX;var e=function(f,h,t){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.DropDownList";this._header=h;this._typeObjects=t;this._selectedChartList=null;this._dom$=$(f);this._$container=null;this._$content=null;this._$arrow=null;this._mousedownHandler=$.proxy(this._globalMouseDownHandler,this);this._createChildren();};O.extend(e,U);e.prototype.open=function(f){this._dispatchEvent(new D(D.DROP_DOWN_OPENED,this));this._dom$.appendTo($("body"));this._locate(f);document.addEventListener("mousedown",this._mousedownHandler,true);$(window).on('blur',this._mousedownHandler);this._$container.css('opacity','1');this._$container.css('top','15px');};e.prototype._globalMouseDownHandler=function(f){var t=f.srcElement?f.srcElement:f.target;if(!$.contains(this._dom,t)){this.close();}};e.prototype._updateDropdownPosition=function(f){var m=this._$li.outerHeight()*11+this._$content.outerHeight()%this._$li.outerHeight();var n=this._$content.outerHeight()>m;if(n){this._$content.outerWidth(this._$li.outerWidth()+28);this._$content.outerHeight(m);}else{this._$content.outerWidth(this._$li.outerWidth()+14);}var g=this._$content.outerWidth();var h=this._$content.outerHeight();this._$container.css({'width':g+'px','height':h+'px'});var k=-5;var l=this._$container.outerWidth();var o=(l/3)*2+1;if(o/2>f){o+=o/2-f;}var p=k+o;this._$arrow.css({"left":p});this._$container.css({"left":-o});};e.prototype._locate=function(f){var s=document.body.scrollWidth-$(window).width();var g=$(window).outerWidth()-f.offset().left;this._updateDropdownPosition(g+s);this._dom$.css({"right":g,"top":f.offset().top+f.outerHeight()});if(this._$container.offset().left<0){var p=this._dom$.offset().left;var o=this._$container.offset().left;this._$container.css({"left":-p+"px"});var h=Number(this._$arrow.css("left").replace('px',''));this._$arrow.css({"left":h+o-this._$container.offset().left+"px"});}var k=$(window).width()-this._$arrow.offset().left-this._$arrow.outerWidth()-12;var l=$(window).width()-this._$container.offset().left-this._$container.outerWidth();var m=l-k;if(m>0){this._$container.css({"width":this._$container.width()+m});this._$content.css({"width":this._$content.width()+m});}};e.prototype.close=function(){var f=$(this._dom);var g=1;if(this._classVisible){f.removeClass(this._classVisible);g=2000;}setTimeout(function(){f.detach();},g);this._dispatchEvent(new D(D.DROP_DOWN_CLOSED,this));document.removeEventListener("mousedown",this._mousedownHandler,true);$(window).off('blur',this._mousedownHandler);this.destroy();};e.prototype._createChildren=function(){var _=this;this._dom$.addClass(d+'dropDownList');var f=this._$container=$('<div/>').appendTo(this._dom$);this._$container.addClass(d+'dropDownList-container');var g=this._$arrow=$('<div/>').appendTo(f);this._$arrow.addClass(d+'dropDownList-arrow uvb-dropDownList');var h=this._$content=$('<div/>').appendTo(f);this._$content.addClass([d+'dropDownList-content',a.COMMON_PREFIX+'scrollable',a.COMMON_PREFIX+'scrollable-y'].join(' '));var k=this._$ul=$('<ul/>').appendTo(h);this._$ul.addClass(d+'chart-list-container');var l=$('<div/>').appendTo(k).text(this._header);l.addClass(d+'chart-list-header');var i;var o;for(i=0;i<this._typeObjects.length;i++){o=this._typeObjects[i];this._$li=$('<li/>').appendTo(k).attr('class','chartList');var m=this._$li;m.data('type',o);m.click($.proxy(this._chartListClickHandler,this));var n=$('<div/>');n.addClass(d+'dropDownList-chart-list');var v=o.id;if((c.isBuildInType(v))||v===C.TYPE_TABLE||v===C.TYPE_CROSSTAB||v===C.TYPE_FUNNEL||v===C.TYPE_PC){n.append($("<div/>",{"class":d+"chart-icon"+" "+d+"chart-icon-"+o.icon}),$("<span/>",{"class":d+"chart-text","text":o.caption}));}else{if(!o.srcIcon){n.append($("<div/>",{"class":d+"chart-icon"+" "+d+"chart-icon-extension"}),$("<span/>",{"class":d+"chart-text","text":o.caption}));}else{n.append($("<img/>",{"class":d+"chart-icon","src":o.srcIcon}),$("<span/>",{"class":d+"chart-text","text":o.caption}));n.children('img').css('background','none');}}$(n[0].firstChild).css('margin','3px 5px 3px 0px');n.appendTo(m);}};e.prototype._chartListClickHandler=function(f){this._dispatchEvent(new D(D.ITEM_SELECTED,this,{'selectedTypeObject':$(f.currentTarget).data('type')}));this.close();};e.prototype.updateSelectedUI=function(s){var f=this._$ul.children('li');for(var i=0;i<f.length;i++){var g=$(f[i]);if(g.text()===s){g.addClass(d+'dropDownList-chart-list-selected');break;}}};return e;});u('sap/viz/controls/switchbar/views/Switcher',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/UIControl','sap/viz/controls/switchbar/views/SwitcherEvent','sap/viz/controls/switchbar/views/DropDownList','sap/viz/controls/switchbar/views/DropDownListEvent'],function($,C,a,b,O,c,U,S,D,d){var e=a.SWITCHBAR_PREFIX;var f=a.COMMON_PREFIX;var g=function(h,k,t){g.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.switchbar.views.Switcher';this._caption=k;this._typeObjects=t;this._selectedTypeObject=null;this._dom$=$(h);this._chartIcon$=null;this._arrow$=null;this._createChildren();this._commitSelectedType();this.size({'width':58,'height':34});};O.extend(g,U);g.prototype.selectedType=function(v){if(arguments.length>0){var t=null;if(v){for(var i=0;i<this._typeObjects.length;i++){if(this._typeObjects[i].id===v){t=this._typeObjects[i];break;}}}this.selectedTypeObject(t);}else{return this._selectedTypeObject?this._selectedTypeObject.id:null;}};g.prototype.selectedTypeObject=function(v){if(arguments.length>0){if(this._selectedTypeObject!=v||(this._selectedTypeObject&&v&&this._selectedTypeObject.id!=v.id)){this._selectedTypeObject=v;this._commitSelectedType();this._dispatchEvent(new S(S.TYPE_CHANGED,this));}}else{return this._selectedTypeObject;}};g.prototype._createChildren=function(){this._dom$.addClass([e+'chart',e+'switcher'].join(' '));var h=$(document.createElement('div'));h.addClass(e+'chart-icon-wrapper');var s=this._typeObjects[0].srcIcon;if(!s){this._chartIcon$=$(document.createElement('div'));}else{this._chartIcon$=$(document.createElement('img'));}this._chartIcon$.addClass(e+'chart-icon');this._updateChartIcon(this._typeObjects[0],false);this._chartIcon$.appendTo(h);h.click($.proxy(this._chartIconClickHandler,this));h.appendTo(this._dom$);var k=this._arrow$=$(document.createElement('div'));k.addClass(e+'splitter');k.appendTo(this._dom$);var l=this._arrow$=$(document.createElement('div'));l.addClass(e+'dropdown-arrow');$(document.createElement('div')).addClass([e+'dropdown-arrow-icon',f+'havanaSharedSprite16-mask'].join(' ')).appendTo(l);l.click($.proxy(this._arrowClickHandler,this));l.appendTo(this._dom$);};g.prototype._chartIconClickHandler=function(h){this.selectedTypeObject(this._chartIcon$.data('type'));};g.prototype._arrowClickHandler=function(h){var k=this._dropDownList=new D(document.createElement('div'),this._caption,this._typeObjects);k.addEventListener(d.ITEM_SELECTED,function(h){this.selectedTypeObject(h.data.selectedTypeObject);},this);if(this._selectedTypeObject){k.updateSelectedUI(this._selectedTypeObject.caption);}k.open(this._arrow$);};g.prototype._commitSelectedType=function(){if(this._selectedTypeObject){this._updateChartIcon(this._selectedTypeObject,true);this._dom$.removeClass(e+'chart');this._dom$.addClass(e+'chart-selected');}else{this._updateChartIcon(this._selectedTypeObject,false);this._dom$.addClass(e+'chart');this._dom$.removeClass(e+'chart-selected');}};g.prototype._updateChartIcon=function(t,s){if(!t){t=this._chartIcon$.data('type');}var v=t.id;if((c.isBuildInType(v))||v===C.TYPE_TABLE||v===C.TYPE_CROSSTAB||v===C.TYPE_FUNNEL||v===C.TYPE_PC){this._chartIcon$.attr({'class':e+'chart-icon'+' '+e+'chart-icon-'+(s?t.whiteIcon:t.icon),'title':t.caption}).data('type',t);}else{if(!t.srcIcon){if(this._chartIcon$[0].nodeName==='IMG'){this._chartIcon$=$(document.createElement("div")).replaceAll(this._chartIcon$);}this._chartIcon$.attr({'class':e+'chart-icon'+' '+e+'chart-icon-'+(s?'extension-white':'extension'),'title':t.caption}).data('type',t);}else{if(this._chartIcon$[0].nodeName==='DIV'){this._chartIcon$=$(document.createElement("img")).replaceAll(this._chartIcon$);}this._chartIcon$.attr({'class':e+'chart-icon','src':s?t.srcWhiteIcon:t.srcIcon,'title':t.caption}).data('type',t);this._chartIcon$.css('background','none');}}};return g;});u('sap/viz/controls/switchbar/SwitchBar',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/switchbar/SwitchBarConfig','sap/viz/controls/switchbar/SwitchBarEvent','sap/viz/controls/switchbar/views/Switcher','sap/viz/controls/switchbar/views/SwitcherEvent'],function($,V,C,a,L,O,b,c,R,S,d,f,g){var h=C.SWITCHBAR_PREFIX;var m=2;var k=2;var l=function(e,n){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.SwitchBar";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_switchbar_control');this._vizGroups=null;this._selectedTypeObject=null;this._direction=null;this._stacking=null;this._uiSwitchers=null;this._dom$=$(this._dom);this._dom$.addClass([C.SWITCHBAR_PREFIX+"view",C.COMMON_PREFIX+'scrollable',C.COMMON_PREFIX+'scrollable-y'].join(' '));this._container$=null;if(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getService!==undefined){var o=sap.bi.framework.getService("*","sap.viz.controls.switchbar.groups");if(o){n=JSON.parse(JSON.stringify(n));if(!n.defaultVizType&&o.defaultVizType){n.defaultVizType=o.defaultVizType;}if(!n.groups&&o.groups){n.groups=o.groups;}}}if(!n){n=S.instance();}this._parseConfiguration(n);this._horizontalGap=24;this._verticalGap=14;this._createChildren();this._validateSize();if(this._vizModel().type()===n.defaultVizType){this._applyModel();}else{this._vizModel().type(n.defaultVizType);}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_switchbar_control');};O.extend(l,V);l.prototype.vizType=function(v){if(arguments.length>0){if(!b.isString(v)){return;}var e=this._vizModel();var n=c.getType(e.type(),v);this._beginUpdateProperty();e.type(n);this._endUpdateProperty();return this;}else{return this._selectedTypeObject?this._selectedTypeObject.id:null;}};l.prototype.horizontalGap=function(v){if(arguments.length>0){if(isNaN(v)){throw L.get('VIZ_CONTROLS_API_PARAMETER_ERROR');}v=Math.max(m,Number(v));if(this._horizontalGap!==v){this._horizontalGap=v;this._validateSize();}return this;}else{return this._horizontalGap;}};l.prototype.verticalGap=function(v){if(arguments.length>0){if(isNaN(v)){throw L.get('VIZ_CONTROLS_API_PARAMETER_ERROR');}v=Math.max(k,Number(v));if(this._verticalGap!==v){this._verticalGap=v;this._validateSize();}return this;}else{return this._verticalGap;}};l.prototype.selectedTypeObject=function(v){if(arguments.length>0){if(this._selectedTypeObject!=v||(this._selectedTypeObject&&v&&this._selectedTypeObject.id!=v.id)){this._selectedTypeObject=v;this._commitSelectedTypeObject();}return this;}else{return this._selectedTypeObject;}};l.prototype.save=function(){var e={};e['type']=this.vizType();return e;};l.prototype.load=function(v){this.vizType(v.type);};l.prototype._onConnect=function(v){var e=this._vizModel();var n=c.getVizType(e.type());this._changeVizType(n);};l.prototype._onVizModelChanged=function(e){if(e.data.vizTypeChanged){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:change_switchbar_viz_type');this._applyModel();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:change_switchbar_viz_type');}};l.prototype._applyModel=function(e){var t=this._vizModel().type();this._direction=c.getDirection(t)||this._direction;this._stacking=c.getStacking(t)||this._stacking;this._changeVizType(c.getVizType(t));};l.prototype._changeVizType=function(v){var e=false;for(var i=0;i<this._vizGroups.length;i++){var n=this._vizGroups[i];for(var j=0;j<n.typeObjects.length;j++){var t=n.typeObjects[j];if(t.id===v){this.selectedTypeObject(t);e=true;break;}}if(e){break;}}if(!e){this.selectedTypeObject(null);}};l.prototype._commitSelectedTypeObject=function(){var s=this._selectedTypeObject?this._selectedTypeObject.id:null;for(var i=0;i<this._uiSwitchers.length;i++){this._uiSwitchers[i].selectedType(s);}this._dispatchPropertyEvent(new d(d.VIZ_TYPE_CHANGED,this,{'vizType':s}));};l.prototype._parseConfiguration=function(e){var n=function(n){};try{this._vizGroups=[];var o={};var p=e.groups;if(p&&p.length){for(var i=0;i<p.length;i++){var q=p[i];var r=q.types;if(!r||r.length===0){continue;}var v={'caption':q.name,'typeObjects':[]};for(var j=0;j<r.length;j++){var s=r[j];var t=s.id;if(o[t]){continue;}var w=sap.viz.api.manifest.Viz.get(t);if(!w||!w[0]){continue;}o[t]=true;var x=c.getVizTypeObject(t);if(!x){x={'id':t};var y=sap.viz.api.manifest.Viz.get(x.id);x.caption=(y&&y[0])?y[0].name:'';x.srcIcon=s.icon;x.srcWhiteIcon=s.whiteIcon;}v.typeObjects.push(x);}if(v.typeObjects.length>0){this._vizGroups.push(v);}}}}catch(z){n("Invalid config format");}};l.prototype._createChildren=function(){this._uiSwitchers=[];var e=this._container$=$(document.createElement('div')).addClass(h+'switcher-container');for(var i=0;i<this._vizGroups.length;i++){var n=this._vizGroups[i];var s=$(document.createElement('div'));var o=new f(s[0],n.caption,n.typeObjects);o.addEventListener(g.TYPE_CHANGED,this._switcherTypeChanged,this);s.appendTo(e);this._uiSwitchers.push(o);}e.appendTo(this._dom$);};l.prototype._switcherTypeChanged=function(e){var n=e.target();if(n.selectedTypeObject()){var o=this._vizModel();var p={};if(this._stacking){p.stacking=this._stacking;}if(this._direction){p.direction=this._direction;}var q=c.updateType(n.selectedTypeObject().id,p);if(c.isMultipleChart(o.type())){q=c.toMultiChartType(q);}o.type(q);}};l.prototype._validateSize=function(){var e=this._dom$.width();var o=0;var n=0;var s=0;for(var i=0;i<this._uiSwitchers.length;i++){var p=this._uiSwitchers[i];var q=p.size();var r=$(p._dom);r.css({'left':o,'top':n});o=o+q.width+this._horizontalGap;if(i+1<this._uiSwitchers.length){var t=this._uiSwitchers[i+1];if(o+t.size().width>e){o=0;n=n+q.height+this._verticalGap;s++;}}else{s++;}}if(this._uiSwitchers.length>0){var v=(this._uiSwitchers[0].size().height+this._verticalGap)*s;this._container$.height(v);}};return l;});u('sap/viz/controls/common/views/feed/PlayerFieldShelfEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var P=function(t,a,d){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.PlayerFieldShelfEvent";};O.extend(P,E);P.CLICK_ADD_PLAYER_FIELD="clickAddplayerField";P.PLAYER_FIELD_CHANGED="playerFieldChanged";P.ACTION_CHANGED="playerFieldActionChanged";P.PLAYER_FIELD_EMPTY_CHANGED="playerFieldEmptyChanged";P.PLAYER_FIELD_DROP_DENY="playerFieldDropDeny";return P;});u('sap/viz/controls/common/views/feed/PlayerFieldShelf',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/UIControl','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/PlayerFieldShelfEvent','sap/viz/controls/common/views/menu/PopUpMenu','sap/viz/controls/common/views/menu/PopUpMenuEvent','sap/viz/controls/common/views/menu/DockStrategy','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/views/menu/MenuItem','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/valueobjects/Shelf','sap/viz/controls/common/feeds/FeedItemType'],function($,O,U,C,a,D,b,P,c,d,e,M,f,L,g,h,F,H,S,k){var l=function(m){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.PlayerFieldShelf";this._dom$.addClass(C.FEEDINGSHELF_PREFIX+"view");this._list$=null;this._ghostCard$=null;this._draggingCard$=null;this._addIndicator$=null;this._addIcon$=null;this._activeHandler=$.proxy(this._active,this);this._dropIndicator$=$(document.createElement('hr')).addClass(C.FEEDINGSHELF_PREFIX+'drop-indicator');this._shelf=new S();this._shelf.id='playerField';this._shelf.name=L.get('VIZ_COMMON_ANIMATION');this._shelf.type=k.DIMENSION;this._shelf.analysisType=g.DIMENSION;this._shelf.feedItemType=k.DIMENSION;this._shelf.capacity=1;this._createChildren();this._droppable();this._enableFeeding=true;};O.extend(l,a);l.CARD_HEIGHT=24;l.prototype.shelf=function(){return this._shelf;};l.prototype.popUpDock=function(){var _=this;return function(){var o=_._list$.offset();return{'x':o.left,'y':o.top+l.CARD_HEIGHT/2,'shelfWidth':_._list$.outerWidth()};}};l.prototype.analyses=function(v){if(arguments.length>0){var i;var m={};for(i=0;i<v.length;){if(!m[v[i].id()]){m[v[i].id()]=true;i++;}else{v.splice(i,1);}}this._traversalCards(function(){$(this).remove();},true,true);for(i=0;i<v.length;i++){this._addCardAt(v[i],-1);}this._analysesChanged();return this;}else{var n=[];this._traversalCards(function(o){var p=$(this);var q=p.data('__analysis');if(q){n.push(q);}},true,true);return n;}};l.prototype._numCards=function(){var n=0;this._traversalCards(function(m){n++;},true,true);return n;};l.prototype.addAnalysis=function(m){return this._addAnalysisAt(m,-1);};l.prototype._addAnalysisAt=function(m,n){var o=this._addCardAt(m,n);this._analysesChanged();return o;};l.prototype.destroy=function(){this.removeAllEventListeners();$('body').off('mouseup',this._activeHandler);l.superclass.destroy.apply(this,arguments);};l.prototype._createChildren=function(){var m=$(document.createElement('div')).appendTo(this._dom$).addClass(C.FEEDINGSHELF_PREFIX+'item');var n=$(document.createElement('div')).appendTo(m).addClass(C.FEEDINGSHELF_PREFIX+'item-title');n.text(this._shelf.name);var o=$(document.createElement('div')).appendTo(m).addClass(C.FEEDINGSHELF_PREFIX+'item-content');var p=this._list$=$(document.createElement('div')).appendTo(o).addClass(C.FEEDINGSHELF_PREFIX+'item-list');var q=this._addIndicator$=$(document.createElement('div')).appendTo(p);q.addClass(C.FEEDINGSHELF_PREFIX+'item-ph');var r=$(document.createElement('a')).appendTo(q);r.addClass(C.FEEDINGSHELF_PREFIX+'item-ph-text');var s=this._addIcon$=$(document.createElement('div')).appendTo(o).addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');s.addClass(C.FEEDINGSHELF_PREFIX+'item-add-icon');var t=$.proxy(this._dispatchAddFeedingEvent,this);q.on('mousedown',this._activeHandler).on('mouseenter',this._activeHandler).on('mouseleave',this._activeHandler).on('click',t);s.on('mousedown',this._activeHandler).on('mouseenter',this._activeHandler).on('mouseleave',this._activeHandler).on('click',t);$('body').on('mouseup',this._activeHandler);};l.prototype._dispatchAddFeedingEvent=function(){if(this.enableFeeding()){this._dispatchEvent(new P(P.CLICK_ADD_PLAYER_FIELD,this));}};l.prototype._active=function(m){if(this._enableFeeding){if(m.type==='mouseup'||m.type==='mouseleave'){this._list$.removeClass(C.FEEDINGSHELF_PREFIX+'item-list_active');this._addIcon$.removeClass(C.FEEDINGSHELF_PREFIX+'item-add-icon_active');}else if(m.type==='mousedown'||m.type==='mouseenter'){this._list$.addClass(C.FEEDINGSHELF_PREFIX+'item-list_active');this._addIcon$.addClass(C.FEEDINGSHELF_PREFIX+'item-add-icon_active');}}};l.prototype._isValidToken=function(m){if(this._draggingCard$){return true;}var t=m.type();var n=m.dataType();var o=t?t.toLowerCase():t;var p=n?n.toLowerCase():n;var s=this._shelf.feedItemType;var v=F.feedCompatible(s,o,p);if(v){var q=this.analyses();for(var i=0;i<q.length;i++){if(q[i].id()===m.id()){v=false;break;}}}return v;};l.prototype._droppable=function(){var _=this;var m;var n;this._list$.droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,activate:function(o,p){},deactivate:$.proxy(function(o,p){if(this._ghostCard$){this._ghostCard$.remove();}if(this._dropIndicator$){this._dropIndicator$.detach();}},this),drop:$.proxy(function(o,p){var q=p.helper;var t=D.instance().getAnalysisToken(q);var r=t.analysisObject;if(t.currentAction()!==b.DENY&&this._isValidToken(r)){t.killRevertAnimation();if(m){t.currentAction(b.ACCEPT_AS_REPLACEMENT);$(m).detach();}else{t.currentAction(b.ACCEPT);}this._addAnalysisAt(r,n);}else{t.currentAction(b.DENY);}t.dropTarget(this._shelf);if(this._ghostCard$){this._ghostCard$.remove();}this._dropIndicator$.detach();},this),over:function(o,p){var q=p.helper;U.defer(function(){var t=D.instance().getAnalysisToken(q);var r=t.analysisObject;if(_._isValidToken(r)){if(_._numCards()===0){if(!_._enableFeeding){t.currentAction(b.DENY);var w=L.get('VIZ_COMMON_DIMENSION_LIMITATION_WARN');t.showWarn(w);return;}else{_._ghostCard$=_._addGhostAnalysisAt(r,0);t.currentAction(b.ACCEPT);}}else{q.on('sap.viz.controls.analysisDrag.events.drag',function(o,s,v){var x=[];var y=-1;_._traversalCards(function(I){if(_._draggingCard$&&_._draggingCard$[0]===this){y=I;}x.push({'card':this,'offset':$(this).offset()});},false,true);n=-1;m=null;for(var i=0;i<x.length;i++){var z=x[i].offset.top;if(v<z+l.CARD_HEIGHT-6){n=i;if(v>=z+2){}break;}}if(n===-1){n=x.length;}if(r.type===g.MND){n=(n<x.length/2)?0:x.length;}if(!_._draggingCard$&&_._numCards()===1){m=x[n===x.length?n-1:n].card;}var E=y!==-1;var G=E&&(y===n||(y+1===n&&!m));if(E){m=null;}_._dropIndicator$.detach();if(m){t.currentAction(b.ACCEPT_AS_REPLACEMENT);}else{if(!_._enableFeeding){t.currentAction(b.DENY);var w=L.get('VIZ_COMMON_DIMENSION_LIMITATION_WARN');t.showWarn(w);}else{t.currentAction(b.ACCEPT);if(!G){_._addElementAt(_._list$,_._dropIndicator$,n);}}}});}}else{t.currentAction(b.DENY);}});},out:$.proxy(function(o,p){var q=p.helper;q.off('sap.viz.controls.analysisDrag.events.drag');var t=D.instance().getAnalysisToken(q);t.playDefaultAction();if(this._ghostCard$){this._ghostCard$.remove();}this._dropIndicator$.detach();t.showWarn();},this)});};l.prototype._traversalCards=function(m,n,o){var p=this._list$.children();var q=0;for(var i=0;i<p.length;i++){var r=p[i];if(this._addIndicator$&&this._addIndicator$[0]===r){continue;}if(this._dropIndicator$&&this._dropIndicator$[0]===r){continue;}if(n&&this._draggingCard$&&this._draggingCard$[0]===r){continue;}if(o&&this._ghostCard$&&this._ghostCard$[0]===r){continue;}m.call(r,q);q++;}};l.prototype._addGhostAnalysisAt=function(m,n){var o=this._addCardAt(m,n);o.addClass(C.FEEDINGSHELF_PREFIX+'card-ghost');return o;};l.prototype._removeCard=function(m){m.remove();this._analysesChanged();};l.prototype._analysesChanged=function(){var n=this._numCards();if(n>=1){this._addIndicator$.addClass(C.FEEDINGSHELF_PREFIX+'item-ph-half');}else{this._addIndicator$.removeClass(C.FEEDINGSHELF_PREFIX+'item-ph-half');}if(n>=1){this._addIcon$.css('display','none');this._addIndicator$.detach();}else{this._addIcon$.css('display','block');this._addIndicator$.appendTo(this._list$);}this._dispatchEvent(new P(P.PLAYER_FIELD_CHANGED,this));};l.prototype._updateCard=function(m,n){var o;if(n.type()===g.HIERARCHY){o=n.selectedHierarchyLevel().name();}else{o=n.name();}m.data('__analysis',n);m.attr('title',o);var t=$('.'+C.FEEDINGSHELF_PREFIX+'card-text',m);t.text(o);};l.prototype._genHierarchyMenuGroups=function(m){var n=[];var o=m.hierarchyLevels();for(var i=0;i<o.length;i++){var p=o[i];var q=new f(p.id(),p.name());q.selected(p.selected());n.push(q);}var r=[new M(n,true)];return r;};l.prototype._genMeasureMenuGroups=function(m){return m.actions();};l.prototype._addCardAt=function(m,n){var o=$(document.createElement('div')).addClass(C.FEEDINGSHELF_PREFIX+'card');var p=0;var i,j;var q,r,s,t;if(m.type()===g.HIERARCHY){var v=$(document.createElement('span')).appendTo(o);v.addClass([C.FEEDINGSHELF_PREFIX+'hierarchy-card-icon',C.COMMON_PREFIX+'UVBSharedSprite'].join(' '));this._createCardAction(o,this._genHierarchyMenuGroups,$.proxy(function(z){m=m.clone();m.selectedHierarchyLevelID(z.data.selectedItem.id());this._updateCard(o,m);this._dispatchEvent(new P(P.PLAYER_FIELD_CHANGED,this));},this),m);p++;}else if(m.type()===g.MEASURE&&m.actions()&&m.actions().length>0){this._createCardAction(o,this._genMeasureMenuGroups,$.proxy(function(z){this._dispatchEvent(new P(P.ACTION_CHANGED,this,{'feedItemID':this._shelf.id,'analysisObjectID':m.id(),'actionID':z.data.selectedItem.id()}));},this),m);p++;}var w=$(document.createElement('div')).appendTo(o);w.attr('style','width:19px; height:22px;');w.addClass(C.FEEDINGSHELF_PREFIX+'card-operation-div');var x=$(document.createElement('span')).appendTo(w);x.addClass(C.FEEDINGSHELF_PREFIX+'card-operation '+C.COMMON_PREFIX+'havanaSharedSprite16');w.click($.proxy(function(){this._removeCard(o);},this));p++;var y=$(document.createElement('div')).appendTo(o);y.addClass([C.FEEDINGSHELF_PREFIX+'card-text',C.FEEDINGSHELF_PREFIX+'card-text-with-icon-'+p].join(' '));y.addClass(C.COMMON_PREFIX+'text-ellipsis');this._updateCard(o,m);this._addElementAt(this._list$,o,n);this._draggable(o);return o;};l.prototype._createCardAction=function(m,n,o,p){var q=$(document.createElement('div')).appendTo(m);q.attr('style','width:19px; height:22px;');q.addClass(C.FEEDINGSHELF_PREFIX+'action-icon-div');var r=$(document.createElement('span')).appendTo(q);if(p.type()===g.HIERARCHY){m.addClass(C.FEEDINGSHELF_PREFIX+'card-hierarchy');r.addClass([C.FEEDINGSHELF_PREFIX+'action-icon-hierarchy',C.COMMON_PREFIX+'UVBSharedSprite'].join(' '));}if(p.type()===g.MEASURE){m.addClass(C.FEEDINGSHELF_PREFIX+'card-measure');r.addClass([C.FEEDINGSHELF_PREFIX+'action-icon-measure',C.COMMON_PREFIX+'havanaSharedSprite16'].join(' '));}q.on('click',$.proxy(function(){var s=new c(document.createElement('div'),n.call(this,m.data('__analysis')));s.addEventListener(d.ITEM_SELECTED,o,this);s.open(q,e.DOWN_WITH_ARROW);},this));return q;};l.prototype._addElementAt=function(m,n,o){var p=m.children();if(o!==-1&&o<p.length){$(p[o]).before(n);}else{m.append(n);}};l.prototype._draggable=function(m){var _=this;D.enableDraggableFeeding(m[0],m.data('__analysis'));m.draggable({containment:'document',revert:'valid',helper:function(n){var o=D.getDefaultHelper(this);var t=D.instance().getAnalysisToken($(o));t.defaultAction(b.AS_TRASH);return o;},start:$.proxy(function(n,o){this._draggingCard$=$(this);this._draggingCard$.addClass(C.FEEDINGSHELF_PREFIX+'card-ghost');var p=o.helper;var t=D.instance().getAnalysisToken(p);var q=t.analysisObject;var r={'analysisObject':q,'feedId':this._shelf.id};this._dispatchEvent(new P(P.PLAYER_FIELD_EMPTY_CHANGED,this,r));},this),stop:function(n,o){var p=o.helper;if(_._draggingCard$){_._draggingCard$.removeClass(C.FEEDINGSHELF_PREFIX+'card-ghost');_._draggingCard$=null;}var t=D.instance().getAnalysisToken(p);if(!t.dropTarget()||t.currentAction()===b.ACCEPT||t.currentAction()===b.ACCEPT_AS_REPLACEMENT){_._removeCard($(this));}else{var q={'analysisObject':t.analysisObject,'feedId':_._shelf.id};_._dispatchEvent(new P(P.PLAYER_FIELD_DROP_DENY,this,q));}},drag:function(n,o){}});};l.prototype.enableFeeding=function(m){if(arguments.length>0){this._enableFeeding=m;this._updateFeedingEnabled(m);}else{return this._enableFeeding;}};l.prototype._updateFeedingEnabled=function(m){if(m){this._list$.css('cursor','pointer');this._addIcon$.css('display','block');}else{this._list$.css('cursor','default');this._addIcon$.css('display','none');}};l.langProps={'changeCalculation':'VIZ_COMMON_CHANGE_CALCULATION','sum':'VIZ_COMMON_SUM','average':'VIZ_COMMON_AVERAGE','min':'VIZ_COMMON_MIN','max':'VIZ_COMMON_MAX','countDistinct':'VIZ_COMMON_COUNT_DISTINCT','countAll':'VIZ_COMMON_COUNT_ALL','none':'VIZ_COMMON_NONE','sum_short':'VIZ_COMMON_SUM_SHORT','average_short':'VIZ_COMMON_AVERAGE_SHORT','min_short':'VIZ_COMMON_MIN_SHORT','max_short':'VIZ_COMMON_MAX_SHORT','countDistinct_short':'VIZ_COMMON_COUNT_DISTINCT_SHORT','countAll_short':'VIZ_COMMON_COUNT_ALL_SHORT','none_short':'VIZ_COMMON_NONE_SHORT'};return l;});u('sap/viz/controls/feeding/FeedingPanelEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.FeedingPanelEvent";};O.extend(F,E);F.ACTION_CHANGED="actionChanged";return F;});u('sap/viz/controls/feeding/FeedingPanel',['jquery','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/SubtotalItemType','sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/views/feed/FeedingShelf','sap/viz/controls/common/views/feed/FeedingShelfEvent','sap/viz/controls/common/views/feed/PlayerFieldShelf','sap/viz/controls/common/views/feed/PlayerFieldShelfEvent','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/feeding/FeedingPanelConfig','sap/viz/controls/feeding/FeedingPanelEvent','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/utils/Serialization'],function($,F,b,O,V,C,L,c,d,f,g,S,h,m,n,o,P,p,R,r,s,t,v,w,x,y){var z=C.COMMON_PREFIX;var D=function(a,e){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.feeding.FeedingPanel";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_feedingpanel_control');this._dom$=$(a);this._dom$.addClass([C.FEEDINGPANEL_PREFIX+"view",z+'scrollable',z+'scrollable-y'].join(' '));this._uiShelf=null;this._dicUIShelf={};this._trellisArrowIcon$=null;this._trellisCollapsed=true;this._trellisDom$=null;this._trellisContainer$=null;this._allAnalyses=null;this._uiConfig=e?e:v.instance();this._enableTrellis=(this._uiConfig.enableTrellis!==false);this._feedsUpdatedRequested=false;if(this._vizModel().type()===this._uiConfig.defaultVizType){this._applyModel();}else{this._vizModel().type(this._uiConfig.defaultVizType);}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_feedingpanel_control');};O.extend(D,c);D.prototype.feeds=function(a){if(arguments.length>0&&b.isArray(a)){if(a!=null&&!V.isArrayOfFeedItem(a)){return;}var e=this._vizModel().type();if(s.isGeo(e)){var k=[];for(var i=0;i<a.length;i++){k[i]=t.cloneFeeds(a[i]);}this._vizModel().feedingItems(k,this._enableTrellis);}else{var k=t.cloneFeeds(a);this._vizModel().feedingItems(k,this._enableTrellis);}return this;}else{return this._vizModel().explicitFeedingItems(a);}};D.prototype.playerField=function(a){if(arguments.length>0){this._vizModel().playerField(a);return this;}else{return this._vizModel().playerField();}};D.prototype.analysisObjectsForPicker=function(a){if(arguments.length>0){if(a!=null&&!V.isArrayOfAnalysisObject(a)){return;}this._allAnalyses=a;}else{return this._allAnalyses;}};D.prototype.feedAnalysisObjects=function(a,e){if(a!=null&&!V.isArrayOfAnalysisObject(a)){return;}var k=this._vizModel();var l;if(e===true){l=x.suggestFeeds(k.type(),k.explicitFeedingItems(),a);}else{l=x.suggestFeeds(k.type(),a);}if(l){k.feedingItems(l.feeds);}return l.feeds;};D.prototype.save=function(){var a={};var e=this._vizModel().type();a['type']=e;if(s.isGeo(e)){var k=[];var l=this.feeds();for(var i=0;i<l.length;i++){k[i]=f.toJSON(l[i]);}a["feedingItems"]=k;}else{a["feedingItems"]=f.toJSON(this.feeds());}return a;};D.prototype.load=function(a){var e=y.migrateFeedingPanel(a);var k=e.type;this._vizModel().type(k);var l=e.feedingItems;if(l){if(s.isGeo(k)){var q=[];for(var i=0;i<l.length;i++){q[i]=f.fromJSON(l[i]);}this.feeds(q);}else{var q=f.fromJSON(l);if(q&&q.length>0){this.feeds(q);}}}var E=this.playerField();if(E){this._playerFieldShelf.analyses([E]);}};D.langProps={'measures':'VIZ_COMMON_MEASURES','dimensions':'VIZ_COMMON_DIMENSIONS','subtotals':'VIZ_COMMON_SUBTOTALS','trellis':'VIZ_COMMON_TRELLIS'};D.prototype._onConnect=function(a,e){if(e){this._vizModel().extensionValues({feedingPanel:{enableTrellis:this._enableTrellis}});this._applyModel();}};D.prototype._onVizModelChanged=function(e){var a=this._vizModel().type();if(s.isGeo(a)){return;}if(e.data.vizTypeChanged){this._applyModel();}else if(e.data.feedingItemsChanged||e.data.isMNDVisibleChanged||e.data.sliceDimensionChanged){this._applyModel(false);}};D.prototype._getFeed=function(a){var e=this._vizModel().feedingItems()||[];for(var i=0;i<e.length;i++){var k=e[i];if(k.id()===a){return k;}}return null;};D.prototype._applyModel=function(a){if(a!==false){this._createShelves();}this._updateShelves();};D.prototype._createShelves=function(){var a=r.getInitialShelves(this._vizModel().type());this._redrawShelves(a.measure,a.attribute,a.subtotal,a.trellis,a.playerField);};D.prototype._updateShelves=function(){var a=this._vizModel().explicitFeedingItems()||[];var e=function(q){for(var E in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(E)){var G=this._dicUIShelf[E];var H=[];for(var i=0;i<a.length;i++){var I=a[i];if(I.id()===G.shelf().id){H=I.values();}}q(G,H);}}};var k=[];e.call(this,function(q,E){for(var i=0;i<E.length;i++){var G=E[i];if(d.compatible(d.MEASURE,G.type())){k.push(G.name());}}});e.call(this,function(q,E){for(var i=0;i<E.length;i++){var G=E[i];if(d.compatible(d.MND,G.type())){G.name('('+k.join(',')+')');}}q.analyses(E);});var l=this.playerField();if(this._playerFieldShelf){if(l){this._playerFieldShelf.analyses([l]);}else{this._playerFieldShelf.analyses([]);}}};D.prototype._isShelvesEqual=function(a,e){if(null==a||null==e||a.length!==e.length){return false;}for(var i=0;i<a.length;i++){var k=a[i];var l=e[i];if(!k.equals(l)){return false;}}return true;};D.prototype._redrawShelves=function(a,e,k,l,q){var E;if(this._oldvizModelType){var G=r.getInitialShelves(this._oldvizModelType);if(this._isShelvesEqual(a,G.measure)&&this._isShelvesEqual(e,G.attribute)&&this._isShelvesEqual(k,G.subtotal)&&this._isShelvesEqual(l,G.trellis)&&s.supportAnimation(this._vizModel().type())==s.supportAnimation(this._oldvizModelType)){return;}}this._dom$.empty();for(var H in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(H)){E=this._dicUIShelf[H];E.destroy();}}this._dicUIShelf={};this._playerFieldShelf=null;this._createSection(L.get(D.langProps['measures']),a);this._createSection(L.get(D.langProps['dimensions']),e);this._createSection(L.get(D.langProps['subtotals']),k);if(s.supportAnimation(s.toSingleChartType(this._vizModel().type()))){this._createPlayerField();}if(this._enableTrellis){this._createSection(L.get(D.langProps['trellis']),l);}for(var I in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(I)){E=this._dicUIShelf[I];E.addEventListener(o.CLICK_ADD_FEEDING,this._clickAddFeeding,this);E.addEventListener(o.FEEDING_CHANGED,this._deferFeedsUpdated,this);E.addEventListener(o.FEEDING_EMPTY_CHANGED,this._dragToUpdateShelvesStatus,this);E.addEventListener(o.FEEDING_DROP_DENY,this._updateShelvesStatus,this);E.addEventListener(o.ACTION_CHANGED,this._actionChangedHandler,this);}}if(this._playerFieldShelf){this._playerFieldShelf.addEventListener(p.CLICK_ADD_PLAYER_FIELD,this._clickAddPlayerField,this);this._playerFieldShelf.addEventListener(p.PLAYER_FIELD_CHANGED,this._deferFeedsUpdated,this);this._playerFieldShelf.addEventListener(p.PLAYER_FIELD_EMPTY_CHANGED,this._dragToUpdateShelvesStatus,this);this._playerFieldShelf.addEventListener(p.PLAYER_FIELD_DROP_DENY,this._updateShelvesStatus,this);}this._oldvizModelType=this._vizModel().type();};D.prototype._clickAddFeeding=function(e){var a=e.target();this._uiShelf=a;if(this._uiConfig&&this._uiConfig.useBuildInFeedList===true){var k=a.shelf();var l=document.createElement('div');var q=this._getFeed(k.id);var E=q?q.values():[];if(k.id===g.ROW_SUBTOTALS||k.id===g.COLUMNS_SUBTOTALS){for(var j=0;j<E.length;j++){var G;if(E[j].aggregationTarget()!==undefined){G=E[j].aggregationTarget();}else{G=b.decode(E[j].id())[0];}E[j].id(G);}for(var i=E.length-1;i>=0;i--){if(E[i].aggregationType()!==null&&E[i].aggregationType()!==S.TOTAL){E.splice(i,1);}}var H=new h(l,S.sanitizeAnalysisObjects(this._allAnalyses),k.feedItemType,E);}else{var H=new h(l,this._allAnalyses,k.feedItemType,E);}H.addEventListener(m.ITEM_SELECTED,function(e){var I=e.data.selectedItem;a.addAnalysis(I);},this);H.open(a.popUpDock());}else{this._dispatchEvent(new F(F.REQUEST_FEED,this,{'feedId':a.shelf().id,'fieldLocalPosition':a.popUpDock()}));}};D.prototype._clickAddPlayerField=function(e){var a=e.target();this._playerFieldShelf=a;var k=a.shelf();var l=document.createElement('div');var q=this._getFeed(k.id);var E=q?q.values():[];var G=new h(l,this._allAnalyses,k.feedItemType,E);var H=this;G.addEventListener(m.ITEM_SELECTED,function(e){var I=e.data.selectedItem;H.playerField(I);},this);G.open(a.popUpDock());};D.prototype._actionChangedHandler=function(e){if(e.data.feedItemID===g.ROWS&&e.data.actionID.indexOf(S.action)!==-1){aggregationType=S.getAggregationType(e.data.actionID);if(aggregationType===null){return;}this.updateSubtotalsWithRowAction(aggregationType,e.data.analysisObjectID,e.data.feedItemID);}this._dispatchEvent(new w(w.ACTION_CHANGED,this,{'feedItemID':e.data.feedItemID,'analysisObjectID':e.data.analysisObjectID,'actionID':e.data.actionID}));};D.prototype._deferFeedsUpdated=function(e){if(!this._feedsUpdatedRequested){this._feedsUpdatedRequested=true;b.defer($.proxy(function(){this._feedsUpdatedRequested=false;if(this._dom){this._feedsUpdated();}},this));}};D.prototype._createSection=function(a,e){if(e.length===0){return;}var k=$(document.createElement('div')).appendTo(this._dom$);var l=$(document.createElement('div')).appendTo(k);l.addClass(C.FEEDINGPANEL_PREFIX+"title-without-icon");var q=$(document.createElement('label')).appendTo(l);q.addClass(C.FEEDINGPANEL_PREFIX+"title-text");q.text(a);var E=$(document.createElement('div')).appendTo(k);E.addClass(C.FEEDINGPANEL_PREFIX+"separator");var G=$(document.createElement('div')).appendTo(k);G.addClass(C.FEEDINGPANEL_PREFIX+"container");var H=this._vizModel();for(var i=0;i<e.length;i++){var I=e[i];var J=new n(document.createElement('div'),I,this._uiConfig.measure);if(H){this._setUiShelfAddIconState(J,H);}G.append(J._dom);this._dicUIShelf[I.id]=J;}if(e[0].type==="trellis"){this._trellisDom$=k;l.removeClass(C.FEEDINGPANEL_PREFIX+"title-without-icon");l.addClass(C.FEEDINGPANEL_PREFIX+"title-with-icon");var K=this._trellisArrowIcon$=$(document.createElement('div'));K.appendTo(l);K.click($.proxy(this._trellisArrowIconClickHandler,this));q.click($.proxy(this._trellisArrowIconClickHandler,this));this._trellisContainer$=G;this._updateTrellisSection(this._trellisCollapsed);}};D.prototype._createPlayerField=function(){var a=$(document.createElement('div')).appendTo(this._dom$);var e=$(document.createElement('div')).appendTo(a);e.addClass(C.FEEDINGPANEL_PREFIX+"container");var k=new P(document.createElement('div'));e.append(k._dom);this._playerFieldShelf=k;};D.prototype._setUiShelfAddIconState=function(a,e){var k=t.cloneFeeds(e.feedingItems());var l=e.type();var q=a._shelf.id;var E=t.getManifestFeedsMap(l);if(!s.isMultipleChart(l)&&s.supportMultiChart(l)){var G=s.toMultiChartType(l);var H=t.getManifestFeedsMap(G);var I=t.supportMultiChart(k,H);if(I){var J=H[t.MultiplierFeedingName];E[t.MultiplierFeedingName]=J;}}var K=e.isMNDVisible();var M=false;var N=q;var Q,T;if(a){if(a.shelf().analysisType===d.MEASURE){T=this._getFeed(N);Q=((T?T.values().length:0)<a.shelf().capacity);}else{if(q===t.RowsFeedingName||q===t.ColumnsFeedingName){N=t.MultiplierFeedingName;}if(N===t.MultiplierFeedingName&&this.playerField()){Q=false;}else{Q=t.canAddValue(k,q,E,K,M,N);}}a.enableFeeding(Q);}};D.prototype._feedsUpdated=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_feeds');var a=this._vizModel();var e=this.playerField();if(this._playerFieldShelf){e=this._playerFieldShelf.analyses()[0];}var k=[];for(var l in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(l)){var q=this._dicUIShelf[l];var E=q.shelf();if(l===g.ROW_SUBTOTALS||l===g.ROWS){this._compareRowsAndSubtotals(this._dicUIShelf);k.push(new f(g.ROW_SUBTOTALS,g.CALCULATION,this._dicUIShelf[g.ROW_SUBTOTALS].analyses()));k.push(new f(g.ROWS,t.convertFeedType(E.feedItemType),this._dicUIShelf[g.ROWS].analyses()));this._compareRowsAndSubtotalsForHierarchies(this._dicUIShelf);break;}k.push(new f(E.id,t.convertFeedType(E.feedItemType),q.analyses()));}}var G=a.explicitFeedingItems();var H=!t.equal(G,k);if(H){a.feedingItems(k);this._dispatchEvent(new F(F.FEEDS_CHANGED,this,{'feeds':this.feeds()}));}if(this._playerFieldShelf){a.playerField(e);}this._updateShelvesStatus();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_feeds');};D.prototype._compareRowsAndSubtotalsForHierarchies=function(a){var e=null;var k=null;for(var l in this._dicUIShelf){if(l===g.ROWS){k=this._dicUIShelf[l];}if(l==g.ROW_SUBTOTALS){e=this._dicUIShelf[l];}}var q=k.analyses();var E=e.analyses();if(k.lastHierarchyOjbectUpdated()){for(var i=0;i<E.length;i++){var G=E[i];if(G.id().indexOf(k.lastHierarchyOjbectUpdated().id())>-1){var H=G.hierarchyLevels();var I=k.lastHierarchyOjbectUpdated().selectedHierarchyLevel();for(var j=0;j<H.length;j++){var J=H[j];if(J.id()===I.id()){G.selectedHierarchyLevelID(J.id());}}}}}else if(e.lastHierarchyOjbectUpdated()){for(var i=0;i<q.length;i++){var G=q[i];if(e.lastHierarchyOjbectUpdated().id().indexOf(G.id())>-1){var H=G.hierarchyLevels();var I=e.lastHierarchyOjbectUpdated().selectedHierarchyLevel();for(var j=0;j<H.length;j++){var J=H[j];if(J.id()===I.id()){G.selectedHierarchyLevelID(J.id());}}}}}k.lastHierarchyOjbectUpdated(null);e.lastHierarchyOjbectUpdated(null);};D.prototype.updateSubtotalsWithRowAction=function(a,e,k){var l=null;var q=null;var E=null;for(var G in this._dicUIShelf){if(G===g.ROWS){q=this._dicUIShelf[G];}if(G==g.ROW_SUBTOTALS){l=this._dicUIShelf[G];}}if(q){var H=q.analyses();for(var i=0;i<H.length;i++){if(H[i].id()===e){E=H[i].clone();}}}if(l&&E){var I=E.id();E.id(b.encode(I,a));E.aggregationType(a);E.aggregationTarget(b.decode(I)[0]);E.actions(null);l.addAnalysis(E);}};D.prototype._compareRowsAndSubtotals=function(a){var e;var k;var q=true;for(var E in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(E)){var G=this._dicUIShelf[E];if(E===g.ROWS){k=G;}if(E==g.ROW_SUBTOTALS){e=G;}}}if(k._lastAnalysisObjectRemoved!==null&&k.analyses().length!==0){for(var i=0;i<k.analyses().length;i++){if(k._lastAnalysisObjectRemoved.id()===k.analyses()[i].id()){q=false;}}}var H=e._lastAnalysisObjectRemoved;if(H!==null){k._lastTwinAnalysisObjectRemoved=H;}var I=e.analyses().length;var J=[];for(var i=0;i<I;i++){var K=e.analyses()[i];var M=e.analyses();var N=K.clone();var Q=K.clone();if(!K.aggregationType()&&k._lastTwinAnalysisObjectRemoved===null){k._lastTwinAnalysisObjectRemoved=K;for(var i=0;i<k.analyses().length;i++){if(K.id()===k.analyses()[i].id()){k._lastTwinAnalysisObjectRemoved=null;break;}}}if(k._lastTwinAnalysisObjectRemoved===null){if(k._lastCardRemoved!==null&&this._analysisObjectInShelfAnalyses(k._lastAnalysisObjectRemoved,e.analyses())){var T=k._lastCardRemoved;var U=k._lastAnalysisObjectRemoved;var W;if(K.aggregationTarget()!==undefined){W=K.aggregationTarget();}else{W=b.decode(K._id)[0];}if(W===U._id){var X=e.getCardFromAnalysisObject(K);if(X){J.push(X);}}}else if(!this._analysisObjectInShelfAnalyses(K,k.analyses())){k.addAnalysis(N);D.updateSubtotalsAnalysisObject(Q,S.TOTAL,M,i,e);}else if(!K.aggregationType()){D.updateSubtotalsAnalysisObject(Q,S.TOTAL,M,i,e);}else if(K.aggregationType()&&this._analysisObjectInShelfAnalyses(K,k.analyses())&&this._compareSubtotalNameToParentDimension(K,k.analyses())){D.updateSubtotalsAnalysisObject(Q,K.aggregationType(),M,i,e);}}else if(k._lastTwinAnalysisObjectRemoved){if(!this._analysisObjectInShelfAnalyses(K,k.analyses())){k.addAnalysis(N);D.updateSubtotalsAnalysisObject(Q,S.TOTAL,M,i,e);}else if(!K.aggregationType()){D.updateSubtotalsAnalysisObject(Q,S.TOTAL,M,i,e);}k.resetTwinAnalysisObject();e.resetLastRemoved();}}if(J.length>0){k.resetLastRemoved();e.resetLastRemoved();if(q===true){for(var l=0;l<J.length;l++){e.removeCard(J[l]);}}}};D.updateSubtotalsAnalysisObject=function(a,e,k,l,E){if(a.dataType()===g.LEVEL||a.dataType()===g.HIERARCHY){var G=a.hierarchyLevels();for(var i=0;i<G.length;i++){var H=G[i];if(H.selected()){H._name=S.getSubTotalsAggregationDisplayType(e)+" "+H._name;}}}else{a.name(S.getSubTotalsAggregationDisplayType(e)+" "+a.name());}var I=a.id();a.aggregationType(e);if(a.aggregationTarget()!==undefined){a.aggregationTarget(a.aggregationTarget());}else{a.aggregationTarget(b.decode(I)[0]);}a.id(b.encode(I,e));a.actions(null);if(E.analyses().length>1){temp=a.id().split("_encoded")[0];for(var q=0;q<E.analyses().length;q++){if(temp===E.analyses()[q].id()){l=q;break;}}}k[l]=a;E.analyses(k);};D.foundTokenInName=function(a,e){if(a._name.indexOf(e)===-1){return false;}else{return true;}};D.prototype._analysisObjectInShelfAnalyses=function(a,e){for(var i=0;i<e.length;i++){var k=e[i];var l=b.decode(k.id())[0];var q=b.decode(a.id())[0];if(l===q){return true;}else if(k.aggregationTarget()!==undefined&&q===k.aggregationTarget()){return true;}else if(a.aggregationTarget()!==undefined&&l===a.aggregationTarget()){return true;}}return false;};D.prototype._compareSubtotalNameToParentDimension=function(a,e){for(var i=0;i<e.length;i++){var l=e[i];if((a.dataType()===g.LEVEL||a.dataType()===g.HIERARCHY)&&(l.dataType()===g.LEVEL||l.dataType()===g.HIERARCHY)){var q;if(a.aggregationTarget()!==undefined){q=a.aggregationTarget();}else{q=b.decode(a.id())[0];}if(q===l.id()){var E=a.hierarchyLevels();var G=l.hierarchyLevels();for(var j=0;j<E.length;j++){var H=E[j];if(H.selected()){for(var k=0;k<G.length;k++){var I=G[k];if(I.selected()){if(I.name()===H.name()){return true;}}}}}}}else if(l.name()===a.name()){return true;}}return false;};D.prototype._dragToUpdateShelvesStatus=function(e){var k=e.data;var l=k.analysisObject;var q=k.feedId;var E=this._vizModel();if(E){var G=t.cloneFeeds(E.feedingItems());for(var i=0;i<G.length;i++){var H=G[i];if(H.id()===q){var I=H.values();for(var i=0;i<I.length;i++){var a=I[i];if(a.id()===l.id()){I.splice(i,1);break;}}break;}}var J=b.clone(E.type());var K=t.getManifestFeedsMap(J);var M;if(s.isMultipleChart(J)){var N=t.hasRowOrColumn(G);if(N){M=K;}else{var Q=s.toSingleChartType(J);M=t.getManifestFeedsMap(Q);var T=K[t.MultiplierFeedingName];M[t.MultiplierFeedingName]=T;}}else{M=K;if(s.supportMultiChart(J)){var U=s.toMultiChartType(J);var W=t.getManifestFeedsMap(U);var X=t.supportMultiChart(G,W);if(X){var T=t.getManifestFeedsMap(U)[t.MultiplierFeedingName];M[t.MultiplierFeedingName]=T;}}}var Y=E.isMNDVisible();var Z=(l.type()===d.MND);for(var _ in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(_)){var a1=this._dicUIShelf[_];if(a1&&a1.shelf().analysisType!==d.MEASURE){var q;if(_===t.RowsFeedingName||_===t.ColumnsFeedingName){q=t.MultiplierFeedingName;}else{q=_;}var b1=t.canAddValue(G,_,M,Y,Z,q);a1.enableFeeding(b1);}}}if(this._playerFieldShelf){var b1=this.playerField()==null||k.feedId==='playerField';this._playerFieldShelf.enableFeeding(b1);}}};D.prototype._updateShelvesStatus=function(){var a=this._vizModel();if(a){var e=t.cloneFeeds(a.feedingItems());for(var k in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(k)){var l=this._dicUIShelf[k];this._setUiShelfAddIconState(l,a);}}var q=t.hasRowOrColumn(e);if(q){this._CollapseTrellis(false);}if(this._playerFieldShelf){var E=false;if(s.supportAnimation(a.type())){E=this.playerField()==null;}this._playerFieldShelf.enableFeeding(E);}}};D.prototype._validateSize=function(){var a=this.size();this._dom$.height(a.height);this._dom$.width(a.width);};D.prototype._trellisArrowIconClickHandler=function(){this._CollapseTrellis(!this._trellisCollapsed);};D.prototype._updateTrellisSection=function(a){if(!this._trellisArrowIcon$){return;}this._trellisArrowIcon$.removeClass();this._trellisArrowIcon$.addClass(C.COMMON_PREFIX+"UVBSharedSprite");if(a){this._trellisArrowIcon$.addClass(C.FEEDINGPANEL_PREFIX+"collapse-icon");this._trellisContainer$.hide();}else{this._trellisArrowIcon$.addClass(C.FEEDINGPANEL_PREFIX+"expand-icon");this._trellisContainer$.show();}};D.prototype._CollapseTrellis=function(a){if(arguments.length>0){if(this._trellisCollapsed!==a){this._trellisCollapsed=a;this._updateTrellisSection(a);}}else{return this._trellisCollapsed;}};return D;});u('sap/viz/controls/builder/VizBuilder',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/VizControlHost','sap/viz/controls/common/views/feed/FeedingShelfEvent','sap/viz/controls/common/managers/LangManager','sap/viz/controls/builder/VizBuilderConfig','sap/viz/controls/builder/VizBuilderEvent','sap/viz/controls/mapbuilder/MapBuilder','sap/viz/controls/mapbuilder/events/GeoEvent','sap/viz/controls/switchbar/SwitchBar','sap/viz/controls/switchbar/SwitchBarEvent','sap/viz/controls/feeding/FeedingPanel','sap/viz/controls/feeding/FeedingPanelEvent','sap/viz/controls/Version','sap/viz/controls/feeding/FeedingPanelConfig','sap/viz/controls/mapbuilder/MapBuilderConfig','sap/viz/controls/switchbar/SwitchBarConfig'],function($,C,a,F,O,b,c,V,d,L,e,f,M,G,S,g,h,k,l,m,n,o){var p=a.COMMON_PREFIX;var q=function q(r,s){q.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.builder.VizBuilder";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizbuilder_control');this._dom=r;this._dom$=$(this._dom);this._dom$.addClass([a.BUILDER_PREFIX+'area',p+'scrollable',p+'scrollable-y'].join(' '));this._uiConfig=s?s:e.instance();this._vizModel().type(this._uiConfig.defaultVizType);for(var i in this._uiConfig.controls){if(this._uiConfig.controls.hasOwnProperty(i)){var t=this._uiConfig.controls[i];if(t.defaultVizType&&t.defaultVizType!==this._uiConfig.defaultVizType){t.defaultVizType=this._uiConfig.defaultVizType;}}}this._layout=null;this._divContainer=null;this._switchBar=null;this._feedingPanel=null;this._mapBuilder=null;this._switchBarDiv=null;this._feedingPanelDiv=null;this._mapBuilderDiv=null;this._activeFeedingDiv=null;this._trellisHistory={};this._attributeHistory={};this._measureHistory={};this._createChildren();var v=this._vizModel().type()?this._vizModel().type():this._uiConfig.defaultVizType;if(v===this._uiConfig.defaultVizType){this._updateActiveFeedingDiv();}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizbuilder_control');};O.extend(q,V);q.prototype._createChildren=function(){this._layout=$(document.createElement('div')).addClass(a.BUILDER_PREFIX+"view-list");var r=this._uiConfig.controls;var s;var t=true;if(this._uiConfig.header){t=this._uiConfig.header.visible===false?false:true;}var v=this._divContainer=$(document.createElement('div'));v.addClass(a.BUILDER_PREFIX+'switcher-container');v.appendTo(this._layout);var w=r.switchBar?r.switchBar:o.instance();if(w){if(t){var x=$(document.createElement('div'));x.addClass(a.BUILDER_PREFIX+'header');var y=$(document.createElement('span'));y.addClass(a.BUILDER_PREFIX+'header-text').text(L.get('VIZ_BUILDER_CHART'));var z=this._headerValue$=$('<span/>');z.addClass(a.BUILDER_PREFIX+'header-value');y.appendTo(x);z.appendTo(x);x.appendTo(v);}this._switchBarDiv=$(document.createElement('div'));this._switchBar=new S(this._switchBarDiv,w);this._switchBar.size({'width':212});this._switchBar.horizontalGap(15);if(t){this._switchBar.addEventListener(g.VIZ_TYPE_CHANGED,function(I){var J=this._switchBar.selectedTypeObject();z.text(J?J.caption:'');},this);}var D=this._switchBar.vizType();if(t&&D&&D.length>0){z.text(c.getVizTypeObject(D).caption);}this._switchBarDiv.appendTo(v);this._addChild(this._switchBar,['vizType','horizontalGap','verticalGap'],[g.VIZ_TYPE_CHANGED]);}var E=r.feedingPanel?r.feedingPanel:m.instance();if(E){s=E;this._feedingPanelDiv=$(document.createElement('div'));this._feedingPanel=new h(this._feedingPanelDiv,s);this._addChild(this._feedingPanel,['feeds','feed','feedAnalysisObjects'],[F.REQUEST_FEED,F.FEEDS_CHANGED,k.ACTION_CHANGED]);}var H=r.mapBuilder?r.mapBuilder:n.instance();if(H){s=H;s.feedingPanel.useBuildInFeedList=r.feedingPanel.useBuildInFeedList;this._mapBuilderDiv=$(document.createElement('div'));this._mapBuilder=new M(this._mapBuilderDiv,s);this._addChild(this._mapBuilder,['config'],[G.CHANGE_BASEMAP_PROVIDER,G.CHANGE_BASEMAP_TYPE,G.SHOW_LAYER,G.HIDE_LAYER,G.CHANGE_LAYER_VIZTYPE,G.SHOW_LEGEND,G.HIDE_LEGEND,G.CHANGE_VIZ_PROPERITIES,G.ADD_LAYER,G.UPDATE_LAYER_DATA,G.DELETE_LAYER,G.REORDER_LAYER,G.RENAME_LAYER,G.ACTION_CHANGED]);}$(this._layout).appendTo(this._dom);};q.prototype._validateSize=function(){};q.prototype._onVizModelChanged=function(r){if(r.data.vizTypeChanged){this._updateActiveFeedingDiv();if(this._headerValue$){var t=this._vizModel().type();if(t&&t.length>0){t=c.getVizType(t);this._headerValue$.text(c.getVizTypeObject(t).caption);}}}};q.prototype._updateActiveFeedingDiv=function(){var r=this._vizModel();if(r.type()===C.TYPE_GEO_MAP){this._activeFeedingDiv=this._replaceDiv(this._layout,this._activeFeedingDiv,this._mapBuilderDiv);if(this._mapBuilder){this._mapBuilder.reset();}}else{this._activeFeedingDiv=this._replaceDiv(this._layout,this._activeFeedingDiv,this._feedingPanelDiv);}};q.prototype._replaceDiv=function(r,s,t){if(s!==t){if(s){s.detach();}if(t){t.appendTo(r);s=t;}}return s;};q.prototype.analysisObjectsForPicker=function(r){if(arguments.length>0){if(this._feedingPanel){this._feedingPanel.analysisObjectsForPicker.apply(this._feedingPanel,arguments);}if(this._mapBuilder){this._mapBuilder.analysisObjectsForPicker.apply(this._mapBuilder,arguments);}}else{if(this._feedingPanel){return this._feedingPanel.analysisObjectsForPicker.apply(this._feedingPanel);}if(this._mapBuilder){return this._mapBuilder.analysisObjectsForPicker.apply(this._mapBuilder);}}};q.prototype.save=function(){var r={};r['version']=l.VERSION;if(this._switchBar){r['switchBar']=this._switchBar.save();}if(this._feedingPanel){r['feedingPanel']=this._feedingPanel.save();}if(this._mapBuilder){r['mapBuilder']=this._mapBuilder.save();}return r;};q.prototype.load=function(v){if(!v){return;}var r=v["switchBar"];if(r&&this._switchBar){this._switchBar.load(r);}r=v["feedingPanel"];if(r&&this._feedingPanel){this._feedingPanel.load(r);}r=v["mapBuilder"];if(r&&this._mapBuilder){this._mapBuilder.load(r);}};q.prototype.feedingPanel=function(){return this._feedingPanel;};q.prototype.switchBar=function(){return this._switchBar;};q.prototype.mapBuilder=function(){return this._mapBuilder;};return q;});u('sap/viz/controls/common/constants/EventTypeConst',[],function(){var E={};E.VC_CHANGE_VIZ_TYPE="vc-changeVizType";E.PRESS_FILTER_BUTTON="vc-filter";E.PRESS_EXCLUDE_BUTTON="vc-exclude";E.PRESS_DRILLDOWN_BUTTON="vc-drillDown";E.SELECT_SHOW_LEGEND="vc-showLegend";E.SELECT_SHOW_DATALABELS="vc-showDataLabels";E.SELECT_CHANGE_DIRECTION="vc-changeDirection";E.SELECT_CHANGE_STACKING="vc-changeStacking";E.SELECT_INSERT_COMMENT="vc-insertComment";E.SELECT_CHART_EDITOR="vc-chartEditor";E.SHOW_MESSAGE="vc-showMessage";E.CLEAR_MESSAGE="vc-clearMessage";E.VIZ_DEFINITION_CHANGED='vizDefinitionChanged';E.REQUEST_FILTER_VALUES='requestFilterValues';return E;});u('sap/viz/controls/annotation/AnnotationConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var a={};a.instance=function(){return{};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_ANNOTATION,a);return a;});u('sap/viz/controls/annotation/AnnotationEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var a=function(t,b,d){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.AnnotationEvent";};O.extend(a,E);a.COMMENT_CHANGED_EVENT="commentChanged";return a;});u('sap/viz/controls/annotation/views/DialogEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var D=function(t,a,d){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.DialogEvent";};O.extend(D,E);D.OK="OK";D.Cancel="Cancel";return D;});u('sap/viz/controls/annotation/views/ConfirmDialog',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/annotation/views/DialogEvent','jquery'],function(O,U,C,L,D,$){var a=function(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.ConfirmDialog";this._confirmDialog$=null;this._needConfirm=true;this._visible=false;this._createChildren();};O.extend(a,U);a.prototype._createChildren=function(){var _=this;this._confirmDialog$=$(document.createElement('div'));this._confirmDialog$.addClass(C.ANNOTATION_PREFIX+'confirmdialog');var d=$(document.createElement('div'));d.addClass(C.ANNOTATION_PREFIX+'confirmdialog-header');this._confirmDialog$.append(d);var b=$(document.createElement('span'));b.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerleft');d.append(b);var c=$(document.createElement('span'));c.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerleft-label');b.append(c);var e=$(document.createElement('span'));e.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerright');d.append(e);var f=$(document.createElement('a'));f.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerright-close');e.append(f);f.click(function(){_.hide();});var g=$(document.createElement('div'));g.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content');this._confirmDialog$.append(g);var h=$(document.createElement('div'));h.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-up');h.appendTo(g);var k=$(document.createElement('div'));k.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-icon');k.appendTo(h);var l=$(document.createElement('div'));l.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-info');l.text(L.get("VIZ_COMMON_DELETE_COMMENT_MESSAGE"));l.appendTo(h);var m=$(document.createElement('div'));m.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-down');m.appendTo(g);this._checkBoxNeedConfirm$=$(document.createElement("input"));this._checkBoxNeedConfirm$.attr("type","checkbox");this._checkBoxNeedConfirm$.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-checkbox');this._checkBoxNeedConfirm$.appendTo(m);var n=$(document.createElement('div'));n.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-checkboxlabel');n.text(L.get("VIZ_COMMON_DONT_SHOW_MESSAGE"));n.appendTo(m);var o=$(document.createElement('div'));o.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer');this._confirmDialog$.append(o);var p=$(document.createElement('div'));p.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-buttons');o.append(p);var q=$(document.createElement('button'));q.text(L.get("VIZ_COMMON_OK"));q.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-button');q.addClass(C.COMMON_PREFIX+'button');p.append(q);q.click(function(){_.hide();_._needConfirm=!(_._checkBoxNeedConfirm$.prop("checked"));_._dispatchEvent(new D(D.OK,_,_._needConfirm));});var r=$(document.createElement('button'));r.text(L.get("VIZ_COMMON_CANCEL"));r.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-button');r.addClass(C.COMMON_PREFIX+'button');p.append(r);r.click(function(){_.hide();});this._blockLayout$=$(document.createElement('div'));this._blockLayout$.addClass(C.ANNOTATION_PREFIX+'block-layer');};a.prototype.show=function(p){this._visible=true;$(document.body).append(this._blockLayout$);$(document.body).append(this._confirmDialog$);if(p){this.setPos(p);}};a.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach();};a.prototype.setPos=function(p){this._confirmDialog$.css({position:"absolute",left:p.pageX-this._confirmDialog$.width()/2,top:p.pageY-this._confirmDialog$.height()/2});};a.prototype.isVisible=function(){return this._visible;};return a;});u('sap/viz/controls/annotation/models/Comment',['sap/viz/controls/common/managers/LangManager'],function(L){var C=function(d,a,s){this._dimension=d;this._dimension2=a;this._series=s;this._text='';this._createTime=L.get("VIZ_ANNOTATION_COMMENT");};C.prototype.dimension=function(v){if(arguments.length>0){this._dimension=v;return this;}else{return this._dimension;}};C.prototype.dimension2=function(v){if(arguments.length>0){this._dimension2=v;return this;}else{return this._dimension2;}};C.prototype.series=function(v){if(arguments.length>0){this._series=v;return this;}else{return this._series;}};C.prototype.createTime=function(v){if(arguments.length>0){this._createTime=v;return this;}else{return this._createTime;}};C.prototype.text=function(v){if(arguments.length>0){this._text=v;return this;}else{return this._text;}};return C;});u('sap/viz/controls/annotation/views/Comments',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/annotation/views/DialogEvent','sap/viz/controls/annotation/views/ConfirmDialog','sap/viz/controls/annotation/models/Comment'],function($,C,a,O,b,U,V,E,c,D,d,f){var F='#F1AB00';var T=12;var L=4;var M=200;var I=8;var g={width:14,height:16};var h="font-family:Arial;font-size:12px;font-weight:bold;fill:#000000;";var k="font-family:Arial;font-size:12px;font-weight:normal;fill:#000000;";var l=function(){this._commentsMap={};this._commentsPositionMap={};this._vizData=null;this._vizType=null;this._eventHandlers={};this._needConfirm=true;this._currentComment=null;};O.extend(l,c);l.Event_EditComment='Event_EditComment';l.Event_RemoveComment='Event_RemoveComment';l.Event_DragComment='Event_DragComment';l.prototype._showConfirmDialog=function(){this._getConfirmDialog().show({pageX:$(this._parent).offset().left+$(this._parent).width()/2,pageY:$(this._parent).offset().top+$(this._parent).height()/2});};l.prototype._getConfirmDialog=function(){if(!this._confirmDialog){this._confirmDialog=new d();this._confirmDialog.addEventListener(D.OK,this._confirmChangedHandler,this);}return this._confirmDialog;};l.prototype._confirmChangedHandler=function(e){this._needConfirm=e.data;this._onRemoveComment(this._currentComment);};l.prototype.assetFolder=function(e){if(arguments.length>0){this._assetFolder=e;return this;}else{return this._assetFolder;}};l.prototype.setChartInfo=function(e){if(arguments.length>0){this._vizData=e.vizData;this._vizType=e.vizType;return this;}else{return this._vizData;}};l.prototype.feedsChanged=function(){this._commentsPositionMap={};};l.prototype._initDIV=function(){if(this._parent){this._parent.empty();}else{var e=document.createElement("DIV");this._parent=$(e);this._chartHolderDiv=$('div.'+C.PREFIX+'chart-holder')[0];this._parent.appendTo(this._chartHolderDiv).attr('id',"comments-parent");this._parent.attr('style','overflow:hidden;position:absolute;pointer-events:none;left:0px;top:0px;');}this._triangleHolder=null;this._lineHolder=null;};l.prototype.redraw=function(){this._initDIV();var e=b.getVizType(this._vizType);if(!G.supportType[e]||V.hasFakeData(this._vizData)){return;}for(var n in this._commentsMap){if(this._commentsMap.hasOwnProperty(n)){this._drawComment(n);}}};l.prototype.clean=function(){this._initDIV();};l.prototype._getPathInfo=function(e,x){var y=e.dii_a1;var H=e.mi;var J=x._crosstableDataset;var K=J.getAnalysisAxisByIdx(0);var N=null;if(K){N='';K=K.getDimensionLabels();for(var i=0;i<K.length;i++){N+=K[i].getValues()[y];}}else{N=J.getMeasureValuesGroupByIdx(0).getMeasureValues()[y].getId();}var P=J.getAnalysisAxisByIdx(1);var Q=null;if(P){Q='';P=P.getDimensionLabels();for(var n=0;n<P.length;n++){Q+=P[n].getValues()[e.dii_a2];}}var R={dimensionIndex:y,seriesIndex:H,dimension:N,dimension2:Q};R.series=J.getMeasureValuesGroupByIdx(e.mg).getMeasureValues()[H].getId();return R;};l.prototype._findDataPoint=function(e){var n=d3.selectAll('.v-datapoint')[0];var x=e.dimension();var y=e.dimension2();var H=e.series();for(var i=0;i<n.length;i++){var J=n[i].__data__;if(J){var K;if(U.isArray(J.ctx)){K=this._getPathInfo(J.ctx[0].path,this._vizData);if(K.dimension===x&&K.dimension2===y&&K.series==H){return n[i];}}else if(b.getVizType(this._vizType)===a.TYPE_BOXPLOT){for(var j=0;j<J.length;j++){K=this._getPathInfo(J[j].ctx.path,this._vizData);if(K.dimension===x&&K.dimension2===y&&K.series==H){return n[i];}}}else if(J.ctx){K=this._getPathInfo(J.ctx.path,this._vizData);if(K.dimension===x&&K.dimension2===y&&K.series==H){return n[i];}}}}};function m(e){var n=e.__data__;if(n&&n.r&&n.midAngle){var H=n.midAngle();var x=n.r*Math.sin(H);var y=n.r-n.r*Math.cos(H);var J=$(e).parentsUntil('.v-m-plot');if(J.length>0){var K=$(J[J.length-1]).parent()[0];var N=K.getElementsByTagName('rect');var P=N[0].getAttribute('height');var Q=N[0].getAttribute('width');var R=K.getBoundingClientRect();var S=R.left+Q/2;var W=R.top+6+n.r;var X={width:1,height:1,top:W-n.r+y,left:S+x};return X;}else{return e.getBoundingClientRect();}}else{return e.getBoundingClientRect();}}function o(e){var n=e.dimension()+"-"+e.dimension2()+"-"+e.series();n=n.replace(/[^(0-9|A-z)]/g,"_");return n;}function p(e){return e+'-line';}function q(e){return e+'-triangle';}function r(e){var n=e.currentTarget.parentNode.__data;if(e.data&&n){if(e.data._needConfirm){e.data._currentComment=n;e.data._showConfirmDialog();}else{e.data._onRemoveComment(n);}}e.stopPropagation();}function s(e){var n=e.currentTarget.parentNode.__data;if(e.data&&n){e.data._onEditComment(n);}e.stopPropagation();}function t(e){var n=e.target;if(n&&n.className!=='ui-draggable'){var x=$(n).parentsUntil(e.data._parent);if(x&&x.length>0){n=x[x.length-1];}}if(e.data&&n&&n.className==='ui-draggable'){$(n).detach();$(n).appendTo(e.data._parent);}e.stopPropagation();}function v(e,n,x,y,H){var J={x:e.left,y:e.top+e.height/2};var K={x:n.left+n.width/2,y:n.top};var N=J.x-K.x;var P=J.y-K.y;var Q=Math.sqrt(N*N+P*P);var R=Math.asin(P/Q)*180/Math.PI;if(J.x<K.x){R=180-R;}var S='rotate('+R+'deg)';var W="0 0";y.css({'transform':S,'transform-origin':W,'-webkit-transform':S,'-webkit-transform-origin':W,'-ms-transform':S,'-ms-transform-origin':W,'-moz-transform':S,'-moz-transform-origin':W,width:Math.floor(Q)-L+'px',left:(K.x-x.left)+'px',top:K.y-x.top+'px'});S='rotate('+(R+90)+'deg)';W="50% 100%";H.css({'transform':S,'transform-origin':W,'-webkit-transform':S,'-webkit-transform-origin':W,'-ms-transform':S,'-ms-transform-origin':W,'-moz-transform':S,'-moz-transform-origin':W,left:(K.x-x.left-T/2)+'px',top:(K.y-x.top-T)+'px'});}function w(e,n){var x='height:0px;width:0px;margin:0px;padding:0px;';x+='border-top-width:'+e+'px;border-left-width: '+n/2+'px;border-right-width: '+n/2+'px;';x+='border-bottom-width: 0px;border-style: solid;border-color: '+F+' transparent transparent transparent;';return x;}l.prototype._initCommentUI=function(n,x,y){var H=m(n);var J=this._parent[0].getBoundingClientRect();var K=0;var N=0;var P=x.attr('id');if(this._commentsPositionMap.hasOwnProperty(P)&&this._commentsPositionMap[P].hasOwnProperty(this._vizType)){K=this._commentsPositionMap[P][this._vizType].left;N=this._commentsPositionMap[P][this._vizType].top;}else{K=0;N=H.top-J.top-80;var Q=n.__data__;if(Q&&Q.r&&Q.midAngle&&Math.sin(Q.midAngle())<0){K=H.left-Math.max(H.width,40)-J.left-150;}else{K=H.left+Math.max(H.width,40)-J.left;}}var R="pointer-events:auto;";R+="padding:4px;background-color:#FFFFCC;";R+='border-radius:4px;border-width:2px; border-color:'+F+'; border-style:solid;';R+="position:absolute;left: "+K+"px; top:"+N+"px;";R+="width:"+M+"px;";x.attr('style',R);x.bind('mouseenter',function(e){var P=$(e.currentTarget).attr('id');var S=$('div#'+P+' img');S.css('visibility','');var W=$('div#'+P+' div#'+'createTime');if(W){W.css('right','68px');}});x.bind('mouseleave',function(e){var P=$(e.currentTarget).attr('id');var S=$('div#'+P+' img');S.css('visibility','hidden');var W=$('div#'+P+' div#'+'createTime');if(W){W.css('right','18px');}});x.bind('contextmenu',function(e){e.stopPropagation();});if(K+x.outerWidth()>this._parent.innerWidth()){K=this._parent.innerWidth()-x.outerWidth();}if(N+x.outerHeight()>this._parent.innerHeight()){K=this._parent.innerHeight()-x.outerHeight();}x.css({left:K+'px',top:N+'px'});};l.prototype._addCommentUI=function(e,n,x){var y=I;for(var i=0;i<x.length;i++){var H=$(document.createElement("DIV")).appendTo(n).attr('style','position:absolute;padding:'+I+'px;left:0px;right:0px;top:'+y+'px;width:'+M+'px;height:auto;');var J=this._appendItem(H,x[i]);H.css('height',J+'px');y+=J+I;H[0].__data=x[i];}y-=I;n.css('height',y+'px');var K=m(e);var N=this._parent[0].getBoundingClientRect();var P=Number(n.css("left").replace('px',''));var Q=Number(n.css("top").replace('px',''));P=Math.min(Math.max(P,0),N.width-M);Q=Math.min(Math.max(Q,0),N.height-y);n.css({left:P,top:Q});var R=n[0].getBoundingClientRect();n[0].__dataPoint=e;n[0].__parent=this._parent[0];var S=n.attr('id');var W=q(S);var X=$('#'+W);if(X.length===0){X=$(document.createElement("DIV"));if(this._triangleHolder){X.insertAfter(this._triangleHolder);}else{X.insertBefore(n);}this._triangleHolder=X;X.attr('id',W).attr('style','position:absolute;'+w(T,T));}var Y=p(S);var Z=$('#'+Y);if(Z.length===0){Z=$(document.createElement("DIV"));if(this._lineHolder){Z.insertAfter(this._lineHolder);}else{Z.insertBefore(n);}this._lineHolder=Z;Z.attr('id',Y).attr('style','position:absolute;border-left-width:'+L+'px; border-top-width:2px;border-bottom-width:0px;border-right-width:0px;border-color:'+F+' transparent; border-style:solid;width:1px;height:0px;');}v(R,K,N,Z,X);};l.prototype._appendItem=function(e,n){var _=this;var x=null;var y=false;var H=0;var J=$(document.createElement("IMG")).appendTo(e);J.attr('src',this._assetFolder+'/edit.png').attr('style','position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:'+(I*3+g.width)+'px;width:'+g.width+'px;height:'+g.height+'px;visibility:hidden;');J.bind('mousedown',this,s);var K=J[0].getBoundingClientRect();var N=$(document.createElement("IMG")).appendTo(e);N.attr('src',this._assetFolder+'/delete.png').attr('style','position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:'+(I*2)+'px;width:'+g.width+'px;height:'+g.height+'px;visibility:hidden;');N.bind('mousedown',this,r);var P=N[0].getBoundingClientRect();var Q=this._creatorDiv=$(document.createElement("DIV")).appendTo(e);Q.attr('id','createTime');Q.text(n.createTime()).attr('style','position:absolute;cursor:default;line-height:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;left:5px;right:18px;top:0px;'+h);Q.mouseover(function(W){if(Q[0].scrollWidth>Q[0].clientWidth){y=true;var X=setTimeout(function(){if(y){if(!x){x=$(document.createElement('div')).appendTo(e);x.attr('style','position:absolute;border-radius:4px;z-index:100;display:block;background-color:#F2F2F2;border:1px solid #7F7F7F;box-shadow:5px 5px 10px rgba(0,0,0,0.5);-webkit-box-shadow:5px 5px 10px rgba(0,0,0,0.5);-moz-box-shadow:5px 5px 10px rgba(0,0,0,0.5);');var Y=$(document.createElement('span')).appendTo(x);Y.attr('style','border-radius:4px;padding-left:4px;padding-right:4px;display:block;font-size:10px;white-space:nowrap;top:0px;overflow:hidden;');Y.text(n.createTime());}var Z=$(Q).offset();x.offset({'left':Z.left-5,'top':Z.top-10});}},500);}});Q.mouseout(function(W){if(Q[0].scrollWidth>Q[0].clientWidth){y=false;if(x){x.remove();x=null;}}});var R=Q[0].getBoundingClientRect();H+=Math.max(K.height,R.height);var S=$(document.createElement("DIV"));S[0].innerHTML=n.text();S.attr('style','position:absolute;pointer-events:none;line-height:normal;word-wrap:break-word;overflow:hidden;top:'+H+'px;width:'+M+'px;'+k).appendTo(e);H+=S[0].getBoundingClientRect().height;return H;};l.prototype._removeCommentUI=function(e){var n=p(e);var x=q(e);if(this._triangleHolder&&this._triangleHolder.attr('id')===x){this._triangleHolder=null;}if(this._lineHolder&&this._lineHolder.attr('id')===n){this._lineHolder=null;}$('div#'+e).remove();$('div#'+n).remove();$('div#'+x).remove();var y=this._parent.children();if(this._triangleHolder===null&&y.length>=3){this._triangleHolder=$(y[y.length/3-1]);}if(this._lineHolder===null&&y.length>=3){this._lineHolder=$(y[y.length/3]);}};function z(e){var n=$(e.target);var _=e.data;if(e.target.__dataPoint&&e.target.__parent){var x=n[0].getBoundingClientRect();var y=m(n[0].__dataPoint);var H=n[0].__parent.getBoundingClientRect();var J=n.attr('id');var K=$('#'+p(J));var N=$('#'+q(J));v(x,y,H,K,N);if(!_._commentsPositionMap.hasOwnProperty(J)){_._commentsPositionMap[J]={};}_._commentsPositionMap[J][_._vizType]={left:Number(n.css("left").replace('px','')),top:Number(n.css("top").replace('px',''))};e.stopPropagation();_._dispatchEvent(new E(l.Event_DragComment,_,_._commentsMap[J]));}}l.prototype._drawComment=function(n){var _=this;var x=this._commentsMap[n];if(!x||x.length===0){this._removeCommentUI(n);return;}var y=this._findDataPoint(x[0]);if(!y){return;}var H=$('div#'+n);if(H.length===0){H=$(document.createElement("DIV"));H.appendTo(this._parent).attr('id',n);this._initCommentUI(y,H);}else{H.empty();}this._addCommentUI(y,H,x);H.draggable({containment:"parent",start:function(e,J){e.target.__lastPosition={x:e.clientX,y:e.clientY};},stop:function(e,J){e.data=_;z(e);},drag:function(e,J){e.data=_;z(e);}});H.bind('click',this,t);};l.prototype._onEditComment=function(e){if(e==null){return;}var n=o(e);var x=this._commentsMap[n];if(x==null){return;}this._dispatchEvent(new E(l.Event_EditComment,this,e));};l.prototype._onRemoveComment=function(e){if(e==null){return;}var n=o(e);var x=this._commentsMap[n];if(x==null){return;}for(var i=0;i<x.length;i++){if(x[i]===e){x.splice(i,1);break;}}this._drawComment(n);this._dispatchEvent(new E(l.Event_RemoveComment,this,e));};l.prototype.createComment=function(e){if(e.length===0){return;}var n=e[e.length-1].ctx[0];var x=this._getPathInfo(n,this._vizData);var y=new f(x.dimension,x.dimension2,x.series);y.text('');return y;};l.prototype.addComment=function(e){if(e==null){return;}var n=o(e);if(this._commentsMap[n]==null){this._commentsMap[n]=[];}this._commentsMap[n].push(e);this._drawComment(n);};l.prototype.updateComment=function(e){if(e==null){return;}var n=o(e);if(!this._commentsMap[n]){return;}this._drawComment(n);};l.prototype.size=function(e){if(e){$('div#comments-parent').css(e);if(this._getConfirmDialog().isVisible()){this._getConfirmDialog().setPos({pageX:$(this._parent).offset().left+$(this._parent).width()/2,pageY:$(this._parent).offset().top+$(this._parent).height()/2});}}};l.prototype.json2CommentsMap=function(e){for(var n in e){if(e.hasOwnProperty(n)){if(this._commentsMap[n]==null){this._commentsMap[n]=[];}var x=e[n];for(var i=0;i<x.length;i++){var y=x[i];var H=new f(y.dimension,y.dimension2,y.series);H.createTime(y.createTime);H.text(y.text);this._commentsMap[n].push(H);}}}this._needConfirm=e["needConfirm"];this._commentsPositionMap=e["commentsPositionMap"];};l.prototype.commentsMap2Json=function(){var e={};for(var n in this._commentsMap){if(this._commentsMap.hasOwnProperty(n)){var x=this._commentsMap[n];e[n]=[];for(var i=0;i<x.length;i++){var y=x[i];e[n].push({"dimension":y.dimension(),"dimension2":y.dimension2(),"series":y.series(),"createTime":y.createTime(),"text":y.text()});}}}e["needConfirm"]=this._needConfirm;e["commentsPositionMap"]=this._commentsPositionMap;return e;};var G={"name":"comment","text":"VIZ_CONTEXTMENU_INSERT_COMMENT","icon":{"show":"/contextmenu/annotation.png"},"supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_column":true,"viz/stacked_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_bar":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};return l;});u('sap/viz/controls/annotation/views/CommentEditorView',['sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/annotation/views/DialogEvent','jquery'],function(L,O,U,a,C,D,$){var M=140;var l="";var t=false;var b=function(d){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.CommentEditorView";this._div=d;this._comment="";this._visible=false;this._oRichTextDialog=null;this._createChildren();};O.extend(b,a);b.WIDTH=497;b.HEIGHT=213;b.prototype._createChildren=function(){var _=this;this._oRichTextDialog=document.createElement('div');this._oRichTextDialog.id="divRichTextDialog";$(this._oRichTextDialog).addClass(C.ANNOTATION_PREFIX+'richtextdialog');$(document.body).append(this._oRichTextDialog);this.hide();var d=document.createElement('div');d.id="RichTextDialogHeader";$(d).addClass(C.ANNOTATION_PREFIX+'richtextdialog-header');$(this._oRichTextDialog).append(d);var c=document.createElement('span');$(c).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerleft');$(d).append(c);var f=document.createElement('span');f.id="RichTextDialogHeaderLabel";$(f).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerleft-label');$(f).text(L.get("VIZ_ANNOTATION_COMMENT"));$(c).append(f);var g=document.createElement('span');$(g).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerright');$(d).append(g);var h=document.createElement('a');h.id="RichTextDialogHeaderClose";$(h).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerright-close');$(g).append(h);$(h).click(function(){_.hide();});var k=document.createElement('div');k.id="RichTextDialogContent";$(k).addClass(C.ANNOTATION_PREFIX+'richtextdialog-content');$(this._oRichTextDialog).append(k);var m=document.createElement('textarea');m.id="RichTextDialogContentTextArea";$(m).addClass('mceEditor');$(k).append(m);var n=document.createElement('div');n.id="RichTextDialogFooter";$(n).addClass(C.ANNOTATION_PREFIX+'richtextdialog-footer');$(this._oRichTextDialog).append(n);var o=document.createElement('div');$(o).addClass(C.ANNOTATION_PREFIX+'richtextdialog-footer-buttons');$(n).append(o);var p=document.createElement('button');p.id="RichTextDialogOKButton";$(p).text(L.get("VIZ_COMMON_OK"));$(p).addClass(C.ANNOTATION_PREFIX+'button');$(p).addClass(C.COMMON_PREFIX+'button');$(o).append(p);$(p).click(function(){_.hide();_._comment=tinymce.activeEditor.getContent();_._dispatchEvent(new D(D.OK,_,{userData:_._userData,comment:_._comment}));});var q=document.createElement('button');q.id="RichTextDialogCancelButton";$(q).text(L.get("VIZ_COMMON_CANCEL"));$(q).addClass(C.ANNOTATION_PREFIX+'button');$(q).addClass(C.COMMON_PREFIX+'button');$(o).append(q);$(q).click(function(){_.hide();});if(!t){t=true;tinymce.init({theme:"advanced",mode:"textareas",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,forecolor,backcolor,|,justifyleft,justifycenter,justifyright,justifyfull,|,fontselect,fontsizeselect",theme_advanced_path:false,theme_advanced_font_sizes:"8px,9px,10px,11px,12px,14px,16px,18px,20px,22px,24px,26px,28px,36px,48px,72px",theme_advanced_statusbar_location:"none",editor_selector:"mceEditor",setup:function(r){r.onEvent.add(function(r,e){var s=r.getContent({format:'text'});if(s.length>M){r.setContent(l);r.selection.select(r.getBody(),true);r.selection.collapse(false);}else{l=r.getContent();}});}});}this._blockLayout=document.createElement('div');this._blockLayout.id="blockLayout";$(this._blockLayout).addClass(C.ANNOTATION_PREFIX+'block-layer');};b.prototype.show=function(o){if(o){if(o.hasOwnProperty("userData")){this._userData=o.userData;}if(o.hasOwnProperty("comment")&&U.isString(o.comment)){this._comment=o.comment;l=o.comment;if(tinymce.activeEditor){tinymce.activeEditor.setContent(this._comment);}}if(o.hasOwnProperty("position")){this.setPos(o.position);}}this._visible=true;$(document.body).append(this._blockLayout);$(this._oRichTextDialog).show();};b.prototype.hide=function(){this._visible=false;$(this._blockLayout).detach();$(this._oRichTextDialog).hide();};b.prototype.setPos=function(p){$(this._oRichTextDialog).css({position:"absolute",left:p.pageX-b.WIDTH/2,top:p.pageY-b.HEIGHT/2});};b.prototype.isVisible=function(){return this._visible;};return b;});u('sap/viz/controls/annotation/Annotation',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/annotation/AnnotationEvent','sap/viz/controls/annotation/views/Comments','sap/viz/controls/annotation/views/DialogEvent','sap/viz/controls/annotation/views/CommentEditorView'],function($,V,O,G,E,a,F,b,c,d,C,D,f){var g=function(e,h){g.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.Annotation";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_annotation_control');this._div=e;this._uiConfig=h?h:c.instance();this._popupLayer=e;this._commentEditor=null;this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_annotation_control');};O.extend(g,V);g.prototype._createChildren=function(){this._comments=new C();var e=this._uiConfig.commentsAssetFolderPath;this._comments.assetFolder(e?e:G.defaultAssetsRoot()+'/controls/frame/assets');this._comments.addEventListener(C.Event_EditComment,this._editCommentHandler,this);this._comments.addEventListener(C.Event_RemoveComment,this._removeCommentHandler,this);this._comments.addEventListener(C.Event_DragComment,this._dragCommentHandler,this);};g.prototype._getCommentEditor=function(){if(!this._commentEditor){var p=this._popupLayer;if(p){this._commentEditor=new f($(p));this._commentEditor.addEventListener(D.OK,this._commentChangedHandler,this);}}return this._commentEditor;};g.prototype._editCommentHandler=function(e){var h=e.data;var k=this._getCommentEditor();k.show({userData:{isNew:false,comment:h},comment:h.text(),position:{pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2}});};g.prototype._removeCommentHandler=function(e){var h=e.data;this._dispatchEvent(new a(d.COMMENT_CHANGED_EVENT,this,h));};g.prototype._dragCommentHandler=function(e){var h=e.data;this._dispatchEvent(new a(d.COMMENT_CHANGED_EVENT,this,h));};g.prototype._commentChangedHandler=function(e){var h=e.data.userData.isNew;var k=e.data.userData.comment;var t=e.data.comment;k.createTime(new Date().toLocaleString());k.text(t);if(h){this._comments.addComment(k);}else{this._comments.updateComment(k);}var l={commentChanged:true};this._dispatchEvent(new a(E.VIZ_DEFINITION_CHANGED,this,l));this._dispatchEvent(new a(d.COMMENT_CHANGED_EVENT,this,k));};g.prototype.popupLayer=function(p){if(arguments.length>0){this._popupLayer=p;return this;}else{return this._popupLayer;}};g.prototype.validateSize=function(w,h){if(this._comments){this._comments.size({width:w,height:h});}if(this._commentEditor&&this._commentEditor.isVisible()){this._commentEditor.setPos({pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2});}};g.prototype.destroy=function(){if(this._commentEditor){this._commentEditor.removeAllEventListeners();this._commentEditor=null;}if(this._popupLayer){this._popupLayer=null;}$(this._div).remove();};g.prototype.addComment=function(s){var e=this._comments.createComment(s);if(e){var h=this._getCommentEditor();h.show({userData:{isNew:true,comment:e},comment:'',position:{pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2}});}};g.prototype.setChartInfo=function(v){this._comments.setChartInfo(v);};g.prototype.redraw=function(){this._comments.redraw();};g.prototype.clean=function(){this._comments.clean();};g.prototype.feedsChanged=function(){this._comments.feedsChanged();};g.prototype.save=function(){return this._comments.commentsMap2Json();};g.prototype.load=function(v){this._comments.json2CommentsMap(v);};return g;});u('sap/viz/controls/annotationcontrol/AnnotationControlConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var a={};a.instance=function(){return{"allowDataPointValueChange":false,"visualStrategies":{"indicator":{"count":{"disabledRules":["SAME_ORIGINAL_VALUE"]}}}};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_ANNOTATIONCONTROL,a);return a;});u('sap/viz/controls/annotationcontrol/AnnotationControlEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var a=function(t,b,d){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotationcontrol.AnnotationControlEvent";};O.extend(a,E);a.ANNOTATION_SELECTED_EVENT="annotationSelected";a.ANNOTATION_LAYOUTED_EVENT="annotationLayouted";return a;});u('sap/viz/controls/annotationcontrol/AnnotationItem',[],function(){var a=function(b,t,d,s,c){this.__className="sap.viz.controls.annotationcontrol.AnnotationItem";this._id=b;this._type=t;this._dataContext=d;this._style=s;this._contents=c;};a.prototype.id=function(v){if(arguments.length>0){this._id=v;}else{return this._id;}};a.prototype.type=function(v){if(arguments.length>0){this._type=v;}else{return this._type;}};a.prototype.dataContext=function(v){if(arguments.length>0){this._dataContext=v;}else{return this._dataContext;}};a.prototype.style=function(v){if(arguments.length>0){this._style=v;}else{return this._style;}};a.prototype.contents=function(v){if(arguments.length>0){this._contents=v;}else{return this._contents;}};return a;});u('sap/viz/controls/annotationcontrol/Layouter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event'],function(O,U,E){var L=function(){this.__className="sap.viz.controls.annotationcontrol.Layouter";};return L;});u('sap/viz/controls/annotationcontrol/AnnotationControl',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/annotationcontrol/AnnotationControlEvent','sap/viz/controls/annotationcontrol/AnnotationItem','sap/viz/controls/annotationcontrol/Layouter',],function($,V,O,a,b,c,L){var d=function(e,f){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotationcontrol.AnnotationControl";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_AnnotationControl_control');this._div=e;this._uiConfig=f?f:a.instance();this._annotationItems=[];this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_AnnotationControl_control');};O.extend(d,V);d.prototype._createChildren=function(){this._layouter=new L();};d.prototype.annotationItems=function(v){if(arguments.length>0){this._annotationItems=v;}else{return this._annotationItems;}};d.prototype.showAnnotations=function(){};d.prototype.hideAnnotations=function(){};d.prototype.invalidAnnotations=function(){return[];};d.prototype.getAnnotationPosition=function(e){if(!e||e.length===0){return[];}var f=[];for(var i=0;i<e.length;++i){f[i]=e[i].dataContext().context;}return this._vizProxy().getDataPointsPosition(f);};d.prototype.save=function(){return{};};d.prototype.load=function(v){};return d;});u('sap/viz/controls/chart/ChartConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};C.instance=function(){return{'enableTrellis':true,'enableMorphing':true,"useBuiltInPropertyZoneInteraction":false,"useDefaultChartSizeForTrellis":false,"defaultLabelFormatString":[['u']],"defaultProperties":{"title":{"visible":true},"tooltip":{"visible":true},"dataLabel":{"visible":false},"plotArea":{"animation":{"dataLoading":false,"dataUpdating":false,"resizing":false}},"legend":{"visible":true}},"specificProperties":{"bar":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true}},"background":{"border":{"left":{"visible":false},"right":{"visible":false},"top":{"visible":false},"bottom":{"visible":false}}}},"column":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"stacked_bar":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true}}},"stacked_column":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"dual_bar":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"xAxis2":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true}}},"dual_column":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis2":{"title":{"visible":true},"gridline":{"visible":false}}},"3d_column":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true}},"zAxis":{"title":{"visible":true}}},"line":{"plotArea":{"marker":{"shape":"circle","size":6,"visible":true}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"area":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"combination":{"plotArea":{"line":{"marker":{"shape":"circle","size":6,"visible":true}}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"dual_line":{"plotArea":{"marker":{"shape":"circle","size":6,"visible":true}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis2":{"title":{"visible":true},"gridline":{"visible":false}}},"dual_combination":{"plotArea":{"line":{"marker":{"shape":"circle","size":6,"visible":true}}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis2":{"title":{"visible":true},"gridline":{"visible":false}}},"pie":{},"donut":{},"pie_with_depth":{},"geobubble":{"plotArea":{"showNegativeValues":false},"sizeLegend":{"visible":true},"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"choropleth":{"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"geopie":{"sizeLegend":{"visible":true},"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"scatter":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"bubble":{"plotArea":{"showNegativeValues":false},"sizeLegend":{"visible":true},"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"scatter_matrix":{"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"heatmap":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true}}},"treemap":{},"number":{},"boxplot":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},"network":{},"radar":{"plotArea":{"marker":{"size":6,},"valueAxis":{"title":{"visible":true}},"polarAxis":{"title":{"visible":true}}}},"tagcloud":{},"tree":{},"waterfall":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}},}};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CHART,C);return C;});u('sap/viz/controls/chart/ChartPreHandler',['sap/viz/controls/common/utils/FakeDataUtils','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager'],function(F,I,a,b,c,d,e,L){var C=function(f){this._useInfoChart=f?f.useInfoChart===true:false;};C._toInfoChartOptions=function(o,f){if(I.isInfoChart(o.type)){if(o.feeds&&o.data){var r=o.data.data();C._updateFlatTableDataset(o.feeds,r);o.data=new sap.viz.api.data.FlatTableDataset(r);}return o;}if(!f){return o;}var g=I.getInfoType(o.type);if(g){var h={};for(var p in o){if(o.hasOwnProperty(p)){h[p]=o[p];}}h.type=g;if(o.data){var k=o.data;var l=o.feeds;if(l){var m=JSON.parse(JSON.stringify(k.data()));C._updateCrossTabDataSet(o.type,l,m);k=new sap.viz.api.data.CrosstableDataset();k.data(m);}h.data=I.buildInfoDataset(k);}h.properties=I.buildInfoProperties(o.type,o.properties);return h;}else{return o}};C._updateFlatTableDataset=function(f,r){if(!f||f.length===0){return;}if(!r||!r.metadata||!r.metadata.fields||r.metadata.fields.length===0){return;}var n={};for(var i=0;i<f.length;i++){var v=f[i].values();if(!v||v.length===0){continue;}for(var g=0;g<v.length;g++){var h=v[g];if(h.type()===b.MND){continue;}else if(h.type()===b.HIERARCHY){var l=h.hierarchyLevels();for(var k=0;k<l.length;k++){var m=l[k];if(n.hasOwnProperty(m.name())){return;}n[m.name()]=m.analysis().id();if(m.selected()){break;}}}else{if(n.hasOwnProperty(h.name())){return;}n[h.name()]=h.id();}}}var o=r.metadata.fields;for(var p=0;p<o.length;p++){var q=o[p];if(q.name===q.id&&n.hasOwnProperty(q.name)){q.id=n[q.name];}}};C._updateCrossTabDataSet=function(v,f,r){if(!r){return;}var g=F.buildFakeData(v,f,JSON.parse(JSON.stringify(r)));var h=g.feeding;if(!h||h.length===0){return;}for(var i=0;i<h.length;i++){var k=h[i];var l=e.getFeed(f,k.feedId);var m=k.binding;if(!l||!m||m.length===0){continue;}var o=l.values();if(!o||o.length===0){continue;}var p=null;for(var n=0;n<m.length;n++){var q=m[n];var s=q.index;if(!q||!r[q.type]){continue;}p=r[q.type][s-1];if(p&&p.data){p=p.data;break;}}if(!p){continue;}C._updateDataID(p,o);}};C._updateDataID=function(f,g){var h=0;for(var i=0;i<g.length;i++){var v=g[i];if(v.type()===b.MND){continue;}else if(v.type()===b.HIERARCHY){var l=v.hierarchyLevels();for(var k=0;k<l.length;k++){var m=l[k];if(f[h]&&f[h].name===m.name()){f[h].id=m.id();h++;}if(m.selected()){break;}}}else{if(f[h]&&f[h].name===v.name()){f[h].id=v.id();h++;}}}};C.prototype.preCreateViz=function(o){o=C._toInfoChartOptions(o,this._useInfoChart);if(o.properties){o.properties.title=o.properties.title||{};o.properties.title.text=o.properties.title.text||L.get('IDS_DEFAULTCHARTTITLE');}return o;};C.prototype.preVizUpdate=function(o){o=C._toInfoChartOptions(o,this._useInfoChart);return o;};C._toInfoFeeding=function(t,f){var n=null;var g=false;if(e.hasMND(f)||(e.countAnalyses(f,b.MEASURE)===0)){n=f;}else{var v=I.getVizType(t);n=c.directFeeding(f,v,[a.genMND()]);g=true;}return I.buildInfoFeeding(n,g);};C.prototype.preLoadChart=function(f){var t=f.type;var g=d.fromJSON(f["feedingItems"]);if(I.isInfoChart(t)){if(f.vizInstance&&f.vizInstance.data&&f.vizInstance.data.val){C._updateFlatTableDataset(g,f.vizInstance.data.val);}return f;}if(!this._useInfoChart){return f;}var h=I.getInfoType(t);if(!h){return f;}f.type=h;if(f.vizInstance){f.vizInstance.type=h;f.vizInstance.properties=I.buildInfoProperties(t,f.vizInstance.properties);var r=f.vizInstance.data;if(r&&r.val&&r.type==="Crosstable"){C._updateCrossTabDataSet(t,g,r.val);var k=new sap.viz.api.data.CrosstableDataset();k.data(r.val);var l=I.buildInfoDataset(k);r.type="FlatTable";r.val=l.data();}f.vizInstance.feeding=C._toInfoFeeding(h,g);}return f;};return C;});u('sap/viz/controls/common/constants/MapProviderConst',[],function(){var M={};M.ESRI="ESRI";M.CVOM="CVOM";M.NAVTEQ="NAVTEQ";return M;});u('sap/viz/controls/chart/views/AxisSizeAdjustHelper',[],function(){var M="v-m-main";var a=function(b,m,o){if(!v.isAxis(m)||!b){return null;}var f=b.feedingZone();var c;f.forEach(function(e){if(e.name===m){c=e.bound[0];}});var d=b._usrOptions.container.querySelector("."+M).querySelector(".v-bound").getBoundingClientRect();var g,h;if(v.isXAxis(m)){g=d.height;h=c[0][1]-c[2][1];}else{g=d.width;h=c[0][0]-c[2][0];}g=Math.abs(g);h=Math.abs(h);if(g!==0){o=parseFloat(o);if(!isNaN(o)){h+=o;}var p={};p[m]={maxSizeRatio:Math.max(0,h/g)};return p;}return null;};var v={xAxisCandidates:["xAxis","xAxis2"],yAxisCandidates:["yAxis","yAxis2"],isXAxis:function(k){return this.xAxisCandidates.indexOf(k)>-1;},isYAxis:function(k){return this.yAxisCandidates.indexOf(k)>-1;},isAxis:function(k){return this.isXAxis(k)||this.isYAxis(k);}};return a;});u('sap/viz/controls/chart/views/AxisSplitter',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function($,O,V,C,E,a){var b=function(c,p,d){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.AxisSplitter";this._container=c;this._propertiesProvider=p;this._propertyZoneProvider=d;this._createChildren();};O.extend(b,a);b.AxisSplitChanged="AxisSplitChanged";b.prototype._createChildren=function(){this._div$=$(document.createElement("DIV"));this._resizeHelper$=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-resizehelper');this._mask$=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-resizehelper-mask');this._axis$=this._createAxis();this._axis2$=this._createAxis();this._div$.append(this._axis$).append(this._axis2$);this._div$.appendTo(this._container);};b.prototype._updateResizeHelperBound=function(c){var w=c[1][0]-c[0][0];var h=c[2][1]-c[0][1];this._resizeHelper$.css({left:c[0][0],top:c[0][1],width:w,height:h});this._resizeHelper$.appendTo(this._container);};b.prototype._resizeHelper=function(o,c){var p=this._resizeHelper$.position();if(c){this._resizeHelper$.css({top:p.top+o,height:this._resizeHelper$.height()-o});}else{this._resizeHelper$.css({width:this._resizeHelper$.width()+o});}};b.prototype._createAxis=function(){var c=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-axis');var d=false;var s,f;var _=this;var m=function(e){var o=d?(e.clientY-f):(e.clientX-f);var p=c.position();if(d){o=Math.max(-p.top,o);o=Math.min(c.data("bottom")-p.top,o);var t=p.top+o;c.css({top:t});}else{o=Math.max(-(p.left-c.data("left")),o);o=Math.min($(_._container).width()-p.left-6,o);var l=p.left+o;c.css({left:l});}f+=o;_._resizeHelper$.css("cursor",c.css("cursor"));_._resizeHelper(o,d);e.stopPropagation();};var g=function(e){_._mask$.unbind("mousemove",m);_._mask$.unbind("mouseup",g);_._mask$.unbind("mouseout",g);_._mask$.detach();_._resizeHelper$.detach();var h=d?e.clientY:e.clientX;var k=c.data("axis").name;var o=s-h;o=d?o:-o;_._axisMoved(k,o);};c.mousedown(function(e){_._mask$.css("cursor",c.css("cursor"));_._mask$.appendTo(document.body);d=c.data("isHorizontal");s=f=d?e.clientY:e.clientX;_._updateResizeHelperBound(c.data("axis").bound[0]);_._mask$.mousemove(m);_._mask$.mouseup(g);_._mask$.mouseout(g);});return c;};b.prototype._axisMoved=function(c,o){var d={axisName:c,offset:o};this._dispatchEvent(new E(b.AxisSplitChanged,this,d));};b.prototype._getAxis=function(){var z=this._propertyZoneProvider();var r=[];if(!z||z.length==0){return r;}for(var i=0;i<z.length;++i){for(var n=0;n<this._categoryAxis.length;++n){if(z[i].name===this._categoryAxis[n]){r.push(z[i]);}}}return r;};b.prototype._layoutAxis=function(c,d){var e=true;if(d.name==="yAxis"||d.name==="yAxis2"){e=false;}c.data("isHorizontal",e);c.data("axis",d);if(e){var w=d.bound[0][1][0]-d.bound[0][0][0];c.data("bottom",d.bound[0][2][1]);c.css({left:d.bound[0][0][0],top:d.bound[0][1][1],width:w,height:6,"margin-top":-3,"margin-left":0,cursor:"n-resize"});}else{var h=d.bound[0][2][1]-d.bound[0][0][1];c.data("left",d.bound[0][0][0]);c.css({left:d.bound[0][1][0],top:d.bound[0][0][1],height:h,width:6,"margin-top":0,"margin-left":-3,cursor:"e-resize"});}};b.prototype._layout=function(){var c=this._getAxis();if(!c||c.length===0){return;}this._layoutAxis(this._axis$,c[0]);if(c[1]){this._axis2$.css({'visibility':""});this._layoutAxis(this._axis2$,c[1]);}else{this._axis2$.css({'visibility':"hidden"});}};b.prototype.reset=function(){this._div$.css({'visibility':'hidden'});};b.prototype.init=function(t){this._categoryAxis=V.getCategoryAxis(t);if(!this._categoryAxis||this._categoryAxis.length==0){this.reset();return;}this._layout();this._div$.css({'visibility':"visible"});};b.prototype.deactive=function(){this._div$.css({'display':"none"});};b.prototype.active=function(){this._div$.css({'display':"block"});};return b;});u('sap/viz/controls/chart/views/ChartEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ChartEvent";};O.extend(C,E);C.CHANGED_SELECTED_DATA="changeSelectedData";C.TRIGGER_CVOM_EVENT="triggerCVOMEvent";C.CHART_CHANGING="ChartChanging";C.CHART_CHANGED="ChartChanged";C.CVOM_INITIALIZED="CVOMChartInitialized";C.CLICK_FILTER_BUTTON="clickFilterButton";C.CLICK_EXCLUDE_BUTTON="clickExcludeButton";C.CLICK_DRILLDOWN_BUTTON="clickDrillDownButton";C.CHANGE_FEEDING="changeFeeding";C.ANALYSIS_DROPPED="analysisDropped";C.TITLE_CHANGED="TitleChanged";C.VIZTYPE_CHANGED="vizTypeChanged";C.VIZ_VIEW_CHANGED='vizViewChanged';C.SELECT_PROPERTY_ZONE="selectPropertyZone";C.PROPERTY_ZONES_CHANGED='propertyZonesChanged';C.ESRI_CUSTOMIZED_SERVICE_CHANGED='esriCustomizedServiceChanged';return C;});u('sap/viz/controls/chart/views/DataPointFinder',['jquery','sap/viz/controls/common/utils/Utils'],function($,U){var D={};D.findDataPointsPosition=function(d){var r=[];if(!d||d.length===0){return r;}for(var i=0;i<d.length;i++){var a=D._findDataPointUI(d[i]);if(a){r[i]=a.getBoundingClientRect();}}return r;};D._findDataPointUI=function(d){var a=d3.selectAll('.v-datapoint')[0];for(var i=0;i<a.length;i++){var b=a[i].__data__;if(!b){continue;}var c;if(U.isArray(b.ctx)){c=b.ctx[0];}else{c=b.ctx;}if(c.path==d.ctx[0]){return a[i];}}return null;};return D;});u('sap/viz/controls/chart/views/DropZone',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/helpers/Rectangle'],function($,C,F,O,a,E,b,c,d,D,f,g,R){var h=function(t,z,k){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=z;this._feedValidator=k;this._enterDrop=false;this._dragActionArray=[];var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=$(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr('style',s);var l=this;this._dom.droppable({accept:$.proxy(function(e){return this._isTriggerAllowed(e)===true;},this),activate:function(e,m){l.enterDrop.apply(l,[e,m]);},deactivate:function(e,m){a.defer(function(){l.exitDrop.apply(l,[e,m]);});}});};O.extend(h,b);h.DROP_ITEM_EVENT='DROP_ITEM_EVENT';var _=8;h.prototype._match=function(z,e){var t=e.type();if(t){t=t.toLowerCase();}var k=e.dataType();if(k){k=k.toLowerCase();}var l=z.feedDef;var m=l[0].id===F.geoFeeds.id?d.GEOGRAPHY:l[0].type;if(l.length===1&&F.feedCompatible(m,t,k)){return true;}for(var i=0;i<l.length;i++){m=l[i].id===F.geoFeeds.id?d.GEOGRAPHY:l[i].type;if(F.feedCompatible(m,t,k)&&l[i].id!==F.MultiplierFeedingName){return true;}}return false;};h.prototype._onDragOver=function(e,k){if(!this._enterDrop){return;}var z=e.target.__zone;var l=e.target.__areaIndex;var t=D.instance().getAnalysisToken(k.helper);if(!z){t.currentAction(f.DENY);return;}this._hightlight(z,l);if(this._acceptable(z,t.analysisObject)){t.dropTarget(e.target);t.currentAction(f.ACCEPT);}else{t.currentAction(f.DENY);}for(var m in this._dragActionArray){if(this._dragActionArray[m].zoneName===z.name){this._dragActionArray.splice(m,1);break;}}this._dragActionArray.push({"zoneName":z.name,"action":t.currentAction()});};h.prototype._acceptable=function(z,e){var m=this._match(z,e);if(!m){return false;}var k=false;var l=z.feedDef;for(var i=0;i<l.length;i++){if(l[i].id!=="r_subtotals"){k=k||this._feedValidator(l[i],e,z.name);}}return m&&k;};h.prototype._onDragOut=function(e,k){if(!this._enterDrop){return;}var z=e.target.__zone;var l=e.target.__areaIndex;if(z){this._unHightlight(z,l);}var t=D.instance().getAnalysisToken(k.helper);if(t.currentAction()===f.ACCEPT&&t.dropTarget()===e.target){t.currentAction(f.DENY);t.dropTarget(null);}for(var m in this._dragActionArray){if(this._dragActionArray[m].zoneName===z.name){this._dragActionArray.splice(m,1);break;}}var n=this._dragActionArray.length;if(n>0){t.currentAction(this._dragActionArray[n-1].action);}};h.prototype._onDragDrop=function(e,k){var z=e.target.__zone;var t=D.instance().getAnalysisToken(k.helper);if(!z||!t){return;}var l=this._dragActionArray.length;if(l>0){var m=this._dragActionArray[l-1];if(m.zoneName!==z.name){return;}}var n=R.parseDOM($(this._targetDiv));var p=new R(e.pageX,e.pageY,0,0);if(!n.contains(p)){return;}var o=t.analysisObject;if(this._acceptable(z,o)){t.currentAction(f.ACCEPT);this._dispatchEvent(new E(h.DROP_ITEM_EVENT,this,{'zone':z,'analysisObject':o}));}else{t.currentAction(f.DENY);}t.dropTarget(this._dom);};h.prototype._isTriggerAllowed=function(e){var k=e.hasClass(D.DRAGGABLE_CLASS_ANALYSIS);k=k&&!e.hasClass(C.FEEDINGSHELF_PREFIX+'card');return k;};h.prototype._createDiv=function(p,k,t,r){var l=$(document.createElement("DIV"));var m=k[0][0],n=k[0][1],w=k[2][0]-k[0][0],o=k[2][1]-k[0][1];var s="visibility:hidden;left:"+m+"px;top:"+n+"px;width:"+w+"px;height:"+o+"px;";var q=this;l.attr('style',s).droppable({tolerance:'pointer',accept:$.proxy(function(e){return this._isTriggerAllowed(e)===true;},this),drop:function(e,z){q._onDragDrop.apply(q,[e,z]);},over:function(e,z){q._onDragOver.apply(q,[e,z]);},out:function(e,z){q._onDragOut.apply(q,[e,z]);}});l.addClass(C.CHART_PREFIX+'drop-zone').appendTo(p);if(t&&t.length>0){s="position:absolute;left:0px;top: 0px;";var v=$(document.createElement("DIV")).attr('style',s).text(t).appendTo(l);var x=v[0].getBoundingClientRect();var y=null;if(r){y="translate("+(w-x.width)/2+"px,"+((x.width-x.height)/2+_)+"px) rotate(-90deg);";}else{y="translate("+_+"px, "+(o-x.height)/2+"px);";}s+="transform: "+y;s+="-webkit-transform: "+y;s+="-ms-transform: "+y;s+="-moz-transform: "+y;v.attr('style',s);}return l;};h.prototype.enterDrop=function(e,k){var t=D.instance().getAnalysisToken(k.helper);if(!t){return;}if(this._enterDrop){return;}this._enterDrop=true;this._targetRect=this._targetDiv.getBoundingClientRect();var s="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr('style',s);var z=this._zoneProvider();if(!z){return;}this._dragActionArray=[];for(var i=0;i<z.length;i++){var l=z[i].bound;for(var n=0;n<l.length;n++){var m=this._createDiv(this._dom[0],l[n],z[i].text,z[i].rotate);m[0].__zone=z[i];m[0].__areaIndex=n;}}};h.prototype.exitDrop=function(){if(!this._enterDrop){return;}this._dom.empty();this._dom.css('visibility','hidden');this._enterDrop=false;};h.prototype.size=function(s){if(s){this._dom.css({width:s.width+"px",height:s.height+"px"});}};h.prototype._getDom=function(z,e){var k=this._dom.children();for(var i=0;i<k.length;i++){if(k[i].__zone===z&&k[i].__areaIndex===e){return k[i];}}return null;};h.prototype._hightlight=function(z,e){var k=this._getDom(z,e);if(k){$(k).css('visibility','');}};h.prototype._unHightlight=function(z,e){var k=this._getDom(z,e);if(k){$(k).css('visibility','hidden');}};return h;});u('sap/viz/controls/chart/views/EditAxisView',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/LangManager',],function($,O,V,U,C,a,E,L){var b=function(d,c){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.EditAxisView";this._createChildren();};O.extend(b,U);b.AxisScaleChanged="AxisScaleChanged";b.prototype._createChildren=function(){var _=this;this._confirmDialog$=$(document.createElement('div'));this._confirmDialog$.addClass(a.CHART_PREFIX+'editaxis');this._axisContainer=[];this._axisContainer[0]=this._createAxisUI("primaryAxis");this._confirmDialog$.append(this._axisContainer[0]);this._axisContainer[1]=this._createAxisUI("secondaryAxis");this._confirmDialog$.append(this._axisContainer[1]);var d=$(document.createElement('div'));d.addClass(a.CHART_PREFIX+'editaxis-footer');this._confirmDialog$.append(d);var c=$(document.createElement('div'));c.addClass(a.CHART_PREFIX+'editaxis-footer-buttons');d.append(c);var e=$(document.createElement('button'));e.text(L.get("VIZ_COMMON_OK"));e.addClass(a.CHART_PREFIX+'editaxis-footer-button');e.addClass(a.COMMON_PREFIX+'button');c.append(e);e.click(function(){_.hide();_._applyChange();});var f=$(document.createElement('button'));f.text(L.get("VIZ_COMMON_CANCEL"));f.addClass(a.CHART_PREFIX+'editaxis-footer-button');f.addClass(a.COMMON_PREFIX+'button');c.append(f);f.click(function(){_.hide();});this._blockLayout$=$(document.createElement('div'));this._blockLayout$.addClass(a.CHART_PREFIX+'block-layer');};b.prototype._createAxisUI=function(c){var _=this;var d=$(document.createElement('div')).addClass(a.CHART_PREFIX+'editaxis-axiscontainer');var e=$(document.createElement('div')).appendTo(d).addClass(a.CHART_PREFIX+'editaxis-axisname');$(document.createElement('span')).appendTo(e).attr("id","axisName").text("Axis");var s=$(document.createElement('div')).appendTo(d).addClass(a.CHART_PREFIX+'editaxis-separator');var f=$(document.createElement('div')).appendTo(d);f.append('<input type="radio" id="autoRange" value="false" name="'+c+'"></input>');f.find("#autoRange").change(function(){_._updateFixedRangeInput(g.find("#fixedRange")[0],h);});$(document.createElement('span')).appendTo(f).text(L.get("VIZ_CHART_AUTO_RANGE"));var g=$(document.createElement('div')).appendTo(d);g.append('<input type="radio" id="fixedRange" value="true" name="'+c+'"></input>');g.find("#fixedRange").change(function(){_._updateFixedRangeInput(g.find("#fixedRange")[0],h);});$(document.createElement('span')).appendTo(g).text(L.get("VIZ_CHART_FIXED_RANGE"));var h=$(document.createElement('div')).appendTo(d).addClass(a.CHART_PREFIX+'editaxis-inputs');var m=$('<input type="number" id="minValue" style="ime-mode:Disabled" class="'+(a.CHART_PREFIX+"editaxis-inputvalue")+'"></input>');m.on("keypress",function(l){return(/[\d.-]/.test(String.fromCharCode(l.keyCode)));});h.append(m);$(document.createElement('span')).appendTo(h).text(" - ");var k=$('<input type="number" id="maxValue" style="ime-mode:Disabled" class="'+(a.CHART_PREFIX+"editaxis-inputvalue")+'"></input>');k.on("keypress",function(l){return(/[\d.-]/.test(String.fromCharCode(l.keyCode)));});h.append(k);return d;};b.prototype._updateFixedRangeInput=function(f,c){var d=f.checked?false:true;c.find("input").attr("disabled",d);};b.prototype._propertiesChanged=function(p){for(var i=0;i<this._valueAxis.length;++i){var c=this._valueAxis[i];var d=p[c];var e=this._properties[c];if(d.scale.fixedRange!==e.scale.fixedRange){return true;}if(d.scale.fixedRange){if(d.scale.minValue!==e.scale.minValue||d.scale.maxValue!==e.scale.maxValue){return true;}}}return false;};b.prototype._applyChange=function(){var p={};for(var i=0;i<this._valueAxis.length;++i){var c=this._valueAxis[i];p[c]={scale:{fixedRange:false}};var d=this._axisContainer[i];if(!d){continue;}if(d.find("#fixedRange")[0].checked){p[c].scale.fixedRange=true;p[c].scale.minValue=Number(d.find("#minValue").val());p[c].scale.maxValue=Number(d.find("#maxValue").val());}}if(this._propertiesChanged(p)){this._dispatchEvent(new E(b.AxisScaleChanged,this,p));}};b.prototype._getAxisName=function(t,c){var v=V.getValueAxis(t);var d=v?v.length:1;if(d===1||t===C.TYPE_SCATTER||t===C.TYPE_BUBBLE){if(c===C.AXIS_XAXIS){return L.get("VIZ_CHART_XAXIS_RANGE")}else if(c===C.AXIS_YAXIS){return L.get("VIZ_CHART_YAXIS_RANGE")}}else{if(c===C.AXIS_XAXIS){return L.get("VIZ_CHART_XAXIS2_RANGE")}else if(c===C.AXIS_YAXIS){return L.get("VIZ_CHART_YAXIS1_RANGE")}}if(c===C.AXIS_XAXIS2){return L.get("VIZ_CHART_XAXIS1_RANGE")}else if(c===C.AXIS_YAXIS2){return L.get("VIZ_CHART_YAXIS2_RANGE")}return"";};b.prototype._updateUI=function(t,p,c){this._properties=p;if(c){this._valueAxis=[c];}else{this._valueAxis=V.getValueAxis(t);}var v=this._valueAxis;if(!v||v.length===0){return;}for(var i=0;i<v.length;++i){var c=v[i];var d=p[c];var e=this._axisContainer[i];if(!e){continue;}e.css({"display":"block"});e.find("#axisName").text(this._getAxisName(t,c));if(d.scale.fixedRange){e.find("#fixedRange")[0].checked=true;}else{e.find("#autoRange")[0].checked=true;}e.find("#minValue").val(d.scale.minValue);e.find("#maxValue").val(d.scale.maxValue);this._updateFixedRangeInput(e.find("#fixedRange")[0],e.find("."+a.CHART_PREFIX+'editaxis-inputs'));}for(var n=v.length;n<this._axisContainer.length;n++){this._axisContainer[n].css({"display":"none"});}};b.prototype.show=function(t,p,c){this._visible=true;var l=this._dom$.offset().left+this._dom$.width()/2;var d=this._dom$.offset().top+this._dom$.height()/2;$(document.body).append(this._blockLayout$);$(document.body).append(this._confirmDialog$);this._confirmDialog$.css({position:"absolute",left:l-this._confirmDialog$.width()/2,top:d-this._confirmDialog$.height()/2});this._updateUI(t,p,c);};b.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach();};return b;});u('sap/viz/controls/chart/morph/constant/MorphConst',[],function(){var M={};M.SHAPE_DATA="data";M.SHAPE_GLOBAL_TRANSLATE_X="translateX";M.SHAPE_GLOBAL_TRANSLATE_Y="translateY";M.MORPHER_DISABLE_COLOR="MORPHER_DISABLE_COLOR";M.MORPHER_DISABLE_LINE="MORPHER_DISABLE_LINE";M.MORPHER_DISABLE_PATH="MORPHER_DISABLE_PATH";M.MORPHER_DISABLE_RECT="MORPHER_DISABLE_RECT";M.MORPHER_DISABLE_TEXT="MORPHER_DISABLE_TEXT";M.MORPHER_DISABLE_TRANSFORM="MORPHER_DISABLE_TRANSFORM";M.CHART_TYPE_COLUMN="viz/column";M.CHART_TYPE_STACKED_COLUMN="viz/stacked_column";M.CHART_TYPE_100_STACKED_COLUMN="viz/100_stacked_column";M.CHART_TYPE_DUAL_COLUMN="viz/dual_column";M.CHART_TYPE_3D_COLUMN="viz/3d_column";M.CHART_TYPE_BAR="viz/bar";M.CHART_TYPE_STACKED_BAR="viz/stacked_bar";M.CHART_TYPE_100_STACKED_BAR="viz/100_stacked_bar";M.CHART_TYPE_DUAL_BAR="viz/dual_bar";M.CHART_TYPE_3D_BAR="viz/3d_bar";M.CHART_TYPE_LINE="viz/line";M.CHART_TYPE_HORIZONTAL_LINE="viz/horizontal_line";M.CHART_TYPE_DUAL_LINE="viz/dual_line";M.CHART_TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";M.CHART_TYPE_AREA="viz/area";M.CHART_TYPE_HORIZONTAL_AREA="viz/horizontal_area";M.CHART_TYPE_100_AREA="viz/100_area";M.CHART_TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";M.CHART_TYPE_COMBINATION="viz/combination";M.CHART_TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";M.CHART_TYPE_DUAL_COMBINATION="viz/dual_combination";M.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";M.CHART_TYPE_BOXPLOT="viz/boxplot";M.CHART_TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";M.CHART_TYPE_WATERFALL="viz/waterfall";M.CHART_TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";M.CHART_TYPE_PIE="viz/pie";M.CHART_TYPE_DONUT="viz/donut";M.CHART_TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";M.CHART_TYPE_SCATTER="viz/scatter";M.CHART_TYPE_BUBBLE="viz/bubble";M.CHART_TYPE_SCATTER_MATRIX="viz/scatter_matrix";M.CHART_TYPE_GEO_BUBBLE="viz/geobubble";M.CHART_TYPE_GEO_CHOROPLETH="viz/choropleth";M.CHART_TYPE_GEO_PIE="viz/geopie";M.CHART_TYPE_HEATMAP="viz/heatmap";M.CHART_TYPE_TREEMAP="viz/treemap";M.CHART_TYPE_TABLE="viz/ext/table";M.CHART_TYPE_CROSSTAB="viz/ext/crosstab";M.CHART_TYPE_RADAR="viz/radar";M.CHART_TYPE_TAG_CLOUD="viz/tagcloud";var _={};var m=function(t,h){_[t]=h;};m(M.CHART_TYPE_COLUMN,M.CHART_TYPE_BAR);m(M.CHART_TYPE_STACKED_COLUMN,M.CHART_TYPE_STACKED_BAR);m(M.CHART_TYPE_100_STACKED_COLUMN,M.CHART_TYPE_100_STACKED_BAR);m(M.CHART_TYPE_DUAL_COLUMN,M.CHART_TYPE_DUAL_BAR);m(M.CHART_TYPE_3D_COLUMN,M.CHART_TYPE_3D_BAR);m(M.CHART_TYPE_LINE,M.CHART_TYPE_HORIZONTAL_LINE);m(M.CHART_TYPE_DUAL_LINE,M.CHART_TYPE_DUAL_HORIZONTAL_LINE);m(M.CHART_TYPE_AREA,M.CHART_TYPE_HORIZONTAL_AREA);m(M.CHART_TYPE_100_AREA,M.CHART_TYPE_100_HORIZONTAL_AREA);m(M.CHART_TYPE_COMBINATION,M.CHART_TYPE_HORIZONTAL_COMBINATION);m(M.CHART_TYPE_DUAL_COMBINATION,M.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION);m(M.CHART_TYPE_BOXPLOT,M.CHART_TYPE_HORIZONTAL_BOXPLOT);m(M.CHART_TYPE_WATERFALL,M.CHART_TYPE_HORIZONTAL_WATERFALL);M.IS_V_H_MAP=function(t,a){if(_[t]&&_[t]===a){return true;}if(_[a]&&_[a]===t){return true;}return false;};return M;});u('sap/viz/controls/chart/morph/utils/Utils',[],function(){var c={};var _=0;c.genUID=function(){if(!_){_=0;}return"mgen_"+(_++);};var d={'[object Boolean]':'boolean','[object Number]':'number','[object String]':'string','[object Function]':'function','[object Array]':'array','[object Date]':'date','[object RegExp]':'regexp','[object Object]':'object'};c.type=function(o){return!o?String(o):d[Object.prototype.toString.call(o)]||"object";};c.isFunction=function(o){return c.type(o)==="function";};c.isBoolean=function(o){return c.type(o)==="boolean";};c.isString=function(o){return c.type(o)==="string";};c.isArray=function(o){return c.type(o)==="array";};c.isNumber=function(o){return c.type(o)==="number";};c.isRegExp=function(o){return c.type(o)==="regexp";};c.sortArrayOn=function(e,p,f){if(c.isArray(e)&&c.isString(p)){e.sort(function(a,b){return f?(a[p]<b[p])-(a[p]>b[p]):(a[p]>b[p])-(a[p]<b[p]);});}};c.noop=function(){};return c;});u('sap/viz/controls/chart/morph/utils/SVGShapeMetadata',[],function(){var S={};var a="__vizmp__";S.set=function(s,n,v){if(!s[a]){s[a]={};}s[a][n]=v;};S.get=function(s,n){if(s&&s[a]!==null&&s[a]!==undefined){return s[a][n];}return undefined;};S.clone=function(n,o){n[a]=o[a];return n;};return S;});u('sap/viz/controls/chart/morph/vo/VizShape',[],function(){var V=function(f,t,d){this.from=f;this.to=t;this.display=d;};return V;});u('sap/viz/controls/chart/morph/vo/VizShapesHolder',[],function(){var V=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[];};V.prototype.empty=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[];};V.prototype.allByOrder=function(){return[].concat(this.backgrounds,this.xAxis2Labels,this.xAxisLabels,this.yAxis2Labels,this.yAxisLabels,this.plotLines,this.plotShapes);};V.prototype.toShapesBySvgType=function(){var a={};var b=[];a["all"]=b;var c=this.allByOrder();for(var i=0;i<c.length;i++){var v=c[i];if(v.to){var t=v.to.localName;var d=a[t];if(!d){a[t]=d=[];}d.push(v);b.push(v);}}return a;};return V;});u('sap/viz/controls/chart/morph/viz/MpShapesCapturer',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/chart/morph/vo/VizShapesHolder'],function(M,S,V,a){var b={};b.getShapes=function(v){var d=new a();var g=d3.select(v).select(".v-m-root");var h=d3.select(v).select(".v-m-main");var r=g.node();var m=h.node();if(r&&m&&r.offsetHeight>0&&r.offsetWidth>0&&r.getScreenCTM!==undefined&&m.getScreenCTM!==undefined){var k=p(g);var l=r.getScreenCTM();d.plotShapes=c(h,".v-m-plot .v-morphable-datapoint",l,k);d.plotLines=c(h,".v-m-plot .v-morphable-line, "+".v-m-plot .v-morphable-areabg",l,k);d.xAxisLabels=c(h,".v-m-xAxis .v-morphable-label",l);d.xAxis2Labels=c(h,".v-m-xAxis2 .v-morphable-label",l);d.yAxisLabels=c(h,".v-m-yAxis .v-morphable-label",l);d.yAxis2Labels=c(h,".v-m-yAxis2 .v-morphable-label",l);d.backgrounds=c(g,".v-m-background .v-morphable-background",l);for(var i=0;i<d.backgrounds.length;i++){var n=d.backgrounds[i];S.set(n.to,M.MORPHER_DISABLE_RECT,true);}}return d;};var c=function(g,s,o,v){var h=g.selectAll(s);var k=[];h.each(function(d,i){if(this.localName==="path"&&String(this.getAttribute("class")).indexOf("v-geo-choropleth-feature")>=0){return;}var l=this.cloneNode(true);S.set(l,M.SHAPE_DATA,this.__data__);f(l,this,v);e(this,o,l);k.push(new V(null,l,null));});return k;};var p=function(v){var g={};var h=false;var d=v.selectAll("defs");d.each(function(){var k=this;if(k.firstChild){var l=k.childNodes;for(var i=0;i<l.length;i++){var m=l[i];if(m){var n="";var s=[];var o="#000000";if(m.localName==="linearGradient"){n=m.getAttribute("id");s=m.childNodes;if(s.length===2){o=s[1].getAttribute("stop-color");}else if(s.length===4){o=s[3].getAttribute("stop-color");}else{o=s[s.length-1].getAttribute("stop-color");}g[n]=o;h=true;}else if(m.localName==="radialGradient"){n=m.getAttribute("id");s=m.childNodes;if(s.length===3){o=s[1].getAttribute("stop-color");}else if(s.length===4){o=s[3].getAttribute("stop-color");}else{o=s[s.length-1].getAttribute("stop-color");}g[n]=o;h=true;}}}}});if(h){g["__hasGradientColor"]=true;}return g;};var e=function(o,d,n){var g=o.getScreenCTM();var l=g.e-d.e;var t=g.f-d.f;n.setAttribute("transform","translate("+l+","+t+")");S.set(n,M.SHAPE_GLOBAL_TRANSLATE_X,l);S.set(n,M.SHAPE_GLOBAL_TRANSLATE_Y,t);return n;};var f=function(s,o,v){if(s.localName==="path"&&s.getAttribute("class")&&s.getAttribute("class").indexOf("v-morphable-line")>=0){s.setAttribute("fill-opacity",0);}if(s.localName==="path"&&s.getAttribute("class")&&s.getAttribute("class").indexOf("v-morphable-datapoint")>=0&&s.getAttribute("visibility")==="hidden"){s.setAttribute("visibility","");s.setAttribute("d","M0,0L0,0Z");}if(o.localName==="rect"&&o.getAttribute("opacity")==="0"&&o.parentNode&&o.parentNode.parentNode&&o.parentNode.parentNode.getAttribute("class")&&o.parentNode.parentNode.getAttribute("class").indexOf("v-heatmap")>=0){s.setAttribute("opacity",1);}if(v&&v["__hasGradientColor"]===true&&o.getAttribute("fill")&&o.getAttribute("fill").indexOf("url(#")===0){var g=o.getAttribute("fill");g=g.substring(5,g.length-1);var d=v[g];d=d?d:"#000000";s.setAttribute("fill",d);}};return b;});u('sap/viz/controls/chart/morph/utils/SVGShapeReplacer',['sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(S){var a={};var b="http://www.w3.org/2000/svg";var c=["x","y","width","height","rx","ry","x1","x2","y1","y2"];var g=function(s,d){var r=parseFloat(s.getAttribute(d));return isNaN(r)?0:r;};a.replace=function(s,n,d,k){if(s&&n){var e=document.createElementNS(b,n);if(k){var o=s.attributes;for(var i=0;i<o.length;i++){var f=o[i];if(c.indexOf(f.localName)===-1){e.setAttribute(f.localName,f.value);}}}for(var h in d){if(d.hasOwnProperty(h)){e.setAttribute(h,d[h]);}}S.clone(e,s);if(s.parentNode){s.parentNode.replaceChild(e,s);}return e;}return null;};a.replaceToPath=function(s){if(s){var p=null;switch(s.localName){case"rect":var x=g(s,"x");var y=g(s,"y");var w=g(s,"width");var h=g(s,"height");var r=g(s,"rx");var d=g(s,"ry");p="M"+x+","+y+"L"+(w+x)+","+y+"L"+(w+x)+","+(h+y)+"L"+x+","+(h+y)+"L"+x+","+y+"Z";break;case"line":var e=g(s,"x1");var f=g(s,"y1");var k=g(s,"x2");var l=g(s,"y2");p="M"+e+","+f+"L"+k+","+l;break;default:}if(p){var m={d:p};return a.replace(s,"path",m,true);}}return null;};return a;});u('sap/viz/controls/chart/morph/viz/MpShapesMapper',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/utils/SVGShapeReplacer','sap/viz/controls/chart/morph/vo/VizShape'],function(M,a,S,b,V){var c={};c.map=function(n,g,h,k){m(n.plotShapes,g.plotShapes,d);m(n.plotLines,g.plotLines,d);if(M.IS_V_H_MAP(h,k)){m(n.xAxisLabels,g.yAxisLabels,d);m(n.xAxis2Labels,g.yAxis2Labels,d);m(n.yAxisLabels,g.xAxisLabels,d);m(n.yAxis2Labels,g.xAxis2Labels,d);}else{m(n.xAxisLabels,g.xAxisLabels,d);m(n.xAxis2Labels,g.xAxis2Labels,d);m(n.yAxisLabels,g.yAxisLabels,d);m(n.yAxis2Labels,g.yAxis2Labels,d);}m(n.backgrounds,g.backgrounds,f);return n;};var d=function(g,t){if(t&&g&&S.get(t,M.SHAPE_DATA)&&S.get(g,M.SHAPE_DATA)&&S.get(g,M.SHAPE_DATA).ctx){var h=S.get(t,M.SHAPE_DATA).ctx;var k=S.get(g,M.SHAPE_DATA).ctx;if(a.isArray(h)){h=h[0];}if(a.isArray(k)){k=k[0];}if(h&&k){return e(h,k);}}if(t&&g&&a.isArray(S.get(t,M.SHAPE_DATA))&&a.isArray(S.get(g,M.SHAPE_DATA))){var l=S.get(t,M.SHAPE_DATA);var n=S.get(g,M.SHAPE_DATA);if(l.length==n.length&&l.length>0){for(var i=0;i<l.length;i++){if(!l[i]||!n[i]||e(l[i].ctx,n[i].ctx)===false){return false;}}return true;}}if(t&&g&&t.localName==="g"&&g.localName==="g"&&t.firstChild.localName==="text"&&g.firstChild.localName==="text"&&t.firstChild.textContent==g.firstChild.textContent){return true;}return false;};var e=function(g,h){if(!g&&!h){return true;}if(!g||!h||g.type!==h.type||(!g.path||!h.path)||(g.path.dii_a1!=h.path.dii_a1)||(g.path.dii_a2!=h.path.dii_a2)||(g.path.mg!=h.path.mg)||(g.path.mi!=h.path.mi)){return false;}return true;};var f=function(g,t){if(t&&g&&t.localName==g.localName&&t.getAttribute("class")==g.getAttribute("class")){return true;}};var m=function(n,g,h,k){var l=[];for(var i=0;i<n.length;i++){var o=n[i];for(var j=0;j<g.length;j++){var p=g[j];if(k||l.indexOf(p)===-1){if(h(o.to,p.display)){var q=r(o.to,p.display);o.to=q.newShape;o.from=q.currentShape;l.push(p);break;}}}}};var r=function(n,g){var h={newShape:n,currentShape:g};var k;if(n.localName==="path"&&g.localName!=="path"){k=b.replaceToPath(g);if(k){h.currentShape=k;}}if(n.localName!=="path"&&g.localName==="path"){k=b.replaceToPath(n);if(k){h.newShape=k;}}return h;};return c;});u('sap/viz/controls/chart/morph/utils/Cache',[],function(){var C={};var r=function(a,b){for(var i=0,c=a.length;i<c;i++){if(a[i]===b){return a.push(a.splice(i,1)[0]);}}};C.func=function(f,s,p){function n(){var a=Array.prototype.slice.call(arguments,0),b=a.join("\u2400"),c=n.cache=n.cache||{},d=n.count=n.count||[];if(c.hasOwnProperty(b)){r(d,b);return p?p(c[b]):c[b];}d.length>=1e3&&delete c[d.shift()];d.push(b);c[b]=f.apply(s,a);return p?p(c[b]):c[b];}return n;};return C;});u('sap/viz/controls/chart/morph/utils/ColorUtil',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/Cache'],function(a,C){var c={};var _=null;c.parse=function(b){if(!_){_=C.func(RGBColorStatic.parse);}return _(b);};c.numberToHexString=function(d){var r=((d&0xff0000)>>16).toString(16),g=((d&0x00ff00)>>8).toString(16),b=(d&0x0000ff).toString(16);var h="#"+((r.length===1)?"0"+r:r)+((g.length===1)?"0"+g:g)+((b.length===1)?"0"+b:b);return h;};c.hexStringToNumber=function(h){if(!h){return 0;}if(h.charAt(0)==='#'){h=h.substr(1);}var r=parseInt(h.substr(0,2),16),g=parseInt(h.substr(2,2),16),b=parseInt(h.substr(4,2),16);var d=(Math.max(0,Math.min(255,r))*65536)+(Math.max(0,Math.min(255,g))*256)+Math.max(0,Math.min(255,b));return d;};c.numberToRGB=function(d){var r=(d&0xff0000)>>16,g=(d&0x00ff00)>>8,b=d&0x0000ff;return'rgb('+r+','+g+','+b+')';};c.numberToRGBA=function(d,e){var r=(d&0xff0000)>>16,g=(d&0x00ff00)>>8,b=d&0x0000ff;if(e===undefined||e<=0||e>1){e=1;}return'rgba('+r+','+g+','+b+','+e+')';};c.RGBToNumber=function(r,g,b){var h=(Math.max(0,Math.min(255,r))*65536)+(Math.max(0,Math.min(255,g))*256)+Math.max(0,Math.min(255,b));return h;};c.getColorMix=function(b,d,p){return c.getPercentageOfColor(b,1-p)+c.getPercentageOfColor(d,p);};c.getPercentageOfColor=function(b,p){p=Math.min(1,Math.max(0,p));var r=(b&0xff0000)>>16;var g=(b&0x00ff00)>>8;var d=b&0x0000ff;return(r*p)<<16|(g*p)<<8|(d*p);};c.adjustBrightness=function(d,e){var r=Math.min(((d>>16)&0xFF)+e,255);r=Math.max(r,0);var g=Math.min(((d>>8)&0xFF)+e,255);g=Math.max(g,0);var b=Math.min((d&0xFF)+e,255);b=Math.max(b,0);return(r<<16)|(g<<8)|b;};c.adjustBrightness2=function(d,e){var r=NaN,g=NaN,b=NaN;if(e==0){return d;}else if(e>0){e/=100;r=((d>>16)&0xFF);g=((d>>8)&0xFF);b=(d&0xFF);r+=((0xFF-r)*e);g+=((0xFF-g)*e);b+=((0xFF-b)*e);r=Math.min(r,255);g=Math.min(g,255);b=Math.min(b,255);}else{e=(100+e)/100;r=((d>>16)&0xFF)*e;g=((d>>8)&0xFF)*e;b=(d&0xFF)*e;}return(r<<16)|(g<<8)|b;};c.rgbMultiply=function(b,d){var r=(b>>16)&0xFF,g=(b>>8)&0xFF,e=b&0xFF;var f=(d>>16)&0xFF,h=(d>>8)&0xFF,k=d&0xFF;return((r*f/255)<<16)|((g*h/255)<<8)|(e*k/255);};return c;});u('sap/viz/controls/chart/morph/morphers/ColorMorpher',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/ColorUtil'],function(a,C){var b={};var g=function(s,c){var r=parseFloat(s.getAttribute(c));return isNaN(r)?1:r;};b.getPercentage=function(f,t,p){p=p>100?100:p<0?0:p;var c=C.parse(f);var d=C.parse(t);if(c.length===0&&d.length===0){return"";}if(c.length===0&&d.length===3){return"rgb("+d[0]+","+d[1]+","+d[2]+")";}if(c.length===3&&d.length===0){return"";}return"rgb("+Math.round(c[0]+(d[0]-c[0])*p/100)+","+Math.round(c[1]+(d[1]-c[1])*p/100)+","+Math.round(c[2]+(d[2]-c[2])*p/100)+")";};b.svg=function(f,t,d,p){if(d&&t){var c=f?f.getAttribute("stroke"):"";var e=t.getAttribute("stroke");var h=f?f.getAttribute("fill"):"";var k=t.getAttribute("fill");if(c===e){d.setAttribute("stroke",e);}else{d.setAttribute("stroke",b.getPercentage(c,e,p));}var l="";if(h===k){l=k;d.setAttribute("fill",l);}else{l=b.getPercentage(h,k,p);d.setAttribute("fill",l);}var m;var n;if(f){if(l===""){d.setAttribute("fill-opacity",0);}else{var o=g(f,"fill-opacity");m=g(t,"fill-opacity");if(o!=m){d.setAttribute("fill-opacity",o+(m-o)*p/100);}}var q=g(f,"stroke-opacity");n=g(t,"stroke-opacity");if(q!=n){d.setAttribute("stroke-opacity",q+(n-q)*p/100);}}else{if(t.getAttribute("fill-opacity")!==""){if(l===""){m=0;}else{m=g(t,"fill-opacity");}d.setAttribute("fill-opacity",0+(m-0)*p/100);}else{d.setAttribute("fill-opacity","");}if(t.getAttribute("stroke-opacity")!==""){n=g(t,"stroke-opacity");d.setAttribute("stroke-opacity",0+(n-0)*p/100);}else{d.setAttribute("stroke-opacity","");}}}};return b;});u('sap/viz/controls/chart/morph/morphers/RectMorpher',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(M,S){var R={};R.NO_DEFAULT_DIRECTION=0;R.DEFAULT_DIRECTION_TO_NORTH=1;R.DEFAULT_DIRECTION_TO_SOUTH=2;R.DEFAULT_DIRECTION_TO_EAST=4;R.DEFAULT_DIRECTION_TO_WEST=8;R.getPercentageRect=function(f,t,p){return{w:f.w+(t.w-f.w)*p/100,h:f.h+(t.h-f.h)*p/100,x:f.x+(t.x-f.x)*p/100,y:f.y+(t.y-f.y)*p/100,r:f.r+(t.r-f.r)*p/100};};var g=function(s,b){var r=parseInt(s.getAttribute(b),10);return isNaN(r)?0:r;};var a=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?0:r;};R.svg=function(f,t,d,p,b){if(d&&t&&t.localName==="rect"){var c;var e;var h;var k;var l;var m;if(S.get(t,M.MORPHER_DISABLE_RECT)===true){c=a(t,"x");e=a(t,"rx");h=a(t,"y");k=a(t,"ry");l=a(t,"width");m=a(t,"height");var n=a(d,"x");var o=a(d,"rx");var q=a(d,"y");var r=a(d,"ry");var s=a(d,"width");var v=a(d,"height");if(c!==n){d.setAttribute("x",c);}if(e!==o){d.setAttribute("rx",e);}if(h!==q){d.setAttribute("y",h);}if(k!==r){d.setAttribute("ry",k);}if(l!==s){d.setAttribute("width",l);}if(m!==v){d.setAttribute("height",m);}}else if(f&&f.localName==="rect"){var w=a(f,"x");c=a(t,"x");var x=a(f,"rx");e=a(t,"rx");var y=a(f,"y");h=a(t,"y");var z=a(f,"ry");k=a(t,"ry");var C=a(f,"width");l=a(t,"width");var D=a(f,"height");m=a(t,"height");var E=(C>=1&&D>=1);var F=(l>=1&&m>=1);if(!E&&!F){p=100;}d.setAttribute("x",w+(c-w)*p/100);d.setAttribute("y",y+(h-y)*p/100);d.setAttribute("rx",x+(e-x)*p/100);d.setAttribute("ry",z+(k-z)*p/100);d.setAttribute("width",C+(l-C)*p/100);d.setAttribute("height",D+(m-D)*p/100);}else if(!f){c=a(t,"x");e=a(t,"rx");h=a(t,"y");k=a(t,"ry");l=a(t,"width");m=a(t,"height");if(b==null||b<0){b=R.DEFAULT_DIRECTION_TO_NORTH|R.DEFAULT_DIRECTION_TO_WEST;}if((b&R.DEFAULT_DIRECTION_TO_NORTH)&&(b&R.DEFAULT_DIRECTION_TO_SOUTH)){d.setAttribute("y",h+(m-0)*(100-p)/100/2);d.setAttribute("height",0+(m-0)*p/100);}else if(b&R.DEFAULT_DIRECTION_TO_NORTH){d.setAttribute("y",h+(m-0)*(100-p)/100);d.setAttribute("height",0+(m-0)*p/100);}else if(b&R.DEFAULT_DIRECTION_TO_SOUTH){d.setAttribute("y",h);d.setAttribute("height",0+(m-0)*p/100);}else{d.setAttribute("y",h);d.setAttribute("height",m);}if((b&R.DEFAULT_DIRECTION_TO_EAST)&&(b&R.DEFAULT_DIRECTION_TO_WEST)){d.setAttribute("x",c+(l-0)*(100-p)/100/2);d.setAttribute("width",0+(l-0)*p/100);}else if(b&R.DEFAULT_DIRECTION_TO_EAST){d.setAttribute("x",c+(l-0)*(100-p)/100);d.setAttribute("width",0+(l-0)*p/100);}else if(b&R.DEFAULT_DIRECTION_TO_WEST){d.setAttribute("x",c);d.setAttribute("width",0+(l-0)*p/100);}else{d.setAttribute("x",c);d.setAttribute("width",l);}}}};return R;});u('sap/viz/controls/chart/morph/morphers/LineMorpher',[],function(){var L={};L.getPercentageLine=function(f,t,p){return{x:f.x+(t.x-f.x)*p/100,y:f.y+(t.y-f.y)*p/100,x2:f.x2+(t.x2-f.x2)*p/100,y2:f.y2+(t.y2-f.y2)*p/100};};var g=function(s,b){var r=parseInt(s.getAttribute(b),10);return isNaN(r)?0:r;};var a=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?0:r;};L.svg=function(f,t,d,p){if(d&&t&&t.localName==="line"){var b;var c;var e;var h;if(f&&f.localName==="rect"){var k=a(f,"x1");b=a(t,"x1");var l=a(f,"x2");c=a(t,"x2");var m=a(f,"y1");e=a(t,"y1");var n=a(f,"y2");h=a(t,"y2");d.setAttribute("x1",k+(b-k)*p/100);d.setAttribute("y1",m+(e-m)*p/100);d.setAttribute("x2",l+(c-l)*p/100);d.setAttribute("y2",n+(h-n)*p/100);}else if(!f){b=a(t,"x1");c=a(t,"x2");e=a(t,"y1");h=a(t,"y2");d.setAttribute("x1",b);d.setAttribute("y1",e);d.setAttribute("x2",0+(c-0)*p/100);d.setAttribute("y2",0+(h-0)*p/100);}}};return L;});u('sap/viz/controls/chart/morph/morphers/PathMorpher',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/Cache','sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(e,C,M,S){var f="concat",g="apply",l="hasOwnProperty",s="split",m=String.prototype.toLowerCase,n=String.prototype.toUpperCase,o=parseFloat,q=parseInt,v=Math,w=v.max,D=v.min,E=v.abs,F=v.pow,P=v.PI,G="number",H="string",I="array",J="toString";var K=/,?([achlmqrstvxz]),?/gi,L=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,N=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig;var _=function(a){return a?a.join(",").replace(K,"$1"):this.join(",").replace(K,"$1");};var O=function(c,z){var d=[];for(var i=0,a=c.length;a-2*!z>i;i+=2){var p=[{x:+c[i-2],y:+c[i-1]},{x:+c[i],y:+c[i+1]},{x:+c[i+2],y:+c[i+3]},{x:+c[i+4],y:+c[i+5]}];if(z){if(!i){p[0]={x:+c[a-2],y:+c[a-1]};}else if(a-4===i){p[3]={x:+c[0],y:+c[1]};}else if(a-2===i){p[2]={x:+c[0],y:+c[1]};p[3]={x:+c[2],y:+c[3]};}}else{if(a-4===i){p[3]=p[2];}else if(!i){p[0]={x:+c[i],y:+c[i+1]};}}d.push(["C",(-p[0].x+6*p[1].x+p[2].x)/6,(-p[0].y+6*p[1].y+p[2].y)/6,(p[1].x+6*p[2].x-p[3].x)/6,(p[1].y+6*p[2].y-p[3].y)/6,p[2].x,p[2].y]);}return d;};var Q=function(p){if(!p){return null;}var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},h=[];if(!h.length){String(p).replace(L,function(a,b,c){var k=[],r=b.toLowerCase();c.replace(N,function(a,b){b&&k.push(+b);});if(r==="m"&&k.length>2){h.push([b][f](k.splice(0,2)));r="l";b=b==="m"?"l":"L";}if(r==="r"){h.push([b][f](k));}else{while(k.length>=d[r]){h.push([b][f](k.splice(0,d[r])));if(!d[r]){break;}}}});}h.toString=_;return h;};var R=function(p){if(!e.isArray(p)||!e.isArray(p&&p[0])){p=Q(p);}if(!p||!p.length){return[["M",0,0]];}var a=[],x=0,y=0,b=0,c=0,d=0;if(p[0][0]==="M"){x=+p[0][1];y=+p[0][2];b=x;c=y;d++;a[0]=["M",x,y];}var h=p.length===3&&p[0][0]==="M"&&p[1][0].toUpperCase()==="R"&&p[2][0].toUpperCase()==="Z";for(var r,t,i=d,z=p.length;i<z;i++){a.push(r=[]);t=p[i];if(t[0]!=n.call(t[0])){r[0]=n.call(t[0]);switch(r[0]){case"A":r[1]=t[1];r[2]=t[2];r[3]=t[3];r[4]=t[4];r[5]=t[5];r[6]=+(t[6]+x);r[7]=+(t[7]+y);break;case"V":r[1]=+t[1]+y;break;case"H":r[1]=+t[1]+x;break;case"R":var X=[x,y][f](t.slice(1));for(var j=2,Y=X.length;j<Y;j++){X[j]=+X[j]+x;X[++j]=+X[j]+y;}a.pop();a=a[f](O(X,h));break;case"M":b=+t[1]+x;c=+t[2]+y;break;default:for(j=1,Y=t.length;j<Y;j++){r[j]=+t[j]+((j%2)?x:y);}}}else if(t[0]==="R"){X=[x,y][f](t.slice(1));a.pop();a=a[f](O(X,h));r=["R"][f](t.slice(-2));}else{for(var k=0,kk=t.length;k<kk;k++){r[k]=t[k];}}switch(r[0]){case"Z":x=b;y=c;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":b=r[r.length-2];c=r[r.length-1];break;default:x=r[r.length-2];y=r[r.length-1];}}a.toString=_;return a;};var T=function(x,y,a,b){return[x,y,a,b,a,b];};var U=function(x,y,a,b,c,d){var h=1/3,k=2/3;return[h*x+k*a,h*y+k*b,h*c+k*a,h*d+k*b,c,d];};var V=function(a,b,r,c,d,p,z,x2,y2,e1){var g1=P*120/180,h1=P/180*(+d||0),i1=[],xy,k1=C.func(function(x,y,h1){var X=x*v.cos(h1)-y*v.sin(h1),Y=x*v.sin(h1)+y*v.cos(h1);return{x:X,y:Y};});if(!e1){xy=k1(a,b,-h1);a=xy.x;b=xy.y;xy=k1(x2,y2,-h1);x2=xy.x;y2=xy.y;var l1=v.cos(P/180*d),n1=v.sin(P/180*d),x=(a-x2)/2,y=(b-y2)/2;var h=(x*x)/(r*r)+(y*y)/(c*c);if(h>1){h=v.sqrt(h);r=h*r;c=h*c;}var o1=r*r,p1=c*c,k=(p==z?-1:1)*v.sqrt(E((o1*p1-o1*y*y-p1*x*x)/(o1*y*y+p1*x*x))),cx=k*r*y/c+(a+x2)/2,cy=k*-c*x/r+(b+y2)/2,f1=v.asin(((b-cy)/c).toFixed(9)),f2=v.asin(((y2-cy)/c).toFixed(9));f1=a<cx?P-f1:f1;f2=x2<cx?P-f2:f2;f1<0&&(f1=P*2+f1);f2<0&&(f2=P*2+f2);if(z&&f1>f2){f1=f1-P*2;}if(!z&&f2>f1){f2=f2-P*2;}}else{f1=e1[0];f2=e1[1];cx=e1[2];cy=e1[3];}var df=f2-f1;if(E(df)>g1){var v1=f2,w1=x2,x1=y2;f2=f1+g1*(z&&f2>f1?1:-1);x2=cx+r*v.cos(f2);y2=cy+c*v.sin(f2);i1=V(x2,y2,r,c,d,0,z,w1,x1,[f2,v1,cx,cy]);}df=f2-f1;var c1=v.cos(f1),s1=v.sin(f1),c2=v.cos(f2),s2=v.sin(f2),t=v.tan(df/4),hx=4/3*r*t,hy=4/3*c*t,m1=[a,b],m2=[a+hx*s1,b-hy*c1],m3=[x2+hx*s2,y2-hy*c2],m4=[x2,y2];m2[0]=2*m1[0]-m2[0];m2[1]=2*m1[1]-m2[1];if(e1){return[m2,m3,m4][f](i1);}else{i1=[m2,m3,m4][f](i1).join()[s](",");var I1=[];for(var i=0,ii=i1.length;i<ii;i++){I1[i]=i%2?k1(i1[i-1],i1[i],h1).y:k1(i1[i],i1[i+1],h1).x;}return I1;}};var W=function(a,b){var p=R(a),c=b&&R(b),h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},k={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r=function(a,d){var nx,ny;if(!a){return["C",d.x,d.y,d.x,d.y,d.x,d.y];}!(a[0]in{T:1,Q:1})&&(d.qx=d.qy=null);switch(a[0]){case"M":d.X=a[1];d.Y=a[2];break;case"A":a=["C"][f](V[g](0,[d.x,d.y][f](a.slice(1))));break;case"S":nx=d.x+(d.x-(d.bx||d.x));ny=d.y+(d.y-(d.by||d.y));a=["C",nx,ny][f](a.slice(1));break;case"T":d.qx=d.x+(d.x-(d.qx||d.x));d.qy=d.y+(d.y-(d.qy||d.y));a=["C"][f](U(d.x,d.y,d.qx,d.qy,a[1],a[2]));break;case"Q":d.qx=a[1];d.qy=a[2];a=["C"][f](U(d.x,d.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][f](T(d.x,d.y,a[1],a[2]));break;case"H":a=["C"][f](T(d.x,d.y,a[1],d.y));break;case"V":a=["C"][f](T(d.x,d.y,d.x,a[1]));break;case"Z":a=["C"][f](T(d.x,d.y,d.X,d.Y));break;}return a;},t=function(d,i){if(d[i].length>7){d[i].shift();var pi=d[i];while(pi.length){d.splice(i++,0,["C"][f](pi.splice(0,6)));}d.splice(i,1);y=w(p.length,c&&c.length||0);}},x=function(d,b,a1,a2,i){if(d&&b&&d[i][0]==="M"&&b[i][0]!=="M"){b.splice(i,0,["M",a2.x,a2.y]);a1.bx=0;a1.by=0;a1.x=d[i][1];a1.y=d[i][2];y=w(p.length,c&&c.length||0);}};for(var i=0,y=w(p.length,c&&c.length||0);i<y;i++){p[i]=r(p[i],h);t(p,i);c&&(c[i]=r(c[i],k));c&&t(c,i);x(p,c,h,k,i);x(c,p,k,h,i);var z=p[i],X=c&&c[i],Y=z.length,c1=c&&X.length;h.x=z[Y-2];h.y=z[Y-1];h.bx=o(z[Y-4])||h.x;h.by=o(z[Y-3])||h.y;k.bx=c&&(o(X[c1-4])||k.x);k.by=c&&(o(X[c1-3])||k.y);k.x=c&&X[c1-2];k.y=c&&X[c1-1];}return c?[p,c]:p;};var Z=null;var b1=function(p,a){if(!Z){Z=C.func(W);}return Z(p,a);};var d1={};d1.getPercentagePath=function(a,t,p){if(!a||!t){return"";}var c=b1(String(a),String(t));var b=c[0];var d=c[1];var h=[];for(var i=0,k=b.length;i<k;i++){h[i]=[b[i][0]];for(var j=1,r=b[i].length;j<r;j++){h[i][j]=b[i][j]+(d[i][j]-b[i][j])*p/100;}}return _(h);};d1.svg=function(a,t,d,p){if(d&&t&&t.localName=="path"&&(!a||a.localName=="path")){var b=t.getAttribute("d");if(b&&b.length>1){var c;if(S.get(t,M.MORPHER_DISABLE_PATH)===true){c=d.getAttribute("d");if(b!==c){d.setAttribute("d",b);}}else{var h="";if(a){h=a.getAttribute("d");}if(!h){var k=b.match(L);if(k.length>0){h=k[0];}else{h="M0,0";}}c=d1.getPercentagePath(h,b,p);d.setAttribute("d",c);}}}};return d1;});u('sap/viz/controls/chart/morph/utils/TransformParser',[],function(){var T={};var t=function(s){return s.replace(/^\s*/,"").replace(/\s*$/,"");};T.parse=function(a){var r=[];var b=[];var s=[];if(a){var c;if(a.indexOf("rotate(")>=0){var d=a.substring(a.indexOf("rotate("));d=d.substring("rotate(".length,d.indexOf(")"));d=t(d);var e=[];if(d.indexOf(",")>0){e=d.split(",");}else{e=d.split(" ");}for(var i=0;i<e.length&&r.length<3;i++){c=t(e[i]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0;}r.push(c);}}if(r.length<3){r[1]=0;r[2]=0;}}if(a.indexOf("translate(")>=0){var f=a.substring(a.indexOf("translate("));f=f.substring("translate(".length,f.indexOf(")"));f=t(f);var g=[];if(f.indexOf(",")>0){g=f.split(",");}else{g=f.split(" ");}for(var j=0;j<g.length&&b.length<2;j++){c=t(g[j]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0;}b.push(c);}}if(b.length<2){b[1]=0;}}if(a.indexOf("scale(")>=0){var h=a.substring(a.indexOf("scale("));h=h.substring("scale(".length,h.indexOf(")"));h=t(h);var l=[];if(h.indexOf(",")>0){l=h.split(",");}else{l=h.split(" ");}for(var k=0;k<l.length&&s.length<2;k++){c=t(l[k]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0;}s.push(c);}}if(s.length<2){s[1]=0;}}}return{rotate:r.length>0?r:null,translate:b.length>0?b:null,scale:s.length>0?s:null};};return T;});u('sap/viz/controls/chart/morph/morphers/TransformMorpher',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/utils/TransformParser'],function(M,S,T){var a={};a.applyTransform=function(f,b,t,c,p){var x=f+(t-f)*p/100;var y=b+(c-b)*p/100;return"translate("+x+","+y+")";};a.svg=function(f,t,d,p,b){if(d&&t){var c="";if(f){var e=T.parse(f.getAttribute("transform"));var g=T.parse(t.getAttribute("transform"));if(b){if(e.translate||g.translate){if(!e.translate){e.translate=[0,0];}if(!g.translate){g.translate=[0,0];}c+=(c?" ":"")+"translate("+(e.translate[0]+(g.translate[0]-e.translate[0])*p/100)+","+(e.translate[1]+(g.translate[1]-e.translate[1])*p/100)+")";}}else{var h=S.get(f,M.SHAPE_GLOBAL_TRANSLATE_X)||0;var k=S.get(f,M.SHAPE_GLOBAL_TRANSLATE_Y)||0;var l=S.get(t,M.SHAPE_GLOBAL_TRANSLATE_X)||0;var m=S.get(t,M.SHAPE_GLOBAL_TRANSLATE_Y)||0;var n=h+(l-h)*p/100;var o=k+(m-k)*p/100;c+=(c?" ":"")+"translate("+n+","+o+")";}if(e.rotate||g.rotate){if(!e.rotate){e.rotate=[0,0,0];}if(!g.rotate){g.rotate=[0,0,0];}c+=(c?" ":"")+"rotate("+(e.rotate[0]+(g.rotate[0]-e.rotate[0])*p/100)+","+(e.rotate[1]+(g.rotate[1]-e.rotate[1])*p/100)+","+(e.rotate[2]+(g.rotate[2]-e.rotate[2])*p/100)+")";}if(e.scale||g.scale){if(!e.scale){e.scale=[0,0];}if(!g.scale){g.scale=[0,0];}c+=(c?" ":"")+"scale("+(e.scale[0]+(g.scale[0]-e.scale[0])*p/100)+","+(e.scale[1]+(g.scale[1]-e.scale[1])*p/100)+")";}d.setAttribute("transform",c);}}};return a;});u('sap/viz/controls/chart/morph/morphers/TextMorpher',['sap/viz/controls/chart/morph/morphers/TransformMorpher'],function(T){var a={};var g=function(s,d){var e=parseInt(s.getAttribute(d),10);return isNaN(e)?0:e;};var b=function(s,d){var e=parseFloat(s.getAttribute(d));return isNaN(e)?0:e;};var r=/(\d+)(in|cm|mm|pt|pc|em|ex|px)/i;var c=function(f,t,p){var d=r.exec(f);if(!d){d=[f,f,""];}var e=parseInt(d[1],10);var h=d[2];var k=r.exec(t);if(!k){k=[t,t,""];}var l=parseInt(k[1],10);var m=k[2];var n=e;switch(h){case"pt":n=n*1.33;break;case"px":n=n;break;default:n=n;}switch(m){case"pt":n=n/1.33;break;case"px":n=n;break;default:n=n;}return String(Math.round(n+(l-n)*p/100))+m;};a.svg=function(f,t,d,p){if(d&&t.localName==="g"&&t.firstChild&&t.firstChild.localName==="text"){if(f&&f.localName==="g"&&f.firstChild&&f.firstChild.localName==="text"){var e=b(f.firstChild,"x");var h=b(t.firstChild,"x");var k=b(f.firstChild,"y");var l=b(t.firstChild,"y");d.firstChild.setAttribute("x",e+(h-e)*p/100);d.firstChild.setAttribute("y",k+(l-k)*p/100);var m=f.getAttribute("font-size");var n=t.getAttribute("font-size");if(m&&n&&m!=n){var o=c(m,n,p);d.setAttribute("font-size",o);}T.svg(f.firstChild,t.firstChild,d.firstChild,p,true);}else if(!f){d.setAttribute("opacity",p/100);}}};return a;});u('sap/viz/controls/chart/morph/VizMorpher',['jquery','sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/chart/morph/vo/VizShapesHolder','sap/viz/controls/chart/morph/viz/MpShapesCapturer','sap/viz/controls/chart/morph/viz/MpShapesMapper','sap/viz/controls/chart/morph/morphers/ColorMorpher','sap/viz/controls/chart/morph/morphers/RectMorpher','sap/viz/controls/chart/morph/morphers/LineMorpher','sap/viz/controls/chart/morph/morphers/PathMorpher','sap/viz/controls/chart/morph/morphers/TextMorpher','sap/viz/controls/chart/morph/morphers/TransformMorpher'],function($,M,a,S,V,b,c,d,C,R,L,P,T,e){var f=function(v,l){this._vizDiv=v;this._morphDiv=l;this._currentVizType="";this._currentVizShapesHolder=new b();this._tween=null;};f.prototype.resetMorphSvg=function(){var v=h(this._vizDiv);var l=v.width();var n=v.height();var o=h(this._morphDiv);o.empty();var q=h(document.createElement("DIV"));q.css("overflow","hidden").appendTo(o).width(l).height(n);var r=v.find("svg");if(r.length>0){q.attr("class","vc-morph-svg-host "+r.parent().attr("class"));}return d3.select(q.get(0)).append("svg").attr("width",l).attr("height",n).node();};f.prototype.getCurrentVizType=function(){return this._currentVizType;};f.prototype.isPlaying=function(){return(this._tween!==null);};f.prototype.showMorphing=function(l,v){var n=h(this._morphDiv);var o=h(this._vizDiv);if(l){n.css("display","");}else{n.css("display","none");}if(v){o.css("visibility","visible");}else{o.css("visibility","hidden");}};f.prototype.morphVizType=function(n,l,o){l=a.isNumber(l)?l:1000;n=a.isString(n)?n:this.getCurrentVizType();var v=h(this._vizDiv);var q=h(this._morphDiv);if(this._tween){this._tween.stop(true,false);this._tween=null;v.css("visibility","visible");q.css("display","none");}var r=c.getShapes(v.get(0));var s=g(r);var t=(s&&l>0);if(s){d.map(r,this._currentVizShapesHolder,n,this._currentVizType);var w=r.allByOrder();var x=this.resetMorphSvg();if(t){v.css("visibility","hidden");q.css("display","");p(x,w,0);var y=this;this._startMorphShapes(w,l,function(){v.css("visibility","visible");q.css("display","none");if(y._tween){y._tween.stop(true,false);}y._tween=null;if(a.isFunction(o)){o.call(null);}});}else{p(x,w,100);this._tween=null;v.css("visibility","visible");q.css("display","none");if(a.isFunction(o)){o.call(null);}}}else{r.empty();this.resetMorphSvg();this._tween=null;v.css("visibility","visible");q.css("display","none");if(a.isFunction(o)){o.call(null);}}this._currentVizType=n;this._currentVizShapesHolder=r;};var g=function(n){var t=n.toShapesBySvgType();if(t["all"].length>n.backgrounds.length){if(t["path"]&&t["path"].length>200){return false;}if(t["rect"]&&t["rect"].length>300){return false;}if(t["all"].length>400){return false;}return true;}return false;};f.prototype._startMorphShapes=function(v,l,n){this._tween=$({percentage:1});this._tween.animate({percentage:100},{duration:l,easing:"swing",step:function(){var o=this.percentage;m(v,o);},complete:function(){n();}});};var h=function(l){if(a.isString(l)){if(l.indexOf("#")!==0){return $("#"+l);}}return $(l);};var p=function(s,v,l){l=l?l:0;for(var i=0;i<v.length;i++){var n=v[i];var o=n.from;var t=n.to;if(t){var q=n.display=t.cloneNode(true);S.clone(q,t);if(l!==100){k(o,t,q,l);}s.appendChild(q);}}};var m=function(v,l){for(var i=0;i<v.length;i++){var n=v[i];var o=n.from;var t=n.to;var q=n.display;k(o,t,q,l);}};var k=function(l,t,n,o){R.svg(l,t,n,o);L.svg(l,t,n,o);P.svg(l,t,n,o);C.svg(l,t,n,o);T.svg(l,t,n,o);e.svg(l,t,n,o);};f.prototype.testDrawShapes=function(n,l){var v=h(this._vizDiv);var o=h(this._morphDiv);var q=c.getShapes(v.get(0));d.map(q,this._currentVizShapesHolder,n,this._currentVizType);var r=q.allByOrder();var s=this.resetMorphSvg();p(s,r,l);this._currentVizType=n;this._currentVizShapesHolder=q;};return f;});u('sap/viz/controls/chart/views/PropertyZone',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function($,C,O,E,a){var P=function(t,z){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=z;this._selectedZone$=null;var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=$(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr('style',s);};O.extend(P,a);P.SELECT_ZONE='SELECT_ZONE_EVENT';P.prototype._createZones=function(){this._targetRect=this._targetDiv.getBoundingClientRect();var s="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr('style',s);var z=this._zoneProvider();for(var i=0;i<z.length;i++){var b=z[i].bound;for(var n=0;n<b.length;n++){this._createZone(this._dom[0],b[n],z[i].name);}}};P.prototype._createZone=function(p,b,z){var d=$(document.createElement("DIV"));var l=b[0][0],t=b[0][1],w=b[2][0]-b[0][0],h=b[2][1]-b[0][1];var s="left:"+l+"px;top:"+t+"px;width:"+w+"px;height:"+h+"px;";d.attr('style',s).addClass(C.CHART_PREFIX+'property-zone').appendTo(p);d.get(0).__name=z;d.click($.proxy(this._selectZone,this));};P.prototype._selectZone=function(e){var c=$(e.target);if(this._selectedZone$!==c){if(this._selectedZone$){this._selectedZone$.removeClass(C.CHART_PREFIX+'property-zone-selected');}this._selectedZone$=c;this._selectedZone$.addClass(C.CHART_PREFIX+'property-zone-selected');var b={'propertyZoneName':this._selectedZone$.get(0).__name};this._dispatchEvent(new E(P.SELECT_ZONE,this,b));}};P.prototype.updateZone=function(e){if(e){this._createZones();this._dom.css('visibility','');}else{this._dom.css('visibility','hidden');}};P.prototype.size=function(s){if(s){this._dom.css({width:s.width+"px",height:s.height+"px"});}};return P;});u("sap/viz/controls/LanguageLoader",[],function(){sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_COMMON_BAR_TEXT:"Bar Chart",VIZ_COMMON_COLUMN_TEXT:"Column Chart",VIZ_COMMON_STACKED_BAR_TEXT:"Stacked Bar Chart",VIZ_COMMON_STACKED_COLUMN_TEXT:"Stacked Column Chart",VIZ_COMMON_DUAL_BAR_TEXT:"Bar Chart With 2 Y-Axes",VIZ_COMMON_DUAL_COLUMN_TEXT:"Column Chart With 2 Y-Axes",VIZ_COMMON_3D_BAR_TEXT:"3D Bar Chart",VIZ_COMMON_3D_COLUMN_TEXT:"3D Column Chart",VIZ_COMMON_LINE_TEXT:"Line Chart",VIZ_COMMON_AREA_TEXT:"Area Chart",VIZ_COMMON_COMBINATION_TEXT:"Combined Column Line Chart",VIZ_COMMON_DUAL_LINE_TEXT:"Line Chart With 2 Y-Axes",VIZ_COMMON_DUAL_COMBINATION_TEXT:"Combined Column Line Chart With 2 Y-Axes",VIZ_COMMON_PIE_TEXT:"Pie Chart",VIZ_COMMON_DONUT_TEXT:"Donut Chart",VIZ_COMMON_PIE_WITH_DEPTH_TEXT:"Pie With Variable Slice Depth",VIZ_COMMON_GEOBUBBLE_TEXT:"Geographic Bubble Chart",VIZ_COMMON_CHOROPLETH_TEXT:"Geo Choropleth Chart",VIZ_COMMON_GEOPIE_TEXT:"Geo Pie Chart",VIZ_COMMON_GEOMAP_TEXT:"Geo Map",VIZ_COMMON_SCATTER_TEXT:"Scatter Plot",VIZ_COMMON_BUBBLE_TEXT:"Bubble Chart",VIZ_COMMON_SCATTER_MATRIX_TEXT:"Scatter Matrix Chart",VIZ_COMMON_TREEMAP_TEXT:"Tree Map",VIZ_COMMON_HEATMAP_TEXT:"Heat Map",VIZ_COMMON_TABLE_TEXT:"Table",VIZ_COMMON_CROSSTAB_TEXT:"Crosstab",VIZ_COMMON_RADAR_TEXT:"Radar Chart",VIZ_COMMON_BOXPLOT_TEXT:"Box Plot",VIZ_COMMON_WATERFALL_TEXT:"Waterfall Chart",VIZ_COMMON_TAGCLOUD_TEXT:"Tag Cloud",VIZ_COMMON_MEASURES:"MEASURES",VIZ_COMMON_DIMENSIONS:"DIMENSIONS",VIZ_COMMON_SUBTOTALS:"SUBTOTALS",VIZ_COMMON_ANIMATION:"Animation",VIZ_COMMON_TRELLIS:"TRELLIS",VIZ_COMMON_XAXIS:"X Axis",VIZ_COMMON_YAXIS:"Y Axis",VIZ_COMMON_PRIMARY_YAXIS:"Y Axis1",VIZ_COMMON_SECONDARY_YAXIS:"Y Axis2",VIZ_COMMON_PRIMARY_XAXIS:"X Axis1",VIZ_COMMON_SECONDARY_XAXIS:"X Axis2",VIZ_COMMON_PIE_SECTORS:"Pie Sectors",VIZ_COMMON_PIE_DEPTH:"Pie Depth",VIZ_COMMON_FEATUREVALUES:"Value",VIZ_COMMON_BUBBLE_WIDTH:"Bubble Width",VIZ_COMMON_BUBBLE_HEIGHT:"Bubble Height",VIZ_COMMON_RECTANGLECOLOR:"Area Color",VIZ_COMMON_RECTANGLEWEIGHT:"Area Weight",VIZ_COMMON_REGIONCOLOR:"Legend Color",VIZ_COMMON_GEO_FEATURES:"Geography",VIZ_COMMON_GEO_COLOR:"Color",VIZ_COMMON_FEATUREANALYSIS:"Overlay Data",VIZ_COMMON_REGIONSHAPE:"Legend Shape",VIZ_COMMON_AREANAME:"Area Name",VIZ_COMMON_SECONDARY_AREANAME:"Area Name2",VIZ_COMMON_RADAR_AXES:"Radar Branches",VIZ_COMMON_TAGWEIGHT:"Word Weight",VIZ_COMMON_TAGFAMILY:"Word Color",VIZ_COMMON_TAGNAME:"Word",VIZ_COMMON_COLUMNS:"Columns",VIZ_COMMON_ROWS:"Rows",VIZ_COMMON_TABLE_DIMENSION:"Rows Axis",VIZ_COMMON_TABLE_MEASURE:"Primary Values",VIZ_COMMON_TABLE_ROWS_SUBTOTALS:"Rows Subtotals",VIZ_COMMON_TABLE_COLUMNS_AXIS:"Columns Axis",VIZ_COMMON_TABLE_COLUMNS_SUBTOTALS:"Columns Subtotals",VIZ_COMMON_LEGEND:"Legend",VIZ_COMMON_DIMENSION_LIMITATION_WARN:"You have reached the maximum number of dimension feeds for this visualization.",VIZ_COMMON_CHANGE_CALCULATION:"Change Calculation",VIZ_COMMON_SUM:"Sum",VIZ_COMMON_AVERAGE:"Average",VIZ_COMMON_MIN:"Min",VIZ_COMMON_MAX:"Max",VIZ_COMMON_COUNT_DISTINCT:"Count-Distinct",VIZ_COMMON_COUNT_ALL:"Count-All",VIZ_COMMON_NONE:"None",VIZ_COMMON_SUM_SHORT:"(Sum)",VIZ_COMMON_AVERAGE_SHORT:"(Avg)",VIZ_COMMON_MIN_SHORT:"(Min)",VIZ_COMMON_MAX_SHORT:"(Max)",VIZ_COMMON_COUNT_DISTINCT_SHORT:"(Cnt-Dis)",VIZ_COMMON_COUNT_ALL_SHORT:"(Cnt-All)",VIZ_COMMON_NONE_SHORT:"(None)",VIZ_COMMON_TOTAL_OF:"Total of",VIZ_COMMON_SUM_OF:"Sum of",VIZ_COMMON_AVERAGE_OF:"Average of",VIZ_COMMON_COUNT_OF:"Count of",VIZ_COMMON_MIN_OF:"Minimum of",VIZ_COMMON_MAX_OF:"Maximum of",VIZ_COMMON_EDIT:"Edit",VIZ_COMMON_DELETE:"Delete",VIZ_COMMON_DELETE_COMMENT_MESSAGE:"Are you sure to delete the comment?",VIZ_COMMON_DONT_SHOW_MESSAGE:"Don't show this again",VIZ_COMMON_OK:"OK",VIZ_COMMON_CANCEL:"Cancel",VIZ_COMMON_BETWEEN:"BETWEEN",VIZ_COMMON_SEARCH:"Search",VIZ_COMMON_FAKE_DIMENSION:"Fake Dimension",VIZ_COMMON_FAKE_MEASURE:"Fake Measure",VIZ_COMMON_SERIALIZATION_FAILED:"Serialization error",VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE:"Invalid serialization package",VIZ_COMMON_DEPENDENCY_ERROR:"Please include {0} when use {1}.",VIZ_COMMON_DEPENDENCY_ERROR_WITH_UI_CONFIG:"Please include {0} when use {1} with {2}.",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_BUILDER_CHART:"TYPE:",VIZ_BUILDER_BUILD:"Build",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_ANNOTATION_COMMENT:"Comment",}});sap.viz.extapi.env.Language.register({id:'dev',value:{}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CHART_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more measures or dimensions.",VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more geography dimensions.",VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more measures.",VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more dimensions.",VIZ_CHART_CREATE_CHART_FAILED:"Failed to create chart:",VIZ_CHART_UPDATE_CHART_FAILED:"Failed to update chart:",VIZ_CHART_UPDATE_DATA_FAILED:"Failed to update chart data:",VIZ_CHART_UPDATE_FEEDING_FAILED:"Failed to update chart feeding:",VIZ_CHART_UPDATE_CSS_FAILED:"Failed to update chart css:",VIZ_CHART_UPDATE_PROPERTIES_FAILED:"Failed to update chart properties:",VIZ_CHART_ADD_EVENT_FAILED:"Failed to add chart event callback:",VIZ_CHART_REMOVE_EVENT_FAILED:"Failed to remove chart event callback:",VIZ_CHART_SELECTION_FAILED:"Failed to get/set chart selection:",VIZ_CHART_FEEDINGZONE_FAILED:"Failed to get chart feedingzone:",VIZ_CHART_DESCRIPTION_FAILED:"Failed to get/set chart description:",VIZ_CHART_TRIGGER_ACTION_FAILED:"Failed to trigger chart action:",VIZ_CHART_SERIALIZE_FAILED:"Failed to serialize chart:",VIZ_CHART_VIZINSTANCE_NOT_CREATED:"VizInstance is not created.",VIZ_CHART_INVALID_VIZ_TYPE:"Cannot display this chart: {0}.",VIZ_CHART_TRELLIS_DISABLED_WARN:"The trellis is disabled in either Viz Frame or Feeding Panel.",VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER:"No data matches your filter(s)",VIZ_CHART_NEGATIVE_VALUES_WARN:"Negative values are not shown in this Bubble chart",VIZ_CHART_NEGATIVE_VALUES_INFO:"To display negative values, click the Settings button and select Show Negative Values from the contextual menu.",VIZ_CHART_TITLE_TEXT_JOIN_BY:"{0} by {1}",VIZ_CHART_TITLE_TEXT_JOIN_AND:"and",VIZ_CHART_TITLE_CONTEXT_MENU_EDIT:"Rename",VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE:"Restore Default Title",VIZ_CONTROLS_API_PARAMETER_ERROR:"API parameter error.",VIZ_CHART_EXPORTSVG_FAILED:"Failed to export to svg string.",VIZ_CHART_SET_AXIS_RANGE:"Set axis range",VIZ_CHART_AXIS_ZOOM:"Zoom",VIZ_CHART_XAXIS_RANGE:"X Axis Range",VIZ_CHART_XAXIS1_RANGE:"X Axis1 Range",VIZ_CHART_XAXIS2_RANGE:"X Axis2 Range",VIZ_CHART_YAXIS_RANGE:"Y Axis Range",VIZ_CHART_YAXIS1_RANGE:"Y Axis1 Range",VIZ_CHART_YAXIS2_RANGE:"Y Axis2 Range",VIZ_CHART_AUTO_RANGE:"Automatic",VIZ_CHART_FIXED_RANGE:"Fixed",VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE:"Import Esri Custom Service",VIZ_CHART_NEXT:"Next",VIZ_CHART_SELECT_DATASET:"Select data set",VIZ_CHART_SET_COLOR_LAYER:"Set color to feature layer",VIZ_CHART_RESET:"Reset",VIZ_CHART_SEGMENTED:"Segmented",VIZ_CHART_GRADIENT:"Gradient",VIZ_CHART_BACK:"Back",VIZ_CHART_CONFIRM:"Confirm",VIZ_CHART_ESRI_MAP_LOADING:"Loading Esri Map",VIZ_CHART_ESRI_MAP_LOG_ON:"Logging in to Esri now",VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL:"Esri Authentication Fail",VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE:"An unknown error has occurred while accessing ESRI online services. Check your internet connection",VIZ_CHART_START:"Start",VIZ_CHART_END:"End",VIZ_CHART_NO_ESRI_SERVICE:"No feature service found under your account.",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CONTEXTMENU_SHOW_LEGEND:"Show Legend",VIZ_CONTEXTMENU_SHOW_DATALABELS:"Show Data Labels",VIZ_CONTEXTMENU_NORMAL_STACKING:"Normal Stacking",VIZ_CONTEXTMENU_FULL_STACKING:"100% Stacking",VIZ_CONTEXTMENU_HORIZONTAL:"Horizontal",VIZ_CONTEXTMENU_VERTICAL:"Vertical",VIZ_CONTEXTMENU_INSERT_COMMENT:"Insert Comment...",VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR:"Choose Legend Item Colors...",VIZ_CONTEXTMENU_MENU_CHART_EDITOR:"Chart Editor...",VIZ_CONTEXTMENU_SHOW_MND:"Use Measures as a Dimension",VIZ_CONTEXTMENU_SHOW_MND_TOOLTIP:"Creates a new dimension with all the measures in the chart. The values are spread on a single axis, or separate charts for a trellis chart.",VIZ_CONTEXTMENU_NO_MENU_ITEMS:"No available items",VIZ_CONTEXTMENU_SHOW_TITLE:"Show Title",VIZ_CONTEXTMENU_SET_AXIS_SCALE:"Set Axis Scale",VIZ_CONTEXTMENU_SHOW_NEGATIVE_VALUES:"Show Negative Values",VIZ_CONTEXTMENU_CREATE_SUBTOTALS:"Create Subtotals",VIZ_CONTEXTMENU_SHOW_BEFORE_ROWS:"Show Subtotals Below Rows",VIZ_CONTEXTMENU_SHOW_ABOVE_ROWS:"Show Subtotals Above Rows",VIZ_CONTEXTMENU_CALCULATE_ROWS_TOTALS_FIRST:"Calculate Rows Totals First",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_CUSTOMBUTTON_SETTINGS:"Settings",VIZ_CUSTOMBUTTON_MAXIMIZE:"Maximize",VIZ_CUSTOMBUTTON_RESTORE_DOWN:"Restore Down",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_FRAME_FILTERMENU_FILTER:"Filter",VIZ_FRAME_FILTERMENU_EXCLUDE:"Exclude",VIZ_FRAME_FILTERBAR_DESCRIPTION:"Select fields from the Data Set to filter.",VIZ_FRAME_CHART_EDITOR:"Chart Editor",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_MAPBUILDER_VIZ_LAYER_NAME:"Layer",VIZ_MAPBUILDER_BASE_MAP_NAME:"base map",VIZ_MAPBUILDER_ADD_NEW_LAYER:"Add Layer",VIZ_MAPBUILDER_RENAME:"Rename",VIZ_MAPBUILDER_DELETE:"Delete layer",VIZ_MAPBUILDER_HIDE:"Hide",VIZ_MAPBUILDER_SHOW:"Show",VIZ_MAPBUILDER_MOVEUP:"Move up",VIZ_MAPBUILDER_MOVEDOWN:"Move down",VIZ_MAPBUILDER_DELETE_GEO_LAYER:"Delete Geo Layer",VIZ_MAPBUILDER_OK:"Ok",VIZ_MAPBUILDER_CANCEL:"Cancel",VIZ_MAPBUILDER_DATA_POINTS:"Data Point Type",VIZ_MAPBUILDER_CHOROPLETH:"choropleth",VIZ_MAPBUILDER_BUBBLE:"bubble",VIZ_MAPBUILDER_MARKER:"marker",VIZ_MAPBUILDER_TYPE:"type",VIZ_MAPBUILDER_GEO:"Geo Dimension",VIZ_MAPBUILDER_GEO_LOCATION:"Geo Location",VIZ_MAPBUILDER_GEO_COLOR:"Color",VIZ_MAPBUILDER_GEO_SIZE:"Size",VIZ_MAPBUILDER_MEASURES:"Color",VIZ_MAPBUILDER_PROPERTIES:"PROPERTIES",VIZ_MAPBUILDER_SHOW_LEGEND:"show legend",VIZ_MAPBUILDER_MARKER_CLUSTER:"Cluster adjacent markers",VIZ_MAPBUILDER_BUBBLE_CLUSTER:"Cluster adjacent bubbles",VIZ_MAPBUILDER_MAP:"MAP",VIZ_MAPBUILDER_PROVIDERS:"Providers",VIZ_MAPBUILDER_STYLES:"STYLES",VIZ_MAPBUILDER_ESRI_MAP_STYLE_MAP:"Map",VIZ_MAPBUILDER_ESRI_MAP_STYLE_SATELLITE:"Satellite",VIZ_MAPBUILDER_ESRI_MAP_STYLE_TERRAIN:"Terrain",VIZ_MAPBUILDER_ESRI_MAP_STYLE_STREETS:"Streets",VIZ_MAPBUILDER_NOT_SUPPORT_ERROR:"Not Support Yet.",VIZ_MAPBUILDER_IMPORT_ESRI_CUSTOM_SERVICE:"Import Esri Custom Service",VIZ_MAPBUILDER_ESRI_CUSTOM_SERVICE:"Esri Custom Service",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_FILTERBAR_ADD_FILTERS:"Add filters.",VIZ_FILTERBAR_CLEAR_FILTERS:"Clear filters",VIZ_FILTERBAR_READONLY_FILTER:"Read-only filter",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_FILTERBAR_DESCRIPTION:"Add filters.",VIZ_FILTERBAR_GLOBAL_FILTER:"Global Filter:",VIZ_FILTERBAR_ITEMS_EXCLUDED:"items excluded",VIZ_FILTERBAR_ITEMS_INCLUDED:"items included",}});sap.viz.extapi.env.Language.register({id:'dev',value:{}});sap.viz.extapi.env.Language.register({id:'dev',value:{PROPERTY_EDITOR_TITLE_PLACE_HOLDER:"Properties",PROPERTY_EDITOR_TITLE_PREFIX:"Properties of {0}",PROPERTY_EDITOR_GENERAL:"General",PROPERTY_EDITOR_SHOW_LEGEND:"Show Legend",PROPERTY_EDITOR_XAXIS:"X Axis",PROPERTY_EDITOR_SHOW_AXIS:"Show Axis",PROPERTY_EDITOR_SHOW_AXIS_TITLE:"Show Axis Title",PROPERTY_EDITOR_SHOW_AXIS_LABEL:"Show Axis Labels",PROPERTY_EDITOR_XAXIS2:"Secondary X Axis",PROPERTY_EDITOR_YAXIS:"Y Axis",PROPERTY_EDITOR_YAXIS2:"Secondary Y Axis",PROPERTY_EDITOR_ZAXIS:"Z Axis",PROPERTY_EDITOR_VALUE_AXIS:"Value Axis",PROPERTY_EDITOR_POLAR_AXIS:"Polar Axis",PROPERTY_EDITOR_ROW_AXIS:"Row Axis",PROPERTY_EDITOR_COLUMN_AXIS:"Column Axis",PROPERTY_EDITOR_SHOW_AXIS_LINE:"Show Axis Line and Ticker",PROPERTY_EDITOR_SHOW_AXIS_IMAGE:"Show Axis Pictograms",PROPERTY_EDITOR_SIZE_OF_ALL_IMAGES:"Size of All Pictograms",PROPERTY_EDITOR_HEIGHT_OF_AXIS_AREA:"Height of Axis Area",PROPERTY_EDITOR_WIDTH_OF_AXIS_AREA:"Width of Axis Area",PROPERTY_EDITOR_SHAPE_STYLE:"Shape Style",PROPERTY_EDITOR_BACKGROUND_COLOR:"Background Color",PROPERTY_EDITOR_POSITION:"Position",PROPERTY_EDITOR_POSITION_OUTSIDE_END:"Outside End",PROPERTY_EDITOR_POSITION_INSIDE_END:"Inside End",PROPERTY_EDITOR_POSITION_CENTER:"Center",PROPERTY_EDITOR_CHART_AREA:"Chart Area",PROPERTY_EDITOR_CHART_TITLE:"Chart Title",PROPERTY_EDITOR_PLOT_AREA:"Plot Area",PROPERTY_EDITOR_GRID_LINE:"Gridline",PROPERTY_EDITOR_LEGEND:"Legend",PROPERTY_EDITOR_HORIZONTAL_AXIS:"Horizontal Axis",PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE:"Horizontal Axis Title",PROPERTY_EDITOR_VERTICAL_AXIS:"Vertical Axis",PROPERTY_EDITOR_VERTICAL_AXIS_TITLE:"Vertical Axis Title",PROPERTY_EDITOR_COLUMN_DATA_POINT:"Column",PROPERTY_EDITOR_BAR_DATA_POINT:"Bar",PROPERTY_EDITOR_SERIES:"Series",PROPERTY_EDITOR_MARKER:"Marker",PROPERTY_EDITOR_DATA_LABELS:"Data Labels",PROPERTY_EDITOR_DATA_LABEL:"Data Label",PROPERTY_EDITOR_DONUT_INNER_CIRCLE:"Inner Circle",PROPERTY_EDITOR_DONUT_DATA_POINT:"Slice",PROPERTY_EDITOR_DONUT_DATA_POINT_SLICE_COLOR:"Slice Color",PROPERTY_EDITOR_DONUT_DATA_POINT_HIGHLIGHT:"Highlight the Slice",PROPERTY_EDITOR_DONUT_DATA_POINT_SHOW_NAME:"Show Name",PROPERTY_EDITOR_DONUT_DATA_POINT_SHOW_PERCENTAGE:"Show Percentage",PROPERTY_EDITOR_DONUT_DATA_POINT_OTHER_SLICE_COLOR:"Other Slices' Color",PROPERTY_EDITOR_LINE:"Line",PROPERTY_EDITOR_SHOW_CHART_TITLE:"Show Chart Title",PROPERTY_EDITOR_SHOW_DATA_LABEL:"Show Data Labels",PROPERTY_EDITOR_SHOW_DATA_LABEL_IMAGE:"Show Data Label Pictograms",PROPERTY_EDITOR_DATA_LABEL_IMAGE_SIZE:"Size of All Pictograms",PROPERTY_EDITOR_VALUE_AXIS_MAX_VALUE:"Value Axis Maximum",PROPERTY_EDITOR_SHOW_LEGEND_TITLE:"Show Legend Title",PROPERTY_EDITOR_SHOW_GRIDLINE:"Show Gridlines",PROPERTY_EDITOR_THICKNESS:"Thickness",PROPERTY_EDITOR_COLOR:"Color",PROPERTY_EDITOR_COLORPICKER_MORE:"More...",PROPERTY_EDITOR_COLORPICKER_NOCOLOR:"No Color",PROPERTY_EDITOR_COLORPICKER_RECENTCOLORS:"Recent Colors",PROPERTY_EDITOR_MARKER_SHAPE:"Marker Pictogram",PROPERTY_EDITOR_SIZE_OF_ALL_MARKERS:"Size of All Markers",PROPERTY_EDITOR_TITLE_POSITION:"Position",PROPERTY_EDITOR_TITLE_POSITION_TOP:"Top",PROPERTY_EDITOR_TITLE_POSITION_BOTTOM:"Bottom",PROPERTY_EDITOR_LINE_LINE_COLOR:"Line Color",PROPERTY_EDITOR_LINE_LINE_THICKNESS:"Line Thickness",PROPERTY_EDITOR_LINE_LINE_STYLE:"Line Style",PROPERTY_EDITOR_HEIGHT:"Height",PROPERTY_EDITOR_WIDTH:"Width",PROPERTY_EDITOR_LAYOUT:"Layout",PROPERTY_EDITOR_CLASSIC_LAYOUT:"Classic Layout",PROPERTY_EDITOR_LEAN_LAYOUT:"Lean Layout",FORMAT_PICKER_DECIMAL:"Decimal Places",FORMAT_PICKER_DISPLAY_NUMBER:"Display As Number",FORMAT_PICKER_DISPLAY_PERCENT:"Display As Percentage",FORMAT_PICKER_SHOW_SEP:"Show 1000 Separator (,)",FORMAT_PICKER_SHOW_BY_UNIT:"Show by KMBT",FORMAT_PICKER_UNIT_AUTO:"Auto",FORMAT_PICKER_UNIT_K:"K",FORMAT_PICKER_UNIT_M:"M",FORMAT_PICKER_UNIT_B:"B",FORMAT_PICKER_UNIT_T:"T",NUMBERCHART_SHOW_TITLE:"Show Title",NUMBERCHART_TITLE_NAME:"Title",NUMBERCHART_VALUE_NAME:"Value",PROPERTY_EDITOR_PSPICKER_PREFIX:"Prefix",PROPERTY_EDITOR_PSPICKER_SUFFIX:"Suffix",PROPERTY_EDITOR_AXIS_VALUE_SCALE:"Axis Value Scale",}});sap.viz.extapi.env.Language.register({id:'dev',value:{VIZ_SWITCHBAR_BAR_COLUMN_CHARTS:"Bar & Column Charts",VIZ_SWITCHBAR_COLUMN_CHARTS:"Column Charts",VIZ_SWITCHBAR_LINE_CHARTS:"Line Charts",VIZ_SWITCHBAR_PIE_CHARTS:"Pie Charts",VIZ_SWITCHBAR_GEO_CHARTS:"Geographic Charts",VIZ_SWITCHBAR_SCATTER_CHARTS:"Scatter Charts",VIZ_SWITCHBAR_MAP_CHARTS:"Map Charts",VIZ_SWITCHBAR_TABLES:"Tables",VIZ_SWITCHBAR_OTHER_CHARTS:"Other Charts",VIZ_SWITCHBAR_NUMBER_CHARTS:"Point Charts",}});sap.viz.extapi.env.Language.register({id:'dev',value:{}});sap.viz.extapi.env.Language.register({id:'dev',value:{}});});u("sap/viz/controls/TemplateLoader",[],function(){(function(){var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var c={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var f={dataLoading:false,dataUpdating:false,resizing:false};var m={color:a,gridline:{color:a},enableLabelSelection:false};var g={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var h={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var k={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},zAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c,rotate:{enableRotate:false}};var l={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},zAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c,rotate:{enableRotate:false}};var n={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var o={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var p={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{marker:{visible:false},animation:f,tooltipVisble:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var q={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{marker:{visible:false},animation:f},rowAxis:m,columnAxis:m,background:b,interaction:c};var r={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{line:{marker:{visible:false}},tooltipVisble:false,animation:f},rowAxis:m,columnAxis:m,background:b,interaction:c};var s={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{line:{marker:{visible:false}},animation:f},rowAxis:m,columnAxis:m,background:b,interaction:c};var t={xAxis:{color:a,label:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},sizeLegend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var v={xAxis:{color:a,label:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var w={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},gridline:{visible:false,},enableLabelSelection:false},plotArea:{animation:f},multiLayout:{plotTitle:{visible:false},},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:c};var x={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:c};var y={plotArea:{animation:f},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:c};var z={plotArea:{animation:f},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:c};var C={plotArea:{animation:f},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var D={plotArea:{animation:f},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var E={plotArea:{animation:f},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c,rotate:{enableRotate:false}};var F={plotArea:{animation:f},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c,rotate:{enableRotate:false}};var G={title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{polarAxis:{title:{visible:false}},valueAxis:{visible:true,},animation:f},rowAxis:m,columnAxis:m,background:b,interaction:c};var H={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var I={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var J={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var K={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var L={yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},xAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var M={xAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},plotArea:{animation:f},yAxis:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},yAxis2:{color:a,label:{visible:true,},axisline:{visible:true,},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:m,columnAxis:m,background:b,interaction:c};var N={plotArea:{animation:f,draggable:false,label:{visible:false}},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:c};var O={plotArea:{animation:f,clickAble:false,label:{visible:false}},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:b,interaction:c};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",name:"Incomplete Ghost",version:"4.0.0",properties:{'viz/bar':h,'viz/image_bar':h,'viz/multi_bar':h,'viz/dual_bar':h,'viz/multi_dual_bar':h,'viz/column':g,'viz/multi_column':g,'viz/dual_column':g,'viz/multi_dual_column':g,'viz/stacked_bar':n,'viz/multi_stacked_bar':n,'viz/dual_stacked_bar':n,'viz/multi_dual_stacked_bar':n,'viz/100_stacked_bar':n,'viz/multi_100_stacked_bar':n,'viz/100_dual_stacked_bar':n,'viz/multi_100_dual_stacked_bar':n,'viz/stacked_column':o,'viz/multi_stacked_column':o,'viz/dual_stacked_column':o,'viz/multi_dual_stacked_column':o,'viz/100_stacked_column':o,'viz/multi_100_stacked_column':o,'viz/100_dual_stacked_column':o,'viz/multi_100_dual_stacked_column':o,'riv/cbar':g,'viz/stacked_column':o,'viz/multi_stacked_column':o,'viz/3d_bar':k,'viz/3d_column':l,'viz/combination':s,'viz/horizontal_combination':r,'viz/dual_combination':s,'viz/dual_horizontal_combination':r,'viz/boxplot':H,'viz/horizontal_boxplot':I,'viz/waterfall':J,'viz/horizontal_waterfall':K,'viz/stacked_waterfall':J,'viz/horizontal_stacked_waterfall':K,'viz/line':q,'viz/multi_line':q,'viz/dual_line':q,'viz/multi_dual_line':q,'viz/horizontal_line':p,'viz/multi_horizontal_line':p,'viz/dual_horizontal_line':p,'viz/multi_dual_horizontal_line':p,'viz/area':q,'viz/multi_area':q,'viz/100_area':q,'viz/multi_100_area':q,'viz/horizontal_area':p,'viz/multi_horizontal_area':p,'viz/100_horizontal_area':p,'viz/multi_100_horizontal_area':p,'viz/pie':C,'viz/multi_pie':C,'viz/donut':D,'viz/multi_donut':D,'viz/pie_with_depth':E,'viz/donut_with_depth':F,'viz/bubble':t,'viz/multi_bubble':t,'viz/scatter':v,'viz/multi_scatter':v,'viz/scatter_matrix':w,'viz/radar':G,'viz/multi_radar':G,'viz/tagcloud':z,'viz/heatmap':x,'viz/treemap':y,'viz/mekko':L,'viz/100_mekko':L,'viz/horizontal_mekko':M,'viz/100_horizontal_mekko':M,'viz/network':N,'viz/tree':O,'viz/number':{plotArea:{valuePoint:{label:{fontColor:'#000000'}}}}}});})();(function(){var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var c={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false};var f={dataLoading:false,dataUpdating:false};var m={color:a,gridline:{color:a},label:{visible:false}};var g={plotArea:{animation:f},title:{visible:false},legend:{visible:false},sizeLegend:{visible:false},background:b,interaction:c,rowAxis:m,columnAxis:m,geoController:{disableInteraction:true}};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{'viz/geobubble':g,'viz/geopie':g,'viz/choropleth':g,'viz/multi_geobubble':g,'viz/multi_choropleth':g}});})();var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var c={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var d={title:{visible:false},legend:{visible:false},background:b,interaction:c};var e={title:{visible:false},legend:{visible:false},background:b};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{"viz/ext/pa/funnel":d,"viz/ext/pa/pc":e},css:"		.v-m-main .v-background-body{fill:;}		 svg {font-family:Tahoma,Arial,Helvetica,sans-serif;font-size:12px;}		.axis line{fill: none;stroke: #333333;shape-rendering: crispEdges;}	    .axis path{fill: none;stroke: #333333;shape-rendering: crispEdges;}	   .axistext{fill: #333333; cursor : move;}	",});var a="#333333";var b={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var c={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var d={title:{visible:false},legend:{visible:false},background:b,interaction:c};var e={title:{visible:false},legend:{visible:false},background:b};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{"viz/ext/pa/funnel":d,"viz/ext/pa/pc":e},css:"		.v-m-main .v-background-body{fill:;}		 svg {font-family:Tahoma,Arial,Helvetica,sans-serif;font-size:12px;}		.axis line{fill: none;stroke: #333333;shape-rendering: crispEdges;}	    .axis path{fill: none;stroke: #333333;shape-rendering: crispEdges;}	   .axistext{fill: #333333; cursor : move;}	",});});u('sap/viz/controls/chart/views/WarningView',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/LangManager',],function($,O,V,U,C,a,E,L){var N=function(d,b){N.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.NegativeValuesView";this._createChildren();};O.extend(N,U);N.prototype._createChildren=function(){this._confirmDialog$=$(document.createElement('div'));this._confirmDialog$.addClass(a.CHART_PREFIX+'warning');this._container$=$(document.createElement('div'));$(document.createElement('div')).appendTo(this._container$).addClass(a.CHART_PREFIX+'warning-separator');var t=$(document.createElement('div')).appendTo(this._container$).addClass(a.CHART_PREFIX+'warning-title');var w=$(document.createElement('div')).appendTo(t);w.addClass(a.CHART_PREFIX+'warning-title-icon');var b=$(document.createElement('span')).appendTo(t).text(L.get("VIZ_CHART_NEGATIVE_VALUES_WARN"));b.addClass(a.CHART_PREFIX+'warning-title-text');var c=$(document.createElement('div')).appendTo(this._container$).addClass(a.CHART_PREFIX+'warning-info');var d=$(document.createElement('span')).appendTo(c).text(L.get("VIZ_CHART_NEGATIVE_VALUES_INFO"));d.addClass(a.CHART_PREFIX+'warning-info-text');var f=$(document.createElement('div')).appendTo(this._container$);f.addClass(a.CHART_PREFIX+'warning-delete-icon');f.addClass(a.COMMON_PREFIX+'UVBSharedSprite');f.click($.proxy(function(e){this.hide();},this));this._confirmDialog$.append(this._container$);this._blockLayout$=$(document.createElement('div'));this._blockLayout$.addClass(a.CHART_PREFIX+'block-layer');};N.prototype.show=function(t,p,b){this._visible=true;var l=this._dom$.offset().left+this._dom$.width()/2;var c=this._dom$.offset().top+this._dom$.height()/2;$(document.body).append(this._blockLayout$);$(document.body).append(this._confirmDialog$);this._confirmDialog$.css({position:"absolute",left:l-this._confirmDialog$.width()/2,top:c-this._confirmDialog$.height()/2});this._container$.css({"display":"block"});};N.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach();};return N;});u('sap/viz/controls/chart/views/View',['jquery','sap/viz/controls/LanguageLoader','sap/viz/controls/TemplateLoader','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/UIControl','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/DropZone','sap/viz/controls/chart/views/WarningView','sap/viz/controls/chart/ChartConfig','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalyticalType'],function($,L,T,G,C,M,F,b,c,O,d,f,D,g,V,h,U,k,l,W,m,I,n,o){var p=function(a,e,s,t,v){p.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.View";this._div=a;this._chartHolder$=null;this._chartLayer$=null;this._descriptionLayer$=null;this._loadingIcon$=null;this._chartModelProvider=t;this._helper=v;this._options=e;this._cssCache=null;this._libFolderPath=s;var w=sap.viz.api.env.Resource.path("sap.viz.geo.geographicInfo.localStorage.resourcePath");this._geoResourcePath=w?w:this._libFolderPath+"/sap.viz.geo/geocharts/resources/data/geo/";this._enableTrellis=true;this._enableMorphing=true;this._enablePropertyZone=false;this._hasChartInstance=false;this._size={width:p.DEFAULT_VIZ_WIDTH,height:p.DEFAULT_VIZ_HEIGHT};this._padding=24;this._chart=null;this._onEventMap={};this._isFeedsValid=false;this._templateId=p.TEMPLATE_DEFAULT;this._mouseDownHandler=$.proxy(function(x){if(document.activeElement&&document.activeElement.tagName&&document.activeElement.tagName.toLowerCase()!="body"&&!$.contains(this._dom$[0],document.activeElement)&&$.contains(this._dom$.parent()[0],x.target)){document.activeElement.blur();}},this);$(document).on('mousedown',this._mouseDownHandler);this._changeTemplateFunc=$.proxy(this.changeTemplate,this);sap.viz.extapi.env.Template.addListener(this._changeTemplateFunc);};O.extend(p,U);p.DEFAULT_VIZ_WIDTH=380;p.DEFAULT_VIZ_HEIGHT=280;p.TEMPLATE_DEFAULT="default";p.TEMPLATE_INCOMPLETE="incomplete_ghost";p.TEMPLATE_EMPTY="empty_ghost";p.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._createDescriptionLayer();this._createLoadingIcon();this._createWarningDialog();};p.prototype._createChartHolder=function(){this._chartHolder$=$(document.createElement('div')).addClass([h.PREFIX+'chart-holder',h.COMMON_PREFIX+'scrollable'].join(' '));this._chartHolder$.appendTo($(this._div));this._chartHolder$.css({position:'relative'});};p.prototype._createChartLayer=function(){this._chartLayer$=$(document.createElement('div')).addClass(h.PREFIX+'chart-layer');this._chartLayer$.appendTo(this._chartHolder$);this._chartLayer$.css({position:'absolute'});};p.prototype._createDescriptionLayer=function(){this._descriptionLayer$=$(document.createElement('div')).addClass(h.PREFIX+"chart-description");this._descriptionLayer$.css({position:'absolute',});this._descriptionLayer$.appendTo(this._chartHolder$);};p.prototype._createLoadingIcon=function(){this._loadingIcon$=$(document.createElement('div')).addClass(h.CHART_PREFIX+"loading-icon");this._loadingIcon$.appendTo(this._chartHolder$);this._loadingIcon$.css({width:this._chartHolder$.width()+"px",height:this._chartHolder$.height()+"px"});};p.prototype._createWarningDialog=function(){this._warningView=new W(this._chartHolder$.get(0),null);};p.prototype._showWarningDialog=function(){this._warningView.show();};p.prototype._createDropZone=function(){var a=this._chartLayer$;this._dropZone=new l(a.get(0),$.proxy(this._getFeedingZone,this),$.proxy(this._dropZoneFeedValidator,this));this._dropZone.addEventListener(l.DROP_ITEM_EVENT,this._dropItemHandler,this);};p.prototype._getFeedingZone=function(){if(!this._chart){return[];}try{return this._chart.feedingZone();}catch(e){return[];}};p.prototype._dropZoneFeedValidator=function(a,e,z){var s=this._chartModelProvider().explicitFeedingItems();var t=a.id===b.MultiplierFeedingName;if(t){var v=this._chartModelProvider().type();if(!f.isMultipleChart(v)&&f.supportMultiChart(v)){var w=f.toMultiChartType(v);var x=b.getManifestFeedsMap(w);var y=b.supportMultiChart(s,x);if(!y){return false;}}}return b.canAddFeed(s,a,e,z);};p.prototype._dropItemHandler=function(e){this._dispatchEvent(new k(k.ANALYSIS_DROPPED,this,e.data));};p.DISPATCH_PROPERTY_EVENT='dispatchPropertyEvent';p.prototype.modelChanged=function(a,e){};p.prototype._getMinSize=function(){return this._size;};p.prototype._setChartSize=function(w,a){if(this._chart){this._chart.size({width:w,height:a});}};p.prototype._updateChartSize=function(a){var e=this._getMinSize();var w=e.width;var s=e.height;var t={width:this._size.width+"px",height:this._size.height+"px",'overflow-x':e['overflow-x']||'','overflow-y':e['overflow-y']||''};if(a){this._setChartSize(w,s);}this._chartLayer$.css({width:w+"px",height:s+"px",visibility:"visible",display:''});this._chartHolder$.css(t);return e;};p.prototype.updateDescription=function(a){this._destroyChartInstance();this._updateDescription(a,true);};p.prototype._updateDescription=function(a,e){if(arguments.length<=0){var v=this._options.type;var s=this._options.feeding;if(!this._enableTrellis&&f.isMultipleChart(v)){a=c.get('VIZ_CHART_TRELLIS_DISABLED_WARN');}else if(!this._isFeedsValid){a=r(v,s,this._chartModelProvider().feedingItems());}}if(a){if(this._descriptionLayer$){this._descriptionLayer$.show();this._descriptionLayer$.text(a);}this._showDescription();}else{if(this._descriptionLayer$){this._descriptionLayer$.hide();this._descriptionLayer$.text("");}this._chartHolder$.css({'opacity':""});}this.hideLoadingIcon();};function q(a,e,t,s){for(var i=0;i<e.length;i++){if(e[i].type()===t){for(var j=0;j<a.length;j++){if(e[i].id()===a[j].id){if((e[i].id()!=="geoFeatures"&&!s)||(e[i].id()==="geoFeatures"&&s)){if(!a[j].minStackedDims){if(e[i].values().length<a[j].min){return false;}}else{if(e[i].values().length<a[j].minStackedDims){return false;}}}}}}}return true;};function r(t,a,e){var s=c.get("VIZ_CHART_INCOMPLETE_DESCRIPTION");var v=b.getVizFeeds(t);var w=true;var x=true;var i;for(i=0;i<v.length;i++){if(!x&&!w){break;}if(x&&v[i].type===F.DIMENSION){x=false;continue;}if(w&&v[i].type===F.MEASURE){w=false;}}if(w){s=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION");return s;}if(x){s=c.get("VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION");return s;}if(!a){return s;}var y=q(v,e,F.MEASURE,false);var z=q(v,e,F.DIMENSION,false);var E=q(v,e,F.DIMENSION,true);if(E){if(!y&&z){s=c.get("VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION");}if(y&&!z){s=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION");}}else{if(y&&z){s=c.get("VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION");}if(y&&!z){s=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION");}}return s;};p.prototype._showDescription=function(){this._chartHolder$.css({'opacity':".3"});if(this._descriptionLayer$){this._descriptionLayer$.css({width:this._size.width+"px",height:this._size.height/2+50+"px",color:"black",'font-size':"28px",'text-align':"center",'top':this._size.height/2-50+"px",'word-wrap':"break-word"});}};p.prototype._destroyChartInstance=function(){if(this._chart){this._offEvent();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:destroy_cvom_chart_instance');this._chart.destroy();this._chart=null;this._hasChartInstance=false;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:destroy_cvom_chart_instance');}};p.prototype._updateDescriptionByOptions=function(a){if(f.isEmptyData(a.type,a.data)){var e=c.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(e);a.data=I.getDataset(a.type);this._chartLayer$.css('opacity','0');}else{this._updateDescription();this._updateChartSize(false);this._chartLayer$.css('opacity','');}};p.prototype._createChartInstance=function(){};p.prototype.getTemplateId=function(a){if(arguments.length>0){return this._templateId;}else{return sap.viz.api.env.Template.get();}};p.prototype._getTemplateId=function(a){var t=sap.viz.api.env.Template.get();if(t!==p.TEMPLATE_INCOMPLETE&&t!==p.TEMPLATE_EMPTY){this._templateId=t;}this._isFeedsValid=!V.hasFakeData(a);t=this._isFeedsValid?this._templateId:p.TEMPLATE_INCOMPLETE;return t;};p.prototype.showLoadingIcon=function(){};p.prototype.hideLoadingIcon=function(){this._loadingIcon$.css({display:""});};p.prototype.hasChartInstance=function(){return this._hasChartInstance;};p.prototype.exportable=function(){return false;};p.prototype.size=function(s){if(arguments.length>0){this._size={width:s.width,height:s.height};this._updateChartSize(true);var a=this._descriptionLayer$;if(a!==null&&a.size()>0){a.css({width:this._size.width+"px",height:this._size.height/2+50+"px",'top':this._size.height/2-50+"px"});}this._loadingIcon$.css({width:this._size.width+"px",height:this._size.height+"px"});return this;}return{width:this._size.width,height:this._size.height};};p.prototype.changeTemplate=function(){var t=sap.viz.api.env.Template.get();if(t!==p.TEMPLATE_INCOMPLETE&&t!==p.TEMPLATE_EMPTY&&t!==this._templateId){var a=this._getTemplateId(this._options.data);if(a===t){this._requestMorphing=true;this._createChartInstance();this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this));}}};p.prototype.create=function(a){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create');if(a){this._options=a;this._requestMorphing=true;var t=this._getTemplateId(a.data);this.__templateId=t;var _=this;sap.viz.api.env.Template.set(t,function(){if(_.__templateId===t){_._createChartInstance();}});this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this));}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create');};p.prototype.destroy=function(){$(document).off('mousedown',this._mouseDownHandler);this.removeAllEventListeners();this._onEventMap={};if(this._chart){this._chart.destroy();this._chart=null;}$(this._div).empty();sap.viz.extapi.env.Template.removeListener(this._changeTemplateFunc);};p.prototype.data=function(a){var e;try{if(arguments.length>0){this._options.data=a;if(this._chart){if(f.isEmptyData(this._options.type,this._options.data)){this._dispatchEvent(new k(k.CHART_CHANGING,this));this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this));e=c.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(e);this._requestMorphing=false;this._options.data=I.getDataset(this._options.type);this._chartLayer$.css('opacity','0');}else{this._updateDescription();this._chartLayer$.css('opacity','');}this._chart.data(this._options.data);return this;}else{e=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(e);throw e;}}else{if(this._chart){return this._chart.data();}else{return this._options.data;}}}catch(s){e=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+s;this._updateDescription(e);throw e;}};p.prototype.feeding=function(a){if(arguments.length>0){this._options.feeding=a;return this;}else{return this._options.feeding;}};p.prototype.css=function(a){if(arguments.length>0){this._options.css=a;return this;}else{return this._options.css;}};p.prototype.getValidProperties=function(a,e){return V.getValidProperties(a,e);};p.prototype.properties=function(a){if(arguments.length>0){this._options.properties=a;return this;}else{return this._options.properties;}};p.prototype.update=function(a,e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');if(!a){return;}if(!e){this._requestMorphing=true;}if(a.css){this._updateCssCacheByNewCss(a.css);this._options.css=a.css;}if(a.feeding){this._options.feeding=a.feeding;}if(a.data){this._options.data=a.data;}if(a.properties){this._options.properties=a.properties;}var s;try{if(this._chart){var t=false;if(a.properties&&a.properties.plotArea&&a.properties.plotArea.showNegativeValues===true){t=true;}if(!t&&this._chart.type&&D.hasNegativeMeasureValue(a.data,this._chart.type)){this._showWarningDialog();}this._updateDescription();if(f.isEmptyData(this._options.type,this._options.data)){this._dispatchEvent(new k(k.CHART_CHANGING,this));this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this));s=c.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');this._updateDescription(s);this._requestMorphing=false;a.data=I.getDataset(this._options.type);a.feeding=null;this._chartLayer$.css('opacity','0');}else{this._chartLayer$.css('opacity','');}this._updateChartSize(true);this._chart.update(a);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');return this;}else{s=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(s);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');throw s;}}catch(v){s=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+v;this._updateDescription(s);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');throw s;}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-update');};p.prototype.on=function(e,a){try{if(this._chart){if(arguments.length>0){this._chart.on(e,a);}}this._onEventMap[e]=a;return this;}catch(s){throw c.get('VIZ_CHART_ADD_EVENT_FAILED')+s;}};p.prototype.off=function(e){try{if(this._chart){if(arguments.length>0){this._chart.off(e);}}delete this._onEventMap[e];return this;}catch(a){throw c.get('VIZ_CHART_REMOVE_EVENT_FAILED')+a;}};p.prototype.selection=function(a,e){try{if(this._chart){if(this._options.type===C.TYPE_TREE||this._options.type===C.TYPE_TABLE||this._options.type===C.TYPE_CROSSTAB){return null;}if(arguments.length>=2){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');this._chart.selection(a,e);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');return this;}else if(arguments.length===1){if(d.isArray(arguments[0])){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');this._chart.selection(arguments[0]);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView_selection-set');return this;}else{return this._chart.selection(arguments[0]);}}else{return this._chart.selection();}}else{if(arguments.length>=2){throw c.get('VIZ_CHART_SELECTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}else if(arguments.length===1){if(d.isArray(arguments[0])){throw c.get('VIZ_CHART_SELECTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}else{return null;}}else{return null;}}}catch(s){throw c.get('VIZ_CHART_SELECTION_FAILED')+s;}};p.prototype.feedingZone=function(){return[];};p.prototype.description=function(a){try{if(arguments.length>0){if(this._chart){this._chart.description(a);return this;}else{throw c.get('VIZ_CHART_DESCRIPTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._chart){return this._chart.description();}else{return null;}}}catch(e){throw c.get('VIZ_CHART_DESCRIPTION_FAILED')+e;}};p.prototype.action=function(a,e){try{if(this._chart){if(arguments.length>0){return this._chart.action(a,e);}}else{throw c.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(s){throw c.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+s;}};p.prototype.exportViz=function(a){if(this._chart){var e=this._chart.toJSON(a);if(e){e.properties=this._options.properties;this._updateCssOfOptions();e.css=this._options.css;}return e;}else{throw c.get('VIZ_CHART_SERIALIZE_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};p.prototype.loadViz=function(v){this.create(v);};p.prototype.enableTrellis=function(v){if(arguments.length>0){this._enableTrellis=(v!==false);return this;}else{return this._enableTrellis;}};p.prototype.enableMorphing=function(v){if(arguments.length>0){this._enableMorphing=(v!==false);return this;}else{return this._enableMorphing;}};p.prototype.enablePropertyZone=function(v){if(arguments.length>0){if(this._enablePropertyZone!==v){this._enablePropertyZone=(v===true);}return this;}else{return this._enablePropertyZone;}};p.prototype.getTitleByFeeding=function(){var a="";var e=[];var s=[];var t=this._chartModelProvider().feedingItems();for(var i=0;i<t.length;i++){var v=t[i];if(v._id===F.ROW_SUBTOTALS||v._id===F.COLUMNS_SUBTOTALS){continue;}var w=v.values();var x=(v.type()===F.MEASURE)?e:s;for(var j=0;j<w.length;j++){var y=w[j];if(y.id()===o.MND){continue;}var z=y.selectedHierarchyLevel();var E=z?z.name():y.name();x.push(E);}}var H=p._getNames(e);var J=p._getNames(s);if(H!==""&&J!==""){a=d.substitute(c.get('VIZ_CHART_TITLE_TEXT_JOIN_BY'),H,J);}else if(H!==""){a=H;}else if(J!==""){a=J;}if(a==""){a=" ";}return a;};p._getNames=function(a){var e="";for(var i=0;i<a.length;i++){var s=a[i];e+=s;if(i+2===a.length){e+=" "+c.get('VIZ_CHART_TITLE_TEXT_JOIN_AND')+" ";}else if(i+2<a.length){e+=", ";}}return e;};p.prototype.resetProperties=function(a,v){return a;};p.prototype.copyData=function(t,a){return d.clone(a);};p.prototype.buildFeedings=function(t,a,e){return null;};p.prototype.supportUpdate=function(t){return true;};p.prototype.setPropertyZones=function(a){};p.prototype.FeedsToJSON=function(a){return n.toJSON(a);};p.prototype.save=function(){};p.prototype.load=function(a,v){};p.prototype.FeedsFromJSON=function(v){var a=n.fromJSON(v);return a;};p.prototype.exportToSVGString=function(a){if(this._chart){return this._chart.exportToSVGString(a);}else{throw c.get('VIZ_CHART_EXPORTSVG_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};p.prototype.supportExportToSVG=function(){if(this._chart){return this._chart.supportExportToSVG();}else{throw c.get('VIZ_CHART_EXPORTSVG_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};p.prototype.getPropertyZones=function(){return[];};p.prototype.getZoneName=function(a){};p.prototype.setAxisScale=function(a){};p.prototype.getDataPointsPosition=function(a){return[];};p.prototype.updateProperties=function(a){};p.prototype._updateCssCache=function(s,a,e){if(!this._cssCache){this._updateCssCacheByOptions();}this._cssCache=this._cssCache||{};this._cssCache[s]=this._cssCache[s]||{};this._cssCache[s][a]=e;};p.prototype._updateCssCacheByOptions=function(){if(this._options&&this._options.css){this._updateCssCacheByCssString(this._options.css);}};p.prototype._updateCssCacheByNewCss=function(a){if(!this._cssCache){this._updateCssCacheByOptions();}this._updateCssCacheByCssString(a);};p.prototype._updateCssCacheByCssString=function(a){if(!a){return;}this._cssCache=this._cssCache||{};var e=a.split('}');var i,j,s,t=[],v,w,x,P,y,z,E;for(i=0;i<e.length;i++){s=e[i];t=s.split('{');if(t.length===2){v=t[0].trim();w=t[1];x=w.split(';');this._cssCache[v]=this._cssCache[v]||{};for(j=0;j<x.length;j++){P=x[j];y=P.split(':');if(y.length===2){z=y[0].trim();E=y[1];this._cssCache[v][z]=E;}}}}};p.prototype._updateCssOfOptions=function(){if(!this._cssCache){return;}var a="",s,e,v;for(s in this._cssCache){if(this._cssCache.hasOwnProperty(s)){a+=' '+s+'{';for(e in this._cssCache[s]){if(this._cssCache[s].hasOwnProperty(e)){a+=e+':'+this._cssCache[s][e]+';';}}a+='}';}}if(a!==""){this._options.css=this._options.css?this._options.css+a:a;}};p.prototype.cssProperty=function(s,a,e){if(this._chart){if(arguments.length>2){this._updateCssCache(s,a,e);return this._chart.cssProperty(s,a,e);}else if(arguments.length===2){return this._chart.cssProperty(s,a);}}return this;};p.prototype.selectedPropertyZone=function(a){if(this._chart){if(arguments.length>0){return this._chart.selectedPropertyZone(a);}else{return this._chart.selectedPropertyZone();}}return this;};p.prototype.onEventMap=function(a){if(arguments.length>0){this._onEventMap=a;return this;}else{return this._onEventMap;}};p.prototype._postVizProcess=function(a){if(!!this._chart.on){Object.keys(this._onEventMap).forEach($.proxy(function(e){var s=this._onEventMap[e];this._chart.on(e,s);},this));}};p.prototype._offEvent=function(){if(!!this._chart.off){Object.keys(this._onEventMap).forEach($.proxy(function(a){var e=this._onEventMap[a];this._chart.off(a,e);},this));}};p.prototype._getCssProperties=function(a,e){var s=null;for(var i=0;i<e.length;++i){var v=this._chart.cssProperty(a,e[i]);if(v!=null){s=s||{};s[e[i]]=v;}}return s;};p.prototype.queryProperties=function(a){if(!a||!a.css){return this.properties();}var e=a.css.properties;var s=a.css.selector;var t=null;if(d.isArray(s)){for(var i=0;i<s.length;++i){t=this._getCssProperties(s[i],e);if(t){break;}}}else{t=this._getCssProperties(s,e);}return t;};p.prototype.updateProperties=function(e){if(!e){return;}if(e.css&&e.css.selector){var s;var t=e.css.selector;var v=e.css.value;var a=v.split('font-size');if(a.length===2){a[1]=a[1].replace(/;/,'!important;');v=a.join('font-size');}if(d.isArray(t)){s="";for(var i=0;i<t.length;++i){s+=t[i]+v;}}else{s=t+v;}this._helper.vizCss(s);}else if(e.hasOwnProperty("properties")){this._helper.vizProperties(e.properties);}};return p;});u('sap/viz/controls/common/property/VizPropertyZone',['sap/viz/controls/common/utils/Utils'],function(U){var V=function(t,c,e,m){this._type=t;this._context=c;this._extraContext=e;this._measureNames=m;if(U.isArray(m)){this._dimensionContext=this._filterDimensionContext(m.concat('_id'));}};V.CHART_AREA='CHART_AREA';V.CHART_TITLE='CHART_TITLE';V.PLOT_AREA='PLOT_AREA';V.GRID_LINE='GRID_LINE';V.LEGEND='LEGEND';V.X_AXIS='X_AXIS';V.X_AXIS_TITLE='X_AXIS_TITLE';V.Y_AXIS='Y_AXIS';V.Y_AXIS_TITLE='Y_AXIS_TITLE';V.DATA_POINT='DATA_POINT';V.DATA_LABEL='DATA_LABEL';V.LINE='LINE';V.prototype.type=function(v){if(arguments.length>0){this._type=v;return this;}else{return this._type;}};V.prototype.context=function(v){if(arguments.length>0){this._context=v;if(U.isArray(this._measureNames)){this._dimensionContext=this._filterDimensionContext(this._measureNames.concat('_id'));}return this;}else{return this._context;}};V.prototype.getDimensionContext=function(){if(this._selectAllData){return undefined;}if(this._seriesData){for(var i in this._seriesData){if(this._seriesData.hasOwnProperty(i)){return this._seriesData;}}return undefined;}return this._dimensionContext;};V.prototype._filterDimensionContext=function(a){var r;for(var k in this._context){if(!r){r={};}var b=true;for(var i=0;i<a.length;i++){if(k===a[i]){a.splice(i,1);b=false;break;}}if(!b){continue;}r[k]=this._context[k];}return r;};V.prototype.extraContext=function(v){if(arguments.length>0){this._extraContext=v;return this;}else{return this._extraContext;}};V.prototype.stackContext=function(v){if(arguments.length>0){this._stackContext=v;return this;}else{return this._stackContext;}};V.prototype.seriesContext=function(s){if(arguments.length>0){this._seriesData=s;return this;}else{return this._seriesData;}};V.prototype.selectAllData=function(s){if(arguments.length>0){this._selectAllData=s;return this;}else{return this._selectAllData;}};return V;});u('sap/viz/controls/chart/views/ChartView',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/AxisSizeAdjustHelper','sap/viz/controls/chart/views/AxisSplitter','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/DataPointFinder','sap/viz/controls/chart/views/DropZone','sap/viz/controls/chart/views/EditAxisView','sap/viz/controls/chart/morph/VizMorpher','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/PropertyZone','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/property/VizPropertyZone'],function($,G,C,M,F,a,L,O,b,c,D,T,V,d,f,g,h,l,m,E,o,p,P,q,I,r,s){var t=function(e,k,n,w){t.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.ChartView";this._morphingLayer$=null;this._supportMorphing=true;this._requestMorphing=false;this._vizMorpher=null;k=k||{};this._enablePropertyZone=false;this._useBuiltInPropertyZoneInteraction=k.useBuiltInPropertyZoneInteraction;this._useDefaultChartSizeForTrellis=k.useDefaultChartSizeForTrellis;this._createChildren();};O.extend(t,q);var S=["legend","sizeLegend"];t.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._editAxisView=new E(this._chartHolder$.get(0),null);this._editAxisView.addEventListener(E.AxisScaleChanged,this._axisScalerChangedHandler,this);this._axisSplitter=new g(this._chartHolder$.get(0),$.proxy(this.properties,this),$.proxy(this._getPropertyZone,this));this._axisSplitter.addEventListener(g.AxisSplitChanged,this._axisSplitChangedHandler,this);this._morphingLayer$=$(document.createElement('div')).addClass(d.PREFIX+'morphing-layer');this._morphingLayer$.appendTo(this._chartHolder$);this._morphingLayer$.css({position:'absolute'});this._createDescriptionLayer();this._createLoadingIcon();this._createWarningDialog();this._createDropZone();var k=this._chartLayer$;this._propertyZone=new P(k.get(0),$.proxy(this._getPropertyZone,this));this._propertyZone.addEventListener(P.SELECT_ZONE,$.proxy(function(e){this._dispatchEvent(new h(h.SELECT_PROPERTY_ZONE,this,e.data));},this));this._uxScaleIndex=null;};t.prototype.getZoneName=function(e){if(!e||!this._chart){return null;}var z=this._getZoneName(e);if(z){if(V.isValueAxis(this._chart.type,z)){return z;}else{for(var i=0;i<S.length;i++){if(S[i]===z){return z;}}}}return null;};t.prototype._getZoneName=function(e){var z=this._getPropertyZone();for(var i=0;i<z.length;i++){var k=z[i].bound;var w=z[i].name;for(var n=0;n<k.length;n++){if(k[n][0][0]<e.x&&k[n][1][0]>e.x&&k[n][1][1]<e.y&&k[n][2][1]>e.y){return w;}}}return null;};t.prototype.setAxisScale=function(e){if(this._chart){var k=this._chart.type;this._editAxisView.show(k,this._chart.properties(),e);}};t.prototype._axisScalerChangedHandler=function(e){if(!this._chart){return;}this._helper.vizProperties(e.data);};t.prototype._axisSplitChangedHandler=function(e){var k=f(this._chart,e.data.axisName,e.data.offset);if(k){this._helper.vizProperties(k);}};t.prototype._titleText=function(e){try{if(this._chart){if(!this.properties().title){return this;}if(arguments.length>0){if(e!=this.properties().title.text)this._dispatchEvent(new h(h.TITLE_CHANGED,this,{text:e}));return this;}else{var k=this.properties().title.text;return k;}}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(n){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+n;}};t._ZoneMap={xAxis:{text:"VIZ_COMMON_XAXIS"},xAxis2:{text:"VIZ_COMMON_XAXIS"},yAxis:{text:"VIZ_COMMON_YAXIS",rotate:true},yAxis2:{text:"VIZ_COMMON_YAXIS",rotate:true}};t._ZoneMap[a.trillisFeeds.column.id]={text:"VIZ_COMMON_COLUMNS"};t._ZoneMap[a.trillisFeeds.row.id]={text:"VIZ_COMMON_ROWS",rotate:true};t.prototype._isEmptyZone=function(z){if(!z||!z.bound){return true;}var e=z.bound[0];if(!e){return true;}var w=e[2][0]-e[0][0];var k=e[2][1]-e[0][1];if(w<1||k<1){return true;}return false;};t.prototype._updateTextInfo=function(z){if(!z){return;}for(var n=0;n<z.length;n++){var e=t._ZoneMap[z[n].name];if(e){z[n].text=L.get(e.text);z[n].rotate=e.rotate;}}};t.prototype.getTitleZone=function(){if(!this._chart){return[];}var e=this._chart.type;var z;try{z=this._chart.propertyZone();}catch(k){return[];}var n=[];for(var i=0;i<z.length;i++){if(z[i].name=='title'){n=z[i].bound[0];break;}}return n;};t.prototype._getFeedingZone=function(){if(!this._chart){return[];}var e=this._chart.type;var z;try{z=this._chart.feedingZone();}catch(k){return[];}if(!c.supportMultiChart(e)){this._updateTextInfo(z);return z;}var n=c.isMultipleChart(e);var w=null;var x=null;if(n){for(var i=z.length-1;i>=0;i--){var y=z[i].name;if(y===a.MultiplierFeedingName){w={name:a.ColumnsFeedingName,bound:[z[i].bound[0]],feedDef:z[i].feedDef};x={name:a.RowsFeedingName,bound:[z[i].bound[1]],feedDef:z[i].feedDef};z.splice(i,1);}else if(y!=="mainPlot"&&y!=="legend"){if(T.providerName(e)===T.MULTIPLE){z.splice(i,1);}}}}if(!this._enableTrellis){this._updateTextInfo(z);return z;}if(this._isEmptyZone(w)){w=null;}if(this._isEmptyZone(x)){x=null;}var H=this._padding;var J={"id":a.MultiplierFeedingName,"name":"ChartView Multiplier","type":F.DIMENSION,"min":1,"max":1,"aaIndex":1,"acceptMND":0};var K;if(!w){K=[[[H,0],[this._size.width-H,0],[this._size.width-H,H],[0,H]]];w={"name":a.ColumnsFeedingName,"feedDef":[J],"bound":K};}if(!x){K=[[[0,H],[H,H],[H,this._size.height-H],[0,this._size.height-H]]];x={"name":a.RowsFeedingName,"feedDef":[J],"bound":K};}z.push(w,x);this._updateTextInfo(z);return z;};t.prototype._updateMorphingSnapshot=function(){if(this._canMorphing()&&this._hasChartInstance&&this._vizMorpher&&!this._vizMorpher.isPlaying()){this._vizMorpher.morphVizType(null,-1);}};t.prototype._setDefaultValue=function(e,k,n,w){var x=k.split('.');var y=e;for(var i=0;i<x.length;i++){y[x[i]]=y[x[i]]||{};y=y[x[i]];}if(!y.hasOwnProperty(n)){y[n]=w;}};t.prototype._applyDefaultProperties=function(e){e=e||{};e.properties=e.properties||{};this._setDefaultValue(e.properties,'background.border.left','visible',false);this._setDefaultValue(e.properties,'background.border.top','visible',false);this._setDefaultValue(e.properties,'background.border.right','visible',false);this._setDefaultValue(e.properties,'background.border.bottom','visible',false);return e;};function v(e,k,w){if(k==null||k.length==0){return 1;}var x=[];var y=1;var z=0;var H=false;for(var n=0;n<k.length;n++){if(k[n].type()===r.HIERARCHY){var J=k[n].hierarchyLevels();for(var j=0;j<J.length;j++){if(J[j].selected()){break;}z++;}}else if(k[n].type()===r.MND){H=true;continue;}if(z<e.length){var K=e[z].values;x[n]={};var N=0;for(var i=0;i<K.length;i++){if(!x[n].hasOwnProperty(K[i])){x[n][K[i]]=true;N++;}}y*=N;z++;}}if(H){y*=w;}return y;};t.prototype._getRowColumn=function(e,n){var w={row:1,column:1};if(!e||e.length===0){return w;}var x=e[0].data;if(!x||x.length===0){return w;}var y=0;var z=null;var H=null;var J=this._chartModelProvider().feedingItems();for(var i=0;i<J.length;i++){if(J[i].id()===a.RowsFeedingName){z=J[i].values();for(var j=0;j<z.length;j++){if(z[j].type()===r.HIERARCHY){var K=z[j].hierarchyLevels();for(var k=0;k<K.length;k++){y++;if(K[k].selected()){break;}}}else if(z[j].type()!==r.MND){y++;}}}else if(J[i].id()===a.ColumnsFeedingName){H=J[i].values();}}w.row=v(x.slice(0,y),z,n);w.column=v(x.slice(y),H,n);return w;};t.prototype._getMinSize=function(){var w=this._size.width;var e=this._size.height;var k=this._options;var n={width:w,height:e};if(!this._useDefaultChartSizeForTrellis&&c.isMultipleChart(k.type)&&T.providerName(k.type)===T.MULTIPLE){if(!k.data||!k.data.data()){return n;}var x=k.data.data().measureValuesGroup;var y=0;for(var i=0;i<x.length;i++){y+=x[i].data.length;}var z=this._getRowColumn(k.data.data().analysisAxis,y);var H=z.column*200;var J=z.row*200;if(w<H){w=H;n['overflow-x']='auto';}if(e<J){e=J;n['overflow-y']='auto';}}n.width=w;n.height=e;return n;};t.prototype._updateChartSize=function(e){var k=t.superclass._updateChartSize.apply(this,arguments);var w=k.width;var n=k.height;this._morphingLayer$.css({width:w+"px",height:n+"px",display:'none'});this._updateUXScale();return k;};t.prototype.updateDescription=function(e){t.superclass.updateDescription.apply(this,arguments);if(this._vizMorpher){this._vizMorpher.showMorphing(false,true);}};t.prototype._destroyChartInstance=function(){t.superclass._destroyChartInstance.apply(this,arguments);this._axisSplitter.reset();};t.prototype._createChartInstance=function(){this._hasChartInstance=false;var e=this._options;e=this._applyDefaultProperties(e);if(this._useBuiltInPropertyZoneInteraction===true){e.properties=e.properties||{};e.properties.interaction=e.properties.interaction||{};e.properties.interaction.selectability=e.properties.interaction.selectability||{};e.properties.interaction.selectability.plotLassoSelection=false;e.properties.interaction.selectability.mode="none";e.properties.tooltip=e.properties.tooltip||{};e.properties.tooltip.visible=false;}var k=this._chartLayer$;var n=this._morphingLayer$;var w=this._descriptionLayer$;var x=this._chartHolder$;var y=e.type;if(y===C.TYPE_TREE||y===C.TYPE_NETWORK||y===C.TYPE_FUNNEL||y===C.TYPE_PC||c.supportAnimation(y)){this._supportMorphing=false;}else if(!c.isBuildInType(y)){this._supportMorphing=false;}else{this._supportMorphing=true;}if(c.isEmptyData(y,e.data)){this._requestMorphing=false;}if(this._canMorphing()&&!this._vizMorpher){this._vizMorpher=new o(k.get(0),n.get(0));}this._updateMorphingSnapshot();this._destroyChartInstance();if(e.data===null||e.data===undefined){if(this._canMorphing()&&this._vizMorpher){this._vizMorpher.morphVizType(null,-1);}return;}var z=false;if(e.properties&&e.properties.plotArea&&e.properties.plotArea.showNegativeValues===true){z=true;}if(!z&&D.hasNegativeMeasureValue(e.data,y)){this._showWarningDialog();}if(!e.properties){e.properties={};}if(this._canMorphing()===true){if(!e.properties.plotArea){e.properties.plotArea={};}if(!e.properties.plotArea.animation){e.properties.plotArea.animation={};}e.properties.plotArea.animation.dataLoading=false;e.properties.plotArea.animation.dataUpdating=false;e.properties.plotArea.animation.resizing=false;}try{if(!this._enableTrellis&&c.isMultipleChart(y)){this._propertyZone.updateZone(false);return;}if(c.supportAnimation(y)){if(!e.properties.plotArea){e.properties.plotArea={};}if(!e.properties.plotArea.animation){e.properties.plotArea.animation={};}e.properties.plotArea.animation.dataLoading=e.properties.plotArea.animation.dataLoading===false?false:true;e.properties.plotArea.animation.dataUpdating=e.properties.plotArea.animation.dataUpdating===false?false:true;e.properties.plotArea.animation.resizing=e.properties.plotArea.animation.resizing===false?false:true;if(!e.properties.geoContainer){e.properties.geoContainer={};}}this._dispatchEvent(new h(h.CHART_CHANGING,this,y));this._updateDescriptionByOptions(e);var H=e.properties;this._chart=sap.viz.api.core.createViz({type:y,data:e.data,feeding:e.feeding,properties:H,css:e.css,events:e.events,container:k.get(0)});this._postVizProcess(e);}catch(J){var K=L.get('VIZ_CHART_CREATE_CHART_FAILED')+J;this._propertyZone.updateZone(false);if(!a.getVizFeeds(y)){this._updateDescription(b.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),y));}else{this._updateDescription(K);}k.html("");this._chart=null;this._hasChartInstance=false;throw K;}};t.prototype._postVizProcess=function(e){t.superclass._postVizProcess.apply(this,arguments);var k=$.proxy(function(w,x){this._dispatchEvent(new h(h.TRIGGER_CVOM_EVENT,this,{type:w,data:x}));},this);if(this._canMorphing()&&this._vizMorpher&&this._requestMorphing){this._vizMorpher.showMorphing(true,false);}this._chart.on("lassoStart.chartview",$.proxy(function(){this._axisSplitter.deactive();},this));this._chart.on("lassoEnd.chartview",$.proxy(function(){this._axisSplitter.active();},this));this._chart.on("initialized.chartview",$.proxy(function(w){if(this._canMorphing()&&this._requestMorphing&&this._hasChartInstance&&this._vizMorpher){this._requestMorphing=false;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:morphing');this._vizMorpher.morphVizType(e.type,800,function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:morphing');});}if(this._isFeedsValid){this._axisSplitter.init(e.type);}var x=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(x);k("initialized",w);},this));var n=this;this._chart.on("selectData.chartview",function(w){if(n._options.type!==C.TYPE_NETWORK){n._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));k("selectData",w);}});this._chart.on("deselectData.chartview",function(w){if(n._options.type!==C.TYPE_NETWORK&&n._options.type!==C.TYPE_TREE){n._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));k("deselectData",w);}});this._chart.on("showTooltip.chartview",function(w){k("showTooltip",w);});this._chart.on("hideTooltip.chartview",function(w){k("hideTooltip",w);});this._hasChartInstance=true;this._uxScaleIndex=null;this._updateUXScale();this._dispatchEvent(new h(h.CHART_CHANGED,this,this._chart));};t.prototype.getTemplateId=function(e){var k=e||this.data();if(V.hasFakeData(k)){return q.TEMPLATE_INCOMPLETE;}else{return this._templateId;}};t.prototype.size=function(e){if(arguments.length>0){t.superclass.size.apply(this,arguments);if(this._dropZone){this._dropZone.size(this._size);}this._propertyZone.size(this._size);setTimeout($.proxy(this._updateMorphingSnapshot,this),500);return this;}else{return t.superclass.size.apply(this,arguments);}};t.prototype.data=function(e,k){if(arguments.length>0){if(!k){this._requestMorphing=true;}}return t.superclass.data.apply(this,arguments);};t.prototype.feeding=function(e,k){try{if(this._chart){if(arguments.length>0){if(!k){this._requestMorphing=true;}this._chart.feeding(e);return this;}else{return this._chart.feeding();}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(n){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+n;}};t.prototype.css=function(e,k){try{if(arguments.length>0){if(!k){this._requestMorphing=true;}this._updateCssCacheByNewCss(e);this._options.css=e;if(this._chart){this._chart.css(e);return this;}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._chart){return this._chart.css();}else{return this._options.css;}}}catch(n){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+n;}};t.prototype.properties=function(e,k){try{if(arguments.length>0){if(!k){this._requestMorphing=true;}this._options.properties=e;if(this._chart){this._chart.properties(e);return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._chart){return this._chart.properties();}else{return this._options.properties;}}}catch(n){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+n;}};t.prototype.update=function(e,k){if(!k){this._requestMorphing=true;}return t.superclass.update.apply(this,arguments);};t.prototype.feedingZone=function(){try{if(this._chart){return this._chart.feedingZone();}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(e){throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+e;}};t.prototype._canMorphing=function(){return this._enableMorphing&&this._supportMorphing;};t.prototype._getPropertyZone=function(){if(!this._chart){return[];}var z;try{z=this._chart.propertyZone();}catch(e){return[];}return z;};t.prototype.enablePropertyZone=function(e){if(arguments.length>0){if(this._enablePropertyZone!==e){this._enablePropertyZone=(e===true);var k=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(k);}return this;}else{return this._enablePropertyZone;}};t.prototype._getCategoryAxisScale=function(e){var k=null;var n=V.getCategoryAxis(e);if(n){k=[];for(var i=0;i<n.length;i++){k.push(n[i]+".maxSizeRatio");}}return k;};t.prototype.resetProperties=function(e,k){if(this._options&&this._options.type){var n=this._options.type;V.convertValueAxisScale(e,n,k);var w=this._getCategoryAxisScale(n);if(w&&w.length>0){V.removeProperties(e,w);}}return e;};t.prototype.copyData=function(e,k){var n=new sap.viz.api.data.CrosstableDataset();n.data(b.clone(k.data()));n.info(b.clone(k.info('additionalData')));return n;};t.prototype.buildFeedings=function(e,k,n){var w=null;if(!k||c.isEmptyData(e,k)){return w;}if(!V.hasFakeData(k)&&!c.isEmptyData(e,k)&&!a.isEmptyFeeds(n)){w=a.buildFeedings(e,n,k);}else{w=a.buildFeedingsWithFakeData(e,n,k);w=a.buildMNDFeedings(w,e);}return w;};t.prototype.getDataPointsPosition=function(e){return l.findDataPointsPosition(e);};t.prototype.getPropertyZones=function(){return[new s(s.CHART_AREA)];};var _={'padding':['24px','16px','9px','2px'],'font_size_1':['16px','15px','14px','13px'],'font_size_2':['14px','13px','12px','11px'],'font_size_3':['13px','12px','11px','10px'],'font_size_4':['12px','11px','10px','9px'],};t.prototype._updateUXScale=function(){var e=this.size();var w=e.width,k=e.height;var n=0;if(w<160||k<160){n=3;}else if(w<260||k<260){n=2;}else if(w<360||k<360){n=1;}if(this._uxScaleIndex!==n&&this._chart){var i=this._uxScaleIndex=n;this._chart.update({'properties':{'general':{'layout':{'padding':parseInt(_.padding[i])}}},'css':'.v-m-root .v-m-title .v-title {font-size:'+_.font_size_1[i]+';}'+'.v-m-root .v-m-main .v-m-yAxis .v-title {font-size:'+_.font_size_2[i]+';}'+'.v-m-root .v-m-main .v-m-xAxis .v-title {font-size:'+_.font_size_2[i]+';}'+'.v-m-tooltip .v-body-dimension-value {font-size:'+_.font_size_3[i]+'!important;}'+'.v-m-tooltip .v-body-measure-value {font-size:'+_.font_size_3[i]+'!important;}'+'.v-m-tooltip .v-body-dimension-label {font-size:'+_.font_size_4[i]+'!important;}'+'.v-m-tooltip .v-body-measure-label {font-size:'+_.font_size_4[i]+'!important;}'+'.v-m-tooltip .v-footer-label {font-size:'+_.font_size_4[i]+'!important;}'+'.v-m-root .v-m-main .v-m-yAxis .v-label {font-size:'+_.font_size_4[i]+';}'+'.v-m-root .v-m-main .v-m-xAxis .v-label {font-size:'+_.font_size_4[i]+';}'+'.v-m-root .v-m-main .v-m-datalabel .v-datalabel {font-size:'+_.font_size_4[i]+';}'+'.v-m-root .v-m-legends .v-m-legend .v-label {font-size:'+_.font_size_4[i]+';}'});}};return t;});u('sap/viz/controls/chart/adapters/InteractionAdapter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/chart/views/ChartEvent'],function(O,a,E,V,C){var I=function(h){I.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.adapters.InteractionAdapter';this._helper=h;var s=true;this._helper.vizOn('selectPropertyZone',$.proxy(function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:interaction_select');s=true;this._selectPropertyZoneHandler(e);},this));this._helper.vizOn('deselectPropertyZone',$.proxy(function(e){s=false;a.defer($.proxy(function(){if(!s){this._selectPropertyZoneHandler(e);}},this));},this));this._propertyZones=null;};O.extend(I,E);var _={'dataPoint':V.DATA_POINT,'title':V.CHART_TITLE,'plotArea':V.PLOT_AREA,'legend':V.LEGEND,'axis.x':V.X_AXIS,'axisTitle.x':V.X_AXIS_TITLE,'axis.y':V.Y_AXIS,'axisTitle.y':V.Y_AXIS_TITLE,'chart':V.CHART_AREA,'dataLabel':V.DATA_LABEL,'dataLine':V.LINE,'gridline':V.GRID_LINE};var b=a.invert(_);I.prototype._getPropertyZones=function(){var s=this._helper.selectedPropertyZone();if(!s){return[];}var t=s.type;if(t==='axisItem'){t='axis';}var p=null;var f=t+(s.subType?'.'+s.subType:'');if(_[f]){p=_[f];}else{}var z=[];var m=this._helper.vizData().measures();if(s.data&&s.data.length>0){s.data.forEach(function(c,d){var e=new V(p,c,s.extraData?s.extraData[d]:undefined,m);var g=s.stackData?s.stackData[d]:null;if(g){e.stackContext(g);}var h=s.seriesData?s.seriesData:null;if(h){e.seriesContext(h);}if(s.selectAllData){e.selectAllData(s.selectAllData);}z.push(e);});}else{z.push(new V(p));}return z;};I.prototype._selectPropertyZoneHandler=function(e){this._propertyZones=this._getPropertyZones();a.defer(function(){this._dispatchEvent(new C(C.PROPERTY_ZONES_CHANGED,this,{'propertyZones':this._propertyZones}));}.bind(this));};I.prototype.propertyZones=function(v){if(arguments.length>0){this._propertyZones=v;var t=null;v=v||[];v.forEach(function(c){var d=b[c.type()];if(!d){return;}t=t||{};t.data=t.data||[];var e=d.split('.');t.type=e[0];if(e.length>1){t.subType=e[1];}if(c.context()){t.data.push(c.context());}});if(t){this._helper.selectedPropertyZone(t);}else{this._helper.selectedPropertyZone(null);}return this;}else{if(this._helper.vizType()==='info/donut'&&this._propertyZones&&this._propertyZones[0]&&this._propertyZones[0].type()===V.DATA_POINT){return this._propertyZones;}else{var z=this._getPropertyZones();if(!z||z.length===0){return this._propertyZones;}else{return z;}}}};return I;});u('sap/viz/controls/chart/adapters/renderer/RendererInfoBase',['require','sap/viz/controls/common/utils/Utils'],function(r,U){var A=r||A;var R=function(a,v){this.implClassPath='sap/viz/controls/chart/adapters/renderer/RendererInfoBase';this.id=a;this.vizPath=v;this.generator=null;this._parameters=[];this._fallbackParas=null;};R.prototype.parameters=function(v){if(arguments.length>0){this._parameters=v;return this;}else{return this._parameters;}};R.prototype.fallbackParas=function(){return this._fallbackParas;};R.prototype.simplify=function(){var a=[];var b=false;this._iterate('general',$.proxy(function(p){if(this._renderGeneral(p.paras)){b=true;a.push(p);}else{this._fallbackParas=p.paras;}},this));this._iterate('specified',$.proxy(function(p){if(b||this._renderSpecified(p.paras)){a.push(p);}},this));return a;};R.prototype._updatePropsAll=function(c,k,v){var p=this._parameters,a;for(var i=0;i<p.length;i++){if(U.deepEqual(p[i].ctx,c)){p[i].paras[k]=v;a=true;}}return a;};R.prototype._updatePropsGeneral=function(c,k,v){var a;if(c){var p=this._parameters,b,d=-1,n=0,e;for(var i=0;i<p.length;i++){if(!p[i].ctx){e=i;}else if(R._compareCtx(p[i].ctx,c)){for(var j in p[i].ctx){n++;}if(d<n){d=n;e=i;}}}if(p[e]){a=U.clone(p[e]).paras;}}a=a||{};a[k]=v;this._parameters.push({'ctx':c,'paras':a});b=true;};R.prototype._updatePropsSpecified=function(c,k,v){var p=this._parameters;for(var i=0;i<p.length;i++){if(!U.deepEqual(p[i].ctx,c)&&R._compareCtx(c,p[i].ctx)){p[i].paras[k]=v;}}if(!c){for(var i=0;i<p.length;i++){p[i].paras[k]=v;}}};R.prototype._mergeAndAddSeriesProps=function(c,k,v){var p=this._parameters,a,b;for(var i=0;i<p.length;i++){if(!R._compareCtx(c,p[i].ctx)&&!R._compareCtx(p[i].ctx,c)&&U.hasCommonKeyValue(c,p[i].ctx)){a=U.updateJSON(p[i].ctx,c);var d=R._contextLength(a);if(d>R._contextLength(c)&&d>R._contextLength(p[i].ctx)){var o={};o[k]=v;b=U.updateJSON(p[i].paras,o);this._parameters.push({'ctx':a,'paras':b});}}}};R._contextLength=function(c){var l=0;if(c){for(var i in c){if(c.hasOwnProperty(i)){l++;}}}return l;};R.prototype.setProperty=function(c,k,v){var a=false;a=this._updatePropsAll(c,k,v);if(!a){this._updatePropsGeneral(c,k,v);}this._updatePropsSpecified(c,k,v);this._mergeAndAddSeriesProps(c,k,v);};R.prototype.getProperty=function(c,k){var v;var p=this._parameters;for(var i=0;i<p.length;i++){if(!p[i].ctx){v=p[i].paras[k];}else if(U.deepEqual(c,p[i].ctx)){v=p[i].paras[k];break;}}var a=-1,n=0,m=-1,g=0;for(var i=0;i<p.length;i++){if((R._compareCtx(c,p[i].ctx)||c===undefined)&&!U.deepEqual(p[i].paras[k],v)){if(v!==null&&v!==undefined){return null;}else{v=p[i].paras[k];}g++;}else if(R._compareCtx(p[i].ctx,c)){n=0;for(var j in p[i].ctx){n++;}if(a<n){a=n;m=i;}}}if(g===1){return null;}if(m>-1){v=p[m].paras[k];}return v;};R.prototype.toJSON=function(){return{'id':this.id,'vizPath':this.vizPath,'generator':this.generator,'parameters':this._parameters,'implClassPath':this.implClassPath};};R.fromJSON=function(a){var c=A(a.implClassPath);return new c(a.id,a.vizPath).parameters(a.parameters);};R.prototype._renderGeneral=function(p){return true;};R.prototype._renderSpecified=function(p){return true;};R.prototype._iterate=function(t,c,a){this._parameters.forEach(function(p,i,b){if(t==='all'){c(p);}else if(t==='general'){if(!p.ctx||R._compareCtx(p.ctx,a)){c(p);}}else if(t==='specified'&&p.ctx){c(p);}});};R._compareCtx=function(c,a){if(c instanceof Object&&a instanceof Object){var k=Object.keys(c);var b=Object.keys(a);return(b.length>0)&&k.every(function(d){return R._compareCtx(c[d],a[d]);});}else{return c===a;}};R.prototype.isConflict=function(p,a,b){var c=false;var _=this;this._iterate('all',function(d){if(_._ignoreKey(a,d.paras,p)){return;}else{if(d.paras[b]!==p[a]){c=true;}}});return c;};R.prototype._ignoreKey=function(p,a,b){return false;};return R;});u('sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var D=function(a,v){D.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo';this.generator='dataLabelRenderer';};O.extend(D,R);D.prototype._renderSpecified=function(p){if(p.iconVisible===true||p.textVisible===false){return true;}else{return p.fontFamily!==undefined||p.fontSize!==undefined||p.fontWeight!==undefined||p.fontColor!==undefined||p.fontStyle!==undefined;}};D.prototype._ignoreKey=function(p,a,b){switch(p){case'textVisible':if(b.textVisible===undefined){if(a.textVisible===b.dataLabelVisible){return true;}}break;case'iconVisible':if(b.iconVisible===undefined){return true;}break;case'fontFamily':if(a.fontFamily===undefined){return true;}break;case'fontSize':if(a.fontSize===undefined){return true;}break;case'fontWeight':if(a.fontWeight===undefined){return true;}break;case'fontColor':if(a.fontColor===undefined){return true;}break;case'fontStyle':if(a.fontStyle===undefined){return true;}break;}return false;};return D;});u('sap/viz/controls/chart/adapters/config/DataLabelPropConfig',['sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo'],function(D){var a={};var _=function(p){return{'id':'plotArea.dataLabel.renderer','infoClass':D,'vizPath':'plotArea.dataLabel.renderer','paraName':p};};a.instance=function(){return{'dataLabelVisible':{'vizPath':'plotArea.dataLabel.visible'},'textVisible':{'renderer':_('textVisible')},'fontFamily':{'renderer':_('fontFamily'),'vizPath':'plotArea.dataLabel.style.fontFamily'},'fontSize':{'renderer':_('fontSize'),'vizPath':'plotArea.dataLabel.style.fontSize'},'fontWeight':{'renderer':_('fontWeight'),'vizPath':'plotArea.dataLabel.style.fontWeight'},'fontColor':{'renderer':_('fontColor'),'vizPath':'plotArea.dataLabel.style.color'},'fontStyle':{'renderer':_('fontStyle'),'vizPath':'plotArea.dataLabel.style.fontStyle'},'iconVisible':{'renderer':_('iconVisible')},'iconSVG':{'renderer':_('iconSVG')},'iconColor':{'renderer':_('iconColor')},'iconSize':{'renderer':_('iconSize')}};};return a;});u('sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var S=function(a,v){S.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo';this.generator='stackDecorator';};O.extend(S,R);S.prototype._renderSpecified=function(p){if(p.stackShape){return true;}else{return false;}};return S;});u('sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var a=function(b,v){a.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo';this.generator='barShapeRenderer';};O.extend(a,R);a.prototype._renderGeneral=function(p){if(p.dataPointShape||p.dataPointShapeFill){return true;}else{return false;}};a.prototype._renderSpecified=function(p){if(p.dataPointShape||p.dataPointShapeFill){return true;}else{return false;}};return a;});u('sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var P=function(a,v){P.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo';this.generator='pieSliceRenderer';};O.extend(P,R);P.prototype._renderGeneral=function(p){if(p.sliceShape){return true;}else{return false;}};P.prototype._renderSpecified=function(p){if(p.sliceShape){return true;}else{return false;}};return P;});u('sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var L=function(a,v){L.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo';this.generator='lineMarkerRenderer';};O.extend(L,R);L.prototype._renderGeneral=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};L.prototype._renderSpecified=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};return L;});u('sap/viz/controls/chart/adapters/config/DataPointPropConfig',['sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo','sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo','sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo','sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo'],function(S,a,P,L){var D={};var _=function(p){return{'id':'plotArea.markerRenderer.barShapeRenderer','infoClass':a,'vizPath':'plotArea.markerRenderer','paraName':p};};var b=function(p){return{'id':'plotArea.stackDecorator.stackDecorator','infoClass':S,'vizPath':'plotArea.stackDecorator','useStackContext':true,'paraName':p};};var c=function(p){return{'id':'plotArea.sliceRenderer.pieSliceRenderer','infoClass':P,'vizPath':'plotArea.sliceRenderer','paraName':p};};var d=function(p){return{'id':'plotArea.markerRenderer.lineMarkerRenderer','infoClass':L,'vizPath':'plotArea.markerRenderer','paraName':p};};D.instance=function(){return{'line.iconSVG':{'renderer':d('iconSVG')},'line.iconColor':{'renderer':d('iconColor')},'line.iconSize':{'renderer':d('iconSize')},'dataPointShape':{'renderer':_('dataPointShape')},'stackShape':{'renderer':b('stackShape')},'dataPointShapeFill':{'renderer':_('dataPointShapeFill')},'sliceShape':{'renderer':c('sliceShape')},'sliceShapeFill':{'renderer':c('sliceShapeFill')},'centerName.fontFamily':{'vizPath':'plotArea.highlight.centerName.style.fontFamily'},'centerName.fontSize':{'vizPath':'plotArea.highlight.centerName.style.fontSize'},'centerName.fontWeight':{'vizPath':'plotArea.highlight.centerName.style.fontWeight'},'centerName.fontColor':{'vizPath':'plotArea.highlight.centerName.style.color'},'centerName.fontStyle':{'vizPath':'plotArea.highlight.centerName.style.fontStyle'},'centerValue.fontFamily':{'vizPath':'plotArea.highlight.centerValue.style.fontFamily'},'centerValue.fontSize':{'vizPath':'plotArea.highlight.centerValue.style.fontSize'},'centerValue.fontWeight':{'vizPath':'plotArea.highlight.centerValue.style.fontWeight'},'centerValue.fontColor':{'vizPath':'plotArea.highlight.centerValue.style.color'},'centerValue.fontStyle':{'vizPath':'plotArea.highlight.centerValue.style.fontStyle'}};};return D;});u('sap/viz/controls/chart/adapters/config/ValueAxisPropConfig',[],function(){var V={};V.instance=function(){return{'fontFamily':{'vizPath':'valueAxis.label.style.fontFamily'},'fontSize':{'vizPath':'valueAxis.label.style.fontSize'},'fontWeight':{'vizPath':'valueAxis.label.style.fontWeight'},'fontColor':{'vizPath':'valueAxis.label.style.color'},'fontStyle':{'vizPath':'valueAxis.label.style.fontStyle'}};};return V;});u('sap/viz/controls/chart/adapters/config/ChartTitlePropConfig',[],function(){var C={};C.instance=function(){return{'fontFamily':{'vizPath':'title.style.fontFamily'},'fontSize':{'vizPath':'title.style.fontSize'},'fontWeight':{'vizPath':'title.style.fontWeight'},'fontColor':{'vizPath':'title.style.color'},'fontStyle':{'vizPath':'title.style.fontStyle'}};};return C;});u('sap/viz/controls/chart/adapters/config/ChartAreaPropConfig',[],function(){var C={};C.instance=function(){return{'fill':{'vizPath':'general.background.color'}};};return C;});u('sap/viz/controls/chart/adapters/config/PlotAreaPropConfig',[],function(){var P={};P.instance=function(){return{'fill':{'vizPath':'plotArea.background.color'}};};return P;});u('sap/viz/controls/chart/adapters/config/CategoryAxisTitlePropConfig',[],function(C){var a={};a.instance=function(){return{'fontFamily':{'vizPath':'categoryAxis.title.style.fontFamily'},'fontSize':{'vizPath':'categoryAxis.title.style.fontSize'},'fontWeight':{'vizPath':'categoryAxis.title.style.fontWeight'},'fontColor':{'vizPath':'categoryAxis.title.style.color'},'fontStyle':{'vizPath':'categoryAxis.title.style.fontStyle'}};};return a;});u('sap/viz/controls/chart/adapters/config/ValueAxisTitlePropConfig',[],function(C){var V={};V.instance=function(){return{'fontFamily':{'vizPath':'valueAxis.title.style.fontFamily'},'fontSize':{'vizPath':'valueAxis.title.style.fontSize'},'fontWeight':{'vizPath':'valueAxis.title.style.fontWeight'},'fontColor':{'vizPath':'valueAxis.title.style.color'},'fontStyle':{'vizPath':'valueAxis.title.style.fontStyle'}};};return V;});u('sap/viz/controls/chart/adapters/config/LegendPropConfig',[],function(){var L={};L.instance=function(){return{'fontFamily':{'vizPath':'legend.label.style.fontFamily'},'fontSize':{'vizPath':'legend.label.style.fontSize'},'fontWeight':{'vizPath':'legend.label.style.fontWeight'},'fontColor':{'vizPath':'legend.label.style.color'},'fontStyle':{'vizPath':'legend.label.style.fontStyle'},'title-fontFamily':{'vizPath':'legend.title.style.fontFamily'},'title-fontSize':{'vizPath':'legend.title.style.fontSize'},'title-fontWeight':{'vizPath':'legend.title.style.fontWeight'},'title-fontColor':{'vizPath':'legend.title.style.color'},'title-fontStyle':{'vizPath':'legend.title.style.fontStyle'}};};return L;});u('sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var C=function(a,v){C.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo';this.generator='categoryAxisLabelRenderer';};O.extend(C,R);C.prototype._renderGeneral=function(p){if(p.iconVisible===true||p.textVisible===false){return true;}else{return false;}};C.prototype._renderSpecified=function(p){if(p.iconVisible===true||p.textVisible===false){return true;}else{return p.fontFamily!==undefined||p.fontSize!==undefined||p.fontWeight!==undefined||p.fontColor!==undefined||p.fontStyle!==undefined;}};C.prototype._ignoreKey=function(p,a,b){switch(p){case'fontFamily':if(a.fontFamily===undefined){return true;}break;case'fontSize':if(a.fontSize===undefined){return true;}break;case'fontWeight':if(a.fontWeight===undefined){return true;}break;case'fontColor':if(a.fontColor===undefined){return true;}break;case'fontStyle':if(a.fontStyle===undefined){return true;}break;}return false;};return C;});u('sap/viz/controls/chart/adapters/config/CategoryAxisPropConfig',['sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo'],function(C){var a={};var _=function(p){return{'id':'categoryAxis.labelRenderer.categoryAxisLabelRenderer','infoClass':C,'vizPath':'categoryAxis.labelRenderer','paraName':p};};a.instance=function(){return{'textVisible':{'renderer':_('textVisible')},'iconSVG':{'renderer':_('iconSVG')},'iconColor':{'renderer':_('iconColor')},'iconSize':{'renderer':_('iconSize')},'iconVisible':{'renderer':_('iconVisible')},'fontFamily':{'renderer':_('fontFamily'),'vizPath':'categoryAxis.label.style.fontFamily'},'fontSize':{'renderer':_('fontSize'),'vizPath':'categoryAxis.label.style.fontSize'},'fontWeight':{'renderer':_('fontWeight'),'vizPath':'categoryAxis.label.style.fontWeight'},'fontColor':{'renderer':_('fontColor'),'vizPath':'categoryAxis.label.style.color'},'fontStyle':{'renderer':_('fontStyle'),'vizPath':'categoryAxis.label.style.fontStyle'}};};return a;});u('sap/viz/controls/chart/adapters/renderer/LineRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var L=function(a,v){L.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/LineRendererInfo';this.generator='lineRenderer';};O.extend(L,R);L.prototype._renderGeneral=function(p){if(p.dash||p.color){return true;}else{return false;}};L.prototype._renderSpecified=function(p){if(p.dash||p.color||p.width){return true;}else{return false;}};return L;});u('sap/viz/controls/chart/adapters/config/LinePropConfig',['sap/viz/controls/chart/adapters/renderer/LineRendererInfo'],function(L){var a={};var _=function(p){return{'id':'plotArea.lineRenderer','infoClass':L,'vizPath':'plotArea.lineRenderer','paraName':p};};a.instance=function(){return{'lineFill':{'renderer':_('color')},'lineStyle':{'renderer':_('dash')},'plotArea.width':{'renderer':_('width'),'vizPath':'plotArea.width'}};};return a;});u('sap/viz/controls/chart/adapters/PropertyMap',['sap/viz/controls/chart/adapters/config/DataLabelPropConfig','sap/viz/controls/chart/adapters/config/DataPointPropConfig','sap/viz/controls/chart/adapters/config/ValueAxisPropConfig','sap/viz/controls/chart/adapters/config/ChartTitlePropConfig','sap/viz/controls/chart/adapters/config/ChartAreaPropConfig','sap/viz/controls/chart/adapters/config/PlotAreaPropConfig','sap/viz/controls/chart/adapters/config/CategoryAxisTitlePropConfig','sap/viz/controls/chart/adapters/config/ValueAxisTitlePropConfig','sap/viz/controls/chart/adapters/config/LegendPropConfig','sap/viz/controls/chart/adapters/config/CategoryAxisPropConfig','sap/viz/controls/chart/adapters/config/LinePropConfig','sap/viz/controls/common/property/VizPropertyZone'],function(D,a,V,C,b,P,c,d,L,e,f,g){var h={};h.getPropConfig=function(z,k){switch(z){case g.DATA_LABEL:return D.instance();break;case g.DATA_POINT:return a.instance();break;case g.X_AXIS:if(k){return V.instance();}else{return e.instance();}break;case g.CHART_TITLE:return C.instance();break;case g.CHART_AREA:return b.instance();break;case g.PLOT_AREA:return P.instance();break;case g.X_AXIS_TITLE:if(k){return d.instance();}else{return c.instance();}break;case g.Y_AXIS_TITLE:if(k){return c.instance();}else{return d.instance();}break;case g.LEGEND:return L.instance();break;case g.Y_AXIS:if(k){return e.instance();}else{return V.instance();}break;case g.LINE:return f.instance();break;};};return h;});u('sap/viz/controls/chart/adapters/PropFnGenerator',[],function(){var P=function(n,f){this.__className="sap.viz.controls.chart.adapters.PropFnGenerator";this._name=n;this._fn=f;};prototype=P.prototype;prototype.generateFn=function(p){return this._fn.apply(null,[p]);};prototype.getName=function(){return this._name;};return P;});u('sap/viz/controls/chart/adapters/PropFnGeneratorRegistry',['sap/viz/controls/chart/adapters/PropFnGenerator'],function(P){var a={};var _={};a.register=function(n,f){var g=_;if(g.hasOwnProperty(n)){throw"PropFnGenerator '"+n+"' exists.";}g[n]=new P(n,f);};a.unregister=function(n){delete _[n];};a.get=function(n){return _[n];};return a;});u('sap/viz/controls/chart/adapters/PropertyAdapter',['require','jquery','sap/viz/controls/chart/adapters/PropertyMap','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/chart/adapters/PropFnGeneratorRegistry','sap/viz/controls/chart/adapters/renderer/RendererInfoBase','sap/viz/controls/common/utils/ChartTypeUtil'],function(r,$,P,E,V,O,U,a,R,C){var A=r||A;var b=function(h,c){b.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.adapters.PropertyAdapter';this._helper=h;this._rendererInfo={};if(c){this._loadRendererInfo(c);}};O.extend(b,E);b.prototype.query=function(o){if(o&&o.propertyZones){var z=o.propertyZones;var p=o.propertyFields;var c=o.chartType;var m;for(var d in z){var e={};for(var l in p){if(p[l]===true){var f=z[d];var g=P.getPropConfig(f.type(),C.isHorizontal(c));if(g&&g[l]){var h=g[l];h.vizPath=h.vizPath||l;if(h.vizPath){e[l]=this._getVizProp(h.vizPath);}if(h.renderer){h.renderer.paraName=h.renderer.paraName||l;var k=this._rendererInfo[h.renderer.id];if(k){var n=f.getDimensionContext();if(h.renderer.useStackContext){n=f.stackContext();}var q=k.getProperty(n,h.renderer.paraName);if(q!==undefined){e[l]=q;}}}}else{e[l]=this._getVizProp(l);}}}if(!m){m=e;}else{for(var l in e){if(!U.deepEqual(m[l],e[l])){m[l]=null;}}}}return m;}return null;};b.prototype._getCfg=function(p,c){for(var l in p){if(p&&p[l]&&p[l].renderer&&p[l].renderer.paraName===c){return p[l];}}return null;};b.prototype.update=function(o){if(!o||!o.propertyZones){return;}var p=o.propertyZones;var c=o.properties;var d=o.chartType;var e={};var n={};for(var i in p){var f=p[i];var g=P.getPropConfig(f.type(),C.isHorizontal(d));var h={};for(var k in c){var l=c[k];if(g&&g[k]){var m=g[k];if(m.renderer){var q=m.renderer;if(!this._rendererInfo[q.id]){this._rendererInfo[q.id]=new q.infoClass(q.id,q.vizPath);}h[q.id]=this._rendererInfo[q.id];var s=f.getDimensionContext();if(q.useStackContext===true){s=f.stackContext();}this._rendererInfo[q.id].setProperty(s,q.paraName,l);}else if(m.vizPath){n[m.vizPath]=l;}}else{n[k]=l;}}for(var t in h){var v=h[t];if(v.simplify().length>0){e[v.vizPath]=v;}else{e[v.vizPath]=undefined;}if(v.fallbackParas()){var w=v.fallbackParas();for(var x in w){var y=w[x];var m=this._getCfg(g,x);if(m&&m.vizPath){n[m.vizPath]=y;}}}}}var c={};for(var z in e){var v=e[z];if(v){b._parseVizPath(z,b._getRenderer(v.generator,v.parameters()),c);}else{b._parseVizPath(z,null,c);}}for(var z in n){b._parseVizPath(z,n[z],c);}this._helper.vizProperties(c);};b.prototype._getVizProp=function(p){var v=this._helper.vizProperties();try{var c=p.split('.');for(var i in c){v=v[c[i]];}}catch(e){return undefined;}return v;};b.prototype.saveRendererInfo=function(){var c={};for(var d in this._rendererInfo){c[d]=this._rendererInfo[d].toJSON();}return c;};b.parseRendererInfo=function(c,p){p=p||{};for(var d in c){var e=c[d];b._parseVizPath(e.vizPath,b._getRenderer(e.generator,e.parameters),p);}return p;};b.prototype._loadRendererInfo=function(c){var d=[];for(var e in c){var f=c[e];d.push(f.implClassPath);}for(var e in c){this._rendererInfo[e]=R.fromJSON(c[e]);}};b._getRenderer=function(n,p){var g=a.get(n);return(g)?g.generateFn(p):null;};b._parseVizPath=function(v,c,p){var d=v.split('.');if(d.length>0){var t=p;for(var i=0;i<d.length;i++){if(i===d.length-1){t[d[i]]=c;break;}t[d[i]]=t[d[i]]||{};t=t[d[i]];}}return p;};return b;});u('sap/viz/controls/chart/views/InfoChartView',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/chart/adapters/InteractionAdapter','sap/viz/controls/chart/adapters/PropertyAdapter','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/View'],function($,O,C,a,L,b,c,d,F,V,I,e,P,f,g){var h=function(k,o,l,m){h.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.views.InfoChartView';this._useBuiltInPropertyZoneInteraction=o.useBuiltInPropertyZoneInteraction;this._iAdapter=null;this._pAdapter=null;this._rendererInfo=null;this._createChildren();};O.extend(h,g);h.prototype._createChartInstance=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create');if(!this._options){return;}var o=this._options;if(this._useBuiltInPropertyZoneInteraction===true){o.properties=o.properties||{};o.properties.interaction={behaviorType:'DesignTimeBehavior'};}this._destroyChartInstance();this._updateDescription();this._chart=sap.viz.api.core.createViz({type:o.type,data:o.data,feeding:o.feeding,properties:o.properties,css:o.css,events:o.events,container:this._chartLayer$.get(0)});this._postVizProcess(o);this._chart.on('initialized.create',$.proxy(function(){if(!this._chart){return;}this._chart.off('initialized.create');if(!this._iAdapter){this._iAdapter=new e(this._helper);this._iAdapter.addEventListener(f.PROPERTY_ZONES_CHANGED,function(k){this._dispatchEvent(new f(f.PROPERTY_ZONES_CHANGED,this,k.data));},this);}if(!this._pAdapter){this._pAdapter=new P(this._helper,this._rendererInfo);this._pAdapter._ownerDom$=this._dom$;}this._dispatchEvent(new f(f.PROPERTY_ZONES_CHANGED,this,{'propertyZones':[new V(V.CHART_AREA)]}));},this));sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_chartView-create');};h.prototype.hasChartInstance=function(){return this._chart!==null;};h.prototype.properties=function(v){if(arguments.length>0){this._options.properties=v;if(this._chart){this._chart.properties(v);return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._chart){return this._chart.properties();}else{return this._options.properties;}}};h.prototype.copyData=function(t,k){var r=k.data();var l=new sap.viz.api.data.FlatTableDataset(r);return l;};h.prototype.buildFeedings=function(t,k,l){var n=null;var m=false;if(F.hasMND(l)||(F.countAnalyses(l,c.MEASURE)===0)){n=l;}else{var v=I.getVizType(t);n=d.directFeeding(l,v,[b.genMND()]);m=true;}return I.buildInfoFeeding(n,m);};h.prototype.feeding=function(k){try{if(this._chart){if(arguments.length>0){this._chart.feeding(k);return this;}else{return this._chart.feeding();}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(l){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+l;}};h.prototype.getPropertyZones=function(){if(this._iAdapter){return this._iAdapter.propertyZones();}else{return[];}};h.prototype.setPropertyZones=function(p){if(this._iAdapter){this._iAdapter.propertyZones(p);}};h.prototype.queryProperties=function(o){return this._pAdapter?this._pAdapter.query(o):{};};h.prototype.updateProperties=function(o){if(this._pAdapter){this._pAdapter.update(o);}};h.prototype.save=function(){if(this._pAdapter){return{'pAdapter':{'rendererInfo':this._pAdapter.saveRendererInfo()}};}else{return{};}};h._migrateRenderInfo=function(r){var k="categoryAxis.labelRenderer.categoryAxisLabelRenderer";if(!r||r[k]){return;}var l;var x="xAxis.labelRenderer.categoryAxisLabelRenderer";var y="yAxis.labelRenderer.categoryAxisLabelRenderer";if(r[x]){l=r[x];delete r[x];}else if(r[y]){l=r[y];delete r[y];}if(l){r[k]=l;l.id=k;l.vizPath="categoryAxis.labelRenderer";}};h.prototype.load=function(k,v){if(k&&k.pAdapter){h._migrateRenderInfo(k.pAdapter.rendererInfo);this._rendererInfo=k.pAdapter.rendererInfo;P.parseRendererInfo(k.pAdapter.rendererInfo,v);}};h.prototype.css=function(k){try{if(arguments.length>0){this._updateCssCacheByNewCss(k);this._options.css=k;if(this._chart){this._chart.css(k);return this;}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._chart){return this._chart.css();}else{return this._options.css;}}}catch(l){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+l;}};h.prototype.data=function(k){if(this._chart){try{if(arguments.length>0){this._chart.app.setDataset(k);}else{return this._chart.app.getDataset();}}catch(l){errorMsg=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+l;this._updateDescription(errorMsg);throw errorMsg;}}else{return h.superclass.data.apply(this,arguments);}};h.prototype.exportViz=function(o){if(this._chart){var r=this._chart.toJSON(o);if(r){r.properties=this._options.properties;delete r.css;}return r;}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};return h;});u('sap/viz/controls/chart/views/ESRIServicePanel',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent'],function($,C,O,V,L,a){var E=function(d,b){E.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIServicePanel";this._uiconfig=b;this._div=d;this._serviceGallery$=null;this.createChildren();};O.extend(E,V);E.prototype.createChildren=function(){this._serviceGallery$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery').appendTo(this._div);};E.prototype.init=function(s,t,b){var c=this;var d=function(){$('.'+C.CHART_PREFIX+'map-service-selector-services-item-icon').removeClass(C.CHART_PREFIX+'map-service-selector-services-item-icon-selected');$(this).addClass(C.CHART_PREFIX+"map-service-selector-services-item-icon-selected");c._dispatchEvent(new a(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,this,{serviceId:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceId"),}));};this._serviceGallery$.empty();if(s&&s.length>0){var e,f,g,h;for(var i=0;i<s.length;i++){e=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item').appendTo(this._serviceGallery$);f=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item-icon').appendTo(e);f.attr("title",s[i].description);f.data("__serviceId",s[i].id);f.data("__serviceUrl",s[i].url);f.on("click",d);g=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item-title').appendTo(e);g.html(s[i].title);h="url(https://www.arcgis.com/sharing/rest/content/items/"+s[i].id+"/info/"+s[i].thumbnail+"?token="+t+")";f.css({"background-image":h});if(b&&b===s[i].id){f.addClass(C.CHART_PREFIX+"map-service-selector-services-item-icon-selected");}}}};E.prototype.getSelectedService=function(){return{id:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceId"),url:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceUrl")};};E.prototype.show=function(){this._serviceGallery$.show();};E.prototype.hide=function(){this._serviceGallery$.hide();};return E;});u('sap/viz/controls/chart/views/ESRIServiceColor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent'],function($,C,O,V,L,a){var E=function(d,b){E.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIServiceColor";this._uiconfig=b;this._div=d;this._serviceColor$=null;this._fieldsSelector$=null;this._startVal$=null;this._startColor$=null;this._endVal$=null;this._endColor$=null;this.createChildren();};O.extend(E,V);E.prototype.createChildren=function(){this._serviceColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-panel').appendTo(this._div);$(document.createElement('div')).html(L.get('VIZ_CHART_SELECT_DATASET')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-title').appendTo(this._serviceColor$);this._fieldsSelector$=$(document.createElement('select')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-selector').appendTo(this._serviceColor$);this.createGradient();};E.prototype.createGradient=function(){var g=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-title-group').appendTo(this._serviceColor$);$(document.createElement('div')).html(L.get('VIZ_CHART_SET_COLOR_LAYER')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-title-label').appendTo(g);this._reset$=$(document.createElement('div')).html(L.get("VIZ_CHART_RESET")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-reset').on("click",function(){this._startVal$.val(this._startVal$.prop("defaultValue"));this._endVal$.val(this._endVal$.prop("defaultValue"));}.bind(this)).appendTo(g);var b=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient').appendTo(this._serviceColor$);$(document.createElement('div')).html(L.get("VIZ_CHART_START")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-start').appendTo(b);var s=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value-group1').appendTo(b);this._startVal$=$(document.createElement('input')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value').attr("value","0").appendTo(s);this._startColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-colorpicker').css("background-color","#c2e3a9").appendTo(s);$(document.createElement('div')).html(L.get("VIZ_CHART_END")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-end').appendTo(b);s=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value-group2').appendTo(b);this._endVal$=$(document.createElement('input')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value').attr("value","100").appendTo(s);this._endColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-colorpicker').css("background-color","#35581C").appendTo(s);};E.prototype.init=function(s,c){$.ajax({url:s,data:{f:"json"},dataType:"json",type:"POST",success:function(r){this._fieldsSelector$.empty();var v=r.fields.filter(function(f){return f.type==="esriFieldTypeSmallInteger"||f.type==="esriFieldTypeInteger"||f.type==="esriFieldTypeSingle"||f.type==="esriFieldTypeDouble";});for(var i=0;i<v.length;i++){$(document.createElement('option')).attr('value',v[i].name).html(v[i].name).appendTo(this._fieldsSelector$);}}.bind(this)});};E.prototype.show=function(){this._serviceColor$.show();};E.prototype.hide=function(){this._serviceColor$.hide();};E.prototype.getColor=function(){return{type:"gradient",bindedField:this._fieldsSelector$.val(),start:{val:this._startVal$.val(),color:this._startColor$.css("background-color")},end:{val:this._endVal$.val(),color:this._endColor$.css("background-color")}}};return E;});u('sap/viz/controls/chart/views/ESRIServiceSelector',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/ESRIServicePanel','sap/viz/controls/chart/views/ESRIServiceColor'],function($,C,O,V,L,a,E,b){var c=function(d,e){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIMapServiceSelector";this._uiconfig=e;this._div=d;this._titleDiv$=null;this._footerDiv$=null;this._servicesDiv$=null;this._servicePanel=null;this._serviceColor=null;this._btnDone$=null;this._btnLayer$=null;this._btnConfirm$=null;this.createChildren();};O.extend(c,V);c.prototype.createChildren=function(){this._titleDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-title').html(L.get('VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE')).appendTo($(this._div));this._servicesDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-panel').appendTo($(this._div));this._servicePanel=new E(this._servicesDiv$);this._serviceColor=new b(this._servicesDiv$);$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery-close').on("click",function(){this.hide();}.bind(this)).appendTo($(this._div));this._servicePanel.addEventListener(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,function(e){if(e.data.serviceId){this._btnConfirm$.show();this._btnDone$.hide();}else{this._btnConfirm$.hide();this._btnDone$.show();}}.bind(this));this._footerDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-footer').appendTo($(this._div));this._btnDone$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-done').html(L.get('VIZ_CHART_CONFIRM')).on("click",function(){this.hide();this._dispatchEvent(new a(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,this,{serviceId:this._servicePanel.getSelectedService().id,color:this._serviceColor.getColor()}));}.bind(this)).appendTo(this._footerDiv$);this._btnConfirm$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-confirm').html(L.get('VIZ_CHART_NEXT')).on("click",function(){this._btnConfirm$.hide();this._btnDone$.show();this._btnLayer$.show();this._servicePanel.hide();this._serviceColor.init(this._servicePanel.getSelectedService().url);this._serviceColor.show();}.bind(this)).appendTo(this._footerDiv$);this._btnLayer$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-layer').html(L.get('VIZ_CHART_BACK')).on("click",function(){this._servicePanel.show();this._serviceColor.hide();this._btnConfirm$.show();this._btnLayer$.hide();this._btnDone$.hide();}.bind(this)).appendTo(this._footerDiv$);this._servicePanel.show();this._serviceColor.hide();this._btnConfirm$.show();this._btnLayer$.hide();this._btnDone$.hide();};c.prototype.show=function(s,t,d){this._servicePanel.init(s,t,d);if(!d){this._btnConfirm$.hide();this._btnDone$.show();}else{this._btnLayer$.hide();this._btnDone$.hide();this._btnConfirm$.show();}this._servicePanel.show();this._serviceColor.hide();$(this._div).show();};c.prototype.hide=function(){$(this._div).hide();};return c;});u('sap/viz/controls/chart/views/EsriNoService',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager'],function setup($,C,l){var E=function(d){this.__className="sap.viz.controls.chart.views.EsriNoSerive";this._div=d;this._titleDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-no-service-title').html(l.get('VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE')).appendTo($(this._div));this._messageDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-no-serive-message').html(l.get('VIZ_CHART_NO_ESRI_SERVICE')).appendTo($(this._div));$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery-close').on("click",function(){this.hide();}.bind(this)).appendTo($(this._div));};E.prototype.hide=function(){$(this._div).hide();};E.prototype.show=function(){$(this._div).show();};return E;});u('sap/viz/controls/chart/views/MapView',['require','jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/chart/views/ESRIServiceSelector','sap/viz/controls/chart/views/EsriNoService'],function(r,$,G,C,D,M,E,F,a,b,L,O,c,d,T,V,g,h,k,l,I,m,n,o,p){var A=r||A;var q=function(e,f,w){e.splice(w,0,e.splice(f,1)[0]);};var s=function(e,f,w,x){s.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.MapView";this._mapselector$=null;this._mapNoService$=null;this._mapNoService=null;this._mapServiceSelector=null;this._esriservices=null;this._selectedServiceId=undefined;this._loadedViz=null;this._mapInitialized=false;this._updateCache=null;this._createChildren();sap.viz.extapi.env.Template.removeListener(this._changeTemplateFunc);};O.extend(s,l);s.prototype._createChildren=function(){s.superclass._createChildren.apply(this,arguments);this._createESRIMapServiceSelector();};s.prototype._createESRIMapServiceSelector=function(){this._mapselector$=$(document.createElement('div')).addClass(g.CHART_PREFIX+'map-service-selector').appendTo($(this._div));this._mapNoService$=$(document.createElement('div')).addClass(g.CHART_PREFIX+'map-no-service').appendTo($(this._div));this._mapNoService=new p(this._mapNoService$);this._mapNoService.hide();this._mapServiceSelector=new o(this._mapselector$);this._mapServiceSelector.addEventListener(h.ESRI_CUSTOMIZED_SERVICE_CHANGED,this._esriServiceChanged.bind(this));this._mapServiceSelector.hide();};s.prototype._esriServiceChanged=function(e){var f=e.data.serviceId;this._selectedServiceColor=e.data.color;this._enableService=true;if(!this._selectedServiceId){this._chartModelProvider().extensionValues({mapBuilder:{mapservice:{showRadio:true,checked:this._enableService}}});}this._selectedServiceId=f;this._changeBaseMap({serviceId:f,color:this._selectedServiceColor});};s.prototype._changeBaseMap=function(e){var f=e.serviceId;var w=e.color;var x;if(!f){x=new sap.viz.geo.basemap.esri.Provider({basemap:this._chart.baseMap().toJSON().options.basemap});}else{var y=this._esriservices.filter(function(z){return z.id===f;});var z=[{}];z[0].type=sap.viz.geo.basemap.esri.Provider.ARCGIS_SERVICE_TYPE_FEATURE;z[0].url=y[0].url;z[0].options={outFields:["*"]};z[0].color=w;x=new sap.viz.geo.basemap.esri.Provider({extent:new esri.geometry.Extent(-115,-34,115,7),basemap:this._chart.baseMap().toJSON().options.basemap},z);}this._chart.baseMap(x);};s.prototype._showRefreshButton=function(){this._refresh$.css({left:$(this._div).width()/2-this._refresh$.width()/2});this._refresh$.css({top:$(this._div).height()/2-this._refresh$.height()/2+40});this._refresh$.show();};s.prototype.modelChanged=function(e,f){if(f.vizTypeChanged){this.showLoadingIcon();}if(f.feedingItemsChanged&&f.feedsChangedInfo&&f.feedsChangedInfo.items){var w=f.feedsChangedInfo.items[0];var x=e.feedingItems()[w];var y=new F(F.FEEDS_CHANGED,this,{'datasetType':D.FlatTableDataset,'feeds':x,'layerIdx':w});this._dispatchEvent(new E(l.DISPATCH_PROPERTY_EVENT,this,y));}if(f.extensionValuesChanged){var z=e.extensionValues();if(z.mapBuilder){var H=z.mapBuilder;var J=this._chart;if(H&&J){if(H.layer){var K=H.layer.action;var w=H.layer.idx;var N=H.layer.from;var P=H.layer.to;if(K==='add'){J.addLayer(new sap.viz.geo.dataviz.Layer({viz:new sap.viz.geo.dataviz.Choropleth(),legendVisible:true}),true);var Q=e.feedingItems();Q.push(H.layer.feeds);e.feedingItems(Q,false);}else if(K==='delete'&&w>=0){J.removeLayer(J.getLayer(w));var Q=e.feedingItems();Q.splice(w,1);e.feedingItems(Q,false);}else if(K==='reorder'&&N>=0&&P>=0){J.reorderLayer(J.getLayer(N),P);var R=e.feedingItems();q(R,N,P);e.feedingItems(R,false);}else if(K==='show'&&w>=0){var S=J.getLayer(w);S.visibility(true);}else if(K==='hide'&&w>=0){var S=J.getLayer(w);S.visibility(false);}else if(K==='changeVizType'&&w>=0){var S=J.getLayer(w);var U=H.layer.vizType;var W=H.layer.feeding;var X,Y,Z,_,a1,b1;if(W!==null){for(var i=0;i<W.length;i++){Y=W[i];if(Y){for(var j=0;j<Y.values().length;j++){var id=Y.values()[j].id();if(Y.id()==="location"){Z=id;}else if(Y.id()==="color"){_=id;a1=Y.type();}else if(Y.id()==="size"){b1=id;}}}}S.data(null);}if(U==='choropleth'){if(W!==null){X={};if(Z){X.location=Z;}if(a1===a.MEASURE&&_){X.color=_;}S.viz(new sap.viz.geo.dataviz.Choropleth(),X);}else{S.viz(new sap.viz.geo.dataviz.Choropleth());}}else if(U==='bubble'){if(W!==null){X={};if(Z){X.location=Z;}if(b1){X.size=b1;}if(a1===a.DIMENSION&&_){X.color=_;}S.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false}}),X);}else{S.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false}}));}}else if(U==='marker'){if(W!==null){X={};if(Z){X.location=Z;}S.viz(new sap.viz.geo.dataviz.Marker({width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false}}),X);}else{S.viz(new sap.viz.geo.dataviz.Marker({width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false}}));}}}else if(K==='changeProperties'&&w>=0){var S=J.getLayer(w);var d1=H.layer.propKey;var e1=H.layer.propValue;if(d1==='markerCluster'||d1==='bubbleCluster'){S.viz().properties({cluster:{enabled:e1}});}}}else if(H.mapservice){if(H.mapservice.action==='choose'){this._chooseMapServiceAsBaseMap();}else if(H.mapservice.action==='enable'){this._enableService=true;this._changeBaseMap({serviceId:this._selectedServiceId,color:this._selectedServiceColor});}else if(H.mapservice.action==='disable'){this._mapServiceSelector.hide();this._enableService=false;this._changeBaseMap({});}}}}}};s.prototype.data=function(e){try{if(arguments.length>0){if(this._chart){if(!e.length){return this;}var f=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var w=f.length>e.length?e.length:f.length;for(var i=0;i<w;++i){if(e[i]){f[i].data(e[i]);}}return this;}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{var x=[];if(this._chart){var f=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<f.length;++i){x.push(f[i].data());}}return x;}}catch(y){throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+y;}};s.prototype.action=function(e,f){if(this._chart){if(this._chart.__instance){return this._chart.__instance.action(e,f);}else{return this._chart;}}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};s.prototype.exportViz=function(e){if(!this._isMapInitialized()&&this._loadedViz){return this._loadedViz;}if(this._chart){var f=this._chart.toJSON(e);f.esriServices=[this._exportEsriService()];return f;}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};s.prototype._exportEsriService=function(){return{serivceId:this._selectedServiceId,color:this._selectedServiceColor,enableService:!!this._enableService};};s.prototype._loadEsriService=function(e){if(e.esriServices&&e.esriServices.length>0){this._selectedServiceId=e.esriServices[0].serivceId;this._selectedServiceColor=e.esriServices[0].color;this._enableService=e.esriServices[0].enableService;}};s.prototype.loadViz=function(e){this._destroyChartInstance();if(!e.baseMap){this._createChartInstance();return;}this._loadedViz=c.clone(e);this._loadEsriService(this._loadedViz);this._hasChartInstance=true;this._mapInitialized=false;this._dispatchEvent(new h(h.CHART_CHANGING,this,e.type));this._updateDescription();this.showLoadingIcon();var f={};if(e.properties&&e.properties.tooltip){f.tooltip=e.properties.tooltip;}var w=this._chartLayer$;var x=sap.viz.api.core.createViz({type:e.type,container:w.get(0),options:f});this._chart=x.action("getMap");this._chart.__instance=x;this._bindExternalEventListener();if(e.baseMap.id.indexOf("esri")!==-1){this._logonESRI(function(){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));this._chart.fromJSON(e);this._postVizProcess(this._options);}.bind(this),function(){this._hasChartInstance=false;this._chartModelProvider().extensionValues({map:{logOnFail:true}});if(this._chart){this._chart._fireEvent("initialized");}}.bind(this));}else if(e.baseMap.id.indexOf("cvom")!==-1){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});this._chart.fromJSON(e);this._postVizProcess(this._options);}else if(e.baseMap.id.indexOf("navtaq")){this._chart.fromJSON(e);this._postVizProcess(this._options);}};s.prototype._setChartSize=function(w,e){if(this._chart&&this._chart.__instance){this._chart.__instance.size({width:w,height:e});}};s.prototype._updateDescription=function(e){if(e){this._descriptionLayer$.show();this._descriptionLayer$.text(e);this._showDescription();}else{this._descriptionLayer$.hide();this._chartHolder$.css({'opacity':""});}this.hideLoadingIcon();};s.prototype.getTitleByFeeding=function(){return'';};s.prototype._logonESRI=function(e,f){var w=sap.viz.geo.basemap.esri.Authentication.credential().disabled;if(w){this._updateDescription(sap.viz.geo.basemap.esri.Authentication.credential().description);f.call(this);return;}var x=sap.viz.geo.basemap.esri.Authentication.credential().accessToken;if(!x){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOG_ON'));sap.viz.geo.basemap.esri.Authentication.login({credential:{}},function(){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));e.call(this);}.bind(this),function(y){if(y===null||y===undefined||y===''){this._updateDescription(L.get('VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE'));}else{this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL')+": "+y);}f.call(this);}.bind(this));}else{this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOG_ON'));sap.viz.geo.basemap.esri.Authentication.checkLoginStatus(x,function(){e.call(this);}.bind(this),function(y){if(y===null||y===undefined||y===''){this._updateDescription(L.get('VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE'));}else{this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL')+": "+y);}f.call(this);}.bind(this))}};s.prototype._createChartInstance=function(){var e=this._options;var f=this._chartLayer$;var w=this._descriptionLayer$;var x=this._chartHolder$;var y=C.TYPE_GEO_MAP;this._destroyChartInstance();try{this._dispatchEvent(new h(h.CHART_CHANGING,this,y));var z=sap.viz.api.core.createViz({type:y,container:f.get(0),options:{tooltip:this.properties().tooltip}});this._chart=z.action("getMap");this._chart.__instance=z;this._bindExternalEventListener();this._hasChartInstance=true;this._mapInitialized=false;var H=M.ESRI;if(H===M.ESRI){this._logonESRI(function(){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));var J=this.createBaseMap(H,{});this._chart.baseMap(J,this._afterMapInitialized.bind(this));this._postVizProcess(e);}.bind(this),function(){this._hasChartInstance=false;this._chartModelProvider().extensionValues({map:{logOnFail:true}});if(this._chart){this._chart._fireEvent("initialized");}}.bind(this));}else{var J=this.createBaseMap(H,{});this._chart.baseMap(J,this._afterMapInitialized.bind(this));this._postVizProcess(e);}}catch(K){var N=L.get('VIZ_CHART_CREATE_CHART_FAILED')+K;if(!b.getVizFeeds(y)){this._updateDescription(c.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),y));}else{this._updateDescription(N);}f.html("");this._chart=null;this._hasChartInstance=false;throw N;}};s.prototype._afterMapInitialized=function(e){var f=$.proxy(function(x,e){this._dispatchEvent(new h(h.TRIGGER_CVOM_EVENT,this,{type:x,data:e}));},this);this.hideLoadingIcon();this._updateDescription();var w=this._chartModelProvider();f("initialized",e);if(!this._loadedViz&&this._isMapInitialized()===false){this._chartModelProvider().extensionValues({map:{created:true}});}else if(this._loadedViz){this._restoreMapBuilder();}this._mapInitialized=true;if(this._updateCache){this.update(this._updateCache);this._updateCache=null;}};s.prototype._bindExternalEventListener=function(){if(this._chart){Object.keys(this._onEventMap).forEach($.proxy(function(e){var f=this._onEventMap[e];this._chart.on(e,f);},this));}};s.prototype._postVizProcess=function(e){var f=$.proxy(function(w,x){this._dispatchEvent(new h(h.TRIGGER_CVOM_EVENT,this,{type:w,data:x}));},this);this._chart.on("initialized.chartview",this._afterMapInitialized.bind(this));this._chart.on("mapChanged.chartview",function(){this._chartModelProvider().extensionValues({})}.bind(this));var _=this;this._chart.on("selectData.chartview",function(w){_._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));f("selectData",w);});this._chart.on("deselectData.chartview",function(w){_._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));f("deselectData",w);});this._chart.on("showTooltip.chartview",function(w){f("showTooltip",w);});this._chart.on("hideTooltip.chartview",function(w){f("hideTooltip",w);});this._hasChartInstance=true;this._dispatchEvent(new h(h.CHART_CHANGED,this,this._chart));};s.prototype.getTemplateId=function(e){return this._templateId;};s.prototype._isMapInitialized=function(){return this._mapInitialized;};s.prototype.update=function(e){if(this._isMapInitialized()){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');var f;try{if(e.data){this._options.data=e.data;}var w=e.properties;if(w){this._options.properties=w;}if(!this._chart){f=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(f);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');throw f;}this._updateDescription();this._chartLayer$.css('opacity','');var x=this._chart;if(x){if(e.data){for(var i=0;i<e.data.length;i++){if(e.data[i]||e.data[i]===null){var y=x.getLayer(i);var z=e.feeding?e.feeding[i]:null;if(y){y.data(e.data[i],z,true);}}}}if(w){var H=w.layers;if(H){H.forEach(function(K,N){if(K){v(x.getLayer(N),K.formats);}});}}}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');return this;}catch(J){f=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+J;this._updateDescription(f);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');throw f;}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_mapView-update');}else{this._updateCache=e;}};var t={bubble:{measureFeedId:"size",legendPropName:"sizeLegend"},choropleth:{measureFeedId:"color",legendPropName:"mbcLegend"}};function v(e,f){if(e&&f){var w=e.viz();var x;if(w instanceof sap.viz.geo.dataviz.Marker){x="marker";}else if(w instanceof sap.viz.geo.dataviz.Bubble){x="bubble";}else if(w instanceof sap.viz.geo.dataviz.Choropleth){x="choropleth";}if(x){var y=t[x];if(y){var z=y.measureFeedId;function H(P){var Q=f[P];if(Q){Q=Q[z];Q=Q&&Q[0];}return Q;};var J=H("viz");if(J){var K={};K[y.legendPropName]={formatString:J};w.properties(K);}var N=H("tooltip")||J;if(N){e.tooltipFormat(N);}}}}};s.prototype.feeding=function(f,e){try{if(this._chart){if(arguments.length>0&&f.length>0){var w=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var x=w.length>f.length?f.length:w.length;for(var i=0;i<x;++i){if(f[i]){w[i].feeding(f[i]);}}return this;}else{var y=[];var w=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<w.length;++i){var z=w[i].feeding();y.push(z);}return y;}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(H){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+H;}};s.prototype.getValidProperties=function(e,f){if(f===C.TYPE_GEO_MAP){return e;}return V.getValidProperties(e,f);};s.prototype.properties=function(e){try{if(arguments.length>0){this._options.properties=e;if(this._chart){var f=this._chart;var w=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<w.length;i++){var x=w[i];if(x&&e.legend){x.legendVisibility(e.legend.visible);}}return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._options.properties;}}catch(y){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+y;}};s.prototype.copyData=function(e,f){if(f&&f.length>0){var w=[];for(var i=0;i<f.length;i++){if(f[i]&&f[i].id&&(f[i].id==="sap.viz.data.FlatTableDataset")){var x=sap.viz.api.data.FlatTableDataset.fromJSON(f[i]);w.push(x);}else w.push(f[i]);}return w;}else{return f;}};s.prototype.buildFeedings=function(e,w,x){var y=[];for(var i=0;i<x.length;i++){y[i]={};if(!x[i]||x[i].length===0){continue;}x[i].forEach(function(f){if(f._values&&f._values.length){if(f._values[0].type()===m.HIERARCHY){for(var j=0;j<f._values[0].hierarchyLevels().length;j++){var z=f._values[0].hierarchyLevels()[j];if(z.selected()){y[i][f._id]=z._id;break;}}}else{y[i][f._id]=f._values[0]._id;}}});}return y;};s.prototype.createBaseMap=function(e,f){var w=null;if(e===M.ESRI){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});var x='topo';if(f&&f.type){x=f.type;}return new sap.viz.geo.basemap.esri.Provider({basemap:x});}else if(e===M.NAVTEQ){var y={center:[40.72,-84],zoomLevel:5};return new sap.viz.geo.basemap.navteq.Provider(y);}else{sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});var y={center:[-84,40.72],scale:6000};return new sap.viz.geo.basemap.cvom.Provider(f);}};s.prototype.FeedsToJSON=function(f){var e=[];for(var i=0;i<f.length;i++){e[i]=n.toJSON(f[i]);}return e;};s.prototype.FeedsFromJSON=function(e){var f=[];for(var i=0;i<e.length;i++){f[i]=n.fromJSON(e[i]);}return f;};s.prototype._queryEsriServices=function(e){var f=sap.viz.geo.basemap.esri.Authentication.credential();if(f!=null){var w="https://www.arcgis.com/sharing/rest/content/users/"+f.username;$.ajax({url:w,data:{token:f.accessToken,f:"json"},dataType:"json",type:"POST",success:function(x){if(x.items){this._esriservices=x.items.filter(function(y){return y.type==="Feature Service";});e();}}.bind(this)});}};s.prototype._chooseMapServiceAsBaseMap=function(){this._queryEsriServices(function(){if(this._esriservices&&this._esriservices.length>0){var e=$(this._div).height()/2-this._mapselector$.height()/2;var f=$(this._div).width()/2-this._mapselector$.width()/2;this._mapselector$.css({top:e,left:f});this._mapServiceSelector.show(this._esriservices,sap.viz.geo.basemap.esri.Authentication.credential().accessToken,this._selectedServiceId);}else{var e=$(this._div).height()/2-this._mapNoService$.height()/2;var f=$(this._div).width()/2-this._mapNoService$.width()/2;this._mapNoService$.css({top:e,left:f});this._mapNoService.show();}}.bind(this));};s.prototype._getVizTypeByVizId=function(e){if(e==="sap.viz.geo.dataviz.Bubble"){return"bubble";}else if(e==="sap.viz.geo.dataviz.Marker"){return"marker";}else{return"choropleth";}};s.prototype._restoreMapBuilder=function(e){if(this._loadedViz&&this._loadedViz.layers.length>0){var f=[];var w=this._chartModelProvider().feedingItems();for(var i=0;i<this._loadedViz.layers.length;i++){var x=this._getVizTypeByVizId(this._loadedViz.vizs[this._loadedViz.layers[i].vizIndex].id);var y="";if(w[i].length>0){if(w[i][0].values().length>0){y=w[i][0].values()[0].name();}}var z=false;if(x==="bubble"||x==="marker"){z=this._loadedViz.vizs[this._loadedViz.layers[i].vizIndex].options.cluster.enabled;}var H={checked:this._loadedViz.layers[i].options.visible,feeding:{feeding:this.FeedsToJSON(w[i])},title:y,titleText:x,vizType:x,sortable:true,clusterChecked:z};f.push(H);}this._chartModelProvider().extensionValues({mapBuilder:{status:f}});}if(this._loadedViz&&this._selectedServiceId){this._queryEsriServices(function(){if(this._esriservices&&this._esriservices.length>0){this._chartModelProvider().extensionValues({mapBuilder:{mapservice:{showRadio:true,checked:!!this._enableService}}});}}.bind(this));}this._loadedViz=null;};s.prototype.exportable=function(){return this._chart!=null;};s.prototype.exportToSVGString=function(e){return"";};s.prototype.queryProperties=function(e){return{};};s.prototype.updateProperties=function(e){};s.prototype.selectedPropertyZone=function(){if(arguments.length){return this;}return null;};return s;});u('sap/viz/controls/chart/views/TableView',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost'],function($,G,C,D,M,E,F,a,L,O,b,c,T,V,d,e,f,g,I){var h=function(k,o,l,m){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.TableView";this._createChildren();sap.viz.extapi.env.Template.addListener($.proxy(this.changeTemplate,this));};O.extend(h,g);h.prototype._createChildren=function(){h.superclass._createChildren.apply(this,arguments);this._createDropZone();};h.prototype.getTitleZone=function(){if(!this._chart){return[];}var t=this._chart.type;var z;try{z=this._chart.propertyZone();}catch(k){return[];}var l=[];for(var i=0;i<z.length;i++){if(z[i].name=='title'){l=z[i].bound[0];break;}}return l;};h.prototype.properties=function(p,k){try{if(!k){this._requestMorphing=true;}if(arguments.length>0){this._options.properties=p;if(this._chart){this._chart.properties(p);return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._chart){return this._chart.properties();}else{return this._options.properties;}}}catch(l){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+l;}};h.prototype.css=function(k){try{if(arguments.length>0){this._updateCssCacheByNewCss(k);this._options.css=k;if(this._chart){this._chart.css(k);return this;}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._chart){return this._chart.css();}else{return this._options.css;}}}catch(l){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+l;}};h.prototype._createChartInstance=function(){this._hasChartInstance=false;var o=this._options;var k=this._chartLayer$;var l=this._descriptionLayer$;var m=this._chartHolder$;var v=o.type;this._supportMorphing=false;this._destroyChartInstance();try{this._dispatchEvent(new e(e.CHART_CHANGING,this,v));this._updateDescriptionByOptions(o);this._chart=sap.viz.api.core.createViz({type:v,data:o.data,feeding:o.feeding,properties:o.properties,css:o.css,events:o.events,container:k.get(0)});this._postVizProcess(o);}catch(n){var p=L.get('VIZ_CHART_CREATE_CHART_FAILED')+n;if(!a.getVizFeeds(v)){this._updateDescription(b.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v));}else{this._updateDescription(p);}k.html("");this._chart=null;this._hasChartInstance=false;throw p;}};h.prototype._postVizProcess=function(o){Object.keys(this._onEventMap).forEach($.proxy(function(k){var l=this._onEventMap[k];this._chart.on(k,l);},this));this._hasChartInstance=true;this._dispatchEvent(new e(e.CHART_CHANGED,this,this._chart));};h.prototype.buildFeedings=function(t,k,l){var m=null;if(!k||c.isEmptyData(t,k)){return m;}if(!V.hasFakeData(k)&&!c.isEmptyData(t,k)&&!a.isEmptyFeeds(l)){m=[];l.forEach(function(n){var o=n.id();m[o]=[];n.values().forEach(function(p){var q={"id":p.id(),"name":p.name(),"type":p.type()};m[o].push(q);});});}return m;};h.prototype.exportViz=function(o){if(this._chart){var r=this._chart.toJSON(o);return r;}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};return h;});u('sap/viz/controls/chart/ViewManager',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/chart/views/ChartView','sap/viz/controls/chart/views/InfoChartView','sap/viz/controls/chart/views/MapView','sap/viz/controls/chart/views/TableView'],function(C,a,b,I,M,T){var t={};var V={};V._register=function(c,v){if(c&&v){t[c]=v;}};V._getViewClass=function(c){if(t.hasOwnProperty(c)){return t[c];}else if(a.isInfoChart(c)){return I;}else{return b;}};V.getViewClass=function(c){return V._getViewClass(c);};V._register(C.TYPE_GEO_MAP,M);V._register(C.TYPE_TABLE,T);V._register(C.TYPE_CROSSTAB,T);return V;});u('sap/viz/controls/chart/VizProxyHandler',['sap/viz/controls/runtime/VizProxy','sap/viz/controls/chart/views/ChartEvent'],function(V,C){var a=function(c){this.__className="sap.viz.controls.chart.VizProxyHandler";this._chart=c;this._init();};a.prototype._init=function(){this._operationMap={};this._operationMap[V.GetTitleZoneOperation]=this._getTitleZone;this._operationMap[V.GetTitleTextOperation]=this._getTitleText;this._operationMap[V.SetTitleTextOperation]=this._setTitleText;this._operationMap[V.GetTitleTextByFeedingOperation]=this._getTitleTextByFeeding;this._operationMap[V.RestoreTitleTextOperation]=this._restoreTitleText;this._operationMap[V.SetTitleModeOperation]=this._setTitleMode;this._operationMap[V.IsFakeChartOperation]=this._isFakeChart;this._operationMap[V.IsTitleCustomizedOperation]=this._isTitleCustomized;this._operationMap[V.GetPropertiesOperation]=this._getProperties;this._operationMap[V.SetPropertiesOperation]=this._setProperties;this._operationMap[V.GetSelectionOperation]=this._getSelection;this._operationMap[V.SetDatasetOperation]=this._setDataset;this._operationMap[V.GetPropertyZonesOperation]=this._getPropertyZones;this._operationMap[V.SetPropertyZonesOperation]=this._setPropertyZones;this._operationMap[V.QueryPropertiesOperation]=this._queryProperties;this._operationMap[V.UpdatePropertiesOperation]=this._updateProperties;this._operationMap[V.GetDatasetOperation]=this._getDataset;this._operationMap[V.AddEventListenerOperation]=this._addEventListener;this._operationMap[V.RemoveEventListenerOperation]=this._removeEventListener;this._operationMap[V.SetAxisScaleOperation]=this._setAxisScaleListener;this._operationMap[V.GetDataPointsPosition]=this._getDataPointsPosition;this._operationMap[V.GetTypeOperation]=this._getType;this._operationMap[V.OnOperation]=this._on;this._operationMap[V.OffOperation]=this._off;this._operationMap[V.GetSizeOperation]=this._getSize;this._operationMap[V.SetSizeOperation]=this._setSize;this._operationMap[V.GetVizFeedingOperation]=this._getVizFeeding;};a.prototype.response=function(d){var o=d.operation;var b=d.args;d.result=this._operationMap[o].apply(this,b);};a.prototype._getTitleZone=function(){return this._chart.getTitleZone();};a.prototype._getTitleText=function(){return this._chart.vizTitle();};a.prototype._setTitleText=function(t){this._chart.vizTitle(t);};a.prototype._getTitleTextByFeeding=function(){return this._chart.getTitleTextByFeeding();};a.prototype._restoreTitleText=function(){this._chart.restoreTitleText();};a.prototype._setTitleMode=function(m){this._chart.vizTitleMode(m);};a.prototype._isFakeChart=function(){return this._chart.isFake();};a.prototype._isTitleCustomized=function(){return this._chart.isTitleCustomized();};a.prototype._getProperties=function(){return this._chart.vizProperties();};a.prototype._setProperties=function(n){this._chart.vizProperties(n);};a.prototype._setDataset=function(o){this._chart.vizUpdate({data:o});};a.prototype._getSelection=function(){return this._chart.vizSelection();};a.prototype._getType=function(){return this._chart.vizType();};a.prototype._getPropertyZones=function(){return this._chart.getPropertyZones();};a.prototype._setPropertyZones=function(v){this._chart.setPropertyZones(v);};a.prototype._queryProperties=function(o){return this._chart.queryProperties(o);};a.prototype._updateProperties=function(o){this._chart.updateProperties(o);};a.prototype._getDataset=function(){return this._chart.vizData();};a.prototype._addEventListener=function(t,l,s,p){this._chart.addEventListener(t,l,s,p);};a.prototype._removeEventListener=function(t,l,s){this._chart.removeEventListener(t,l,s);};a.prototype._setAxisScaleListener=function(z){return this._chart.setAxisScale.apply(this._chart,arguments);};a.prototype._getDataPointsPosition=function(d){return this._chart.getDataPointsPosition.apply(this._chart,arguments);};a.prototype._on=function(e,c){return this._chart.vizOn.apply(this._chart,arguments);};a.prototype._off=function(e){return this._chart.vizOff.apply(this._chart,arguments);};a.prototype._getSize=function(){return this._chart.size();};a.prototype._setSize=function(s){if(s){this._chart.size(s);this._chart._dom$.parent().width(s.width);this._chart._dom$.parent().height(s.height);}};a.prototype._getVizFeeding=function(){return this._chart.getFeeding();};return a;});u('sap/viz/controls/chart/Chart',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/ChartPreHandler','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/chart/views/ChartView','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/View','sap/viz/controls/chart/views/InfoChartView','sap/viz/controls/chart/ViewManager','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/common/services/BVRService','sap/viz/controls/runtime/VizProxy','sap/viz/controls/chart/VizProxyHandler'],function($,V,G,C,D,E,a,F,b,c,d,f,g,O,k,l,L,m,n,I,o,q,r,s,t,R,v,x,y){var z=function z(e,h){z.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.Chart";this._div=e;this._uiConfig=h?h:m.instance();this._uiConfig.libFolderPath=G.defaultAssetsRoot()+'/common/libs';this._layout=null;this._chartViewInstance=null;this._type=null;this._data=null;this._properties=null;this._categoryAxis=[];this._valueAxis=[];this._labelFormats=null;this._css=null;this._description=null;this._vizCreated=false;this._enableVizDefChangedEvent=true;this._loadingModel=false;this._loadingInstance=false;this._titleMode=z.VIZ_TITLE_MODE.auto;this._titleGeneratorFunc=null;this._enableTrellis=(this._uiConfig.enableTrellis!==false);this._enableMorphing=(this._uiConfig.enableMorphing!==false);R.getRuntime().registerModel(this._uid,this._vizModel());this._vizProxyHandler=new y(this);this._vizModel().addEventListener(x.VizProxyEvent,function(p){this._vizProxyHandler.response(p.data);},this);this._chartPreHandler=new n({"useInfoChart":this._uiConfig.useInfoChart});this._createChildren();this._onEventMap={};};O.extend(z,V);z.VIZ_TITLE_MODE={manual:"manual",auto:"auto"};z.prototype.vizType=function(e){if(arguments.length>0){if(!k.isString(e)){return;}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizType()_set');this._beginUpdateProperty();this._vizType=e;this._vizModel().type(this._vizType);this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizType()_set');return this;}else{return this._vizModel().type();}};z.prototype.vizTitle=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizTitle()_set');if(l.hasFakeData(this._data)){e=' ';}var h=this.vizProperties()?this.vizProperties().title:null;if(!h||e!==h.text){if(!h){h={};}h.text=e;this.vizProperties({'title':h});}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizTitle()_set');return this;}else{var e=this.vizProperties()?this.vizProperties().title:null;return e?e.text:null;}};z.prototype.clearSelectedPropertyZone=function(){this._chartViewInstance.selectedPropertyZone(null);};z.prototype.isFake=function(){return l.hasFakeData(this._data);};z.prototype.setTitleGeneratorFunc=function(e){if(e!==null&&e!==undefined&&!k.isFunction(e)){return;}this._titleGeneratorFunc=e;};z.prototype.vizTitleMode=function(e){if(arguments.length>0){if(e==z.VIZ_TITLE_MODE.auto||e==z.VIZ_TITLE_MODE.manual){this._titleMode=e;}}else{return this._titleMode;}};z.prototype.isTitleCustomized=function(){return this._titleMode===z.VIZ_TITLE_MODE.manual;};z.prototype.getTitleZone=function(){if(this._chartView().getTitleZone){return this._chartView().getTitleZone();}else{return[];}};z.prototype.getTitleTextByFeeding=function(){if(this._titleGeneratorFunc){var e=[this.vizUid()];return this._titleGeneratorFunc.apply(null,e);}return this._chartView().getTitleByFeeding();};z.prototype.restoreTitleText=function(){this.vizTitle(this.getTitleTextByFeeding());};z.prototype._titleChangedHandler=function(e){var h=e.data.text;this.vizTitle(h);};z.prototype.destroy=function(){this._destroyViz();z.superclass.destroy.apply(this,arguments);};z.prototype.feedAnalysisObjects=function(e,h){this._beginUpdateProperty();var p=this._vizModel();var w;if(h===true){w=v.suggestFeeds(p.type(),p.explicitFeedingItems(),e);}else{w=v.suggestFeeds(p.type(),e);}var K=p.explicitFeedingItems();if(w){if(f.equal(K,w.feeds)){for(var M in e){var N=f.getVizFeeds(p.type());for(var P in N){if(f.canAddFeed(K,N[P],e[M])){J(this._vizModel().type(),K,e[M]);}}}}else{K=w.feeds;}p.feedingItems(K);}this._endUpdateProperty();return K;};z.prototype.getDefaultIncompleteOptions=function(e){if(!k.isString(e)){return;}var p=this._getDefaultProperties(e);return{'type':e,'properties':p,'data':I.getDataset(e)};};z.prototype._updateColumnDimCount=function(){if(g.isMultipleChart(this._vizModel().type())){var e=f.getNumberOfDimensionsInColumn(this._vizModel().feedingItems());this._properties=this._properties||{};this._properties.multiLayout=this._properties.multiLayout||{};this._properties.multiLayout.numberOfDimensionsInColumn=e;}};z.prototype._dispatchVizDefChangedEvent=function(e){var h={vizTypeChanged:(e.vizTypeChanged===true),vizPropertiesChanged:(e.vizPropertiesChanged===true),vizCssChanged:(e.vizCssChanged===true),feedingItemsChanged:(e.feedingItemsChanged===true),filterChanged:(e.filterChanged===true),vizTitleChanged:(e.vizTitleChanged===true)};if(this._vizDefChangedData){for(var p in this._vizDefChangedData){if(this._vizDefChangedData.hasOwnProperty(p)){h[p]=h[p]||this._vizDefChangedData[p];}}this._vizDefChangedData=null;}if(this._enableVizDefChangedEvent){this._dispatchEvent(new a(E.VIZ_DEFINITION_CHANGED,this,h));}else{this._vizDefChangedData=h;}};z.prototype._updateView=function(e){var h=t.getViewClass(e);if(this._chartViewInstance instanceof h){return;}if(this._chartViewInstance){this._chartViewInstance.destroy();this._chartViewInstance=null;this._data=null;}this._createChartView(h);this._chartView().onEventMap(this._onEventMap);var p={width:$(this._div).width(),height:$(this._div).height()};this._chartView().size(p);if(g.isTable(e)){this._data=I.getDataset(e);}var w={type:e};this._dispatchEvent(new q(q.VIZ_VIEW_CHANGED,this,w));};z.prototype._onVizModelChanged=function(e){this._dispatchVizDefChangedEvent(e.data);var h=this._vizModel().type();if(e.data.vizTypeChanged){this._updateView(h);}if(this._loadingModel){return;}if(e.data.vizTypeChanged){if(!this._inUpdatingProperty()){this._properties=this._chartView().resetProperties(this._properties,h);}this._updateAxisProperties(h);this._updateLabelFormats(h);this._dispatchPropertyEvent(new q(q.VIZTYPE_CHANGED,this,{type:h}));}if(!this._chartView()){return;}if(e.data.feedingItemsChanged&&!g.isGeo(h)){this._updateColumnDimCount();if(!this._inUpdatingProperty()){this._updateTitle();this.showLoadingIcon();var p=g.getDatasetType(h);this._dispatchPropertyEvent(new F(F.FEEDS_CHANGED,this,{datasetType:p,feeds:this.feeds()}));return;}}this._chartView().modelChanged(this._vizModel(),e.data);if(e.data.extensionValuesChanged){var w=this._vizModel().extensionValues();if(w.feedingPanel&&this._enableTrellis!==w.feedingPanel.enableTrellis){this._enableTrellis=w.feedingPanel.enableTrellis;this._chartView().enableTrellis(this._enableTrellis);}}if(this._needCreateViz(h,false)&&(e.data.vizTypeChanged||e.data.feedingItemsChanged)){this._createVizInstance();}};function H(p,e,h){if(e&&h){var i,w,K;for(i=0;i<e.length;i++){w=e[i];if(h.length>i){K=h[i];p[w]=k.clone(h[i]);}}}};z.prototype._updateAxisProperties=function(e){if(this._properties){var h=l.getCategoryAxis(e);H(this._properties,h,this._categoryAxis);var p=l.getValueAxis(e);H(this._properties,p,this._valueAxis);}};z.prototype._updateLabelFormats=function(e){var h=['xAxis','xAxis2','yAxis','yAxis2','valueAxis'];var p={'xAxis':'yAxis','xAxis2':'yAxis2','yAxis':'xAxis','yAxis2':'xAxis2'};var i,w;if(!this._labelFormats&&this._properties){for(i=0;i<h.length;i++){w=h[i];var K;if(w==='valueAxis'){K=this._properties.plotArea?this._properties.plotArea.valueAxis:null;}else{K=this._properties[w];}var M=(K&&K.label&&K.label.hasOwnProperty('formatString'))?true:false;if(M){this._labelFormats=this._labelFormats||{};this._labelFormats[w]=K.label.formatString;}}}var N=sap.viz.api.manifest.Viz.get(e)[0].allProperties();if(!N){return;}var P;for(i=0;i<h.length;i++){w=h[i];var Q;if(w==='valueAxis'){if(N.plotArea&&N.plotArea.valueAxis){Q=N.plotArea.valueAxis.supportedValues;}}else{Q=N[w];}var S=(Q&&Q.label&&Q.label.supportedValues&&Q.label.supportedValues.hasOwnProperty('formatString'))?true:false;if(S){var T;if(this._properties){var U;if(w==='valueAxis'){if(this._properties.plotArea&&this._properties.plotArea.valueAxis){U=this._properties.plotArea.valueAxis;if(U&&U.label&&U.label.hasOwnProperty('formatString')){T=U.label.formatString;}}}else{U=k.clone(this._properties[w]);if(U&&U.label&&U.label.hasOwnProperty('formatString')){T=U.label.formatString;}}}if(T===undefined&&this._labelFormats){T=this._labelFormats[w];if(T===undefined&&w!=='valueAxis'){var W=p[w];if(W){T=this._labelFormats[W];}}}if(T===undefined){T=this._uiConfig.defaultLabelFormatString;}if(T!==undefined){this._properties=this._properties||{};if(w==='valueAxis'){this._properties.plotArea=this._properties.plotArea||{};this._properties.plotArea.valueAxis=this._properties.plotArea.valueAxis||{};this._properties.plotArea.valueAxis.label={formatString:T};}else{this._properties[w]=this._properties[w]||{};this._properties[w].label={formatString:T};}}}else{P=P||[];P.push(w);}}if(P&&this._properties){for(i=0;i<P.length;i++){w=P[i];if(w==='valueAxis'){if(this._properties.plotArea&&this._properties.plotArea.valueAxis&&this._properties.plotArea.valueAxis.label){delete this._properties.plotArea.valueAxis.label.formatString;}}else{if(this._properties[w]&&this._properties[w].label){delete this._properties[w].label.formatString;}}}}};z.prototype._createChartView=function(h){var p=this._chartViewInstance=new h($(this._div),{'type':this._vizModel().type(),'useBuiltInPropertyZoneInteraction':this._uiConfig.useBuiltInPropertyZoneInteraction,'useDefaultChartSizeForTrellis':this._uiConfig.useDefaultChartSizeForTrellis},this._uiConfig.libFolderPath,$.proxy(this._vizModel,this),{'vizProperties':$.proxy(this.vizProperties,this),'vizCss':$.proxy(this.vizCss,this),'vizCssProperty':$.proxy(this.vizCssProperty,this),'vizOn':$.proxy(this.vizOn,this),'vizType':$.proxy(this.vizType,this),'selectedPropertyZone':$.proxy(this.selectedPropertyZone,this),'vizData':$.proxy(this.vizData,this)});p.enableTrellis(this._enableTrellis);p.enableMorphing(this._enableMorphing);p.addEventListener(q.TITLE_CHANGED,this._titleChangedHandler,this);p.addEventListener(q.ANALYSIS_DROPPED,this._analysisDroppedHandler,this);p.addEventListener(q.CHART_CHANGED,function(e){this._dispatchEvent(e);},this);p.addEventListener(q.CHART_CHANGING,function(e){this._dispatchEvent(e);},this);p.addEventListener(q.CHANGED_SELECTED_DATA,function(e){this._dispatchEvent(new q(q.CHANGED_SELECTED_DATA,this,e.data));},this);p.addEventListener(q.SELECT_PROPERTY_ZONE,function(e){this._dispatchEvent(new q(q.SELECT_PROPERTY_ZONE,this,e.data));},this);p.addEventListener(r.DISPATCH_PROPERTY_EVENT,function(e){var w=e.data;this._dispatchPropertyEvent(w);},this);p.addEventListener(q.PROPERTY_ZONES_CHANGED,function(e){this._dispatchEvent(new q(q.PROPERTY_ZONES_CHANGED,this,e.data));},this);};z.prototype._createChildren=function(){this._validateSize();this._createChartView(o);};z.prototype._analysisDroppedHandler=function(e){var i;var h=this._vizModel();var p=h.explicitFeedingItems();var w;var K=e.data.zone;var M=e.data.analysisObject;if(K.feedDef.length===1){var N=K.feedDef[0];var P=N.id;if(K.name===f.RowsFeedingName||K.name===f.ColumnsFeedingName){P=K.name;}w=f.getFeed(p,P);if(!w){w=new c(P,N.type,[]);p.push(w);}var Q=N.type===d.MEASURE?N.max:N.maxStackedDims;if(Q===null||Q===undefined){Q=Number.MAX_VALUE;}if(w.values().length===Q){w.values().splice(0,1);}w.values().push(M);}else{var S=[];for(i=0;i<K.feedDef.length;i++){if(K.feedDef[i].id===f.MultiplierFeedingName){S.push(f.RowsFeedingName);S.push(f.ColumnsFeedingName);}else{S.push(K.feedDef[i].id);}}var T=v.suggestFeeds(h.type(),p,[M],S);if(T){if(f.equal(p,T.feeds)){J(this._vizModel().type(),p,M);}else{p=T.feeds;}}}h.feedingItems(p,this._enableTrellis);};function J(e,h,p){var w=v.suggestFeeds(e,[p]);var K,i,M;for(i=0;i<w.feeds.length;i++){M=w.feeds[i];if(M.values().length===1){K=M.id();break;}}for(i=0;i<h.length;i++){M=h[i];if(M.id()===K){var N=false;var P=M.values();for(var Q in P){if(P[Q].id()===p.id()){N=true;break;}}if(!N&&M.values().length>0){M.values().splice(0,1);M.values().push(p);}}}};z.prototype._validateSize=function(){var w=$(this._div).width();var h=$(this._div).height();$(this._layout).css({width:w+"px",height:h+"px",visibility:"visible",display:''});if(this._chartView()){this._chartView().size({width:w,height:h});}};z.prototype._updateData=function(e,h){this._data=this._chartViewInstance.copyData(e,h);};z.prototype._chartView=function(){return this._chartViewInstance;};z.prototype._needCreateViz=function(e,h){if(h===true){return true;}var p=false;if(g.isTable(e)){p=true;}else{if(e!==this._type){p=true;}}if(!this._chartView().hasChartInstance()){p=true;}return p;};z.prototype._needChangeTemplate=function(e,h){var p=this._chartViewInstance.getTemplateId();var w=this._chartViewInstance.getTemplateId(h);return(p!==w);};z.prototype.showLoadingIcon=function(){this._chartView().showLoadingIcon();};z.prototype.connect=function(e){};z.prototype.disconnect=function(){};z.prototype.chartModel=function(){return this._vizModel();};z.prototype.vizUid=function(){return this._uid;};z.prototype.vizData=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizData_set');var h=this._vizModel().type();this._updateData(h,e);if(this._vizCreated){var p=this._needChangeTemplate(h,e);if(p||g.isTable(h)){this._createVizInstance();}else{this._chartView().data(this._data);}}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizData_set');return this;}else{if(this._chartView()){return this._chartView().data();}return null;}};z.prototype.vizCss=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizCss_set');this._css=e;if(this._vizCreated){this._chartView().css(this._css);this._css=this._chartView().css();}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}this._dispatchVizDefChangedEvent({'vizCssChanged':true});sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizCss_set');return this;}else{return this._chartView().css();}};z.prototype.vizProperties=function(p){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizProperties_set');this._enableVizDefChangedEvent=false;var e=this._vizModel().type();var h=this._initOptions({properties:p});this._labelFormats=null;if(h!==e){this._vizModel().type(h);if(this._vizCreated){this._createVizInstance();}else{this._enableVizDefChangedEvent=true;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizProperties_set');throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._vizCreated){if(this._chartView().hasChartInstance()){var p=this._chartView().getValidProperties(this._properties,h);this._chartView().properties(p);}}else{this._enableVizDefChangedEvent=true;sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizProperties_set');throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}var w={vizPropertiesChanged:true};if(p.hasOwnProperty("title")){w.vizTitleChanged=true;}this._enableVizDefChangedEvent=true;this._dispatchVizDefChangedEvent(w);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizProperties_set');return this;}else{return this._chartView().properties();}};z.prototype.vizDescription=function(){return this._chartView().description();};z.prototype.vizUpdate=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');if(!e){return;}e=this._chartPreHandler.preVizUpdate(e);this._beginUpdateProperty();var h=false;var p=e.type||this._vizModel().type();if(e.hasOwnProperty("type")){this._updateView(e.type);}if(e.hasOwnProperty('data')){h=this._needChangeTemplate(p,e.data);}p=this._initOptions(e);var w=(p!==this._vizModel().type());if(!g.isGeo(p)&&e.data===null){h=true;this._updateData(p,I.getDataset(p));}var K=null;var M=e.feeds;if(M){K=M.value?M.value:M;}else if(M===null){K=[];}var N;if(w){N={'type':p};if(K){N['feedingItems']=K;}this._vizModel().vizModelChanged(N);}else{if(K){N={'feedingItems':K};this._vizModel().vizModelChanged(N);}if(this._vizCreated){try{if(this._needCreateViz(p,h)||!this._chartView().supportUpdate(p)){this._createVizInstance();}else{this._updateVizInstance();}}catch(P){this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');throw P;}}else{}}this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_vizUpdate');return this;};z.prototype.vizOn=function(e,h){if(arguments.length>0){if(!k.isString(e)||!k.isFunction(h)){return;}this._chartView().on(e,h);this._onEventMap[e]=h;return this;}};z.prototype.vizOff=function(e){if(arguments.length>0){if(!k.isString(e)){return;}this._chartView().off(e);delete this._onEventMap[e];return this;}};z.prototype.vizAction=function(e,h){if(arguments.length>0){if(this._vizCreated){return this._chartView().action(e,h);}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}return this;}};z.prototype.vizSelection=function(p,e){if(this._vizCreated){var h=this._chartView().selection.apply(this._chartView(),arguments);return h;}else{throw L.get('VIZ_CHART_SELECTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};z.prototype.vizFeedingZone=function(){if(this._vizCreated){try{return this._chartView().feedingZone();}catch(e){return[];}}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};z.prototype.changeTemplate=function(){return this._chartView().changeTemplate.apply(this._chartView());};z.prototype._initOptions=function(e){if(!e){return;}var h=e.type||this._vizModel().type();if(e.hasOwnProperty('css')){this._css=e.css;}if(e.properties){var p=k.clone(e.properties);h=g.updateType(h,p);this._updateAxisCache(h,p);this._properties=this._properties||{};if(p.title&&p.title.text){p.title.text=p.title.text.trim();}this._properties=k.updateJSON(this._properties,p);}if(e.data){this._updateView(h);this._updateData(h,e.data);}return h;};z.prototype._updateAxis=function(p,e,h){var i,w,K,M;if(p){for(i=0;i<p.length;i++){w=p[i];if(h.hasOwnProperty(w)){M=k.clone(h[w]);if(e.length>i){K=e[i];e[i]=k.updateJSON(K,M);}else{if(this._properties.hasOwnProperty(w)){e.push(k.updateJSON(this._properties[w],M));}else{e.push(M);}}}}}};z.prototype._updateAxisCache=function(e,h){if(h){var p=l.getCategoryAxis(e);this._updateAxis(p,this._categoryAxis,h);var w=l.getValueAxis(e);this._updateAxis(w,this._valueAxis,h);}};z.prototype._clearAxisCache=function(){if(this._categoryAxis){this._categoryAxis.length=0;}if(this._valueAxis){this._valueAxis.length=0;}};z.prototype._saveAxisCache=function(){var e={};e['categoryAxis']=this._categoryAxis;e['valueAxis']=this._valueAxis;return e;};z.prototype._loadAxisCache=function(e){if(e['categoryAxis']){this._categoryAxis=e['categoryAxis'];}if(e['valueAxis']){this._valueAxis=e['valueAxis'];}};z.prototype.createViz=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_createViz');e=this._chartPreHandler.preCreateViz(e);this._beginUpdateProperty();this._type=null;this._vizModel().type(null);this._data=null;this._css=null;this._properties={};if(e.hasOwnProperty("type")){this._updateView(e.type);}var h=this._initOptions(e);var p=null;var w=e.feeds;if(w){p=w.value?w.value:w;}else if(w===null){p=[];}this._vizCreated=true;try{this._vizModel().vizModelChanged({'type':h,'feedingItems':p});}finally{this._endUpdateProperty();}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_createViz');}};z.prototype._destroyViz=function(){this._data=null;this._vizModel().type(null);this._properties=null;this._css=null;this._onEventMap={};this._chartView().destroy();this._vizCreated=false;};z.prototype.exportViz=function(e){return(this._chartView().hasChartInstance()||this._chartView().exportable())?this._chartView().exportViz(e):null;};z.prototype.loadViz=function(e){if(arguments.length===1){e=sap.viz.api.serialization.migrate(e);var h=e.type;if(e.data&&e.data.type){if(e.data.type==='Crosstable'){var p=new sap.viz.api.data.CrosstableDataset();p.data(e.data.val);if(e.data.val.infos){p.info([{'type':'additionalData','info':e.data.val.infos}]);}e.data=p;}else if(e.data.type==='FlatTable'){e.data=new sap.viz.api.data.FlatTableDataset(e.data.val);}else{e.data=e.data.val;}}if(h!==this._vizModel().type()){this._loadingModel=true;this._vizModel().vizModelChanged({'type':h});this._loadingModel=false;}this._properties={};e.properties=e.properties||{};this._applyLeanLayout(e);this._initOptions(e);var w=this._getDefaultProperties(h);e.properties=k.updateJSON(w,e.properties);e.properties=this._chartView().getValidProperties(e.properties,h);this._clearAxisCache();this._type=h;this._vizCreated=true;this._updateFeeding(e,h);this._chartViewInstance.loadViz(e);}};z.prototype._applyLeanLayout=function(e){if(this._chartViewInstance instanceof s&&this._uiConfig.forceLeanLayout===true){this._properties.title=this._properties.title||{};this._properties.title.visible=false;this._properties.legend=this._properties.legend||{};this._properties.legend.visible=false;this._properties.categoryAxis=this._properties.categoryAxis||{};this._properties.categoryAxis.title=this._properties.categoryAxis.title||{};this._properties.categoryAxis.title.visible=false;this._properties.categoryAxis2=this._properties.categoryAxis2||{};this._properties.categoryAxis2.title=this._properties.categoryAxis2.title||{};this._properties.categoryAxis2.title.visible=false;this._properties.valueAxis=this._properties.valueAxis||{};this._properties.valueAxis.title=this._properties.valueAxis.title||{};this._properties.valueAxis.title.visible=false;this._properties.valueAxis2=this._properties.valueAxis2||{};this._properties.valueAxis2.title=this._properties.valueAxis2.title||{};this._properties.valueAxis2.title.visible=false;e.properties=e.properties||{};e.properties=k.updateJSON(e.properties,this._properties);}};z.prototype._updateVizInstance=function(){var e=this._vizModel().type();var h=this.feeds({'withMND':true});var p=this._chartView().getValidProperties(this._properties,e);var w={'properties':p,'css':this._css,'data':this._data};this._updateFeeding(w,e);this._data=w.data;this._chartView().update(w);};z.prototype._createVizInstance=function(e){if(!this._vizCreated){return;}try{var h=this._vizModel().type();var p=this._getDefaultProperties(h);var w=k.updateJSON(p,this._properties);w=this._chartView().getValidProperties(w,h);var K={'type':h,'data':this._data,'css':this._css,'properties':w};this._updateFeeding(K,h);this._data=K.data;this._type=K.type;if(!g.isGeo(this._type)){this._chartView().hideLoadingIcon();}this._chartView().create(K);}catch(M){if(R.getRuntime()._modelRefs[this._uid]===1){throw M;}}};z.prototype._updateFeeding=function(e,h){var p=this.feeds({'withMND':true});if(!g.isTable(h)){if(!g.isGeo(h)&&f.isEmptyFeeds(p)){if(l.getDatasetType(e.data)!==D.CrosstableDataset||l.hasFakeData(e.data)){e.data=I.getDataset(h);}}else{e.feeding=this._chartViewInstance.buildFeedings(h,e.data,p);}}else{if(!e.data||l.hasFakeData(e.data)){e.data=I.getDataset(h);}e.feeding=this._chartViewInstance.buildFeedings(h,e.data,p);}};z.prototype.save=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_save');var h={};h["vizInstance"]=this.exportViz(e);var p=this.feeds();var w=this._chartViewInstance.FeedsToJSON(p);h["feedingItems"]=w;h["type"]=this._vizModel().type();h["vizTitleMode"]=this._titleMode;h["vizView"]=this._chartViewInstance.save();h["axis"]=this._saveAxisCache();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_save');return h;};z.prototype.load=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_load');e=this._chartPreHandler.preLoadChart(e);this._beginUpdateProperty();var h=e["vizTitleMode"];if(h){this.vizTitleMode(h);}this._loadingModel=true;var p=e["type"];this._updateView(p);var w=null;var K=e['feedingItems'];if(K){w=this._chartViewInstance.FeedsFromJSON(K);}this._vizModel().load({"type":p,"feedingItems":w});this._loadingModel=false;var M=e["vizInstance"];if(M){this._loadingInstance=true;if(e["vizView"]){this._chartViewInstance.load(e["vizView"],M.properties);}this.loadViz(M);this._loadingInstance=false;}var N=e["axis"];if(N){this._loadAxisCache(N);}this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_load');};z.prototype.feeds=function(e){if(arguments.length>0&&k.isArray(e)){if(e!==null&&e!==undefined&&!l.isArrayOfFeedItem(e)){return;}this._beginUpdateProperty();var h=e.slice(0);this._vizModel().feedingItems(h,this._enableTrellis);try{var p=this._vizModel().type();if(this._needCreateViz(p,false)){this._createVizInstance();}else{this._updateVizInstance();}}catch(w){this._endUpdateProperty();throw w;}this._endUpdateProperty();return this;}else{return this._vizModel().explicitFeedingItems(e);}};z.prototype.enableMorphing=function(e){if(arguments.length>0){if(this._chartView()){return this._chartView().enableMorphing(!!e);}}else{if(this._chartView()){return this._chartView().enableMorphing();}}return this;};z.prototype.enablePropertyZone=function(e){if(arguments.length>0){if(this._chartView()){return this._chartView().enablePropertyZone(!!e);}}else{if(this._chartView()){return this._chartView().enablePropertyZone();}}return this;};z.prototype._updateTitle=function(){if(this.isTitleCustomized()){return;}var e=this.getTitleTextByFeeding();this._properties.title=this._properties.title||{};e=e.trim();if(this._properties.title.text!=e){this._properties.title.text=e;}};z.prototype.feeding=function(){if(this._chartViewInstance){return this._chartViewInstance.feeding();}else{return[];}};z.prototype.showMessage=function(e){if(arguments.length==1){if(this._chartView()){return this._chartView().updateDescription(e);}}};z.prototype.exportToSVGString=function(e){return this._chartView().exportToSVGString(e);};z.prototype.supportExportToSVG=function(){return this._chartView().supportExportToSVG();};z.prototype.getPropertyZones=function(){return this._chartView().getPropertyZones();};z.prototype.setPropertyZones=function(p){this._chartView().setPropertyZones(p);};z.prototype.queryProperties=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_queryProperties');var h=this._chartView().queryProperties(e);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:chart_control_api_queryProperties');return h;};z.prototype.updateProperties=function(e){this._chartView().updateProperties(e);};z.prototype.selectedPropertyZone=function(e){var h=this._chartView();return h.selectedPropertyZone.apply(h,arguments);};z.prototype.getZoneName=function(p){return this._chartView().getZoneName.apply(this._chartView(),arguments);};z.prototype.getDataPointsPosition=function(e){return this._chartView().getDataPointsPosition.apply(this._chartView(),arguments);};z.prototype.setAxisScale=function(e){return this._chartView().setAxisScale.apply(this._chartView(),arguments);};z.prototype.vizCssProperty=function(e,p,h){return this._chartView().cssProperty.apply(this._chartView(),arguments);};z.prototype.getFeeding=function(){return this._chartView().feeding();};z.prototype._getDefaultProperties=function(e){if(!e){return{};}var p;var h=g.getChartId(e);if(this._uiConfig&&this._uiConfig.hasOwnProperty('specificProperties')){p=k.updateJSON(this._uiConfig.defaultProperties,this._uiConfig.specificProperties[h]);}else{p=this._uiConfig?this._uiConfig.defaultProperties:null;}p=l.convertProperties(p,g.getVizType(e),e);return p;};return z;});u('sap/viz/controls/plugins/infochart/getPropertiesByCtx',['sap/viz/controls/common/utils/Utils'],function(U){function e(c,a){var k=Object.keys(c),b=Object.keys(a);return(k.length>0)&&k.every(function(d){return c[d]===a[d];});}function m(c,d){if(!c){return false;}if(!Array.isArray(c)){c=[c];}return c.some(function(a){if(!a){return true;}return e(a,d);});}function f(c,a){var r;for(var k in c){if(!r){r={};}var b=true;for(var i=0;i<a.length;i++){if(k===a[i]){a.splice(i,1);b=false;break;}}if(!b){continue;}r[k]=c[k];}return r;};return function(c,a){var b=c.ctx;if(!Array.isArray(a)){a=[a];}var d;for(var i=0,l=a.length;i<l;i++){var g=a[i],h=g.ctx,p=g.paras;if(!h){d=p;}}var p=this._parameters,k,n=-1,o,q;for(var i=0,l=a.length;i<l;i++){var g=a[i],h=g.ctx,p=g.paras;if(m(h,b)){o=0;for(var j in h){o++;}if(n<o){n=o;q=i;}}}if(a[q]){return a[q].paras;}return d;};});u('sap/viz/controls/plugins/infochart/SVG',[],function(){var s='http://www.w3.org/2000/svg';var E="...";var t;function c(b,r,d){var e=r?r.ownerDocument:window.document;var n=b.toLowerCase()==="svg"?s:(r?r.namespaceURI:s);var f=e.createElementNS(n,b);return r?(d?r.parentNode.insertBefore(f,r):r.appendChild(f)):f;}function g(b,d){if(!t){var e=c("svg",document.body);e.style.cssText="position:absolute;left:-1000px;top:-1000px;z-index:-9000;width:1px;height:1px";t=c("text",e);}t.style.cssText=a(d);t.textContent=b;return t;}function a(b){var d="";if(Object.prototype.toString.call(b)==='[object String]'){d=b;}else{for(var i in b){if(b.hasOwnProperty(i)){var v=b[i];if(v!==null&&v!==undefined&&v!==""){d+=i+":"+v+";";}}}}return d;}return{create:c,measureText:function(b,d){if(!b){return{width:0,height:0,x:0,y:0};}return g(b,d).getBBox();},toCSSText:a,createTextNode:function(b,d,m,e,f){d=a(d);var h=e!==undefined,k=f!==undefined;var l;if(m||h||k){var n=g(b,d);var o=false;if(h){var p=n.getComputedTextLength();if(p>e){n.textContent=E;p=n.getComputedTextLength();e-=p;if(e<=0){return;}n.textContent=b;var q=b.length-1;while(q>0&&(n.getSubStringLength(0,q)>e)){q--;}if(q>0){l=b;b=b.substr(0,q)+E;o=true;}else{return;}}}if(m||k){if(o){n.textContent=b;}if(m){m=n.getBBox();}if(k&&m.height>f){return;}}}var r=c("text");r.setAttribute("style",d);r.textContent=b;if(l){var v=c("title",r);v.textContent=l;}return m?{measure:m,node:r}:r;}};});u('sap/viz/controls/plugins/infochart/Icon',["./SVG"],function(S){var _={};var I=function(c){var a=document.createElement("div");a.innerHTML=c;var s=this._svgNode=a.firstChild;if(!_[c]){document.body.appendChild(a);_[c]=s.getBBox();}var b=_[c];this._width=b.width;this._height=b.height;this._x=b.x;this._y=b.y;};var p=I.prototype;p.render=function(a,s,f){var g=S.create("g",a);var b=this._svgNode;var n=this._svgNode.firstChild;while(n){var c=n.nextSibling;g.appendChild(n);n=c;}if(s){if(Array.isArray(s)){s=s.join(" ");}g.setAttribute("transform","scale("+s+")");}if(f){g.setAttribute("fill",f);}return g;};p.clipPath=function(a){var s=this._svgNode;var n=this._svgNode.firstChild;while(n){var b=n.nextSibling;a.appendChild(n);n=b;}};p.destroy=function(){var c=this._svgNode.parentNode;if(c&&c.parentNode){c.parentNode.removeChild(c);}delete this._svgNode;};p.getWidth=function(){return this._width;};p.getHeight=function(){return this._height;};p.getX=function(){return this._x;};p.getY=function(){return this._y;};return I;});u('sap/viz/controls/plugins/infochart/StackDecoratorGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){var a=50;var _=0;function t(w,h,b,n){var c;if(n){c=[[w,0]];if(b){c.push([0,h/2],[w,h]);}else{c.push([0,0],[w/2,h]);}}else{c=[[0,h]];if(b){c.push([0,0],[w,h/2]);}else{c.push([w/2,0],[w,h]);}}return c;}var p={"pike":function(w,h,b,n){var c=t(w,h,b,n);if(n){if(b){if(w>a){c.splice(1,0,[a,0]);c.splice(3,0,[a,h]);}}else{if(h>a){c.splice(2,0,[0,h-a]);c.splice(4,0,[w,h-a]);}}}else{if(b){if(w>a){c.splice(2,0,[w-a,0]);c.splice(4,0,[w-a,h]);}}else{if(h>a){c.splice(1,0,[0,a]);c.splice(3,0,[w,a]);}}}return c;},"triangle":t,"trapezoid":function(w,h,b,n){var c;if(n){c=[[w,0]];if(b){if(w>a){c.push([a,0]);}c.push([0,h]);}else{c.push([0,0]);if(h>a){c.push([0,h-a]);}}}else{c=[[0,h]];if(b){c.push([0,0]);if(w>a){c.push([w-a,0]);}c.push([w,h]);}else{if(h>a){c.push([0,a]);}c.push([w,0]);}}c.push([w,h]);return c;}};return{name:"stackDecorator",fn:function(c){return function(b){var e=g(b,c);if(!e){return;}var f=b.graphic,n,w=f.width,h=f.height;var s=e.stackShape||{};var k=s.value;var n=b.g;var l=S.create("clipPath",n);var m="clipPath_"+(_++);l.setAttribute("id",m);n.setAttribute("clip-path","url(#"+m+")");if(s.type==="svg"){var o=new I(k);var q=o.getWidth();var r=o.getHeight();var v=w/q;var x=h/r;o.clipPath(l);l.setAttribute("transform","translate( "+f.x+","+f.y+") scale("+v+" "+x+")");o.destroy();}else{if(!k||k==="rectangle"){var y=S.create("rect",l);y.setAttribute("width",w);y.setAttribute("height",h);}else{var z=S.create("path",l);var d="";p[k](w,h,b.horizontal,b.negative).forEach(function(C,D){d+=(D===0?"M":"L")+C[0]+" "+C[1];});d+="Z";z.setAttribute("d",d);}l.setAttribute("transform","translate( "+f.x+","+f.y+")");}};}};});u('sap/viz/controls/plugins/infochart/BarShapeRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){var a=50;function t(w,h,b,n){var c;if(n){c=[[w,0]];if(b){c.push([0,h/2],[w,h]);}else{c.push([0,0],[w/2,h]);}}else{c=[[0,h]];if(b){c.push([0,0],[w,h/2]);}else{c.push([w/2,0],[w,h]);}}return c;}var p={"pike":function(w,h,b,n){var c=t(w,h,b,n);if(n){if(b){if(w>a){c.splice(1,0,[a,0]);c.splice(3,0,[a,h]);}}else{if(h>a){c.splice(2,0,[0,h-a]);c.splice(4,0,[w,h-a]);}}}else{if(b){if(w>a){c.splice(2,0,[w-a,0]);c.splice(4,0,[w-a,h]);}}else{if(h>a){c.splice(1,0,[0,a]);c.splice(3,0,[w,a]);}}}return c;},"triangle":t,"trapezoid":function(w,h,b,n){var c;if(n){c=[[w,0]];if(b){if(w>a){c.push([a,0]);}c.push([0,h]);}else{c.push([0,0]);if(h>a){c.push([0,h-a]);}}}else{c=[[0,h]];if(b){c.push([0,0]);if(w>a){c.push([w-a,0]);}c.push([w,h]);}else{if(h>a){c.push([0,a]);}c.push([w,0]);}}c.push([w,h]);return c;}};return{name:"barShapeRenderer",fn:function(c){return function(b){var e=g(b,c);if(e){var f=b.graphic,n,w=f.width,h=f.height,k=e.dataPointShapeFill,l=k||f.fill,m=e.dataPointShape||{},o=m.type,q=m.value;if(o==="svg"){var r=new I(q);n=S.create("g");var s=r.getWidth();var v=r.getHeight();var x=w/s;var y=h/v;r.render(n,[x,y],l);if(k){b.data.color=k;}n.setAttribute("transform","translate("+(w/2-s*x/2-r.getX()*x)+","+(h/2-v*y/2-r.getY()*y)+")");r.destroy();}else{if(!q||q==="rectangle"){n=S.create("rect");n.setAttribute("width",w);n.setAttribute("height",h);}else{n=S.create("path");var d="";p[q](w,h,b.horizontal,b.negative).forEach(function(z,C){d+=(C===0?"M":"L")+z[0]+" "+z[1];});d+="Z";n.setAttribute("d",d);}if(k){b.data.color=k;}n.setAttribute("fill",l);}return n;}};}};});u('sap/viz/controls/plugins/infochart/CategoryAxisLabelRendererGenerator',['./getPropertiesByCtx','./SVG','./Icon'],function(g,S,I){var P=5;var a=3;var D=0.5;return{name:"categoryAxisLabelRenderer",fn:function(c){var b=function(d){var p=g(d,c);if(p){var e=d.position;var f=e==="left";var h=d.size.width;var k=d.size.height;var r=h,l=k;if(f){r-=P;}else{l-=P;}if(r<=0||l<=0){return null;}var m=S.create("g");var t,n;var o=0;if(p.iconVisible===true&&p.iconSVG){var q=p.iconSize;if(q===undefined){q=D;}if(q>0){var s=new I(p.iconSVG);var v=s.getWidth();var w=s.getHeight();var x,y;if(f){x=y=Math.min(k*q,r);}else{x=y=Math.min(h*q,l);}var z=Math.min(x/v,y/w);var C=S.create("g",m);s.render(C,z,p.iconColor);s.destroy();var E=s.getX()*z;var F=s.getY()*z;if(f){t=r-x-E;n=l/2-y/2-F;r-=x+a;}else{t=r/2-x/2-E;n=P-F;l-=y+a;o=y+a;}C.setAttribute("transform","translate("+t+" "+n+")");}}if(r>0&&l>0){if(p.textVisible!==false){var G=!f&&d.rotated===true;var H,J;if(G){H=f?undefined:l;J=r;}else{H=r;J=f?undefined:l;}var K=d.styles;var L=S.createTextNode(d.text,{"font-family":p.fontFamily||K["font-family"],"font-size":p.fontSize||K["font-size"],"font-weight":p.fontWeight||K["font-weight"],"font-style":p.fontStyle||K["font-style"],"fill":p.fontColor||K["fill"]},true,H,J);if(L){var M=L.measure;if(G){var N=p.fontSize||K['font-size'];var O=parseFloat(N)*1.2;var Q=3;var R=6;t=r/2+O/2-Q;n=R;}else{if(f){t=r-M.width-M.x;n=l/2-M.height/2-M.y;if(d.childCells&&d.childCells.length){n-=d.childCells[0].cellHeight/2;}}else{t=r/2-M.width/2-M.x;n=k-l-M.y;}}var T=L.node;if(G){n+=o;T.setAttribute('x',t);T.setAttribute('y',n);T.setAttribute('text-anchor','end');T.setAttribute('transform','rotate(-90,'+t+','+n+')');}else{T.setAttribute("transform","translate("+t+" "+n+")");}m.appendChild(T);}}}return m;}};b.getPreferredSize=function(d){var p=g(d,c);if(!p){return;}var e=b._buildCssString(d.styles,p);var f=d.rotated;if(p.iconVisible===true){if(!p.iconSVG){return;}}else{if(p.textVisible===false){return{cellWidth:0,cellHeight:0,};}else{var t=S.measureText(d.text,e);if(d.position==='left'){return{cellWidth:t.width+P,cellHeight:t.height};}else{if(t.width>d.size){f=true;return{cellWidth:t.height+P,cellHeight:t.width,rotated:true};}else{return{cellWidth:t.width,cellHeight:t.height+P};}}}}var h=P;var k=P;var r=p.iconSize;if(r===undefined){r=D;}if(r<=0){return;}if(d.position==="top"||d.position==="bottom"){h=d.size;k+=d.size*r;if(p.textVisible!==false){var t=S.measureText(d.text,e);if(t.width>d.size){f=true;k+=a+t.width;}else{k+=a+t.height;}}}else{k=d.size;h+=d.size*r;if(p.textVisible!==false){var t=S.measureText(d.text,e);h+=a+t.width;}}return{cellWidth:h,cellHeight:k,rotated:f};};b._buildCssString=function(s,p){var d='';d+='fill:'+(p.fontColor||s['fill'])+';';d+='font-family:'+(p.fontFamily||s['font-family'])+';';d+='font-size:'+(p.fontSize||s['font-size'])+';';d+='font-style:'+(p.fontStyle||s['font-style'])+';';d+='font-weight:'+(p.fontWeight||s['font-weight'])+';';return d;};b.autoHide=function(){return true;};return b;}};});u('sap/viz/controls/plugins/infochart/PieSliceRendererGenerator',["./getPropertiesByCtx","./SVG"],function(g,S){return{name:"pieSliceRenderer",fn:function(c){return function(a,d){var p=g(a,c);if(p&&p.sliceShapeFill){a.graphic.color=p.sliceShapeFill;}return d(a);};}};});u('sap/viz/controls/plugins/infochart/DataLabelRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){var a=5,b=0.8;return{name:"dataLabelRenderer",fn:function(c){return function(d){var p=g(d,c);if(p){var e=S.create("g");var t,f;if(p.textVisible!==false){f=d.text;t=S.create("text",e);t.textContent=f;var s="",h;if((h=p.fontColor)){s+="fill:"+h+";";}if((h=p.fontFamily)){s+="font-family:"+h+";";}if((h=p.fontSize)){s+="font-size:"+h+";";}if((h=p.fontWeight)){s+="font-weight:"+h+";";}if((h=p.fontStyle)){s+="font-style:"+h+";";}if(s){t.setAttribute("style",s);}}if(p.iconVisible===true&&p.iconSVG){var k=p.iconSize;if(k!==0){k=k||b;var l=new I(p.iconSVG);var m=S.create("g",e);var n=l.getWidth();var o=l.getHeight();var q=d.horizontal;var r=q?o:n;var v=d[q?"dataPointHeight":"dataPointWidth"];if(v===0){l.destroy();return e;}var w=v*k/r;l.render(m,w,p.iconColor);l.destroy();if(t){var x=d.styles;var y=S.measureText(f,{"font-family":p.fontFamily||x["font-family"],"font-size":p.fontSize||x["font-size"],"font-weight":p.fontWeight||x["font-weight"],"font-style":p.fontStyle||x["font-style"]});n*=w;o*=w;var z=l.getX()*w;var C=l.getY()*w;var D,E;if(q){D=y.x+y.width+a-z;E=y.y+y.height/2-C-o/2;}else{D=y.x+y.width/2-z-n/2;E=y.y-a-C-o;}m.setAttribute("transform","translate("+D+","+E+")");}}}return e;}};}};});u('sap/viz/controls/plugins/infochart/LineMarkerRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){return{name:"lineMarkerRenderer",fn:function(c){return function(a){var p=g(a,c);if(p){var b=a.graphic,d=p.iconSVG;if(d){var e=p.iconSize;if(e===0){return null;}e=Math.min(p.iconSize,a.bandLength,a.plotSize[a.horizontal?0:1]);d=new I(d);var f=S.create("g");var h=d.getWidth();var k=d.getHeight();var x=e/h;var y=e/k;d.render(f,[x,y],p.iconColor||b.fill);d.destroy();f.setAttribute("transform","translate("+(-d.getX()*x-e/2)+","+(-d.getY()*y-e/2)+")");return f;}}};}};});u('sap/viz/controls/plugins/infochart/LineRendererGenerator',["./getPropertiesByCtx"],function(g){return{name:"lineRenderer",fn:function(c){return function(a){var p=g(a,c);if(p){var b=a.graphic;b.color=p.color||b.color;b.width=p.width||b.width;b.dash=p.dash||b.dash;}};}};});u('sap/viz/controls/plugins/infochart/setup',['sap/viz/controls/chart/adapters/PropFnGeneratorRegistry','./StackDecoratorGenerator','./BarShapeRendererGenerator','./CategoryAxisLabelRendererGenerator','./PieSliceRendererGenerator','./DataLabelRendererGenerator','./LineMarkerRendererGenerator','./LineRendererGenerator'],function(P,S,a,C,b,D,L,c){function r(d){P.register(d.name,d.fn);}var g=[S,a,C,b,D,L,c];g.forEach(r);});u('sap/viz/controls/common/utils/OSUtil',[],function(){function _(){return undefined!==document.documentElement.style.webkitBoxAlign;}function a(){return!!window.XDomainRequest;}function b(){return!!window.chrome;}function c(){return(undefined!==document.documentElement.style.MozBoxAlign)&&("Gecko"===navigator.product);}function d(){return(/javafx\//i).test(window.navigator.userAgent);}function e(){return _()&&!b();}function f(){return(undefined!==window.navigator.standalone)&&_()&&!b();}return{isIE:a,isChrome:b,isFirefox:c,isJavaFx:d,isSafari:e,isSafariMobile:f,isWebkit:_};});u('sap/viz/controls/contextmenu/constants/MenuItemConst',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager'],function(C,L){var M={};M.getText=function(t){return L.get(t);};M.DEFAULT={"icon":"/contextmenu/uncheck.png"};M.LEGEND={"name":"legend","text":"VIZ_CONTEXTMENU_SHOW_LEGEND","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/geomap":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};M.DATALABELS={"name":"datalabels","text":"VIZ_CONTEXTMENU_SHOW_DATALABELS","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/heatmap":true,"viz/treemap":true,"viz/radar":true,"viz/waterfall":true}};M.DIRECTION={"name":"direction","text":{"horizontal":"VIZ_CONTEXTMENU_VERTICAL","vertical":"VIZ_CONTEXTMENU_HORIZONTAL"},"supportType":{"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/boxplot":true,"viz/waterfall":true}};M.STACKING={"name":"stacking","text":{"full":"VIZ_CONTEXTMENU_NORMAL_STACKING","normal":"VIZ_CONTEXTMENU_FULL_STACKING"},"supportType":{"viz/stacked_bar":true,"viz/stacked_column":true,"viz/area":true}};M.COMMENT={"name":"comment","text":"VIZ_CONTEXTMENU_INSERT_COMMENT","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};M.CHARTEDITOR={"name":"charteditor","text":"VIZ_CONTEXTMENU_MENU_CHART_EDITOR","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":true,"viz/tree":true,"viz/network":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};M.MBCLEGEND={"name":"mbclegend","text":"VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR","supportType":{"viz/choropleth":true,"viz/treemap":true,"viz/heatmap":true,"viz/tagcloud":true}};M.MND={"name":"mnd","text":"VIZ_CONTEXTMENU_SHOW_MND","tooltip":"VIZ_CONTEXTMENU_SHOW_MND_TOOLTIP","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":false,"viz/tree":true,"viz/network":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};M.TITLE={"name":"title","text":"VIZ_CONTEXTMENU_SHOW_TITLE","notSupportType":{"viz/geomap":true,}};M.SETAXISSCALE={"name":"setAxisScale","text":"VIZ_CONTEXTMENU_SET_AXIS_SCALE","supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/boxplot":true,"viz/waterfall":true}};M.NEGATIVE={"name":"negative","text":"VIZ_CONTEXTMENU_SHOW_NEGATIVE_VALUES","supportType":{"viz/bubble":true,"viz/geobubble":true}};return M;});u('sap/viz/controls/contextmenu/ContextMenuConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};C.instance=function(){return{'menu':[["direction","stacking"],["title","legend","mbclegend","datalabels","negative","mnd","setAxisScale"],["comment","charteditor"]]};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU,C);return C;});u('sap/viz/controls/contextmenu/ContextMenuEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenuEvent";};O.extend(C,E);C.CONTEXT_MENU_CHANGED="contextMenuChanged";C.POPUP_CONTEXT_MENU="popupContextMenu";C.REQUEST_LEGEND_COLOR="chooseLegendColors";C.POPUP_CHART_EDITOR='popupChartEditor';return C;});u('sap/viz/controls/contextmenu/models/MenuItem',[],function(){var M=function(n,t,a,b,c,d){this._name=n;this._text=t;this._isVisibleFunc=b;this._iconFunc=a;this._clickHandler=c;this._scope=this;this._isCheckable=false;this._tooltip=d;};M.prototype.name=function(v){return this._name;};M.prototype.scope=function(v){if(arguments.length>0){this._scope=v;return this;}else{return this._scope;}};M.prototype.text=function(v){if(this._textFunc){return this._textFunc();}else{return this._text;}};M.prototype.textFunc=function(v){this._textFunc=v;};M.prototype.clickHandler=function(v){if(arguments.length>0){this._clickHandler=v;return this;}else{return this._clickHandler;}};M.prototype.icon=function(v){if(!this._iconFunc){return null;}return this._iconFunc.apply(this._scope,arguments);};M.prototype.supportPropertyZone=function(v,p){if(p==null){return true;}else{return false;}};M.prototype.isVisible=function(v){if(!this._isVisibleFunc){return true;}return this._isVisibleFunc.apply(this._scope,arguments);};M.prototype.isCheckable=function(v){return this._isCheckable;};M.prototype.tooltip=function(v){if(arguments.length>0){this._tooltip=v;return this;}else{return this._tooltip;}};return M;});u('sap/viz/controls/contextmenu/models/DataLabelMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,M,a){var D=function(c,b){D.superclass.constructor.apply(this,[M.DATALABELS.name,M.getText(M.DATALABELS.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.DataLabelMenuItem";this._chartModelProvider=c;this._chartProxyProvider=b;this._isCheckable=true;};O.extend(D,a);D.prototype.isChecked=function(v){if(M.DATALABELS.supportType[v]){var p=this._chartProxyProvider().getProperties();;p=p||{};p.dataLabel=p.dataLabel||{visible:false};var c=p.dataLabel.visible;return c;}return null;};D.prototype._clickHandler=function(){var c=this._chartProxyProvider().getProperties();;var v=!c.dataLabel.visible;var n={};n.dataLabel={};n.dataLabel.visible=v;this._chartProxyProvider().setProperties(n);};return D;});u('sap/viz/controls/contextmenu/models/DirectionMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,M,b){var D=function(c){D.superclass.constructor.apply(this,[M.DIRECTION.name,'',this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.DirectionMenuItem";this._chartModelProvider=c;};O.extend(D,b);D.prototype._textFunc=function(){var d=a.getDirection(this._getType());return M.getText(M.DIRECTION.text[d]);};D.prototype._clickHandler=function(){var d=this.getDirection();if(d==C.DIRECTION_VERTICAL){d=C.DIRECTION_HORIZONTAL;}else{d=C.DIRECTION_VERTICAL;}var c=this._getType();var n=a.changeDirection(c,d);this._chartModelProvider().type(n);};D.prototype._getType=function(){return this._chartModelProvider().type();};D.prototype.getDirection=function(){return a.getDirection(this._getType());};return D;});u('sap/viz/controls/contextmenu/models/LegendMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,M,a){var L=function(c,b){L.superclass.constructor.apply(this,[M.LEGEND.name,M.getText(M.LEGEND.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.LegendMenuItem";this._chartModelProvider=c;this._chartProxyProvider=b;this._isCheckable=true;};O.extend(L,a);L.prototype.supportPropertyZone=function(v,p){if(p==="legend"||p==="sizeLegend"){return true;}return L.superclass.supportPropertyZone.apply(this,arguments);};L.prototype.isChecked=function(v){if(M.LEGEND.supportType[v]){var p=this._chartProxyProvider().getProperties();p=p||{};p.legend=p.legend||{visible:true};var c=p.legend.visible;if(v.search('geo')>-1){var s=p.sizeLegend;c=c&&(s?s.visible:true);}return c;}return null;};L.prototype._clickHandler=function(){var c=this._chartProxyProvider().getProperties();var v=false;if(c&&c.legend){v=!c.legend.visible;}else if(c&&c.sizeLegend){v=!c.sizeLegend.visible;}else if(c&&c.geomap){var l=c.geomap.layers;v=!l[0].options.legendVisible;}var n={};n.legend={};n.legend.visible=v;if(this._chartModelProvider().type().search('geo')>-1||this._chartModelProvider().type().search('bubble')>-1){n.sizeLegend={};n.sizeLegend.visible=v;}this._chartProxyProvider().setProperties(n);};return L;});u('sap/viz/controls/contextmenu/models/StackingMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,M,b){var S=function(c){S.superclass.constructor.apply(this,[M.STACKING.name,'',this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.StackingMenuItem";this._chartModelProvider=c;};O.extend(S,b);S.prototype._textFunc=function(){var s=a.getStacking(this._getType());return M.getText(M.STACKING.text[s]);};S.prototype._clickHandler=function(){var s=this.getStacking();if(s==C.STACKING_NORMAL){s=C.STACKING_FULL;}else{s=C.STACKING_NORMAL;}var c=this._getType();var n=a.changeStacking(c,s);this._chartModelProvider().type(n);};S.prototype._getType=function(){return this._chartModelProvider().type();};S.prototype.getStacking=function(){return a.getStacking(this._getType());};return S;});u('sap/viz/controls/contextmenu/models/MBCLegendMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,M,a){var b=function(c,d){b.superclass.constructor.apply(this,[M.MBCLEGEND.name,M.getText(M.MBCLEGEND.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.MBCLegendMenuItem";this._chartModelProvider=c;this._chartProxyProvider=d;};O.extend(b,a);b.prototype.supportPropertyZone=function(v,p){if(p==="legend"||p==="sizeLegend"){return true;}return b.superclass.supportPropertyZone.apply(this,arguments);};b.prototype._isVisibleFunc=function(v){if(this._chartProxyProvider().isFakeChart()){return false;}var f=this._chartModelProvider().feedingItems();for(var i=0;i<f.length;i++){var c=f[i];if(v===C.TYPE_TAG_CLOUD&&c.id()==="tagFamily"&&c.values().length===0){return false;}if(v===C.TYPE_TREEMAP&&c.id()==="rectangleColor"&&c.values().length===0){return false;}}return true;};return b;});u('sap/viz/controls/contextmenu/models/MNDMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,F,b,M,c){var d=function(e){d.superclass.constructor.apply(this,[M.MND.name,M.getText(M.MND.text),this._iconFunc,this._isVisibleFunc,this._clickHandler,M.getText(M.MND.tooltip)]);this.__className="sap.viz.controls.contextmenu.models.MNDMenuItem";this._chartModelProvider=e;this._isCheckable=true;};O.extend(d,c);d.prototype.isChecked=function(){return this._chartModelProvider().isMNDVisible();};d.prototype._isVisibleFunc=function(v){var s=false;var f;var k=-1;var e=sap.viz.api.manifest.Viz.get(v)[0];if(e){f=e.allFeeds();for(k=0;k<f.length;k++){if(b.canAcceptMND(f[k].acceptMND)){s=true;break;}}}if(!s&&!a.isMultipleChart(v)&&a.supportMultiChart(v)){var m=a.toMultiChartType(v);e=sap.viz.api.manifest.Viz.get(m)[0];f=e.allFeeds();for(k=0;k<f.length;k++){if(b.canAcceptMND(f[k].acceptMND)){s=true;break;}}}if(!s)return false;var g=this._chartModelProvider().feedingItems();for(var i=0;i<g.length;i++){var h=g[i];if(h.type()===F.MEASURE&&h.values().length>0){return true;}}return false;};d.prototype._clickHandler=function(){var v=this._chartModelProvider().isMNDVisible();this._chartModelProvider().isMNDVisible(!v);};return d;});u('sap/viz/controls/contextmenu/models/SetAxisScaleMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,V,C,M,a){var S=function(c,b){S.superclass.constructor.apply(this,[M.SETAXISSCALE.name,M.getText(M.SETAXISSCALE.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.SetAxisScaleMenuItem";this._chartModelProvider=c;this._chartProxyProvider=b;this._isCheckable=false;};O.extend(S,a);S.prototype.isChecked=function(){return false;};S.prototype.supportPropertyZone=function(v,p){var m=this._chartModelProvider();if(V.isValueAxis(m.type(),p)){return true;}return S.superclass.supportPropertyZone.apply(this,arguments);};S.prototype._isVisibleFunc=function(){var m=this._chartModelProvider();var v=V.getValueAxis(m.type());if(v&&v.length>0){return true;}else{return false;}};S.prototype._clickHandler=function(v,p){this._chartProxyProvider().setAxisScale(p);};return S;});u('sap/viz/controls/contextmenu/models/ChartEditorMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,M,a){var b=function(c){b.superclass.constructor.apply(this,[M.CHARTEDITOR.name,M.getText(M.CHARTEDITOR.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.ChartEditorMenuItem";this._chartProxyProvider=c;};O.extend(b,a);return b;});u('sap/viz/controls/contextmenu/models/ShowHideTitleMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,M,b){var S=function(c,d){S.superclass.constructor.apply(this,[M.TITLE.name,M.getText(M.TITLE.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.ShowHideTitleMenuItem";this._chartModelProvider=c;this._chartProxyProvider=d;this._isCheckable=true;};O.extend(S,b);S.prototype.isChecked=function(v){if(!M.TITLE.notSupportType[v]){var p=this._chartProxyProvider().getProperties();p=p||{};p.title=p.title||{visible:true};var c=p.title.visible;return c;}return null;};S.prototype._clickHandler=function(){var c=this._chartProxyProvider().getProperties();var v=false;if(c.title){v=!c.title.visible;}var n={};n.title={};n.title.visible=v;this._chartProxyProvider().setProperties(n);};return S;});u('sap/viz/controls/contextmenu/models/ShowHideNegativeMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,D,M,b){var S=function(c,d){S.superclass.constructor.apply(this,[M.NEGATIVE.name,M.getText(M.NEGATIVE.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.ShowHideNegativeMenuItem";this._chartModelProvider=c;this._chartProxyProvider=d;this._isCheckable=true;};O.extend(S,b);S.prototype.isChecked=function(v){if(M.NEGATIVE.supportType[v]){var p=this._chartProxyProvider().getProperties();;p=p||{};p.plotArea=p.plotArea||{showNagativeValues:false};var c=p.plotArea.showNegativeValues;return c;}return null;};S.prototype._isVisibleFunc=function(v){var d=this._chartProxyProvider().getDataset();if(D.hasNegativeMeasureValue(d,this._chartModelProvider().type())){return true;}return false;};S.prototype._clickHandler=function(){var c=this._chartProxyProvider().getProperties();c=c||{};c.plotArea=c.plotArea||{};var s=!c.plotArea.showNegativeValues;var n={};n.plotArea={};n.plotArea.showNegativeValues=s;this._chartProxyProvider().setProperties(n);};return S;});u('sap/viz/controls/contextmenu/views/MenuItem',['jquery','sap/viz/controls/common/constants/CSSConst'],function($,C){var c=C.CONTEXTMENU_PREFIX;var a=c+"MnuItm";var b=c+"MnuItmIco";var d=c+"MnuItmTxt";var e=c+"MnuItm-Show";var f=c+"MnuItm-Hide";var g=c+"MnuItmIco-Show";var h=c+"MnuItmIco-Hide";var k=c+"MnuItmOpen";var l=C.COMMON_PREFIX+'menu-list-suffix-icon-submenu';var m=C.COMMON_PREFIX+'havanaSharedSprite16';function M(r,s){this.__className="sap.viz.controls.contextmenu.views.MenuItem";r=r||{};var t=this.dom=document.createElement('li');t.className=a;t.innerHTML='<div id="'+r.name+'" class="'+a+'"><div class="'+b+'"></div><div class="'+d+'">'+(r.text===undefined?'':r.text)+'</div><div class="'+l+' '+m+'"></div></div>';this._menuItemNode=t.firstChild;this._iconNode=this._menuItemNode.firstChild;this._textNode=this._iconNode.nextSibling;this._arrowNode=this._menuItemNode.lastChild;this._arrowNode.style.visibility='hidden';this.name=r.name;this.menu=s;if(r.icon){this.setIcon(r.icon);}if(r.tooltip){this.setTooltip(r.tooltip);}if($.isArray(r.submenu)&&r.submenu.length){var v=A('sap/viz/controls/contextmenu/views/Menu');this.setSubmenu(new v(r.submenu,s));}this.onExecute=r.click;this._setupEvents();}M.prototype._setupEvents=function(){var s=this;var r=$(this.dom);function t(){s.showSubmenu();}function v(){if(!s._submenu){s._onExecute();}}r.on('mouseenter',t).on('click',v);s._cleanupEvents=function(){r.off('mouseenter',t).off('click',v);};};M.prototype.destroy=function(){if(this._submenu){this._submenu.destroy();}this._cleanupEvents();$(this.dom).remove();};M.prototype.text=function(){return this._textNode.innerHTML;};M.prototype.setText=function(t){this._textNode.innerHTML=t;};M.prototype.setIcon=function(r){this._iconNode.innerHTML='<img src="'+r+'" />';};M.prototype.setTooltip=function(t){_(this.dom,t,this.menu.container());};M.prototype.submenu=function(){return this._submenu;};M.prototype.setSubmenu=function(r){this._submenu=r;this._arrowNode.style.visibility=r?'':'hidden';};M.prototype.showSubmenu=function(){this.menu.hideSubmenus();if(this._submenu){$(this.dom).addClass(k);this._submenu.show({dock:this.dom},this.menu._hDir+'-down');}};M.prototype.hideSubmenu=function(){if(this._submenu){$(this.dom).removeClass(k);this._submenu.hideSubmenus();this._submenu.hide();}};M.prototype._onExecute=function(){if(this.onExecute){this.onExecute();}this.menu.hideAll();};var T={top:15,left:20};var n=C.CONTEXTMENU_PREFIX+"MnuItmTooltip";function _(r,t,s){var v;var w=$(r);var x=$(s);w.on('mouseover',function(y){var z=$(document.createElement('div')).addClass(n).appendTo($("body"));z.text(t);q(x,z,p(x,o(w)),T);v=setTimeout(function(){$("."+n).animate({opacity:1},500);},1000);});w.on("mouseout mousedown",function(){$("."+n).remove();clearTimeout(v);});}function o(r){var s=r.offset(),w=r.innerWidth(),t=r.innerHeight();return{pageX:s.left+w/2,pageY:s.top+t/2};}function p(r,s){return{pageX:s.pageX-r.offset().left,pageY:s.pageY-r.offset().top};}function q(r,s,t,v){if(!v){v={top:0,left:0};}if(t){var w=r.innerWidth();var x=s.outerWidth();var y=t.pageX+v.left;if(w<x+y){y=t.pageX-x-v.left;}var z=t.pageY+v.top;var D=r.innerHeight();var E=s.outerHeight();if(D<E+z){z=t.pageY-E-v.top;}s.css({position:"fixed",left:r.offset().left+y+"px",top:r.offset().top+z+"px"});}}return M;});u('sap/viz/controls/contextmenu/views/CheckedMenuItem',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/contextmenu/views/MenuItem'],function($,O,C,M){var c=C.CONTEXTMENU_PREFIX+"MnuItm-Show";var a=C.CONTEXTMENU_PREFIX+"MnuItm-Hide";var b=C.CONTEXTMENU_PREFIX+"MnuItmIco-Show";var d=C.CONTEXTMENU_PREFIX+"MnuItmIco-Hide";function e(f){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.views.CheckedMenuItem";this._iconNode.style.display='none';this.setChecked(f.checked);}O.extend(e,M);e.prototype.setChecked=function(f){$(this.dom).toggleClass(b,!!f).toggleClass(d,!f);$(this._menuItemNode).toggleClass(c,!!f).toggleClass(a,!f);};e.prototype.checked=function(){return $(this.dom).hasClass(b);};e.prototype._onExecute=function(){this.setChecked(!this.checked());e.superclass._onExecute.apply(this,arguments);};return e;});u('sap/viz/controls/contextmenu/views/BlankMenuItem',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/contextmenu/views/MenuItem'],function($,O,C,L,M){var c=C.CONTEXTMENU_PREFIX+"blank-MnuItem";var a=C.CONTEXTMENU_PREFIX+'blank-MnuItmTxt';function b(){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.views.BlankMenuItem";$(this.dom).addClass(c);$(this._textNode).addClass(a).text(L.get('VIZ_CONTEXTMENU_NO_MENU_ITEMS'));}O.extend(b,M);return b;});u('sap/viz/controls/contextmenu/views/MenuSeparator',['sap/viz/controls/common/constants/CSSConst'],function(C){function M(){this.__className="sap.viz.controls.contextmenu.views.MenuSeparator";var d=this.dom=document.createElement('div');d.className=C.CONTEXTMENU_PREFIX+"MnuItem-separator";}return M;});u('sap/viz/controls/contextmenu/views/Menu',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/contextmenu/views/MenuItem','sap/viz/controls/contextmenu/views/CheckedMenuItem','sap/viz/controls/contextmenu/views/BlankMenuItem','sap/viz/controls/contextmenu/views/MenuSeparator'],function($,C,M,a,b,c){var d=C.PREFIX+'contextmenu';var e=C.CONTEXTMENU_PREFIX+'list';var f=C.CONTEXTMENU_PREFIX+'list-hovered';var g=document;var w=window;function h(k,p,l){this.__className="sap.viz.controls.contextmenu.views.Menu";var m=this.dom=g.createElement('div');m.className=d;m.innerHTML='<ul class="'+e+'"></ul>';this._listNode=m.firstChild;this._items=[];this._parentMenu=p;this.setContainer(l);this._opennedSubmenuCount=0;this._shown=0;this._setupEvents();this.create(k);}h.prototype.marginOffset=6;h.prototype._setupEvents=function(){var s=this;function n(l,p){var r=false;for(var m=l;m&&!r;m=m._parentMenu){r=$.contains(m.dom,p);}return r;}function o(l){if(s._shown&&s._opennedSubmenuCount===0&&!n(s,l.target)){s.hideAll();}}function k(){s.hide();}$(g).on('mousedown',o);$(w).on('blur',k);this._cleanupEvents=function(){$(g).off('mousedown',o);$(w).off('blur',k);};};h.prototype._createMenuItem=function(k){k=k||{};var m={checked:a,blank:b,separator:c}[k.menuItemType]||M;return new m(k,this);};h.prototype.create=function(k){k=$.isArray(k)?k:[];this._destroyChildren();$(this._listNode).toggleClass(f,!!k.length);if(!k.length){k.push({menuItemType:'blank'});}for(var i=0;i<k.length;++i){var l=this._createMenuItem(k[i]);if(l){this.addChild(l);}}};h.prototype._destroyChildren=function(){for(var i=0;i<this._items.length;++i){var k=this._items[i];if(k.destroy){k.destroy();}}this._listNode.innerHTML='';this._items=[];};h.prototype.destroy=function(){this._destroyChildren();this._cleanupEvents();$(this.dom).remove();};h.prototype.setContainer=function(k){this._container=k||(this._parentMenu&&this._parentMenu.container())||g.body;};h.prototype.container=function(){return this._container;};h.prototype.isShown=function(){return!!this._shown;};h.prototype._calcPopupPosition=function(p,k){var l=this.dom;var m=this._container;var n=0;var t=0;var o;if(p){n=p.left||0;t=p.top||0;o=p.dock;}k=String(k).toLowerCase().split('-');var q=k[0];var v=k[1];this._hDir='right';this._vDir='down';if(m){var r=m.clientHeight;var s=m.clientWidth;var x=l.offsetWidth;var y=l.offsetHeight;var z=$(m).offset();var D=z.left;var E=z.top;if(o){var F=$(o).offset();var G=F.left;var H=F.top;var I=o.offsetWidth;var J=o.offsetHeight;var K=this.marginOffset;if((q==='left'&&D<=G-x)||(q!=='left'&&D+s<G+I+x)){n=G-x;this._hDir='left';}else{n=G+I;}if((v==='up'&&E<=H+J-y)||(v!=='up'&&E+r<H+y)){t=H+J-y+K;this._vDir='up';}else{t=H-K;}}else{if((q==='left'&&n>=x)||(q!=='left'&&s<n+x)){n-=x;this._hDir='left';}if((v==='up'&&up>=y)||(v!=='up'&&r<t+y)){t-=y;this._vDir='up';}n+=D;t+=E;}n-=g.body.scrollLeft;t-=g.body.scrollTop;}return{left:n,top:t};};h.prototype.show=function(p,k){if(!this._shown){if(this._parentMenu){this._parentMenu._opennedSubmenuCount++;}this._shown=1;g.body.appendChild(this.dom);var l=this.dom.style;l.display='block';var m=this._calcPopupPosition(p,k);l.left=m.left+'px';l.top=m.top+'px';}};h.prototype.hide=function(){if(this._shown){if(this._parentMenu){this._parentMenu._opennedSubmenuCount--;}this._shown=0;var k=this.dom;k.style.display='none';if(k.parentNode){k.parentNode.removeChild(this.dom);}}};h.prototype.hideAll=function(){if(this._parentMenu){this._parentMenu.hideAll();}else{this.hideSubmenus();this.hide();}};h.prototype.children=function(){return this._items;};h.prototype.addChild=function(m){var k=this._items.indexOf(m);if(k<0){this._items.push(m);this._listNode.appendChild(m.dom);}};h.prototype.removeChild=function(m){var k=this._items.indexOf(m);if(k>=0){this._items.splice(k,1);this._listNode.removeChild(m.dom);}};h.prototype.hideSubmenus=function(){this._items.forEach(function(k){if(k.hideSubmenu){k.hideSubmenu();}});};return h;});u('sap/viz/controls/contextmenu/ContextMenu',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/contextmenu/ContextMenuEvent','sap/viz/controls/contextmenu/models/MenuItem','sap/viz/controls/contextmenu/models/DataLabelMenuItem','sap/viz/controls/contextmenu/models/DirectionMenuItem','sap/viz/controls/contextmenu/models/LegendMenuItem','sap/viz/controls/contextmenu/models/StackingMenuItem','sap/viz/controls/contextmenu/models/MBCLegendMenuItem','sap/viz/controls/contextmenu/models/MNDMenuItem','sap/viz/controls/contextmenu/models/SetAxisScaleMenuItem','sap/viz/controls/contextmenu/models/ChartEditorMenuItem','sap/viz/controls/contextmenu/models/ShowHideTitleMenuItem','sap/viz/controls/contextmenu/models/ShowHideNegativeMenuItem','sap/viz/controls/contextmenu/views/Menu'],function($,O,a,U,F,V,G,C,E,b,L,c,M,d,f,g,D,h,k,S,l,m,n,o,p,r,s){var t=function(e,q){t.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenu";this._div$=$(e);this._uiConfig=q?q:d.instance();this._uiConfig.contextMenuAssetFolderPath=G.defaultAssetsRoot()+'/common/assets';this._customizedUiConfig={};this._cusMenuItems=null;this._vizModelProvider=$.proxy(this._vizModel,this);this._vizProxyProvider=$.proxy(this._vizProxy,this);this._menu=new s();this._initMenuItemsModel();};O.extend(t,V);var v={CLICK:'Clicked'};t.prototype._onVizModelChanged=function(e){};t.prototype._initMenuItemsModel=function(){this._cusMenuItems={};var e=new k(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[e.name()]=e;var q=new D(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[q.name()]=q;var w=new h(this._vizModelProvider);this._cusMenuItems[w.name()]=w;var x=new S(this._vizModelProvider);this._cusMenuItems[x.name()]=x;var y=new l(this._vizModelProvider,this._vizProxyProvider);y.clickHandler($.proxy(function(){this._dispatchEvent(new f(f.REQUEST_LEGEND_COLOR,this));},this));this._cusMenuItems[y.name()]=y;var z=new m($.proxy(this._vizModelProvider,this));this._cusMenuItems[z.name()]=z;var H=new p(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[H.name()]=H;var I=new n(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[I.name()]=I;var J=new r(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[J.name()]=J;this._setCustomizedMenuItems(this._uiConfig.customizedMenu);};t.prototype._redrawMenuItems=function(e){var q=c.getVizType(this._vizModel().type());var w=F.getVizFeeds(q);if(w){var x=this._getMenuConfig(q,e);this._menu.create(x);}return!!w;};t.prototype._getMenuConfig=function(e,q){var w=this;var x=this._cusMenuItems;var y=this._uiConfig.contextMenuAssetFolderPath?this._uiConfig.contextMenuAssetFolderPath:"../src/common/assets";function z(H){return H.filter(function(I){if(!U.isString(I)){I=I.name;}var J=x[I];return I==='blank'||(J&&J.isVisible(e,q)&&J.supportPropertyZone(e,q));}).filter(function(I,i,J){return!(I==='blank'&&(i===0||i===J.length-1||J[i-1]==='blank'));}).map(function(I){if(I==='blank'){return{menuItemType:'separator'};}var J;if(!U.isString(I)){J=I.submenu;I=I.name;}var K=x[I];var N=K.icon(e,q);return{menuItemType:K.isCheckable()&&'checked',name:K.name(),text:K.text(),tooltip:K.tooltip(),icon:N&&(y+'/'+N),checked:K.isChecked&&K.isChecked(e),click:w._getMenuItemHandler(K,e,q),submenu:J&&z(J)};});}var H=t.typeHelp(e,{menu:this._uiConfig.menu,customizedMenu:this._customizedUiConfig.customizedMenu});return z(H);};t.prototype._getMenuItemHandler=function(e,q,w){var x=this;return function(y){var z=e.clickHandler();if(z){z.apply(e.scope(),[q,w]);}var H={};var I=true;switch(e.name()){case M.LEGEND.name:H.legend=e.isChecked(q);break;case M.DATALABELS.name:H.datalabels=e.isChecked(q);break;case M.DIRECTION.name:H.direction=e.getDirection();break;case M.STACKING.name:H.stacking=e.getStacking();break;case M.TITLE.name:H.title=e.isChecked(q);break;case M.NEGATIVE.name:H.negative=e.isChecked(q);break;default:I=false;break;}if(I){x._dispatchEvent(new f(f.CONTEXT_MENU_CHANGED,x,H));}};};t.prototype.show=function(e,q){this._menu.setContainer(this._div$.parent().get(0));if(this._redrawMenuItems(q)){this._menu.show(e&&{left:e.pageX,top:e.pageY});}};t.prototype.hide=function(){this._menu.hide();};t.prototype.save=function(){var e={};return e;};t.prototype.load=function(e){};t.prototype.addMenuItem=function(e){this._cusMenuItems[e.name()]=e;};t.prototype._setCustomizedMenuItems=function(e){var q=this;function w(y,z){y.forEach(function(H){if(H.name==='blank'){z.push('blank');}else{var I=new g(H.name,H.text,null,H.isVisible);I.clickHandler(function(){if(H.click){H.click.apply(I.scope(),arguments);}var K=new f(q._getEventName(H.name,v.CLICK));q._dispatchEvent(K,q);});q.addMenuItem(I);if(U.isArray(H.submenu)){var J=[];w(H.submenu,J);z.push({name:H.name,submenu:J});}else{z.push(H.name);}}});}if(U.isArray(e)){var x=this._customizedUiConfig.customizedMenu=[];w(e,x);}};t.prototype._getEventName=function(e,q){return e+q;};t.prototype.getEventNames=function(){var e=[f.CONTEXT_MENU_CHANGED,f.REQUEST_LEGEND_COLOR];if(U.isArray(this._customizedUiConfig.customizedMenu)){var q=this._customizedUiConfig.customizedMenu.slice();while(q.length){var w=q.shift();if(U.isString(w)){e.push(this._getEventName(w,v.CLICK));}else{e.push(this._getEventName(w.name,v.CLICK));q=q.concat(w.submenu);}}}return e;};t.typeHelp=function(e,q){var w=[];var x=q.menu||[];for(var i=0;i<x.length;i++){for(var j=0;j<x[i].length;j++){var y=x[i][j].toUpperCase();if(y==='TITLE'){if(!M[y].notSupportType[e]){w.push(x[i][j]);}}else if(M[y].supportType[e]){w.push(x[i][j]);}}if(i!==x.length-1){w.push("blank");}}return w.concat(q.customizedMenu||[]);};return t;});u('sap/viz/controls/custombutton/CustomButtonConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};C.instance=function(){return{"visible":true,"title":"Button"};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON,C);return C;});u('sap/viz/controls/custombutton/CustomButtonEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButtonEvent";};O.extend(C,E);C.CLICK_CUSTOM_BUTTON="clickCustomButton";return C;});u('sap/viz/controls/custombutton/CustomButton',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/custombutton/CustomButtonEvent'],function($,O,U,V,C,a,b){var c=function(d,e){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButton";this._div=d;this._uiConfig=e?e:a.instance();this._button$=null;this._icon$=null;this._createChildren();};O.extend(c,V);c.prototype._createChildren=function(){if(!(this._uiConfig.visible===false)){this._button$=$(document.createElement("div")).appendTo(this._div);this._button$.addClass(C.CUSTOMBUTTON_PREFIX+"button");this._icon$=$(document.createElement("div")).appendTo(this._button$);if(this._uiConfig.title){this.setTitle(this._uiConfig.title);}var _=this;this._button$.click(function(e){var d=_._button$.offset();_._dispatchEvent(new b(b.CLICK_CUSTOM_BUTTON,_,d));});}};c.prototype.setIcon=function(d){if(arguments.length>0){this._icon$.removeAttr('class');this._icon$.addClass(d);return this;}};c.prototype.setTitle=function(t){if(arguments.length>0){this._icon$.attr("title",t);return this;}};return c;});u('sap/viz/controls/filterbar0/FilterBarConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var F={};F.instance=function(){return{"module":{"visible":true}};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_FILTERBAR0,F);return F;});u('sap/viz/controls/frame/VizFrameConfig',['sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/common/constants/ChartConst'],function(G,a,b,C,F,c,d,e){var V={};V.instance=function(){var r={"enableAnnotation":false,"enableAnnotationControl":false,"enableContextMenu":true,"enableFilterMenu":true,"enableFilterBar":true,"enableTitleEditor":true,"enableSettingButton":true,"enableFullScreenButton":true,"enablePlayControl":true,"useInfoChart":false,"controls":{"chart":C.instance(),"filterBar":F.instance(),"contextMenu":c.instance(),"annotation":a.instance(),"annotationControl":b.instance(),"settingButton":d.instance(),"fullScreenButton":d.instance()}};return r;};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_FRAME,V);return V;});u('sap/viz/controls/frame/VizFrameEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var V=function(t,a,d){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrameEvent";};O.extend(V,E);V.FILTERS_CHANGED="filtersChanged";V.CONTEXT_MENU_CHANGED='contextMenuChanged';V.ENTER_FULL_SCREEN="enterFullScreen";V.EXIT_FULL_SCREEN="exitFullScreen";V.ADD_COMMENT='addComment';V.ADD_FILTER='addFilter';V.REQUEST_LEGEND_COLOR='chooseLegendColors';V.POPUP_CHART_EDITOR='popupChartEditor';V.SLICE_DIMENSION_CHANGED="sliceDimensionChanged";return V;});u('sap/viz/controls/frame/chartEditor/ChartEditorEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);};O.extend(F,E);F.FILTER_CLICKED="filterClicked";F.EXCLUDE_CLICKED="excludeClicked";return F;});u('sap/viz/controls/frame/chartEditor/ChartEditor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/frame/chartEditor/ChartEditorEvent'],function($,C,L,O,U,a){var b=function(d,c){b.superclass.constructor.apply(this,arguments);this._dom$=$(d);this._createChildren(c);};O.extend(b,U);b.prototype._createChildren=function(c){var _=this;this._dom$.addClass(C.FRAME_PREFIX+'editor');var d=$('<div/>').appendTo(this._dom$);d.addClass(C.FRAME_PREFIX+'editor-main');d.addClass(C.COMMON_PREFIX+'popUp');var e=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-header');var f=$('<h3/>').appendTo(e).text(L.get("VIZ_FRAME_CHART_EDITOR"));var g=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-content');var h=$('<img/>').appendTo(g).addClass(C.FRAME_PREFIX+'editor-content-img');h.attr('src',c+'/chartEditorPH.png');var k=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-footer');var l=$('<button/>').appendTo(k).text(L.get("VIZ_COMMON_OK"));l.addClass(C.FRAME_PREFIX+'editor-footer-button');l.addClass(C.COMMON_PREFIX+'button');var m=$('<button/>').appendTo(k).text(L.get("VIZ_COMMON_CANCEL"));m.addClass(C.FRAME_PREFIX+'editor-footer-button');m.addClass(C.COMMON_PREFIX+'button');var n=$('<div/>').appendTo(d);n.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');n.addClass(C.FRAME_PREFIX+'editor-close');var o=function(){_._dispatchEvent(new a(a.EDIT_CANCELED,this));_._dispatchEvent(new a(a.EDITOR_CLOSED,this));_._dom$.detach();};var p=function(){_._dispatchEvent(new a(a.EDIT_CONFIRMED,this,{}));_._dispatchEvent(new a(a.EDITOR_CLOSED,this));_._dom$.detach();};l.click(p);m.click(o);n.click(o);};return b;});u('sap/viz/controls/frame/chartEditor/ChartEditorPlugin',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/frame/chartEditor/ChartEditor','sap/viz/controls/frame/chartEditor/ChartEditorEvent'],function($,C,a,b){var c=function(d,v,e){this.__className="sap.viz.controls.frame.chartEditor.ChartEditorPlugin";this._vizFrame=v;this._uiConfig=e;this._div=d;this._chartEditor=null;};c.prototype.validateSize=function(w,h){this._locateChartEditor();};c.prototype.destroy=function(){if(this._chartEditor){this._chartEditor.removeAllEventListeners();this._chartEditor.destroy();this._chartEditor=null;}$(this._div).remove();};c.prototype._popUpEditor=function(){var d=$(this._div);var e=this._uiConfig.chartEditorAssetFolderPath?this._uiConfig.chartEditorAssetFolderPath:'../src/controls/frame/assets';d.children().addClass(C.COMMON_PREFIX+'blur');var f=$(document.createElement('div')).appendTo(d);this._chartEditor=new a(f[0],e);this._locateChartEditor();this._chartEditor.addEventListener(b.EDITOR_CLOSED,function(g){d.children().removeClass(C.COMMON_PREFIX+'blur');});};c.prototype._locateChartEditor=function(){if(this._chartEditor){var d=$(this._div);var e=$(this._chartEditor._dom);e.css({'left':(d.width()-e.width())/2,'top':Math.min(120,(d.height()-e.height())/2)});}};return c;});u('sap/viz/controls/frame/menu/CommentMenuItem',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/constants/MenuItemConst','sap/viz/controls/contextmenu/models/MenuItem'],function(O,C,a,M,b){var c=function(d,e){c.superclass.constructor.apply(this,[M.COMMENT.name,M.getText(M.COMMENT.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.frame.menu.CommentMenuItem";this._chartModelProvider=d;this._chartProxyProvider=e;};O.extend(c,b);c.prototype._isVisibleFunc=function(){var d=a.getVizType(this._getType());var s=this._chartProxyProvider.getSelection();var h=(s&&s.length>0);return(h&&M.COMMENT.supportType[d]);};c.prototype._getType=function(){return this._chartModelProvider().type();};c.prototype.getDirection=function(){return a.getDirection(this._getType());};return c;});u('sap/viz/controls/filterbar0/Tooltip',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function($,C,a,L){var d=1000;var o={x:8,y:16};var T=function(b){this._div=b;this._showing=false;this._tooltip$=null;};T.prototype._getTitle=function(f){if(f.getType()!==a.VALUE_TYPE){return f.filterTitle();}var c=f.values().length;var t=f.filterName()+' ('+c+' ';if(f.isExcluded()){t+=L.get('VIZ_FILTERBAR_ITEMS_EXCLUDED');}else{t+=L.get('VIZ_FILTERBAR_ITEMS_INCLUDED');}t+=')';return t;};T.prototype._showTooltip=function(f){if(!this._showing){return;}if(!this._tooltip$){this._tooltip$=$(document.createElement('div')).appendTo(this._div);}else{this._tooltip$.empty();}var t=this._tooltip$;t.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip');if(f.isGlobalFilter()){var g=L.get('VIZ_FILTERBAR_GLOBAL_FILTER');var b=$(document.createElement('span')).appendTo(t).text(g);b.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-globalfilter');}var c=$(document.createElement('span')).appendTo(t).text(this._getTitle(f));c.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-title');var e=$(document.createElement('span')).appendTo(t);e.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-value');if(f.isExcluded()){e.addClass(C.FILTERBAR0_PREFIX+'filter-exclude');}e.text(f.filterContent());var m=15*15;while(e.height()>m){e.text(e.text().replace(/(\s)*([a-zA-Z0-9]+|\W)(\.\.\.)?$/,"..."));}var l=this._position.left+o.x;var r=this._div.offset().left+this._div.outerWidth();l=Math.min(l,r-t.outerWidth());t.offset({"left":l,"top":this._position.top+o.y});};T.prototype.show=function(f,p){this._position=p;if(this._showing){return;}this._showing=true;var _=this;setTimeout(function(){_._showTooltip(f);},d);};T.prototype.position=function(p){this._position=p;};T.prototype.hide=function(){this._showing=false;if(this._tooltip$){this._tooltip$.remove();this._tooltip$=null;}};return T;});u('sap/viz/controls/filterbar0/FilterBarEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar0.FilterBarEvent";};O.extend(F,E);F.DELETE_FILTER="deleteFilter";F.HEIGHT_CHANGED="heightExtend";return F;});u('sap/viz/controls/filterbar0/FilterBar',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/filterbar0/Tooltip','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/filterbar0/FilterBarEvent'],function($,V,C,E,a,D,L,O,U,b,F,c,d,f,R,g,h,N,k,l,T,m,n){var o=function(e,s){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar0.FilterBar";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control');this._div=e;this._uiConfig=s?s:m.instance();this._containerCurrentPosition=0;this._allAnalyses=null;this._settings=null;this._visualLines=2;this._description$=null;this._layout$=null;this._headerVisible=false;this._isFullScreen=false;this._tooltip=new T(this._div);this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control');};var p=0.8;var q=40;var r=190;O.extend(o,V);o.TYPE_STRING='string';o.TYPE_INTEGER='integer';o.TYPE_NUMBER='number';o.TYPE_DATE='date';var I=16;o.prototype.filterItems=function(e){if(arguments.length>0){this._vizModel().filterItems(e);return this;}else{return this._vizModel().filterItems();}};o.prototype.save=function(){var e={};e['filterItems']=l.toJSON(this._vizModel().filterItems());return e;};o.prototype.load=function(v){var e=null;if(v&&v.filterItems){e=l.fromJSON(v.filterItems);}e=e||[];this._vizModel().filterItems(e);};o.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){this._filtersChanged();}};o.prototype._createChildren=function(){var _=this;var s=this._uiConfig.module;if(s&&!(s.visible===false)){this._headerVisible=true;this._plus$=$(document.createElement("div")).appendTo(this._div);this._plus$.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');this._plus$.addClass(C.FILTERBAR0_PREFIX+'header-plus');this._plus$.click(function(e){_._plusClickHandler(e);});var t=s.label?s.label:L.get('VIZ_FILTERBAR_DESCRIPTION');this._description$=$(document.createElement("span")).text(t).appendTo(this._div);this._description$.addClass(C.FILTERBAR0_PREFIX+"description");}this._layout$=$(document.createElement('div')).appendTo(this._div);this._layout$.addClass(C.FILTERBAR0_PREFIX+'layout');this._layout$.addClass(C.COMMON_PREFIX+'scrollable');this._layout$.addClass(C.COMMON_PREFIX+'scrollable-y');this._layout$.css({'max-height':this._visualLines*q});this._filterItemsContainer$=$(document.createElement('div')).appendTo(this._layout$);this._filterItemsContainer$.addClass(C.FILTERBAR0_PREFIX+'filterItems-container');if(this._headerVisible===true){this._layout$.hide();}else{this._layout$.css({'left':'0px'});}$(this._div).droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,over:$.proxy(this._dragOver,this),out:$.proxy(this._dragOut,this),drop:$.proxy(this._drop,this)});};o.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e;}else{return this._allAnalyses;}};o.prototype._plusClickHandler=function(e){var s=document.createElement('div');var t=this._getExcludeGlobalFilter(this._vizModel().filterItems());var v=new F(s,this._allAnalyses,f.DIMENSION,t);v.addEventListener(c.ITEM_SELECTED,function(x){var y=x.data.selectedItem;if(y){this._addFilterItem(y);}},this);var w=this._plus$.offset();v.open({x:w.left,y:w.top,shelfWidth:this._plus$.width()});};o.prototype._getExcludeGlobalFilter=function(e){var s=[];if(e){for(i=0;i<e.length;i++){if(e[i].isGlobalFilter()==false){s.push(e[i]);}}}return s;};o.prototype._getDroppableAnalysisObject=function(t){if(!t||!t.analysisObject){return null;}var e=t.analysisObject;var s=e.type();var v=l.getFilterInfo(e);if(d.compatible(d.DIMENSION,s)&&!l.isFilterItemExisted(this._vizModel(),v.id,v.hierarchyLevelId)&&s!==d.MND){return e;}else{return null;}};o.prototype._dragOver=function(e,s){var t=D.instance().getAnalysisToken(s.helper);if(!t){return;}var v=this._getDroppableAnalysisObject(t);if(v){t.currentAction(b.ACCEPT_AS_COPY);}else{t.currentAction(b.DENY);}};o.prototype._dragOut=function(e,s){var t=D.instance().getAnalysisToken(s.helper);if(t){t.currentAction(b.DENY);}};o.prototype._drop=function(e,s){var t=D.instance().getAnalysisToken(s.helper);if(!t){return;}var v=this._getDroppableAnalysisObject(t);if(v){t.currentAction(b.ACCEPT_AS_COPY);this._addFilterItem(v);}else{t.currentAction(b.DENY);}t.dropTarget(this._dom);};o.prototype._addFilterItem=function(e){var s=l.getFilterInfo(e);var t=s.name;var v=s.id;var w=e.dataType();var x;switch(w){case o.TYPE_INTEGER:case o.TYPE_NUMBER:x=new N(v,t);break;case o.TYPE_DATE:x=new h(v,t);break;case o.TYPE_STRING:default:x=new k(v,t);if(s.hierarchyLevelId){x.hierarchyLevelId=s.hierarchyLevelId;}break;}var y=this._vizModel().filterItems();y.push(x);this._vizModel().filterItems(y);this._dispatchRequestFilterEvent(x);};o.prototype._filtersChanged=function(){if(this._filterItemsContainer$){this._filterItemsContainer$.empty();}var e=this._vizModel().filterItems();if(!e||e.length==0){this._updateDescription();return this;}if(this._headerVisible===true){this._description$.hide();this._layout$.show();}this._updateFilterItemContainer();};o.prototype._dispatchRequestFilterEvent=function(e){var _=this;var v=function(w){var x=_._vizModel().filterItems();if(e.isEmpty()){var y=x.indexOf(e);if(y>=0){x.splice(y,1);_._vizModel().filterItems(x);_._tooltip.hide();}return;}if(w){_._vizModel().filterItems(x);}};var s=$('#'+e.id(),this._filterItemsContainer$);var t={bounds:R.toJSON(R.parseDOM(s)),filterName:e.filterName(),analysisObjectId:e.analysisObjectId(),filterItem:e,validate:v};this._dispatchEvent(new a(E.REQUEST_FILTER_VALUES,this,t));};o.prototype._createFilterTitle=function(e,s){if(e.getType()!==g.VALUE_TYPE){var t=$(document.createElement('span')).appendTo(s).text(e.filterTitle());t.addClass(C.FILTERBAR0_PREFIX+'filter-item-text');t.addClass(C.FILTERBAR0_PREFIX+'range-filter-item-text');return;}var v=$(document.createElement('div')).appendTo(s);var w=$(document.createElement('div')).appendTo(v).text(e.filterName()).css("display",'inline');w.addClass(C.FILTERBAR0_PREFIX+'filter-item-text').attr('id','filterName');var x=$(document.createElement('div')).appendTo(v).css("display",'inline').attr('id','countInfo');x.addClass(C.FILTERBAR0_PREFIX+'filter-item-info');$(document.createElement('span')).appendTo(x).text('(');var y=$(document.createElement('span')).appendTo(x).text(e.values().length);if(e.isExcluded()){y.addClass(C.FILTERBAR0_PREFIX+'filter-exclude');}$(document.createElement('span')).appendTo(x).text(')');};o.prototype._createFilterItem=function(s){var t=s.filterName();var _=this;var v=document.createElement('div');var w=$(v).appendTo(this._filterItemsContainer$);this._createFilterTitle(s,w);if(s.isGlobalFilter()){w.attr({'id':'GLOBAL-'+s.id()});w.addClass(C.FILTERBAR0_PREFIX+'global-filter-item');}else{w.attr({'id':s.id()});w.addClass(C.FILTERBAR0_PREFIX+'filter-item');w.click(function(){_._dispatchRequestFilterEvent(s);});var x=$(document.createElement('div')).appendTo(w);x.addClass(C.FILTERBAR0_PREFIX+'delete-icon');x.addClass(C.COMMON_PREFIX+'UVBSharedSprite');x.click(function(e){_._removeFilterItem(s);_._dispatchEvent(new n(n.DELETE_FILTER,_));_._tooltip.hide();e.stopPropagation();});}return w;};o.prototype._stringToNumber=function(v){if(!v){return 0;}return parseInt(v.replace('px',''));};o.prototype.validateSize=function(){var e=this._filterItemsContainer$.children();if(e.length==0){return this;}e.css({'width':r});this._updateFilterItemsWidth();};o.prototype._needAdjust=function(){var e=this._filterItemsContainer$.innerHeight();var s=e>q;if(s){return true;}else{return false;}};o.prototype._updateFilterItemContainer=function(){var e=this._vizModel().filterItems();var i;for(i=0;i<e.length;i++){this._createFilterUI(e[i]);}this._updateFilterItemsWidth();return this;};o.prototype._createFilterUI=function(e){var s=e.filterName();var t;var _=this;t=this._createFilterItem(e);t.mouseover(function(v){_._tooltip.show(e,{left:v.clientX,top:v.clientY});$('.'+C.FILTERBAR0_PREFIX+'filter-values',v.currentTarget).addClass(C.FILTERBAR0_PREFIX+'filter-values-active');});t.mousemove(function(v){_._tooltip.position({left:v.clientX,top:v.clientY});});t.mouseout(function(v){_._tooltip.hide();$('.'+C.FILTERBAR0_PREFIX+'filter-values',v.currentTarget).removeClass(C.FILTERBAR0_PREFIX+'filter-values-active');});this._addFilterValues(e,t);};o.prototype._updateFiltersTitle=function(){var e=function(s,t){var v=$('#filterName',t);if(v.length===0){return;}v.css({'width':'auto'});var w=v.parent();var x=$('#countInfo',t);var y=v.position();var z=v.width()+y.left+2;var G=w.width()-I;var H=x.width();var J=Math.min(z,G-H);v.css({'width':J-y.left});x.css({'left':J});};$('.'+C.FILTERBAR0_PREFIX+'filter-item',this._div).each(e);$('.'+C.FILTERBAR0_PREFIX+'global-filter-item',this._div).each(e);};o.prototype._updateFilterItemsWidth=function(){var e;if(this._filterItemsContainer$.children().length===0){this._updateDescription();return this;}if(!this._needAdjust()){e={'height':q};this._dispatchEvent(new n(n.HEIGHT_CHANGED,this,e));this._updateFiltersTitle();return this;}var s=0;while(this._needAdjust()&&s<2){s++;var t=$('.'+C.FILTERBAR0_PREFIX+'filter-item');var w=$($('.'+C.FILTERBAR0_PREFIX+'filter-item')[0]).outerWidth()*p;t.css({'width':w});}if(this._needAdjust()){e={'height':this._avaliableHeightForHeader()};this._dispatchEvent(new n(n.HEIGHT_CHANGED,this,e));if(e.height<this._filterItemsContainer$.outerHeight()){$(this._layout$).scrollTop(this._filterItemsContainer$.outerHeight());}}if(!this._needAdjust()){e={'height':q};this._dispatchEvent(new n(n.HEIGHT_CHANGED,this,e));};this._updateFiltersTitle();return this;};o.prototype._avaliableHeightForHeader=function(){var e=this._filterItemsContainer$.outerHeight();var s=q-2;var t=q;var v=this._visualLines-1;for(var i=2;i<=this._visualLines;i++){if(s*i<=e&&e<=t*i){v=i-1;break;}}var w=2;return v*s+t+w;};o.prototype._addFilterValues=function(e,s){var v=e.filterContent();var t=s.find("span[id='values']");if(t.length===0){t=$(document.createElement('span')).appendTo(s);t.addClass(C.FILTERBAR0_PREFIX+'filter-values');t.attr({id:'values'});}t.text(v);var w=C.FILTERBAR0_PREFIX+'filter-exclude';if(e.isExcluded()){t.addClass(w);}else{t.removeClass(w);}};o.prototype._removeFilterItem=function(e){var s=this._vizModel().filterItems().slice(0);var t=s.indexOf(e);s.splice(t,1);this._vizModel().filterItems(s);return s;};o.prototype._updateDescription=function(){var e=this._vizModel().filterItems();if(e.length===0&&this._headerVisible===true){this._description$.show();this._layout$.hide();}};return o;});u('sap/viz/controls/frame/views/FilterMenuEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenuEvent";};O.extend(F,E);F.FILTER_CLICKED="filterClicked";F.EXCLUDE_CLICKED="excludeClicked";return F;});u('sap/viz/controls/frame/views/FilterMenu',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/frame/views/FilterMenuEvent'],function($,O,U,C,L,F){var a=function(d,b){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenu";this._div=d;this._uiConfig=b;this._container=null;this._createChildren();};O.extend(a,U);a.prototype._createChildren=function(){this._container=$(document.createElement('div')).appendTo(this._div);$(this._container).addClass(C.FRAME_PREFIX+"filtermenu");var b=$(document.createElement('div')).appendTo(this._container);var f=$(document.createElement('div')).appendTo(b);f.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');f.addClass(C.FRAME_PREFIX+'filtermenu-filter-icon');var c=$(document.createElement('div')).appendTo(b);c.text(L.get('VIZ_FRAME_FILTERMENU_FILTER'));b.click($.proxy(function(){this._dispatchEvent(new F(F.FILTER_CLICKED),this);},this));var d=$(document.createElement('div')).appendTo(this._container);var e=$(document.createElement('div')).appendTo(d);e.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');e.addClass(C.FRAME_PREFIX+'filtermenu-exclude-icon');var g=$(document.createElement('div')).appendTo(d);g.text(L.get('VIZ_FRAME_FILTERMENU_EXCLUDE'));$(d).click($.proxy(function(){this._dispatchEvent(new F(F.EXCLUDE_CLICKED),this);},this));};a.prototype.show=function(s,b){if(s||b){$(this._container).css({bottom:2+'px','visibility':'visible','display':'block'});$(this._container).show();}else{$(this._container).hide();}};a.prototype.hide=function(){$(this._container).hide();};a.prototype.size=function(s){$(this._container).css({left:(s.width-$(this._container).outerWidth())/2+'px'});};return a;});u('sap/viz/controls/chart/views/TitleContextMenu',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','jquery'],function(O,a,U,C,$){var b=function(d,c){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleContextMenu";this._div=d;this._menu=null;this._visible=true;this._shown=false;this._cusMenuItems=c;this._createContextMenu();this._mousedownHandler=$.proxy(this._handleMousedownEvent,this);};O.extend(b,U);b.prototype._createContextMenu=function(){var _=this;this._menu=document.createElement('div');$(this._menu).addClass(C.PREFIX+'contextmenu');$(this._div).append(this._menu);this.hide();this._ul=document.createElement('ul');$(this._ul).addClass([C.CONTEXTMENU_PREFIX+'list',C.CONTEXTMENU_PREFIX+'list-hovered'].join(' '));$(this._ul).appendTo(this._menu);};var E=[];b.prototype._getCusMenuItem=function(n){if(this._cusMenuItems&&this._cusMenuItems.length>0){for(var i=0;i<this._cusMenuItems.length;i++){var m=this._cusMenuItems[i];if(m.name===n){return m;}}}return null;};b.prototype.updateMenu=function(){var v=[];$(this._ul).empty();for(var i=0;i<this._cusMenuItems.length;i++){var c=this._cusMenuItems[i];this._createMenuItemUI(c);}};b.prototype._createMenuItemUI=function(c){var t=c.text;var e={};e.clickHandler=c.clickHandler;e.scope=c.scope;var d=c.enableValidator.apply(c.scope);var f=c.name;var l=document.createElement('li');var m=document.createElement('div');$(l).addClass(C.CONTEXTMENU_PREFIX+"MnuItm");$(m).addClass(C.CONTEXTMENU_PREFIX+"MnuItm");$(l).appendTo(this._ul);$(m).appendTo(l);var T=$("<div>",{"class":C.CONTEXTMENU_PREFIX+"MnuItmTxt"});$(T).appendTo(m);$(T).text(t);if(d){$(T).css("color","black");}else{$(T).css("color","grey");}m.id=f;var _=this;if(d){$(m).click(function(g){if(e.clickHandler){e.clickHandler.apply(e.scope);}_.hide();});}else{$(m).click(function(g){_.hide();});}};b.prototype.isShown=function(){return this._shown;};b.prototype.show=function(o){this.updateMenu();if(o&&o.position){var p=$(this._div).innerWidth();var m=$(this._menu).outerWidth();var l=o.position.pageX;if(p<m+l){l=p-m;}var t=o.position.pageY;var c=$(this._div).parent().innerHeight();var d=$(this._menu).outerHeight();if(c<d+t){t=c-d;}t+=$(this._div).parent().offset().top;if(l<0){l=$(this._div).parent().offset().left;}else{l+=$(this._div).parent().offset().left;}$(this._menu).css({position:"fixed",left:l+"px",top:t+"px"});}$(this._menu).css('visibility','visible');this._shown=true;document.removeEventListener("mousedown",this._mousedownHandler,true);$(window).off('blur',this._mousedownHandler);document.addEventListener("mousedown",this._mousedownHandler,true);$(window).on('blur',this._mousedownHandler);};b.prototype._handleMousedownEvent=function(e){var c=e.target.id;if(a.isIE()&&c==""){c=e.target.parentNode.id;}var d=this._getCusMenuItem(c);if(d){return;}this.hide();};b.prototype.hide=function(){$(this._menu).find('*').removeData().off();$(this._menu).css('visibility','hidden');this._shown=false;};return b;});u('sap/viz/controls/chart/views/TitleEditor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/chart/views/TitleContextMenu','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/chart/Chart'],function($,C,O,a,E,V,R,T,L,b,c){var d=function(e,f){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleEditor";this._targetDiv=e;this._uiconfig=f;this._editing=false;this.createChildren();};O.extend(d,V);d.prototype.createChildren=function(){var p=this._targetDiv;this._div=$(document.createElement("DIV"));this._textInput=$('<input type="text" spellcheck="false"/>');this._textInput.addClass(C.CHART_PREFIX+'title-text');this._textInput.attr('value',this._vizProxy().getTitleText());this._settingBtn=$(document.createElement("div"));this._settingBtn.addClass(C.CHART_PREFIX+'title-button');var s=$(document.createElement("div")).appendTo(this._settingBtn);s.addClass(C.COMMON_PREFIX+"UVBSharedSprite");s.addClass(C.CHART_PREFIX+"setting-icon");this._settingBtn.hide();var m=[{text:L.get('VIZ_CHART_TITLE_CONTEXT_MENU_EDIT'),name:'edit',clickHandler:this.enterEditMode,enableValidator:function(){return true;},scope:this},{text:L.get('VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE'),name:'restore',clickHandler:this.restore,enableValidator:function(){return this.edited();},scope:this}];this._contextMenu=new T(p,m);this._div.append(this._textInput).append(this._settingBtn).appendTo(p);var _=this;document.addEventListener("mousedown",function(e){_._documentMouseDownHandler(e);},true);this._settingBtn.click(function(e){_._popupContextMenu();});this._div.bind("mouseover",function(){_.mouseOver();}).bind("mouseout",function(){_.mouseOut();}).bind("dblclick",function(){_.dblClick();}).bind('keypress',function(e){if(e.keyCode==13){_._documentKeyPressHandler(e);e.preventDefault();}});};d.prototype.editable=function(){return!this._vizProxy().isFakeChart();};d.prototype.edited=function(){return this._vizProxy().isTitleCustomized();};d.prototype.restore=function(){this._editing=false;this._vizProxy().setTitleMode(c.VIZ_TITLE_MODE.auto);this._vizProxy().restoreTitleText();};d.prototype.enterEditMode=function(){if(this.editable()){this._settingBtn.hide();this._editing=true;this._layoutTitleDiv();this._textInput.css({'display':'block'});this._textInput.val(this._vizProxy().getTitleText());this._textInput.focus().select();};};d.prototype._layoutTitleDiv=function(){var e=this._vizProxy().getTitleZone();if(e&&e.length>0){var s=this._targetDiv.scrollLeft();var l=e[0][0],t=e[0][1],w=e[2][0]-e[0][0],h=e[2][1]-e[0][1];var f="position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;";if(this._editing){var p=8;f+="left:"+s+"px;top:"+(t-p)+"px;width:100%;"+"height:"+(h+p*2)+"px;";this._div.addClass(C.CHART_PREFIX+'title-edit');}else{f+="left:"+l+"px;top:"+t+"px;width:"+(w+16)+"px;height:"+h+"px;";if(a.isIE()){f+="background-color:rgba(0,0,0,0)";}this._div.removeClass(C.CHART_PREFIX+'title-edit');};this._div.attr('style',f);};};d.prototype.init=function(){if(b.supportTitle(this._vizModel().type())){this.size();this._show();}else{this._hide();}};d.prototype._show=function(){this.show();};d.prototype._hide=function(){this.hide();};d.prototype.dblClick=function(){if(this.editable()&&!this._editing){this.enterEditMode();};};d.prototype._popupContextMenu=function(){var e=this._vizProxy().getTitleZone();var l=e[0][0],t=e[0][1],w=e[2][0]-e[0][0],h=e[2][1]-e[0][1];var o=95;var p={pageX:l+w-o-this._targetDiv.scrollLeft(),pageY:t+h-this._targetDiv.scrollTop()};this._contextMenu.show({position:p});};d.prototype.mouseOver=function(){var t=this._vizProxy().getProperties().title||{visible:true};if(this.editable()&&!this._editing&&t.visible){this._layoutTitleDiv();this._settingBtn.show();};};d.prototype.mouseOut=function(){if(this.editable()&&!this._editing){this._layoutTitleDiv();if(a.isIE()){this._div.css({'border-width':'0px','background-color':'rgba(0,0,0,0)'});}else{this._div.css({'border-width':'0px','background-color':'transparent'});}this._textInput.css({'display':'none'});this._textInput.blur();if(!this._contextMenu.isShown()){this._settingBtn.hide();}};};d.prototype._documentMouseDownHandler=function(e){if(this._editing&&e.target!==this._textInput[0]){this._commitTitleEdit();e.stopPropagation();}if(this._contextMenu.isShown()&&e.target!=this._settingBtn[0]&&e.target.parentElement!=this._settingBtn[0]){this._settingBtn.hide();}};d.prototype._documentKeyPressHandler=function(e){if(this._editing&&e.target===this._textInput[0]){this._commitTitleEdit();e.stopPropagation();}};d.prototype._onVizModelChanged=function(){this.init();};d.prototype._commitTitleEdit=function(){this._editing=false;var t=this._textInput[0].value;if(t!=this._vizProxy().getTitleText()){this._vizProxy().setTitleMode(c.VIZ_TITLE_MODE.manual);this._vizProxy().setTitleText(t);}this.mouseOut();};d.prototype.size=function(){this._layoutTitleDiv();if(this._contextMenu.isShown()){this._popupContextMenu();}};d.prototype.load=function(){this.init();};return d;});u('sap/viz/controls/playcontrol/PlayControlEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var P=function(t,a,d){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.playcontrol.PlayControlEvent";};O.extend(P,E);P.SLICE_DIMENSION_CHANGED="sliceDimensionChanged";P.UPDATE_CHART_COMPLETE="updateChartComplete";return P;});u('sap/viz/controls/playcontrol/PlayControl',["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/playcontrol/PlayControlEvent",'sap/viz/controls/common/feeds/AnalysisObject',"sap/viz/controls/common/utils/Utils","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/constants/ChartConst"],function($,V,G,C,O,P,a,U,F,b){var c=0,d=1,f=2,D=1,g=1000,k="/controls/playcontrol/assets/paused.svg",l="/controls/playcontrol/assets/inprogress.svg",L=48;var m=function(p){this._player=p;this._t=null;this._lastUpdateTstmp=0;};m.prototype._playerUpdateHandler=function(){if(this._player){var t=(new Date()).getTime();if(t-this._lastUpdateTstmp>=g){this._player._progressing();this._lastUpdateTstmp=t;}else{if(!this._t){this._t=setTimeout($.proxy(function(){clearTimeout(this._t);this._t=null;this._playerUpdateHandler();},this),t-this._lastUpdateTstmp);}}}};m.prototype.start=function(){this._player._start();if(!this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.addEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this);}this._playerUpdateHandler();};m.prototype.pause=function(){if(this._t){clearTimeout(this._t);this._t=null;}if(this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.removeEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this);}this._player._pause();};m.prototype.stop=function(){if(this._t){clearTimeout(this._t);this._t=null;}if(this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.removeEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this);}this._player._stop();};var n=function(e,h){n.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.playcontrol.PlayControl";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_playcontrol");this._div=e;this._body=null;this._slider=null;this._playBtn=null;this._slicedData=[];this._labelDiv=null;this._timer=new m(this);this._state=c;this._currentVal=0;this._step=D;this._visible=false;this._chartFeedings=[];this._createChildren();this._chartUpdateCompleteHandler=$.proxy(function(){this._dispatchEvent(new P(P.UPDATE_CHART_COMPLETE,this));},this);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_playcontrol");};O.extend(n,V);n.prototype.sliceDimension=function(e){if(arguments.length>0){this._vizModel().playerField(e);return this;}else{return this._vizModel().playerField();}};n.prototype.slicedData=function(s){if(arguments.length>0){this._slicedData=s;this._resetControls();this._resetChartFrameDataScale();this._timer.stop();}else{return this._slicedData;}};n.prototype._createChildren=function(){var _=this;var e=this._uiConfig;if(!this._body){this._body=$(document.createElement("div")).appendTo(this._div);this._body.addClass(C.PLAYCTRL_PREFIX+"body");}if(!this._playBtnDiv){this._playBtnDiv=$(document.createElement("div")).appendTo(this._body);this._playBtnDiv.addClass(C.PLAYCTRL_PREFIX+"playbtn");this._playBtn=new sap.ui.commons.Button({icon:G.defaultAssetsRoot()+k,iconDesityAware:true,press:$.proxy(_._btnPress,this)});this._playBtn.addStyleClass(C.PLAYCTRL_PREFIX+"playbtn");this._playBtn.placeAt(this._playBtnDiv);}if(!this._sliderDiv){this._sliderDiv=$(document.createElement("div")).appendTo(this._body);this._sliderDiv.addClass(C.PLAYCTRL_PREFIX+"slider");this._slider=new sap.ui.commons.Slider({editable:false,min:0,max:1,smallStepWidth:1,liveChange:$.proxy(this._sliderValueChange,this)});this._slider.placeAt(this._sliderDiv);}if(!this._labelDiv){this._labelDiv=$(document.createElement("div")).appendTo(this._body);this._labelDiv.addClass(C.PLAYCTRL_PREFIX+"label").text("text");}this._resetControls();};n.prototype._progressing=function(){this._currentVal+=this._step;if(this._currentVal>this._slider.getMax()){this._timer.stop();return;}this._updateControls();this._updateChartData();};n.prototype._start=function(){this._state=d;this._updateControls();this._updateChartScale();this._enableChartInteraction(false);};n.prototype._stop=function(){this._state=c;this._currentVal=0;this._updateControls();this._updateChartData();this._enableChartInteraction(true);};n.prototype._pause=function(){this._state=f;this._updateControls();this._enableChartInteraction(true);};n.prototype._updateChartData=function(){if(this._slicedData&&this._slicedData.slices&&this._slicedData.slices[this._currentVal]!==undefined){this._vizProxy().SetDataset(this._slicedData.slices[this._currentVal].data);}};n.prototype._updateChartScale=function(){if(this._vizModel().type()===b.TYPE_GEO_BUBBLE){var p=this._vizProxy().getProperties();if(p&&p.geoContainer){this._vizProxy().updateProperties({properties:{geoContainer:{scale:p.geoContainer.scale,center:p.geoContainer.center}}});}}};n.prototype._resetChartFixScale=function(){if(this._vizModel().type()===b.TYPE_GEO_BUBBLE){this._vizProxy().updateProperties({properties:{geoContainer:{isFixedScale:this.sliceDimension()!=null,scale:null,center:[]}}});}};n.prototype._resetChartFrameDataScale=function(){function e(z,E){var i,H,I=Number.MAX_VALUE,J=Number.MIN_VALUE,K=false;if(z&&E){for(i=0;i<z.length;i++){H=z[i].name();if(E[H]){I=Math.min(E[H][0],I);J=Math.max(E[H][1],J);K=true;}}}return K?[I,J]:[0,0];}function h(z,E,H){var I=E.split("."),j,J;for(j=0,J=z;j<I.length;j++){if(j==I.length-1){J[I[j]]=H;}else{J[I[j]]=J[I[j]]||{};J=J[I[j]];}}}var o={},p=[],q=this._vizModel().type(),r=sap.viz.api.manifest.Viz.get(q),s={},t,v,w,x={},y=r&&r[0]?r[0].dataScale:null;if(!y){return;}if(this._slicedData&&U.isArray(this._slicedData.measuresInfo)){this._slicedData.measuresInfo.forEach(function(z){s[z.name]=z.range;});}if(this._chartFeedings){p=this._chartFeedings.filter(function(z){return z&&z.type()===F.MEASURE;});if(p.length>0){p.forEach(function(z){x[z.id()]=e(z.values(),s)});}}for(t in x){if(x.hasOwnProperty(t)){w=x[t];}if(y[t]&&U.isArray(y[t].minValue)){y[t].minValue.forEach(function(z){h(o,z,w[0]);});}if(y[t]&&U.isArray(y[t].maxValue)){y[t].maxValue.forEach(function(z){h(o,z,w[1]);});}}this._vizProxy().updateProperties({properties:o});};n.prototype._enableChartInteraction=function(e){if(this._vizModel().type()===b.TYPE_GEO_BUBBLE){this._vizProxy().updateProperties({properties:{geoController:{disableInteraction:!e}}});}};n.prototype._updateControls=function(){switch(this._state){case c:this._playBtn.setIcon(G.defaultAssetsRoot()+k);break;case d:this._playBtn.setIcon(G.defaultAssetsRoot()+l);break;case f:this._playBtn.setIcon(G.defaultAssetsRoot()+k);break;}this._slider.setValue(this._currentVal);if(this._slicedData&&this._slicedData.slices&&this._slicedData.slices[this._currentVal]!==undefined){this._labelDiv.text(this._slicedData.slices[this._currentVal].dimensionMember);this._alignLabelWithSliderThumb();}};n.prototype._alignLabelWithSliderThumb=function(){this._labelDiv.width("auto");var s=this._sliderDiv.offset().left,e=this._sliderDiv.width(),h=Math.min(e,this._labelDiv.width()),t=$(".sapUiSliGrip",this._sliderDiv).offset()?$(".sapUiSliGrip",this._sliderDiv).offset().left:0;this._labelDiv.width(h+1);this._labelDiv.offset({left:h+t<s+e?t:s+e-h});};n.prototype._resetControls=function(){var h=!!(this._slicedData&&this._slicedData.slices&&this._slicedData.slices.length>0);this._playBtn.setEnabled(h);this._slider.setEditable(h);this._slider.setEnabled(h);this._slider.setMin(0);this._slider.setMax(h?this._slicedData.slices.length-1:1);this._updateControls();this._updateLabelVisiblity();};n.prototype._btnPress=function(){switch(this._state){case c:case f:this._timer.start();break;case d:this._timer.pause();break;}};n.prototype._onConnect=function(e){n.superclass._onConnect.apply(this,arguments);this._chartFeedings=this._vizModel().feedingItems();this._sliceDimensionChanged();this._vizProxy().on("initialized.playcontrol",this._chartUpdateCompleteHandler);};n.prototype._onVizModelChanged=function(e){if(e.data.feedingItemsChanged){this._chartFeedings=this._vizModel().feedingItems();this.slicedData([]);}if(e.data.sliceDimensionChanged){this._sliceDimensionChanged();}};n.prototype._sliderValueChange=function(){this._currentVal=this._slider.getValue();this._updateControls();this._updateChartScale();this._updateChartData();};n.prototype._sliceDimensionChanged=function(){this.slicedData([]);this._resetChartFixScale();var e={"sliceDimension":this.sliceDimension()};this._dispatchEvent(new P(P.SLICE_DIMENSION_CHANGED,this,e));};n.prototype.validateSize=function(w,h){var e=0,o=0,s,p=$(this._body).height();$(this._body).css({width:w});if(this._playBtnDiv){e=this._playBtnDiv.outerWidth();o=this._playBtnDiv.outerHeight();this._playBtnDiv.css({top:p/2-o/2+"px",left:0+"px",position:"absolute"})}if(this._sliderDiv){s=w-e;this._slider.setWidth(s+"px");sliderHeight=this._slider.getHeight();this._sliderDiv.css({top:p/2+"px",left:e+"px",position:"absolute"})}if(this._labelDiv){setTimeout($.proxy(function(){this._alignLabelWithSliderThumb();},this),0)}if(this._slider.oGrip&&this._slider.oGrip.title){$(".viz-controls-playcontrol-slider #__slider0-grip").mouseover(function(q){$('#__slider0-grip').attr('title'," ");});}};n.prototype.visible=function(v){n.superclass.visible.apply(this,arguments);this._visible=v;this._updateLabelVisiblity();};n.prototype._updateLabelVisiblity=function(){var h=!!(this._slicedData&&this._slicedData.slices&&this._slicedData.slices.length>0);this._labelDiv.css("visibility",h&&this._visible?"visible":"hidden");};n.prototype.save=function(o){var s={},i=0;if(o&&o.emptyDataset===true){s.measuresInfo=[];s.slices=[];}else if(this._slicedData){s.measuresInfo=this._slicedData.measuresInfo;if(U.isArray(this._slicedData.slices)){s.slices=[];for(;i<this._slicedData.slices.length;i++){s.slices.push({data:this._slicedData.slices[i].data.toJSON(),dimensionMember:this._slicedData.slices[i].dimensionMember});}}}return{sliceDimension:a.toJSON(this.sliceDimension()),slicedData:s,value:this._currentVal};};n.prototype.load=function(v){var s=v.slicedData,h=s&&U.isArray(s.slices)&&s.slices.length>0;this.sliceDimension(a.fromJSON(v.sliceDimension));if(h){s.slices=s.slices.map(function(e){return{dimensionMember:e.dimensionMember,data:sap.viz.api.data.CrosstableDataset.fromJSON(e.data)}});}this._slicedData=s;this._currentVal=h?Math.min(v.value,s.slices.length):0;this._resetControls();this._resetChartFrameDataScale();this._resetChartFixScale();};n.prototype.destroy=function(){this._vizProxy().off("initialized.playcontrol",this._chartUpdateCompleteHandler);n.superclass.destroy.apply(this,arguments);if(this._playBtn){this._playBtn.destroy(true);}if(this._slider){this._slider.destroy(true);}$(".viz-controls-playcontrol-slider #__slider0-grip").unbind('mouseover');};return n;});u('sap/viz/controls/frame/VizFrame',['jquery','sap/viz/controls/common/VizControlHost','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/common/managers/LangManager','sap/viz/controls/frame/VizFrameConfig','sap/viz/controls/frame/VizFrameEvent','sap/viz/controls/annotation/Annotation','sap/viz/controls/annotation/AnnotationEvent','sap/viz/controls/annotationcontrol/AnnotationControl','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/annotationcontrol/AnnotationControlEvent','sap/viz/controls/frame/chartEditor/ChartEditorPlugin','sap/viz/controls/chart/Chart','sap/viz/controls/contextmenu/ContextMenu','sap/viz/controls/contextmenu/ContextMenuEvent','sap/viz/controls/frame/menu/CommentMenuItem','sap/viz/controls/custombutton/CustomButton','sap/viz/controls/custombutton/CustomButtonEvent','sap/viz/controls/filterbar0/FilterBar','sap/viz/controls/filterbar0/FilterBarEvent','sap/viz/controls/frame/views/FilterMenu','sap/viz/controls/frame/views/FilterMenuEvent','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/TitleEditor','sap/viz/controls/playcontrol/PlayControl','sap/viz/controls/playcontrol/PlayControlEvent','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/runtime/VizModel','sap/viz/controls/Version','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/common/utils/Serialization'],function($,V,C,a,E,b,F,c,d,f,O,U,g,k,L,l,m,n,o,p,q,r,s,t,v,x,y,z,D,G,H,I,J,K,T,P,M,R,N,Q,S,W,X,Y,Z,_){var a1=function a1(h,w){a1.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrame";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizframe_control');this._div=h;this._uiConfig=w?w:l.instance();if(this._uiConfig.enablePlayControl){try{jQuery.sap.require('sap.ui.commons.Button');jQuery.sap.require('sap.ui.commons.Slider');}catch(e){throw U.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR_WITH_UI_CONFIG'),'sap.ui.commons','VizFrame','{enablePlayControl: true}');}}this._layout=null;this._filterBar=null;this._chart=null;this._chartEditorPlugin=new s(this._div,this,this._uiConfig);this._contextMenu=null;this._popupLayout=null;this._annotation=null;this._settingBtn=null;this._fullScreenBtn=null;this._titleEditor=null;this._playControl=null;this._createChildren();this._addChild(this._chart,['enableMorphing','feedAnalysisObjects'],[K.CHART_CHANGED,K.CHART_CHANGING,K.VIZTYPE_CHANGED,F.FEEDS_CHANGED]);if(this._filterBar){this._addChild(this._filterBar,['analysisObjectsForPicker'],[E.REQUEST_FILTER_VALUES]);}if(this._annotationControl){this._addChild(this._annotationControl,[r.ANNOTATION_SELECTED_EVENT,r.ANNOTATION_LAYOUTED_EVENT]);}this._addChild(this._annotation,[],[]);if(this._contextMenu&&U.isFunction(this._contextMenu.getEventNames)){this._addChild(this._contextMenu,[],this._contextMenu.getEventNames());}this._addChild(this._fullScreenBtn,[],[m.ENTER_FULL_SCREEN,m.EXIT_FULL_SCREEN]);sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizframe_control');};O.extend(a1,V);a1.HEADER_HEIGHT=40;a1.prototype.vizType=function(e){return this._chart.vizType.apply(this._chart,arguments);};a1.prototype.filterItems=function(e){if(arguments.length>0){this._beginUpdateProperty();if(this._filterBar){this._filterBar.filterItems(e);}this._endUpdateProperty();return this;}else{if(this._filterBar){return this._filterBar.filterItems();}return[];}};a1.prototype.clearSelectedPropertyZone=function(){this._chart.clearSelectedPropertyZone();};a1.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){var h=this._vizModel().filterItems();if(!this._inUpdatingProperty()){this._chart.showLoadingIcon();}this._dispatchPropertyEvent(new m(m.FILTERS_CHANGED,this,h));}if(e.data.sliceDimensionChanged){if(!this._playControl){var w=this._uiConfig.enablePlayControl===false?false:true;if(w){this._createPlayControl();}}}};a1.prototype._commentChangedHandler=function(e){var h={commentChanged:true};this._dispatchEvent(new b(E.VIZ_DEFINITION_CHANGED,this,h));};a1.prototype._vizDefinitionChanged=function(e){this._dispatchEvent(new b(E.VIZ_DEFINITION_CHANGED,this,e.data));};a1.prototype._vizViewChanged=function(e){var h=this._uiConfig.enableTitleEditor===false?false:true;if(h){if(this._titleEditor){this._titleEditor.destroy();this._titleEditor=null;}var w=e.data.type;if(f.supportTitle(w)){this._createTitleEditor();this._titleEditor.connect(this.vizUid());}}};a1.prototype._createChart=function(){this._layout=document.createElement('div');$(this._div).append(this._layout);var h=W.instance();if(this._uiConfig.controls&&this._uiConfig.controls.chart){h=this._uiConfig.controls.chart;}h=$.extend({},h);h.useInfoChart=(this._uiConfig.useInfoChart===true);this._chart=new t(this._layout,h);this._chart.addEventListener(E.VIZ_DEFINITION_CHANGED,this._vizDefinitionChanged,this);this._chart.addEventListener(K.SELECT_PROPERTY_ZONE,$.proxy(function(e){this._dispatchEvent(new K(K.SELECT_PROPERTY_ZONE,this,e.data));},this));this._chart.addEventListener(K.VIZ_VIEW_CHANGED,this._vizViewChanged,this);this._chart.addEventListener(K.CHART_CHANGED,this._chartChangedHandler,this);this._validateSize();this.__vizModel=this._chart.chartModel();this.__vizModel.addEventListener(N.PropertiesChangedEvent,this._onVizModelChanged,this);};a1.prototype._chartChangedHandler=function(){if(this._titleEditor){this._titleEditor.init();}};a1.prototype.popupLayer=function(){return this._popupLayout;};a1.prototype._createPopupLayer=function(){this._popupLayout=document.createElement('div');this._popupLayout.id="popupLayout";$(this._div).append(this._popupLayout);};a1.prototype._createHeader=function(){if(!this._header$){this._header$=$(document.createElement('div')).appendTo(this._div);this._header$.addClass(C.FRAME_PREFIX+"header");}};a1.prototype._createFullScreenButton=function(){var e=Z.instance();if(this._uiConfig.controls&&this._uiConfig.controls.fullScreenButton){e=this._uiConfig.controls.fullScreenButton;}this._fullScreenBtn=new z(this._header$,e);this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-enter-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_MAXIMIZE'));this._fullScreenBtn.addEventListener(D.CLICK_CUSTOM_BUTTON,$.proxy(function(h){this._isFullScreen=!this._isFullScreen;if(this._isFullScreen){this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-exit-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_RESTORE_DOWN'));this._dispatchEvent(new m(m.ENTER_FULL_SCREEN,this,this._isFullScreen));}else{this._fullScreenBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-fullscreen-enter-icon'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_MAXIMIZE'));this._dispatchEvent(new m(m.EXIT_FULL_SCREEN,this,this._isFullScreen));}},this),this);};a1.prototype._createSettingButton=function(){var e=Z.instance();if(this._uiConfig.controls&&this._uiConfig.controls.settingButton){e=this._uiConfig.controls.settingButton;}this._settingBtn=new z(this._header$,e);this._settingBtn.setIcon([C.COMMON_PREFIX+"UVBSharedSprite",C.FRAME_PREFIX+'header-setting-icon'].join(' '));this._settingBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_SETTINGS'));this._settingBtn.addEventListener(D.CLICK_CUSTOM_BUTTON,$.proxy(function(h){var w=34;var b1={pageX:$(this._div).width(),pageY:w};this._contextMenu.show(b1,null);},this),this);};a1.prototype._createFilterBar=function(){this._filterBarContainer$=$(document.createElement('div')).appendTo(this._header$);this._filterBarContainer$.addClass(C.FRAME_PREFIX+'header-filterbar-container');var e=X.instance();if(this._uiConfig.controls&&this._uiConfig.controls.filterBar){e=this._uiConfig.controls.filterBar;}this._filterBar=new G(this._filterBarContainer$,e);this._filterBar.addEventListener(H.HEIGHT_CHANGED,function(h){if(!this._header$){return this;}this._header$.css({'height':h.data.height});this._validateSize(true);},this);};a1.prototype._createContextMenu=function(){var h=Y.instance();if(this._uiConfig.controls&&this._uiConfig.controls.contextMenu){h=this._uiConfig.controls.contextMenu;}this._contextMenu=new v($(this._popupLayout),h);$(this._layout).bind('contextmenu',$.proxy(function(e){var w=U.getEventPosition(e);var b1={pageX:w.pageX-$(this._div).offset().left,pageY:w.pageY-$(this._div).offset().top};var c1=$(this._layout).offset();var d1=this._chart.getZoneName({x:w.pageX-c1.left,y:w.pageY-c1.top,});this._contextMenu.show(b1,d1);return false;},this));};a1.prototype._createFilterMenu=function(){this._filterMenu=new I($(this._popupLayout),this._uiConfig);this._filterMenu.addEventListener(J.FILTER_CLICKED,function(e){this._filterMenu.hide();this._addFilter(false);},this);this._filterMenu.addEventListener(J.EXCLUDE_CLICKED,function(e){this._filterMenu.hide();this._addFilter(true);},this);this._chart.addEventListener(K.CHANGED_SELECTED_DATA,function(e){var h=this.vizSelection();var w=h?h.length:0;var b1=w>0;var c1=w>0;this._filterMenu.show(b1,c1);},this);this.vizOn("initialized.filterMenu",$.proxy(function(e){if(this._filterMenu){var h=this.vizSelection();var w=h?h.length:0;if(w>0){this._filterMenu.show(true,true);}else{this._filterMenu.hide();}}},this));};a1.prototype._createPlayControl=function(){var h=document.createElement('div');this._playControlContainer$=$(h);$(h).css({"position":"relative"});$(this._div).append(h);this._playControl=new P($(h));this._validateSize();this._playControl.addEventListener(M.SLICE_DIMENSION_CHANGED,$.proxy(function(e){var w=this._playControl.sliceDimension();this._playControl.visible(!!w);this._validateSize();this._dispatchPropertyEvent(new m(m.SLICE_DIMENSION_CHANGED,this,w));},this));this.vizOn("initialized.playControl",$.proxy(function(e){this._validatePlayControlSize();},this));this._playControl.connect(this.vizUid());};a1.prototype._validatePlayControlSize=function(){var e=this.vizFeedingZone();var h;for(var i=0;i<e.length;i++){var w=e[i];if(w.name==='plot'){h=w.bound[0];break;}}if(h&&h.length>0){var b1=h[1][0]-h[0][0];var c1=h[0][0];$(this._playControlContainer$).css({"width":b1,'left':c1});this._playControl.validateSize(b1);}};a1.prototype._addFilter=function(e){if(this._filterBar){var h=this.vizSelection({'withDataCtx':true});this._vizModel().updateFilterItems(h,e,this.vizData(),this._chart.feeding());}else{var w={"isExclude":e,"feeding":this._chart.feeding()};this._dispatchEvent(new m(m.ADD_FILTER,this,w));}};a1.prototype._createTitleEditor=function(){this._titleEditorContainer$=$(this._layout).find("."+C.CHART_PREFIX+"holder");$(this._titleEditorContainer$).css({position:'absolute',width:'100%'});this._titleEditor=new T(this._titleEditorContainer$);this.vizOn("initialized.titleEditor",$.proxy(function(e){if(this._titleEditor){this._titleEditor.init();}},this));};a1.prototype._createAnnotation=function(){var h=S.instance();if(this._uiConfig.controls&&this._uiConfig.controls.annotation){h=this._uiConfig.controls.annotation;}this._annotation=new n(this._div,h);this._annotation.popupLayer(this._popupLayout);if(this._contextMenu){var w=new y($.proxy(this._vizModel,this),this._chart.__vizProxy);w.clickHandler($.proxy(function(){this._dispatchEvent(new m(m.ADD_COMMENT,this));},this));this._contextMenu.addMenuItem(w);}this.addEventListener(K.CHART_CHANGED,$.proxy(function(e){if(this._annotation){this._annotation.setChartInfo({'vizType':this._chart.vizType(),'vizData':this._chart.vizData()});var b1=this._chart.size();this._annotation.validateSize(b1.width,b1.height);}},this));this.addEventListener(K.CHART_CHANGING,$.proxy(function(e){if(this._annotation){this._annotation.clean();}},this));this.addEventListener(F.FEEDS_CHANGED,$.proxy(function(e){if(this._annotation){this._annotation.feedsChanged();}},this));this.addEventListener(m.ADD_COMMENT,$.proxy(function(e){if(this._annotation){this._annotation.addComment(this.vizSelection({'withDataCtx':true}));}},this));this.vizOn("initialized.annotation",$.proxy(function(e){if(this._annotation){this._annotation.redraw();}},this));};a1.prototype._createAnnotationControl=function(){var e=null;if(this._uiConfig.controls&&this._uiConfig.controls.annotationControl){e=this._uiConfig.controls.annotationControl;}else{e=q.instance();}var h=$(document.createElement('div')).insertBefore(this._popupLayout);this._annotationControl=new p(h[0],e);if(this._contextMenu){var w=new y($.proxy(this._vizModel,this),this._chart.__vizProxy);w.clickHandler($.proxy(function(){var b1=this.vizSelection({'withDataCtx':true});this._dispatchEvent(new m(m.ADD_COMMENT,this,{context:b1[0]}));},this));this._contextMenu.addMenuItem(w);}};a1.prototype._createChildren=function(){var e=this._uiConfig.enableFilterBar===false?false:true;var h=this._uiConfig.enableFullScreenButton===false?false:true;var w=this._uiConfig.enableSettingButton===false?false:true;if(e||h||w){this._createHeader();}if(e){this._createFilterBar();}if(h){this._createFullScreenButton();}if(w){this._createSettingButton();}this._createChart();this._createPopupLayer();var b1=this._uiConfig.enableContextMenu===false?false:true;if(b1){this._createContextMenu();}var c1=this._uiConfig.enableAnnotation===false?false:true;if(c1){this._createAnnotation();}if(this._uiConfig.enableAnnotationControl===true){this._createAnnotationControl();}var d1=this._uiConfig.enableFilterMenu===false?false:true;if(d1){this._createFilterMenu();}var e1=this._uiConfig.enableTitleEditor===false?false:true;if(e1){this._createTitleEditor();}if(this._filterBar){this._filterBar.connect(this.vizUid());}if(this._contextMenu){this._contextMenu.connect(this.vizUid());}if(this._titleEditor){this._titleEditor.connect(this.vizUid());}if(this._annotation){this._annotation.connect(this.vizUid());}if(this._annotationControl){this._annotationControl.connect(this.vizUid());}};a1.prototype._validateSize=function(e){var w=$(this._div).width();var h=$(this._div).height();if(this._header$&&this._header$.css('display')!='none'&&!isNaN(this._header$.outerHeight())){if(this._filterBar&&!(e===true)){this._filterBar.validateSize();}h-=this._header$.outerHeight();}if(this._playControl&&this._playControlContainer$.css('visibility')==='visible'&&!isNaN(this._playControlContainer$.outerHeight())){h-=this._playControlContainer$.outerHeight();}$(this._layout).css({width:w+"px",height:h+"px",visibility:"visible",display:''});if(this._chart){this._chart.size({width:w,height:h});}if(this._annotation){this._annotation.validateSize(w,h);}if(this._chartEditorPlugin){this._chartEditorPlugin.validateSize(w,h);}if(this._filterMenu){this._filterMenu.size({width:w});}if(this._playControl){this._validatePlayControlSize();}if(this._titleEditor){this._titleEditor.size();}};a1.prototype._chartControl=function(){return this._chart;};a1.prototype.connect=function(e){};a1.prototype.disconnect=function(){};a1.prototype.destroy=function(){if(this._contextMenu){this._contextMenu.removeAllEventListeners();this._contextMenu.destroy();this._contextMenu=null;}if(this._filterMenu){this._filterMenu.removeAllEventListeners();this._filterMenu.destroy();this._filterMenu=null;}if(this._chartEditorPlugin){this._chartEditorPlugin.destroy();this._chartEditorPlugin=null;}if(this._annotation){this._annotation.destroy();this._annotation=null;}if(this._playControl){this._playControl.destroy();this._playControl=null;}a1.superclass.destroy.apply(this,arguments);this._chart=null;this._filterBar=null;};a1.prototype.vizUid=function(){return this._chart.vizUid();};a1.prototype.vizData=function(e){return this._chart.vizData.apply(this._chart,arguments);};a1.prototype.vizCss=function(e){return this._chart.vizCss.apply(this._chart,arguments);};a1.prototype.vizProperties=function(e){return this._chart.vizProperties.apply(this._chart,arguments);};a1.prototype.vizDescription=function(){return this._chart.vizDescription.apply(this._chart,arguments);};a1.prototype.vizUpdate=function(e){if(!e){return;}this._beginUpdateProperty();try{if(e.filters&&this._filterBar){var h=e.filters.value?e.filters.value:e.filters;this._filterBar.filterItems(h);}var w=this._chart.vizUpdate.apply(this._chart,arguments);}catch(b1){this._endUpdateProperty();throw b1;}this._endUpdateProperty();return w;};a1.prototype.vizOn=function(e,h){this._chart.vizOn.apply(this._chart,arguments);return this;};a1.prototype.vizOff=function(e){this._chart.vizOff.apply(this._chart,arguments);return this;};a1.prototype.vizAction=function(e,h){this._chart.vizAction.apply(this._chart,arguments);return this;};a1.prototype.vizSelection=function(e,h){return this._chart.vizSelection.apply(this._chart,arguments);};a1.prototype.vizFeedingZone=function(){return this._chart.vizFeedingZone.apply(this._chart,arguments);};a1.prototype.vizTitle=function(e){return this._chart.vizTitle.apply(this._chart,arguments);};a1.prototype.createViz=function(e){if(arguments.length>0){this._chart.createViz(e);return this;}};a1.prototype.changeTemplate=function(){return this._chart.changeTemplate.apply(this._chart);};a1.prototype.exportViz=function(e){return this._chart.exportViz(e);};a1.prototype.loadViz=function(e){this._chart.loadViz(e);};a1.prototype.save=function(e){var h={};h['version']=Q.VERSION;h["chart"]=this._chart.save(e);if(this._filterBar){h["filterBar"]=this._filterBar.save();}if(this._contextMenu){h["contextMenu"]=this._contextMenu.save();}if(this._annotation){h["annotation"]=this._annotation.save();}if(this._titleEditor){h['titleEditor']=this._titleEditor.save();}if(this._playControl){h['playControl']=this._playControl.save(e);}return h;};a1.prototype.load=function(e){this._beginUpdateProperty();var h=_.migrateVizFrame(e);this._vizModel().playerField(null);var w=h['version'];w=h["filterBar"];if(w&&this._filterBar){this._filterBar.load(w);}w=h["contextMenu"];if(w&&this._contextMenu){this._contextMenu.load(w);}w=h["chart"];if(w){this._chart.load(w);}w=h["annotation"];if(w&&this._annotation){this._annotation.load(w);}w=h["titleEditor"];if(w&&this._titleEditor){this._titleEditor.load(w);}w=h["playControl"];if(w){if(!this._playControl){var b1=this._uiConfig.enablePlayControl===false?false:true;if(b1){this._createPlayControl();}}if(this._playControl){this._playControl.load(w);}}this._endUpdateProperty();};a1.prototype.feeds=function(e){return this._chart.feeds.apply(this._chart,arguments);};a1.prototype.getDefaultIncompleteOptions=function(e){return this._chart.getDefaultIncompleteOptions.apply(this._chart,arguments);};a1.prototype.showMessage=function(e){if(arguments.length==1){this._chart.showMessage(e);}};a1.prototype.setTitleGeneratorFunc=function(e){this._chart.setTitleGeneratorFunc(e);};a1.prototype.vizTitleMode=function(e){if(arguments.length>0){this._chart.vizTitleMode(e);}else{return this._chart.vizTitleMode();}};a1.prototype.annotationControl=function(){return this._annotationControl;};a1.prototype.chart=function(){return this._chart;};a1.prototype.filterBar=function(){return this._filterBar;};a1.prototype.contextMenu=function(){return this._contextMenu;};a1.prototype.titleEditor=function(){return this._titleEditor;};a1.prototype.playControl=function(){return this._playControl;};a1.prototype.exportToSVGString=function(e){return this._chart.exportToSVGString(e);};a1.prototype.supportExportToSVG=function(){var e=false;if(this.vizType()){e=f.isBuildInType(this.vizType())||e;}return e;};a1.prototype.selectedPropertyZone=function(e){return this._chart.selectedPropertyZone.apply(this._chart,arguments);};return a1;});u('sap/viz/controls/filterbar/FilterBarConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var F={};F.instance=function(){return{"maxLines":2,"enableDrop":true,"showInformationIcon":false,"showClearIcon":false,"addButtonVisible":true,"informationIconTooltip":''};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_FILTERBAR,F);return F;});u('sap/viz/controls/filterbar/FilterBarEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar.FilterBarEvent";};O.extend(F,E);F.REQUEST_ADD_FILTER="requestAddFilter";F.REQUEST_REMOVE_FILTER="requestRemoveFilter";F.REQUEST_EDIT_FILTER="requestEditFilter";F.SIZE_CHANGED="sizeChanged";F.CLEAR_FILTERS="clearFilters";return F;});u('sap/viz/controls/filterbar/FilterItem',['sap/viz/controls/common/utils/Utils'],function(U){var F=function(a,d,b,c,e,v,f,g){this.__className="sap.viz.controls.filterbar.FilterItem";this._id=a;this._displayName=d;this._displayValue=b;this._customData=c;this._cssClass=e;this._valueCssClass=v;this._disableRemoval=U.isBoolean(f)?f:false;this._valueCount=U.isNumber(g)?g:0;};U.genGetterSetters(F.prototype,["_id","_displayName","_valueCount","_disableRemoval","_cssClass","_customData","_valueCssClass","_displayValue"]);return F;});u('sap/viz/controls/filterbar/FilterRenderer',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/filterbar/FilterBarEvent'],function($,O,E,C,L,F){var a=function(f,d,s,b){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar.FilterRenderer";this._filterItem=f;this._showInformationIcon=s;this._informationIconTooltip=b;this._div$=$(d);this._draw();};O.extend(a,E);a.prototype.filterItem=function(v){if(arguments.length>0){this._filterItem=v;this._reset();this._draw();}else{return this._filterItem;}};a.prototype.destroy=function(){this._div$.empty();};a.prototype._draw=function(){var f=this._filterItem;var _=this;this._createFilterTitle(f,this._div$);this._addFilterValues(f,this._div$);this._div$.attr({'id':f.id()});this._div$.mouseover(function(e){$('.'+C.FILTERBAR_PREFIX+'filter-values',e.currentTarget).addClass(C.FILTERBAR_PREFIX+'filter-values-active');});this._div$.mouseout(function(e){$('.'+C.FILTERBAR_PREFIX+'filter-values',e.currentTarget).removeClass(C.FILTERBAR_PREFIX+'filter-values-active');});if(f.cssClass()){this._div$.addClass(f.cssClass());}this._div$.addClass(C.FILTERBAR_PREFIX+'filter-item');if(f.disableRemoval()){this._div$.addClass(C.FILTERBAR_PREFIX+'filter-item-readonly');if(this._showInformationIcon){var b=$(document.createElement('div')).appendTo(this._div$);b.attr("title",this._informationIconTooltip||L.get("VIZ_FILTERBAR_READONLY_FILTER"));b.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');b.addClass(C.FILTERBAR_PREFIX+'info-icon');}}else{this._div$.click(function(){_._dispatchEvent(new F(F.REQUEST_EDIT_FILTER,_,{"filterItem":_._filterItem}));});var d=$(document.createElement('div')).appendTo(this._div$);d.addClass(C.FILTERBAR_PREFIX+'delete-icon');d.addClass(C.COMMON_PREFIX+'UVBSharedSprite');d.click(function(e){_._dispatchEvent(new F(F.REQUEST_REMOVE_FILTER,_,{"filterItem":_._filterItem}));e.stopPropagation();});}};a.prototype._createFilterTitle=function(f,b){if(f.valueCount()<=0){var c=$(document.createElement('span')).appendTo(b).text(f.displayName()).attr("title",f.displayName());c.addClass(C.FILTERBAR_PREFIX+'filter-item-text');c.addClass(C.FILTERBAR_PREFIX+'range-filter-item-text');return;}var t=$(document.createElement('div')).appendTo(b);var n=$(document.createElement('div')).appendTo(t).text(f.displayName()).attr("title",f.displayName()).css("display",'inline');n.addClass(C.FILTERBAR_PREFIX+'filter-item-text').attr('id','filterName');var d=$(document.createElement('div')).appendTo(t).css("display",'inline').attr('id','countInfo');d.addClass(C.FILTERBAR_PREFIX+'filter-item-info');$(document.createElement('span')).appendTo(d).text('(');var e=$(document.createElement('span')).appendTo(d).text(f.valueCount());if(f.valueCssClass()){e.addClass(f.valueCssClass());}$(document.createElement('span')).appendTo(d).text(')');};a.prototype._addFilterValues=function(f,b){var c=b.find("span[id='values']");if(c.length===0){c=$(document.createElement('span')).appendTo(b);c.addClass(C.FILTERBAR_PREFIX+'filter-values');c.attr({id:'values'});}var d=f.displayValue();c.text(d).attr("title",d);if(f.valueCssClass()){c.addClass(f.valueCssClass());}};return a;});u('sap/viz/controls/filterbar/FilterBar',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/filterbar/FilterBarConfig','sap/viz/controls/filterbar/FilterBarEvent','sap/viz/controls/filterbar/FilterItem','sap/viz/controls/filterbar/FilterRenderer'],function($,V,C,E,a,D,L,O,U,b,c,d,F,f,g,h,R,k,l,m,n){var o=function(e,s){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar.FilterBar";sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control');this._div=e;this._uiConfig=s?s:k.instance();this._filterItems=[];this._renderers=[];this._allAnalyses=null;this._settings=null;this._visualLines=1;if(U.isNumber(this._uiConfig.maxLines)&&this._uiConfig.maxLines>1){this._visualLines=this._uiConfig.maxLines;}this._description$=null;this._layout$=null;this._headerVisible=false;this._isFullScreen=false;this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_filterbar_control');};var p=0.8;var q=40;var r=180;O.extend(o,V);o.TYPE_STRING='string';o.TYPE_INTEGER='integer';o.TYPE_NUMBER='number';o.TYPE_DATE='date';var I=16;o.prototype.filterItems=function(e){if(arguments.length>0){this._filterItems=e;this._filtersChanged();return this;}else{return this._filterItems;}};o.prototype._createChildren=function(){var _=this;var s=this._uiConfig;if(!s||s.addButtonVisible!==false){this._headerVisible=true;this._plus$=$(document.createElement("div")).appendTo(this._div);this._plus$.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');this._plus$.addClass(C.FILTERBAR_PREFIX+'header-plus');this._plus$.click(function(e){_._plusClickHandler(e);});var t=s.label?s.label:L.get('VIZ_FILTERBAR_ADD_FILTERS');this._description$=$(document.createElement("span")).text(t).appendTo(this._div);this._description$.addClass(C.FILTERBAR_PREFIX+"description");}var v=0;if(s&&s.showClearIcon){this._clearIcon$=$(document.createElement("div"));this._clearIcon$.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');this._clearIcon$.addClass(C.FILTERBAR_PREFIX+'clear-disabled');this._clearIcon$.attr({"title":L.get('VIZ_FILTERBAR_CLEAR_FILTERS')});this._clearIcon$.appendTo(this._div);v=24;}this._layout$=$(document.createElement('div')).appendTo(this._div);this._layout$.addClass(C.FILTERBAR_PREFIX+'layout');this._layout$.addClass(C.COMMON_PREFIX+'scrollable');this._layout$.addClass(C.COMMON_PREFIX+'scrollable-y');this._layout$.css({'max-height':this._visualLines*q,'right':v});this._filterItemsContainer$=$(document.createElement('div')).appendTo(this._layout$);this._filterItemsContainer$.addClass(C.FILTERBAR_PREFIX+'filterItems-container');if(this._headerVisible===true){this._layout$.hide();}else{this._layout$.css({'left':'0px'});}if(!s||s.enableDrop!==false){$(this._div).droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,over:$.proxy(this._dragOver,this),out:$.proxy(this._dragOut,this),drop:$.proxy(this._drop,this)});}};o.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){if(e!=null&&!b.isArrayOfAnalysisObject(e)){return;}this._allAnalyses=e;}else{return this._allAnalyses;}};o.prototype._plusClickHandler=function(e){var s=document.createElement('div');var t=this._filterItems;if(this._filterItemsFilter){t=this._filterItemsFilter(this._filterItems);}var v=new F(s,this._allAnalyses,h.DIMENSION,t);v.addEventListener(f.ITEM_SELECTED,function(x){var y=x.data.selectedItem;if(y){this._addFilterItem(y);}},this);var w=this._plus$.offset();v.open({x:w.left,y:w.top,shelfWidth:this._plus$.width()});};o.prototype.setfilterItemsFilter=function(e){this._filterItemsFilter=e;};o.prototype._isExist=function(e){var s=e.id();if(e.type()===g.HIERARCHY){s=e.selectedHierarchyLevel().analysis().id();}for(var i=0;i<this._filterItems.length;++i){if(this._filterItems[i].id()===s){return true;}}return false;};o.prototype._getDroppableAnalysisObject=function(t){if(!t||!t.analysisObject){return null;}var e=t.analysisObject;var s=e.type();if(g.compatible(g.DIMENSION,s)&&s!==g.MND&&!this._isExist(e)&&!e.aggregationType()){return e;}else{return null;}};o.prototype._dragOver=function(e,s){var t=D.instance().getAnalysisToken(s.helper);if(!t){return;}var v=this._getDroppableAnalysisObject(t);if(v){t.currentAction(d.ACCEPT_AS_COPY);}else{t.currentAction(d.DENY);}};o.prototype._dragOut=function(e,s){var t=D.instance().getAnalysisToken(s.helper);if(t){t.currentAction(d.DENY);}};o.prototype._drop=function(e,s){var t=D.instance().getAnalysisToken(s.helper);if(!t){return;}var v=this._getDroppableAnalysisObject(t);if(v){t.currentAction(d.ACCEPT_AS_COPY);this._addFilterItem(v);}else{t.currentAction(d.DENY);}t.dropTarget(this._dom);};o.prototype._addFilterItem=function(e){this._dispatchEvent(new l(l.REQUEST_ADD_FILTER,this,{"analysisObject":e}));};o.prototype._updateClearIcon=function(){if(!this._clearIcon$){return;}var s=this._filterItems;var t=false;if(s){for(var i=0;i<s.length;i++){if(!s[i].disableRemoval()){t=true;break;}}}var _=this;this._clearIcon$.unbind("click");if(t){this._clearIcon$.addClass(C.FILTERBAR_PREFIX+'clear');this._clearIcon$.removeClass(C.FILTERBAR_PREFIX+'clear-disabled');this._clearIcon$.click(function(e){_._dispatchEvent(new l(l.CLEAR_FILTERS,_,null));});}else{this._clearIcon$.addClass(C.FILTERBAR_PREFIX+'clear-disabled');this._clearIcon$.removeClass(C.FILTERBAR_PREFIX+'clear');}};o.prototype._filtersChanged=function(){if(this._filterItemsContainer$){this._filterItemsContainer$.empty();}this._updateClearIcon();var e=this._filterItems;if(!e||e.length==0){this._updateDescription();this._updateFilterItemContainer();return this;}if(this._headerVisible===true){this._description$.hide();this._layout$.show();}this._updateFilterItemContainer();};o.prototype._stringToNumber=function(v){if(!v){return 0;}return parseInt(v.replace('px',''));};o.prototype._validateSize=function(){var e=$('.'+C.FILTERBAR_PREFIX+'filter-item');if(e.length==0){return this;}e.css({'width':r});this._updateFilterItemsWidth();};o.prototype._needAdjust=function(){var e=this._filterItemsContainer$.innerHeight();var s=e>q;if(s){return true;}else{return false;}};o.prototype._updateFilterItemContainer=function(){var e=this._filterItems;var i;for(i=0;i<this._renderers.length;i++){this._renderers[i].destroy();}for(i=0;i<e.length;i++){var s=$(document.createElement('div')).appendTo(this._filterItemsContainer$);this._renderers[i]=new n(e[i],s,this._uiConfig.showInformationIcon,this._uiConfig.informationIconTooltip);this._renderers[i].addEventListener(l.REQUEST_REMOVE_FILTER,this._dispatchFilterEvent,this);this._renderers[i].addEventListener(l.REQUEST_EDIT_FILTER,this._dispatchFilterEvent,this);}this._updateFilterItemsWidth();return this;};o.prototype._dispatchFilterEvent=function(e){this._dispatchEvent(e);};o.prototype._updateFiltersTitle=function(){var e=function(s,t){var v=$('#filterName',t);if(v.length===0){return;}v.css({'width':'auto'});var w=v.parent();var x=$('#countInfo',t);var y=v.position();var z=v.width()+y.left+2;var G=w.width()-I;var H=x.width();var J=Math.min(z,G-H);v.css({'width':J-y.left});x.css({'left':J});};$('.'+C.FILTERBAR_PREFIX+'filter-item',this._div).each(e);$('.'+C.FILTERBAR_PREFIX+'global-filter-item',this._div).each(e);};o.prototype._updateFilterItemsWidth=function(){var e;if(this._filterItemsContainer$.children().length===0){this._updateDescription();var s=this._filterItemsContainer$.innerHeight();if(s!==q){e={'height':q};this._dispatchEvent(new l(l.SIZE_CHANGED,this,e));}return this;}if(!this._needAdjust()){e={'height':q};this._dispatchEvent(new l(l.SIZE_CHANGED,this,e));this._updateFiltersTitle();return this;}var t=0;var v=r;var w=this._filterItemsContainer$.children();while(this._needAdjust()&&t<2){t++;v=v*p;w.css({'width':v});}if(this._needAdjust()){e={'height':this._avaliableHeightForHeader()};this._dispatchEvent(new l(l.SIZE_CHANGED,this,e));if(e.height<this._filterItemsContainer$.outerHeight()){$(this._layout$).scrollTop(this._filterItemsContainer$.outerHeight());}}if(!this._needAdjust()){e={'height':q};this._dispatchEvent(new l(l.SIZE_CHANGED,this,e));};this._updateFiltersTitle();return this;};o.prototype._avaliableHeightForHeader=function(){var e=this._filterItemsContainer$.outerHeight();var s=q-2;var t=q;var v=this._visualLines-1;for(var i=2;i<=this._visualLines;i++){if(s*i<=e&&e<=t*i){v=i-1;break;}}var w=2;return v*s+t+w;};o.prototype._updateDescription=function(){var e=this._vizModel().filterItems();if(e.length===0&&this._headerVisible===true){this._description$.show();this._layout$.hide();}};return o;});u('sap/viz/controls/propertyeditor/PropertyEditorConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var P={};P.instance=function(a){return{'icons':[{'id':'bus','svg':'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" viewBox="0 0 309 293" enable-background="new 0 0 309 293" xml:space="preserve">'+'<path d="M195.781,200.678v5.801h72.909V5.316H42.312v201.163h72.899v-5.801H195.781z M221.002,176.428'+'c-11.501,0-20.826-9.325-20.826-20.809c0-11.518,9.325-20.826,20.826-20.826s20.834,9.309,20.834,20.826'+'C241.836,167.103,232.503,176.428,221.002,176.428z M159.738,27.415h95.483v57.129h-95.483V27.415z M55.785,27.415h95.475'+'v57.129H55.785V27.415z M92.741,174.805c-11.518,0-20.83-9.326-20.83-20.827s9.312-20.817,20.83-20.817'+'c11.476,0,20.81,9.316,20.81,20.817S104.217,174.805,92.741,174.805z"/>'+'<polygon points="195.781,218.038 195.781,225.137 115.212,225.137 115.212,218.038 29.091,218.038'+'29.091,243.811 281.89,243.811 281.89,218.038"/>'+'<rect x="115.212" y="206.479" width="80.569" height="11.56"/>'+'<rect x="42.312" y="243.811" width="36.434" height="33.843"/>'+'<rect x="232.244" y="243.811" width="36.446" height="33.843"/>'+'<rect x="274.7" y="55.975" width="30.301" height="56.292"/>'+'<rect x="5.001" y="55.975" width="30.297" height="56.292"/></svg>'},{'id':'plane','svg':'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" viewBox="0 0 424.876 469.719" enable-background="new 0 0 424.876 469.719" xml:space="preserve">'+'<path d="M211.131,4.251c6.051-0.543,12.363,5.176,19.721,25.602c7.393,20.47,7.188,41.583,7.193,42.477v70.454'+'l36.368,33.614l0.03-5.229c0.03-3.354,1.335-7.684,3.661-10.167c0.616-0.656,1.469-0.897,2.385-0.9h14.942'+'c0.9,0.001,1.771,0.234,2.376,0.9c2.287,2.519,3.55,6.806,3.512,10.167v28.655l30.799,27.212l0.027-2.894'+'c0.012-3.364,1.316-6.443,3.651-8.926c0.622-0.658,1.479-1.065,2.376-1.06h14.954c0.886,0.006,1.763,0.398,2.358,1.06'+'c2.305,2.513,3.367,5.757,3.347,9.113v26.129l61.135,51.113c0.694,0.614,0.915,1.506,0.909,2.445v25.433'+'c-0.012,1.152-0.625,2.225-1.64,2.775c-1.009,0.568-2.245,0.568-3.245-0.024l-122.26-70.578l-55.687-17.585v104.766'+'c-0.117,15.592-2.816,25.786-2.931,26.218l-4.263,15.474l58.095,53.767c0.635,0.613,1.291,1.454,1.281,2.355v15.894'+'c-0.009,0.993-0.47,1.939-1.281,2.544c-0.793,0.61-1.816,0.805-2.783,0.557l-67.872-17.462l-0.876,4.971'+'c-0.165,0.844-0.656,1.672-1.275,1.994c-0.773,0.402-1.4,0.635-2.25,0.432l-2.759-0.504l-2.81,0.504'+'c-0.86,0.194-1.442,0.059-2.163-0.432c-0.721-0.482-1.233-1.147-1.401-1.994l-0.801-4.971l-67.659,17.462'+'c-0.979,0.258-1.997,0.051-2.805-0.557c-0.775-0.626-1.22-1.541-1.218-2.544v-15.894c0.003-0.91,0.564-1.739,1.218-2.355'+'l58.184-53.767l-4.077-15.474c-0.064-0.258-2.64-10.63-2.516-26.218V244.037l-57.453,17.585L7.249,332.2'+'c-1.01,0.587-2.236,0.614-3.245,0.024c-0.994-0.565-1.607-1.614-1.595-2.775v-25.433c0.014-0.949,0.607-1.828,1.307-2.445'+'l58.987-51.113v-28.236c0.024-3.369,1.505-4.519,3.834-7.005c0.618-0.654,1.476-1.068,2.384-1.06H83.87'+'c0.915,0.008,1.76,0.382,2.374,1.06c2.279,2.505,3.527,3.822,3.499,7.206l-0.015,4.614l31.402-27.212l0.207-28.655'+'c0.014-3.354,1.308-7.661,3.64-10.167c0.618-0.643,1.489-0.911,2.376-0.9h14.958c0.901,0.009,1.76,0.237,2.363,0.9'+'c2.302,2.516,3.544,6.808,3.513,10.167l-0.033,5.229l36.929-33.614V71.981c0,0-1.081-22.023,6.593-42.388'+'C199.329,9.287,205.091,3.617,211.131,4.251z"/></svg>'}],'enableTitle':false};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_PROPERTYEDITOR,P);return P;});u('sap/viz/controls/propertyeditor/helpers/CSSHelper',['jquery'],function($){var C={};C.FontCSSProperties=["font-family","font-size","font-weight","fill","font-style"];C.FontProperties=["fontFamily","fontSize","fontWeight","fontColor","fontStyle"];C.cssTofont=function(c){var f={};for(var i=0;i<C.FontCSSProperties.length;++i){f[C.FontProperties[i]]=c[C.FontCSSProperties[i]];}return f;};C.fontToCss=function(f){var c="{";for(var i=0;i<C.FontCSSProperties.length;++i){if(f.hasOwnProperty(C.FontProperties[i])){c+=C.FontCSSProperties[i]+":"+f[C.FontProperties[i]]+";";}}c+="}";return c;};return C;});u('sap/viz/controls/propertyeditor/helpers/VizPropertiesHelper',['sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/propertyeditor/helpers/CSSHelper'],function(L,C,a){var V={};V.Type_Boolean="boolean";V.Type_Font="font";V.Type_Separator="separator";V.Text_Alignment="alignment";V.Text_Format="format";function c(t,p,n,o){var r={path:p,type:V.Type_Boolean,text:t,children:[{path:p,cssClass:n,cssProperties:a.FontCSSProperties,type:V.Type_Font}]};if(o){r.children.push({path:o,type:V.Text_Alignment});}return r;}function b(t,p){return{path:p,text:t,type:V.Type_Separator};}function d(n,r,t,o){var p=n.toUpperCase();t=t||"PROPERTY_EDITOR_"+p;o=o||".v-m-root .v-m-main .v-m-"+n;r.push(b(t,n+".visible"));r.push({path:n+".visible",type:V.Type_Boolean,text:"PROPERTY_EDITOR_SHOW_AXIS",children:[c("PROPERTY_EDITOR_SHOW_AXIS_TITLE",n+".title.visible",o+" .v-title"),c("PROPERTY_EDITOR_SHOW_AXIS_LABEL",n+".label.visible",o+" .v-label")]});}function e(p,n){p.push(b("PROPERTY_EDITOR_GENERAL","title.visible"));p.push(c("PROPERTY_EDITOR_SHOW_CHART_TITLE","title.visible",[".v-m-root .v-m-title .v-title",".v-m-root .v-m-Title .v-title"]));p.push(c("PROPERTY_EDITOR_SHOW_LEGEND",["legend.visible","sizeLegend.visible"],[".v-m-root .v-m-legends .v-m-legend .v-label",".v-m-root .v-m-legends .v-m-sizeLegend .v-label",".v-m-root .v-m-ColorLegend .v-label"]));p.push(c("PROPERTY_EDITOR_SHOW_DATA_LABEL","dataLabel.visible",n));}var f=null;function g(){if(!f){f=[];e(f,".v-m-root .v-m-main .v-m-datalabel .v-datalabel");d("xAxis",f);d("xAxis2",f);d("yAxis",f);d("yAxis2",f);d("zAxis",f);d("plotArea.valueAxis",f,"PROPERTY_EDITOR_VALUE_AXIS",".v-m-root .v-m-main .v-m-plot");f.push(b("PROPERTY_EDITOR_POLAR_AXIS","plotArea.polarAxis.title.visible"));f.push(c("PROPERTY_EDITOR_SHOW_AXIS_TITLE","plotArea.polarAxis.title.visible",".v-m-root .v-m-main .v-m-plot .v-polar-axis-title"));}return f;}var m=null;function h(){if(!m){m=[];e(m,".v-m-root .v-m-main .v-m-plot .v-m-datalabel .v-datalabel");d("rowAxis",m,"PROPERTY_EDITOR_ROW_AXIS",".v-m-root>.v-m-main>.v-m-yAxis");d("columnAxis",m,"PROPERTY_EDITOR_COLUMN_AXIS",".v-m-root>.v-m-main>.v-m-xAxis2");d("xAxis",m,null,".v-m-root .v-m-main .v-m-plot .v-m-xAxis");d("xAxis2",m,null,".v-m-root .v-m-main .v-m-plot .v-m-xAxis2");d("yAxis",m,null,".v-m-root .v-m-main .v-m-plot .v-m-yAxis");d("yAxis2",m,null,".v-m-root .v-m-main .v-m-plot .v-m-yAxis2");d("plotArea.valueAxis",m,"PROPERTY_EDITOR_VALUE_AXIS",".v-m-root .v-m-main .v-m-plot .v-m-plot");m.push(b("PROPERTY_EDITOR_POLAR_AXIS","plotArea.polarAxis.title.visible"));m.push(c("PROPERTY_EDITOR_SHOW_AXIS_TITLE","plotArea.polarAxis.title.visible",".v-m-root .v-m-main .v-m-plot .v-m-plot .v-polar-axis-title"));}return m;}var _={};V.register=function(v,p){if(v&&p){_[v]=p;}};V.getProperties=function(v){if(_.hasOwnProperty(v)){return _[v]();}else if(C.isMultipleChart(v)){return h();}else{return g();}};var k={};k[V.Type_Font]=a.fontToCss;V.toCSSValue=function(n,v){if(v==null){return v;}if(k.hasOwnProperty(n)){return k[n](v);}else{return v;}};var F={};F[V.Type_Font]=a.cssTofont;V.fromCSSValue=function(n,v){if(v==null){return v;}if(F.hasOwnProperty(n)){return F[n](v);}else{return v;}};var N=null;function l(){if(!N){N=[];N.push({path:"plotArea.valuePoint.label",text:"NUMBERCHART_VALUE_NAME",type:V.Type_Separator});N.push({path:"plotArea.valuePoint.label",type:V.Type_Font});N.push({path:"plotArea.valuePoint.label.formatString",type:V.Text_Format});N.push(b("NUMBERCHART_TITLE_NAME","title.visible"));var t=c("NUMBERCHART_SHOW_TITLE","title.visible",".v-m-root .v-m-title .v-title","title.alignment");t.children.push({path:"title.layout.position",text:'PROPERTY_EDITOR_TITLE_POSITION',type:"list",items:[{key:"top",value:L.get('PROPERTY_EDITOR_TITLE_POSITION_TOP')},{key:"bottom",value:L.get('PROPERTY_EDITOR_TITLE_POSITION_BOTTOM')}]});N.push(t);}return N;};V.register('viz/number',l);return V;});u('sap/viz/controls/propertyeditor/sections/PropertyViewFactory',[],function(){var P={};P.produce=function(s,d,a,v,p){return new s.viewClass(d,a,v,p);};return P;});u('sap/viz/controls/propertyeditor/pickers/PickerEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var P=function(t,a,d){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.PickerEvent";};O.extend(P,E);P.PICKED_ITEM_CHANGED='pickedItemChanged';P.STATUS_CHANGED="statusChanged";return P;});u('sap/viz/controls/propertyeditor/pickers/PickerBase',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(O,U,P){var a=function(d,p,c){a.superclass.constructor.apply(this,arguments);this._pickedItem=p;this._config=c;};O.extend(a,U);a.prototype.pickedItem=function(v){if(arguments.length>0){this._pickedItem=v;return this;}else{return this._pickedItem;}};a.prototype.visible=function(v){if(arguments.length>0){this._dom$.css("display",v?"":"none");this._onStatusChanged();return this;}else{return this._dom$.css("display")!=="none";}};a.prototype._onStatusChanged=function(){this._dispatchEvent(new P(P.STATUS_CHANGED,this,{}));};a.prototype._changePickedItem=function(v,c){if(v!==undefined){this._pickedItem=v;}this._dispatchEvent(new P(P.PICKED_ITEM_CHANGED,this,{'pickedItem':this._pickedItem,'changedItem':c}));};return a;});u('sap/viz/controls/propertyeditor/pickers/SectionPicker',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/pickers/PickerBase'],function(O,P){var S=function(d,p,c){S.superclass.constructor.apply(this,arguments);c=this._config||{};this._sectionMap=null;this._combobox=new sap.ui.commons.DropdownBox({'maxPopupItems':-1,'change':$.proxy(function(e){this._changePickedItem(this._sectionMap[e.oSource.getSelectedKey()]);},this)});this._combobox.placeAt(d);this.sections(c.sections);};O.extend(S,P);S.prototype.sections=function(v){this._sections=v||[];this._commitSections();return this;};S.prototype._commitSections=function(){this._combobox.removeAllItems();this._sectionMap={};var g=0;this._sections.forEach($.proxy(function(s){if(g!==s.groupIndex){g=s.groupIndex;var a=new sap.ui.core.ListItem({'enabled':false,'text':'------'});a.setTooltip(new sap.ui.core.TooltipBase({text:""}));this._combobox.addItem(a);}this._sectionMap[s.id]=s;this._combobox.addItem(new sap.ui.core.ListItem({'key':s.id,'text':s.caption}));},this));};S.prototype.pickedItem=function(v){S.superclass.pickedItem.apply(this,arguments);this._combobox.setSelectedKey(this._pickedItem.id);};return S;});u('sap/viz/controls/propertyeditor/events/PropertyEditorEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var P=function(t,a,d){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.propertyEditor.PropertyEditorEvent";};O.extend(P,E);P.RECENTCOLORS_CHANGED="recentColorsChanged";return P;});u('sap/viz/controls/propertyeditor/pickers/ColorButton',[],function(){var _=function(){jQuery.sap.declare("sap.viz.controls.propertyeditor.pickers.ColorButton");sap.ui.commons.Button.extend("sap.viz.controls.propertyeditor.pickers.ColorButton",{metadata:{properties:{color:{type:"any",defaultValue:"#FFFFFF"},}},setColor:function(v){this.setProperty("color",v,true);this.$().css("background-color",v);},renderer:function(r,c){r.addStyle("background-color",c.getColor());r.addClass("colorButton");sap.ui.commons.ButtonRenderer.render(r,c);}});};return{'create':function(a,s){try{return new sap.viz.controls.propertyeditor.pickers.ColorButton(a,s);}catch(e){_();return arguments.callee.apply(this,arguments);}}};});u('sap/viz/controls/propertyeditor/pickers/ColorPicker',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/pickers/PickerBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/propertyeditor/events/PropertyEditorEvent','sap/viz/controls/propertyeditor/pickers/ColorButton'],function(C,O,P,L,E,a,b){var d=function(c,p,k){d.superclass.constructor.apply(this,arguments);k=this._config||{};var n;if(this._pickedItem===null){n=true;}else{n=false;}if(this._pickedItem===undefined){this._pickedItem='rgba(0,0,0,1)';}this._pickedItemChanged=false;this._mode=k.mode||'fill';this._needUpdate=true;this._viewsContainer$=null;this._views=[];this._mdHandler=null;this._noColorText=null;this._resizeHandler=null;this._oRecentColorsPalette=null;this._pickContainer$=$(document.createElement('div')).appendTo(c).on('click',$.proxy(this._pickerBtnClickHandler,this));this._pickContainer$.addClass('sapUiTfBrd sapUiTfStd  sapUiTfCombo '+C.PROPERTYEDITOR_PREFIX+'colorpicker-pickercontainer');this._colorDiv$=$(document.createElement('div')).appendTo(this._pickContainer$);this._imgDiv$=$(document.createElement('div')).appendTo(this._pickContainer$);if(!n){this._colorDiv$.css({'background-color':this._pickedItem});}this._imgDiv$.addClass('sapUiTfComboIcon');this._colorDiv$.addClass(C.PROPERTYEDITOR_PREFIX+'colorpicker-background-color');};d._recentColors=[];d._shouldExcludeRecentColors={'rgba(0,0,0,0)':true};d._eventDispatch=new E();var e=["#000000","#7F7F7F","#ED1C24","#FF7F27","#FFF200","#22B14C","#00A2E8","#3F48CC","#A349A4","#FFFFFF","#C3C3C3","#FFAEC9","#FFC90E","#EFE4B0","#B5E61D","#99D9EA","#7092BE","#C8BFE7"];var f=["rgba(0,0,0,1)","rgba(127,127,127,1)","rgba(237,28,36,1)","rgba(255,127,39,1)","rgba(255,242,0,1)","rgba(34,177,76,1)","rgba(0,162,232,1)","rgba(63,72,204,1)","rgba(163,73,164,1)","rgba(255,255,255,1)","rgba(195,195,195,1)","rgba(255,174,201,1)","rgba(255,201,14,1)","rgba(239,228,176,1)","rgba(181,230,29,1)","rgba(153,217,234,1)","rgba(112,146,190,1)","rgba(200,191,231,1)"];var M=9;O.extend(d,P);d.prototype._pickerBtnClickHandler=function(){if(this._viewsContainer$!==null){this._destroyControls();return;}var v=this._viewsContainer$=$(document.createElement('div'));v.addClass(C.PROPERTYEDITOR_PREFIX+'colorpicker-views-container');this._locate();v.appendTo(document.body);var c=$(document.createElement('div'));var k=$(document.createElement('div'));k.css({'width':'100%',}).appendTo(v);this._oTogglePickerBtn=new sap.ui.commons.ToggleButton({text:L.get('PROPERTY_EDITOR_COLORPICKER_MORE'),press:function(m){var s=m.getSource();if(s.getPressed()){this._oPicker.$().addClass("visible");this._locate();}else{this._oPicker.$().removeClass("visible");this._locate();}}.bind(this)});this._oPicker=new sap.ui.commons.ColorPicker({colorString:_(this._pickedItem?this._pickedItem:'rgba(0,0,0,1)')});this._oPicker.attachLiveChange($.proxy(this._handlerColorPickerChange,this));this._oPalette=this._createColorPalette(e);this._oPalette.placeAt(v);var l=$(document.createElement('div'));var o=new sap.ui.commons.Label();o.setText(L.get('PROPERTY_EDITOR_COLORPICKER_RECENTCOLORS'));o.addStyleClass('recentColorLabel');o.placeAt(l);l.appendTo(v);this._oRecentColorsPalette=this._createRecentColorsPalette();this._oRecentColorsPalette.placeAt(v);this._oTogglePickerBtn.placeAt(c);this._oPicker.placeAt(c);this._needUpdate=true;c.appendTo(v);v.fadeIn();this._addEventListeners();this._mdHandler=$.proxy(this._mousedownHandler,this);$(document).on('mousedown',this._mdHandler);$(window).on('blur',this._mdHandler);};d.prototype._handleColorPalettePickerChange=function(o){var t=o.getParameters().id;this._pickedItem=$('#'+t)[0].title;this._needUpdate=false;this._oPicker.setColorString(this._pickedItem);if(this._oPicker._processRGBchanges){this._oPicker._processRGBchanges();}this._updateColor();this._needUpdate=true;};d.prototype._handleNoColorClicked=function(){this._pickedItem='rgba(0,0,0,0)';this._updateColor();};var g=function(o){var p=o.getParameters();if(p.h===360){this._oPicker.oHueField.setValue(359.9);if(this._oPicker._handleHueValueChange){this._oPicker._handleHueValueChange();}return;}return'rgba('+p.r+','+p.g+','+p.b+','+((!!p.alpha||p.alpha===0)?p.alpha:1)+')';};d.prototype._handlerColorPickerChange=function(o){if(!this._needUpdate){return;}this._pickedItem=g(o);this._pickedItemChanged=true;this._updateColor();};d.prototype._updateRecentColor=function(o){this._updateRecentColorPalette();};d.prototype._updateColor=function(){this._changePickedItem(this._pickedItem);this._colorDiv$.css({'background-color':this._pickedItem})};d.prototype._locate=function(){if(this._viewsContainer$!==null&&this._pickContainer$!==null){var o=$('.viz-controls-propertyeditor-main').offset();var c=this._pickContainer$.offset();var k=$('body').height();var v=this._viewsContainer$.height();v=v>100?v:100;var l=c.top+32+v<k-20?c.top+26:c.top-v-12;this._viewsContainer$.css({'left':o.left-10,'top':l<0?0:l});}};d.prototype._resizer=function(c){if(!c.data.invalidateSize){setTimeout($.proxy(function(){c.data.invalidateSize=false;this._locate();},this),1000/24);}c.data.invalidateSize=true;};d.prototype._addEventListeners=function(){this._resizeHandler=$.proxy(this._resizer,this);$(window).resize({'invalidateSize':false},this._resizeHandler);};d.prototype._mousedownHandler=function(o){if(this._viewsContainer$!==null&&$(o.target).closest(this._viewsContainer$).length<=0&&$(o.target).closest(this._pickContainer$).length<=0){this._destroyControls();this._updateRecentColor();}};d.prototype._destroyControls=function(){$(document).off('mousedown',this._mdHandler);$(window).off('blur',this._mdHandler);$(window).off('resize',this._resizeHandler);this._views.forEach(function(v){v.destroy();});if(!!this._noColorText){this._noColorText.destroy();}this._viewsContainer$.empty().detach();this._views=[];this._viewsContainer$=null;this._mdHandler=null;this._resizeHandler=null;};var h=function(c,p,s){var c=c===undefined?'transparent':c;var o=b.create({color:c,tooltip:c});o.attachPress(function(k){p.call(s,k);});o.addStyleClass('colorButton');return o;};d.prototype._createColorPalette=function(c){var k=c.length;var l=$(document.createElement('div'));for(var i=0;i<k;i++){var o=h(c[i],this._handleColorPalettePickerChange,this);o.placeAt(l);}var n=b.create({color:"transparent",tooltip:L.get('PROPERTY_EDITOR_COLORPICKER_NOCOLOR'),});n.attachPress(function(m){this._handleNoColorClicked();}.bind(this));n.addStyleClass('colorButton');n.placeAt(l);this._noColorText=new sap.ui.core.HTML("noColorText",{content:"<span class='sapUiBtnS noColorText'>"+L.get('PROPERTY_EDITOR_COLORPICKER_NOCOLOR')+"</span>"});this._noColorText.attachBrowserEvent('click',function(){this._handleNoColorClicked();}.bind(this));this._noColorText.placeAt(l);return{placeAt:function(m){l.appendTo(m);}};};d.prototype._createRecentColorsPalette=function(){var c=$(document.createElement('div'));c.addClass('recentColorsContainer');var r=d._recentColors.length>M?M:d._recentColors.length;var k=[];for(var i=0;i<r;i++){var o=h(d._recentColors[i],this._handleRecentColorChange,this);o.placeAt(c);k.push(o);}return{placeAt:function(l){c.appendTo(l);},update:function(){var i;for(i=0;i<r;i++){if(i===0){k[i].addStyleClass("colorButtonSelected");}else{k[i].removeStyleClass("colorButtonSelected");}k[i].setColor(d._recentColors[i]);k[i].setTooltip(d._recentColors[i]);}for(i=r;i<M;i++){if(!!d._recentColors[i]){var o=h(d._recentColors[i],this._handleRecentColorChange,this);o.placeAt(c);k.push(o);}}}};};d.prototype._checkExcludedRecentColor=function(){var c=false;if(this._pickedItem){if(d._shouldExcludeRecentColors.hasOwnProperty(this._pickedItem)&&d._shouldExcludeRecentColors[this._pickedItem]){c=true;}}return c;};d.prototype._handleRecentColorChange=function(o){var t=o.getParameters().id;this._pickedItem=$('#'+t)[0].title;this._pickedItemChanged=true;this._needUpdate=false;this._oPicker.setColorString(this._pickedItem);this._updateRecentColorPalette();if(this._oPicker._processRGBchanges){this._oPicker._processRGBchanges();}this._updateColor();this._needUpdate=true;};d.prototype._updateRecentColorPalette=function(){if(this._pickedItemChanged===false){return;}this._pickedItemChanged=false;if(e.indexOf(this._pickedItem)>=0||f.indexOf(this._pickedItem)>=0||this._checkExcludedRecentColor()){return;}var c=d._recentColors.indexOf(this._pickedItem);if(c>=0){d._recentColors.splice(c,1);}d._recentColors.splice(0,0,this._pickedItem);this._oRecentColorsPalette.update.call(this);d._recentColors.length=d._recentColors.length>M?M:d._recentColors.length;var p=new a(a.RECENTCOLORS_CHANGED,this,d._recentColors);d._eventDispatch._dispatchEvent(p);};var _=function(k){var c=k;if(c.substr(0,4)==='rgba'){c=c.substr(4);c=c.replace('(','');c=c.replace(')','');c=c.split(',');if(Number(c[3])===0){c[3]='0.0';c=c.join(',');c='rgba('+c+')';return c;}}return k;};return d;});u('sap/viz/controls/propertyeditor/pickers/AlignmentPicker',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/propertyeditor/pickers/PickerBase','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(O,C,P,a){var b=function(f,p,g){b.superclass.constructor.apply(this,arguments);this._dom$;this._buttons={};this._createChildren();p=p?p:d;this._switchUIHandler(p);};var c='left';var d='center';var e='right';O.extend(b,P);b.prototype._createChildren=function(){this._pickerContainer$=$(document.createElement('div')).appendTo(this._dom$);this._pickerContainer$.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row '+C.PROPERTYEDITOR_PREFIX+'view-item-padding-bottom');this._buttons={left:this._addButton(c),center:this._addButton(d),right:this._addButton(e)};};b.prototype._switchUIHandler=function(f){for(var k in this._buttons){var n=this._buttons[k];n.removeClass(C.PROPERTYEDITOR_PREFIX+'alignmentpicker-selected-'+k);if(k===f){n.removeClass(C.PROPERTYEDITOR_PREFIX+'alignmentpicker-unselected-'+k);n.addClass(C.PROPERTYEDITOR_PREFIX+'alignmentpicker-selected-'+k);}else{n.addClass(C.PROPERTYEDITOR_PREFIX+'alignmentpicker-unselected-'+k);}}};b.prototype._addButton=function(f){var n=$(document.createElement('div'));n.addClass(C.PROPERTYEDITOR_PREFIX+'alignmentpicker-button');n.addClass(C.PROPERTYEDITOR_PREFIX+'icon');n.appendTo(this._pickerContainer$);n.on('click',$.proxy(function(E){this._switchUIHandler(f);this.pickedItem(f);this._changePickedItem();},this));return n;};return b;});u('sap/viz/controls/propertyeditor/pickers/FontPicker',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/propertyeditor/pickers/PickerBase','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/AlignmentPicker'],function(O,C,c,P,d,e,f){var F=function(a,p,b,h){F.superclass.constructor.apply(this,arguments);b=this._config||{};this._sizes=[8,9,10,11,12,14,16,18,20,22,24,26,28];this._pickedItem={fontFamily:p?g(p.fontFamily):undefined,fontSize:p?p.fontSize:undefined,fontWeight:p?p.fontWeight:undefined,fontColor:p?p.fontColor:undefined,fontStyle:p?p.fontStyle:undefined};this._dom$.addClass(C.PROPERTYEDITOR_PREFIX+'fontpicker');var k=this._createItemRow(2,C.PROPERTYEDITOR_PREFIX+'view-item-row');var l=$(k.children()[0]).addClass(C.PROPERTYEDITOR_PREFIX+'fontpicker-family');var m=new sap.ui.commons.DropdownBox({'width':l.width()+'px','selectedKey':this._pickedItem.fontFamily,'items':this._genFamilyItems(),'change':$.proxy(function(E){this._pickedItem.fontFamily=E.oSource.getSelectedKey();this._changePickedItem(this._pickedItem,{'fontFamily':this._pickedItem.fontFamily});},this)}).placeAt(l);if(this._pickedItem.fontFamily===null){c.defer(function(){sap.ui.commons.TextField.prototype.setValue.apply(m,[' '])});}else{this._pickedItem.fontFamily=m.getSelectedKey();}var s=$(k.children()[1]).addClass(C.PROPERTYEDITOR_PREFIX+'fontpicker-size');if(c.isArray(h)){this._sizes=h;}var n=this._size=new sap.ui.commons.ComboBox({'width':s.width()+'px','selectedKey':this._pickedItem.fontSize?parseInt(this._pickedItem.fontSize):null,'items':this._genSizeItems(),'change':$.proxy(function(E){var r=E.oSource.getValue();if(isNaN(r)){this._updateSize(this._sizes[0]);}else{this._updateSize(E.oSource.getSelectedKey()||parseInt(r));}this._changePickedItem(this._pickedItem,{'fontSize':this._pickedItem.fontSize});},this)}).placeAt(s);this._updateSize(this._pickedItem.fontSize!==null?parseInt(this._pickedItem.fontSize):null);c.defer(function(){var r=$('input',n.$());r.on('click',function(){r.get(0).select();});});k=this._createItemRow(3,C.PROPERTYEDITOR_PREFIX+'view-item');var w=new sap.ui.commons.ToggleButton({'text':'B','pressed':this._pickedItem.fontWeight==='bold'?true:false,'press':$.proxy(function(E){this._pickedItem.fontWeight=E.oSource.getPressed()?'bold':'normal';this._changePickedItem(this._pickedItem,{'fontWeight':this._pickedItem.fontWeight});},this)}).placeAt($(k.children()[0]));w.addStyleClass(C.PROPERTYEDITOR_PREFIX+'fontpicker-button');if(this._pickedItem.fontWeight!==null){this._pickedItem.fontWeight=w.getPressed()?'bold':'normal';}var o=new sap.ui.commons.ToggleButton({'text':'/','pressed':this._pickedItem.fontStyle==='oblique'?true:false,'press':$.proxy(function(E){this._pickedItem.fontStyle=E.oSource.getPressed()?'oblique':'normal';this._changePickedItem(this._pickedItem,{'fontStyle':this._pickedItem.fontStyle});},this)}).placeAt($(k.children()[1]));o.addStyleClass(C.PROPERTYEDITOR_PREFIX+'fontpicker-button');if(this._pickedItem.fontStyle!==null){this._pickedItem.fontStyle=o.getPressed()?'oblique':'normal';}if(b.showColorPicker===false){k.children().eq(2).hide();}var q=new e($(k.children()[2]),this._pickedItem.fontColor,{'mode':'text'});q.addEventListener(d.PICKED_ITEM_CHANGED,function(r){this._pickedItem.fontColor=r.data.pickedItem;this._changePickedItem(this._pickedItem,{'fontColor':this._pickedItem.fontColor});},this);if(this._pickedItem.fontColor!==null){this._pickedItem.fontColor=q.pickedItem();}};O.extend(F,P);F.prototype._updateSize=function(v){if(v){this._pickedItem.fontSize=v+'px';this._size.setValue(v);}else{this._size.setValue(' ');}};F.prototype._createItemRow=function(a,b){var i,h,k;h=$(document.createElement('div'));if(b){h.addClass(b);}for(i=0;i<a;i++){k=$(document.createElement('div'));if(i===0){k.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell-wrap');}else{k.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');}k.appendTo(h);}h.appendTo(this._dom$);return h;};var _=['Arial','Courier','Georgia','Times New Roman','Trebuchet MS','Verdana'];F.prototype._genFamilyItems=function(){var a=[];_.forEach(function(b){a.push(new sap.ui.core.ListItem({'key':b,'text':b}));});return a;};F.prototype._genSizeItems=function(){var h=[];this._sizes.sort(function(a,b){return a-b;});this._sizes.forEach(function(s){h.push(new sap.ui.core.ListItem({'key':s,'text':s}));});return h;};var g=function(a){if(!a){return null;}var t;for(var i in _){t=_[i];if(a.indexOf(t)>=0){return t;}}return a;};return F;});u('sap/viz/controls/propertyeditor/pickers/SwitchPicker',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/pickers/PickerBase'],function(O,P){var S=function(d,p,c){S.superclass.constructor.apply(this,arguments);c=this._config||{};this._checkBox=new sap.ui.commons.CheckBox({'text':c.text,'checked':this._pickedItem,'change':$.proxy(function(e){this._changePickedItem(this._checkBox.getChecked());this._onStatusChanged();},this)});this._checkBox.placeAt(d);};O.extend(S,P);S.prototype.checked=function(c){if(arguments.length>0){if(this._checkBox.getChecked()!==c){this._checkBox.setChecked(c);}return this;}else{return this._checkBox.getChecked();}};S.prototype.enabled=function(e){if(arguments.length>0){if(this._checkBox.getEnabled()!==e){this._checkBox.setEnabled(e);}return this;}else{return this._checkBox.getEnabled();}};return S;});u('sap/viz/controls/propertyeditor/sections/PropertyViewBase',['sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/utils/Utils'],function(V,O,U,a){var P=function(d,b,v,p){P.superclass.constructor.apply(this,arguments);this._vizProxy=v;this._propertyZones=p;this._vizProxy.on("initialized.PropertyViewBase",$.proxy(function(e){this._propertyChangedHandler(e);},this));};O.extend(P,U);P.prototype._createHelper=function(c,b){return new c(b,{'view':this,'dom$':this._dom$,'proxy':this._vizProxy,'queryProperty':$.proxy(this._queryProperty,this),'queryProperties':$.proxy(this._queryProperties,this),'updateProperty':$.proxy(this._updateProperty,this),'updateProperties':$.proxy(this._updateProperties,this)});};P.prototype._queryProperty=function(p){var b={};b[p]=true;var r=this._queryProperties(b);return r?r[p]:undefined;};P.prototype._queryProperties=function(p){if(this._propertyZones){return this._vizProxy.queryProperties({'propertyZones':this._propertyZones,'propertyFields':p,'chartType':this._vizProxy._client().type()});}else{return this._vizProxy.queryProperties({'propertyFields':p});}};P.prototype._updateProperty=function(p,v){var b={};b[p]=v;this._updateProperties(b);};P.prototype._updateProperties=function(p,k,b){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_properties_on_propertyviewbase');if(!k){this._filterNullValue(p);}if(this._propertyZones){if(b===true){this._vizProxy.updateProperties({'propertyZones':[new V(this._propertyZones[0].type())],'properties':p,'chartType':this._vizProxy._client().type()});}else{var c=[];this._propertyZones.forEach($.proxy(function(d){c.push(d);},this));this._vizProxy.updateProperties({'propertyZones':c,'properties':p,'chartType':this._vizProxy._client().type()});}}else{this._vizProxy.updateProperties(p);}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_properties_on_propertyviewbase');};P.prototype._isAllSelected=function(){if(this._propertyZones){return this._propertyZones[0].context()===undefined;}return false;};P.prototype._filterNullValue=function(p){for(var i in p){if(p[i]===null){delete p[i];}}};P.prototype._getExtraContext=function(c){var i,e,f,h;if(this._propertyZones&&this._propertyZones.length&&this._propertyZones[0].extraContext()){f=this._propertyZones[0].extraContext()[c];for(i=0;i<this._propertyZones.length;i++){e=this._propertyZones[i].extraContext();if(e[c]!==f){h=true;break;}}}if(!h){return f;}return null;};P.prototype.destroy=function(){this._vizProxy.off("initialized.PropertyViewBase");P.superclass.destroy.apply(this,arguments);};P.prototype._propertyChangedHandler=function(e){};return P;});u('sap/viz/controls/propertyeditor/spin/SpinEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var S=function(t,a,d){S.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.SpinEvent";};O.extend(S,E);S.CHANGED='changed';return S;});u('sap/viz/controls/propertyeditor/spin/Spin',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/KeyboardEventConst','sap/viz/controls/common/UIControl','sap/viz/controls/propertyeditor/spin/SpinEvent'],function(O,C,K,U,S){var a=function(d,o){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.propertyeditor.spin.Spin";this._options=(o!=null?o:{});if(!(this._options.hasOwnProperty('step'))){this._options.step=1;}if(!(this._options.hasOwnProperty('decimals'))){this._options.decimals=0;}if(!(this._options.hasOwnProperty('value'))){this._options.value=0;}this._createChildren();};O.extend(a,U);a.prototype._createChildren=function(){var _=$(document.createElement('div'));this._dom.append(_);var t=document.createElement('div');this._input=new sap.ui.commons.TextField({"width":"100%"});this._input.setValue(this._options.value);this._input.placeAt($(t));_.append(t);var b=document.createElement('span');var c=document.createElement('span');b.appendChild(c);_.append(b);var d=document.createElement('span');var e=document.createElement('span');d.appendChild(e);_.append(d);_.addClass(C.PROPERTYEDITOR_PREFIX+'spin');$(t).addClass(C.PROPERTYEDITOR_PREFIX+'spin-input');$(c).addClass(C.PROPERTYEDITOR_PREFIX+'icon');$(c).addClass(C.PROPERTYEDITOR_PREFIX+'spin-upButton-content');$(b).addClass(C.PROPERTYEDITOR_PREFIX+'spin-upButton');$(e).addClass(C.PROPERTYEDITOR_PREFIX+'icon');$(e).addClass(C.PROPERTYEDITOR_PREFIX+'spin-downButton-content');$(d).addClass(C.PROPERTYEDITOR_PREFIX+'spin-downButton');var m=this;this._input.attachChange(function(f){m.setValue(m._input.getValue());});t.addEventListener('mousewheel',$.proxy(this._handleMouseWheel,this),this);t.addEventListener('DOMMouseScroll',$.proxy(this._handleMouseWheel,this),false);t.addEventListener('keydown',$.proxy(this._handleKeyDown,this),false);t.addEventListener('keypress',$.proxy(this._handleKeyPress,this),false);t.addEventListener('keyup',$.proxy(this._stop,this),false);b.addEventListener('mousedown',$.proxy(this._upButtonStart,this),false);b.addEventListener('mouseup',$.proxy(this._stop,this),false);b.addEventListener('mouseout',$.proxy(this._stop,this),false);d.addEventListener('mousedown',$.proxy(this._downButtonStart,this),false);d.addEventListener('mouseup',$.proxy(this._stop,this),false);d.addEventListener('mouseout',$.proxy(this._stop,this),false);};a.prototype.getValue=function(){return this._input.getValue();};a.prototype.setValue=function(v){this._setValue(v,false);};a.prototype._setValue=function(v,b){var c;if(v===null||v===''){c=true;}var v=parseFloat(v);if(isNaN(v)){v=0;}if(this._options.hasOwnProperty('min')){v=Math.max(this._options.min,v);}if(this._options.hasOwnProperty('max')){v=Math.min(this._options.max,v);}var s=(v<0?'-':'');v=Math.abs(v);var m=Math.pow(10,this._options.decimals);v=Math.round(v*m);var d=(v-v%m)/m;var f=''+v%m;var n=this._options.decimals-f.length;if(n>0){for(var i=0;i<n;i++){f='0'+f;}}if(c){this._input.setValue('');}else{this._input.setValue(s+d+(this._options.decimals>0?'.'+f:''));if(!b){this._dispatchEvent(new S(S.CHANGED,this,{'value':this._input.getValue()}));}}};a.prototype.updateUI=function(v){this._setValue(v,true);};a.prototype._handleMouseWheel=function(e){if(e.target.id===this._input.sId){if(e.wheelDelta){this._start(e,e.wheelDelta>1);}else if(e.detail){this._start(e,e.detail<1);}this._stop();}};a.prototype._handleKeyDown=function(e){if(e.keyCode==K.UP)this._start(e,true);if(e.keyCode==K.DOWN)this._start(e,false);};a.prototype._handleKeyPress=function(e){var k=e.keyCode;if(k==0||e.altKey||e.ctrlKey||e.metaKey){return;}if(k==K.SUBTRACT&&(!this._options.hasOwnProperty('min')||this._options.min<0)){return;}if(k==K.DECIMAL&&this._options.decimals>0){return;}if(k>=K.NUM_0&&k<=K.NUM_9){return;}if(k==K.ENTER){this.setValue(this._input.getValue());return;}e.preventDefault();};a.prototype._upButtonStart=function(e){e.preventDefault();this._start(e,true);};a.prototype._downButtonStart=function(e,b){e.preventDefault();this._start(e,false)};a.prototype._start=function(e,b){if(this._timeout)return;this._curStep=(b?this._options.step:-this._options.step);this._delay=500;this._update();};a.prototype._stop=function(e){if(this._timeout){clearTimeout(this._timeout);delete this._timeout;}};a.prototype._update=function(){var v=parseFloat(this._input.getValue());if(isNaN(v))v=0;this.setValue(v+this._curStep);this._delay=Math.max(20,Math.floor(this._delay*0.8));this._timeout=setTimeout($.proxy(function(){this._update();},this),this._delay);};return a;});u('sap/viz/controls/propertyeditor/pickers/PSfixPicker',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/pickers/PickerBase'],function(O,C,L,P){var a=function(d,p){a.superclass.constructor.apply(this,arguments);this._pickedItem={fix:p?p.fix:undefined,value:p?p.value:''};this._dom$.addClass(C.PROPERTYEDITOR_PREFIX+'fixpicker-container');this._createChildren();};O.extend(a,P);a.LABEL_PREFIX="Prefix";a.LABEL_SUFFIX="Suffix";a.prototype._createChildren=function(){var b=this._createItemRow(2,C.PROPERTYEDITOR_PREFIX+'view-item');var f=$(b.children()[0]).addClass(C.PROPERTYEDITOR_PREFIX+'fixpicker-fix');var c=new sap.ui.commons.DropdownBox({'width':f.width()+'px','selectedKey':this._pickedItem.fix,'items':g(),'change':$.proxy(function(e){this._pickedItem.fix=e.oSource.getSelectedKey();this._pickedItem.value=this._input.getValue();this._changePickedItem(this._pickedItem,{'fix':this._pickedItem.fix,'value':this._pickedItem.value?this._pickedItem.value:''});},this)}).placeAt(f);var d=$(b.children()[1]).addClass(C.PROPERTYEDITOR_PREFIX+'fixpicker-input');this._input=new sap.ui.commons.TextField({"width":"60px"}).placeAt(b.children()[1]);this._input.setMaxLength(3);this._input.setValue(this._pickedItem.value);var m=this;this._input.attachChange(function(e){var h=m._pickedItem.fix?m._pickedItem.fix:a.LABEL_PREFIX;m._pickedItem.value=m._input.getValue();m._changePickedItem(m._pickedItem,{'fix':h,'value':m._pickedItem.value});});};var _=[{"key":a.LABEL_PREFIX,"text":L.get('PROPERTY_EDITOR_PSPICKER_PREFIX')},{"key":a.LABEL_SUFFIX,"text":L.get('PROPERTY_EDITOR_PSPICKER_SUFFIX')}];function g(){var b=[];_.forEach(function(f){b.push(new sap.ui.core.ListItem({'key':f["key"],'text':f["text"]}));});return b;};a.prototype._createItemRow=function(c,b){var i,d,e;d=$(document.createElement('div'));if(b){d.addClass(b);}for(i=0;i<c;i++){e=$(document.createElement('div'));e.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');e.appendTo(d);}d.appendTo(this._dom$);return d;};return a;});u('sap/viz/controls/propertyeditor/pickers/FormatPicker',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/propertyeditor/pickers/PickerBase','sap/viz/controls/propertyeditor/spin/Spin','sap/viz/controls/propertyeditor/pickers/PSfixPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(O,L,C,P,S,a,b){var c="u";var d="[CVOM#UNIT]k";var f="[CVOM#UNIT]m";var g="[CVOM#UNIT]b";var h="[CVOM#UNIT]t";var k=[c,d,f,g,h];var l="[CVOM#PFIX]";var m="[CVOM#SFIX]";var M='#minus#';function p(e){var q=0,r=true,s=false,t=false;var v=false,w=undefined,x,y,z,D,E=0,i;var G=null,H=null,I;if(e){e=e.replace(/#minus#/g,'-');var J=11;var K=e.indexOf(l);var N=e.lastIndexOf(l);if(K>=0&&N>=0&&K!==N){G=e.substring(K+J,N);e=e.substring(N+J);}K=e.indexOf(m);N=e.lastIndexOf(m);if(K>=0&&N>=0&&K!==N){H=e.substring(K+J,N);e=e.substring(0,K);}var Q=e.length;if(e.substring(Q-1)==='%'){s=true;r=false;z=e.substring(0,Q-1);}else{s=false;r=true;z=e;for(i=0;i<k.length;i++){I=k[i];unitFormtSuffixLen=I.length;x=e.substring(Q-unitFormtSuffixLen);if(I===x){v=true;w=I;z=e.substring(0,Q-unitFormtSuffixLen);break;}}if(z.indexOf(',')>-1){t=true;}}D=z.indexOf(".");if(D>-1){fraction=z.substring(D);for(i=1,E=0;i<fraction.length;i++){if(fraction.charAt(i)==='0'){E++;}else{break;}}}q=E;}return{decimal:q,displayAsNumber:r,displayAsPercent:s,showSep:t,useAbbr:v,abbrOption:w,prefix:G,suffix:H};}function n(v,e){if(v){v=v.replace(/-/g,M);if(e===a.LABEL_PREFIX){return l+v+l;}else if(e===a.LABEL_SUFFIX){return m+v+m;}}return null;}function o(e){var q=e["decimal"],r=e["displayAsNumber"];var s=e["displayAsPercent"],t=e["showSep"];var v=e["useAbbr"],w=e["abbrOption"],x="",i;var y=n(e['prefix'],a.LABEL_PREFIX);var z=n(e['suffix'],a.LABEL_SUFFIX);if(q&&!isNaN(Number(q))){q=Number(q);if(q>0){x+=".";while(q--){x+="0";}}}if(r){x=(t?"#,##0":"###0")+x;if(v){switch(w){case c:x+=c;break;case d:case f:case g:case h:x+=w;default:}}}else if(s){x="0"+x+"%";}if(y){x=y+x;}if(z){x=x+z;}return x;}var F=function(q,r){F.superclass.constructor.apply(this,arguments);try{this._formatItem=p(r);}catch(e){this._formatItem={};}this._createChildren();};O.extend(F,P);F.prototype._createChildren=function(){var q,r;q=$(document.createElement('div'));q.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');q.appendTo(this._dom$);var s=new sap.ui.commons.Label({text:L.get('FORMAT_PICKER_DECIMAL')});s.placeAt(q);q=$(document.createElement('div'));q.appendTo(this._dom$).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-padding-bottom');q.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var t=new S(q,{min:0,max:10,value:this._formatItem.decimal});t.addEventListener("changed",$.proxy(function(e){this._formatItem["decimal"]=e.data.value;this._pickedItem=o(this._formatItem);this._changePickedItem();},this));q=$(document.createElement('div')).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');q.appendTo(this._dom$);var v=new sap.ui.commons.RadioButton({text:L.get('FORMAT_PICKER_DISPLAY_NUMBER'),groupName:'formatradio',selected:this._formatItem.displayAsNumber,select:$.proxy(function(e){this._formatItem["displayAsNumber"]=true;this._formatItem["displayAsPercent"]=false;H.apply(this);this._pickedItem=o(this._formatItem);this._changePickedItem();},this)}).placeAt(q);q=$(document.createElement('div'));q.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1 '+C.PROPERTYEDITOR_PREFIX+'formatpicker-number');q.appendTo(this._dom$);r=$(document.createElement('div'));r.appendTo(q);var w=new sap.ui.commons.CheckBox({text:L.get('FORMAT_PICKER_SHOW_SEP'),checked:this._formatItem.showSep,change:$.proxy(function(e){this._formatItem["showSep"]=e.oSource.getChecked();this._pickedItem=o(this._formatItem);this._changePickedItem();},this)}).placeAt(r);r=$(document.createElement('div'));r.appendTo(q).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var x=new sap.ui.commons.CheckBox({text:L.get('FORMAT_PICKER_SHOW_BY_UNIT'),'width':r.width()+'px',checked:this._formatItem.useAbbr,change:$.proxy(function(e){this._formatItem["useAbbr"]=e.oSource.getChecked();this._formatItem["abbrOption"]=y.getSelectedKey();H.apply(this);this._pickedItem=o(this._formatItem);this._changePickedItem();},this)}).placeAt(r);r=$(document.createElement('div'));r.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row '+C.PROPERTYEDITOR_PREFIX+'formatpicker-dropdown');r.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');r.appendTo(q);var y=new sap.ui.commons.DropdownBox({'width':r.width()+'px','items':this._createAbbrOptions(),selectedKey:this._formatItem.abbrOption||c,change:$.proxy(function(e){this._formatItem["abbrOption"]=e.oSource.getSelectedKey();this._pickedItem=o(this._formatItem);this._changePickedItem();},this)}).placeAt(r);q=$(document.createElement('div'));q.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');q.appendTo(this._dom$);var z=new sap.ui.commons.RadioButton({text:L.get('FORMAT_PICKER_DISPLAY_PERCENT'),groupName:'formatradio',selected:this._formatItem.displayAsPercent,select:$.proxy(function(e){this._formatItem["displayAsNumber"]=false;this._formatItem["displayAsPercent"]=true;H.apply(this);this._pickedItem=o(this._formatItem);this._changePickedItem();},this)}).placeAt(q);q=$(document.createElement('div'));q.appendTo(this._dom$);var D,E;if(this._formatItem.prefix&&this._formatItem.prefix!==''){D='Prefix';E=this._formatItem.prefix;}else if(this._formatItem.suffix&&this._formatItem.suffix!==''){D='Suffix';E=this._formatItem.suffix;}var G=new a(q,{'fix':D,'value':E});G.addEventListener(b.PICKED_ITEM_CHANGED,$.proxy(function(e){var I=e.data.changedItem;this._formatItem["prefix"]=I.fix===a.LABEL_PREFIX?I.value:null;this._formatItem["suffix"]=I.fix===a.LABEL_SUFFIX?I.value:null;this._pickedItem=o(this._formatItem);this._changePickedItem();},this));function H(){x.setEnabled(this._formatItem["displayAsNumber"]);y.setEnabled(this._formatItem["displayAsNumber"]&&this._formatItem["useAbbr"]);w.setEnabled(this._formatItem["displayAsNumber"]);}H.apply(this);};F.prototype._createAbbrOptions=function(){var e=[];var q=[{key:c,value:L.get('FORMAT_PICKER_UNIT_AUTO')},{key:d,value:L.get('FORMAT_PICKER_UNIT_K')},{key:f,value:L.get('FORMAT_PICKER_UNIT_M')},{key:g,value:L.get('FORMAT_PICKER_UNIT_B')},{key:h,value:L.get('FORMAT_PICKER_UNIT_T')}];q.forEach(function(r){e.push(new sap.ui.core.ListItem({'key':r.key,'text':r.value}));});return e;};F.analysisFormatString=function(e){if(e===undefined||e===null){return;}var q=e.toString();var r=0;if(q.indexOf('.')>=0){r=q.length-1-q.indexOf('.');}var s='0';for(var i=0;i<r;i++){if(i===0){s='0.';}s=s.concat('0');}return s;};return F;});u('sap/viz/controls/propertyeditor/pickers/ListPicker',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/propertyeditor/pickers/PickerBase','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(O,C,P,a){var L=function(d,p,c){L.superclass.constructor.apply(this,arguments);this._pickedItem=p;this._createChildren(c);};O.extend(L,P);L.prototype._createChildren=function(c){this._dom$.addClass(C.PROPERTYEDITOR_PREFIX+'listpicker');var b=$(document.createElement('div'));b.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');b.appendTo(this._dom$);var l=new sap.ui.commons.Label({text:c.text}).placeAt(b);b=$(document.createElement('div'));b.addClass(C.PROPERTYEDITOR_PREFIX+'listpicker-dropdown');b.appendTo(this._dom$);var d=new sap.ui.commons.DropdownBox({'width':b.width()+'px','items':this._createOptions(c.items),selectedKey:this._pickedItem,change:$.proxy(function(e){this._pickedItem=e.oSource.getSelectedKey();this._changePickedItem();},this)}).placeAt(b);};L.prototype._createOptions=function(l){var b=[];if(l){l.forEach(function(c){b.push(new sap.ui.core.ListItem({'key':c.key,'text':c.value}));});}return b;};return L;});u('sap/viz/controls/propertyeditor/sections/views/VizChartView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/propertyeditor/helpers/VizPropertiesHelper','sap/viz/controls/propertyeditor/pickers/FontPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/pickers/SwitchPicker','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/common/events/Event','sap/viz/controls/propertyeditor/pickers/FormatPicker','sap/viz/controls/propertyeditor/pickers/ListPicker','sap/viz/controls/propertyeditor/pickers/AlignmentPicker'],function(C,O,U,V,F,P,S,a,E,b,L,c){var d=function(e,g,v,p){d.superclass.constructor.apply(this,arguments);this._createChildren();};O.extend(d,a);var f={"boolean":S,"font":F,"alignment":c,"format":b,"list":L};d.prototype._createChildren=function(){this._area$=$(document.createElement('div')).appendTo(this._dom$);this._area$.addClass(C.PROPERTYEDITOR_PREFIX+'views-container');};d.prototype.update=function(e,v){this._vizProxy=v;this._updateChildren(e);};d.prototype._updateChildren=function(e){this.destroy();var g=this._area$=$(document.createElement('div')).appendTo(this._dom$);this._createUIChildren(g,e,null);};d.prototype._createUIChildren=function(e,g,p,h){for(var i=0;i<g.length;i++){var k=g[i];var l=$(document.createElement('div')).appendTo(e);var m=this._createUIControl(k,l,p);if(!m){continue;}if(k.hasOwnProperty("children")){var n=$(document.createElement('div')).appendTo(e).addClass(C.PROPERTYEDITOR_PREFIX+"vizchartview-childcontainer");this._createUIChildren(n,k.children,m,true);if(!h){n.hide();}}if(!l.hasClass(C.PROPERTYEDITOR_PREFIX+'collapse')&&!h){l.hide();}}if(!h){var o=new Object;o.currentTarget=$(e.get(0).children[0]);if(o.currentTarget.length<=0){return;}this._collapseControlClickHandler(o);}};d.prototype._createCollapseControl=function(e,g,p){var t=e.text||'';var h=(g).addClass(C.PROPERTYEDITOR_PREFIX+'collapse');h.data('isCollapsed',true);var k=$(document.createElement('div')).addClass(C.COMMON_PREFIX+"UVBSharedSprite");k.addClass(C.PROPERTYEDITOR_PREFIX+"collapse-icon");k.appendTo(h);var l=$(document.createElement('div')).appendTo(h);l.addClass(C.PROPERTYEDITOR_PREFIX+"title-text");var m=new sap.ui.commons.Label({'text':t});m.placeAt(l);h.click(this._collapseControlClickHandler);};d.prototype._collapseControlClickHandler=function(e){var g=$(e.currentTarget);var h=!g.data('isCollapsed');g.data('isCollapsed',h);var k=$(g.get(0).children[0]);if(h){k.removeClass(C.PROPERTYEDITOR_PREFIX+"expand-icon");k.addClass(C.PROPERTYEDITOR_PREFIX+"collapse-icon");}else{k.removeClass(C.PROPERTYEDITOR_PREFIX+"collapse-icon");k.addClass(C.PROPERTYEDITOR_PREFIX+"expand-icon");}_(g,h);};var _=function(e,g){var h=e.next();if(g){while(!h.hasClass(C.PROPERTYEDITOR_PREFIX+'collapse')&&h.length>0){h.hide();h=h.next();}}else{while(!h.hasClass(C.PROPERTYEDITOR_PREFIX+'collapse')&&h.length>0){h.show();h=h.next();}}};d.prototype._createUIControl=function(g,h,p){var t=g.type;var k=null;if(f.hasOwnProperty(t)){if(t==='font'&&this._vizProxy.getType()==='viz/number'){var l=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];k=new f[t](h[0],g.value,g,l);}else if(t==='format'&&this._vizProxy.getType()==='viz/number'){var r=this._vizProxy.getDataset().data().measureValuesGroup;if(r&&r[0]&&r[0].data&&r[0].data[0]&&r[0].data[0].values&&r[0].data[0].values[0]&&r[0].data[0].values[0][0]){g.value=g.value||f[t].analysisFormatString(r[0].data[0].values[0][0]);}k=new f[t](h[0],g.value,g);this._updateProperty(g.path,g.value);}else{k=new f[t](h[0],g.value,g);}k.addEventListener(P.PICKED_ITEM_CHANGED,function(e){this._pickedItemChangedHandler(e.data.pickedItem,g);},this);if(p&&p.pickedItem){k.visible(p.pickedItem()&&p.visible());p.addEventListener(P.STATUS_CHANGED,function(){k.visible(p.pickedItem()&&p.visible());});}}else if(t===V.Type_Separator){k=this._createCollapseControl(g,h,p);}return k;};d.prototype._pickedItemChangedHandler=function(p,e){if(e.cssClass){var v=V.toCSSValue(e.type,p);this._updateProperties({css:{selector:e["cssClass"],value:v}});}else{this._updateProperty(e.path,p);}};d.prototype._updateProperty=function(p,v){var e=this._queryProperties();if(!U.isArray(p)){p=[p];}for(var n=0;n<p.length;++n){var g=p[n].split('.');var h=e;var k=true;for(var i=0;i<g.length-1;i++){if(!h[g[i]]){k=false;break;}h=h[g[i]];}if(k){var l=g[g.length-1];h[l]=v;}}this._updateProperties({properties:e});};d.prototype.destroy=function(){d.superclass.destroy.apply(this,arguments);this._area$.empty();};return d;});u('sap/viz/controls/propertyeditor/VizPropertyEditor',['sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/helpers/VizPropertiesHelper','sap/viz/controls/propertyeditor/sections/PropertyViewFactory','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/pickers/SectionPicker','sap/viz/controls/propertyeditor/sections/views/VizChartView'],function(V,C,O,U,a,b,L,c,P,d,S,e){var f=function(g,h){f.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.propertyeditor.VizPropertyEditor';sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizpropertyeditor_control');this._title$=null;this._sectionPicker=null;this._viewsContainer$=null;this._views=[];this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_vizpropertyeditor_control');};O.extend(f,V);f.prototype._onConnect=function(v,m){f.superclass._onConnect.apply(this,arguments);this._updateChildren();this._vizProxy().addEventListener("ChartChanged",this._chartChangedHandler,this);};f.prototype._onDisconnect=function(){f.superclass._onDisconnect.apply(this,arguments);this._vizProxy().removeEventListener("ChartChanged",this._chartChangedHandler,this);};f.prototype._chartChangedHandler=function(){var v=this._vizModel().type();if(v){this._updateVizChartView(v);}};f.prototype._createChildren=function(){var g;this._dom$.addClass(C.PROPERTYEDITOR_PREFIX+'main');this._dom$.css('overflow','auto');if(this._uiConfig.enableTitle===true){this._title$=$(document.createElement('div'));this._title$.addClass(C.PROPERTYEDITOR_PREFIX+'title');this._title$.appendTo(this._dom$);}this._viewsContainer$=$(document.createElement('div'));this._viewsContainer$.addClass(C.PROPERTYEDITOR_PREFIX+'views-container');this._viewsContainer$.appendTo(this._dom$);this._vizChartView=new e(this._viewsContainer$,{},this._vizProxy());this._updateChildren();};f.prototype._updateChildren=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_vizpropertyeditor');var v=this._vizModel().type();if(a.isInfoChart(v)){return;}if(v){var m=a.getVizType(v);if(this._title$){this._title$.text(U.substitute(L.get('PROPERTY_EDITOR_TITLE_PREFIX'),a.getVizTypeObject(m).caption));}this._updateVizChartView(v);}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_vizpropertyeditor');};f._getPropertyValue=function(p,g){var h=g.split('.');var v=p;for(var j=0;j<h.length;j++){v=v[h[j]];if(v==null){break;}}return v;};f.prototype._getCssValue=function(g,p,t){var v=this._vizProxy().queryProperties({css:{selector:g,properties:p}});if(v){v=c.fromCSSValue(t,v);}return v;};f.prototype._createPropertiesData=function(v,p){var g=[];for(var i=0;i<p.length;++i){g.push(p[i].path);}var s=b.hasProperties(v,g);var h=[];var k=this._vizProxy().getProperties();if(!k){return h;}for(var i=0;i<p.length;i++){if(!s[i]){continue;}var l=U.clone(p[i]);l.text=L.get(l.text);var m=l.path;var o=null;if(l.cssClass){o=this._getCssValue(l.cssClass,l.cssProperties,l.type);}else{if(U.isArray(m)){for(var n=0;n<m.length;++n){o=o||f._getPropertyValue(k,m[n]);}}else{o=f._getPropertyValue(k,m);}}l.value=o;if(l.hasOwnProperty("children")){l.children=this._createPropertiesData(v,l.children);}h.push(l);}return h;};f.prototype._updateVizChartView=function(v){var g=this._createPropertiesData(v,c.getProperties(v));this._vizChartView.update(g,this._vizProxy());};f.prototype.destroy=function(){this._dom$.css('overflow','visible');f.superclass.destroy.apply(this,arguments);this._vizChartView.destroy();this._viewsContainer$.empty();};return f;});u('sap/viz/controls/propertyeditor/sections/Section',[],function(){var S=function(a,v,c,g,b){this.id=a;this.viewClass=v;this.caption=c;this.groupIndex=g;this.itemIndex=b;};S.CHART_AREA='sectionChartArea';S.CHART_TITLE='sectionChartTitle';S.PLOT_AREA='sectionPlotArea';S.LEGEND='sectionLegend';S.CATEGORY_AXIS='sectionCategoryAxis';S.VALUE_AXIS='sectionValueAxis';S.VALUE_AXIS_TITLE='sectionValueAxisTitle';S.CATEGORY_AXIS_TITLE='sectionCategoryAxisTitle';S.COLUMN_DATA_POINT='sectionColumnDataPoint';S.COLUMN_DATA_LABEL='sectionColumnDataLabel';S.DONUT_DATA_POINT='sectionDonutDataPoint';S.DONUT_DATA_LABEL='sectionDonutDataLabel';S.DONUT_PLOT_AREA='sectionDonutPlotArea';S.LINE_DATA_POINT='sectionLineDataPoint';S.LINE_DATA_LABEL='sectionLineDataLabel';S.LINE='sectionLine';return S;});u('sap/viz/controls/propertyeditor/sections/helpers/ViewHelperBase',[],function(){var V=function(c,t){this._config=c;this._target=t;};return V;});u('sap/viz/controls/propertyeditor/sections/helpers/TextViewHelper',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/propertyeditor/sections/helpers/ViewHelperBase','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/pickers/FontPicker'],function(O,C,V,P,F){var T=function(c,t){T.superclass.constructor.apply(this,arguments);this._checkbox=null;this._fontPicker=null;this._createChildren();};O.extend(T,V);T.prototype._createChildren=function(){var c=$(document.createElement('div')).appendTo(this._target.dom$).addClass(C.PROPERTYEDITOR_PREFIX+'view-item');var a=this._checkbox=new sap.ui.commons.CheckBox({'text':this._config.visible.text,'change':$.proxy(this._checkboxChangedHandler,this)});a.placeAt(c);var f=$(document.createElement('div')).appendTo(this._target.dom$).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');this._fontPicker=new F(f.get(0),this._target.queryProperties({'fontFamily':true,'fontSize':true,'fontWeight':true,'fontColor':true,'fontStyle':true}));this._fontPicker.addEventListener(P.PICKED_ITEM_CHANGED,this._fontPickerChangedHandler,this);a.setChecked(this._target.queryProperty(this._config.visible.propertyField));this._commitChecked();};T.prototype._checkboxChangedHandler=function(){var c=this._checkbox.getChecked();this._target.updateProperty(this._config.visible.propertyField,c);if(this._config.visible.updateLayout){this._config.visible.updateLayout(c);}this._commitChecked();};T.prototype._commitChecked=function(){var c=this._checkbox.getChecked();this._fontPicker.visible(c);};T.prototype._fontPickerChangedHandler=function(e){this._target.updateProperties(e.data.pickedItem);};return T;});u('sap/viz/controls/propertyeditor/sections/views/CategoryAxisTitleView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/sections/helpers/TextViewHelper'],function(O,L,P,T){var C=function(d,v,p){C.superclass.constructor.apply(this,arguments);this._createChildren();};O.extend(C,P);C.prototype._createChildren=function(){var h=this._createHelper(T,{'visible':{'text':L.get('PROPERTY_EDITOR_SHOW_AXIS_TITLE'),'propertyField':'categoryAxis.title.visible',}});};return C;});u('sap/viz/controls/propertyeditor/sections/views/ValueAxisTitleView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/sections/helpers/TextViewHelper',],function(O,L,P,T){var V=function(d,a,v,p){V.superclass.constructor.apply(this,arguments);this._createChildren();};O.extend(V,P);V.prototype._createChildren=function(){var h=this._createHelper(T,{'visible':{'text':L.get('PROPERTY_EDITOR_SHOW_AXIS_TITLE'),'propertyField':'valueAxis.title.visible',}});};return V;});u('sap/viz/controls/propertyeditor/utils/PropertyUtil',[],function(){var P={};P.propertyToToggle=function(v){if(v===null){return'Mixed';}else if(v!==true){return"Unchecked";}else{return"Checked";}};return P;});u('sap/viz/controls/propertyeditor/helpers/SVGHelper',['jquery'],function($){var S={};S.setColor=function(s,c){$(s).find('*').each(function(){var t=$(this);if(t.css('stroke')&&t.css('stroke')!=='none'){t.css('stroke',c);}if(t.css('fill')&&t.css('fill')!=='none'){t.css('fill',c);}});};return S;});u('sap/viz/controls/propertyeditor/helpers/ObjectHelper',['jquery','sap/viz/controls/propertyeditor/helpers/SVGHelper'],function($,S){var O={};O.setSVGColor=function(o,c,a){if($('svg',o).length>0){S.setColor(o,c);if(a){a();}}};return O;});u('sap/viz/controls/propertyeditor/pickers/IconPicker',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/helpers/ObjectHelper','sap/viz/controls/propertyeditor/helpers/SVGHelper','sap/viz/controls/propertyeditor/pickers/PickerBase'],function($,C,O,a,S,P){var I=function(d,p,e){I.superclass.constructor.apply(this,arguments);e=this._config||{};this._icons=e.icons;this._iconMap={};this._parseIconMap();if(this._pickedItem===null){this._icon=null;}else{this._icon=p?p:this._icons[0].svg;}this._color=e.color?e.color:'rgb(0,0,0)';this._createChildren();this._list$=null;this._container$=null;this._resizeHandler=null;this._mdHandler=$.proxy(this._mousedownHandler,this);};O.extend(I,P);var c=C.PROPERTYEDITOR_PREFIX+'iconpicker-';var b=C.COMMON_PREFIX;I.prototype._createChildren=function(){this._container$=$(document.createElement('div')).appendTo(this._dom$);this._container$.addClass('sapUiTfBrd sapUiTfStd  sapUiTfCombo '+c+'container');this._icon$=$(document.createElement('div')).appendTo(this._container$);this._icon$.addClass(c+'icon');this._arrow$=$(document.createElement('div')).appendTo(this._container$);this._arrow$.addClass('sapUiTfComboIcon');this._arrow$.click($.proxy(this._arrowClickHandler,this));this._applyDefaultIcon();};I.prototype._parseIconMap=function(){var i,d;for(i=0;i<this._icons.length;i++){d=this._icons[i];this._iconMap[d.id]=d.svg;}};I.prototype.icon=function(d){if(arguments.length>0){if(this._icon!==d){this._icon=d;this._applyIcon();this._changePickedItem(this._icon);}return this;}else{return this._icon;}};I.prototype._applyIcon=function(){if(this.icon()){this._icon$[0].innerHTML=this.icon();var s=this._icon$.children().get(0);if(!s.getAttribute('viewBox')){var d=s.getBBox();s.setAttribute('viewBox',[d.x,d.y,d.width,d.height].join(' '));}s.setAttribute('fill',this.color());}};I.prototype.color=function(d){if(arguments.length>0){this._color=d;this._applyColor();return this;}else{return this._color;}};I.prototype._applyColor=function(){$('svg',this._dom$).each($.proxy(function(d,e){S.setColor(e,this.color());},this));};I.prototype._createIconList=function(){this._list$=$(document.createElement('div')).appendTo($('body'));this._locate();this._list$.addClass(c+'list');var t=$(document.createElement('div')).appendTo(this._list$);var i,d,e,s,l,f,g;for(i=0;i<this._icons.length;i++){e=this._icons[i];d=e.id;s=e.svg;this._iconMap[d]=s;g=$(document.createElement('div')).appendTo(t);g.addClass(c+'list-cell');g.data('icon',s);f=$(document.createElement('div')).appendTo(g);f[0].innerHTML=s;var s=f.children().get(0);if(!s.getAttribute('viewBox')){var h=s.getBBox();s.setAttribute('viewBox',[h.x,h.y,h.width,h.height].join(' '));}f.addClass(c+'list-icon');s.setAttribute('fill',this.color());g.click($.proxy(this._iconListClickHandler,this));}this._addEventListeners();$(document).on('mousedown',this._mdHandler);$(window).on('blur',this._mdHandler);};I.prototype._iconListClickHandler=function(e){var d=$(e.currentTarget);var f=d.data('icon');this.icon(f);this._destroyList();};I.prototype._arrowClickHandler=function(e){if(this._list$!==null){this._destroyList();return;}this._createIconList();};I.prototype._destroyList=function(){$(document).off('mousedown',this._mdHandler);$(window).off('blur',this._mdHandler);$(window).off('resize',this._resizeHandler);this._list$.empty().detach();this._list$=null;};I.prototype._locate=function(){if(!!this._list$){var o;if(!!this._container$){o=this._container$.offset();}else{o=this._dom$.children().offset();}this._list$.css({position:'absolute',top:o.top+2,left:o.left});}};I.prototype._resizer=function(e){if(!e.data.invalidateSize){setTimeout($.proxy(function(){e.data.invalidateSize=false;this._locate();},this),1000/24);}e.data.invalidateSize=true;};I.prototype._addEventListeners=function(){this._resizeHandler=$.proxy(this._resizer,this);$(window).resize({'invalidateSize':false},this._resizeHandler);};I.prototype._mousedownHandler=function(e){if(this._list$!==null&&this._list$.css('visibility')=='visible'&&$(e.target).closest(this._list$).length<=0&&e.target!==this._arrow$[0]){this._destroyList();}};I.prototype._applyDefaultIcon=function(){var i,d;for(i=0;i<this._icons.length;i++){d=this._icons[i];if(this._icon===d.svg){this._applyIcon();break;}}};return I;});u('sap/viz/controls/propertyeditor/sections/views/CategoryAxisView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/SwitchPicker','sap/viz/controls/propertyeditor/utils/PropertyUtil','sap/viz/controls/propertyeditor/pickers/FontPicker','sap/viz/controls/propertyeditor/pickers/IconPicker','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(C,L,O,a,I,b,P,S,c,F,d,e,f){var g=function(){g.superclass.constructor.apply(this,arguments);this._axisSize=0;this._defaultIcon=this._uiConfig.icons[0].svg;this._axisName=a.getCategoryAxis(this._vizProxy.getType())[0];this._axisVisibleProperty="categoryAxis.visible";this._axisLineVisibleProperty='categoryAxis.axisLine.visible';this._axisTickVisibleProperty="categoryAxis.axisTick.visible";this._axisLabelVisibleProperty='textVisible';var h=a.getDirection(I.getVizType(this._vizProxy.getType()));if(h===b.DIRECTION_HORIZONTAL){this._axisSizeProperty="categoryAxis.layout.maxWidth";}else{this._axisSizeProperty="categoryAxis.layout.maxHeight";}this._axisImageProperty="iconSVG";this._axisImageColorProperty="iconColor";this._axisImageSizeProperty='iconSize';this._axisImageVisibleProperty="iconVisible";this._axisDefaultSize=0.25;this._axisDefaultImageSize=0.5;this._createChildren();};O.extend(g,P);g.prototype.destroy=function(){g.superclass.destroy.apply(this,arguments);if(this._axisImageSize){this._axisImageSize.destroy();}this._axisImageSize=null;};g.prototype._createChildren=function(){var p=this._initialProperties();if(p){var h=this._createItemRow(1,C.PROPERTYEDITOR_PREFIX+'view-item-row');var v=p[this._axisLineVisibleProperty]!==false;this._axisLineVisible=new S($(h.children()[0]),v,{text:L.get('PROPERTY_EDITOR_SHOW_AXIS_LINE')});var k=true;this._axisLineVisible.enabled(k);var l=this._createItemRow(1,C.PROPERTYEDITOR_PREFIX+'view-item-row');if(p[this._axisLabelVisibleProperty]===null){v=null;}else{v=p[this._axisLabelVisibleProperty]!==false;}v=c.propertyToToggle(v);this._axisLabelVisible=new sap.ui.commons.TriStateCheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_AXIS_LABEL'),});this._axisLabelVisible.toggle(v);this._axisLabelVisible.placeAt($(l.children()[0]));this._axisLabelVisible.attachChange($.proxy(this._showHideAxisLabel,this));l=this._createItemRow(1,C.PROPERTYEDITOR_PREFIX+'view-item-indent1');l.addClass(C.PROPERTYEDITOR_PREFIX+'fontpicker');this._axisLabelFont=new F($(l.children()[0]),{'fontFamily':p['fontFamily'],'fontSize':p['fontSize'],'fontWeight':p['fontWeight'],'fontColor':p['fontColor'],'fontStyle':p['fontStyle']});this._axisLabelFontContainer$=l;if(v!=="Unchecked"){this._axisLabelFontContainer$.show();}else{this._axisLabelFontContainer$.hide();}var m=this._createItemRow(1,C.PROPERTYEDITOR_PREFIX+'view-item-row');var n=p[this._axisImageProperty];var o=p[this._axisImageColorProperty];var q=p[this._axisImageVisibleProperty];if(q===null){v=null;}else{v=q?q:false;}v=c.propertyToToggle(v);this._axisImageVisible=new sap.ui.commons.TriStateCheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_AXIS_IMAGE'),});this._axisImageVisible.toggle(v);this._axisImageVisible.placeAt($(m.children()[0]));this._axisImageVisible.attachChange($.proxy(this._showHideAxisImage,this));m=this._axisImageRow$=this._createItemRow(2,C.PROPERTYEDITOR_PREFIX+'view-item-indent1');this._axisImage=new d($(m.children()[0]),n,{'icons':this._uiConfig.icons});this._axisImageColor=new e($(m.children()[1]),o,{'mode':'fill'});this._axisImageSize$=this._createItemRow(2,C.PROPERTYEDITOR_PREFIX+'view-item-indent1');this._axisImageSize$.css({'height':'auto'});var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_SIZE_OF_ALL_IMAGES')});t.placeAt(this._axisImageSize$.children()[0]);var r=(p[this._axisImageSizeProperty]!==undefined&&p[this._axisImageSizeProperty]!==null)?p[this._axisImageSizeProperty]:this._axisDefaultImageSize;this._axisImageSize=new sap.ui.commons.Slider({min:0,max:1,value:r,width:'154px',smallStepWidth:0.01,liveChange:$.proxy(function(w){this._changeAxisImageSize(w.getParameters().value);},this)});this._axisImageSize.placeAt($(this._axisImageSize$.children()[1]).addClass(C.PROPERTYEDITOR_PREFIX+'views-slider-container '+C.PROPERTYEDITOR_PREFIX+'view-item-padding-bottom'));this._showImagePickers(v!=='Unchecked');this._axisLineVisible.addEventListener(f.PICKED_ITEM_CHANGED,this._showHideAxisLine,this);this._axisLabelFont.addEventListener(f.PICKED_ITEM_CHANGED,this._changeAxisLabelFont,this);this._axisImage.addEventListener(f.PICKED_ITEM_CHANGED,this._changeAxisImage,this);this._axisImageColor.addEventListener(f.PICKED_ITEM_CHANGED,this._changeAxisImageColor,this);if(p.textVisible===undefined||p.iconVisible===undefined){var s=this._getPickerProps(['showDataLabel','fontPicker','showDataLabelImage','imageIcon','imageColor','imageSizeSlider']);this._updateProperties(s);}}};g.prototype._createItemRow=function(h,k){var i,l,m;l=$(document.createElement('div'));if(k){l.addClass(k);}for(i=0;i<h;i++){m=$(document.createElement('div'));if(i===0){m.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell-wrap');}else{m.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');}m.appendTo(l);}l.appendTo(this._dom$);return l;};g.prototype._initialProperties=function(){var o={};o[this._axisLineVisibleProperty]=true;o[this._axisLabelVisibleProperty]=true;o[this._axisSizeProperty]=true;o[this._axisImageProperty]=true;o[this._axisImageColorProperty]=true;o[this._axisImageSizeProperty]=true;o[this._axisImageVisibleProperty]=true;o['fontFamily']=true;o['fontSize']=true;o['fontWeight']=true;o['fontColor']=true;o['fontStyle']=true;return this._queryProperties(o);};g.prototype._changeAxisImageSize=function(v){var o={};o[this._axisImageSizeProperty]=v;this._updateProperties(o,false,true);};g.prototype._showHideAxisLine=function(h){var v=h.data.pickedItem;var o={};o[this._axisLineVisibleProperty]=v;o[this._axisTickVisibleProperty]=v;this._updateProperties(o);};g.prototype._showHideAxisLabel=function(h){var v=this._axisLabelVisible.getSelectionState();if(v!=="Unchecked"){this._axisLabelFontContainer$.show();}else{this._axisLabelFontContainer$.hide();}var o={};o[this._axisLabelVisibleProperty]=v!=="Unchecked"?undefined:false;this._updateProperties(o);};g.prototype._changeAxisLabelFont=function(h){var p=h.data.changedItem;this._updateProperties(p);};g.prototype._showHideAxisImage=function(h){var v=this._axisImageVisible.getSelectionState();var o={};o[this._axisImageProperty]=this._axisImage.icon();o[this._axisImageColorProperty]=this._axisImageColor.pickedItem();o[this._axisImageSizeProperty]=this._axisImageSize?this._axisImageSize.getValue():this._axisDefaultImageSize;o[this._axisImageVisibleProperty]=(v!=='Unchecked');o[this._axisSizeProperty]=v!=='Unchecked'?0.5:0.25;this._showImagePickers(v!=='Unchecked');this._updateProperties(o);};g.prototype._changeAxisImage=function(h){var k=h.data.pickedItem;var o={};o[this._axisImageProperty]=k;this._updateProperties(o);};g.prototype._changeAxisImageColor=function(h){var k=h.data.pickedItem;var o={};o[this._axisImageColorProperty]=k;this._updateProperties(o);};g.prototype._showImagePickers=function(v){if(this._axisImageRow$){v?this._axisImageRow$.show():this._axisImageRow$.hide();}if(this._axisImageSize$){v?this._axisImageSize$.show():this._axisImageSize$.hide();}};g.prototype._getPickerProps=function(p){var h={};for(var i in p){switch(p[i]){case'showAxisLine':if(this._axisLineVisible){h[this._axisLineVisibleProperty]=h[this._axisTickVisibleProperty]=this._axisLineVisible.pickedItem();}break;case'showDataLabel':if(this._axisLabelVisible){if(this._axisLabelVisible.getSelectionState()==='Checked'){h['textVisible']=true;}else if(this._axisLabelVisible.getSelectionState()==='Unchecked'){h['textVisible']=false;}}break;case'fontPicker':if(this._axisLabelFont){h['fontFamily']=this._axisLabelFont.pickedItem()['fontFamily'];h['fontSize']=this._axisLabelFont.pickedItem()['fontSize'];h['fontWeight']=this._axisLabelFont.pickedItem()['fontWeight'];h['fontColor']=this._axisLabelFont.pickedItem()['fontColor'];h['fontStyle']=this._axisLabelFont.pickedItem()['fontStyle'];}break;case'showDataLabelImage':if(this._axisImageVisible){if(this._axisImageVisible.getSelectionState()==='Checked'){h['iconVisible']=true;}else if(this._axisImageVisible.getSelectionState()==='Unchecked'){h['iconVisible']=false;}}break;case'imageIcon':if(this._axisImage){h['iconSVG']=this._axisImage.icon();}break;case'imageColor':if(this._axisImageColor){h['iconColor']=this._axisImageColor.pickedItem();}break;case'imageSizeSlider':if(this._axisImageSize){h['iconSize']=this._axisImageSize.getValue();}break;}}return h;};g.prototype._mergeLayoutProperties=function(p,l){if(p&&l){for(var h in l){p[h]=l[h];}}};return g;});u('sap/viz/controls/propertyeditor/sections/helpers/ChartAreaViewHelper',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/sections/helpers/ViewHelperBase'],function(O,C,L,V){var a=function(c,t){a.superclass.constructor.apply(this,arguments);};O.extend(a,V);a.prototype.createLayout=function(){var l=$(document.createElement('div')).appendTo(this._target.dom$);l.addClass(C.PROPERTYEDITOR_PREFIX+'title-text');l.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');var b=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_LAYOUT')});b.placeAt(l);var c=$(document.createElement('div')).appendTo(this._target.dom$);c.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row '+C.PROPERTYEDITOR_PREFIX+'linestyle');var d=$(document.createElement('div')).appendTo(c);d.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');d.addClass(C.PROPERTYEDITOR_PREFIX+'chartarea-layoutbtn');var e=new sap.ui.commons.Button({'text':L.get('PROPERTY_EDITOR_CLASSIC_LAYOUT'),'press':$.proxy(this._classicBtnPress,this),'styled':false,'width':"100px"});e.placeAt(d);var f=$(document.createElement('div')).appendTo(c);f.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');f.addClass(C.PROPERTYEDITOR_PREFIX+'chartarea-layoutbtn');var g=new sap.ui.commons.Button({'text':L.get('PROPERTY_EDITOR_LEAN_LAYOUT'),'press':$.proxy(this._leanBtnPress,this),'styled':false,'width':"100px"});g.placeAt(f);};a.prototype._classicBtnPress=function(e){var p={title:{visible:true},legend:{visible:true},valueAxis:{title:{visible:true}},valueAxis2:{title:{visible:true}},categoryAxis:{title:{visible:true}},categoryAxis2:{title:{visible:true}}};this._target.proxy.setProperties(p);};a.prototype._leanBtnPress=function(e){var p={title:{visible:false},legend:{visible:false},valueAxis:{title:{visible:false}},valueAxis2:{title:{visible:false}},categoryAxis:{title:{visible:false}},categoryAxis2:{title:{visible:false}}};this._target.proxy.setProperties(p);};return a;});u('sap/viz/controls/propertyeditor/sections/views/ChartAreaView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/spin/Spin','sap/viz/controls/propertyeditor/sections/helpers/ChartAreaViewHelper'],function(C,L,O,P,a,b,S,c){var d=function(e,v,p){d.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren();};O.extend(d,P);d.prototype._createChildren=function(){this._helper=this._createHelper(c,{});var e=$(document.createElement('div')).appendTo(this._dom$);e.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_BACKGROUND_COLOR')});t.placeAt(e);var f=$(document.createElement('div')).appendTo(this._dom$);var g=this._colorPicker=new a(f,this._queryProperty('fill'),{'mode':'fill'});this._colorPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._pickerChangedHandler,this);var s=this._vizProxy.getSize();};d.prototype._pickerChangedHandler=function(e){var f=e.data.pickedItem;var o={'fill':f};this._updateProperties(o);};d.prototype._heightChangedHandler=function(e){var s=this._vizProxy.getSize();var h=parseFloat(e.data.value);if(h!=s.height){this._vizProxy.setSize({'height':h,'width':s.width});}};d.prototype._widthChangedHandler=function(e){var s=this._vizProxy.getSize();var w=parseFloat(e.data.value);if(w!=s.width){this._vizProxy.setSize({'height':s.height,'width':w});}};d.prototype._propertyChangedHandler=function(e){if(this._heightSpin&&this._widthSpin){var s=this._vizProxy.getSize();if(s.height!=this._heightSpin.getValue()){this._heightSpin.updateUI(s.height);}if(s.width!=this._widthSpin.getValue()){this._widthSpin.updateUI(s.width);}}};return d;});u('sap/viz/controls/propertyeditor/sections/views/ChartTitleView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/sections/helpers/TextViewHelper'],function(O,L,P,T){var C=function(d,v,p){C.superclass.constructor.apply(this,arguments);this._createChildren();};O.extend(C,P);C.prototype._createChildren=function(){var h=this._createHelper(T,{'visible':{'text':L.get('PROPERTY_EDITOR_SHOW_CHART_TITLE'),'propertyField':'title.visible','updateLayout':$.proxy(this._updateLayout,this)}});};C.prototype._updateLayout=function(v){if(v){this._updateProperty("title.layout.maxHeight",0.1);}else{this._updateProperty("title.layout.maxHeight",0);}};return C;});u('sap/viz/controls/propertyeditor/pickers/ThicknessPicker',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/pickers/PickerBase'],function(C,O,P){var T=function(d,p,b){T.superclass.constructor.apply(this,arguments);b=this._config||{};this._color=b.color?b.color:'rgb(0,0,0)';this._lineSize=this._pickedItem;this._createChildren();this._list$=null;this._mdHandler=$.proxy(this._mousedownHandler,this);};O.extend(T,P);var c=C.PROPERTYEDITOR_PREFIX+'thicknesspicker-';var a=C.COMMON_PREFIX;var l=[{'thickness':1},{'thickness':2},{'thickness':3},{'thickness':4},{'thickness':5},{'thickness':6}];T.prototype._createChildren=function(){this._container$=$(document.createElement('div')).appendTo(this._dom$);this._container$.addClass('sapUiTfBrd sapUiTfStd  sapUiTfCombo '+c+'container');this._line$=$(document.createElement('div')).appendTo(this._container$);this._line$.addClass(c+'line');this._line$.click($.proxy(this._arrowClickHandler,this));this._arrow$=$(document.createElement('div')).appendTo(this._container$);this._arrow$.addClass('sapUiTfComboIcon');this._arrow$.click($.proxy(this._arrowClickHandler,this));this._applyLine();};T.prototype._createLineList=function(){this._list$=$(document.createElement('div')).appendTo($('body'));this._list$.addClass(c+'list');this._locate();var _=$(document.createElement('ul')).appendTo(this._list$);var i,b,d,e,f,g,h,p,k,m,n;for(i=0;i<l.length;i++){b=l[i];li$=$(document.createElement('li')).appendTo(_);li$.data('line',b.thickness);e=$(document.createElement('div')).appendTo(li$);g=$(document.createElement('div')).addClass(c+'list-line-container').appendTo(e);f=$(document.createElement('div')).css({'margin-top':(20-b.thickness)/2+'px','background-color':this._color,'height':b.thickness+'pt'}).appendTo(g);if(b.thickness==this._lineSize){g.removeClass(c+'list-line-container');g.addClass(c+'list-line-container-selected');}li$.click($.proxy(this._lineListClickHandler,this));}$(document).on('mousedown',this._mdHandler);$(window).on('blur',this._mdHandler);};T.prototype._locate=function(){if(!!this._list$){var o;if(!!this._container$){o=this._container$.offset();}else{o=this._dom$.children().offset();}this._list$.css({position:'absolute',top:o.top+2,left:o.left});}};T.prototype._resizer=function(e){if(!e.data.invalidateSize){setTimeout($.proxy(function(){e.data.invalidateSize=false;this._locate();},this),1000/24);}e.data.invalidateSize=true;};T.prototype._arrowClickHandler=function(e){if(this._list$!==null){this._destroyList();return;}this._createLineList();};T.prototype._lineListClickHandler=function(e){var b=$(e.currentTarget);var d=b.data('line');this.lineSize(d);this._destroyList();};T.prototype.color=function(b){if(arguments.length>0){this._color=b;this._applyColor();return this;}else{return this._color;}};T.prototype._applyColor=function(){$('div.'+c+'list-line').css('background-color',this._color);};T.prototype.lineSize=function(s){if(arguments.length>0){if(this._lineSize!==s){this._lineSize=s;this._applyLine();this._changePickedItem(this._lineSize);}return this;}else{return this._lineSize;}};T.prototype._applyLine=function(){this._line$.empty();var b=$(document.createElement('div')).css({'margin-top':(20-this._lineSize)/2+'px','background-color':this._color,'height':this._lineSize+'pt'}).addClass(c+'list-line').appendTo(this._line$);};T.prototype._mousedownHandler=function(e){if(this._list$!==null&&this._list$.css('visibility')=='visible'&&$(e.target).closest(this._list$).length<=0&&e.target!==this._arrow$[0]){this._destroyList();}};T.prototype.destroy=function(){T.superclass.destroy.apply(this,arguments);if(this._list$!==null){this._destroyList();}this._line$.empty().detach();this._line$=null;this._arrow$.empty().detach();this._arrow$=null;this._container$.empty().detach();this._container$=null;};T.prototype._destroyList=function(){$(document).off('mousedown',this._mdHandler);$(window).off('blur',this._mdHandler);this._list$.empty().detach();this._list$=null;};return T;});u('sap/viz/controls/propertyeditor/sections/views/PlotAreaView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/ThicknessPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(C,L,O,P,a,T,b){var c=function(d,v,p){c.superclass.constructor.apply(this,arguments);this._createChildren();};O.extend(c,P);c.prototype._createChildren=function(){var g=this._initialProperties();var d=$(document.createElement('div')).appendTo(this._dom$);d.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_BACKGROUND_COLOR')});t.placeAt(d);var e=$(document.createElement('div')).appendTo(this._dom$);var f=this._colorPicker=new a(e,this._queryProperty('fill'),{'mode':'fill'});this._colorPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._pickerChangedHandler,this);d=$(document.createElement('div')).appendTo(this._dom$);d.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');var s=g["plotArea.gridline.visible"]!==false;var h=this._showGridLineChb=new sap.ui.commons.CheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_GRIDLINE'),'checked':s,'change':$.proxy(function(m){this._showGridLine(m.getParameters().checked);},this)});h.placeAt(d);d=this._thicknessContainer$=$(document.createElement('div')).appendTo(this._dom$);d.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');var k=$(document.createElement('div')).appendTo(d).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');this._thicknessPicker=new T(k,g["plotArea.gridline.size"]);this._thicknessPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._thicknessChangeHandler,this);var l=$(document.createElement('div')).appendTo(d).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');this._tcPicker=new a(l,g["plotArea.gridline.color"]);this._tcPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._tcPickerChangedHandler,this);s?this._thicknessContainer$.show():this._thicknessContainer$.hide();};c.prototype._initialProperties=function(){var o={"plotArea.gridline.visible":true,"plotArea.gridline.color":true,"plotArea.gridline.size":true};return this._queryProperties(o);};c.prototype._showGridLine=function(v){if(v){this._thicknessContainer$.show();}else{this._thicknessContainer$.hide();}var o={"plotArea.gridline.visible":v};this._updateProperties(o);};c.prototype._tcPickerChangedHandler=function(e){var d=e.data.pickedItem;var o={"plotArea.gridline.color":e.data.pickedItem};this._updateProperties(o);};c.prototype._thicknessChangeHandler=function(e){var s=e.data.pickedItem;var o={"plotArea.gridline.size":s};this._updateProperties(o);};c.prototype._pickerChangedHandler=function(e){var d=e.data.pickedItem;var o={'fill':d};this._updateProperties(o);};return c;});u('sap/viz/controls/propertyeditor/sections/views/DonutPlotAreaView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(C,L,O,P,a,b){var D=function(d,v,p){D.superclass.constructor.apply(this,arguments);this._createChildren();};O.extend(D,P);D.prototype._createChildren=function(){var c=$(document.createElement('div')).appendTo(this._dom$);c.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_BACKGROUND_COLOR')});t.placeAt(c);var d=$(document.createElement('div')).appendTo(this._dom$);var e=this._colorPicker=new a(d,this._queryProperty('fill'),{'mode':'fill'});this._colorPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._pickerChangedHandler,this);};D.prototype._pickerChangedHandler=function(e){var c=e.data.pickedItem;var o={'fill':c};this._updateProperties(o);};return D;});u('sap/viz/controls/propertyeditor/sections/views/LegendView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/pickers/FontPicker','sap/viz/controls/propertyeditor/sections/PropertyViewBase'],function(C,L,O,P,F,a){var b=function(d,v,p){b.superclass.constructor.apply(this,arguments);this._showLegendChb=null;this._fontPicker=null;this._showLegendTitleChb=null;this._titleFontPicker=null;this._createChildren();this._legendPosition='right';};O.extend(b,a);b.prototype._createChildren=function(){var l=this._initialProperties();if(l){this._legendPosition=l['legendGroup.layout.position'];var c=$(document.createElement('div')).appendTo(this._dom$);c.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');var s=l['legend.visible']!==false;var d=this._showLegendChb=new sap.ui.commons.CheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_LEGEND'),'checked':s,'change':$.proxy(function(f){this._showLegend(f.getParameters().checked);},this)});d.placeAt(c);c=this._fontPicker$=$(document.createElement('div')).appendTo(this._dom$);c.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');this._fontPicker=new F(c.get(0),{'fontFamily':l['fontFamily'],'fontSize':l['fontSize'],'fontWeight':l['fontWeight'],'fontColor':l['fontColor'],'fontStyle':l['fontStyle']});this._fontPicker.addEventListener(P.PICKED_ITEM_CHANGED,this._fontPickerChangedHandler,this);this._fontPicker.visible(s);c=this._showLegendTitle$=$(document.createElement('div')).appendTo(this._dom$);c.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');var e=l['legend.title.visible']!==false;d=this._showLegendTitleChb=new sap.ui.commons.CheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_LEGEND_TITLE'),'checked':e,'change':$.proxy(function(f){this._showLegendTitle(f.getParameters().checked);},this)});d.setVisible(s);d.placeAt(c);c=this._titleFontPicker$=$(document.createElement('div')).appendTo(this._dom$);c.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent2');this._titleFontPicker=new F(c.get(0),{'fontFamily':l['title-fontFamily'],'fontSize':l['title-fontSize'],'fontWeight':l['title-fontWeight'],'fontColor':l['title-fontColor'],'fontStyle':l['title-fontStyle']});this._titleFontPicker.addEventListener(P.PICKED_ITEM_CHANGED,this._titleFontPickerChangedHandler,this);this._titleFontPicker.visible(s&&l['legend.title.visible']!==false);}};b.prototype._initialProperties=function(){var o={'legendGroup.layout.position':true,'legend.visible':true,'fontFamily':true,'fontSize':true,'fontWeight':true,'fontColor':true,'fontStyle':true,'legend.title.visible':true,'title-fontFamily':true,'title-fontSize':true,'title-fontWeight':true,'title-fontColor':true,'title-fontStyle':true};return this._queryProperties(o);};b.prototype._showLegend=function(v){if(v){this._fontPicker$.show();this._showLegendTitle$.show();}else{this._fontPicker$.hide();this._showLegendTitle$.hide();}this._showLegendTitleChb.setVisible(v);this._titleFontPicker.visible(v&&this._showLegendTitleChb.getChecked());var o={'legend.visible':v};if(v){if(this._legendPosition=='right'||this._legendPosition=='left'){o['legendGroup.layout.maxWidth']=0.2;o['legendGroup.layout.maxHeight']=null;}else{o['legendGroup.layout.maxWidth']=null;o['legendGroup.layout.maxHeight']=0.2;}}else{if(this._legendPosition=='right'||this._legendPosition=='left'){o['legendGroup.layout.maxWidth']=0;o['legendGroup.layout.maxHeight']=null;}else{o['legendGroup.layout.maxWidth']=null;o['legendGroup.layout.maxHeight']=0;}}this._updateProperties(o);};b.prototype._showLegendTitle=function(v){v?this._titleFontPicker$.show():this._titleFontPicker$.hide();this._updateProperties({'legend.title.visible':v});};b.prototype._fontPickerChangedHandler=function(e){this._updateProperties(e.data.changedItem);};b.prototype._titleFontPickerChangedHandler=function(e){var p={};var c=e.data.changedItem;if(c.fontFamily){p['title-fontFamily']=c['fontFamily'];}if(c.fontSize){p['title-fontSize']=c['fontSize'];}if(c.fontWeight){p['title-fontWeight']=c['fontWeight'];}if(c.fontColor){p['title-fontColor']=c['fontColor'];}if(c.fontStyle){p['title-fontStyle']=c['fontStyle'];}this._updateProperties(p);};return b;});u('sap/viz/controls/propertyeditor/sections/views/ValueAxisView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/SwitchPicker','sap/viz/controls/propertyeditor/pickers/FontPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/constants/ChartConst'],function(O,C,L,P,S,F,a,b,I,c){var V=function(d,e,v,p){V.superclass.constructor.apply(this,arguments);this._valueAxisScaleEditor=null;this._axisLineVisible=null;this._axisLabelVisible=null;this._axisLabelFont=null;this._axisTitleVisible=true;this._axisName=b.getValueAxis(this._vizProxy.getType())[0];this._axisVisibleProperty="valueAxis.visible";var f=b.getDirection(I.getVizType(this._vizProxy.getType()));if(f===c.DIRECTION_VERTICAL){this._axisSizeProperty="valueAxis.layout.maxWidth";}else{this._axisSizeProperty="valueAxis.layout.maxHeight";}this._axisLineVisibleProperty="valueAxis.axisLine.visible";this._axisTitleVisibleProperty="valueAxis.title.visible";this._axisLabelVisibleProperty="valueAxis.label.visible";this._axisTickVisibleProperty="valueAxis.axisTick.visible";this._axisDefaultSize=0.15;this._valueScaleMaxProperty="plotArea.primaryScale.maxValue";this._valueScaleMinProperty="plotArea.primaryScale.minValue";this._valueScaleAutoMaxProperty="plotArea.primaryScale.autoMaxValue";this._valueScaleAutoMinProperty="plotArea.primaryScale.autoMinValue";this._valueScaleFixedRangeProperty="plotArea.primaryScale.fixedRange";this._createChildren();};O.extend(V,P);V.prototype.destroy=function(){V.superclass.destroy.apply(this,arguments);if(this._valueScaleSlider){this._valueScaleSlider.destroy();}this._valueScaleSlider=null;};V.prototype._createChildren=function(){var d=this._initialProperties();if(d){var m=this;this._axisTitleVisible=d[this._axisTitleVisibleProperty];var e=$(document.createElement('div')).appendTo(this._dom$);e.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');var f=this._axisLineVisible=new sap.ui.commons.CheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_AXIS_LINE'),'checked':d[this._axisLineVisibleProperty],'change':$.proxy(function(w){m._showLineTick(w.getParameters().checked);},this)});f.placeAt(e);e=$(document.createElement('div')).appendTo(this._dom$);e.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var s=d[this._axisLabelVisibleProperty];var f=this._axisLabelVisible=new sap.ui.commons.CheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_AXIS_LABEL'),'checked':s,'change':$.proxy(function(w){m._showLabel(w.getParameters().checked);},this)});f.placeAt(e);e=$(document.createElement('div')).appendTo(this._dom$);e.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');var g=this._axisLabelFont=new F(e.get(0),{'fontFamily':d['fontFamily'],'fontSize':d['fontSize'],'fontWeight':d['fontWeight'],'fontColor':d['fontColor'],'fontStyle':d['fontStyle']});g.addEventListener(a.PICKED_ITEM_CHANGED,this._fontPickerChangedHandler,this);g.visible(s);var v=this._createItemRow(2,C.PROPERTYEDITOR_PREFIX+'view-item').css({'height':'auto'});var h=$(document.createElement('div')).appendTo(this._dom$).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell-wrap');var k=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_AXIS_VALUE_SCALE')});k.placeAt(v.children()[0]);var l=this._queryProperty(this._valueScaleFixedRangeProperty);var n=this._getFixedValueScale();var o=this._getAutoValueScale();var p,q;if(l&&n.max!==null){p=n.max;}else{p=o.max;}if(l&&n.min!==null){q=n.min;}else{q=o.min;}var r=p/o.max;r=Math.max(1,Math.min(r,2));var t=$(document.createElement('div')).appendTo(this._dom$).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');this._valueScaleSlider=new sap.ui.commons.Slider({'max':2,'min':1,'smallStepWidth':0.01,'value':r,'width':'154px','liveChange':$.proxy(function(E){m._valueScaleSliderChangedHandler(E);},m)});this._valueScaleSlider.placeAt($(v.children()[1]).addClass(C.PROPERTYEDITOR_PREFIX+'views-slider-container'));}};V.prototype._createItemRow=function(d,e){var i,f,g;f=$('<div/>');if(e){f.addClass(e);}for(i=0;i<d;i++){g=$('<div/>');if(i===0){g.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell-wrap');}else{g.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');}g.appendTo(f);}f.appendTo(this._dom$);return f;};V.prototype._valueScaleSliderChangedHandler=function(e){var r=parseFloat(e.oSource.getValue());var p={};var d=this._getAutoValueScale();p[this._valueScaleMaxProperty]=Math.round(d.max*r*100)/100;if(d.max*d.min<0){p[this._valueScaleMinProperty]=Math.round(d.min*r*100)/100;}p[this._valueScaleFixedRangeProperty]=true;this._updateProperties(p);};V.prototype._getAutoValueScale=function(){var m=this._queryProperty(this._valueScaleAutoMaxProperty);var d=this._queryProperty(this._valueScaleAutoMinProperty);return{max:m,min:d};};V.prototype._getFixedValueScale=function(){var m=this._queryProperty(this._valueScaleMaxProperty);var d=this._queryProperty(this._valueScaleMinProperty);return{max:m,min:d};};V.prototype._initialProperties=function(){var o={"plotArea.primaryScale.maxValue":true};o[this._axisLineVisibleProperty]=true;o[this._axisTitleVisibleProperty]=true;o[this._axisLabelVisibleProperty]=true;o[this._axisTickVisibleProperty]=true;o['fontFamily']=true;o['fontSize']=true;o['fontWeight']=true;o['fontColor']=true;o['fontStyle']=true;return this._queryProperties(o);};V.prototype._showLineTick=function(v){var o={};o[this._axisLineVisibleProperty]=v;o[this._axisTickVisibleProperty]=v;this._updateProperties(o);};V.prototype._showLabel=function(v){this._axisLabelFont.visible(v);if(v){this._axisLabelFont._dom$.show();}else{this._axisLabelFont._dom$.hide();}var o={};o[this._axisLabelVisibleProperty]=v;this._updateProperties(o);};V.prototype._fontPickerChangedHandler=function(e){var p=e.data.changedItem;this._updateProperties(p);};V.prototype._mergeLayoutProperties=function(p,l){if(p&&l){for(var d in l){p[d]=l[d];}}};return V;});u('sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/FontPicker','sap/viz/controls/propertyeditor/pickers/IconPicker','sap/viz/controls/propertyeditor/utils/PropertyUtil','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/sections/helpers/ViewHelperBase','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/constants/ChartConst'],function(C,L,O,a,F,I,P,b,V,c,d){var D=function(f,t){D.superclass.constructor.apply(this,arguments);this._createChildren();};var e=1.2;O.extend(D,V);D.prototype._createChildren=function(){var p=this._initProperties();if(p){if(this._config.showDataLabel===true){var s=$(document.createElement('div')).appendTo(this._target.dom$);s.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');var t=p['textVisible'];var f=p['dataLabelVisible'];var g=(t===undefined)?f:t;g=P.propertyToToggle(g);this._showDataLabel=new sap.ui.commons.TriStateCheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_DATA_LABEL'),});this._showDataLabel.toggle(g);this._showDataLabel.placeAt(s);this._showDataLabel.attachChange($.proxy(this._showDataLabelChangedHandler,this));var h=this._fontPicker$=$(document.createElement('div')).appendTo(this._target.dom$);h.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');this._fontPicker=new F(h.get(0),{'fontFamily':p['fontFamily'],'fontSize':p['fontSize'],'fontWeight':p['fontWeight'],'fontColor':p['fontColor'],'fontStyle':p['fontStyle']});this._fontPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._fontPickerChangedHandler,this);this._showFontPicker(g!=='Unchecked');}if(this._config.showDataLabelImage===true){var k=$(document.createElement('div')).appendTo(this._target.dom$);k.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var l=p['iconVisible'];l=P.propertyToToggle(l);this._showDataLabelImage=new sap.ui.commons.TriStateCheckBox({'text':L.get('PROPERTY_EDITOR_SHOW_DATA_LABEL_IMAGE'),});this._showDataLabelImage.toggle(l);this._showDataLabelImage.placeAt(k);this._showDataLabelImage.attachChange($.proxy(this._showDataLabelImageChangedHandler,this));var m=this._createItemRow(2,C.PROPERTYEDITOR_PREFIX+'view-item-indent1');this._imageIconAndColor$=m;var n=$(m.children()[0]);var o=p['iconSVG'];var q=p['iconColor'];this._imageIcon=new I(n,o,{'icons':this._target.view._uiConfig.icons});this._imageIcon.addEventListener(b.PICKED_ITEM_CHANGED,this._imageIconChangedHandler,this);var r=$(m.children()[1]);this._imageColor=new a(r,q,{'mode':'fill'});this._imageColor.addEventListener(b.PICKED_ITEM_CHANGED,this._imageColorChangedHandler,this);var v=this._imageSize$=$(document.createElement('div'));v.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1').css({'height':'auto'});v.appendTo(this._target.dom$);var w=$(document.createElement('div'));w.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');w.appendTo(v);var x=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_DATA_LABEL_IMAGE_SIZE')});x.placeAt(w);var y=$(document.createElement('div')).appendTo(v);y.addClass(C.PROPERTYEDITOR_PREFIX+'views-slider-container');var z=(p['iconSize']!==undefined&&p['iconSize']!==null)?p['iconSize']:0.8;this._imageSizeSlider=new sap.ui.commons.Slider({'max':1,'min':0,'smallStepWidth':0.01,'value':z,'width':'154px','liveChange':$.proxy(function(G){this._imageSizeSliderChangedHandler(G);},this)});this._imageSizeSlider.placeAt(y);this._showImagePickers(l!=='Unchecked');}if(p.textVisible===undefined||p.iconVisible===undefined){var E=this._getPickerProps(['showDataLabel','fontPicker','showDataLabelImage','imageIcon','imageColor','imageSizeSlider']);this._target.updateProperties(E);}}};D.prototype._initProperties=function(){var p={'dataLabelVisible':true,'textVisible':true,'fontFamily':true,'fontSize':true,'fontWeight':true,'fontColor':true,'fontStyle':true,'iconVisible':true,'iconSVG':true,'iconColor':true,'iconSize':true};return this._target.queryProperties(p);};D.prototype._createItemRow=function(f,g){var h=$(document.createElement('div'));if(g){h.addClass(g);}for(var i=0;i<f;i++){var k=$(document.createElement('div'));if(i===0){k.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell-wrap');}else{k.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');}k.appendTo(h);}h.appendTo(this._target.dom$);return h;};D.prototype._addItemToComboBox=function(f,g){for(var i in g){f.addItem(new sap.ui.core.ListItem({'key':g[i].key,'text':g[i].text}));}};D.prototype._getPickerProps=function(p){var f={};for(var i in p){switch(p[i]){case'showDataLabel':if(this._showDataLabel){if(this._showDataLabel.getSelectionState()==='Checked'){f['textVisible']=true;}else if(this._showDataLabel.getSelectionState()==='Unchecked'){f['textVisible']=false;}}break;case'fontPicker':if(this._fontPicker){f['fontFamily']=this._fontPicker.pickedItem()['fontFamily'];f['fontSize']=this._fontPicker.pickedItem()['fontSize'];f['fontWeight']=this._fontPicker.pickedItem()['fontWeight'];f['fontColor']=this._fontPicker.pickedItem()['fontColor'];f['fontStyle']=this._fontPicker.pickedItem()['fontStyle'];}break;case'showDataLabelImage':if(this._showDataLabelImage){if(this._showDataLabelImage.getSelectionState()==='Checked'){f['iconVisible']=true;}else if(this._showDataLabelImage.getSelectionState()==='Unchecked'){f['iconVisible']=false;}}break;case'imageIcon':if(this._imageIcon){f['iconSVG']=this._imageIcon.icon();}break;case'imageColor':if(this._imageColor){f['iconColor']=this._imageColor.pickedItem();}break;case'imageSizeSlider':if(this._imageSizeSlider){f['iconSize']=this._imageSizeSlider.getValue();}break;}}return f;};D.prototype._showFontPicker=function(v){if(this._fontPicker$){v!==false?this._fontPicker$.show():this._fontPicker$.hide();}};D.prototype._showImagePickers=function(v){if(this._imageIconAndColor$){v?this._imageIconAndColor$.show():this._imageIconAndColor$.hide();}if(this._imageSize$){v?this._imageSize$.show():this._imageSize$.hide();}};D.prototype._updateDataLabelVisible=function(p){if(p['textVisible']!==false||p['iconVisible']!==false){p['dataLabelVisible']=true;}else if(this._target.view._isAllSelected()){p['dataLabelVisible']=false;}};D.prototype._showDataLabelChangedHandler=function(f){var p=this._getPickerProps(['showDataLabel','fontPicker','showDataLabelImage']);this._updateDataLabelVisible(p);this._showFontPicker(p['textVisible']===true);this._mergeRangeProperties(p,this._getRangeProperties());this._target.updateProperties(p);};D.prototype._fontPickerChangedHandler=function(f){var p=this._getPickerProps(['fontPicker']);var g=f.data.changedItem;for(var i in g){if(g[i]){p[i]=g[i];}}this._target.updateProperties(p);};D.prototype._showDataLabelImageChangedHandler=function(f){var p=this._getPickerProps(['showDataLabel','showDataLabelImage','imageIcon','imageColor','imageSizeSlider']);this._updateDataLabelVisible(p);this._showImagePickers(p['iconVisible']===true);this._mergeRangeProperties(p,this._getRangeProperties());this._target.updateProperties(p);};D.prototype._imageIconChangedHandler=function(f){var p=this._getPickerProps(['imageIcon']);p['iconSVG']=f.data.pickedItem;this._target.updateProperties(p);};D.prototype._imageColorChangedHandler=function(f){var p=this._getPickerProps(['imageColor']);p['iconColor']=f.data.pickedItem;this._target.updateProperties(p);};D.prototype._imageSizeSliderChangedHandler=function(E){var p=this._getPickerProps(['imageSizeSlider']);p['iconSize']=E.oSource.getValue();this._mergeRangeProperties(p,this._getRangeProperties());this._target.updateProperties(p,false,true);};D.prototype.destroy=function(){if(this._imageSizeSlider){this._imageSizeSlider.destroy();}this._imageSizeSlider=null;};D.prototype._getRangeProperties=function(){var p=this._getPickerProps(['showDataLabel','showDataLabelImage']);var v=c.getVizType(this._target.proxy.getType());if(!this._target.queryProperty('plotArea.primaryScale.fixedRange')){if(d.TYPE_BAR===v){return this._getValueRange(p.textVisible===true||p.iconVisible===true);}else if(d.TYPE_COLUMN===v){return this._getValueRange(p.iconVisible===true);}}};D.prototype._getValueRange=function(f){if(f){var p={};var g=this._target.queryProperty('plotArea.primaryScale.autoMaxValue');var h=this._target.queryProperty('plotArea.primaryScale.autoMinValue');p['plotArea.primaryScale.maxValue']=parseFloat(g*e);if(g*h<0){p['plotArea.primaryScale.minValue']=parseFloat(h*e);}p['plotArea.primaryScale.fixedRange']=true;return p;}};D.prototype._mergeRangeProperties=function(p,r){if(p&&r){for(var f in r){p[f]=r[f];}}};return D;});u('sap/viz/controls/propertyeditor/sections/views/ColumnDataLabelView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper'],function(O,P,D){var C=function(d,v,p){C.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren();};O.extend(C,P);C.prototype.destroy=function(){C.superclass.destroy.apply(this,arguments);if(this._helper){this._helper.destroy();}this._helper=null;};C.prototype._createChildren=function(){this._helper=this._createHelper(D,{'showDataLabel':true,'showDataLabelImage':true});};return C;});u('sap/viz/controls/propertyeditor/pickers/ShapePicker',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/helpers/ObjectHelper','sap/viz/controls/propertyeditor/helpers/SVGHelper','sap/viz/controls/propertyeditor/pickers/PickerBase'],function($,C,O,a,S,P){var b=function(f,p,g){b.superclass.constructor.apply(this,arguments);g=this._config||{};this._icons=g.icons||[];this._defaultIcon=null;this._iconMap={};this._parseIconMap();this._pickedItem={icon:p?p.icon:undefined,color:p?p.color:undefined};if(this._pickedItem.icon===null){this._icon=null;}else{this._icon=this._pickedItem.icon?this._pickedItem.icon:this._defaultIcon;}this._color=this._pickedItem.color?this._pickedItem.color:e;this._createChildren();this._list$=null;this._container$=null;this._resizeHandler=null;this._mdHandler=$.proxy(this._mousedownHandler,this);};O.extend(b,P);var c=C.PROPERTYEDITOR_PREFIX+'iconpicker-';var d=C.COMMON_PREFIX;var e='rgba(0,0,0,1)';var s=[{'type':'shape','id':'rectangle','svg':'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" viewBox="265 0 622 104" enable-background="new 265 0 622 104" xml:space="preserve">'+'<rect x="272" y="6" fill="#F05B26" width="100%" height="100%"/></svg>'},{'type':'shape','id':'trapezoid','svg':'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"'+'width="100%" height="100%" viewBox="265 0 622 104" enable-background="new 265 0 622 104" xml:space="preserve">'+'<polygon fill="#F05B26" points="272,6 272,96.197 879.811,96.197 789.666,6 "/></svg>'},{'type':'shape','id':'triangle','svg':'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"'+'width="100%" height="100%" viewBox="0 0 622 104" enable-background="new 0 0 622 104" xml:space="preserve">'+'<polygon fill="#F05B26" points="7,96.196 7,6 614.811,51.098 "/></svg>'},{'type':'shape','id':'pike','svg':'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"'+'width="100%" height="100%" viewBox="265 0 622 104" enable-background="new 265 0 622 104" xml:space="preserve">'+'<polygon fill="#F05B26" points="789.666,6 272,6 272,96.195 789.666,96.195 879.811,51.098 "/></svg>'}];b.prototype._createChildren=function(){this._container$=$(document.createElement('div')).appendTo(this._dom$);this._container$.addClass('sapUiTfBrd sapUiTfStd  sapUiTfCombo '+c+'container');this._icon$=$(document.createElement('div')).appendTo(this._container$);this._icon$.addClass(c+'icon');this._arrow$=$(document.createElement('div')).appendTo(this._container$);this._arrow$.addClass('sapUiTfComboIcon');this._arrow$.click($.proxy(this._arrowClickHandler,this));this._applyIcon();};b.prototype._parseIconMap=function(){var i,f;var g=this._icons=s.concat(this._icons);if(g.length){for(i=0;i<g.length;i++){f=g[i];this._iconMap[f.id]=f;}if(g[0].type==='shape'){this._defaultIcon={'type':'shape','value':g[0].id};}else{this._defaultIcon={'type':'svg','value':g[0].svg};}}};b.prototype.icon=function(f){if(arguments.length>0){if(this._icon!==f){this._icon=f;this._applyIcon();this._changePickedItem(this._icon);}return this;}else{return this._icon;}};b.prototype._applyIcon=function(){if(this.icon()){var f=this.icon().type==='shape'?this._iconMap[this.icon().value].svg:this.icon().value;this._icon$[0].innerHTML=f;var g=this._icon$.children().get(0);if(!g.getAttribute('viewBox')){var h=g.getBBox();g.setAttribute('viewBox',[h.x,h.y,h.width,h.height].join(' '));}if(this.icon().type==='shape'){a.setSVGColor(this._icon$[0],this.color());}else{g.setAttribute('fill',this.color());}}};b.prototype.color=function(f){if(arguments.length>0){this._color=f;this._applyColor();return this;}else{return this._color;}};b.prototype._applyColor=function(){if(this.color()){$('svg',this._dom$).each($.proxy(function(f,g){S.setColor(g,this.color());},this));}};b.prototype._createIconList=function(){this._list$=$(document.createElement('div')).appendTo($('body'));this._list$.addClass(c+'list');this._locate();var t=$(document.createElement('div')).appendTo(this._list$);var i,f,g,h,k,l,m,n,o;for(i=0;i<this._icons.length;i++){g=this._icons[i];f=g.id;h=g.svg;o=$(document.createElement('div')).appendTo(t);o.addClass(c+'list-cell');if(g.type==='shape'){l={'type':'shape','value':f};}else{l={'type':'svg','value':h};}o.data('icon',l);n=$(document.createElement('div')).appendTo(o);n[0].innerHTML=h;h=n.children().get(0);if(!h.getAttribute('viewBox')){var p=h.getBBox();h.setAttribute('viewBox',[p.x,p.y,p.width,p.height].join(' '));}n.addClass(c+'list-icon');k=this.color()?this.color():e;if(g.type==='shape'){a.setSVGColor(n[0],k);}else{h.setAttribute('fill',k);}o.click($.proxy(this._iconListClickHandler,this));}this._addEventListeners();$(document).on('mousedown',this._mdHandler);$(window).on('blur',this._mdHandler);};b.prototype._locate=function(){if(!!this._list$){var o;if(!!this._container$){o=this._container$.offset();}else{o=this._dom$.children().offset();}this._list$.css({position:'absolute',top:o.top+2,left:o.left});}};b.prototype._resizer=function(f){if(!f.data.invalidateSize){setTimeout($.proxy(function(){f.data.invalidateSize=false;this._locate();},this),1000/24);}f.data.invalidateSize=true;};b.prototype._addEventListeners=function(){this._resizeHandler=$.proxy(this._resizer,this);$(window).resize({'invalidateSize':false},this._resizeHandler);};b.prototype._iconListClickHandler=function(f){var g=$(f.currentTarget);var h=g.data('icon');this.icon(h);this._destroyList();};b.prototype._arrowClickHandler=function(f){if(this._list$!==null){this._destroyList();return;}this._createIconList();};b.prototype._destroyList=function(){$(document).off('mousedown',this._mdHandler);$(window).off('blur',this._mdHandler);$(window).off('resize',this._resizeHandler);this._list$.empty().detach();this._list$=null;};b.prototype._mousedownHandler=function(E){if(this._list$!==null&&this._list$.css('visibility')=='visible'&&$(E.target).closest(this._list$).length<=0&&E.target!==this._arrow$[0]){this._destroyList();}};return b;});u('sap/viz/controls/propertyeditor/sections/views/ColumnDataPointView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/ShapePicker','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(C,L,O,P,a,S,b){var c=function(){c.superclass.constructor.apply(this,arguments);this._defaultShapeFill=null;this._createChildren();};O.extend(c,P);c.prototype._createChildren=function(){var p=this._initialProperties();if(p){if(!this._isAllSelected()){this._defaultShapeFill=this._getExtraContext('color');}var d=this._createItemRow(3,C.PROPERTYEDITOR_PREFIX+'view-item');var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_SHAPE_STYLE')});t.placeAt($(d.children()[0]));var e;if(p.dataPointShape===null){e=null;}else{e={};e.type=p.dataPointShape?p.dataPointShape.type:'shape';e.value=p.dataPointShape?p.dataPointShape.value:'rectangle';}var f;if(p.lineFill===null){f=null;}else{f=p.dataPointShapeFill?p.dataPointShapeFill:this._defaultShapeFill;}var s={'icon':e};this._shapePicker=new S($(d.children()[1]),s,{'icons':this._uiConfig.icons});var g=f;this._colorPicker=new a($(d.children()[2]),g,{'mode':'fill'});this._shapePicker.addEventListener(b.PICKED_ITEM_CHANGED,this._shapeChangedHandler,this);this._colorPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._colorChangedHandler,this);d.children()[0].insertAdjacentHTML('afterEnd','<br>');}};c.prototype._createItemRow=function(d,e){var i,f,g;f=$(document.createElement('div'));if(e){f.addClass(e);}for(i=0;i<d;i++){g=$(document.createElement('div')).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');g.appendTo(f);}f.appendTo(this._dom$);return f;};c.prototype._initialProperties=function(){var o={'dataPointShape':true,'dataPointShapeFill':true};return this._queryProperties(o);};c.prototype._shapeChangedHandler=function(e){var s=e.data.pickedItem;var o={'dataPointShape':s};this._updateProperties(o);};c.prototype._colorChangedHandler=function(e){var d=e.data.pickedItem;var o={'dataPointShapeFill':d,};this._updateProperties(o);};return c;});u('sap/viz/controls/propertyeditor/sections/views/ColumnSeriesView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/ShapePicker','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/common/property/VizPropertyZone'],function(C,L,O,a,I,P,b,S,c,V){var d=function(){d.superclass.constructor.apply(this,arguments);this._defaultShapeFill=null;if(this._isSeries()){this._createChildrenForSeries();}else{this._createChildrenForDataPoint();}};O.extend(d,P);d.prototype._isSeries=function(){var e=true;var z=this._propertyZones;z.forEach(function(f){if(!f.seriesContext()){e=false;return;}});return e;};d.prototype._createChildrenForSeries=function(){var p=this._initialProperties();if(p){if(!this._isAllSelected()){this._defaultShapeFill=this._getExtraContext('color');}var e;if(p.lineFill===null){e=null;}else{e=p.dataPointShapeFill?p.dataPointShapeFill:this._defaultShapeFill;}var f=this._createItemRow(1,C.PROPERTYEDITOR_PREFIX+'view-item');this._seriesItems=this._createSeriesItems();var s=this._genSeriesListItems(this._seriesItems);var g=this._genSelectedSeriesItem();var h=new sap.ui.commons.DropdownBox({'width':'76px','selectedKey':Object.keys(g).length==1?Object.keys(g)[0]:null,'items':s,'change':$.proxy(this._seriesDropdownChangedHandler,this)}).placeAt($(f.children()[0]));if(Object.keys(g).length!=1){a.defer(function(){sap.ui.commons.TextField.prototype.setValue.apply(h,[' '])});}f=this._createItemRow(2,C.PROPERTYEDITOR_PREFIX+'view-item');var k=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_COLOR')}).placeAt($(f.children()[0]));this._colorPicker=new b($(f.children()[1]),e,{'mode':'fill'});this._colorPicker.addEventListener(c.PICKED_ITEM_CHANGED,this._colorPickerChangedHandler,this);}};d.prototype._createChildrenForDataPoint=function(){var p=this._initialProperties();if(p){var e=this._createItemRow(3,C.PROPERTYEDITOR_PREFIX+'view-item');var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_SHAPE_STYLE')});t.placeAt($(e.children()[0]));var f;if(p.stackShape===null){f=null;}else{f={};f.type=p.stackShape?p.stackShape.type:'shape';f.value=p.stackShape?p.stackShape.value:'rectangle';}var s={'icon':f};this._shapePicker=new S($(e.children()[1]),s,{'icons':this._uiConfig.icons});this._shapePicker.addEventListener(c.PICKED_ITEM_CHANGED,this._shapeChangedHandler,this);var r=new sap.ui.commons.Button({press:$.proxy(this._btnPress,this)});r.placeAt(e.children()[2]);$(e.children()[2]).addClass(C.PROPERTYEDITOR_PREFIX+'rotatebutton-container');e.children()[0].insertAdjacentHTML('afterEnd','<br>');}};d.prototype._createItemRow=function(e,f){var g=$(document.createElement('div'));if(f){g.addClass(f);}for(var i=0;i<e;i++){var h=$(document.createElement('div'));if(i===0){h.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell-wrap');}else{h.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');}h.appendTo(g);}g.appendTo(this._dom$);return g;};d.prototype._initialProperties=function(){var o={'stackShape':true,'dataPointShapeFill':true};return this._queryProperties(o);};d.prototype._shapeChangedHandler=function(e){var s=e.data.pickedItem;var o={'stackShape':s};this._updateProperties(o);};d.prototype._btnPress=function(){};d.prototype._seriesDropdownChangedHandler=function(e){var s=e.oSource.getSelectedKey();var z=V.DATA_POINT;var f=this._propertyZones[0];var g=this._seriesItems[s]['seriesData'];f.context(g);this._vizProxy.setPropertyZones([f]);var p=this._initialProperties();if(p){if(!this._isAllSelected()){this._defaultShapeFill=this._getExtraContext('color');}var h;if(p.lineFill===null){h=null;}else{h=p.dataPointShapeFill?p.dataPointShapeFill:this._defaultShapeFill;}}this._colorPicker.updateColor(h);};d.prototype._colorPickerChangedHandler=function(e){var f=e.data.pickedItem;var o={'dataPointShapeFill':f,};this._updateProperties(o);};d.prototype._createSeriesItems=function(){var f=this._vizProxy.getVizFeeding();var e=this._vizProxy.getDataset().table();var s=I.buildInfoSeries(f,e);return s;};d.prototype._genSeriesListItems=function(s){var e=[];for(item in s){e.push(new sap.ui.core.ListItem({'key':s[item].name,'text':s[item].name}));}return e;};d.prototype._genSelectedSeriesItem=function(){var f=this._vizProxy.getVizFeeding();var e=[];this._propertyZones.forEach(function(g){e.push(g.context());});return I.buildInfoSeries(f,e);};return d;});u('sap/viz/controls/propertyeditor/sections/views/DonutDataLabelView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper'],function(O,P,D){var a=function(d,v,p){a.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren();};O.extend(a,P);a.prototype.destroy=function(){a.superclass.destroy.apply(this,arguments);if(this._helper){this._helper.destroy();}this._helper=null;};a.prototype._createChildren=function(){this._helper=this._createHelper(D,{'showDataLabel':true});};return a;});u('sap/viz/controls/propertyeditor/sections/views/DonutGetPropertiesByCtx',[],function(){function e(c,a){var k=Object.keys(c),b=Object.keys(a);return(k.length>0)&&k.every(function(d){return c[d]===a[d];});}function m(c,d){if(!c){return false;}if(!Array.isArray(c)){c=[c];}return c.some(function(a){if(!a){return true;}return e(a,d);});}function f(c,a){var r;for(var k in c){if(!r){r={};}var b=true;for(var i=0;i<a.length;i++){if(k===a[i]){a.splice(i,1);b=false;break;}}if(!b){continue;}r[k]=c[k];}return r;};return function(c,a){var b=c.ctx;if(!Array.isArray(a)){a=[a];}var d;for(var i=0,l=a.length;i<l;i++){var g=a[i],h=g.ctx,p=g.paras;if(!h){d=p;}}var p=this._parameters,k,n=-1,o,q;for(var i=0,l=a.length;i<l;i++){var g=a[i],h=g.ctx,p=g.paras;if(!h){q=i;}else if(m(h,b)){o=0;for(var j in h){o++;}if(n<o){n=o;q=i;}}}if(a[q]){return a[q].paras;}return d;};});u('sap/viz/controls/propertyeditor/sections/views/DonutDataPointView',['sap/viz/controls/propertyeditor/sections/views/DonutGetPropertiesByCtx','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/ShapePicker','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/FontPicker','sap/viz/controls/common/property/VizPropertyZone'],function(g,C,L,O,U,P,S,a,b,F,V){var D=function(d,c,v,p){D.superclass.constructor.apply(this,arguments);this._createChildren();};O.extend(D,P);D.prototype._createChildren=function(){var p=this._properties=this._initialProperties();if(p){var c=this._propertyZones[0].context();this._selectedIndex=null;if(c){this._selectedIndex=c._id;}var h=-1;var d=this._vizProxy.getDataset();if(p['plotArea.highlight.highlightContext']&&p['plotArea.highlight.highlightContext'].length>0){h=this._getHighlightContextIndex(p['plotArea.highlight.highlightContext'][0],d.table());}if(this._selectedIndex===null){if(h>-1){this._selectedIndex=h;}else{this._selectedIndex=0;}var e=d.table()[this._selectedIndex];var c=U.clone(e);c._id=c._contextId;delete c._contextId;this._vizProxy.setPropertyZones([new V(V.DATA_POINT,c)]);}var f=this._container$=$(document.createElement('div')).appendTo(this._dom$);var k=$(document.createElement('div')).appendTo(f);k.addClass(C.PROPERTYEDITOR_PREFIX+'view-item '+C.PROPERTYEDITOR_PREFIX+'slicestyle');var l=$(document.createElement('div')).appendTo(k);l.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_DONUT_DATA_POINT_SLICE_COLOR')});t.placeAt(l);var m=$(document.createElement('div')).appendTo(k);m.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var n=null;if(this._propertyZones&&this._propertyZones.length===1){var o=this._propertyZones[0];var q=o.extraContext();if(q&&q.hasOwnProperty('color')){n=q.color;}else{n=p['plotArea.colorPalette'][this._selectedIndex];var r=p['plotArea.highlight.contextInfos'];this._setDefaultSelectedContext(d,this._selectedIndex);if(r&&r.length>0){if(d){if(this._DefaultSelectedContext){var s={'ctx':this._DefaultSelectedContext};var v=g(s,r);if(v&&v.color){n=v.color;}}}}}}var w=new b(m,this._propertyZones.length>1?this._getMultiSelectedColor():n,{'mode':'fill'});w.addEventListener(a.PICKED_ITEM_CHANGED,$.proxy(this._cpChangedHandler,this),this);var x=$(document.createElement('div'));x.addClass(C.PROPERTYEDITOR_PREFIX+'view-item');x.appendTo(f);var y=this._highLightCB=new sap.ui.commons.CheckBox({text:L.get('PROPERTY_EDITOR_DONUT_DATA_POINT_HIGHLIGHT'),checked:this._selectedIndex===h,change:$.proxy(this._hlBoxChangedHandler,this),enabled:(this._vizProxy.getPropertyZones().length==1)});y.placeAt(x);this._subContainer$=$(document.createElement('div'));this._subContainer$.appendTo(f);if(y.getChecked()){this._subContainer$.show();}else{this._subContainer$.hide();}this._createSubContainer();}};D.prototype._setDefaultSelectedContext=function(d,c){this._DefaultSelectedContext=null;if(d){var e=d.dimensions();var f=d.table();if(e&&e.length>0&&f&&f.length>0&&c<f.length){var o=f[c];var s={};for(var j=0;j<e.length;j++){var p=e[j];if(p&&o.hasOwnProperty(p)){s[p]=o[p];}}if(s){this._DefaultSelectedContext=s;}else{this._DefaultSelectedContext=null;}}}};D.prototype._getHighlightContextIndex=function(h,d){if(!h||!d){return-1;}var c=-1;if(d&&d.length>0){var t=null;var i=0;for(;i<d.length;i++){var f=true;t=d[i];if(t&&h){for(var p in h){if(h.hasOwnProperty(p)&&t.hasOwnProperty(p)){if(h[p]===t[p]){f=f&&true;}else{f=false;break;}}else{f=false;}}}else{f=false;}if(f){c=i;break;}}}return c;};D.prototype._createSubContainer=function(){if(this._properties){var c=$(document.createElement('div'));c.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');c.appendTo(this._subContainer$);var d=new sap.ui.commons.CheckBox({text:L.get('PROPERTY_EDITOR_DONUT_DATA_POINT_SHOW_NAME'),checked:this._properties['plotArea.highlight.centerName.visible'],change:$.proxy(this._showNameChangedHandler,this)});d.placeAt(c);var f=this._showNameFontPicker$=$(document.createElement('div'));f.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent2');f.appendTo(this._subContainer$);var p={fontFamily:this._properties['centerName.fontFamily'],fontSize:this._properties['centerName.fontSize'],fontWeight:this._properties['centerName.fontWeight'],fontColor:this._properties['centerName.fontColor'],fontStyle:this._properties['centerName.fontStyle']};var e=new F(f.get(0),p,{'showColorPicker':false});e.addEventListener(a.PICKED_ITEM_CHANGED,$.proxy(this._nameFPChangedHandler,this),this);if(d.getChecked()){this._showNameFontPicker$.show();}else{this._showNameFontPicker$.hide();}var h=$(document.createElement('div'));h.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1');h.appendTo(this._subContainer$);var k=new sap.ui.commons.CheckBox({text:L.get('PROPERTY_EDITOR_DONUT_DATA_POINT_SHOW_PERCENTAGE'),checked:this._properties['plotArea.highlight.centerValue.visible'],change:$.proxy(this._showPercentChangedHandler,this)});k.placeAt(h);var l=this._showPercentageFontPicker$=$(document.createElement('div'));l.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent2');l.appendTo(this._subContainer$);var m={fontFamily:this._properties['centerValue.fontFamily'],fontSize:this._properties['centerValue.fontSize'],fontWeight:this._properties['centerValue.fontWeight'],fontColor:this._properties['centerValue.fontColor'],fontStyle:this._properties['centerValue.fontStyle']};var n=new F(l.get(0),m,{'showColorPicker':false});n.addEventListener(a.PICKED_ITEM_CHANGED,$.proxy(this._percentFPChangedHandler,this),this);if(k.getChecked()){this._showPercentageFontPicker$.show();}else{this._showPercentageFontPicker$.hide();}var o=$(document.createElement('div'));o.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-indent1').css({'height':'auto'});o.appendTo(this._subContainer$);var q=$(document.createElement('div')).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');q.appendTo(o);var r=new sap.ui.commons.Label({text:L.get('PROPERTY_EDITOR_DONUT_DATA_POINT_OTHER_SLICE_COLOR')});r.placeAt(q);var s=$(document.createElement('div')).addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');s.appendTo(o);var t=this._properties['plotArea.highlight.unhighlightSliceColor'];var v=new b(s,t,{'mode':'fill'});v.addEventListener(a.PICKED_ITEM_CHANGED,$.proxy(this._otherCPChangedHandler,this),this);}};D.prototype._initialProperties=function(){var o={'plotArea.highlight.highlightContext':true,'plotArea.highlight.unhighlightSliceColor':true,'plotArea.highlight.contextInfos':true,'plotArea.highlight.centerName.visible':true,'plotArea.highlight.centerValue.visible':true,'centerName.fontFamily':true,'centerName.fontSize':true,'centerName.fontWeight':true,'centerName.fontStyle':true,'centerValue.fontFamily':true,'centerValue.fontSize':true,'centerValue.fontWeight':true,'centerValue.fontStyle':true,};var p=this._queryProperties(o);var c=p['plotArea.colorPalette']=this._vizProxy.getProperties().plotArea.colorPalette;var d=c.length;var s=this._vizProxy.getDataset().dataInFields().length;if(d<s){for(var i=d;i++;i<s){c[i]=c[i%d];}}return p;};D.prototype._updateProperties=function(p){var k=true;D.superclass._updateProperties.apply(this,[p,k]);};D.prototype._getMultiSelectedColor=function(){var z=this._propertyZones;var c=null;if(z&&z.length>0&&z[0].extraContext()){var e=z[0].extraContext();if(e&&e.color){c=e.color;for(var i=1;i<z.length;i++){var d=z[i];if(d&&d.extraContext()){var n=d.extraContext().color;if(c!==n){return null;}}}}}return c;};D.prototype._hlBoxChangedHandler=function(e){var c=this._highLightCB.getChecked();var h=[];if(c){this._subContainer$.show();if(this._propertyZones&&this._propertyZones.length>0&&this._propertyZones[0]&&this._propertyZones[0]._context){var d=this._propertyZones[0]._context;if(d&&d.hasOwnProperty('_id')){h.push(this._propertyZones[0].getDimensionContext());}}else{if(this._DefaultSelectedContext){h.push(this._DefaultSelectedContext);}}}else{this._subContainer$.hide();}var o={'plotArea.highlight.highlightContext':h,'centerName.fontColor':this._properties['plotArea.colorPalette'][this._selectedIndex],'centerValue.fontColor':this._properties['plotArea.colorPalette'][this._selectedIndex]};this._updateProperties(o);};D.prototype._cpChangedHandler=function(e){var c=e.data.pickedItem;var p=this._properties['plotArea.colorPalette'];var d=this._properties['plotArea.highlight.contextInfos'];var z=this._vizProxy.getPropertyZones();if(!d||(d&&d.length<1)){d=[];}for(var i=0;i<z.length;i++){var f=z[i].context();if(f){var s=f._id;p[s]=c;f=z[i].getDimensionContext();if((f===null||f===undefined)&&this._DefaultSelectedContext!==null){f=this._DefaultSelectedContext;}var h={'ctx':f};var k=g(h,d);if(k&&k.color){k.color=c;}else{if(!d||d.length===0){d=[];}d.push({'ctx':f,'paras':{'color':c}});}}}this._updateProperties({'plotArea.highlight.contextInfos':d,'centerName.fontColor':p[this._selectedIndex],'centerValue.fontColor':p[this._selectedIndex]});};D.prototype._otherCPChangedHandler=function(e){var c=e.data.pickedItem;this._updateProperties({'plotArea.highlight.unhighlightSliceColor':c});};D.prototype._showNameChangedHandler=function(e){if(e.getParameter('checked')){this._showNameFontPicker$.show();}else{this._showNameFontPicker$.hide();}var o={'plotArea.highlight.centerName.visible':e.getParameter('checked'),'centerName.fontColor':this._properties['plotArea.colorPalette'][this._selectedIndex]};this._updateProperties(o);};D.prototype._showPercentChangedHandler=function(e){if(e.getParameter('checked')){this._showPercentageFontPicker$.show();}else{this._showPercentageFontPicker$.hide();}var o={'plotArea.highlight.centerValue.visible':e.getParameter('checked'),'centerValue.fontColor':this._properties['plotArea.colorPalette'][this._selectedIndex]};this._updateProperties(o);};D.prototype._nameFPChangedHandler=function(e){var p=e.data.changedItem;var o={};if(p.hasOwnProperty('fontFamily')){o['centerName.fontFamily']=p.fontFamily;}if(p.hasOwnProperty('fontSize')){o['centerName.fontSize']=p.fontSize;}if(p.hasOwnProperty('fontWeight')){o['centerName.fontWeight']=p.fontWeight;}if(p.hasOwnProperty('fontStyle')){o['centerName.fontStyle']=p.fontStyle;}this._updateProperties(o);};D.prototype._percentFPChangedHandler=function(e){var p=e.data.changedItem;var o={};if(p.hasOwnProperty('fontFamily')){o['centerValue.fontFamily']=p.fontFamily;}if(p.hasOwnProperty('fontSize')){o['centerValue.fontSize']=p.fontSize;}if(p.hasOwnProperty('fontWeight')){o['centerValue.fontWeight']=p.fontWeight;}if(p.hasOwnProperty('fontStyle')){o['centerValue.fontStyle']=p.fontStyle;}this._updateProperties(o);};return D;});u('sap/viz/controls/propertyeditor/sections/views/DonutChartAreaView',['sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/spin/Spin','sap/viz/controls/propertyeditor/sections/helpers/ChartAreaViewHelper'],function(C,L,O,P,a,b,S,c){var D=function(d,v,p){D.superclass.constructor.apply(this,arguments);this._innerCircleSlider=null;this._innerCiccleRatioProperty="plotArea.innerRadiusRatio";this._helper=null;this._createChildren();};O.extend(D,P);D.prototype.destroy=function(){D.superclass.destroy.apply(this,arguments);if(this._innerCircleSlider){this._innerCircleSlider.destroy();}this._innerCircleSlider=null;};D.prototype._createChildren=function(){this._helper=this._createHelper(c,{});var p=this._initialProperties();var d=$(document.createElement('div')).appendTo(this._dom$);d.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row '+C.PROPERTYEDITOR_PREFIX+'donut-chartarea');var l=$(document.createElement('div')).appendTo(d);l.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_BACKGROUND_COLOR')});t.placeAt(l);var e=$(document.createElement('div')).appendTo(d);e.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var f=this._colorPicker=new a(e,this._queryProperty('fill'),{'mode':'fill'});this._colorPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._pickerChangedHandler,this);var s=this._vizProxy.getSize();d=$(document.createElement('div')).appendTo(this._dom$);d.addClass(C.PROPERTYEDITOR_PREFIX+'view-item '+C.PROPERTYEDITOR_PREFIX+'donut-chartarea');l=$(document.createElement('div')).appendTo(d);l.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_DONUT_INNER_CIRCLE')});t.placeAt(l);var g=$(document.createElement('div')).appendTo(d);g.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var h=this._innerCircleSlider=new sap.ui.commons.Slider({min:0,max:1,value:p[this._innerCiccleRatioProperty],width:'154px',smallStepWidth:0.01,liveChange:$.proxy(function(k){this._changeInnerSize(k.getParameters().value);},this)});h.placeAt(g.addClass(C.PROPERTYEDITOR_PREFIX+'views-slider-container'));};D.prototype._initialProperties=function(){var o={};o[this._innerCiccleRatioProperty]=true;return this._queryProperties(o);};D.prototype._pickerChangedHandler=function(e){var d=e.data.pickedItem;var o={'fill':d};this._updateProperties(o);};D.prototype._heightChangedHandler=function(e){var s=this._vizProxy.getSize();var h=parseFloat(e.data.value);if(h!=s.height){this._vizProxy.setSize({'height':h,'width':s.width});}};D.prototype._widthChangedHandler=function(e){var s=this._vizProxy.getSize();var w=parseFloat(e.data.value);if(w!=s.width){this._vizProxy.setSize({'height':s.height,'width':w});}};D.prototype._propertyChangedHandler=function(e){if(this._heightSpin&&this._widthSpin){var s=this._vizProxy.getSize();if(s.height!=this._heightSpin.getValue()){this._heightSpin.updateUI(s.height);}if(s.width!=this._widthSpin.getValue()){this._widthSpin.updateUI(s.width);}}};D.prototype._changeInnerSize=function(v){var o={};o[this._innerCiccleRatioProperty]=v;this._updateProperties(o);};return D;});u('sap/viz/controls/propertyeditor/sections/views/LineDataPointView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/propertyeditor/pickers/SwitchPicker','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/IconPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent'],function(O,U,P,C,L,V,S,a,I,b){var c=function(){c.superclass.constructor.apply(this,arguments);this._dataPointImageProperty='line.iconSVG';this._dataPointImageColorProperty='line.iconColor';this._dataPointSizeProperty='line.iconSize';this._defaultIcon=null;this._defaultIconColor=null;this._dataPointDefaultSize=8;this._icons=this._uiConfig.icons.concat();this._createChildren();};O.extend(c,P);c.prototype.destroy=function(){c.superclass.destroy.apply(this,arguments);if(this._markerSizeSlider){this._markerSizeSlider.destroy();}this._markerSizeSlider=null;};c.prototype._createChildren=function(){var p=this._initialProperties();if(p){var d=this._createItemRow(1,C.PROPERTYEDITOR_PREFIX+'view-item');var t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_MARKER_SHAPE')});t.placeAt($(d.children()[0]));var e=p[this._dataPointImageProperty];var f=p[this._dataPointImageColorProperty];dataPointImageRow$=this._createItemRow(2,C.PROPERTYEDITOR_PREFIX+'view-item-row');var g=null;var h=null;this._setDefaultIcon('circle');if(e===null){g=null;}else{g=e?e:this._defaultIcon;}if(f===null){h=null;}else{if(!this._isAllSelected()){this._defaultIconColor=this._getExtraContext('color');}h=f?f:this._defaultIconColor;}this._dataPointImage=new I($(dataPointImageRow$.children()[0]),g,{'icons':this._icons});this._dataPointColor=new a($(dataPointImageRow$.children()[1]),h,{'mode':'fill'});var k=this._createItemRow(1,C.PROPERTYEDITOR_PREFIX+'view-item');t=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_SIZE_OF_ALL_MARKERS')});t.placeAt($(k.children()[0]));var m=p[this._dataPointSizeProperty];m=(m!==undefined&&m!==null)?m:this._dataPointDefaultSize;var l=this._createItemRow(1,C.PROPERTYEDITOR_PREFIX+'view-item-row');var n=this._markerSizeSlider=new sap.ui.commons.Slider({min:0,max:100,value:m,width:'154px',smallStepWidth:1,liveChange:$.proxy(function(o){this._changeMarkerSize(o.getParameters().value);},this)});n.placeAt($(l.children()[0]).addClass(C.PROPERTYEDITOR_PREFIX+'views-slider-container'));this._dataPointImage.addEventListener(b.PICKED_ITEM_CHANGED,this._changeDataPointImage,this);this._dataPointColor.addEventListener(b.PICKED_ITEM_CHANGED,this._changeDataPointImageColor,this);if(this._needApplyDefaultMarker()){U.defer($.proxy(function(){this._applyDefaultMarker();},this));}}};c.prototype._createItemRow=function(d,e){var i,f,g;f=$(document.createElement('div'));if(e){f.addClass(e);}for(i=0;i<d;i++){g=$(document.createElement('div'));if(i===0){g.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell-wrap');}else{g.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-cell');}g.appendTo(f);}f.appendTo(this._dom$);return f;};c.prototype._initialProperties=function(){var o={};o[this._dataPointImageProperty]=true;o[this._dataPointImageColorProperty]=true;o[this._dataPointSizeProperty]=true;return this._queryProperties(o);};c.prototype._needApplyDefaultMarker=function(){var p={};p[this._dataPointImageProperty]=true;var o=this._vizProxy.queryProperties({'propertyZones':[new V(this._propertyZones[0].type())],'propertyFields':p});return(o[this._dataPointImageProperty]===undefined);};c.prototype._applyDefaultMarker=function(){var o={};o[this._dataPointImageProperty]=this._defaultIcon;o[this._dataPointSizeProperty]=this._dataPointDefaultSize;this._updateProperties(o,false,true);};c.prototype._changeMarkerSize=function(v){var o={};o[this._dataPointSizeProperty]=v;this._updateProperties(o,false,true);};c.prototype._changeDataPointImage=function(e){var d=e.data.pickedItem;var o={};o[this._dataPointImageProperty]=d;this._updateProperties(o);};c.prototype._changeDataPointImageColor=function(e){var d=e.data.pickedItem;var o={};o[this._dataPointImageColorProperty]=d;this._updateProperties(o);};c.prototype._setDefaultIcon=function(d){var i,e;for(i=0;i<this._icons.length;i++){e=this._icons[i];if(e.id===d){this._defaultIcon=e.svg;break;}}if(!this._defaultIcon){this._defaultIcon='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" viewBox="0 0 400.427 400.38" enable-background="new 0 0 400.427 400.38" xml:space="preserve">'+'<circle cx="200.199" cy="200.186" r="200"/></svg>';var n={'id':d,'svg':this._defaultIcon};this._icons.unshift(n);}};return c;});u('sap/viz/controls/propertyeditor/sections/views/LineDataLabelView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper'],function(O,P,D){var L=function(d,v,p){L.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren();};O.extend(L,P);L.prototype.destroy=function(){L.superclass.destroy.apply(this,arguments);if(this._helper){this._helper.destroy();}this._helper=null;};L.prototype._createChildren=function(){this._helper=this._createHelper(D,{'showDataLabel':true});};return L;});u('sap/viz/controls/propertyeditor/pickers/LineStylePicker',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/helpers/ObjectHelper','sap/viz/controls/propertyeditor/helpers/SVGHelper','sap/viz/controls/propertyeditor/pickers/ShapePicker'],function($,C,O,a,S,b){var L=function(d,p,c){this._lineStyles=[this._generateLineStyle('1,0'),this._generateLineStyle('2,4'),this._generateLineStyle('6,6')];L.superclass.constructor.apply(this,arguments);};O.extend(L,b);var l=C.PROPERTYEDITOR_PREFIX+'linestylepicker-';L.prototype._generateLineStyle=function(d){var r={};r.type='shape';r.id=d;r.svg='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" enable-background="new 265 0 622 104" xml:space="preserve">'+'<g style="stroke-width: 2;stroke: F05B26;"><path d="M0 10 80 10" stroke-dasharray="'+d+'"></path></g></svg>';return r;};L.prototype._parseIconMap=function(){var i,c;if(this._lineStyles.length){for(i=0;i<this._lineStyles.length;i++){shape=this._lineStyles[i];this._iconMap[shape.id]=shape;}this._defaultIcon={'type':'shape','value':this._lineStyles[0].id};}};L.prototype._applyIcon=function(){if(this.icon()&&this.color()){var c=this.icon().type==='shape'?this._iconMap[this.icon().value].svg:this.icon().value;this._icon$[0].innerHTML=c;a.setSVGColor(this._icon$[0],this.color());}};L.prototype._createIconList=function(){this._list$=$(document.createElement('div')).appendTo($('body'));this._list$.addClass(l+'list');this._locate();var c=$(document.createElement('ul')).appendTo(this._list$);var i,d,s,e,f,g;var h={};for(i=0;i<this._lineStyles.length;i++){e=this._lineStyles[i];d=e.id;s=e.svg;if(e.type==='shape'){h={'type':'shape','value':d};}else{h={'type':'svg','value':s};}f=$(document.createElement('li')).appendTo(c).addClass(l+'list-li');f.data('icon',h);g=$(document.createElement('div')).appendTo(f);g[0].innerHTML=s;g.addClass(l+'list-shape');a.setSVGColor(g[0],this.color());f.click($.proxy(this._iconListClickHandler,this));if(this._shape===e){f.removeClass(l+'list-li');f.addClass(l+'list-li-selected');}}$(document).on('mousedown',this._mdHandler);$(window).on('blur',this._mdHandler);};return L;});u('sap/viz/controls/propertyeditor/sections/views/LineView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/pickers/ColorPicker','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/pickers/LineStylePicker','sap/viz/controls/propertyeditor/spin/Spin'],function(O,P,C,L,a,b,c,S){var d=function(){d.superclass.constructor.apply(this,arguments);this._defaultLineFill=null;this._createChildren();};O.extend(d,P);d.prototype._createChildren=function(){var p=this._initialProperties();if(p){if(!this._isAllSelected()){this._defaultLineFill=this._getExtraContext('color');}var e=this._cpContainer$=$(document.createElement('div')).appendTo(this._dom$);e.addClass(C.PROPERTYEDITOR_PREFIX+'view-item '+C.PROPERTYEDITOR_PREFIX+'linestyle');var f=$(document.createElement('div')).appendTo(e);f.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var g=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_LINE_LINE_COLOR')});g.placeAt(f);var h=$(document.createElement('div')).appendTo(e);h.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var k;if(p.lineFill===null){k=null;}else{k=p.lineFill?p.lineFill:this._defaultLineFill;}this._colorPicker=new a(h,k,{'mode':'fill'});this._colorPicker.addEventListener(b.PICKED_ITEM_CHANGED,this._colorChangedHandler,this);var t=this._thicknessContainer$=$(document.createElement('div')).appendTo(this._dom$);t.addClass(C.PROPERTYEDITOR_PREFIX+'view-item '+C.PROPERTYEDITOR_PREFIX+'linestyle');var l=$(document.createElement('div')).appendTo(t);l.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var m=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_LINE_LINE_THICKNESS')});m.placeAt(l);var n;if(p['plotArea.width']===null){n=null;}else if(p['plotArea.width']===undefined){n=2;}else{n=p['plotArea.width'];}var s=$(document.createElement('div')).appendTo(t);var o=new S(s,{min:0,value:n});o.addEventListener("changed",$.proxy(function(z){this._thicknessChangedHandler(z);},this),this);var q=this._lineStyleContainer$=$(document.createElement('div')).appendTo(this._dom$);q.addClass(C.PROPERTYEDITOR_PREFIX+'view-item '+C.PROPERTYEDITOR_PREFIX+'linestyle');var r=$(document.createElement('div')).appendTo(q);r.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var v=new sap.ui.commons.Label({'text':L.get('PROPERTY_EDITOR_LINE_LINE_STYLE')});v.placeAt(r);var w=$(document.createElement('div')).appendTo(q);w.addClass(C.PROPERTYEDITOR_PREFIX+'view-item-row');var x;if(p.lineStyle===null){x=null;}else{x={};x.type='shape';x.value=p.lineStyle?p.lineStyle:'1,0';}var y={'icon':x};this._stylePicker=new c(w,y);this._stylePicker.addEventListener(b.PICKED_ITEM_CHANGED,this._lineStyleChangedHandler,this);}};d.prototype._initialProperties=function(){var o={'lineFill':true,'lineStyle':true,'plotArea.width':true};return this._queryProperties(o);};d.prototype._colorChangedHandler=function(e){var f=e.data.pickedItem;var o={'lineFill':f,};this._updateProperties(o);};d.prototype._thicknessChangedHandler=function(e){var w=parseFloat(e.data.value);this._updateProperty('plotArea.width',w);};d.prototype._lineStyleChangedHandler=function(e){var s=e.data.pickedItem;var o={'lineStyle':s.value};this._updateProperties(o);};return d;});u('sap/viz/controls/propertyeditor/sections/views/StackedColumnDataLabelView',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/propertyeditor/sections/PropertyViewBase','sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper'],function(O,P,D){var S=function(d,v,p){S.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren();};O.extend(S,P);S.prototype.destroy=function(){S.superclass.destroy.apply(this,arguments);if(this._helper){this._helper.destroy();}this._helper=null;};S.prototype._createChildren=function(){this._helper=this._createHelper(D,{'showDataLabel':true,'showDataLabelImage':false});};return S;});u('sap/viz/controls/propertyeditor/sections/VizPropertyZoneMap',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/sections/Section','sap/viz/controls/propertyeditor/sections/views/CategoryAxisTitleView','sap/viz/controls/propertyeditor/sections/views/ValueAxisTitleView','sap/viz/controls/propertyeditor/sections/views/CategoryAxisView','sap/viz/controls/propertyeditor/sections/views/ChartAreaView','sap/viz/controls/propertyeditor/sections/views/ChartTitleView','sap/viz/controls/propertyeditor/sections/views/PlotAreaView','sap/viz/controls/propertyeditor/sections/views/DonutPlotAreaView','sap/viz/controls/propertyeditor/sections/views/LegendView','sap/viz/controls/propertyeditor/sections/views/ValueAxisView','sap/viz/controls/propertyeditor/sections/views/ColumnDataLabelView','sap/viz/controls/propertyeditor/sections/views/ColumnDataPointView','sap/viz/controls/propertyeditor/sections/views/ColumnSeriesView','sap/viz/controls/propertyeditor/sections/views/DonutDataLabelView','sap/viz/controls/propertyeditor/sections/views/DonutDataPointView','sap/viz/controls/propertyeditor/sections/views/DonutChartAreaView','sap/viz/controls/propertyeditor/sections/views/LineDataPointView','sap/viz/controls/propertyeditor/sections/views/LineDataLabelView','sap/viz/controls/propertyeditor/sections/views/LineView','sap/viz/controls/propertyeditor/sections/views/StackedColumnDataLabelView'],function(C,V,I,L,S,a,b,c,d,e,P,D,f,g,h,k,l,m,n,o,p,q,r,s){var t={};var _='commonChartType';var v=null;var w=function(z,E,F){var G;G=v[z]=v[z]||{};G[E]=F;};var x=function(z,E){if(v[z]&&v[z][E]){return v[z][E];}else if(z!==_){return x(_,E);}};t.mapSections=function(z,E){y();return x(z,E)||[];};t.getAvailableSections=function(z){y();if(v[z]){var E=[];for(var F in v[z]){E=E.concat(x(z,F));}E.sort(function(G,H){return(G.groupIndex*10+G.itemIndex)-(H.groupIndex*10+H.itemIndex);});return E;}else if(z!==_){return t.getAvailableSections(_);}};t.queryPropertyZone=function(z,E){y();if(v[z]){for(var F in v[z]){var G=x(z,F);if($.inArray(E,G)!==-1){return new V(F);}}}return null;};var y=function(){if(!v){v={};var z;z=_;w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),0,0)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),0,1)]);z=I.getInfoType(C.TYPE_COLUMN);w(z,V.DATA_POINT,[new S(S.COLUMN_DATA_POINT,k,L.get('PROPERTY_EDITOR_COLUMN_DATA_POINT'),0,0)]);w(z,V.DATA_LABEL,[new S(S.COLUMN_DATA_LABEL,h,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.X_AXIS,[new S(S.CATEGORY_AXIS,c,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS'),1,0)]);w(z,V.X_AXIS_TITLE,[new S(S.CATEGORY_AXIS_TITLE,a,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE'),1,1)]);w(z,V.Y_AXIS,[new S(S.VALUE_AXIS,g,L.get('PROPERTY_EDITOR_VERTICAL_AXIS'),1,2)]);w(z,V.Y_AXIS_TITLE,[new S(S.VALUE_AXIS_TITLE,b,L.get('PROPERTY_EDITOR_VERTICAL_AXIS_TITLE'),1,3)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);z=I.getInfoType(C.TYPE_BAR);w(z,V.DATA_POINT,[new S(S.COLUMN_DATA_POINT,k,L.get('PROPERTY_EDITOR_BAR_DATA_POINT'),0,0)]);w(z,V.DATA_LABEL,[new S(S.COLUMN_DATA_LABEL,h,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.Y_AXIS,[new S(S.CATEGORY_AXIS,c,L.get('PROPERTY_EDITOR_VERTICAL_AXIS'),1,0)]);w(z,V.Y_AXIS_TITLE,[new S(S.CATEGORY_AXIS_TITLE,a,L.get('PROPERTY_EDITOR_VERTICAL_AXIS_TITLE'),1,1)]);w(z,V.X_AXIS,[new S(S.VALUE_AXIS,g,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS'),1,2)]);w(z,V.X_AXIS_TITLE,[new S(S.VALUE_AXIS_TITLE,b,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE'),1,3)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);z=I.getInfoType(C.TYPE_LINE);w(z,V.DATA_POINT,[new S(S.LINE_DATA_POINT,p,L.get('PROPERTY_EDITOR_MARKER'),0,0)]);w(z,V.DATA_LABEL,[new S(S.LINE_DATA_LABEL,q,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.LINE,[new S(S.LINE,r,L.get('PROPERTY_EDITOR_LINE'),0,2)]);w(z,V.X_AXIS,[new S(S.CATEGORY_AXIS,c,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS'),1,0)]);w(z,V.X_AXIS_TITLE,[new S(S.CATEGORY_AXIS_TITLE,a,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE'),1,1)]);w(z,V.Y_AXIS,[new S(S.VALUE_AXIS,g,L.get('PROPERTY_EDITOR_VERTICAL_AXIS'),1,2)]);w(z,V.Y_AXIS_TITLE,[new S(S.VALUE_AXIS_TITLE,b,L.get('PROPERTY_EDITOR_VERTICAL_AXIS_TITLE'),1,3)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);z=I.getInfoType(C.TYPE_HORIZONTAL_LINE);w(z,V.DATA_POINT,[new S(S.LINE_DATA_POINT,p,L.get('PROPERTY_EDITOR_MARKER'),0,0)]);w(z,V.DATA_LABEL,[new S(S.LINE_DATA_LABEL,q,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.LINE,[new S(S.LINE,r,L.get('PROPERTY_EDITOR_LINE'),0,2)]);w(z,V.Y_AXIS,[new S(S.CATEGORY_AXIS,c,L.get('PROPERTY_EDITOR_VERTICAL_AXIS'),1,0)]);w(z,V.Y_AXIS_TITLE,[new S(S.CATEGORY_AXIS_TITLE,a,L.get('PROPERTY_EDITOR_VERTICAL_AXIS_TITLE'),1,1)]);w(z,V.X_AXIS,[new S(S.VALUE_AXIS,g,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS'),1,2)]);w(z,V.X_AXIS_TITLE,[new S(S.VALUE_AXIS_TITLE,b,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE'),1,3)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);z=I.getInfoType(C.TYPE_DONUT);w(z,V.DATA_POINT,[new S(S.DONUT_DATA_POINT,n,L.get('PROPERTY_EDITOR_DONUT_DATA_POINT'),0,0)]);w(z,V.DATA_LABEL,[new S(S.DONUT_DATA_LABEL,m,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,o,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.DONUT_PLOT_AREA,D,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);z=I.getInfoType(C.TYPE_STACKED_COLUMN);w(z,V.DATA_POINT,[new S(S.COLUMN_DATA_POINT,l,L.get('PROPERTY_EDITOR_SERIES'),0,0)]);w(z,V.DATA_LABEL,[new S(S.COLUMN_DATA_LABEL,s,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.X_AXIS,[new S(S.CATEGORY_AXIS,c,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS'),1,0)]);w(z,V.X_AXIS_TITLE,[new S(S.CATEGORY_AXIS_TITLE,a,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE'),1,1)]);w(z,V.Y_AXIS,[new S(S.VALUE_AXIS,g,L.get('PROPERTY_EDITOR_VERTICAL_AXIS'),1,2)]);w(z,V.Y_AXIS_TITLE,[new S(S.VALUE_AXIS_TITLE,b,L.get('PROPERTY_EDITOR_VERTICAL_AXIS_TITLE'),1,3)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);z=I.getInfoType(C.TYPE_STACKED_BAR);w(z,V.DATA_POINT,[new S(S.COLUMN_DATA_POINT,l,L.get('PROPERTY_EDITOR_SERIES'),0,0)]);w(z,V.DATA_LABEL,[new S(S.COLUMN_DATA_LABEL,s,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.Y_AXIS,[new S(S.CATEGORY_AXIS,c,L.get('PROPERTY_EDITOR_VERTICAL_AXIS'),1,0)]);w(z,V.Y_AXIS_TITLE,[new S(S.CATEGORY_AXIS_TITLE,a,L.get('PROPERTY_EDITOR_VERTICAL_AXIS_TITLE'),1,1)]);w(z,V.X_AXIS,[new S(S.VALUE_AXIS,g,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS'),1,2)]);w(z,V.X_AXIS_TITLE,[new S(S.VALUE_AXIS_TITLE,b,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE'),1,3)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);z=I.getInfoType(C.TYPE_100_STACKED_COLUMN);w(z,V.DATA_POINT,[new S(S.COLUMN_DATA_POINT,l,L.get('PROPERTY_EDITOR_SERIES'),0,0)]);w(z,V.DATA_LABEL,[new S(S.COLUMN_DATA_LABEL,s,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.X_AXIS,[new S(S.CATEGORY_AXIS,c,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS'),1,0)]);w(z,V.X_AXIS_TITLE,[new S(S.CATEGORY_AXIS_TITLE,a,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE'),1,1)]);w(z,V.Y_AXIS,[new S(S.VALUE_AXIS,g,L.get('PROPERTY_EDITOR_VERTICAL_AXIS'),1,2)]);w(z,V.Y_AXIS_TITLE,[new S(S.VALUE_AXIS_TITLE,b,L.get('PROPERTY_EDITOR_VERTICAL_AXIS_TITLE'),1,3)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);z=I.getInfoType(C.TYPE_100_STACKED_BAR);w(z,V.DATA_POINT,[new S(S.COLUMN_DATA_POINT,l,L.get('PROPERTY_EDITOR_SERIES'),0,0)]);w(z,V.DATA_LABEL,[new S(S.COLUMN_DATA_LABEL,s,L.get('PROPERTY_EDITOR_DATA_LABEL'),0,1)]);w(z,V.Y_AXIS,[new S(S.CATEGORY_AXIS,c,L.get('PROPERTY_EDITOR_VERTICAL_AXIS'),1,0)]);w(z,V.Y_AXIS_TITLE,[new S(S.CATEGORY_AXIS_TITLE,a,L.get('PROPERTY_EDITOR_VERTICAL_AXIS_TITLE'),1,1)]);w(z,V.X_AXIS,[new S(S.VALUE_AXIS,g,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS'),1,2)]);w(z,V.X_AXIS_TITLE,[new S(S.VALUE_AXIS_TITLE,b,L.get('PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE'),1,3)]);w(z,V.CHART_AREA,[new S(S.CHART_AREA,d,L.get('PROPERTY_EDITOR_CHART_AREA'),2,0)]);w(z,V.CHART_TITLE,[new S(S.CHART_TITLE,e,L.get('PROPERTY_EDITOR_CHART_TITLE'),2,1)]);w(z,V.PLOT_AREA,[new S(S.PLOT_AREA,P,L.get('PROPERTY_EDITOR_PLOT_AREA'),2,2)]);w(z,V.LEGEND,[new S(S.LEGEND,f,L.get('PROPERTY_EDITOR_LEGEND'),2,3)]);}};return t;});u('sap/viz/controls/propertyeditor/InfoPropertyEditor',['sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/propertyeditor/sections/VizPropertyZoneMap','sap/viz/controls/propertyeditor/sections/PropertyViewFactory','sap/viz/controls/propertyeditor/pickers/PickerEvent','sap/viz/controls/propertyeditor/pickers/SectionPicker'],function(V,C,O,a,I,b,L,c,d,P,e,S){var f=function(g,h){f.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.propertyeditor.InfoPropertyEditor';sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_infopropertyeditor_control');this._title$=null;this._sectionPicker=null;this._viewsContainer$=null;this._views=[];this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:create_infopropertyeditor_control');};O.extend(f,V);f.prototype.destroy=function(){f.superclass.destroy.apply(this,arguments);var v=this._vizProxy();v.removeEventListener('propertyZonesChanged',this._recreateViews,this);v.setPropertyZones([]);this._destroyViews();};f.prototype._onConnect=function(v,m){f.superclass._onConnect.apply(this,arguments);this._updateChildren();this._vizProxy().addEventListener('propertyZonesChanged',this._recreateViews,this);};f.prototype._onDisconnect=function(){f.superclass._onDisconnect.apply(this,arguments);this._vizProxy().removeEventListener('propertyZonesChanged',this._recreateViews,this);};f.prototype._createChildren=function(){var g;this._dom$.addClass(C.PROPERTYEDITOR_PREFIX+'main');if(this._uiConfig.enableTitle===true){this._title$=$(document.createElement('div'));this._title$.addClass(C.PROPERTYEDITOR_PREFIX+'title');this._title$.appendTo(this._dom$);}if(this._title$){g=$(document.createElement('div'));g.addClass(C.PROPERTYEDITOR_PREFIX+'title-splitter');g.appendTo(this._dom$);}g=$(document.createElement('div'));g.addClass(C.PROPERTYEDITOR_PREFIX+'section-selector-container');g.appendTo(this._dom$);g=$(document.createElement('div')).appendTo(g);this._sectionPicker=new S(g.get(0),null,{'sections':[]});this._sectionPicker.addEventListener(e.PICKED_ITEM_CHANGED,this._sectionPickerChangedHandler,this);this._viewsContainer$=$(document.createElement('div'));this._viewsContainer$.addClass(C.PROPERTYEDITOR_PREFIX+'views-container');this._viewsContainer$.appendTo(this._dom$);this._updateChildren();};f.prototype._updateChildren=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_infopropertyeditor');var v=this._vizModel().type();if(!b.isInfoChart(v)){return;}if(v){if(this._title$){var n=sap.viz.api.manifest.Viz.get(I.getVizType(v))[0].name;this._title$.text(a.substitute(L.get('PROPERTY_EDITOR_TITLE_PREFIX'),n));}this._sectionPicker.sections(d.getAvailableSections(v));this._recreateViews();}else{if(this._title$){this._title$.text(L.get('PROPERTY_EDITOR_TITLE_PLACE_HOLDER'));}this._sectionPicker.sections([]);this._destroyViews();}sap.viz.base.utils.log.Analyzer.pnrProfiling('VizControls:update_infopropertyeditor');};f.prototype._sectionPickerChangedHandler=function(g){var s=g.data.pickedItem;var z=d.queryPropertyZone(this._vizModel().type(),s);this._vizProxy().setPropertyZones([z]);this._recreateViews();};f.prototype._recreateViews=function(){this._destroyViews();this._createViews();};f.prototype._createViews=function(){this._views=[];var z=this._vizProxy().getPropertyZones();if(!z||z.length==0){z=[new c(c.CHART_AREA)];this._vizProxy().setPropertyZones(z);}var g={};z.forEach($.proxy(function(h,k,z){if(g[h.type()]){g[h.type()].push(h);}else{g[h.type()]=[h];}},this));for(var t in g){var s=d.mapSections(this._vizModel().type(),t);s.forEach($.proxy(function(h){this._sectionPicker.pickedItem(h);var k=$(document.createElement('div')).appendTo(this._viewsContainer$);k.addClass(C.PROPERTYEDITOR_PREFIX+'view');var v=P.produce(h,k.get(0),this._uiConfig,this._vizProxy(),g[t]);this._views.push(v);},this));}};f.prototype._destroyViews=function(){if(this._views){this._views.forEach(function(v){v.destroy();});}this._views=null;this._viewsContainer$.empty();};return f;});u('sap/viz/controls/propertyeditor/PropertyEditor',['sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/propertyeditor/PropertyEditorConfig','sap/viz/controls/propertyeditor/VizPropertyEditor','sap/viz/controls/propertyeditor/InfoPropertyEditor','sap/viz/controls/propertyeditor/events/PropertyEditorEvent','sap/viz/controls/propertyeditor/pickers/ColorPicker'],function(V,C,O,a,L,P,b,I,c,d){var f=function(g,h){f.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.propertyeditor.PropertyEditor';this._uiConfig=h?h:P.instance();try{jQuery.sap.require('sap.ui.commons.Button');jQuery.sap.require('sap.ui.commons.Slider');jQuery.sap.require('sap.ui.commons.ColorPicker');jQuery.sap.require('sap.ui.commons.ToggleButton');jQuery.sap.require('sap.ui.commons.Label');jQuery.sap.require('sap.ui.commons.DropdownBox');jQuery.sap.require('sap.ui.commons.TextField');jQuery.sap.require('sap.ui.commons.CheckBox');jQuery.sap.require('sap.ui.commons.RadioButton');jQuery.sap.require('sap.ui.commons.TriStateCheckBox');jQuery.sap.require('sap.ui.commons.ComboBox');}catch(e){throw a.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR'),'sap.ui.commons','PropertyEditor');}this._createChildren();this._recentColors=[];this._colorPickerClass=d;this._colorPickerClass._recentColors=this._recentColors;this._colorPickerClass._eventDispatch.addEventListener(c.RECENTCOLORS_CHANGED,function(k){this._onRecentColorsChange(k);}.bind(this));};O.extend(f,V);f.prototype.update=function(){this._updateChildren();};f.prototype.recentColors=function(r){if(arguments.length>0&&!!r){if(this._colorPickerClass){this._colorPickerClass._recentColors=r;}this._recentColors=r;return this;}else{return this._recentColors;}};f.prototype._onConnect=function(v,m){f.superclass._onConnect.apply(this,arguments);this._updateChildren();};f.prototype._onDisconnect=function(){f.superclass._onDisconnect.apply(this,arguments);if(this._editorInstance){this._editorInstance.disconnect();}};f.prototype._onAfterDisconnect=function(){this._vizModel().type(null);this._updateChildren();};f.prototype._onVizModelChanged=function(e){if(e.data.vizTypeChanged){this._updateChildren();}};f.prototype._createChildren=function(){this._dom$.addClass(C.PROPERTYEDITOR_PREFIX+'main');this._editorInstance=null;this._updateChildren();};f.prototype._onRecentColorsChange=function(e){this._dispatchEvent(e);this._recentColors=e.data;};f.prototype._updateChildren=function(){if(this._editorInstance){this._editorInstance.disconnect();this._editorInstance.destroy();}this._dom$.empty();var v=this._vizModel().type();if(!v){return;}if(v.indexOf('info/')==0){this._editorInstance=new I(this._dom$,this._uiConfig);}else if(v.indexOf('viz/')==0){this._editorInstance=new b(this._dom$,this._uiConfig);}else{this._editorInstance=new b(this._dom$,this._uiConfig);}if(this._editorInstance){this._editorInstance.connect(this._vizUid);}};f.prototype.destroy=function(){if(this._editorInstance){this._editorInstance.destroy();}f.superclass.destroy.apply(this,arguments);};return f;});u('sap/viz/controls/popover/chartpopover/ShapeMarker',[],function(){var _=function(){
/*
         * Copyright (C) 2009-2013 SAP BOBJ or an SAP affiliate company. All rights reserved
         */
jQuery.sap.declare('sap.viz.chartpopover.ShapeMarker');sap.ui.core.Control.extend('sap.viz.chartpopover.ShapeMarker',{metadata:{properties:{'type':'string','color':'string','markerSize':'int'}},renderer:{render:function(r,c){var m=c.getMarkerSize()?c.getMarkerSize():10;var p={rx:m/2,ry:m/2,type:c.getType(),borderWidth:0};r.write('<div');r.writeClasses();r.write('>');r.write('<svg width='+m+'px height='+m+'px ');r.write('>');r.write("<path d = '"+c._generateShapePath(p)+"'");r.write(" fill = '"+c.getColor()+"'");r.write(" transform = 'translate("+m/2+","+m/2+")'");r.write('</path>');r.write('</svg>');r.write('</div>');r.writeStyles();}}});sap.viz.chartpopover.ShapeMarker.prototype._generateShapePath=function(p){var a;var t=p.borderWidth/2;switch(p.type){case"circle":a="M"+(-p.rx-t)+",0 A"+(p.rx+t)+","+(p.ry+t)+" 0 1,0 "+(p.rx+t)+",0 A";a+=(p.rx+t)+","+(p.ry+t)+" 0 1,0 "+(-p.rx-t)+",0z";break;case"cross":a="M"+(-p.rx-t)+","+(-p.ry/3-t)+"H"+(-p.rx/3-t)+"V"+(-p.ry-t)+"H"+(p.rx/3+t);a+="V"+(-p.ry/3-t)+"H"+(p.rx+t)+"V"+(p.ry/3+t)+"H"+(p.rx/3+t);a+="V"+(p.ry+t)+"H"+(-p.rx/3-t)+"V"+(p.ry/3+t)+"H"+(-p.rx-t)+"Z";break;case"diamond":a="M0,"+(-p.ry-t)+"L"+(p.rx+t)+",0"+" 0,"+(p.ry+t)+" "+(-p.rx-t)+",0"+"Z";break;case"square":a="M"+(-p.rx-t)+","+(-p.ry-t)+"L"+(p.rx+t)+",";a+=(-p.ry-t)+"L"+(p.rx+t)+","+(p.ry+t)+"L"+(-p.rx-t)+","+(p.ry+t)+"Z";break;case"triangle-down":case"triangleDown":a="M0,"+(p.ry+t)+"L"+(p.rx+t)+","+-(p.ry+t)+" "+-(p.rx+t)+","+-(p.ry+t)+"Z";break;case"triangle-up":case"triangleUp":a="M0,"+-(p.ry+t)+"L"+(p.rx+t)+","+(p.ry+t)+" "+-(p.rx+t)+","+(p.ry+t)+"Z";break;case"triangle-left":case"triangleLeft":a="M"+-(p.rx+t)+",0L"+(p.rx+t)+","+(p.ry+t)+" "+(p.rx+t)+","+-(p.ry+t)+"Z";break;case"triangle-right":case"triangleRight":a="M"+(p.rx+t)+",0L"+-(p.rx+t)+","+(p.ry+t)+" "+-(p.rx+t)+","+-(p.ry+t)+"Z";break;case"intersection":a="M"+(p.rx+t)+","+(p.ry+t)+"L"+(p.rx/3+t)+",0L"+(p.rx+t)+","+-(p.ry+t)+"L";a+=(p.rx/2-t)+","+-(p.ry+t)+"L0,"+(-p.ry/3-t)+"L"+(-p.rx/2+t)+","+-(p.ry+t)+"L";a+=-(p.rx+t)+","+-(p.ry+t)+"L"+-(p.rx/3+t)+",0L"+-(p.rx+t)+","+(p.ry+t)+"L";a+=(-p.rx/2+t)+","+(p.ry+t)+"L0,"+(p.ry/3+t)+"L"+(p.rx/2-t)+","+(p.ry+t)+"Z";break;case'squareWithRadius':var r=p.rx;var b=r-3;a="M0,"+-r+"L"+-b+","+-r+"Q"+-r+","+-r+" "+-r+","+-b+"L"+-r+","+b+"Q"+-r+","+r+" "+-b+","+r;a+="L"+b+","+r+"Q"+r+","+r+" "+r+","+b+"L"+r+","+-b+"Q"+r+","+-r+" "+b+","+-r+"Z";break;}return a;};};return{'create':function(a,s){try{return new sap.viz.chartpopover.ShapeMarker(a,s);}catch(e){_();return arguments.callee.apply(this,arguments);}}};});u('sap/viz/controls/popover/chartpopover/ContentPanel',['sap/viz/controls/popover/chartpopover/ShapeMarker'],function(S){var _=function(){jQuery.sap.declare('sap.viz.chartpopover.ContentPanel');sap.ui.core.Control.extend('sap.viz.chartpopover.ContentPanel',{metadata:{publicMethods:["setContentData"]},renderer:{render:function(r,c){r.renderControl(c._oPanel);}}});sap.viz.chartpopover.ContentPanel.prototype.init=function(){this._measureItemsLen=0;this._defaultItemsLineHeight=1.4375;this._spacing=0.4375*2;var m=new sap.ui.model.json.JSONModel();this._sModelName="sapvizModel";var I=new sap.m.DisplayListItem({label:"{measureName}",value:"{measureValue}"}).addStyleClass('viz-controls-chartPopover-measures-item');this._oList=new sap.m.List({}).addStyleClass('viz-controls-chartPopover-measures-list');this._oList.setModel(m);this._oList.bindAggregation("items","/items",I);this._oShapeLabel=S.create(this._createId('vizShapeMarker'),{}).addStyleClass('viz-controls-chartPopover-dimension-marker');this._oDimLabel=new sap.m.Label(this._createId('vizDimensionLabel'),{}).addStyleClass('viz-controls-chartPopover-dimension-label');this._oPanel=new sap.m.Panel(this._createId('vizPanel'),{content:[this._oShapeLabel,this._oDimLabel,this._oList]});};sap.viz.chartpopover.ContentPanel.prototype.setContentData=function(d){var v=d.val,a='',m=[];this._measureItemsLen=0;if(v){for(var i=0;i<v.length;i++){if(v[i].type==='dimension'){if(a.length>0){a=a+' - '+v[i].value;}else{a=v[i].value;}}else if(v[i].type=='measure'){m.push({measureName:v[i].name,measureValue:v[i].value});}}var b=this._oDimLabel.$().css('margin-left');if(b){b=parseInt(b.substr(0,b.length-2));this._oShapeLabel.setMarkerSize(b);}this._oShapeLabel.setColor(d.color).setType((d.shape?d.shape:'square'));this._oDimLabel.setText(a);this._oList.getModel().setData({'items':m});this._measureItemsLen=m.length;}};sap.viz.chartpopover.ContentPanel.prototype.getContentHeight=function(){return this._measureItemsLen>0?((this._measureItemsLen+1)*this._defaultItemsLineHeight+this._spacing):0;};sap.viz.chartpopover.ContentPanel.prototype._createId=function(I){return this.getId()+"-"+I;};sap.viz.chartpopover.ContentPanel.prototype.exit=function(I){if(this._oList){this._oList.destroy();this._oList=null;}if(this._oShapeLabel){this._oShapeLabel.destroy();this._oShapeLabel=null;}if(this._oDimLabel){this._oDimLabel.destroy();this._oDimLabel=null;}};};return{'create':function(a,s){try{return new sap.viz.chartpopover.ContentPanel(a,s);}catch(e){_();return arguments.callee.apply(this,arguments);}}};});u('sap/viz/controls/popover/chartpopover/HeaderBar',[],function(){var _=function(){jQuery.sap.declare('sap.viz.chartpopover.HeaderBar');sap.m.Bar.extend('sap.viz.chartpopover.HeaderBar',{metadata:{properties:{'showNavButton':'boolean','title':'string'},publicMethods:[],events:{"navButtonPress":{},"closeButtonPress":{}}},renderer:{}});sap.viz.chartpopover.HeaderBar.prototype.getContentLeft=function(){if(!this._oNavButton){this._oNavButton=new sap.m.Button(this._createId("popoverNavButton"),{type:sap.m.ButtonType.Back,press:jQuery.proxy(function(){this.fireNavButtonPress();},this)}).addStyleClass('sapUiIcon');}this._oNavButton.setVisible(this.getShowNavButton());return[this._oNavButton];};sap.viz.chartpopover.HeaderBar.prototype.getContentMiddle=function(){if(!this._oTitleLabel){this._oTitleLabel=new sap.m.Label(this._createId('popoverHeaderTitle'));}this._oTitleLabel.setText(this.getTitle());return[this._oTitleLabel];};sap.viz.chartpopover.HeaderBar.prototype.getContentRight=function(){if(!this._oCloseButton){this._oCloseButton=new sap.m.Button(this._createId("popoverCloseButton"),{icon:sap.ui.core.IconPool.getIconURI("decline"),press:jQuery.proxy(function(){this.fireCloseButtonPress();},this)}).addStyleClass('sapUiIcon');}return[this._oCloseButton];};sap.viz.chartpopover.HeaderBar.prototype.exit=function(){if(this._oCloseButton){this._oCloseButton.destroy();this._oCloseButton=null;}if(this._oTitleLabel){this._oTitleLabel.destroy();this._oTitleLabel=null;}if(this._oNavButton){this._oNavButton.destroy();this._oNavButton=null;}};sap.viz.chartpopover.HeaderBar.prototype._createId=function(I){return this.getId()+"-"+I;};};return{'create':function(a,s){try{return new sap.viz.chartpopover.HeaderBar(a,s);}catch(e){_();return arguments.callee.apply(this,arguments);}}};});u('sap/viz/controls/popover/chartpopover/SubActionItemsPage',[],function(){var _=function(){jQuery.sap.declare('sap.viz.chartpopover.SubActionItemsPage');sap.ui.core.Element.extend('sap.viz.chartpopover.SubActionItemsPage',{metadata:{properties:{items:{type:'sap.m.ListBase[]'}}}});sap.viz.chartpopover.SubActionItemsPage.prototype.init=function(){this._oList=new sap.m.List({});this._oPage=new sap.m.Page(this._createId("listPage"),{showNavButton:false,showHeader:false,content:[this._oList]});};sap.viz.chartpopover.SubActionItemsPage.prototype.exit=function(){if(this._oList){this._oList.destroy();this._oList=null;}if(this._oPage){this._oPage.destroy();this._oPage=null;}};sap.viz.chartpopover.SubActionItemsPage.prototype.getControl=function(){return this._oPage;};sap.viz.chartpopover.SubActionItemsPage.prototype.getPageId=function(){return this._oPage.getId();};sap.viz.chartpopover.SubActionItemsPage.prototype.setItems=function(a){this._oList.removeAllItems();var b;for(var i=0;i<a.length;i++){b=new sap.m.ActionListItem({text:a[i].text,press:a[i].press?a[i].press:function(){}});this._oList.addItem(b);}};sap.viz.chartpopover.SubActionItemsPage.prototype._createId=function(I){return this.getId()+"-"+I;};};return{'create':function(a,s){try{return new sap.viz.chartpopover.SubActionItemsPage(a,s);}catch(e){_();return arguments.callee.apply(this,arguments);}}};});u('sap/viz/controls/popover/chartpopover/ChartPopover',['sap/viz/controls/popover/chartpopover/ContentPanel','sap/viz/controls/popover/chartpopover/HeaderBar','sap/viz/controls/popover/chartpopover/SubActionItemsPage'],function(C,H,S){var _=function(){jQuery.sap.declare('sap.viz.chartpopover.ChartPopover');sap.ui.core.Control.extend('sap.viz.chartpopover.ChartPopover',{metadata:{properties:{'customDataControl':{type:'any'},'actionItems':{type:'object[]'}}}});sap.viz.chartpopover.ChartPopover.prototype.init=function(){this._listItemHeight=3;this._options=null;this._oContentPanel=C.create(this._createId('vizContentPanel'),{});this._oSelectedLabel=new sap.m.Label(this._createId('vizSelectedLabel'),{});this._oSelectedBar=new sap.m.Bar(this._createId('vizSelectedBar'),{contentMiddle:[this._oSelectedLabel]}).addStyleClass('viz-controls-chartPopover-vizSelectedBar').addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');this._oHomePage=new sap.m.Page(this._createId('vizHomePage'),{showNavButton:false,showHeader:false,content:[this._oContentPanel]});this._oNavContainer=new sap.m.NavContainer(this._createId('vizNavContainer'),{afterNavigate:jQuery.proxy(function(e){var p=e.getParameter("to").getId();if(p.search('HomePage')!==-1){this._oCustomHeader.setShowNavButton(false).setTitle('Current Selection');}else{this._oCustomHeader.setShowNavButton(true);}},this)});this._oNavContainer.addPage(this._oHomePage);this._oCustomHeader=H.create(this._createId('vizHeaderBar'),{title:'Current Selection',showNavButton:false,closeButtonPress:jQuery.proxy(this.close,this),navButtonPress:jQuery.proxy(this._navigateBack,this)});this._oPopover=new sap.m.ResponsivePopover(this._createId('vizChartPopover'),{modal:false,bounce:true,horizontalScrolling:false,contentWidth:"18rem",contentHeight:'100%',customHeader:this._oCustomHeader,content:[this._oNavContainer]});this._oPopover.addStyleClass('viz-controls-chartPopover');this._oPopover.attachBeforeOpen(jQuery.proxy(this._beforeOpen,this));this._oPopover.attachAfterClose(jQuery.proxy(this._afterClose,this));};sap.viz.chartpopover.ChartPopover.prototype._beforeOpen=function(){var s=0;if(!this._options.data.val||this._options.selectedValues>1){s=this._listItemHeight+0.1;}var c=this._oContentPanel.getContentHeight()+s;if(this._oContentPanel.getContentHeight()===0){if(!this._oCustomPanel){this._oHomePage.removeContent(this._oContentPanel);this._oSelectedBar.removeStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');}}if(this.getActionItems()){c+=this.getActionItems().length*this._listItemHeight;}this._oPopover.setContentHeight(c+'rem');};sap.viz.chartpopover.ChartPopover.prototype._afterClose=function(){if(this._options&&this._options.selectedValues<1){this._oHomePage.removeContent(this._oSelectedBar);}};sap.viz.chartpopover.ChartPopover.prototype.isOpen=function(){return this._oPopover.isOpen();};sap.viz.chartpopover.ChartPopover.prototype.openBy=function(c,s){if(c){this._updateContent();this._updateActionItems();var t=c.getBoundingClientRect();this._oPopover.setOffsetX(parseInt(t.width)).setOffsetY(parseInt(t.height/2));this._navigateBack();this._oPopover.openBy(c,s);}return this;};sap.viz.chartpopover.ChartPopover.prototype.close=function(){this._oPopover.close();return this;};sap.viz.chartpopover.ChartPopover.prototype.exit=function(){if(this._oNavContainer){this._oNavContainer.destroy();this._oNavContainer=null;}if(this._oContentPanel){this._oContentPanel.destroy();this._oContentPanel=null;}if(this._oSelectedLabel){this._oSelectedLabel.destroy();this._oSelectedLabel=null;}if(this._oHomePage){this._oHomePage.destroy();this._oHomePage=null;}if(this._oCustomHeader){this._oCustomHeader.destroy();this._oCustomHeader=null;}if(this._oCustomPanel){this._oCustomPanel.destroy();this._oCustomPanel=null;}if(this._oPopover){this._oPopover.destroy();this._oPopover=null;}this._options=null;};sap.viz.chartpopover.ChartPopover.prototype.setOptions=function(o){var d=o.data;this._options=o;this._oContentPanel.setContentData(d);if(!d.val||o.selectedValues>1){this._oSelectedLabel.setText(o.selectedValues+' values selected');this._oHomePage.insertContent(this._oSelectedBar,1);}else{this._oHomePage.removeContent(this._oSelectedBar);}return this;};sap.viz.chartpopover.ChartPopover.prototype._updateContent=function(){var c=this.getCustomDataControl();if(c){if(this._oCustomPanel){this._oHomePage.removeContent(this._oCustomPanel);}this._oCustomPanel=c(this._options);this._oHomePage.removeContent(this._oContentPanel);this._oHomePage.insertContent(this._oCustomPanel,0);this._oSelectedBar.addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');}else{this._oCustomPanel=null;if(this._oHomePage.indexOfContent(this._oContentPanel)===-1){this._oHomePage.insertContent(this._oContentPanel,0);this._oSelectedBar.addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');}}return this;};sap.viz.chartpopover.ChartPopover.prototype._updateActionItems=function(){if(!this._oActionList){var a=this.getActionItems();if(a&&a.length>0){this._actionItems=jQuery.extend(true,this._actionItems,a);var b,l=[];for(var i=0,c=a.length;i<c;i++){b=a[i];if(b.type==='action'){l.push(new sap.m.ActionListItem(this._createId('actionItems-'+i),{text:b.text,press:b.press?b.press:function(){}}));}else if(b.type==='navigation'){l.push(new sap.m.StandardListItem(this._createId('actionItems-'+i),{title:b.text,type:'Navigation',press:jQuery.proxy(function(e){var d=e.getParameter('id');var f=parseInt(d.substring(d.lastIndexOf('-')+1));var s=this._actionItems[f].children;if(s&&s.length>0){if(!this._oSubActionItemsPage){this._oSubActionItemsPage=S.create();this._oNavContainer.addPage(this._oSubActionItemsPage.getControl());}this._oSubActionItemsPage.setItems(s);this._oCustomHeader.setTitle(this._actionItems[f].text);this._navigateTo(this._oSubActionItemsPage.getPageId());}},this)}));}}this._oActionList=new sap.m.List({items:l}).addStyleClass('viz-controls-chartPopover-actionList');this._oHomePage.addContent(this._oActionList);}}};sap.viz.chartpopover.ChartPopover.prototype._navigateBack=function(){this._oNavContainer.back();};sap.viz.chartpopover.ChartPopover.prototype._navigateTo=function(p){this._oNavContainer.to(p);};sap.viz.chartpopover.ChartPopover.prototype._createId=function(I){return this.getId()+"-"+I;};};return{'create':function(a,s){try{return new sap.viz.chartpopover.ChartPopover(a,s);}catch(e){_();return arguments.callee.apply(this,arguments);}}};});u('sap/viz/controls/popover/PopOver',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/popover/chartpopover/ChartPopover'],function($,V,O,a,L,C){var P=function(o){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.popover.PopOver";try{jQuery.sap.require("sap.m.Label");jQuery.sap.require("sap.m.List");jQuery.sap.require("sap.m.Bar");jQuery.sap.require("sap.m.Page");jQuery.sap.require("sap.m.ActionListItem");jQuery.sap.require("sap.m.ResponsivePopover");jQuery.sap.require("sap.m.StandardListItem");jQuery.sap.require("sap.m.DisplayListItem");jQuery.sap.require("sap.m.Panel");jQuery.sap.require("sap.m.Button");}catch(e){throw a.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR'),'sap.m','PopOver');}this._chartPopover=C.create(o);};O.extend(P,V);P.prototype._onConnect=function(v,m){P.superclass._onConnect.apply(this,arguments);this._vizProxy().on('showTooltip.PopOver',jQuery.proxy(function(e){this._chartPopover.setOptions(e.data).openBy(e.data.target);},this));this._vizProxy().on('hideTooltip.PopOver',jQuery.proxy(function(){this._chartPopover.close();},this));};P.prototype._onDisconnect=function(){P.superclass._onDisconnect.apply(this,arguments);this._vizProxy().off('showTootip.PopOver');this._vizProxy().off('hideTooltip.PopOver');};P.prototype.destroy=function(){P.superclass.destroy.apply(this,arguments);this._vizProxy().off('showTooltip.PopOver');this._vizProxy().off('hideTooltip.PopOver');};P.prototype.setContents=function(c){for(var i=0;i<c.length;i++){this._chartPopover.addContent(c[i]);}};P.prototype.setActionItems=function(b){for(var i=0;i<b.length;i++){this._chartPopover.addActionItem(b[i]);}};P.prototype.setSubActionItems=function(b){for(var i=0;i<b.length;i++){this._chartPopover.addSubActionItem(b[i]);}};return P;});u('sap/viz/controls/dedicatedlegend/DedicatedLegend',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager'],function($,V,O,a,L){var D=function(o){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.DedicatedLegend.DedicatedLegend";this._defaultChartOption={};try{jQuery.sap.require("sap.m.ResponsivePopover");}catch(e){throw a.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR'),'sap.m','DedicatedLegend');}this._options=o;};O.extend(D,V);D.prototype._onConnect=function(v,m){D.superclass._onConnect.apply(this,arguments);this._olegendDOMID=this._createId('legends');this._oLegendDOM=new sap.ui.core.HTML();this._oPopover=new sap.m.ResponsivePopover(this._createId('legendPopover'),{dal:false,verticalScrolling:true,horizontalScrolling:false,placement:sap.m.PlacementType.Auto,contentWidth:"18rem",title:'Legends',content:[this._oLegendDOM]});this._oPopover.addStyleClass('viz-controls-dedicatedLegend');this._oPopover.attachBeforeClose(function(){console.log('close');},this);this._maxHeight=this._vizProxy().getSize().height*0.8-48-6;};D.prototype._open=function(o){this._oPopover.attachBeforeOpen(jQuery.proxy(function(){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");this._vizProxy().setProperties({legendGroup:{renderTo:function(){return s;}}});var c=parseInt($(s).attr('height'))+4;this._oLegendDOM.setContent($(s).outerHTML());this._oPopover.setContentHeight(Math.min(c,this._maxHeight)+'px');},this));this._oPopover.openBy(o);};D.prototype._onDisconnect=function(){D.superclass._onDisconnect.apply(this,arguments);};D.prototype.destroy=function(){D.superclass.destroy.apply(this,arguments);};D.prototype._createId=function(I){return this._uid+"-"+I;};D.prototype.updateLegendVisibility=function(){var c=this._vizProxy().getProperties();if(this._isDefaultLegend(c.legendGroup.layout.position)){if((c.legend&&c.legend.visible)||(c.sizeLegend&&c.sizeLegend.visible)){this._hideLegend(c);this._vizProxy().setProperties(c);}else{this._vizProxy().setProperties(this._defaultChartOption);}}else{if(this._oPopover.isOpen()){this._oPopover.close();}else{this._vizProxy().setProperties(this._defaultChartOption);this._open(this._options.openBy);}}};D.prototype.parseDefaultLegendProperties=function(p){$.extend(true,this._defaultChartOption,p);if(this._defaultChartOption.legend&&this._defaultChartOption.legend.visible===false){if(this._defaultChartOption.sizeLegend){if(this._defaultChartOption.sizeLegend.visible===false){this._defaultChartOption.legend.visible=true;this._defaultChartOption.sizeLegend.visible=true;}}else{this._defaultChartOption.legend.visible=true;}}if(!this._isDefaultLegend(p.legendGroup.layout.position)){this._hideLegend(p);}return p;};D.prototype._isDefaultLegend=function(p){return(p==='top'||p==='bottom')?(this._vizProxy().getSize().height>=480):(this._vizProxy().getSize().width>=600);};D.prototype._hideLegend=function(p){if(p.legend){p.legend.visible=false;}if(p.sizeLegend){p.sizeLegend.visible=false;}};D.prototype._showLegend=function(p){if(p.legend){p.legend.visible=true;}if(p.sizeLegend){p.sizeLegend.visible=true;}};return D;});(function(g){var e=("sap/viz/controls/Version,sap/viz/controls/common/config/GlobalConfig,sap/viz/controls/common/constants/ChartConst,sap/viz/controls/common/constants/CSSConst,sap/viz/controls/common/feeds/AnalysisObject,sap/viz/controls/common/feeds/AnalyticalType,sap/viz/controls/common/feeds/AutoFeedingUtils,sap/viz/controls/common/feeds/FeedItem,sap/viz/controls/common/feeds/HierarchyLevelObject,sap/viz/controls/common/filter/AbstractFilter,sap/viz/controls/common/filter/DateRangeFilter,sap/viz/controls/common/filter/NumericRangeFilter,sap/viz/controls/common/filter/ValueFilter,sap/viz/controls/common/managers/DragManager,sap/viz/controls/common/managers/LangManager,sap/viz/controls/common/utils/InfoChartUtil,sap/viz/controls/common/utils/Serialization,sap/viz/controls/common/views/menu/MenuGroup,sap/viz/controls/common/views/menu/MenuItem,sap/viz/controls/services/FakeDataService,sap/viz/controls/builder/VizBuilder,sap/viz/controls/annotation/Annotation,sap/viz/controls/annotationcontrol/AnnotationControl,sap/viz/controls/chart/Chart,sap/viz/controls/plugins/infochart/setup,sap/viz/controls/contextmenu/ContextMenu,sap/viz/controls/custombutton/CustomButton,sap/viz/controls/feeding/FeedingPanel,sap/viz/controls/frame/VizFrame,sap/viz/controls/mapbuilder/MapBuilder,sap/viz/controls/filterbar/FilterBar,sap/viz/controls/filterbar/FilterItem,sap/viz/controls/filterbar0/FilterBar,sap/viz/controls/playcontrol/PlayControl,sap/viz/controls/propertyeditor/PropertyEditor,sap/viz/controls/switchbar/SwitchBar,sap/viz/controls/popover/PopOver,sap/viz/controls/dedicatedlegend/DedicatedLegend").split(/,\s*/);if(e[0]==="// REPLACE_"+"EXPORT_LIST_HERE")e=['sap/viz/controls/annotationcontrol/AnnotationItem','sap/viz/controls/builder/VizBuilder','sap/viz/controls/chart/Chart','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/AutoFeedingUtils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/utils/Serialization','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/views/menu/MenuItem','sap/viz/controls/feeding/FeedingPanel','sap/viz/controls/filterbar/FilterBar','sap/viz/controls/filterbar/FilterItem','sap/viz/controls/frame/VizFrame','sap/viz/controls/mapbuilder/MapBuilder','sap/viz/controls/playcontrol/PlayControl','sap/viz/controls/plugins/infochart/setup','sap/viz/controls/propertyeditor/PropertyEditor','sap/viz/controls/services/FakeDataService','sap/viz/controls/switchbar/SwitchBar','sap/viz/controls/popover/PopOver','sap/viz/controls/dedicatedlegend/DedicatedLegend','sap/viz/controls/Version'];var a=g.jQuery;if(a){if(jQuery.holdReady){jQuery.holdReady(true);}else{jQuery.readyWait+=1;}}A(e,function(){var b=arguments;e.forEach(function(m,i){var n=m.split("/");n.reduce(function(p,c,d){if(!p[c]){if(d<n.length-1){p[c]={};}else{p[c]=b[i];}}return p[c];},g);});if(a){if(jQuery.holdReady){jQuery.holdReady(false);}else{jQuery.ready(true);}}});})(this);})();
