VBI.VBIContext=
function(c){"use strict";var v={};v.vbiclass="VBIContext";v.m_bLoaded=false;v.m_Resources=null;v.m_Config=null;v.m_DataTypeProvider=null;v.m_DataProvider=null;v.m_SceneManager=null;v.m_MapProviders=null;v.m_MapLayerStackManager=null;v.m_Windows=null;v.m_Actions=null;v.m_Automations=null;v.m_Menus=null;v.m_Control=c;v.m_deltacolTable=[];var n=new Date();v.m_StartupTime=n.getTime();v.clear=function(){if(v.m_Resources){v.m_Resources.clear();}if(v.m_Config){v.m_Config.clear();}if(v.m_DataTypeProvider){v.m_DataTypeProvider.clear();}if(v.m_DataProvider){v.m_DataProvider.clear();}if(v.m_SceneManager){v.m_SceneManager.clear();}if(v.m_MapProviders){v.m_MapProviders.clear();}if(v.m_MapLayerStackManager){v.m_MapLayerStackManager.clear();}if(v.m_Windows){v.m_Windows.clear();}if(v.m_Actions){v.m_Actions.clear();}if(v.m_Automations){v.m_Automations.clear();}if(v.m_Menus){v.m_Menus.clear();}v.m_Control=null;v.m_Resources=null;v.m_Config=null;v.m_DataTypeProvider=null;v.m_DataProvider=null;v.m_SceneManager=null;v.m_MapProviders=null;v.m_MapLayerStackManager=null;v.m_Windows=null;v.m_Actions=null;v.m_Automations=null;v.m_Menus=null;};v.GetResources=function(){if(!v.m_Resources){v.m_Resources=new VBI.Resources();}return(v.m_Resources);};v.GetConfig=function(){if(!v.m_Config){v.m_Config=new VBI.Configurations();}return(v.m_Config);};v.GetMainScene=function(){if(v.m_Windows){var w=v.m_Windows.GetMainWindow();if(w){var s=w.GetScene();if(s){return s;}}}return null;};v.FireAction=function(b,s,d,e,p,i,f,h){var g=null;if(jQuery.type(d)=='object'){g=d.m_ID;}else if(jQuery.type(d)=='string'){g=d;}var o={};var r=(o["SAPVB"]={});r["version"]="2.0";r["xmlns:VB"]="VB";var A=(r["Action"]={});A.name=b.m_name;A.object=g;A.id=b.m_id;if(i!=undefined){A.instance=i;}else if(e){A.instance=e.GetPath();}var x=0.0;var y=0.0;var m=false;if(p){A.Params={};A.Params.Param=[];for(var a in p){var t={};t["name"]=a;t["#"]=p[a];A.Params.Param.push(t);if(a=='x'){x=p[a];m=true;}if(a=='y'){y=p[a];m=true;}}}if(d=="Thumbnail"){x*=(s.GetInternalDivWidth()/s.m_Div.clientWidth);y*=(s.GetInternalDivHeight()/s.m_Div.clientHeight);}if(v.m_DataProvider){v.m_DataProvider.store(r);}var l;if(b.m_additionalProperties&&(l=b.m_additionalProperties.length)){var j=A.AddActionProperties={};var k=j.AddActionProperty=[];for(var q=0;q<l;++q){var u,w;switch(b.m_additionalProperties[q]){case'zoom':k.push({name:'zoom','#':s.GetCurrentZoomlevel().toString()});break;case'pieitem':if(d instanceof VBI.VisualObjects.Pie&&h){k.push({name:'pieitem','#':h.m_Detail.m_slice});}break;case'centerpoint':u=VBI.MathLib.RadToDeg(s.GetCenterPos());k.push({name:'centerpoint','#':u[0].toString()+';'+u[1].toString()+';0.0'});break;case'vos':k.push({name:'vos','#':e.cnt});break;case'subclusters':w=(e.isCl==4&&e.bw!=undefined?e.bw.length:-1);k.push({name:'subclusters','#':w});break;case'clustersnextlod':if(e.isCl==4&&e.bw!=undefined){w=(s.GetCurrentZoomlevel()==e.lod?e.bw.length:1);}else{w=-1;}k.push({name:'clustersnextlod','#':w});break;case'clusterarea':var z="";if(e.isCl==4&&e.bo!=undefined){z=this.m_Clustering.getClusterArea(s,e);}k.push({name:'clusterarea','#':z});break;case'pos':if(m){u=s.GetPosFromVPPoint([x,y,0]);k.push({name:'pos','#':u[0].toString()+';'+u[1].toString()+';0.0'});}break;case'pitch':k.push({name:'pitch','#':'0.0'});break;case'yaw':k.push({name:'yaw','#':'0.0'});break;default:break;}}}var B=JSON.stringify(r,null,'  ');if(v.m_Control){if(f){return v.m_Control.fireEvent("submit",{data:B},true);}v.m_Control.fireSubmit({data:B});}};v.onRenderLayer=function(a){v.m_Control.fireRender({canvas:a});};v.onMoveLayer=function(a){v.m_Control.fireMove({canvas:a});};v.onZoomLayer=function(a){v.m_Control.fireZoom({canvas:a});};v.onOpenWindow=function(i,d){v.m_Control.fireOpenWindow({id:i,contentarea:d});};v.onCloseWindow=function(i,d){v.m_Control.fireCloseWindow({id:i,contentarea:d});};v.onOpenContainer=function(i,d){v.m_Control.fireContainerCreated({id:i,contentarea:d});};v.onCloseContainer=function(i,d){v.m_Control.fireContainerDestroyed({id:i,contentarea:d});};v.onChangeTrackingMode=function(m,s){v.m_Control.fireChangeTrackingMode({mode:m,bSet:s});};v.DoMinimize=function(s){var t=v.moThumbnail;var a=this.m_Control;var S;if(!t.bThumbnailed){t.strOrgWidth=this.m_Control.getWidth();t.strOrgHeight=this.m_Control.getHeight();t.nOrgWidth=t.nFullWidth?t.nFullWidth:s.m_nDivWidth;t.nOrgHeight=t.nFullHeight?t.nFullHeight:s.m_nDivHeight;t.bThumbnailed=true;S=((t.nThumbWidth===s.m_nDivWidth)&&(t.nThumbHeight===s.m_nDivHeight));}else{S=((t.nThumbWidth===parseInt(a.getWidth(),10))&&(t.nThumbHeight===parseInt(a.getHeight(),10)));if(t.nFullWidth&&t.nOrgWidth!=t.nFullWidth){t.nOrgWidth=t.nFullWidth;S=true;}if(t.nFullHeight&&t.nOrgHeight!=t.nFullHeight){t.nOrgHeight=t.nFullHeight;S=true;}}if(t.nThumbWidth<=0&&t.nOrgHeight>0){t.nThumbWidth=t.nOrgWidth/t.nOrgHeight*t.nThumbHeight;}if(t.nThumbHeight<=0&&t.nOrgWidth>0){t.nThumbHeight=t.nOrgHeight/t.nOrgWidth*t.nThumbWidth;}a.setWidth(t.nThumbWidth);a.setHeight(t.nThumbHeight);if(S){s.resizeCanvas(0);}};return v;}
;
