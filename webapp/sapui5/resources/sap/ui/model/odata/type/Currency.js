/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/model/type/Currency"],function(P,V,B){"use strict";var c=new Map(),r=/\.(\d+)$/;function g(k,p){return sap.ui.getCore().getLibraryResourceBundle().getText(k,p);}var C=B.extend("sap.ui.model.odata.type.Currency",{constructor:function(f,o,d){if(f&&f["customCurrencies"]){throw new Error("Format option customCurrencies is not supported");}if(o){throw new Error("Constraints not supported");}if(arguments.length>2){throw new Error("Only the parameter oFormatOptions is supported");}this.bParseAsString=!f||!("parseAsString"in f)||f.parseAsString;f=Object.assign({},f,{parseAsString:true});B.call(this,f,o);this.bParseWithValues=true;this.setConstraints=function(){throw new Error("Constraints not supported");};this.setFormatOptions=function(){throw new Error("Format options are immutable");};this.mCustomCurrencies=undefined;}});C.prototype.formatValue=function(v,t){var a=this;if(this.mCustomCurrencies===undefined&&v&&v[2]!==undefined){if(v[2]===null){this.mCustomCurrencies=null;}else{this.mCustomCurrencies=c.get(v[2]);if(!this.mCustomCurrencies){this.mCustomCurrencies={};Object.keys(v[2]).forEach(function(k){a.mCustomCurrencies[k]={decimals:v[2][k].UnitSpecificScale,isoCode:v[2][k].StandardCode};});c.set(v[2],this.mCustomCurrencies);}B.prototype.setFormatOptions.call(this,Object.assign({customCurrencies:this.mCustomCurrencies},this.oFormatOptions));}}if(!v||v[0]===undefined||v[1]===undefined||this.mCustomCurrencies===undefined&&v[2]===undefined){return null;}return B.prototype.formatValue.call(this,v.slice(0,2),t);};C.prototype.getInterface=function(){return this;};C.prototype.getName=function(){return"sap.ui.model.odata.type.Currency";};C.prototype.parseValue=function(v,s,a){var b,d,f,m,e;if(this.mCustomCurrencies===undefined){throw new P("Cannot parse value without currency customizing");}e=B.prototype.parseValue.apply(this,arguments);b=e[1]||a[1];if(e[0].includes(".")){e[0]=e[0].replace(/0+$/,"").replace(/\.$/,"");}if(b&&this.mCustomCurrencies){m=r.exec(e[0]);f=m?m[1].length:0;d=this.mCustomCurrencies[b].decimals;if(f>d){throw new P(d?g("EnterNumberFraction",[d]):g("EnterInt"));}}if(!this.bParseAsString){e[0]=Number(e[0]);}return e;};C.prototype.validateValue=function(v){if(this.mCustomCurrencies===undefined){throw new V("Cannot validate value without currency customizing");}};return C;});
