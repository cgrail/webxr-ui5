{
"version":"2.0",
"name":"sap.ui.vk.library-preload",
"dependencies":["sap.ui.core.library-preload"],
"modules":{
	"sap/ui/vk/BaseNodeProxy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/Object'],function(q,B){'use strict';var a=B.extend('sap.ui.vk.BaseNodeProxy',{metadata:{'abstract':true}});return a;});\n",
	"sap/ui/vk/Camera.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,M){'use strict';var C=M.extend('sap.ui.vk.Camera',{metadata:{properties:{'position':{type:'float[]'},'targetDirection':{type:'float[]'},'upDirection':{type:'float[]'},'nearClipPlane':{type:'float'},'farClipPlane':{type:'float'},'isModified':{type:'boolean'}}}});C.prototype.getCameraRef=function(){return null;};return C;});\n",
	"sap/ui/vk/ContainerBase.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','sap/ui/core/IconPool','sap/ui/core/Popup','sap/ui/Device','sap/m/library','./ContainerBaseRenderer'],function(q,l,C,I,P,D,m,a){'use strict';var b=C.extend('sap.ui.vk.ContainerBase',{metadata:{library:'sap.ui.vk',properties:{'showFullScreen':{type:'boolean',group:'Misc',defaultValue:true},'showSettings':{type:'boolean',group:'Misc',defaultValue:true},'showSelection':{type:'boolean',group:'Misc',defaultValue:true},'fullScreen':{type:'boolean',group:'Misc',defaultValue:false},'title':{type:'string',group:'Misc',defaultValue:''},'autoAdjustHeight':{type:'boolean',group:'Misc',defaultValue:false}},defaultAggregation:'content',aggregations:{content:{type:'sap.ui.vk.ContainerContent',multiple:true,singularName:'content'},'toolbar':{type:'sap.m.Toolbar',multiple:false,visibility:'hidden'}},associations:{},events:{'contentChange':{parameters:{selectedItemId:'string'}},'settingsPressed':{}}}});b.prototype.switchContent=function(c){this.setSelectedContent(c);this.rerender();};b.prototype.updateContainer=function(){this._contentChanged=true;this.rerender();};b.prototype.setSelectedContent=function(c){this._oSelectedContent=c;};b.prototype.getSelectedContent=function(){return this._oSelectedContent;};b.prototype.init=function(){this._selectionState='SINGLE';this._firstTime=true;this._aContentIcons=[];this._selectedContent=null;this._oSelectedContent=null;this._bSegmentedButtonSaveSelectState=false;this._oMenu=null;this._customButtons=[];var L=new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.High});var c=sap.m.ButtonType.Transparent;this._oFullScreenButton=new sap.m.OverflowToolbarButton({layoutData:L,type:c,icon:'sap-icon://full-screen',text:sap.ui.vk.getResourceBundle().getText('CONTAINERBASE_FULLSCREEN'),tooltip:sap.ui.vk.getResourceBundle().getText('CONTAINERBASE_FULLSCREEN'),press:function(){this._bSegmentedButtonSaveSelectState=true;this._toggleFullScreen();}.bind(this)});this._oSettingsButton=new sap.m.OverflowToolbarButton({layoutData:L.clone(),type:c,icon:'sap-icon://action-settings',text:sap.ui.vk.getResourceBundle().getText('CONTAINERBASE_SETTINGS'),tooltip:sap.ui.vk.getResourceBundle().getText('CONTAINERBASE_SETTINGS'),press:function(){this._bSegmentedButtonSaveSelectState=true;this.fireSettingsPressed();}.bind(this)});this._oSelectionButtonSingle=new sap.m.SegmentedButtonItem({icon:'sap-icon://map-container/selection-single',tooltip:sap.ui.vk.getResourceBundle().getText('CONTAINERBASE_MENU_SINGLE'),press:this._handleSelection.bind(this,'SINGLE')});this._oSelectionButtonRectangle=new sap.m.SegmentedButtonItem({icon:'sap-icon://map-container/selection-rectangle',tooltip:sap.ui.vk.getResourceBundle().getText('CONTAINERBASE_MENU_RECT'),press:this._handleSelection.bind(this,'RECT')});this._oSelectionButtonLasso=new sap.m.SegmentedButtonItem({icon:'sap-icon://map-container/selection-lasso',tooltip:sap.ui.vk.getResourceBundle().getText('CONTAINERBASE_MENU_LASSO'),press:this._handleSelection.bind(this,'LASSO')});this._selectionMenu=new sap.m.SegmentedButton({items:[this._oSelectionButtonSingle,this._oSelectionButtonRectangle,this._oSelectionButtonLasso]});this._oPopup=new P({modal:true,shadow:false,autoClose:false});this._oContentSegmentedButton=new sap.m.SegmentedButton({layoutData:L.clone(),select:this._onContentButtonSelect.bind(this)});this._oContTitle=new sap.m.Label();this._oToolbar=new sap.m.OverflowToolbar({width:'auto'}).addStyleClass('sapUiVkContainerBaseToolbar');this.setAggregation('toolbar',this._oToolbar);this.sResizeListenerId=null;if(D.system.desktop){this.sResizeListenerId=sap.ui.core.ResizeHandler.register(this,q.proxy(this._performHeightChanges,this));}else{D.orientation.attachHandler(this._performHeightChanges,this);D.resize.attachHandler(this._performHeightChanges,this);}q.sap.require('sap.ui.thirdparty.URI');var d=[{name:'selection-lasso',unicode:'E000'},{name:'selection-rectangle',unicode:'E001'},{name:'selection-single',unicode:'E002'}],e='map-container',f='map-container';d.forEach(function(i){sap.ui.core.IconPool.addIcon(i.name,e,f,i.unicode);});};b.prototype.exit=function(){if(this._oFullScreenButton){this._oFullScreenButton.destroy();this._oFullScreenButton=undefined;}if(this._oPopup){this._oPopup.destroy();this._oPopup=undefined;}if(this._oContentSegmentedButton){this._oContentSegmentedButton.destroy();this._oContentSegmentedButton=undefined;}if(this._oSelectedContent){this._oSelectedContent.destroy();this._oSelectedContent=undefined;}if(this._oToolbar){this._oToolbar.destroy();this._oToolbar=undefined;}if(D.system.desktop&&this.sResizeListenerId){sap.ui.core.ResizeHandler.deregister(this.sResizeListenerId);this.sResizeListenerId=null;}else{D.orientation.detachHandler(this._performHeightChanges,this);D.resize.detachHandler(this._performHeightChanges,this);}};b.prototype.setFullScreen=function(f){if(this._firstTime){return;}if(this.getFullScreen()==f){return;}var c=this.getProperty('fullScreen');if(c!==f){this._toggleFullScreen();}};b.prototype.onAfterRendering=function(){var t=this;if((this.sResizeListenerId===null)&&(D.system.desktop)){this.sResizeListenerId=sap.ui.core.ResizeHandler.register(this,q.proxy(this._performHeightChanges,this));}if(this.getAutoAdjustHeight()||this.getFullScreen()){q.sap.delayedCall(500,this,function(){t._performHeightChanges();});}this._firstTime=false;if(this.getSelectedContent()!==null){var c=this.getSelectedContent().getContent();if(c instanceof sap.ui.vbm.GeoMap||c instanceof sap.ui.vbm.AnalyticMap){if(this.getShowSelection()){if(this._selectionState==='LASSO'){c.setLassoSelection(true);}else if(this._selectionState==='RECT'){c.setRectangularSelection(true);}else if(this._selectionState==='SINGLE'){c.setRectangularSelection(false);c.setLassoSelection(false);}}}}};b.prototype.onBeforeRendering=function(){var t=this;if(t._contentChanged){t._contentChange();}t._oToolbar.getContent().forEach(function(e){var c=e.getId();var d=e['getPressed']?e.getPressed():null;for(var i in t._customButtons){if(t._customButtons[i].button&&t._customButtons[i].button.getId()==c){t._customButtons[i].toggled=d;}}});t._oToolbar.removeAllContent();t._addToolbarContent();};b.prototype.setTitle=function(v){this._oContTitle.setText(v);this.setProperty('title',v,true);};b.prototype.addContent=function(o){this.addAggregation('content',o);this._contentChanged=true;};b.prototype.insertContent=function(o,i){this.insertAggregation('content',o,i);this._contentChanged=true;};b.prototype.updateContent=function(){this.updateAggregation('content');this._contentChanged=true;};b.prototype._toggleFullScreen=function(){var f=this.getProperty('fullScreen');var s;var h;var c;if(f){this._closeFullScreen();this.setProperty('fullScreen',false,true);c=this.getSelectedContent().getContent();s=c.getId();c.setWidth('100%');h=this._contentHeight[s];if(h){c.setHeight(h);}this.invalidate();}else{var o=this.getAggregation('content');this._contentHeight={};if(o){for(var i=0;i<o.length;i++){c=o[i].getContent();s=c.getId();if(q.isFunction(c.getHeight)){h=c.getHeight();}else{h=0;}this._contentHeight[s]=h;}}this._openFullScreen(true);this.setProperty('fullScreen',true,true);}var d=(f?'sap-icon://full-screen':'sap-icon://exit-full-screen');this._oFullScreenButton.setIcon(d);this._oFullScreenButton.focus();};b.prototype._openFullScreen=function(n){if((n!==null)&&(n===true)){this._oScrollEnablement=new sap.ui.core.delegate.ScrollEnablement(this,this.getId()+'-wrapper',{horizontal:true,vertical:true});}this.$content=this.$();if(this.$content){this.$tempNode=q('<div></div>');this.$content.before(this.$tempNode);this._$overlay=q(\"<div id='\"+q.sap.uid()+\"'></div>\");this._$overlay.addClass('sapUiVkContainerBaseOverlay');this._$overlay.append(this.$content);this._oPopup.setContent(this._$overlay);}else{q.sap.log.warn('Overlay: content does not exist or contains more than one child');}this._oPopup.open(200,undefined,undefined,q('body'));};b.prototype._closeFullScreen=function(){if(this._oScrollEnablement!==null){this._oScrollEnablement.destroy();this._oScrollEnablement=null;}this.$tempNode.replaceWith(this.$content);this._oToolbar.setDesign(sap.m.ToolbarDesign.Auto);this._oPopup.close();this._$overlay.remove();};b.prototype._performHeightChanges=function(){if(this.getAutoAdjustHeight()||this.getFullScreen()){var $=this.$();if(($.find('.sapUiVkContainerBaseToolbarArea').children()[0])&&($.find('.sapUiVkContainerBaseContentArea').children()[0])){var o=this.getSelectedContent().getContent();if(o.getDomRef().offsetWidth!==this.getDomRef().clientWidth){this.rerender();}}}};b.prototype._switchContent=function(c){var o=this._findContentById(c);this.setSelectedContent(o);this.fireContentChange({selectedItemId:c});this.rerender();};b.prototype._contentChange=function(){var c=this.getContent();this._oContentSegmentedButton.removeAllButtons();this._destroyButtons(this._aContentIcons);this._aContentIcons=[];if(c.length===0){this._oContentSegmentedButton.removeAllButtons();this._setDefaultOnSegmentedButton();this.switchContent(null);}if(c){for(var i=0;i<c.length;i++){var d=c[i].getContent();if(d.setWidth){d.setWidth('100%');}var B=new sap.m.SegmentedButtonItem({icon:c[i].getIcon(),tooltip:c[i].getTitle(),key:d.getId()});this._aContentIcons.push(B);this._oContentSegmentedButton.addItem(B);if(i===0){this.setSelectedContent(c[i]);}}}this._contentChanged=false;};b.prototype._onContentButtonSelect=function(e){var c=e.getParameter('key');this._switchContent(c);};b.prototype._findContentById=function(s){var c=null;var o=this.getAggregation('content');if(o){for(var i=0;!c&&i<o.length;i++){if(o[i].getContent().getId()===s){c=o[i];}}}return c;};b.prototype._addToolbarContent=function(){this._oToolbar.addContent(new sap.m.ToolbarSpacer());if(this._aContentIcons.length>1){this._oToolbar.addContent(this._oContentSegmentedButton);}if(this.getSelectedContent()!==null){var c=this.getSelectedContent().getContent();if(c instanceof sap.ui.vbm.GeoMap||c instanceof sap.ui.vbm.AnalyticMap){if(this.getShowSelection()){this._oToolbar.addContent(this._selectionMenu);}}}this._customButtons.forEach(function(i){if(i.visible){var s={type:sap.m.ButtonType.Transparent,layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.High})};if('active'in i){s.enabled=i.active;}if('icon'in i){s.icon=i.icon;}if('activeIcon'in i){s.activeIcon=i.activeIcon;}if('text'in i){s.text=i.text;}if('tooltip'in i){s.tooltip=i.tooltip;}if('press'in i){s.press=i.press;}if('toggled'in i){s.pressed=i.toggled;}if('overflow'in i){s.overflow=i.overflow;}switch(i.type){case sap.ui.vk.MapContainerButtonType.Click:i.button=s.overflow?new sap.m.OverflowToolbarButton(s):new sap.m.Button(s);break;default:i.button=s.overflow?new sap.m.OverflowToolbarToggleButton(s):new sap.m.ToggleButton(s);break;}this._oToolbar.addContent(i.button);}},this);if(this.getShowSettings()){this._oToolbar.addContent(this._oSettingsButton);}if(!D.system.phone&&this.getShowFullScreen()){this._oToolbar.addContent(this._oFullScreenButton);}};b.prototype._setDefaultOnSegmentedButton=function(){if(!this._bSegmentedButtonSaveSelectState){this._oContentSegmentedButton.setSelectedButton(null);}this._bSegmentedButtonSaveSelectState=false;};b.prototype._destroyButtons=function(c){c.forEach(function(B){B.destroy();});};b.prototype._handleSelection=function(c){var d=this.getSelectedContent().getContent();if(d instanceof sap.ui.vbm.GeoMap||d instanceof sap.ui.vbm.AnalyticMap){if(c==='LASSO'){d.setLassoSelection(true);this._selectionState=c;}else if(c==='RECT'){d.setRectangularSelection(true);this._selectionState=c;}else if(c==='SINGLE'){d.setRectangularSelection(false);d.setLassoSelection(false);this._selectionState=c;}}};return b;});\n",
	"sap/ui/vk/ContainerBaseRenderer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(function(){'use strict';var C={};C.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapUiVkContainerBase');r.writeClasses(c);r.write('>');r.write('<div');r.writeAttributeEscaped('id',c.getId()+'-wrapper');r.addClass('sapUiVkContainerBaseWrapper');r.writeClasses();r.write('>');this.writeContentArea(r,c);this.writeToolbarArea(r,c);r.write('</div>');r.write('</div>');};C.writeContentArea=function(r,c){var s=c.getSelectedContent();r.write('<div');r.addClass('sapUiVkContainerBaseContentArea');r.writeClasses();r.write('>');if(s!==null){r.renderControl(s);}else if(c.getContent().length>0){s=c.getContent()[0];r.renderControl(s);}r.write('</div>');};C.writeToolbarArea=function(r,c){r.write('<div');r.addClass('sapUiVkContainerBaseToolbarArea');r.writeClasses();r.write('>');r.renderControl(c._oToolbar);r.write('</div>');};return C;},true);\n",
	"sap/ui/vk/ContainerContent.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['./library','sap/ui/core/Control','./ContainerContentRenderer'],function(l,C,a){'use strict';var b=C.extend('sap.ui.vk.ContainerContent',{metadata:{library:'sap.ui.vk',properties:{'icon':{type:'string',group:'Misc',defaultValue:null},'title':{type:'string',group:'Misc',defaultValue:null}},aggregations:{'content':{type:'sap.ui.core.Control',multiple:false}}}});b.prototype.setContent=function(c){if(c instanceof sap.ui.vbm.GeoMap){c.setNavcontrolVisible(false);c.setWidth('100%');c.setHeight('100%');}this.setAggregation('content',c);return this;};return b;});\n",
	"sap/ui/vk/ContainerContentRenderer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(function(){'use strict';var C={};C.render=function(r,c){r.renderControl(c.getContent());};return C;},true);\n",
	"sap/ui/vk/ContentConnector.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObjectObserver','sap/ui/core/Element','./Messages','./Core'],function(q,M,E,a,V){'use strict';var l=q.sap.log;var C=E.extend('sap.ui.vk.ContentConnector',{metadata:{library:'sap.ui.vk',aggregations:{contentResources:{type:'sap.ui.vk.ContentResource',bindable:'bindable'},viewStateManagers:{type:'sap.ui.vk.ViewStateManager'},contentManagers:{type:'sap.ui.vk.ContentManager',visibility:'hidden'}},defaultAggregation:'contentResources',events:{contentChangesStarted:{parameters:{}},contentChangesFinished:{parameters:{content:{type:'any'},failureReason:{type:'any'}}},contentChangesProgress:{parameters:{phase:{type:'string'},percentage:{type:'float'},source:{type:'any'}}},contentReplaced:{parameters:{newContent:{type:'any'},oldContent:{type:'any'}}},contentDestroying:{parameters:{content:{type:'any'},preventGarbageCollection:{type:'function'}}}}}});sap.ui.vk.getCore().registerClass(C);var b=C.getMetadata().getParent().getClass().prototype;C.prototype.isTreeBinding=function(n){return n==='contentResources';};C.prototype.init=function(){if(b.init){b.init.call(this);}this._inLoading=false;this._delayContentResourcesUpdate=false;this._scheduleContentResourcesUpdateTimerId=null;this._content=null;this._contentManager=null;this._decryptionHandler=null;this._authorizationHandler=null;this._selfObserver=new M(this._observeChanges.bind(this));this._selfObserver.observe(this,{aggregations:['contentResources','viewStateManagers']});};C.prototype.exit=function(){this._selfObserver.disconnect();this._selfObserver=null;if(this._scheduleContentResourcesUpdateTimerId){q.sap.clearDelayedCall(this._scheduleContentResourcesUpdateTimerId);this._scheduleContentResourcesUpdateTimerId=null;}this._delayContentResourcesUpdate=false;this._setContent(null,null);if(b.exit){b.exit.call(this);}};C.prototype._observeChanges=function(d){if(d.name==='contentResources'){this._scheduleContentResourcesUpdate();}else if(d.name==='viewStateManagers'){if(d.mutation==='insert'){d.child.setContentConnector(this);}else if(d.mutation==='remove'){d.child.setContentConnector(null);}}};C.prototype.invalidate=function(o){if(sap.ui.vk.ContentResource&&o instanceof sap.ui.vk.ContentResource){this._scheduleContentResourcesUpdate();return;}b.invalidate.apply(this,arguments);};C.prototype._scheduleContentResourcesUpdate=function(){if(this._inLoading){this._delayContentResourcesUpdate=true;return this;}if(!this._scheduleContentResourcesUpdateTimerId){this._scheduleContentResourcesUpdateTimerId=q.sap.delayedCall(0,this,function(){this._scheduleContentResourcesUpdateTimerId=null;var d=this.getContentResources();if(d.length>0){this._collectContentResourceSourceTypeInformation(d).then(function(i){if(i.dimensions.length>1){q.sap.delayedCall(0,this,function(){this.fireContentChangesStarted();this._setContent(null,null);this.fireContentChangesFinished({content:null,failureReason:{errorMessage:sap.ui.vk.getResourceBundle().getText(a.VIT17.cause)}});l.error(sap.ui.vk.getResourceBundle().getText(a.VIT17.summary),a.VIT17.code,'sap.ui.vk.ContentConnector');});}else if(i.contentManagerClassNames.length>1){q.sap.delayedCall(0,this,function(){this.fireContentChangesStarted();this._setContent(null,null);this.fireContentChangesFinished({content:null,failureReason:{errorMessage:sap.ui.vk.getResourceBundle().getText(a.VIT35.cause)}});l.error(sap.ui.vk.getResourceBundle().getText(a.VIT35.summary),a.VIT35.code,'sap.ui.vk.ContentConnector');});}else if(i.contentManagerClassNames.length===0){q.sap.delayedCall(0,this,function(){this.fireContentChangesStarted();this._setContent(null,null);this.fireContentChangesFinished({content:null,failureReason:{errorMessage:sap.ui.vk.getResourceBundle().getText(a.VIT36.cause)}});l.error(sap.ui.vk.getResourceBundle().getText(a.VIT36.summary),a.VIT36.code,'sap.ui.vk.ContentConnector');});}else if(i.contentManagerClassNames.length===1){var e=this._getContentManagerByClassName(i.contentManagerClassNames[0]);if(e!==this._contentManager){this._setContent(null,null);}e.loadContent(this._content,d);}}.bind(this));}else{q.sap.delayedCall(0,this,function(){this.fireContentChangesStarted();this._setContent(null,null);this.fireContentChangesFinished({content:null});});}});}return this;};C.prototype._handleContentChangesStarted=function(e){this._inLoading=true;this.fireContentChangesStarted();};C.prototype._handleContentChangesFinished=function(e){var d=e.getParameter('content');this._setContent(d,e.getSource());this.fireContentChangesFinished({content:d,failureReason:e.getParameter('failureReason')});this._inLoading=false;if(this._delayContentResourcesUpdate){this._delayContentResourcesUpdate=false;this._scheduleContentResourcesUpdate();}};C.prototype._handleContentChangesProgress=function(e){this.fireContentChangesProgress({phase:e.getParameter('phase'),source:e.getParameter('source'),percentage:e.getParameter('percentage')});};C.prototype._getContentManagerByClassName=function(d){var e,g=this.getAggregation('contentManagers',[]);for(var i=0,h=g.length;i<h;++i){e=g[i];if(e.getMetadata().getName()===d){return e;}}q.sap.require(d);e=new(q.sap.getObject(d));this.addAggregation('contentManagers',e);e.attachContentChangesStarted(this._handleContentChangesStarted,this);e.attachContentChangesFinished(this._handleContentChangesFinished,this);e.attachContentChangesProgress(this._handleContentChangesProgress,this);this._assignDecryptionHandler([e]);this._assignAuthorizationHandler([e]);return e;};C.prototype.getContent=function(){return this._content;};C.prototype.getContentManager=function(){return this._contentManager;};C.prototype._assignDecryptionHandler=function(d){for(var i=0;i<d.length;i++){d[i].setDecryptionHandler(this._decryptionHandler);}};C.prototype._assignAuthorizationHandler=function(d){for(var i=0;i<d.length;i++){d[i].setAuthorizationHandler(this._authorizationHandler);}};C.prototype.setDecryptionHandler=function(h){this._decryptionHandler=h;this._assignDecryptionHandler(this.getAggregation('contentManagers',[]));return this;};C.prototype.setAuthorizationHandler=function(h){this._authorizationHandler=h;this._assignAuthorizationHandler(this.getAggregation('contentManagers',[]));return this;};C.prototype._setContent=function(n,d){var o=this._content,e=this._contentManager;if(o!==n){this._content=n;this._contentManager=d;this.fireContentReplaced({oldContent:o,newContent:n});if(o){var p=false;this.fireContentDestroying({content:o,preventGarbageCollection:function(v){p=v;}});e.destroyContent(o);if(!p){e.collectGarbage();}}}return this;};var r=[{pattern:/(^threejs[:.])|(^(threejs|stream)$)/,dimension:3,contentManagerClassName:'sap.ui.vk.threejs.ContentManager'},{pattern:/^vdsl?$/,dimension:3,contentManagerClassName:'sap.ui.vk.dvl.ContentManager'},{pattern:/^(png|jpg|jpeg|gif|bmp|tiff?|svg)$/,dimension:2,contentManagerClassName:'sap.ui.vk.ImageContentManager'},{pattern:'cgm',dimension:2,contentManagerClassName:'sap.ui.vk.dvl.ContentManager'}];var c=function(d){return new Promise(function(e,g){var h=r.slice();var t=function(i){if(i>=h.length){g();return;}var j=h[i];(function(){var s=d.getSourceType();if(s){s=s.toLowerCase();}if(typeof j==='function'){return j(d);}else if(typeof j.pattern==='string'){var p=j.pattern.toLowerCase();if(p===s){return Promise.resolve(j);}}else if(j.pattern instanceof RegExp){if(j.pattern.test(s)){return Promise.resolve(j);}}return Promise.reject();})().then(function(v){e({dimension:v.dimension,contentManagerClassName:v.contentManagerClassName,settings:v.settings});},function(){t(i+1);});};t(0);});};C.addContentManagerResolver=function(d){if(typeof d==='function'){r.unshift(d);}else{r.unshift({pattern:d.pattern,dimension:d.dimension,contentManagerClassName:d.contentManagerClassName,settings:d.settings});}return this;};C.removeAllContentManagerResolvers=function(){r=[];return this;};C.removeContentManagerResolver=function(d){var e=typeof d==='function',g=typeof d==='string',h=d instanceof RegExp;for(var i=0,j=r.length;i<j;++i){if(e||g){if(r[i]===d){r.splice(i,1);return true;}}else if(h){if(typeof r[i]==='object'&&r[i].pattern instanceof RegExp&&r[i].pattern.source===d.source){r.splice(i,1);return true;}}}return false;};C.prototype._collectContentResourceSourceTypeInformation=function(d){var n=false,u=false,e={},g={},h=[];d.forEach(function flatten(i){h.push(i);i.getContentResources().forEach(flatten);});return Promise.all(h.map(function(i){return c(i).then(function(j){e[j.dimension]=true;g[j.contentManagerClassName]=true;return j;},function(){if(i.getSourceType()){u=true;}else{n=true;}return false;});})).then(function(j){for(var i=0,k=h.length;i<k;++i){if(j[i]){h[i]._contentManagerResolver=j[i];}}return{noSourceTypes:n,unknownSourceTypes:u,dimensions:Object.getOwnPropertyNames(e).sort(),contentManagerClassNames:Object.getOwnPropertyNames(g)};});};var f=C.getMetadata().getName();var m={init:function(){this._contentConnector=null;sap.ui.vk.getCore().attachEvent(f+'-created',this._handleContentConnectorCreated,this).attachEvent(f+'-destroying',this._handleContentConnectorDestroying,this);},exit:function(){this.setContentConnector(null);sap.ui.vk.getCore().detachEvent(f+'-destroying',this._handleContentConnectorDestroying,this).detachEvent(f+'-created',this._handleContentConnectorCreated,this);},setContentConnector:function(d){this.setAssociation('contentConnector',d,true);this._updateContentConnector();return this;},_updateContentConnector:function(){var n=this.getContentConnector(),d=n&&sap.ui.getCore().byId(n)||null;if(this._contentConnector!==d){this._clearContentConnector();if(d){if(this._handleContentChangesStarted){d.attachContentChangesStarted(this._handleContentChangesStarted,this);}if(this._handleContentChangesFinished){d.attachContentChangesFinished(this._handleContentChangesFinished,this);}if(this._handleContentChangesProgress){d.attachContentChangesProgress(this._handleContentChangesProgress,this);}if(this._handleContentReplaced){d.attachContentReplaced(this._handleContentReplaced,this);}if(this._handleContentDestroying){d.attachContentDestroying(this._handleContentDestroying,this);}this._contentConnector=d;if(this._onAfterUpdateContentConnector){this._onAfterUpdateContentConnector();}}}return this;},_clearContentConnector:function(){if(this._contentConnector){if(this._onBeforeClearContentConnector){this._onBeforeClearContentConnector();}if(this._handleContentDestroying){this._contentConnector.detachContentDestroying(this._handleContentDestroying,this);}if(this._handleContentReplaced){this._contentConnector.detachContentReplaced(this._handleContentReplaced,this);}if(this._handleContentChangesProgress){this._contentConnector.detachContentChangesProgress(this._handleContentChangesProgress,this);}if(this._handleContentChangesFinished){this._contentConnector.detachContentChangesFinished(this._handleContentChangesFinished,this);}if(this._handleContentChangesStarted){this._contentConnector.detachContentChangesStarted(this._handleContentChangesStarted,this);}this._contentConnector=null;}return this;},_handleContentConnectorCreated:function(e){if(this.getContentConnector()===e.getParameter('object').getId()){this._updateContentConnector();}},_handleContentConnectorDestroying:function(e){if(this.getContentConnector()===e.getParameter('object').getId()){this._clearContentConnector();}}};C.injectMethodsIntoClass=function(d){var p=d.prototype,i=p.init,e=p.exit;p.init=function(){if(i){i.call(this);}m.init.call(this);};p.exit=function(){m.exit.call(this);if(e){e.call(this);}};p.setContentConnector=m.setContentConnector;p._updateContentConnector=m._updateContentConnector;p._clearContentConnector=m._clearContentConnector;p._handleContentConnectorCreated=m._handleContentConnectorCreated;p._handleContentConnectorDestroying=m._handleContentConnectorDestroying;};return C;});\n",
	"sap/ui/vk/ContentManager.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,M){'use strict';var C=M.extend('sap.ui.vk.ContentManager',{metadata:{'abstract':true,library:'sap.ui.vk',events:{contentChangesStarted:{parameters:{}},contentChangesFinished:{parameters:{content:{type:'any'},failureReason:{type:'object'}}},contentChangesProgress:{parameters:{phase:{type:'string'},percentage:{type:'float'},source:{type:'any'}}}}}});var b=C.getMetadata().getParent().getClass().prototype;C.prototype.init=function(){if(b.init){b.init.call(this);}this._decryptionHandler=null;this._authorizationHandler=null;};C.prototype.destroyContent=function(c){return this;};C.prototype.collectGarbage=function(){return this;};C.prototype.createOrthographicCamera=function(){return null;};C.prototype.createPerspectiveCamera=function(){return null;};C.prototype.destroyCamera=function(c){return this;};C.prototype.setDecryptionHandler=function(h){this._decryptionHandler=h;return this;};C.prototype.setAuthorizationHandler=function(h){this._authorizationHandler=h;return this;};return C;});\n",
	"sap/ui/vk/ContentResource.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/base/ManagedObject'],function(q,l,M){'use strict';var C=M.extend('sap.ui.vk.ContentResource',{metadata:{properties:{source:'any',sourceType:'string',sourceId:'string',localMatrix:'sap.ui.vk.TransformationMatrix',name:'string',password:'string',useSecureConnection:{type:'boolean',defaultValue:true},veid:'string',includeHidden:'boolean',includeAnimation:'boolean',pushPMI:'boolean',metadataFilter:'string',activateView:'string',enableLogger:'boolean',pushViewGroups:'boolean'},aggregations:{contentResources:'sap.ui.vk.ContentResource'}},constructor:function(i,s,S){M.apply(this,arguments);}});C.prototype.isTreeBinding=function(n){return n==='contentResources';};C.prototype.destroy=function(){M.prototype.destroy.call(this);};C.prototype.setLocalMatrix=function(v){var n=this.getNodeProxy();if(n){n.setLocalMatrix(v);}this.setProperty('localMatrix',v,true);return this;};C.prototype.getSourceProperties=function(){return this._shadowContentResource&&this._shadowContentResource.sourceProperties||{};};C.prototype.getNodeProxy=function(){return this._shadowContentResource&&this._shadowContentResource.nodeProxy||null;};C.collectCategories=function(r){var c=[];var m={};function g(a){var s=(a.getSourceType()||'').toLowerCase();if(s){var b=sap.ui.vk.ContentResourceSourceTypeToCategoryMap[s]||'unknown';if(!m.hasOwnProperty(b)){m[b]=true;c.push(b);}}a.getContentResources().forEach(g);}r.forEach(g);return c;};return C;});\n",
	"sap/ui/vk/Core.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,M){'use strict';var C=M.extend('sap.ui.vk.Core',{metadata:{publicMethods:['registerClass']},constructor:function(){if(sap.ui.vk.getCore&&sap.ui.vk.getCore()){return sap.ui.vk.getCore();}M.call(this);sap.ui.vk.getCore=q.sap.getter(this);this._classes=[];}});C.prototype.registerClass=function(c){if(this._classes.indexOf(c)>=0){return this;}var t=this,f=c.getMetadata().getName(),e=f+'-created',a=f+'-destroying',b=c.prototype.register,d=c.prototype.deregister;c.prototype.register=function(){if(b){b.call(this);}t.fireEvent(e,{object:this});};c.prototype.deregister=function(){t.fireEvent(a,{object:this});if(d){d.call(this);}};this._classes.push(c);return this;};return new C();});\n",
	"sap/ui/vk/DownloadManager.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/base/EventProvider','./Messages'],function(q,l,E,M){'use strict';var D=E.extend('sap.ui.vk.DownloadManager',{metadata:{publicMethods:['start','attachItemSucceeded','detachItemSucceeded','attachItemFailed','detachItemFailed','attachAllItemsCompleted','detachAllItemsCompleted'],events:{itemSucceeded:{parameters:{source:{type:'any'},response:{type:'object'}}},itemProgress:{parameters:{source:{type:'any'},loaded:{type:'int'},total:{type:'int'}}},itemFailed:{parameters:{source:{type:'any'},status:{type:'any'},statusText:{type:'string'}}},allItemsCompleted:{}}},constructor:function(s,m){E.apply(this);this._maxParallelTasks=m||5;this._sourcesToProcess=s.slice();this._sourcesBeingProcessed=[];}});D.prototype.start=function(){while(this._pickAndDispatchTask()){}return this;};D.prototype.queue=function(s){this._sourcesToProcess.push(s);this._pickAndDispatchTask();return this;};D.prototype._pickAndDispatchTask=function(){if(this._sourcesToProcess.length>0&&this._sourcesBeingProcessed.length<this._maxParallelTasks){var s=this._sourcesToProcess.shift();this._sourcesBeingProcessed.push(s);this._runTask(s);return true;}return false;};D.prototype._taskFinished=function(s){var i=this._sourcesBeingProcessed.indexOf(s);if(i>=0){this._sourcesBeingProcessed.splice(i,1);}return this;};D.prototype._queueIsEmpty=function(){return this._sourcesToProcess.length===0&&this._sourcesBeingProcessed.length===0;};D.prototype._runTask=function(s){var t=this;if(typeof s==='string'){var x=new(typeof sinon==='object'&&sinon.xhr&&sinon.xhr.XMLHttpRequest||XMLHttpRequest);x.onerror=function(e){t._taskFinished(s);t._pickAndDispatchTask();t.fireItemFailed({source:s,status:x.status,statusText:x.statusText});if(t._queueIsEmpty()){t._asyncFireAllItemsCompleted();}};x.onload=function(e){t._taskFinished(s);t._pickAndDispatchTask();if(x.status===200||x.status===0){t.fireItemSucceeded({source:s,response:x.response});}else{t.fireItemFailed({source:s,status:x.status,statusText:x.statusText});}if(t._queueIsEmpty()){t._asyncFireAllItemsCompleted();}};x.onprogress=function(e){t.fireItemProgress({source:s,loaded:e.loaded,total:e.total});};x.open('GET',s,true);x.responseType='arraybuffer';x.send(null);}else if(s instanceof File){var f=new FileReader();f.onload=function(e){t._taskFinished(s);t._pickAndDispatchTask();t.fireItemSucceeded({source:s,response:f.result});if(t._queueIsEmpty()){t._asyncFireAllItemsCompleted();}};f.onerror=function(e){t._taskFinished(s);t._pickAndDispatchTask();t.fireItemFailed({source:s,status:f.error.name,statusText:f.error.message});if(t._queueIsEmpty()){t._asyncFireAllItemsCompleted();}};f.onprogress=function(e){t.fireItemProgress({source:s.name,loaded:e.loaded,total:e.total});};f.readAsArrayBuffer(s);}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT5.summary),M.VIT5.code,'sap.ui.vk.DownloadManager');}return this;};D.prototype._asyncFireAllItemsCompleted=function(){q.sap.delayedCall(0,this,this.fireAllItemsCompleted);};D.prototype.attachItemSucceeded=function(d,f,a){return this.attachEvent('itemSucceeded',d,f,a);};D.prototype.detachItemSucceeded=function(f,a){return this.detachEvent('itemSucceeded',f,a);};D.prototype.fireItemSucceeded=function(p,a,e){return this.fireEvent('itemSucceeded',p,a,e);};D.prototype.attachItemFailed=function(d,f,a){return this.attachEvent('itemFailed',d,f,a);};D.prototype.detachItemFailed=function(f,a){return this.detachEvent('itemFailed',f,a);};D.prototype.fireItemFailed=function(p,a,e){return this.fireEvent('itemFailed',p,a,e);};D.prototype.attachAllItemsCompleted=function(d,f,a){return this.attachEvent('allItemsCompleted',d,f,a);};D.prototype.detachAllItemsCompleted=function(f,a){return this.detachEvent('allItemsCompleted',f,a);};D.prototype.fireAllItemsCompleted=function(p,a,e){return this.fireEvent('allItemsCompleted',p,a,e);};D.prototype.attachItemProgress=function(d,f,a){return this.attachEvent('itemProgress',d,f,a);};D.prototype.detachItemProgress=function(f,a){return this.detachEvent('itemProgress',f,a);};D.prototype.fireItemProgress=function(p,a,e){return this.fireEvent('itemProgress',p,a,e);};return D;});\n",
	"sap/ui/vk/DvlException.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['sap/ui/base/Exception'],function(E){'use strict';var D=function(c,m){this.name='DvlException';this.code=c;this.message=m;};D.prototype=Object.create(E.prototype);return D;});\n",
	"sap/ui/vk/FlexibleControl.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/Control','sap/ui/core/EnabledPropagator','./FlexibleControlRenderer'],function(q,C,E,F){'use strict';var a=C.extend('sap.ui.vk.FlexibleControl',{metadata:{library:'sap.ui.vk',properties:{width:{type:'sap.ui.core.CSSSize',group:'Dimension',defaultValue:null},height:{type:'sap.ui.core.CSSSize',group:'Dimension',defaultValue:null},layout:{type:'string',group:'Behavior',defaultValue:'Stacked'},enabled:{type:'boolean',group:'Behavior',defaultValue:true}},defaultAggregation:'content',aggregations:{content:{type:'sap.ui.core.Control',multiple:true,singularName:'content'}},designTime:true}});E.call(a.prototype);return a;},true);\n",
	"sap/ui/vk/FlexibleControlLayoutData.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/LayoutData','./library'],function(q,L,l){'use strict';var F=L.extend('sap.ui.vk.FlexibleControlLayoutData',{metadata:{library:'sap.ui.vk',properties:{size:{type:'sap.ui.core.CSSSize',group:'Dimension',defaultValue:'auto'},minSize:{type:'sap.ui.core.CSSSize',group:'Dimension',defaultValue:'0px'},marginTop:{type:'sap.ui.core.CSSSize',group:'Dimension',defaultValue:'0px'},marginBottom:{type:'sap.ui.core.CSSSize',group:'Dimension',defaultValue:'0px'}}}});return F;},true);\n",
	"sap/ui/vk/FlexibleControlRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var F={};F.render=function(r,f){var a=r;a.write('<div');a.writeControlData(f);a.addClass('sapUiFlexControl');if(f.getWidth()&&f.getWidth()!=''){a.addStyle('width',f.getWidth());}if(f.getHeight()&&f.getHeight()!=''){a.addStyle('height',f.getHeight());}a.writeStyles();a.writeClasses();a.write('>');var c=f.getContent();var l=f.getLayout();var b='sapUiFlexCellStacked';if(l=='Vertical'){b='sapUiFlexCellVertical';}for(var i=0;i<c.length;i++){var d=c[i];a.write(\"<div id=\\\"\"+f.getId()+'Content_'+i+\"\\\" class=\\\"\"+b+\"\\\"\");var e=d.getLayoutData();if(e&&l!='Stacked'){a.write(\" style=\\\"\");if(e.getSize()&&e.getSize()!=''){a.write('height: '+e.getSize()+';');}if(e.getMinSize()&&e.getMinSize()!=''){a.write('min-height: '+e.getMinSize()+';');}if(e.getMarginTop()&&e.getMarginTop()!=''){a.write('margin-top: '+e.getMarginTop()+';');}if(e.getMarginBottom()&&e.getMarginBottom()!=''){a.write('margin-bottom: '+e.getMarginBottom()+';');}a.write(\"\\\"\");}a.write('>');a.renderControl(d);a.write('</div>');}a.write('</div>');};return F;},true);\n",
	"sap/ui/vk/ImageContentManager.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./Messages','./ContentManager'],function(q,M,C){'use strict';var I=C.extend('sap.ui.vk.ImageContentManager',{metadata:{library:'sap.ui.vk'}});var b=I.getMetadata().getParent().getClass().prototype;I.prototype.init=function(){if(b.init){b.init.call(this);}this._handleLoadSucceededProxy=this._handleLoadSucceeded.bind(this);this._handleLoadFailedProxy=this._handleLoadFailed.bind(this);};I.prototype.exit=function(){if(b.exit){b.exit.call(this);}};I.prototype.loadContent=function(c,a){if(a.length!==1){q.sap.delayedCall(0,this,function(){this.fireContentChangesStarted();this.fireContentChangesFinished({content:null,failureReason:{errorMessage:'Only a single image can be loaded.'}});});}else if(a[0].getContentResources().length>0){q.sap.delayedCall(0,this,function(){this.fireContentChangesStarted();this.fireContentChangesFinished({content:null,failureReason:{errorMessage:'Cannot load a hierarchy of images.'}});});}else{var d=a[0],s=d.getSource(),e=d.getSourceType();if(s instanceof File){var f=new FileReader();f.onload=function(g){this._loadImageFromUrl(c,f.result,e);}.bind(this);f.readAsDataURL(s);}else{var t=new sap.m.Image({src:s});s=t.getSrc();t.destroy();this._loadImageFromUrl(c,s,e);}}};I.prototype._addEventListeners=function(h){h.addEventListener('load',this._handleLoadSucceededProxy);h.addEventListener('error',this._handleLoadFailedProxy);};I.prototype._removeEventListeners=function(h){h.removeEventListener('error',this._handleLoadFailedProxy);h.removeEventListener('load',this._handleLoadSucceededProxy);};I.prototype._addSvgQuirks=function(h){h.style.setProperty('visibility','collapse');h.style.setProperty('width','0');h.style.setProperty('height','0');h.style.setProperty('position','absolute');document.body.appendChild(h);return this;};I.prototype._removeSvgQuirks=function(h){h.parentElement.removeChild(h);h.style.removeProperty('visibility');h.style.removeProperty('width');h.style.removeProperty('height');h.style.removeProperty('position');return this;};I.prototype._loadImageFromUrl=function(c,u,s){this.fireContentChangesStarted();switch(s.toLowerCase()){case'svg':var a=document.createElement('object');this._addEventListeners(a);a.type='image/svg+xml';a.data=u;a.className='SVGImage';this._addSvgQuirks(a);break;case'jpg':case'jpeg':case'png':case'gif':case'bmp':case'tif':case'tiff':var i=document.createElement('img');this._addEventListeners(i);i.src=u;break;default:q.sap.delayedCall(0,this,function(){this.fireContentChangesFinished({content:null,failureReason:{errorMessage:'Unsupported image type.',sourcesFailedToDownload:[{source:u}]}});});break;}};I.prototype._handleLoadSucceeded=function(a){var c=a.target;if(c instanceof HTMLObjectElement){try{if(!c.getSVGDocument()){this._handleLoadFailed(a);return;}}catch(e){}}this._removeEventListeners(c);if(c instanceof HTMLObjectElement){this._removeSvgQuirks(c);}this.fireContentChangesFinished({content:c});};I.prototype._handleLoadFailed=function(e){var c=e.target;this._removeEventListeners(c);if(c instanceof HTMLObjectElement){this._removeSvgQuirks(c);}this.fireContentChangesFinished({content:null,failureReason:{errorMessage:'Failed to load the image.',sourcesFailedToDownload:[{source:c instanceof HTMLImageElement?c.src:c.data}]}});};return I;});\n",
	"sap/ui/vk/InputDeviceKeyboard.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var I=E.extend('sap.ui.vk.InputDeviceKeyboard',{metadata:{publicMethods:['enable','disable']},constructor:function(l){this._loco=l;}});I.prototype.enable=function(c){this._control=c;this._control.attachBrowserEvent('keydown keyup keypress',this._onKeyEvent,this);};I.prototype.disable=function(){this._control.detachBrowserEvent('keydown keyup keypress',this._onKeyEvent,this);};I.prototype._onKeyEvent=function(e){this._loco.keyEventHandler(e,this._control);};return I;},true);\n",
	"sap/ui/vk/InputDeviceMouse.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var I=E.extend('sap.ui.vk.InputDeviceMouse',{metadata:{publicMethods:['isSupported','enable','disable']},constructor:function(L){this._loco=L;this._buttons=0;this._buttonFlagsValue=0;this._zoomOrigin={x:0,y:0};this._mousedownProxy=this._onmousedown.bind(this);this._mouseupProxy=this._onmouseup.bind(this);this._mousemoveProxy=this._onmousemove.bind(this);this._mousewheelProxy=this._onmousewheel.bind(this);this._contextmenuProxy=this._oncontextmenu.bind(this);this._onmouseupWindowListenerProxy=this._onmouseupWindowListener.bind(this);}});I.prototype._buttonFlags=function(b,d){if(d){this._buttonFlagsValue|=(1<<b);}else{this._buttonFlagsValue&=~(1<<b);}return this._buttonFlagsValue;};I.prototype._eventToInput=function(e,b){var a=(e.buttons!=undefined)?e.buttons:this._buttonFlagsValue;if(b){a=b;}var i={x:0,y:0,z:0,d:0,n:0,buttons:a,scroll:e.wheelDelta,points:[],handled:false,jqueryEvent:e};var n=0;switch(a){case 0:case 1:n=1;i.points.push({x:e.pageX,y:e.pageY,z:0});break;case 3:case 4:case 5:n=2;i.points.push({x:e.pageX,y:e.pageY,z:0});i.points.push({x:e.pageX,y:e.pageY,z:0});break;case 2:n=2;i.points.push({x:this._zoomOrigin.x,y:e.pageY,z:0});i.points.push({x:this._zoomOrigin.x,y:e.pageY+(this._zoomOrigin.y-e.pageY)*2,z:0});break;default:n=0;break;}i.n=n;return i;};I.prototype._onmouseup=function(e){this._capturedByControl=true;var b=(e.buttons!=undefined)?e.buttons:this._buttonFlags(e.button,false);if(e['_sapui_handledByControl']){return;}var i=this._eventToInput(e,this._buttons);this._loco.endGesture(i,this._control);if(b==2){this._zoomOrigin.x=e.pageX;this._zoomOrigin.y=e.pageY;}i=this._eventToInput(e);if(b!=0){i.handled=false;this._loco.beginGesture(i,this._control);}this._buttons=b;};I.prototype._onmouseupWindowListener=function(e){if(!this._capturedByControl){this._onmouseup(e);}this._capturedByControl=false;};I.prototype._onmousemove=function(e){if(e['_sapui_handledByControl']){return;}if(sap.ui.Device.os.name===sap.ui.Device.os.OS.MACINTOSH&&e.buttons===2){e.buttons=3;}var i=this._eventToInput(e);this._loco.move(i,this._control);};I.prototype._onmousedown=function(e){var b=(e.buttons!=undefined)?e.buttons:this._buttonFlags(e.button,true);if(e['_sapui_handledByControl']){return;}var i;if(this._buttons!=0){i=this._eventToInput(e,this._buttons);this._loco.endGesture(i,this._control);}if(b==2){this._zoomOrigin.x=e.pageX;this._zoomOrigin.y=e.pageY;}i=this._eventToInput(e);i.handled=false;this._loco.beginGesture(i,this._control);this._prevButtons=b;this._buttons=b;};I.prototype._onmousewheel=function(e){var a=e.originalEvent?e.originalEvent:e;if(a['_sapui_handledByControl']||this._buttons!=0){return;}this._zoomOrigin.x=a.pageX;this._zoomOrigin.y=a.pageY;var d=a.detail?a.detail*(-40):a.wheelDelta;if(d==null){d=-a.deltaY;}var s={pageX:a.pageX,pageY:a.pageY,buttons:2,wheelDelta:d};var i=this._eventToInput(s);this._loco.beginGesture(i,this._control);s.pageY-=d/5;i=this._eventToInput(s);i.handled=false;this._loco.move(i,this._control);i.handled=false;this._loco.endGesture(i,this._control);if(i.handled){a['_sapui_handledByControl']=true;a.preventDefault();}};I.prototype._oncontextmenu=function(e){var i=this._eventToInput(e);this._loco.contextMenu(i,this._control);if(i.handled){e['_sapui_handledByControl']=true;e.preventDefault();}};I.prototype.isSupported=function(){return true;};I.prototype.enable=function(c){this._buttonFlagsValue=0;this._buttons=0;this._control=c;var f=this._control?this._control.attachBrowserEvent.bind(this._control):window.document.addEventListener;f('mousedown',this._mousedownProxy);f('mouseup',this._mouseupProxy);f('mousemove',this._mousemoveProxy);f('mousewheel',this._mousewheelProxy);f('DOMMouseScroll',this._mousewheelProxy);f('contextmenu',this._contextmenuProxy);window.document.addEventListener('mouseup',this._onmouseupWindowListenerProxy);};I.prototype.disable=function(){var f=this._control?this._control.detachBrowserEvent.bind(this._control):window.document.removeEventListener;f('mousedown',this._mousedownProxy);f('mouseup',this._mouseupProxy);f('mousemove',this._mousemoveProxy);f('mousewheel',this._mousewheelProxy);f('DOMMouseScroll',this._mousewheelProxy);f('contextmenu',this._contextmenuProxy);window.document.removeEventListener('mouseup',this._onmouseupWindowListenerProxy);};return I;},true);\n",
	"sap/ui/vk/InputDevicePointer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider','./InputDeviceMouse'],function(q,E,I){'use strict';var a=E.extend('sap.ui.vk.InputDevicePointer',{metadata:{publicMethods:['isSupported','enable','disable']},constructor:function(L){this._loco=L;this._pointerIds=[];this._pointers=[];this._count=0;this._points=0;this._buttons=0;this._mouse=new I(this._loco);this._pointerdownProxy=this._onpointerdown.bind(this);this._pointerupProxy=this._onpointerup.bind(this);this._pointermoveProxy=this._onpointermove.bind(this);this._mousewheelProxy=this._mouse._onmousewheel.bind(this._mouse);this._contextmenuProxy=this._mouse._oncontextmenu.bind(this._mouse);this._onpointerupWindowListenerProxy=this._onpointerupWindowListener.bind(this);}});a.prototype._clearPointers=function(){this._pointerIds=[];this._pointers=[];this._count=0;this._points=0;this._buttons=0;};a.prototype._addPointer=function(i,_,b){if(this._pointerIds[i]==null){this._pointerIds[i]=this._count;}var c=this._pointerIds[i];if(this._pointers.length<=c||this._pointers[c]==null){this._count++;}this._pointers[c]={x:_,y:b};return this._count;};a.prototype._removePointer=function(i){if(this._pointerIds[i]==null){return this._count;}var b=this._pointerIds[i];this._pointerIds[i]=null;if(this._pointers.length>b&&this._pointers[b]!=null){this._count--;}this._pointers[b]=null;return this._count;};a.prototype._eventToInput=function(e){var b={x:0,y:0,z:0,d:0,n:this._count,buttons:0,scroll:0,points:[],handled:false,jqueryEvent:e};var t=this._pointers;var l=t.length;for(var i=0;i<l;i++){var c=t[i];if(c!=null){b.points.push({x:c.x,y:c.y,z:0});}}return b;};a.prototype._onpointerdown=function(e){var b=e.originalEvent?e.originalEvent:e;if(b.pointerType!='touch'&&b.pointerType!='pen'){this._buttons=b.buttons;this._mouse._onmousedown(b);return;}if(b.isPrimary){this._clearPointers();}this._addPointer(b.pointerId,b.pageX,b.pageY);b.target.setPointerCapture(b.pointerId);var i=this._eventToInput(b);if(this._points!=0&&this._points!=i.n){this._loco.endGesture(i,this._control);this._loco._resetClickTimer();}this._points=i.n;i.handled=false;this._loco.beginGesture(i,this._control);if(i.handled){}else{this._removePointer(b.pointerId);}};a.prototype._onpointerup=function(e){this._capturedByControl=true;var b=e.originalEvent?e.originalEvent:e;if(b.pointerType!='touch'&&b.pointerType!='pen'){this._buttons=0;this._mouse._onmouseup(b);return;}this._removePointer(b.pointerId);b.target.releasePointerCapture(b.pointerId);var i=this._eventToInput(b);this._loco.endGesture(i,this._control);if(i.n!=0&&this._points!=i.n){i.handled=false;this._loco.beginGesture(i,this._control);this._loco._resetClickTimer();}this._points=i.n;};a.prototype._onpointerupWindowListener=function(e){if(!this._capturedByControl){this._onpointerup(e);}this._capturedByControl=false;};a.prototype._onpointermove=function(e){if(e.buttons!==0||sap.ui.Device.system.desktop){var b=e.originalEvent?e.originalEvent:e;if(b.pointerType!='touch'&&b.pointerType!='pen'){this._mouse._onmousemove(b);return;}this._addPointer(b.pointerId,b.pageX,b.pageY);var i=this._eventToInput(b);if(this._points!=i.n){this._loco.endGesture(i,this._control);this._loco._resetClickTimer();i.handled=false;this._loco.beginGesture(i,this._control);this._loco._resetClickTimer();this._points=i.n;}else{this._loco.move(i,this._control);}}};a.prototype.isSupported=function(){if((sap.ui.Device.browser.edge||sap.ui.Device.browser.msie)&&sap.ui.Device.support.pointer){return true;}return false;};a.prototype.enable=function(c){this._pointerIds=[];this._pointers=[];this._points=0;this._count=0;this._buttons=0;this._mouse._buttons=0;this._control=c;this._mouse._control=c;var f=this._control?this._control.attachBrowserEvent.bind(this._control):window.document.addEventListener;f('pointerdown',this._pointerdownProxy);f('pointerup',this._pointerupProxy);f('pointermove',this._pointermoveProxy);f('mousewheel',this._mousewheelProxy);f('DOMMouseScroll',this._mousewheelProxy);f('contextmenu',this._contextmenuProxy);window.document.addEventListener('pointerup',this._onpointerupWindowListenerProxy);};a.prototype.disable=function(){var f=this._control?this._control.detachBrowserEvent.bind(this._control):window.document.removeEventListener;f('pointerdown',this._pointerdownProxy);f('pointerup',this._pointerupProxy);f('pointermove',this._pointermoveProxy);f('mousewheel',this._mousewheelProxy);f('DOMMouseScroll',this._mousewheelProxy);f('contextmenu',this._contextmenuProxy);window.document.removeEventListener('pointerup',this._onpointerupWindowListenerProxy);};return a;},true);\n",
	"sap/ui/vk/InputDeviceTouch.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var I=E.extend('sap.ui.vk.InputDeviceTouch',{metadata:{publicMethods:['isSupported','enable','disable']},constructor:function(L){this._loco=L;this._points=0;this._touchdownProxy=this._ontouchdown.bind(this);this._touchupProxy=this._ontouchup.bind(this);this._touchmoveProxy=this._ontouchmove.bind(this);}});I.prototype._eventToInput=function(e){var a={x:0,y:0,z:0,d:0,n:e.touches.length,buttons:0,scroll:0,points:[],handled:false,jqueryEvent:e};for(var i=0;i<a.n;i++){var b=e.touches[i];a.points.push({x:b.pageX,y:b.pageY,z:0});}return a;};I.prototype._ontouchdown=function(e){var i=this._eventToInput(e);if(this._points!=0&&this._points!=i.n){this._loco.endGesture(i,this._control);}this._points=i.n;i.handled=false;this._loco.beginGesture(i,this._control);if(i.handled){e['_sapui_handledByControl']=true;e.preventDefault();}};I.prototype._ontouchup=function(e){var i=this._eventToInput(e);this._loco.endGesture(i,this._control);this._points=0;if(i.handled){e['_sapui_handledByControl']=true;e.preventDefault();}};I.prototype._ontouchmove=function(e){var i=this._eventToInput(e);if(this._points!=i.n){this._loco.endGesture(i,this._control);i.handled=false;this._loco.beginGesture(i,this._control);this._points=i.n;}else{this._loco.move(i,this._control);}if(i.handled){e['_sapui_handledByControl']=true;e.preventDefault();}};I.prototype.isSupported=function(){return typeof window.ontouchstart!=='undefined';};I.prototype.enable=function(c){this._points=0;this._control=c;var f=this._control?this._control.attachBrowserEvent.bind(this._control):window.document.addEventListener;f('touchstart',this._touchdownProxy);f('touchend',this._touchupProxy);f('touchmove',this._touchmoveProxy);};I.prototype.disable=function(){var f=this._control?this._control.detachBrowserEvent.bind(this._control):window.document.removeEventListener;f('touchstart',this._touchdownProxy);f('touchend',this._touchupProxy);f('touchmove',this._touchmoveProxy);};return I;},true);\n",
	"sap/ui/vk/LayerProxy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/Object'],function(q,B){'use strict';var L=B.extend('sap.ui.vk.LayerProxy',{metadata:{'abstract':true}});return L;});\n",
	"sap/ui/vk/LegendItem.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['./library','sap/m/StandardListItem','./LegendItemRenderer'],function(l,S,L){'use strict';var a=S.extend('sap.ui.vk.LegendItem',{metadata:{library:'sap.ui.vk',properties:{color:{type:'sap.ui.core.CSSColor',group:'Appearance',defaultValue:null},semanticSpotType:{type:'sap.ui.vbm.SemanticType',group:'Behavior',defaultValue:null}},aggregations:{}}});return a;});\n",
	"sap/ui/vk/LegendItemRenderer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['sap/m/StandardListItemRenderer','sap/ui/core/Renderer'],function(B,R){'use strict';var L=R.extend(B);L.renderLIContent=function(r,c){var s=c.getColor();var t=c.getSemanticSpotType();var i=null;if(s){r.write('<span');r.addClass('sapUiVkLegendItemSquare');r.addStyle('background-color',s);r.writeStyles();r.writeClasses();r.write('>');r.write('</span>');}if(t){switch(t){case sap.ui.vbm.SemanticType.Error:i=sap.ui.resource('sap.ui.vbm','themes/base/img/Pin_Red.png');break;case sap.ui.vbm.SemanticType.Warning:i=sap.ui.resource('sap.ui.vbm','themes/base/img/Pin_Orange.png');break;case sap.ui.vbm.SemanticType.Success:i=sap.ui.resource('sap.ui.vbm','themes/base/img/Pin_Green.png');break;case sap.ui.vbm.SemanticType.Default:i=sap.ui.resource('sap.ui.vbm','themes/base/img/Pin_Blue.png');break;case sap.ui.vbm.SemanticType.Inactive:i=sap.ui.resource('sap.ui.vbm','themes/base/img/Pin_Grey.png');break;default:break;}if(i){c.addStyleClass('sapUiVkLegendItemSpotType');c.setIcon(i);}}B.renderLIContent(r,c);};return L;},true);\n",
	"sap/ui/vk/ListPanel.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['./library','sap/ui/core/Control','sap/m/library','./ListPanelRenderer'],function(l,C,m,L){'use strict';var a=C.extend('sap.ui.vk.ListPanel',{metadata:{library:'sap.ui.vk',properties:{'headerText':{type:'string',group:'Misc'},'headerIcon':{type:'sap.ui.core.URI',group:'Misc'},'expanded':{type:'boolean',group:'Misc',defaultValue:true},'expandAnimation':{type:'boolean',group:'Misc',defaultValue:true},'selectionMode':{type:'sap.m.ListMode',group:'Misc',defaultValue:sap.m.ListMode.MultiSelect}},aggregations:{'items':{type:'sap.m.ListItemBase',multiple:true,singularName:'item'},'panel':{type:'sap.m.Panel',multiple:false,visibility:'hidden'}},events:{headerIconPress:{},expand:{},selectionChange:{parameters:{listItem:{type:'sap.m.ListItemBase'},listItems:{type:'sap.m.ListItemBase[]'},selected:{type:'boolean'}}},itemPress:{parameters:{listItem:{type:'sap.m.ListItemBase'},srcControl:{type:'sap.ui.core.Control'}}}}}});a.prototype.getSelectedItem=function(){return this._oList.getSelectedItem();};a.prototype.setSelectedItem=function(o,s,f){this._oList.setSelectedItem(o,s,f);};a.prototype.getSelectedItems=function(){return this._oList.getSelectedItems();};a.prototype.init=function(){this._oList=new sap.m.ListBase({mode:this.getSelectionMode(),itemPress:this.fireItemPress.bind(this),selectionChange:this.fireSelectionChange.bind(this)});this._oPanel=new sap.m.Panel({expandable:true,expanded:true,expandAnimation:true,headerToolbar:new sap.m.Toolbar({active:false}),content:[this._oList],expand:this.fireExpand.bind(this)});this._oPanel.getHeaderToolbar().addStyleClass('sapUiVkLPTb');this.setAggregation('panel',this._oPanel,true);this._oHeaderIcon=null;this._oHeaderText=null;this._bHeaderToolbarChanged=true;};a.prototype.exit=function(){this._destroyControl(this._oList);this._destroyControl(this._oPanel);this._destroyControl(this._oHeaderIcon);this._destroyControl(this._oHeaderText);};a.prototype.getItems=function(){return this._oList.getItems();};a.prototype.addItem=function(o){return this._oList.addItem(o);};a.prototype.insertItem=function(o,i){return this._oList.insertItem(o,i);};a.prototype.removeItem=function(o){return this._oList.removeItem(o);};a.prototype.removeAllItems=function(){return this._oList.removeAllItems();};a.prototype.setHeaderText=function(v){if(!this._oHeaderText){this._oHeaderText=new sap.m.Title();}this._oHeaderText.setText(v);this._bHeaderToolbarChanged=true;if(this._oHeaderIcon){this._oHeaderIcon.setTooltip(v);this._oHeaderIcon.addAriaLabelledBy(this._oHeaderText);this._oHeaderIcon.addAriaDescribedBy(this._oHeaderText);}return this.setProperty('headerText',v);};a.prototype.getExpanded=function(){return this._oPanel.getExpanded();};a.prototype.setExpanded=function(v){return this._oPanel.setExpanded(v);};a.prototype.getExpandAnimation=function(){return this._oPanel.getExpandAnimation();};a.prototype.setExpandAnimation=function(v){return this._oPanel.setExpandAnimation(v);};a.prototype.setHeaderIcon=function(v){if(!this._oHeaderIcon){this._oHeaderIcon=new sap.m.Button({press:this.fireHeaderIconPress.bind(this),type:sap.m.ButtonType.Transparent,tooltip:this.getHeaderText()});}this._oHeaderIcon.setIcon(v);this._bHeaderToolbarChanged=true;if(this._oHeaderText){this._oHeaderIcon.addAriaLabelledBy(this._oHeaderText);this._oHeaderIcon.addAriaDescribedBy(this._oHeaderText);}return this.setProperty('headerIcon',v);};a.prototype.setSelectionMode=function(v){this._oList.setMode(v);return this.setProperty('selectionMode',v);};a.prototype.onBeforeRendering=function(){if(this._bHeaderToolbarChanged){var t=this._oPanel.getHeaderToolbar();t.removeAllContent();if(this._oHeaderIcon){t.addContent(this._oHeaderIcon);}if(this._oHeaderText){t.addContent(this._oHeaderText);}this._bHeaderToolbarChanged=false;}};a.prototype._destroyControl=function(c){if(c){c.destroy();c=undefined;}};return a;});\n",
	"sap/ui/vk/ListPanelRenderer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(function(){'use strict';var L={};L.render=function(r,c){var p=c._oPanel;p.addStyleClass('sapUiVkListPanel');r.write('<div');r.writeControlData(c);r.write('>');r.renderControl(p);r.write('</div>');};return L;},true);\n",
	"sap/ui/vk/ListPanelStack.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['./library','sap/ui/core/Control','sap/ui/layout/library','./ListPanelStackRenderer'],function(l,C,a,L){'use strict';var b=C.extend('sap.ui.vk.ListPanelStack',{metadata:{library:'sap.ui.vk',properties:{'width':{type:'sap.ui.core.CSSSize',group:'Misc',defaultValue:'100%'},'expanded':{type:'boolean',group:'Misc',defaultValue:true},'expandAnimation':{type:'boolean',group:'Misc',defaultValue:true},'collapsible':{type:'boolean',group:'Misc',defaultValue:true}},aggregations:{'content':{type:'sap.ui.vk.ListPanel',multiple:true,singularName:'content'},'layout':{type:'sap.ui.layout.VerticalLayout',multiple:false,visibility:'hidden'}}}});b.prototype.init=function(){this._oLayout=new sap.ui.layout.VerticalLayout();this._oLayout.addStyleClass('sapUiVkLPSTrans');this.setAggregation('layout',this._oLayout,true);this._bFirstTime=true;};b.prototype.exit=function(){if(this._oLayout){this._oLayout.destroy();this._oLayout=undefined;}};b.prototype.getContent=function(){return this._oLayout.getContent();};b.prototype.addContent=function(o){o.attachExpand(this._onContentExpand.bind(this));o.attachHeaderIconPress(this._onContentHeaderIconPress.bind(this));return this._oLayout.addContent(o);};b.prototype.removeContent=function(o){return this._oLayout.removeContent(o);};b.prototype.insertContent=function(o,i){return this._oLayout.insertContent(o,i);};b.prototype.removeAllContent=function(){return this._oLayout.removeAllContent();};b.prototype.getWidth=function(){return this._oLayout.getWidth();};b.prototype.setWidth=function(v){this.setProperty('width',v,true);return this._oLayout.setWidth(v);};b.prototype.setExpanded=function(v){if(v!=this.getExpanded()){if(v){this._expand();}else{this._collapse();}}return this;};b.prototype.setExpandAnimation=function(v){this._oLayout.removeStyleClass('sapUiVkLPSTrans');if(v){this._oLayout.addStyleClass('sapUiVkLPSTrans');}return this.setProperty('expandAnimation',v,true);};b.prototype.onBeforeRendering=function(){if(this._bFirstTime){var e=false;var c=this.getContent();for(var i=0;i<c.length;++i){if(c[i].getExpanded()){e=true;}}this.setExpanded(e);this._bFirstTime=false;}};b.prototype.onAfterRendering=function(){if(!this.getExpanded()){this._updateCollapsedLayoutWidth();}};b.prototype._onContentExpand=function(e){var c=false;var d=this._oLayout.getContent();for(var i=0;i<d.length;++i){if(d[i].getExpanded()){c=true;}}this.setExpanded(c);};b.prototype._onContentHeaderIconPress=function(e){var c=e.oSource.getExpanded()?false:true;e.oSource.setExpanded(c);var E=false;var d=this._oLayout.getContent();for(var i=0;i<d.length;++i){if(d[i].getExpanded()){E=true;break;}}this.setExpanded(E);};b.prototype._expand=function(){this._oLayout.removeStyleClass('sapUiVkLPSCollapse');this._oLayout.setWidth(this.getProperty('width'));this.setProperty('expanded',true,true);};b.prototype._collapse=function(){if(!this.getCollapsible()){return;}var c=this.getContent();for(var i=0;i<c.length;++i){c[i].setExpanded(false);}this._oLayout.addStyleClass('sapUiVkLPSCollapse');this._updateCollapsedLayoutWidth();this.setProperty('expanded',false,true);};b.prototype._updateCollapsedLayoutWidth=function(){if(this._oLayout.$().closest('.sapUiSizeCompact').length===0){this._oLayout.setWidth('3rem');}else{this._oLayout.setWidth('2.5rem');}};return b;});\n",
	"sap/ui/vk/ListPanelStackRenderer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(function(){'use strict';var L={};L.render=function(r,c){c._oLayout.addStyleClass('sapUiVkListPanelStack');r.renderControl(c._oLayout);};return L;},true);\n",
	"sap/ui/vk/Loco.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider','./InputDevicePointer','./InputDeviceMouse','./InputDeviceTouch','./InputDeviceKeyboard'],function(q,E,I,a,b,c){'use strict';var L=E.extend('sap.ui.vk.Loco',{metadata:{publicMethods:['addHandler','removeHandler','beginGesture','move','endGesture','contextMenu']},constructor:function(){if(L._instance){return L._instance;}E.apply(this);this._handlers=[];this._handlerMap=[];this._gesture=[];this._touchOrigin={x:0,y:0,z:0};this._touchMoved=false;this._touchButton=0;this._touchStart=0;this._touchEnd=0;this._clickTimer=0;this._isDoubleClick=false;L._instance=this;}});L.prototype.destroy=function(){this._gesture=[];this._handlers=[];};L.prototype.addHandler=function(h){if(this._handlers.indexOf(h)>=0){return;}this._handlers.push(h);var v=h.getViewport();var d=this._handlerMap[v];if(d==null){this._handlerMap[v]=[];d=this._handlerMap[v];d.push(h);}else if(d.indexOf(h)==-1){d.push(h);}var p=new I(this);if(p.isSupported()){p.enable(v);v._pointer=p;}else{var m=new a(this);if(m.isSupported()){m.enable(v);v._mouse=m;}var t=new b(this);if(t.isSupported()){t.enable(v);v._touch=t;}}v._keyboard=new c(this);v._keyboard.enable(v);};L.prototype.removeHandler=function(d){var v=d.getViewport();var h=this._handlers;var e=this._handlerMap[v];var f;if(e!=null){f=e.indexOf(d);if(f>=0){e.splice(f,1);}}f=h.indexOf(d);if(f>=0){h.splice(f,1);if(v._pointer){v._pointer.disable();v._pointer=null;}if(v._touch){v._touch.disable();v._touch=null;}if(v._mouse){v._mouse.disable();v._mouse=null;}if(v._keyboard){v._keyboard.disable();v._keyboard=null;}}};L.prototype._processClick=function(d,v){this._clickTimer=0;var e={x:this._touchOrigin.x,y:this._touchOrigin.y,z:this._touchOrigin.z,d:0,n:0,buttons:this._touchButton,scrolls:[],points:[],handled:false};var h=this._handlerMap[v];if(h!=null){for(var i=h.length-1;i>=0&&!e.handled;i--){if(d){var n=h[i].getViewport().getId();var p=/-nativeViewport$/.test(n)?n.replace(/-nativeViewport$/,''):null;var f=sap.ui.getCore().byId(p);if(!f||!f.getOverlay()||!(typeof f.getOverlay().mIACreateCB==='function')){h[i].doubleClick(e,v);}}else{h[i].click(e,v);}}}};L.prototype._processInput=function(e){var d=e.points;switch(e.n){case 0:e.x=0;e.y=0;e.z=0;e.d=0;break;case 2:var f=d[0].x-d[1].x,g=d[0].y-d[1].y,h=d[0].z-d[1].z;e.x=(d[0].x+d[1].x)/2;e.y=(d[0].y+d[1].y)/2;e.z=(d[0].z+d[1].z)/2;e.d=Math.sqrt(f*f+g*g+h*h);break;default:e.x=d[0].x;e.y=d[0].y;e.z=d[0].z;e.d=0;break;}return e;};L.prototype.beginGesture=function(e,v){if(this._gesture[v]){return;}if(this._clickTimer>0){clearTimeout(this._clickTimer);this._clickTimer=0;this._isDoubleClick=true;if(e.n==1&&e.buttons<=1&&this._touchButton<=1){this._processClick(true,v);}if(e.jqueryEvent&&e.jqueryEvent.preventDefault){e.jqueryEvent.preventDefault();e.jqueryEvent.stopPropagation();}}this._processInput(e);var h=this._handlerMap[v];if(h!=null){for(var i=h.length-1;i>=0;i--){h[i].beginGesture(e);if(e.handled){break;}}}var n=new Date();this._touchStart=n.getTime();this._touchMoved=false;this._gesture[v]=true;this._touchOrigin.x=e.x;this._touchOrigin.y=e.y;this._touchOrigin.z=e.z;this._touchButton=e.buttons;if(this._touchEnd!=0&&this._touchStart-this._touchEnd<50){this._touchMoved=true;}};L.prototype.move=function(e,v){this._processInput(e);var h=this._handlerMap[v];var i;if(this._gesture[v]){if(h!=null){for(i=h.length-1;i>=0;i--){h[i].move(e);if(e.handled){break;}}}var d=this._touchOrigin.x-e.x;var f=this._touchOrigin.y-e.y;var g=this._touchOrigin.z-e.z;if((d*d+f*f+g*g)>8){this._touchMoved=true;}}else if(h!=null){for(i=h.length-1;i>=0;i--){if(h[i].hover!=undefined){h[i].hover(e);if(e.handled){break;}}}}};L.prototype.endGesture=function(e,v){if(!this._gesture[v]){return;}this._processInput(e);var h=this._handlerMap[v];if(h!=null){for(var i=h.length-1;i>=0;i--){h[i].endGesture(e);if(e.handled){break;}}}var n=new Date();this._touchEnd=n.getTime();if(!this._touchMoved&&!this._isDoubleClick&&(this._touchEnd-this._touchStart)<2000&&!(sap.ui.Device.os.macintosh&&e.jqueryEvent&&e.jqueryEvent.ctrlKey&&e.buttons===1)){this._clickTimer=setTimeout(function(l){l._processClick(false,v);},200,this);}this._isDoubleClick=false;this._gesture[v]=false;};L.prototype._resetClickTimer=function(){if(this._clickTimer>0){clearTimeout(this._clickTimer);this._clickTimer=0;}};L.prototype.contextMenu=function(e,v){this._processInput(e);var h=this._handlerMap[v];if(h!=null){for(var i=h.length-1;i>=0;i--){h[i].contextMenu(e);if(e.handled){break;}}}};L.prototype.keyEventHandler=function(e,v){var h=this._handlerMap[v];if(h!==null&&h!==undefined){for(var i=h.length-1;i>=0;i--){if(h[i].keyEventHandler){h[i].keyEventHandler(e);}}}};return L;},true);\n",
	"sap/ui/vk/MapContainer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/vk/ContainerBase','sap/ui/core/IconPool','sap/ui/vbm/lib/sapvbi','sap/ui/Device','./MapContainerRenderer'],function(q,l,C,I,s,D,M){'use strict';var a=C.extend('sap.ui.vk.MapContainer',{metadata:{library:'sap.ui.vk',properties:{'showNavbar':{type:'boolean',group:'Misc',defaultValue:true},'showHome':{type:'boolean',group:'Misc',defaultValue:true},'showMapLayer':{type:'boolean',group:'Misc',defaultValue:true},'showRectangularZoom':{type:'boolean',group:'Misc',defaultValue:true},'showZoom':{type:'boolean',group:'Misc',defaultValue:true}},aggregations:{'listPanelStack':{type:'sap.ui.vk.ListPanelStack',multiple:false},'scrollCont':{type:'sap.m.ScrollContainer',multiple:false,visibility:'hidden'}},associations:{},events:{}}});a.prototype.init=function(){this._currentText=new sap.m.Text({}).addStyleClass('mapLayerSelectedText');C.prototype.init.apply(this,arguments);var m=new sap.ui.model.json.JSONModel();m.setData({rectZoom:false});this.setModel(m,'rectZoom');this._oNavbar=new sap.m.Toolbar({width:'auto'});this._oScrollCont=new sap.m.ScrollContainer({horizontal:false,vertical:true,focusable:false});this.setAggregation('scrollCont',this._oScrollCont,true);this._oHomeButton=new sap.m.Button({icon:'sap-icon://home',type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText('MAPCONTAINER_HOME'),press:this._onNavbarHome.bind(this)});this._oRectZoomButton=new sap.m.ToggleButton({icon:'sap-icon://draw-rectangle',type:sap.m.ButtonType.Transparent,pressed:'{rectZoom>/rectZoom}',tooltip:sap.ui.vk.getResourceBundle().getText('MAPCONTAINER_RECT_ZOOM')}).setModel(m,'rectZoom');this._oZoomInButton=new sap.m.Button({icon:'sap-icon://add',type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText('MAPCONTAINER_ZOOMIN'),press:this._onNavbarZoomIn.bind(this)});this._oZoomOutButton=new sap.m.Button({icon:'sap-icon://less',type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText('MAPCONTAINER_ZOOMOUT'),press:this._onNavbarZoomOut.bind(this)});if(D.system.phone){this._oMenuOpenButton=new sap.m.Button({layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}),icon:'sap-icon://menu2',type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText('CONTAINERBASE_MENU'),press:function(){this._bSegmentedButtonSaveSelectState=true;this._showListPanelStack();}.bind(this)});this._oMenuCloseButton=new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:'sap-icon://nav-back',press:function(){this._bSegmentedButtonSaveSelectState=true;this._hideListPanelStack();}.bind(this)});}};a.prototype.exit=function(){if(this._oNavbar){this._oNavbar.destroy();this._oNavbar=undefined;}if(this._oScrollCont){this._oScrollCont.destroy();this._oScrollCont=undefined;}C.prototype.exit.apply(this,arguments);};a.prototype.getListPanelStack=function(){return this._oScrollCont.getContent()[0];};a.prototype.setListPanelStack=function(p){if(D.system.phone){p.setCollapsible(false);p.setWidth('100%');}this._oScrollCont.removeAllContent();return this._oScrollCont.addContent(p);};a.prototype.onBeforeRendering=function(){C.prototype.onBeforeRendering.apply(this,arguments);this._oNavbar.removeAllContent();var c=this.getSelectedContent();if(c!==null){var b=c.getContent();this._isInstanceGeoAnalytic=b instanceof sap.ui.vbm.GeoMap||b instanceof sap.ui.vbm.AnalyticMap;if(this._isInstanceGeoAnalytic){if(this.getShowHome()){this._oNavbar.addContent(this._oHomeButton);}if(!D.system.phone&&this.getShowRectangularZoom()){this._oNavbar.addContent(this._oRectZoomButton);}if(this.getShowZoom()){this._oNavbar.addContent(this._oZoomInButton);this._oNavbar.addContent(this._oZoomOutButton);}this._shouldRenderListPanel=true;}else{this._shouldRenderListPanel=false;}this._isSupportingMapLayerSwitch=b instanceof sap.ui.vbm.GeoMap&&!(b instanceof sap.ui.vbm.AnalyticMap);if(this._isSupportingMapLayerSwitch&&b.getMapConfiguration()!==null&&this.getShowMapLayer()){var d=b.getMapConfiguration();var e=[].concat(d.MapLayerStacks);if(e.length>1){this._box=new sap.m.HBox({}).addStyleClass('mapContainerHboxPopover');this._popover=new sap.m.Popover({enableScrolling:false,placement:sap.m.PlacementType.Horizontal,content:this._box,showHeader:false});this._selectionMap=new sap.m.Image({width:'4.7rem',press:function(f){if(this._popover.isOpen()){this._popover.close();}else{this._popover.openBy(this._selectionMap);}}.bind(this)}).addStyleClass('mapLayerPopoverItem');}this._shouldRenderMapLayerSwitch=true;}else{this._shouldRenderMapLayerSwitch=false;}}};a.prototype.onAfterRendering=function(){if(D.system.phone){var L=document.getElementById(this.getId()+'-LPW');this.getDomRef().appendChild(L);}C.prototype.onAfterRendering.apply(this,arguments);if(this.getSelectedContent()!==null){var c=this.getSelectedContent().getContent();if(this._isSupportingMapLayerSwitch===true&&c.getMapConfiguration()){var b=c.getMapConfiguration();var d=[].concat(b.MapLayerStacks);if(d.length>1){d.forEach(function(v,i){var e=new sap.ui.layout.VerticalLayout({});var f=c.mVBIContext.GetMainScene();var g=c.mVBIContext.m_MapLayerStackManager.GetMapLayerStack(v.name);var o=new sap.m.Image({width:'4.5rem',press:function(j){this._popover.close();o.setAlt(v.name);var k=j.getSource();var t=k.getAlt();c.setRefMapLayerStack(t);this._currentText.setText(v.name);f.GetPreviewImage(g,function(m){q('.mapLayerPopoverItem').attr('src',m.src);});this._currentMapLayerStackIndex=i;}.bind(this)});var h=new sap.m.Text({text:v.name}).addStyleClass('mapLayerPopoverItemText');o.addStyleClass('layerType');f.GetPreviewImage(g,function(j){o.setSrc(j.src);});f.GetPreviewImage(f.m_MapLayerStack,function(j){q('.mapLayerPopoverItem').attr('src',j.src);});var n=d[this._currentMapLayerStackIndex||0].name;this._currentText.setText(n);this._box.addItem(e);e.addContent(o);e.addContent(h);},this);}}}};a.prototype.setToolbarItem=function(b){if(!b||!b.id){return null;}var o;for(var i=0;i<this._customButtons.length;++i){if(b.id===this._customButtons[i].id){o=this._customButtons[i];o.index=i;this._customButtons.splice(i,1);break;}}if(!o){o={id:b.id,visible:true,active:true,index:this._customButtons.length,type:sap.ui.vk.MapContainerButtonType.Click};}if('index'in b){o.index=b.index;}if('visible'in b){o.visible=b.visible;}if('overflow'in b){o.overflow=b.overflow;}if('active'in b){o.active=b.active;}if('text'in b){o.text=b.text;}if('tooltip'in b){o.tooltip=b.tooltip;}if('icon'in b){o.icon=b.icon;}if('activeIcon'in b){o.activeIcon=b.activeIcon;}if('press'in b){o.press=b.press;}if('toggled'in b){o.toggled=b.toggled;if(o.button){o.button.setPressed(b.toggled);}}if('type'in b){o.type=b.type;}if(o.index>this._customButtons.length){o.index=this._customButtons.length;}else if(o.index<0){o.index=0;}this._customButtons.splice(o.index,0,o);this.invalidate();return o;};a.prototype.setSelectedContent=function(c){var o;if(this._oSelectedContent){if((o=this._oSelectedContent.getContent())instanceof sap.ui.vbm.GeoMap){o.unbindProperty('rectZoom','rectZoom>/rectZoom');}}C.prototype.setSelectedContent.apply(this,arguments);var n=this._oSelectedContent.getContent();if(n instanceof sap.ui.vbm.GeoMap){n.bindProperty('rectZoom','rectZoom>/rectZoom');}};a.prototype._addToolbarContent=function(){if(D.system.phone){this._oToolbar.addContent(this._oMenuOpenButton);}C.prototype._addToolbarContent.apply(this,arguments);};a.prototype._onNavbarZoomIn=function(e){var c=this.getSelectedContent().getContent();if(c.getZoomlevel&&c.setZoomlevel&&c.setEnableAnimation){c.setEnableAnimation(true);c.setZoomlevel(c.getZoomlevel()+1);}};a.prototype._onNavbarZoomOut=function(e){var c=this.getSelectedContent().getContent();if(c.getZoomlevel&&c.setZoomlevel&&c.setEnableAnimation){c.setEnableAnimation(true);c.setZoomlevel(c.getZoomlevel()-1);}};a.prototype._onNavbarHome=function(e){var c=this.getSelectedContent().getContent();if(c.goToStartPosition){c.goToStartPosition();}};a.prototype._showListPanelStack=function(){q('#'+this.getId()+'-LPW').addClass('sapUiVkMapContainerLPWIn');q('#'+this.getId()+'-wrapper').addClass('sapUiVkMapContainerMapOut');};a.prototype._hideListPanelStack=function(){q('#'+this.getId()+'-LPW').removeClass('sapUiVkMapContainerLPWIn');q('#'+this.getId()+'-wrapper').removeClass('sapUiVkMapContainerMapOut');};return a;});\n",
	"sap/ui/vk/MapContainerRenderer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['./ContainerBaseRenderer','sap/ui/core/Renderer','sap/ui/Device'],function(B,R,D){'use strict';var M=R.extend(B);M.render=function(r,c){c.addStyleClass('sapUiVkMapContainer');B.render.apply(this,arguments);};M.writeToolbarArea=function(r,c){r.write('<div');r.addClass('sapUiVkMapContainerOverlay');r.writeClasses();r.write('>');if(c.getShowNavbar()){r.write('<div');r.addClass('sapUiVkMapContainerNavbarArea');r.writeClasses();r.write('>');if(c.getShowMapLayer()&&c._shouldRenderMapLayerSwitch){r.renderControl(c._currentText);r.renderControl(c._selectionMap);}r.write('<div');r.addClass('sapUiVkMapContainerNavbarContainer');r.writeClasses();r.write('>');r.renderControl(c._oNavbar);r.write('</div>');r.write('</div>');}if(!D.system.phone&&c._shouldRenderListPanel){c._oScrollCont.addStyleClass('sapUiVkMapContainerListPanelArea');r.renderControl(c._oScrollCont);}B.writeToolbarArea(r,c);r.write('</div>');if(D.system.phone){r.write('<div id='+c.getId()+'-LPW');r.addClass('sapUiVkMapContainerLPW');r.writeClasses();r.write('>');r.renderControl(c._oMenuCloseButton);c._oScrollCont.addStyleClass('sapUiVkMapContainerListPanelArea');r.renderControl(c._oScrollCont);r.write('</div>');}};return M;},true);\n",
	"sap/ui/vk/Material.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,M){'use strict';var a=M.extend('sap.ui.vk.Material',{metadata:{properties:{'id':{type:'string'},'name':{type:'string'},'ambientColour':{type:'sap.ui.core.CSSColor',defaultValue:'rgba(0, 0, 0, 1)'},'diffuseColour':{type:'sap.ui.core.CSSColor',defaultValue:'rgba(0, 0, 0, 1)'},'specularColour':{type:'sap.ui.core.CSSColor',defaultValue:'rgba(0, 0, 0, 1)'},'emissiveColour':{type:'sap.ui.core.CSSColor',defaultValue:'rgba(0, 0, 0, 1)'},'opacity':{type:'float',defaultValue:1.0},'glossiness':{type:'float',defaultValue:0.0},'lineColour':{type:'sap.ui.core.CSSColor',defaultValue:'rgba(0, 0, 0, 1)'},'lineWidth':{type:'float',defaultValue:0.0},'textureDiffuse':{type:'sap.ui.vk.Texture',defaultValue:null},'textureBump':{type:'sap.ui.vk.Texture',defaultValue:null},'textureOpacity':{type:'sap.ui.vk.Texture',defaultValue:null},'textureReflection':{type:'sap.ui.vk.Texture',defaultValue:null},'textureEmissive':{type:'sap.ui.vk.Texture',defaultValue:null},'textureAmbientOcclusion':{type:'sap.ui.vk.Texture',defaultValue:null}}}});a.prototype.getMaterialRef=function(){return null;};return a;});\n",
	"sap/ui/vk/Messages.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,M){'use strict';var a={VIT1:{summary:'NATIVEVIEWPORT_MSG_NOTBELOADED_SUMMARY',cause:'NATIVEVIEWPORT_MSG_NOTBELOADED_NOTFOUND_CAUSE',resolution:'NATIVEVIEWPORT_MSG_NOTBELOADED_NOTFOUND_CHECKEXISTS_RESOLUTION',code:'VIT1'},VIT2:{summary:'NATIVEVIEWPORT_MSG_NOTBELOADED_SUMMARY',cause:'NATIVEVIEWPORT_MSG_NOTBELOADED_NOTFOUND_CAUSE',resolution:'NATIVEVIEWPORT_MSG_NOTBELOADED_NOTFOUND_CHECKEXISTS_RESOLUTION',code:'VIT2'},VIT3:{summary:'NATIVEVIEWPORT_MSG_NOTBELOADED_SUMMARY',cause:'NATIVEVIEWPORT_MSG_NOTBELOADED_UNSUPPORTEDFILEFORMAT_CAUSE',resolution:'NATIVEVIEWPORT_MSG_NOTBELOADED_UNSUPPORTEDFILEFORMAT_CHECKFILEFORMAT_RESOLUTION',code:'VIT3'},VIT4:{summary:'NATIVEVIEWPORT_MSG_NOTBELOADED_SUMMARY',cause:'NATIVEVIEWPORT_MSG_NOTBELOADED_UNSUPPORTEDFILEFORMAT_CAUSE',resolution:'NATIVEVIEWPORT_MSG_NOTBELOADED_UNSUPPORTEDFILEFORMAT_CHECKFILEFORMAT_RESOLUTION',code:'VIT4'},VIT5:{summary:'DOWNLOADMANAGER_MSG_NOTBELOADED_SUMMARY',cause:'DOWNLOADMANAGER_MSG_NOTBELOADED_VALUESOURCEUNSUPPORTED_CAUSE',resolution:'DOWNLOADMANAGER_MSG_NOTBELOADED_VALUESOURCEUNSUPPORTED_CHECKSOURCEISURLORFILE_RESOLUTION',code:'VIT5'},VIT6:{summary:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY',cause:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INVALIDQUERY_CAUSE',resolution:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INVALIDQUERY_SPECIFYVALUEPROPERTY_RESOLUTION',code:'VIT6'},VIT7:{summary:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY',cause:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_PREDICATENOTSPECIFIED_CAUSE',resolution:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_PREDICATENOTSPECIFIED_SPECIFYPREDICATE_RESOLUTION',code:'VIT7'},VIT8:{summary:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY',cause:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INCORRECTPREDICATEVALUE_CAUSE',resolution:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INCORRECTPREDICATEVALUE_INVALIDPREDICATE_RESOLUTION',code:'VIT8'},VIT9:{summary:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY',cause:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INCORRECTPREDICATEVALUE_CAUSE',resolution:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INCORRECTPREDICATEVALUE_INVALIDPREDICATE_RESOLUTION',code:'VIT9'},VIT10:{summary:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY',cause:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_NOMETADATASPECIFIED_CAUSE',resolution:'NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_NOMETADATASPECIFIED_SPECIFYMETADATACATEGORY_RESOLUTION',code:'VIT10'},VIT11:{summary:'OVERLAY_MSG_EVENTHANDLERFAILED_SUMMARY',cause:'OVERLAY_MSG_EVENTHANDLERFAILED_UNSUPPORTEDEVENTTYPE_CAUSE',resolution:'OVERLAY_MSG_EVENTHANDLERFAILED_UNSUPPORTEDEVENTTYPE_CHECKEVENTTYPE_RESOLUTION',code:'VIT11'},VIT12:{summary:'STEPNAVIGATION_MSG_STEPCOULDNOTBEPLAYED_SUMMARY',cause:'STEPNAVIGATION_MSG_STEPCOULDNOTBEPLAYED_INCORRECTSTEPEVENTTYPE_CAUSE',resolution:'STEPNAVIGATION_MSG_STEPCOULDNOTBEPLAYED_INCORRECTSTEPEVENTTYPE_CHECKSTEPEVENTTYPEVALUE_RESOLUTION',code:'VIT12'},VIT13:{summary:'VIEWER_MSG_CONTENTRESOURCESNOTLOADED_SUMMARY',cause:'VIEWER_MSG_CONTENTRESOURCESNOTLOADED_NONEXISTINGORUNSUPPORTEDFILE_CAUSE',resolution:'VIEWER_MSG_CONTENTRESOURCESNOTLOADED_NONEXISTINGORUNSUPPORTEDFILE_CHECKFILEEXISTSANDIFSUPPORT_RESOLUTION',code:'VIT13'},VIT14:{summary:'VIEWER_MSG_FAILEDTOBUILDSCENE_SUMMARY',cause:'VIEWER_MSG_FAILEDTOBUILDSCENE_COULDNOTCREATESCENE_CAUSE',resolution:'VIEWER_MSG_FAILEDTOBUILDSCENE_COULDNOTCREATESCENE_RELOADORSELECTANOTHERFILE_RESOLUTION',code:'VIT14'},VIT15:{summary:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_SUMMARY',cause:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_LOADINGMULTIPLE2DNOTSUPPORTED_CAUSE',resolution:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_LOADINGMULTIPLE2DNOTSUPPORTED_LOADONE2D_RESOLUTION',code:'VIT15'},VIT16:{summary:'VIEWER_MSG_NOTBELOADED_SUMMARY',cause:'VIEWER_MSG_NOTBELOADED_NONATIVESUPPORT_CAUSE',resolution:'VIEWER_MSG_NOTBELOADED_NONATIVESUPPORT_CHECKFILEFORMATSUPPORT_RESOLUTION',code:'VIT16'},VIT17:{summary:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_SUMMARY',cause:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_COMBINATIONOF2D3DNOTSUPPORTED_CAUSE',resolution:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_COMBINATIONOF2D3DNOTSUPPORTED_MULTIPLESUPPORTFOR3DONLY_RESOLUTION',code:'VIT17'},VIT18:{summary:'VIEWPORT_MSG_ERRORLOADINGVIEWPORT_SUMMARY',cause:'VIEWPORT_MSG_ERRORLOADINGVIEWPORT_CREATINGMULTIPLEVIEWPORTINSTANCES_CAUSE',resolution:'VIEWPORT_MSG_ERRORLOADINGVIEWPORT_CREATINGMULTIPLEVIEWPORTINSTANCES_ONEINSTANCEOFVIEWPORTSUPPORTED_RESOLUTION',code:'VIT18'},VIT19:{summary:'VIEWPORT_MSG_COULDNOTSETCAMERAPROJECTION_SUMMARY',cause:'VIEWPORT_MSG_COULDNOTSETCAMERAPROJECTION_SPECIFIEDCAMERAPROJECTIONNOTSUPPORTED_CAUSE',resolution:'VIEWPORT_MSG_COULDNOTSETCAMERAPROJECTION_SPECIFIEDCAMERAPROJECTIONNOTSUPPORTED_CHECKPROJECTIONTYPESUPPORTED_RESOLUTION',code:'VIT19'},VIT20:{summary:'DOWNLOADMANAGER_MSG_VDS4_BETA_WARNING_SUMMARY',cause:'DOWNLOADMANAGER_MSG_VDS4_BETA_WARNING_CAUSE',resolution:'DOWNLOADMANAGER_MSG_VDS4_BETA_WARNING_RESOLUTION',code:'VIT20'},VIT21:{summary:'VIEWER_MSG_FAILEDTOBUILDSCENE_SUMMARY',cause:'VIEWER_MSG_FAILEDTOBUILDSCENE_MISSINGPASSWORD_CAUSE',resolution:'VIEWER_MSG_FAILEDTOBUILDSCENE_MISSINGPASSWORD_PROVIDEPASSWORD_RESOLUTION',code:'VIT21'},VIT22:{summary:'GRAPHICSCORE_MSG_VDSL_NOFILEPROPERTY_SUMMARY',cause:'GRAPHICSCORE_MSG_VDSL_EMPTY_CAUSE',resolution:'GRAPHICSCORE_MSG_VDSL_FIRSTLINE_WRONGFORMAT_RESOLUTION',code:'VIT22'},VIT23:{summary:'GRAPHICSCORE_MSG_VDSL_FIRSTLINE_WRONGFORMAT_SUMMARY',cause:'GRAPHICSCORE_MSG_VDSL_WRONGFORMAT_CAUSE',resolution:'GRAPHICSCORE_MSG_VDSL_FIRSTLINE_WRONGFORMAT_RESOLUTION',code:'VIT23'},VIT24:{summary:'GRAPHICSCORE_MSG_VDSL_RELATIVE_IN_LOCAL_SUMMARY',cause:'GRAPHICSCORE_MSG_VDSL_WRONGFORMAT_CAUSE',resolution:'GRAPHICSCORE_MSG_VDSL_RELATIVE_IN_LOCAL_RESOLUTION',code:'VIT24'},VIT25:{summary:'GRAPHICSCORE_MSG_VDS3ENCRYPTED_SUMMARY',cause:'GRAPHICSCORE_MSG_VDS3ENCRYPTED_CAUSE',resolution:'GRAPHICSCORE_MSG_VDS3ENCRYPTED_RESOLUTION',code:'VIT25'},VIT26:{summary:'VIEWPORT_UNSUPPORTED_STEP_INDEX_SUMMARY',cause:'VIEWPORT_UNSUPPORTED_STEP_INDEX_CAUSE',resolution:'VIEWPORT_UNSUPPORTED_STEP_INDEX_RESOLUTION',code:'VIT26'},VIT27:{summary:'VIEWPORT_UNSUPPORTED_PROCEDURE_INDEX_SUMMARY',cause:'VIEWPORT_UNSUPPORTED_PROCEDURE_INDEX_CAUSE',resolution:'VIEWPORT_UNSUPPORTED_PROCEDURE_INDEX_RESOLUTION',code:'VIT27'},VIT28:{summary:'VIEWPORT_UNSUPPORTED_VISIBILITY_MODE_SUMMARY',cause:'VIEWPORT_UNSUPPORTED_VISIBILITY_MODE_CAUSE',resolution:'VIEWPORT_UNSUPPORTED_VISIBILITY_MODE_RESOLUTION',code:'VIT28'},VIT29:{summary:'VIEWER_RUNTIME_SETTINGS_NOT_CHANGEABLE_SUMMARY',cause:'VIEWER_RUNTIME_SETTINGS_NOT_CHANGEABLE_CAUSE',resolution:'VIEWER_RUNTIME_SETTINGS_NOT_CHANGEABLE_RESOLUTION',code:'VIT29'},VIT30:{summary:'VIEWER_WEBGLCONTEXTATTRIBUTES_NOT_CHANGEABLE_SUMMARY',cause:'VIEWER_WEBGLCONTEXTATTRIBUTES_NOT_CHANGEABLE_CAUSE',resolution:'VIEWER_WEBGLCONTEXTATTRIBUTES_NOT_CHANGEABLE_RESOLUTION',code:'VIT30'},VIT31:{summary:'VIEWPORT_UNSUPPORTED_RESET_OPTIONS_SUMMARY',cause:'VIEWPORT_UNSUPPORTED_RESET_OPTIONS_CAUSE',resolution:'VIEWPORT_UNSUPPORTED_RESET_OPTIONS_RESOLUTION',code:'VIT31'},VIT32:{summary:'VIEWPORT_UNSUPPORTED_VISIBILITY_TRACKING_SUMMARY',cause:'VIEWPORT_UNSUPPORTED_VISIBILITY_TRACKING_CAUSE',resolution:'VIEWPORT_UNSUPPORTED_VISIBILITY_TRACKING_RESOLUTION',code:'VIT32'},VIT33:{summary:'VIEWER_SOURCE_FAILED_TO_DOWNLOAD_SUMMARY',cause:'VIEWER_SOURCE_FAILED_TO_DOWNLOAD_CAUSE',resolution:'VIEWER_SOURCE_FAILED_TO_DOWNLOAD_RESOLUTION',code:'VIT33'},VIT34:{summary:'VIEWER_SOURCE_FAILED_TO_LOAD_SUMMARY',cause:'VIEWER_SOURCE_FAILED_TO_LOAD_CAUSE',resolution:'VIEWER_SOURCE_FAILED_TO_LOAD_RESOLUTION',code:'VIT34'},VIT35:{summary:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_SUMMARY',cause:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_COMBINATIONOFDIFFRENTCONTENTMANAGERSNOTSUPPORTED_CAUSE',resolution:'VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_COMBINATIONOFDIFFRENTCONTENTMANAGERSNOTSUPPORTED_MULTIPLESUPPORTFORSAMECONTENTMANAGER_RESOLUTION',code:'VIT35'},VIT36:{summary:'VIEWER_UNKNOWN_CONTENT_RESOURCE_TYPE_SUMMARY',cause:'VIEWER_UNKNOWN_CONTENT_RESOURCE_TYPE_CAUSE',resolution:'VIEWER_UNKNOWN_CONTENT_RESOURCE_TYPE_RESOLUTION',code:'VIT36'},VIT37:{summary:'VIEWER_MSG_FAILEDTOLOADCONTENT_SUMMARY',cause:'VIEWER_MSG_FAILEDTOLOADCONTENT_URLORAUTHENTICATION_CAUSE',resolution:'VIEWER_MSG_FAILEDTOLOADCONTENT_URLORAUTHENTICATION_RESOLUTION',code:'VIT37'}};q.sap.setObject('sap.ui.vk.Messages',a);return a;});\n",
	"sap/ui/vk/NativeViewport.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','sap/ui/core/ResizeHandler','./Loco','./ViewportHandler','./Messages','./ContentConnector','./NativeViewportRenderer'],function(q,l,C,R,L,V,M,a,N){'use strict';var b=C.extend('sap.ui.vk.NativeViewport',{metadata:{library:'sap.ui.vk',properties:{limitZoomOut:{type:'boolean',group:'Behavior',defaultValue:false}},associations:{contentConnector:{type:'sap.ui.vk.ContentConnector',multiple:false}},events:{'resize':{parameters:{oldSize:'object',size:'object'}},'move':{parameters:{pan:'object',zoom:'float'}}}}});b.prototype.init=function(){if(C.prototype.init){C.prototype.init.call(this);}this._canvas=null;this._canvas=document.createElement('div');this._canvas.style.textAlign='left';this._canvas.id=q.sap.uid();this._resizeListenerId=null;this._viewportHandler=new V(this);this._loco=new L();this._loco.addHandler(this._viewportHandler);this._reset();this._svgid=this.getId()+'-svg';};b.prototype.exit=function(){this._loco.removeHandler(this._viewportHandler);this._viewportHandler.destroy();if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}if(C.prototype.exit){C.prototype.exit.call(this);}};b.prototype.onBeforeRendering=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}};b.prototype.onAfterRendering=function(){if(this._canvas){var d=this.getDomRef();d.appendChild(this._canvas);this._resizeListenerId=R.register(this,this._handleResize.bind(this));this._handleResize({size:{width:d.clientWidth,height:d.clientHeight}});}};b.prototype._handleResize=function(e){this.fireResize({oldSize:e.oldSize,size:e.size});if(!e.oldSize||!e.oldSize.width||!e.oldSize.height||this._svgError){this._bestFit();}else{this._update();}};b.prototype._reset=function(){this._img=null;this._svg=null;this._svgError=null;this._imageW=0;this._imageH=0;this._s4BestFit=1;this._s=1;this._x=0;this._y=0;this._gx=0;this._gy=0;this._canvas.style.visibility='hidden';while(this._canvas.lastChild){this._canvas.removeChild(this._canvas.lastChild);}};b.prototype._update=function(){var i=this._svgError||this._img||this._svg;if(i){var x=this._x-(this._imageW-this._canvas.clientWidth)/2;var y=this._y-(this._imageH-this._canvas.clientHeight)/2;var t='matrix('+this._s+',0,0,'+this._s+','+x+','+y+')';i.style.transform=t;i.style.webkitTransform=t;i.style.msTransform=t;i.style.MozTransform=t;i.style.OTransform=t;}};b.prototype._bestFit=function(){if(this._svgError){this._imageW=550;this._imageH=512;}else if(this._svg){this._imageW=this._svg.clientWidth;this._imageH=this._svg.clientHeight;}else if(this._img){this._imageW=this._img.width;this._imageH=this._img.height;}else{return;}if(!this._imageW||!this._imageH||!this._canvas.clientWidth||!this._canvas.clientHeight){return;}var s=Math.min(this._canvas.clientWidth/this._imageW,this._canvas.clientHeight/this._imageH);this._s4BestFit=s;this._s=s;this._x=0;this._y=0;this._update();this._canvas.style.visibility='visible';};b.prototype.loadUrl=function(u,o,c,d,e){if(/^(svg)$/.test(e.toLowerCase())){this._reset();this._svg=document.createElement('object');this._svg.setAttribute('type','image/svg+xml');this._svg.setAttribute('data',u);this._svg.setAttribute('id',this._svgid);this._svg.setAttribute('class','SVGImage');this._canvas.appendChild(this._svg);var s=document.createElement('div');s.style.position='absolute';s.style.top=0;s.style.left=0;s.style.height='100%';s.style.width='100%';this._canvas.appendChild(s);this._svg.onload=function(){this._svg.onload=null;setTimeout(function(){this._bestFit();if(o){o();}}.bind(this),0);}.bind(this);this._svg.onerror=function(){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT1.summary),M.VIT1.code,'sap.ui.vk.NativeViewport');this._reset();if(c){c();}}.bind(this);this._svg.src=u;return this;}else if(/^(jpg|jpeg|png|gif|bmp|tif|tiff)$/.test(e.toLowerCase())){this._reset();this._img=new Image();this._img.draggable=false;this._img.onload=function(){setTimeout(function(){this._bestFit();this._canvas.appendChild(this._img);if(o){o();}}.bind(this),0);}.bind(this);this._img.onerror=function(){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT2.summary),M.VIT2.code,'sap.ui.vk.NativeViewport');if(c){c();}};this._img.src=u;return this;}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT3.summary),M.VIT3.code,'sap.ui.vk.NativeViewport');if(c){c();}}};b.prototype.loadFailed=function(t){this._reset();this._svgError=document.createElement('div');this._svgError.className='svgErrorContainer';this._svgErrorElement=document.createElementNS('http://www.w3.org/2000/svg','svg');this._svgErrorElement.setAttribute('width','550px');this._svgErrorElement.setAttribute('height','512px');this._svgErrorElement.setAttribute('viewBox','-244 -244 512 512');this._svgErrorElement.setAttribute('enable-background','new -244 -244 512 512');this._svgErrorElement.setAttribute('id','SVGError');var c=document.createElementNS('http://www.w3.org/2000/svg','rect');c.setAttribute('fill','#FFFFFF');c.setAttribute('x','-244');c.setAttribute('y','-244');c.setAttribute('width','512');c.setAttribute('height','512');c.setAttribute('opacity','0.1');this._svgErrorElement.appendChild(c);var d=document.createElementNS('http://www.w3.org/2000/svg','path');d.setAttribute('fill','#474747');d.setAttribute('d','M12.833,89.742c-70.781,0-128.366-57.584-128.366-128.366c0-70.781,57.584-128.365,128.366-128.365 s128.365,57.584,128.365,128.365C141.198,32.158,83.614,89.742,12.833,89.742z M12.833-146.989 c-59.753,0-108.366,48.612-108.366,108.365c0,59.752,48.613,108.366,108.366,108.366S121.198,21.129 121.198-38.624 C121.198-98.376,72.586-146.989,12.833-146.989z');d.setAttribute('opacity','0.3');this._svgErrorElement.appendChild(d);var e=document.createElementNS('http://www.w3.org/2000/svg','rect');e.setAttribute('fill','#474747');e.setAttribute('x','-2.167');e.setAttribute('y','-120.847');e.setAttribute('width','30');e.setAttribute('height','119.447');e.setAttribute('fill','#474747');e.setAttribute('opacity','0.3');this._svgErrorElement.appendChild(e);var f=document.createElementNS('http://www.w3.org/2000/svg','rect');f.setAttribute('fill','#474747');f.setAttribute('x','-2.167');f.setAttribute('y','13.6');f.setAttribute('width','30');f.setAttribute('height','30');f.setAttribute('opacity','0.3');this._svgErrorElement.appendChild(f);var g=document.createElementNS('http://www.w3.org/2000/svg','path');g.setAttribute('fill','#474747');g.setAttribute('d','M10.833,87.33c-70.781,0-128.366-57.584-128.366-128.365c0-70.781,57.584-128.365,128.366-128.365 s128.365,57.584,128.365,128.365C139.198,29.746,81.614,87.33,10.833,87.33z M10.833-149.4 c-59.753,0-108.366,48.612-108.366,108.365S-48.92,67.33,10.833,67.33S119.198,18.718,119.198-41.035S70.586-149.4,10.833-149.4z');this._svgErrorElement.appendChild(g);var h=document.createElementNS('http://www.w3.org/2000/svg','rect');h.setAttribute('fill','#474747');h.setAttribute('x','-4.167');h.setAttribute('y','-123.259');h.setAttribute('width','30');h.setAttribute('height','119.447');h.setAttribute('fill','#474747');this._svgErrorElement.appendChild(h);var i=document.createElementNS('http://www.w3.org/2000/svg','rect');i.setAttribute('fill','#474747');i.setAttribute('x','-4.167');i.setAttribute('y','11.188');i.setAttribute('width','30');i.setAttribute('height','30');i.setAttribute('fill','#474747');this._svgErrorElement.appendChild(i);var j=document.createElementNS('http://www.w3.org/2000/svg','text');j.setAttribute('id','textError');j.setAttribute('left','auto');j.setAttribute('right','auto');j.setAttribute('y','150');j.setAttribute('x','10');j.setAttribute('display','block');j.setAttribute('text-anchor','middle');j.setAttribute('fill','#474747');j.setAttribute('style','font-family:Arial');j.setAttribute('font-size','32');j.textContent=t?t:sap.ui.vk.getResourceBundle().getText('VIEWPORT_MESSAGEUNSUPPORTEDFILEFORMAT');this._svgErrorElement.appendChild(j);this._svgError.appendChild(this._svgErrorElement);this._bestFit();this._canvas.appendChild(this._svgError);return this;};b.prototype.beginGesture=function(x,y){this._gx=(x-this._canvas.clientWidth/2-this._x)/this._s;this._gy=(y-this._canvas.clientHeight/2-this._y)/this._s;return this;};b.prototype.endGesture=function(){this._gx=0;this._gy=0;return this;};b.prototype.pan=function(d,c){if(this._svgError){return this;}this._x+=d;this._y+=c;this._update();this.fireMove({pan:{x:d,y:c},zoom:1.0});return this;};b.prototype.rotate=function(d,c){if(this._svgError){return this;}this._x+=d;this._y+=c;this._update();this.fireMove({pan:{x:d,y:c},zoom:1.0});return this;};b.prototype._getZoomInLimit=function(){return 500;};b.prototype._getZoomOutLimit=function(){return(this.getLimitZoomOut())?this._s4BestFit*0.25:0.0001;};b.prototype._getZoomFactor=function(){return this._s;};b.prototype.zoom=function(z){if(this._svgError){return this;}var g=this._gx*this._s;var c=this._gy*this._s;var o=this._s;this._s=Math.min(Math.max(this._s*z,this._getZoomOutLimit()),this._getZoomInLimit());z=this._s/o;var d=this._gx*this._s;var e=this._gy*this._s;var f=g-d;var h=c-e;this._x+=f;this._y+=h;this._update();this.fireMove({pan:{x:f,y:h},zoom:z});return this;};b.prototype.tap=function(x,y,i){if(i){this._bestFit();}return this;};b.prototype.queueCommand=function(c){c();return this;};b.prototype.getViewInfo=function(){var v={};v.camera=[this._s,0,0,this._s,this._x,this._y];return v;};b.prototype.setViewInfo=function(v){if(this._svgError){return this;}var c=v.camera;this._s=c[0];this._x=c[4];this._y=c[5];this._update();return this;};b.prototype.getOutputSize=function(){var c=this.getViewInfo().camera,d=this.getDomRef().getBoundingClientRect();return{left:d.width/2+c[4],top:d.height/2+c[5],sideLength:this._canvas.children[0].getBoundingClientRect().width};};b.prototype._onAfterUpdateContentConnector=function(){this._setImage(this._contentConnector.getContent());};b.prototype._onBeforeClearContentConnector=function(){this._setImage(null);};b.prototype._handleContentReplaced=function(e){this._setImage(e.getParameter('newContent'));};b.prototype._setImage=function(i){this._reset();if(i instanceof HTMLObjectElement){this._svg=i;i.setAttribute('id',this._svgid);i.onload=function(){i.onload=null;setTimeout(function(){this._bestFit();}.bind(this),0);}.bind(this);if(sap.ui.Device.browser.msie||sap.ui.Device.browser.edge){setTimeout(function(){this._bestFit();}.bind(this),0);}this._canvas.appendChild(i);var s=document.createElement('div');s.style.position='absolute';s.style.top=0;s.style.left=0;s.style.height='100%';s.style.width='100%';this._canvas.appendChild(s);}else if(i instanceof HTMLImageElement){this._img=i;i.draggable=false;setTimeout(function(){this._bestFit();this._canvas.appendChild(i);}.bind(this),0);}};var r=2;var p=2;[{key:'left',dx:-p,dy:0},{key:'right',dx:+p,dy:0},{key:'up',dx:0,dy:-p},{key:'down',dx:0,dy:+p}].forEach(function(i){b.prototype['onsap'+i.key]=function(e){this.beginGesture(this.$().width()/2,this.$().height()/2);this.pan(i.dx,i.dy);this.endGesture();e.preventDefault();e.stopPropagation();};});[{key:'left',dx:-r,dy:0},{key:'right',dx:+r,dy:0},{key:'up',dx:0,dy:-r},{key:'down',dx:0,dy:+r}].forEach(function(i){b.prototype['onsap'+i.key+'modifiers']=function(e){if(e.shiftKey&&!(e.ctrlKey||e.altKey||e.metaKey)){this.beginGesture(this.$().width()/2,this.$().height()/2);this.rotate(i.dx,i.dy);this.endGesture();e.preventDefault();e.stopPropagation();}};});[{key:'minus',d:0.98},{key:'plus',d:1.02}].forEach(function(i){b.prototype['onsap'+i.key]=function(e){this.beginGesture(this.$().width()/2,this.$().height()/2);this.zoom(i.d);this.endGesture();e.preventDefault();e.stopPropagation();};});a.injectMethodsIntoClass(b);return b;});\n",
	"sap/ui/vk/NativeViewportRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var N={};N.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapVizKitNativeViewport');r.writeClasses();r.writeAttribute('tabindex',0);r.write('>');r.write('</div>');};return N;},true);\n",
	"sap/ui/vk/NodeHierarchy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject','./Messages'],function(q,M,a){'use strict';var N=M.extend('sap.ui.vk.NodeHierarchy',{metadata:{'abstract':true,events:{changed:{},nodeCreated:{parameters:{nodeRef:{type:'any'},nodeId:{type:'string'}}},nodeRemoving:{parameters:{nodeRef:{type:'any'},nodeId:{type:'string'}}},nodeReplaced:{parameters:{ReplacedNodeRef:{type:'any'},ReplacementNodeRef:{type:'any'},ReplacedNodeId:{type:'string'},ReplacementNodeId:{type:'string'}}},nodeUpdated:{parameters:{nodeRef:{type:'any'},nodeId:{type:'string'}}}}}});N.prototype.findNodesById=function(b){if(b.fields.some(function(g){return!g.caseSensitive;})){b=q.extend(true,{},b);b.fields.forEach(function(g){if(!g.caseSensitive){g.value=g.value.toLowerCase();}});}var c=function(p,g,v,h){var m;p=p||'equals';h=h||'';var j=g?v:v.toLowerCase();switch(p){case'equals':m=(j===h);break;case'contains':m=(j.indexOf(h)!==-1);break;case'startsWith':m=(j.indexOf(h)===0);break;default:m=false;q.sap.log.error(sap.ui.vk.getResourceBundle().getText(a.VIT8.summary),a.VIT8.code,'sap.ui.vk.dvl.NodeHierarchy');}return m;};var i=function(l,g){return!l.some(function(v){return g.name===v.name?c(g.predicate,g.caseSensitive,v.value,g.value):false;});};var f=function(b,v){return b.source===v.source&&b.type===v.type&&!b.fields.some(i.bind(undefined,v.fields));};var d=this.findNodesByName();var e=d.filter(function(n){var g=this.createNodeProxy(n);var v=g.getVeIds();this.destroyNodeProxy(g);return v.some(f.bind(undefined,b));}.bind(this));return e;};N.prototype.findNodesByMetadata=function(b){var c=function(m,j,k,v,h,i){if(m.hasOwnProperty(j)){var l=m[j];if(l.hasOwnProperty(k)){var n=l[k];if(!i){n=n.toLowerCase();}return v.some(h.bind(undefined,n));}}return false;};var d=function(m,j){if(m==null){return false;}return m.hasOwnProperty(j);};var g=function(e,f,j,k,v,h,i){var n=this._baseNodeProxyPool.borrowObject();var r=e.filter(function(l){n.init(this,l);var m=n.getNodeMetadata();var o=f(m,j,k,v,h,i);n.reset();return o;}.bind(this));this._baseNodeProxyPool.returnObject(n);return r;};var e=this.findNodesByName(),r=[];if(b===undefined||b===null||q.isEmptyObject(b)){r=e;}else if(b.category!==null&&b.category!==undefined&&b.category!==''){var f,v,p,h,i=!!(b&&b.caseSensitive);if(b.key===undefined||b.key===null){f=d;}else{v=b.value;p=b.predicate||'equals';if(v===undefined||v===null){v='';p='contains';}if(!Array.isArray(v)){v=[v];}if(!i){v=v.map(function(j){return j.toLowerCase();});}switch(p){case'equals':h=function(m,j){return m===j;};break;case'contains':h=function(m,j){return m.indexOf(j)!==-1;};break;case'startsWith':h=function(m,j){return m.indexOf(j)===0;};break;default:q.sap.log.error(sap.ui.vk.getResourceBundle().getText(a.VIT9.summary),a.VIT9.code,'sap.ui.vk.dvl.NodeHierarchy');}f=c;}r=g.bind(this)(e,f,b.category,b.key,v,h,i);}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(a.VIT10.summary),a.VIT10.code,'sap.ui.vk.dvl.NodeHierarchy');}return q.sap.unique(r);};N.prototype._appendAncestors=function(n,s){s=s?new Set(s):null;var b=new Set(n);n.forEach(function(d){var e=this.getAncestors(d);e.forEach(function(f){if(s===null||!s.has(f)){b.add(f);}});},this);var c=[];b.forEach(function(d){c.push(d);});return c;};return N;});\n",
	"sap/ui/vk/NodeProxy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/base/ManagedObject'],function(q,l,M){'use strict';var N=M.extend('sap.ui.vk.NodeProxy',{metadata:{properties:{nodeRef:'any',veIds:'object[]',name:'string',localMatrix:{type:'sap.ui.vk.TransformationMatrix',bindable:'bindable'},worldMatrix:{type:'sap.ui.vk.TransformationMatrix',bindable:'bindable'},material:{type:'sap.ui.vk.Material'},opacity:{type:'float',bindable:'bindable'},tintColorABGR:{type:'int',bindable:'bindable'},tintColor:{type:'sap.ui.core.CSSColor',bindable:'bindable'},nodeMetadata:'object',hasChildren:'boolean',closed:'boolean'}}});N.prototype.setClosed=function(v){return this;};N.prototype.setHasChildren=function(v){return this;};N.prototype.setName=function(v){return this;};N.prototype.setNodeId=function(v){return this;};N.prototype.setNodeMetadata=function(v){return this;};N.prototype.setVeIds=function(v){return this;};N.prototype.assignMaterial=function(v){return this;};return N;});\n",
	"sap/ui/vk/Notifications.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','./Messages','sap/m/ToggleButton','./NotificationsRenderer'],function(q,l,C,M,T,N){'use strict';var a=C.extend('sap.ui.vk.Notifications',{metadata:{library:'sap.ui.vk',publicMethods:['clearAllMessages'],aggregations:{_messagePopover:{type:'sap.m.MessagePopover',multiple:false,visibility:'hidden'},_messagePopoverToggleButton:{type:'sap.m.ToggleButton',multiple:false,visibility:'hidden'}},events:{allMessagesCleared:{},messageAdded:{}}}});a.prototype.init=function(){if(C.prototype.init){C.prototype.init.call(this);}var m;var b=new T({icon:'sap-icon://message-popup',type:sap.m.ButtonType.Emphasized,tooltip:sap.ui.vk.getResourceBundle().getText('MESSAGEPOPOVERBUTTON'),text:'0',press:function(e){if(b.getPressed()){m.openBy(b);}else{m.close();}}});b.addStyleClass('messagePopoverButton');this.setAggregation('_messagePopoverToggleButton',b);m=new sap.m.MessagePopover({headerButton:new sap.m.Button({text:sap.ui.vk.getResourceBundle().getText('MESSAGEPOPOVER_CLEARBUTTON'),type:sap.m.ButtonType.Emphasized,tooltip:sap.ui.vk.getResourceBundle().getText('MESSAGEPOPOVER_CLEARBUTTON'),press:function(e){m.getParent().clearAllMessages();}}),afterClose:b.setPressed.bind(b,false)});m.addStyleClass('sapVizKitNotificationPopover');this.setAggregation('_messagePopover',m);q.sap.log.addLogListener(this);};a.prototype.exit=function(){q.sap.log.removeLogListener(this);if(C.prototype.exit){C.prototype.exit.call(this);}};a.prototype.onLogEntry=function(e){if(/^sap\\.ui\\.vk/.test(e.component)){var m=e.details,c,r,b;if(M[e.details]){m=sap.ui.vk.getResourceBundle().getText(M[e.details].summary);c=sap.ui.vk.getResourceBundle().getText(M[e.details].cause);r=sap.ui.vk.getResourceBundle().getText(M[e.details].resolution);b=sap.ui.vk.getResourceBundle().getText('ERROR_DESCRIPTION_CODE');}var d=sap.ui.vk.getResourceBundle().getText('ERROR_DESCRIPTION_COMPONENT');var f=sap.ui.vk.getResourceBundle().getText('ERROR_DESCRIPTION_DATE');var t=sap.ui.vk.getResourceBundle().getText('ERROR_DESCRIPTION_TIME');var g=sap.ui.vk.getResourceBundle().getText('ERROR_DESCRIPTION_LEVEL');var h=sap.ui.vk.getResourceBundle().getText('ERROR_DESCRIPTION_MESSAGE');var i=sap.ui.vk.getResourceBundle().getText('ERROR_DESCRIPTION_CAUSE');var j=sap.ui.vk.getResourceBundle().getText('ERROR_DESCRIPTION_RESOLUTION');var k='<div><b>'+d+':</b><br>'+e.component+'</div><br>'+'<div><b>'+f+':</b><br>'+e.date+'</div><br>'+(b?'<div><b>'+b+':</b><br>'+e.details+'</div><br>':'')+'<div><b>'+t+':</b><br>'+e.time.slice(0,e.time.indexOf('.'))+'</div><br>'+'<div><b>'+g+':</b><br>'+e.level+'</div><br>'+'<div><b>'+h+':</b><br>'+m+'</div><br>'+(c?'<div><b>'+i+':</b><br>'+c+'</div><br>':'')+(r?'<div><b>'+j+':</b><br>'+r+'</div>':'');var n=new sap.m.MessagePopoverItem({markupDescription:true,title:e.message,description:k});var o=this.getAggregation('_messagePopover');o.addItem(n);this.getAggregation('_messagePopoverToggleButton').setText(o.getItems().length);this.fireMessageAdded();}};a.prototype.clearAllMessages=function(){var m=this.getAggregation('_messagePopover');m.removeAllItems();m.close();this.getAggregation('_messagePopoverToggleButton').setText(m.getItems().length);this.fireAllMessagesCleared();return this;};return a;});\n",
	"sap/ui/vk/NotificationsRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var N={};N.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapVizKitNotifications');r.writeClasses();r.write('>');r.renderControl(c.getAggregation('_messagePopoverToggleButton'));r.write('</div>');};return N;},true);\n",
	"sap/ui/vk/OrthographicCamera.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./Camera'],function(q,C){'use strict';var O=C.extend('sap.ui.vk.OrthographicCamera',{metadata:{properties:{'zoomFactor':{type:'float'}}}});return O;});\n",
	"sap/ui/vk/Overlay.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','sap/ui/vbm/library','sap/ui/vbm/lib/sapvbi','./Messages','./OverlayRenderer'],function(q,l,C,v,a,M,O){'use strict';var b=C.extend('sap.ui.vk.Overlay',{metadata:{library:'sap.ui.vk',properties:{zoomOnResize:{type:'boolean',group:'Behavior',defaultValue:true}},aggregations:{areas:{type:'sap.ui.vk.OverlayArea',multiple:true,singularName:'area'}},associations:{target:{type:'sap.ui.core.Control',cardinality:'0..1'}},events:{click:{parameters:{clientX:{type:'int'},clientY:{type:'int'},pos:{type:'string'}}},contextMenu:{parameters:{pos:{type:'string'},menu:{type:'sap.ui.unified.Menu'}}}}}});b.prototype.getPositionInteractive=function(p,c){if(!this.mIACreateCB&&c&&typeof(c)==='function'){this.mIACreateCB=c;var t='POS';if(p){t+='ARRAY';}var L={'SAPVB':{'Automation':{'Call':{'handler':'OBJECTCREATIONHANDLER','name':'CreateObject','object':'MainScene','scene':'MainScene','instance':'','Param':{'name':'data','#':'{'+t+'}'}}}}};this._load(L);return true;}else{return false;}};b.prototype.openContextMenu=function(m){this._openContextMenu('Overlay',this,m);};b.prototype.setPanAndZoom=function(n,c,z){if(n===0&&c===0&&z===1){return;}var s=this.mVBIContext.GetMainScene();this.totalCenterOffset.dx+=n;this.totalCenterOffset.dy+=c;if(z===1){s.MoveMap(n,c);}else{var d=s.m_Canvas[0];var e=d.m_nExactLOD+Math.log(z)*Math.LOG2E;s.ZoomToGeoPosition(VBI.MathLib.DegToRad([0.5,0.5]),e);s.MoveMap(this.totalCenterOffset.dx,this.totalCenterOffset.dy);}};b.prototype.reset=function(){this.totalCenterOffset.dx=this.totalCenterOffset.dy=0;var s=this.mVBIContext.GetMainScene();if(s){s.ZoomToGeoPosition(VBI.MathLib.DegToRad([0.5,0.5]),this.initialZoom);}return this;};b.prototype.init=function(){this.aLoadQueue=null;this.oTargetDomRef=null;this.mVBIContext=new VBI.VBIContext(this);this.resizeID='';this.resizeIDTarget='';this.bVosDirty=true;this.bWindowsDirty=true;this.bSceneDirty=true;this.bDataDeltaUpdate=false;this.bHandleDataChangeActive=false;this.bForceDataUpdate=false;this.mAddMenuItems=[];this.totalCenterOffset={dx:0,dy:0};this.initialZoom=10;};b.prototype.exit=function(){if(this.mVBIContext){this.mVBIContext.clear();}if(this.resizeID!=''){sap.ui.core.ResizeHandler.deregister(this.resizeID);this.resizeID='';}if(this.resizeIDTarget!=''){sap.ui.core.ResizeHandler.deregister(this.resizeIDTarget);this.resizeIDTarget='';}};b.prototype.resize=function(e){var c=(this.oControl!=undefined)?this.oControl:this;var d=c.mVBIContext;if(d){var s=d.GetMainScene();if(s){if(c.getZoomOnResize()&&e&&e.oldSize.width>0){var z=Math.log(e.size.width/e.oldSize.width)*Math.LOG2E;s.ZoomToGeoPosition(s.GetCenterPos(),s.GetCurrentZoomlevel()+z,false,true,true);}s.resizeCanvas(e,true,true);}}};b.prototype.setTarget=function(t){if(!t){return;}this.setAssociation('target',t);this.reset();if(t instanceof sap.m.Image){t.addDelegate({onAfterRendering:function(e){this.oTargetDomRef=t.getDomRef();this.oTargetDomRef.addEventListener('load',q.proxy(this._adaptSizeOfTarget,this));}.bind(this)});}else{t.addDelegate({onAfterRendering:function(e){this.oTargetDomRef=t.getDomRef();this._adaptSizeOfTarget();}.bind(this)});}if(this.resizeIDTarget!=''){sap.ui.core.ResizeHandler.deregister(this.resizeIDTarget);this.resizeIDTarget='';}this.resizeIDTarget=sap.ui.core.ResizeHandler.register(t,this._adaptSizeOfTarget.bind(this));};b.prototype._adaptSizeOfTarget=function(){var t=this.oTargetDomRef;var d=this.getDomRef();if(t){try{var T=q(t);var p={top:T.offset().top,left:T.offset().left,width:T.outerWidth(),height:T.outerHeight()};q(d).width(p.width).height(p.height).css('position','absolute');q(d).css('top','0px').css('left','0px').css('visibility','');}catch(e){q.sap.log.error(e);}}else{q(d).css('position','fixed').width('0px').height('0px').css('top','0px').css('left','0px').css('visibility','hidden');}};b.prototype.onAfterRendering=function(){if(this.$oldContent.length>0){this.$().append(this.$oldContent);}this._adaptSizeOfTarget();if(this.aLoadQueue){var n;for(n=0;n<this.aLoadQueue.length;++n){this._load(this.aLoadQueue[n]);}this.aLoadQueue=null;}if(this.resizeID==''){this.resize();this.resizeID=sap.ui.core.ResizeHandler.register(this,this.resize);}var o=this.getId();if(this.mVBIContext.m_Windows){this.mVBIContext.m_Windows.Awake(o);}};b.prototype.onBeforeRendering=function(){this.$oldContent=sap.ui.core.RenderManager.findPreservedContent(this.getId());};b.prototype.invalidate=function(s){this.bSceneDirty=true;if(s instanceof sap.ui.vk.OverlayArea){this.bVosDirty=true;this.bDataDeltaUpdate=this.bHandleDataChangeActive;}sap.ui.core.Control.prototype.invalidate.apply(this,arguments);};b.prototype._load=function(d){if(!this.isRendered()){if(!this.aLoadQueue){this.aLoadQueue=[];}this.aLoadQueue.push(d);return;}this._loadHtml(d);};b.prototype._loadHtml=function(d){var o=this.getId();var c=null;if(typeof d=='string'){c=JSON.parse(d.indexOf('{')?d.substr(d.indexOf('{')):d);}else if(typeof d=='object'){c=d;}if(!c){return;}if(!c['SAPVB']){var m;if(this.mVBIContext&&(m=(new VBI.Adaptor(this.mVBIContext)).CreateLoadData(c))){this.loadHtml(m);return;}else{return;}}var e=false;var f=false;var g=false;if(q.type(c)=='object'){if(c.SAPVB){if(c.SAPVB.Config){this.mVBIContext.GetConfig().load(c.SAPVB.Config,this.mVBIContext);}if(c.SAPVB.Resources){this.mVBIContext.GetResources().load(c.SAPVB.Resources,this.mVBIContext);}if(c.SAPVB.DataTypes){if(!this.mVBIContext['m_DataTypeProvider']){this.mVBIContext['m_DataTypeProvider']=new VBI.DataTypeProvider();}this.mVBIContext['m_DataTypeProvider'].load(c.SAPVB.DataTypes,this.mVBIContext);}if(c.SAPVB.Data){if(!this.mVBIContext['m_DataProvider']){this.mVBIContext['m_DataProvider']=new VBI.DataProvider();}this.mVBIContext['m_DataProvider'].load(c.SAPVB.Data,this.mVBIContext);e=true;}if(c.SAPVB.Windows){if(!this.mVBIContext['m_Windows']){this.mVBIContext['m_Windows']=new VBI.Windows();}this.mVBIContext['m_Windows'].load(c.SAPVB.Windows,this.mVBIContext);g=true;}if(c.SAPVB.Actions){if(!this.mVBIContext['m_Actions']){this.mVBIContext['m_Actions']=new VBI.Actions();}this.mVBIContext['m_Actions'].load(c.SAPVB.Actions,this.mVBIContext);}if(c.SAPVB.Automation){if(!this.mVBIContext['m_Automations']){this.mVBIContext['m_Automations']=new VBI.Automations();}this.mVBIContext['m_Automations'].load(c.SAPVB.Automation,this.mVBIContext);}if(c.SAPVB.Menus){if(!this.mVBIContext['m_Menus']){this.mVBIContext['m_Menus']=new VBI.Menus();}this.mVBIContext['m_Menus'].load(c.SAPVB.Menus,this.mVBIContext);}if(c.SAPVB.Scenes){if(!this.mVBIContext['m_SceneManager']){this.mVBIContext['m_SceneManager']=new VBI.SceneManager();}this.mVBIContext['m_SceneManager'].load(c.SAPVB.Scenes,this.mVBIContext);f=true;}}if(e){if(this.mVBIContext['m_Windows']){this.mVBIContext['m_Windows'].NotifyDataChange();}}if(f||g){if(this.mVBIContext['m_Windows']){this.mVBIContext['m_Windows'].Awake(o);}}if(f||e){if(this.mVBIContext['m_Windows']){this.mVBIContext['m_Windows'].RenderAsync();}}}};b.prototype._openContextMenu=function(t,i,m){if(m&&m.vbi_data&&m.vbi_data.VBIName=='DynContextMenu'){if(!this.mVBIContext['m_Menus']){this.mVBIContext['m_Menus']=new window.VBI.Menus();}for(var n=0;n<this.mAddMenuItems.length;++n){m.addItem(this.mAddMenuItems[n]);}this.mVBIContext.m_Menus.m_menus.push(m);this._loadHtml({'SAPVB':{'version':'2.0','Automation':{'Call':{'earliest':'0','handler':'CONTEXTMENUHANDLER','instance':i.sId,'name':'SHOW','object':t,'refID':'CTM','Param':[{'name':'x','#':i.mClickPos[0]},{'name':'y','#':i.mClickPos[1]},{'name':'scene','#':'MainScene'}]}}}});}this.mAddMenuItems=[];};b.prototype._update=function(){var A={SAPVB:{}};if(this.bSceneDirty){this._updateScene(A);}this._updateWindows(A);if(A.SAPVB.Actions){Array.prototype.push.apply(A.SAPVB.Actions.Set.Action,this._getActionArray());}return this._minimizeApp(A);};b.prototype._minimizeApp=function(A){var t,s;var c;s=null;if(!this.bWindowsDirty){c=(t=A)&&(t=t.SAPVB)&&(t=t.Windows)&&(s=JSON.stringify(t))&&(s==this.mCurWindows)&&(delete A.SAPVB.Windows);if(!c){this.mCurWindows=s?s:this.mCurWindows;}}else{this.bWindowsDirty=false;}s=null;c=(t=A)&&(t=t.SAPVB)&&(t=t.Scenes)&&(s=JSON.stringify(t))&&(s==this.mCurScenes)&&(delete A.SAPVB.Scenes);if(!c){this.mCurScenes=s?s:this.mCurScenes;}s=null;c=(t=A)&&(t=t.SAPVB)&&(t=t.Actions)&&(s=JSON.stringify(t))&&(s==this.mCurActions)&&(delete A.SAPVB.Actions);if(!c){this.mCurActions=s?s:this.mCurActions;}s=null;c=(t=A)&&(t=t.SAPVB)&&(t=t.DataTypes)&&(s=JSON.stringify(t))&&(s==this.mCurDataTypes)&&(delete A.SAPVB.DataTypes);if(!c){this.mCurDataTypes=s?s:this.mCurDataTypes;}if(!this.bForceDataUpdate){s=null;c=(t=A)&&(t=t.SAPVB)&&(t=t.Data)&&(s=JSON.stringify(t))&&(s==this.mCurData)&&(delete A.SAPVB.Data);if(!c){this.mCurData=s?s:this.mCurData;}}else{this.bForceDataUpdate=false;}return A;};b.prototype._updateWindows=function(A){A.SAPVB.Windows={'Set':[{'name':'Main','Window':{'id':'Main','caption':'MainWindow','type':'geo','refParent':'','refScene':'MainScene','modal':'true'}}]};};b.prototype._updateScene=function(A){var s=[];var c=[];var d=[];var e=[];this._updateVOData(s,c,d,e);var _=JSON.stringify(s);var m=true;if(!this.saVO){((((A.SAPVB.Scenes={}).Set={}).SceneGeo={id:'MainScene',scaleVisible:'false',navControlVisible:'false',VisualFrame:{minLOD:5},NavigationDisablement:{move:'true',zoom:'true'},initialZoom:this.initialZoom.toString(),initialStartPosition:'0.5;0.5;0'}).VO=s);}else if(this.bRefMapLayerStackDirty||!(this.saVO===_)){(A.SAPVB.Scenes=this._getSceneVOdelta(JSON.parse(this.m_saVO),s));}else{m=false;}this.saVO=_;if(this.bDataDeltaUpdate){A.SAPVB.Data=[];for(var n=0;n<c.length;++n){A.SAPVB.Data.push({Set:{name:c[n].name,type:'N',N:c[n]}});}}else{((A.SAPVB.Data={}).Set={}).N=c;}if(m){(((A.SAPVB.DataTypes={}).Set={}).N=d);}(((A.SAPVB.Actions={}).Set={}).Action=e);this.bSceneDirty=this.bVosDirty=this.bDataDeltaUpdate=false;};b.prototype._isEventRegistered=function(A,e){var c=this.getAggregation(A);if(!c){return false;}for(var n=0;n<c.length;++n){var i=c[n];if(i.hasListeners(e)){return true;}}return false;};b.prototype._getTemplateBindingInfo=function(A){var B=this.getBindingInfo(A);if(B&&B.template){return B.template.mBindingInfos;}};b.prototype._getBindInfo=function(A){var B={};var t=this._getTemplateBindingInfo(A);B.C=(t)?t.hasOwnProperty('color'):true;B.CB=(t)?t.hasOwnProperty('colorBorder'):true;B.DCH=(t)?t.hasOwnProperty('deltaColorHot'):true;B.CS=(t)?t.hasOwnProperty('colorSelect'):true;B.CNS=(t)?t.hasOwnProperty('colorNonSelect'):true;B.TT=(t)?t.hasOwnProperty('tooltip'):true;B.M=(t)?t.hasOwnProperty('changeable'):true;B.hasTemplate=(t)?true:false;return B;};b.prototype._updateVOData=function(s,c,d,e){var B,V;this.AreaBindInfo=B=(this.AreaBindInfo)?this.AreaBindInfo:this._getBindInfo('areas');V=(B.hasTemplate)?this.getBindingInfo('areas').template:null;var o={id:'OverlayArea',datasource:'OverlayArea',type:'{00100000-2012-0004-B001-F311DE491C77}'};o['posarray.bind']=o.id+'.P';if(B.C){o['color.bind']=o.id+'.C';}else{o.color=V.getColor();}if(B.CB){o['colorBorder.bind']=o.id+'.C';}else{o.colorBorder=V.getColorBorder();}if(B.DCH){o['hotDeltaColor.bind']=o.id+'.DCH';}else{o.hotDeltaColor=V.getDeltaColorHot();}if(B.CS){o['colorSelect.bind']=o.id+'.C';}else{o.colorSelect=V.getColorSelect();}if(B.CNS){o['colorNonSelect.bind']=o.id+'.C';}else{o.colorNonSelect=V.getColorNonSelect();}if(!B.M){o['VB:c']=V.getChangeable();}s.push(o);var f={name:o.id,key:'K'};f.A=[{'name':'K','alias':'K','type':'string'},{'name':'VB:s','alias':'VB:s','type':'boolean'},{'name':'P','alias':'P','type':'vectorarray','changeable':'true'}];if(B.C){f.A.push({'name':'C','alias':'C','type':'color'});}if(B.CB){f.A.push({'name':'CB','alias':'CB','type':'string'});}if(B.DCH){f.A.push({'name':'DCH','alias':'DCH','type':'string'});}if(B.CS){f.A.push({'name':'CS','alias':'CS','type':'string'});}if(B.CNS){f.A.push({'name':'CNS','alias':'CNS','type':'string'});}if(B.TT){f.A.push({'name':'TT','alias':'TT','type':'string'});}d.push(f);var i=o.id;if(this._isEventRegistered('areas','click')){e.push({'id':i+'1','name':'click','refScene':'MainScene','refVO':i,'refEvent':'Click','AddActionProperty':[{'name':'pos'}]});}if(this._isEventRegistered('areas','contextMenu')){e.push({'id':i+'2','name':'contextMenu','refScene':'MainScene','refVO':i,'refEvent':'ContextMenu'});}if(this._isEventRegistered('areas','edgeClick')){e.push({'id':i+'7','name':'edgeClick','refScene':'MainScene','refVO':i,'refEvent':'EdgeClick'});}e.push({'id':i+'4','name':'handleMoved','refScene':'MainScene','refVO':i,'refEvent':'HandleMoved'});e.push({'id':i+'5','name':'handleContextMenu','refScene':'MainScene','refVO':i,'refEvent':'HandleContextMenu'});e.push({'id':i+'8','name':'edgeContextMenu','refScene':'MainScene','refVO':i,'refEvent':'EdgeContextMenu'});if(this._isEventRegistered('areas','handleClick')){e.push({'id':i+'6','name':'handleClick','refScene':'MainScene','refVO':i,'refEvent':'HandleClick'});}var g={name:o.id,E:[]};var h=this.getAreas();for(var n=0;n<h.length;++n){g.E.push(h[n].getDataElement());}c.push(g);};b.prototype._getSceneVOdelta=function(c,n){var V=[];var r=[];var o={};for(var d=0,e=c.length;d<e;++d){o[c[d].id]=c[d];}for(var f=0;f<n.length;++f){if(o[n[f].id]){if(JSON.stringify(n[f])!=JSON.stringify(o[n[f].id])){r.push({'id':n[f].id,'type':'VO'});V.push(n[f]);}}else{V.push(n[f]);}delete o[n[f].id];}for(var i in o){r.push({'id':i,'type':'VO'});}var g={'Merge':{'name':'MainScene','type':'SceneGeo','SceneGeo':{'id':'MainScene'}}};if(r.length){g.Merge.SceneGeo.Remove=r;}if(V.length){g.Merge.SceneGeo.VO=V;}return g;};b.prototype._getActionArray=function(){var A=[];if(this.mEventRegistry['click']){A.push({'id':'Overlay1','name':'click','refScene':'MainScene','refVO':'Map','refEvent':'Click','AddActionProperty':[{'name':'pos'}]});}if(this.mEventRegistry['contextMenu']){A.push({'id':'Overlay2','name':'contextMenu','refScene':'MainScene','refVO':'Map','refEvent':'ContextMenu','AddActionProperty':[{'name':'pos'}]});}A.push({'id':'Overlay3','name':'GetPosComplete','refScene':'MainScene','refVO':'General','refEvent':'CreateComplete'});return A;};b.prototype._handleChangedData=function(n){try{this.bHandleDataChangeActive=true;if(n&&n.length){for(var c=0,N;c<n.length;++c){N=n[c];if(N.E&&N.E.length){for(var d=0,e,i;d<N.E.length;++d){e=N.E[d];i=this._findInstance(e.K);if(i){i.handleChangedData(e);}}}}}this.bHandleDataChangeActive=false;}catch(f){this.bHandleDataChangeActive=false;throw f;}};b.prototype._findInstance=function(i){var I=(i.indexOf('.')!==-1)?i.split('.')[1]:i;var A=this.getAreas();for(var n=0;n<A.length;++n){var e=A[n];if(e.getId()===I){return e;}}return null;};b.prototype._handleAggregationEvent=function(e){var E;if((E=this._findInstance(e.Action.instance))){try{E.handleEvent(e);}catch(c){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT11.summary),M.VIT11.code,'sap.ui.vk.Overlay');}}};b.prototype.isRendered=function(){return this.getDomRef()?true:false;};b.prototype.fireSubmit=function(e){var d=JSON.parse(e.data);if(d.Data&&d.Data.Merge){this._handleChangedData(d.Data.Merge.N);}if(d.Action.object==='OverlayArea'){this._handleAggregationEvent(d);}else{var A=d.Action.name,c;if(A==='click'||A==='contextMenu'){c=[d.Action.Params.Param[0]['#'],d.Action.Params.Param[1]['#']];}switch(A){case'GetPosComplete':if(this.mIACreateCB){try{this.mIACreateCB(d.Action.Params.Param[0]['#']);this.mIACreateCB=null;}catch(f){this.mIACreateCB=null;throw f;}}break;case'click':this.fireClick({clientX:c[0],clientY:c[1],pos:d.Action.AddActionProperties.AddActionProperty[0]['#']});break;case'contextMenu':if(this.mVBIContext.m_Menus){this.mVBIContext.m_Menus.deleteMenu('DynContextMenu');}sap.ui.getCore().loadLibrary('sap.ui.unified');var m=new sap.ui.unified.Menu();m['vbi_data']={};m['vbi_data'].menuRef='CTM';m['vbi_data'].VBIName='DynContextMenu';this.mClickPos=c;this.fireContextMenu({pos:d.Action.AddActionProperties.AddActionProperty[0]['#'],menu:m});break;default:break;}}};b.prototype.fireRender=function(d){};b.prototype.fireMove=function(d){};b.prototype.fireZoom=function(d){};b.prototype.fireOpenWindow=function(d){};b.prototype.fireCloseWindow=function(d){};return b;});\n",
	"sap/ui/vk/OverlayArea.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['./library','sap/ui/core/Element'],function(l,E){'use strict';var O=E.extend('sap.ui.vk.OverlayArea',{metadata:{library:'sap.ui.vk',properties:{key:{type:'string',group:'Misc',defaultValue:null},position:{type:'string',group:'Misc',defaultValue:null},color:{type:'sap.ui.core.CSSColor',group:'Misc',defaultValue:'rgba(200, 50, 50, 0.3)'},colorBorder:{type:'sap.ui.core.CSSColor',group:'Misc',defaultValue:'rgba(200, 50, 50, 1.0)'},colorSelect:{type:'string',group:'Misc',defaultValue:null},colorNonSelect:{type:'string',group:'Misc',defaultValue:null},deltaColorHot:{type:'string',group:'Misc',defaultValue:'RHLSA(0;1.3;1.0;1.0)'},select:{type:'boolean',group:'Misc',defaultValue:false},changeable:{type:'boolean',group:'Misc',defaultValue:false}},events:{click:{clientX:{type:'int'},clientY:{type:'int'}},contextMenu:{parameters:{menu:{type:'sap.ui.unified.Menu'}}},edgeClick:{parameters:{index:{type:'int'}}},edgeContextMenu:{parameters:{index:{type:'int'},menu:{type:'sap.ui.unified.Menu'}}},handleMoved:{},handleContextMenu:{parameters:{index:{type:'int'},menu:{type:'sap.ui.unified.Menu'}}},handleClick:{index:{type:'int'}}}}});O.prototype.openContextMenu=function(m){this.getParent().openContextMenu('OverlayArea',this,m);};O.prototype.getDataElement=function(){var e={};var b=this.getParent().AreaBindInfo;e.K=this.getId();if(b.C){e.C=this.getColor();}if(b.CB){e.CB=this.getColorBorder();}if(b.DCH){e.DCH=this.getDeltaColorHot();}if(b.CS){e.CS=this.getColorSelect();}if(b.CNS){e.CNS=this.getColorNonSelect();}if(b.TT){e.TT=this.getTooltip();}e['VB:s']=this.getSelect();e.P=this.getPosition();if(b.M){e['VB:c']=this.getChangeable();}return e;};O.prototype.handleChangedData=function(e){if(e.P){this.setPosition(e.P);}};O.prototype.handleEvent=function(e){var a=e.Action.name;var f='fire'+a[0].toUpperCase()+a.slice(1);if(a==='contextMenu'||a==='edgeContextMenu'||a==='handleContextMenu'){var p=this.getParent();this.mClickPos=[e.Action.Params.Param[0]['#'],e.Action.Params.Param[1]['#']];if(p.mVBIContext.m_Menus){p.mVBIContext.m_Menus.deleteMenu('DynContextMenu');}sap.ui.getCore().loadLibrary('sap.ui.unified');var m=new sap.ui.unified.Menu();m['vbi_data']={};m['vbi_data'].menuRef='CTM';m['vbi_data'].VBIName='DynContextMenu';if(this.getChangeable()){if(a==='edgeContextMenu'){var s=e.Action.Params.Param[2]['#'];p.mAddMenuItems.push(new sap.ui.unified.MenuItem({text:sap.ui.vk.getResourceBundle().getText('OVL_AREA_EDGE_SPLIT'),select:this._handleCtxFunction.bind(this,'SPLIT',s)}));}else if(a==='handleContextMenu'){var h=e.Action.Params.Param[2]['#'];p.mAddMenuItems.push(new sap.ui.unified.MenuItem({text:sap.ui.vk.getResourceBundle().getText('OVL_AREA_HANDLE_REMOVE'),select:this._handleCtxFunction.bind(this,'REMOVE',h)}));}}if(this.hasListeners(a)){if(a==='contextMenu'){this.firecontextMenu({menu:m});}else{this[f]({index:e.Action.Params.Param[2]['#'],menu:m});}}else{p._openContextMenu(e.Action.object,this,m);}}else if(a=='click'){this.mClickPos=e.Action.AddActionProperties.AddActionProperty[0]['#'];this.fireClick({clientX:e.Action.Params.Param[0]['#'],clientY:e.Action.Params.Param[1]['#']});}else if(a.indexOf('Click')>-1){this[f]({index:e.Action.Params.Param[2]['#']});}else{this[f]();}};O.prototype.getKey=function(){var k=this.getProperty('key');if(!k){k=this.getId();}return k;};O.prototype._handleCtxFunction=function(f,c){var p=this.getPosition().split(';');var o=c*3;if(f==='REMOVE'){p.splice(o,3);}else if(f==='SPLIT'){var s=[p[o],p[o+1]];var e=(o+3<p.length)?[p[o+3],p[o+4]]:[p[0],p[1]];var m=[parseFloat(s[0])+(e[0]-s[0])/2,parseFloat(s[1])+(e[1]-s[1])/2];p.splice(o+3,0,m[0].toString(),m[1].toString(),'0');}this.setPosition(p.toString().replace(/,/g,';'));};return O;});\n",
	"sap/ui/vk/OverlayRenderer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(function(){'use strict';var O={};O.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapUiVkOverlay');r.writeClasses(c);r.write('>');r.write('</div>');var a;if((a=c._update())){c._load(a);}};return O;},true);\n",
	"sap/ui/vk/PerspectiveCamera.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./Camera'],function(q,C){'use strict';var P=C.extend('sap.ui.vk.PerspectiveCamera',{metadata:{properties:{'fov':{type:'float'}}}});return P;});\n",
	"sap/ui/vk/ProgressIndicator.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/m/ProgressIndicator','./ProgressIndicatorRenderer'],function(q,l,M,P){'use strict';var a=M.extend('sap.ui.vk.ProgressIndicator');a.prototype.setPercentValue=function(p){var i=function i(v){return(typeof(v)==='number')&&!isNaN(v)&&v>=0&&v<=100;};var t=this,$,f,b=this.$(),A,u=false;if(!i(p)){p=0;q.sap.log.warning(this+': percentValue ('+p+') is not correct! Setting the default percentValue:0.');}if(this.getPercentValue()!==p){f=this.getPercentValue()-p;this.setProperty('percentValue',p,true);if(!b.length){return this;}['sapMPIValueMax','sapMPIValueMin','sapMPIValueNormal','sapMPIValueGreaterHalf'].forEach(function(c){b.removeClass(c);});b.addClass(this._getCSSClassByPercentValue(p));b.addClass('sapMPIAnimate').attr('aria-valuenow',p).attr('aria-valuetext',this._getAriaValueText({fPercent:p}));A=u?Math.abs(f)*20:0;$=this.$('bar');$.animate({'flex-basis':p+'%'},A,'linear',function(){t._setText.apply(t);t.$().removeClass('sapMPIAnimate');});}return this;};return a;},true);\n",
	"sap/ui/vk/ProgressIndicatorRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/m/ProgressIndicatorRenderer'],function(q,P){'use strict';return P;},true);\n",
	"sap/ui/vk/RedlineDesign.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','./RedlineSurface','./RedlineElement','./RedlineGesturesHandler','./RedlineDesignHandler','./Loco','./RedlineDesignRenderer'],function(q,l,C,R,a,b,c,L,d){'use strict';var e=R.extend('sap.ui.vk.RedlineDesign',{metadata:{library:'sap.ui.vk',events:{elementCreated:{parameters:{element:'object'}}},aggregations:{activeElementInstance:{type:'sap.ui.vk.RedlineElement',multiple:false,visibility:'hidden'}}}});e.prototype.init=function(){this._isAddingModeActive=false;this._isDrawingOn=false;this._activeElementInstance=null;this.addStyleClass('sapUiVizkitRedlineInteractionMode');this._gestureHandler=new b(this);this._designHandler=new c(this);};e.prototype.onBeforeRendering=function(){if(this._loco){this._loco.removeHandler(this._gestureHandler);this._loco.removeHandler(this._designHandler);}};e.prototype.onAfterRendering=function(){var f=this.getDomRef();f.style.width='100%';f.style.height='100%';this._loco=new L();if(this._isAddingModeActive){this._loco.addHandler(this._designHandler);}else{this._loco.addHandler(this._gestureHandler);}this.updatePanningRatio();};e.prototype._editElement=function(f,o,g){f.edit(o,g);return this;};e.prototype._getIsDrawingOn=function(){return this._isDrawingOn;};e.prototype._setIsDrawingOn=function(i){this._isDrawingOn=i;return this;};e.prototype.startAdding=function(f){this._isAddingModeActive=true;this._activeElementInstance=f;this.setAggregation('activeElementInstance',this._activeElementInstance);this.addStyleClass('sapUiVizkitRedlineDesignMode');this.removeStyleClass('sapUiVizkitRedlineInteractionMode');return this;};e.prototype.stopAdding=function(){this._isAddingModeActive=false;this._setIsDrawingOn(false);this.setAggregation('activeElementInstance',null);this._activeElementInstance=null;this.addStyleClass('sapUiVizkitRedlineInteractionMode');this.removeStyleClass('sapUiVizkitRedlineDesignMode');return this;};e.prototype._getOffset=function(o){var r=o.getBoundingClientRect();return{x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};};e.prototype._getTargetViewport=function(){return this._targetViewport;};e.prototype._setTargetViewport=function(v){this._targetViewport=v;this._targetViewport.attachEvent('resize',this,this._onresize,this);};e.prototype._onresize=function(f){var v=f.oSource.getOutputSize();this.setProperty('virtualLeft',v.left,true);this.setProperty('virtualTop',v.top,true);this.setProperty('virtualSideLength',v.sideLength,true);this.invalidate();};return e;});\n",
	"sap/ui/vk/RedlineDesignHandler.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider','sap/ui/core/ResizeHandler'],function(q,E,R){'use strict';var a=E.extend('RedlineDesignHandler',{metadata:{publicMethods:['beginGesture','move','endGesture','click','doubleClick','contextMenu','getViewport']},constructor:function(r){this._redlineDesign=r;this._x=0;this._y=0;this._gesture=false;}});a.prototype.destroy=function(){this._redlineDesign=null;this._rect=null;this._gesture=false;};a.prototype._getOffset=function(d){var r=d.getBoundingClientRect();return{x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};};a.prototype._inside=function(e,r){var b=r.getDomRef(),i=false;if(b!==null){var c=this._getOffset(b);var d={x:c.x,y:c.y,width:b.getBoundingClientRect().width,height:b.getBoundingClientRect().height};i=(e.x>=d.x&&e.x<=d.x+d.width&&e.y>=d.y&&e.y<=d.y+d.height);}return i;};a.prototype._onresize=function(e){this._gesture=false;};a.prototype.beginGesture=function(e){var v=this.getViewport();if(this._inside(e,v)&&v._activeElementInstance){this._gesture=true;this._x=e.x;this._y=e.y;v._setIsDrawingOn(true);var d=v.getDomRef();var t=v._toVirtualSpace(e.x-d.getBoundingClientRect().left-window.pageXOffset,e.y-d.getBoundingClientRect().top-window.pageYOffset);v._activeElementInstance.setOriginX(t.x);v._activeElementInstance.setOriginY(t.y);if(sap.ui.Device.browser.msie||sap.ui.Device.browser.edge){v.invalidate();}else{var r=sap.ui.getCore().createRenderManager();v._activeElementInstance.render(r);r.flush(v.getDomRef(),false,true);r.destroy();var x=v.$();x.html(x.html());}e.handled=true;}return this;};a.prototype.move=function(e){var v=this.getViewport();if(v._activeElementInstance&&v._getIsDrawingOn()){var b=v.getDomRef().getBoundingClientRect(),o=e.x-b.left-window.pageXOffset,c=e.y-b.top-window.pageYOffset;v._editElement(v._activeElementInstance,o,c);}e.handled=true;return this;};a.prototype.endGesture=function(e){var v=this.getViewport();this._gesture=false;if(v._activeElementInstance){v.addRedlineElement(v._activeElementInstance);v.fireElementCreated({element:v._activeElementInstance});v.stopAdding();}return this;};a.prototype.click=function(e){};a.prototype.doubleClick=function(e){};a.prototype.contextMenu=function(e){e.handled=true;};a.prototype.getViewport=function(){return this._redlineDesign;};return a;},true);\n",
	"sap/ui/vk/RedlineDesignRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./RedlineSurfaceRenderer','sap/ui/core/Renderer'],function(q,R,a){'use strict';var b=a.extend(R);b.render=function(r,c){R.render.call(this,r,c);};b.renderAfterRedlineElements=function(r,c){if(c._activeElementInstance&&c._getIsDrawingOn()){c._activeElementInstance.render(r);}};return b;},true);\n",
	"sap/ui/vk/RedlineElement.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/Element'],function(q,E){'use strict';var R=E.extend('sap.ui.vk.RedlineElement',{metadata:{library:'sap.ui.vk',properties:{elementId:{type:'string'},originX:{type:'float',defaultValue:0},originY:{type:'float',defaultValue:0},opacity:{type:'float',defaultValue:1},strokeWidth:{type:'float',defaultValue:2},strokeColor:{type:'sap.ui.core.CSSColor',defaultValue:'#e6600d'},strokeDashArray:{type:'float[]',defaultValue:[]},halo:{type:'boolean',defaultValue:false}}}});R.prototype.init=function(){var g=function(){var s=function(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);};return s()+s()+'-'+s()+'-'+s()+'-'+s()+'-'+s()+s()+s();};this.setElementId(g());};R.prototype.applyZoom=function(){};R.prototype.render=function(r){this.renderElement(r,this.getHalo());};R.prototype.renderElement=function(r,h){};R.prototype.exportJSON=function(){var j={originX:this.getOriginX(),originY:this.getOriginY(),opacity:this.getOpacity(),strokeColor:this.getStrokeColor(),strokeWidth:this.getStrokeWidth(),elementId:this.getElementId(),halo:this.getHalo()};if(this.getStrokeDashArray().length>0){j['strokeDashArray']=this.getStrokeDashArray();}return j;};R.prototype.importJSON=function(j){if(j.hasOwnProperty('originX')){this.setOriginX(j.originX);}if(j.hasOwnProperty('originY')){this.setOriginY(j.originY);}if(j.hasOwnProperty('opacity')){this.setOpacity(j.opacity);}if(j.hasOwnProperty('strokeColor')){this.setStrokeColor(j.strokeColor);}if(j.hasOwnProperty('strokeWidth')){this.setStrokeWidth(j.strokeWidth);}if(j.hasOwnProperty('strokeDashArray')){this.setStrokeDashArray(j.strokeDashArray);}if(j.hasOwnProperty('elementId')){this.setElementId(j.elementId);}if(j.hasOwnProperty('halo')){this.setHalo(j.halo);}return this;};R.prototype.exportSVG=function(){return null;};R.prototype.importSVG=function(s){if(s.getAttribute('x')){this.setOriginX(parseFloat(s.getAttribute('x')));}if(s.getAttribute('y')){this.setOriginY(parseFloat(s.getAttribute('y')));}if(s.getAttribute('opacity')){this.setOpacity(parseFloat(s.getAttribute('opacity')));}if(s.getAttribute('stroke')){this.setStrokeColor(s.getAttribute('stroke'));}if(s.getAttribute('stroke-width')){this.setStrokeWidth(parseFloat(s.getAttribute('stroke-width')));}if(s.getAttribute('stroke-dasharray')){this.setStrokeDashArray(s.getAttribute('stroke-dasharray').split(',').map(parseFloat));}if(s.getAttribute('data-sap-element-id')){this.setElementId(s.getAttribute('data-sap-element-id'));}this.setHalo(s.getAttribute('data-sap-halo')==='true');return this;};return R;});\n",
	"sap/ui/vk/RedlineElementEllipse.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./RedlineElement'],function(q,R){'use strict';var a=R.extend('sap.ui.vk.RedlineElementEllipse',{metadata:{library:'sap.ui.vk',properties:{radiusX:{type:'float',defaultValue:0.0001},radiusY:{type:'float',defaultValue:0.0001},fillColor:{type:'sap.ui.core.CSSColor',defaultValue:'rgba(0, 0, 0, 0)'}}}});a.prototype.edit=function(o,b){var p=this.getParent(),t=p._toVirtualSpace(o,b),r=t.x-this.getOriginX(),c=t.y-this.getOriginY();this.setRadiusX(r>0?r:-r);this.setRadiusY(c>0?c:-c);return this;};a.prototype.applyZoom=function(z){this.setProperty('radiusX',this.getRadiusX()*z,true);this.setProperty('radiusY',this.getRadiusY()*z,true);return this;};a.prototype.setRadiusX=function(r){this.setProperty('radiusX',r,true);var d=this.getDomRef();if(d){d.setAttribute('rx',this.getParent()._toPixelSpace(r));}};a.prototype.setRadiusY=function(r){this.setProperty('radiusY',r,true);var d=this.getDomRef();if(d){d.setAttribute('ry',this.getParent()._toPixelSpace(r));}};a.prototype.renderElement=function(r,h){var p=this.getParent();r.write('<ellipse');r.writeElementData(this);var o=p._toPixelSpace(this.getOriginX(),this.getOriginY());r.writeAttribute('cx',o.x);r.writeAttribute('cy',o.y);r.writeAttribute('rx',p._toPixelSpace(this.getRadiusX()));r.writeAttribute('ry',p._toPixelSpace(this.getRadiusY()));r.writeAttribute('fill',this.getFillColor());r.writeAttribute('stroke',this.getStrokeColor());r.writeAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){r.writeAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}r.writeAttribute('opacity',this.getOpacity());if(h){r.writeAttribute('filter','url(#halo)');}r.write('></ellipse>');};a.prototype.exportJSON=function(){return q.extend(true,R.prototype.exportJSON.call(this),{type:sap.ui.vk.Redline.ElementType.Ellipse,version:1,radiusX:this.getRadiusX(),radiusY:this.getRadiusY(),fillColor:this.getFillColor()});};a.prototype.importJSON=function(j){if(j.type===sap.ui.vk.Redline.ElementType.Ellipse){if(j.version===1){R.prototype.importJSON.call(this,j);if(j.hasOwnProperty('radiusX')){this.setRadiusX(j.radiusX);}if(j.hasOwnProperty('radiusY')){this.setRadiusY(j.radiusY);}if(j.hasOwnProperty('fillColor')){this.setFillColor(j.fillColor);}}else{q.sap.log.error('wrong version number');}}else{q.sap.log.error('Redlining JSON import: Wrong element type');}return this;};a.prototype.exportSVG=function(){var e=document.createElementNS(sap.ui.vk.Redline.svgNamespace,'ellipse');e.setAttribute('x',this.getOriginX());e.setAttribute('y',this.getOriginY());e.setAttribute('rx',this.getRadiusX());e.setAttribute('ry',this.getRadiusY());e.setAttribute('fill',this.getFillColor());e.setAttribute('stroke',this.getStrokeColor());e.setAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){e.setAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}if(this.getOpacity()<1){e.setAttribute('opacity',this.getOpacity());}e.setAttribute('data-sap-element-id',this.getElementId());e.setAttribute('data-sap-halo',this.getHalo());return e;};a.prototype.importSVG=function(s){if(s.tagName==='ellipse'){R.prototype.importSVG.call(this,s);if(s.getAttribute('rx')){this.setRadiusX(parseFloat(s.getAttribute('rx')));}if(s.getAttribute('ry')){this.setRadiusY(parseFloat(s.getAttribute('ry')));}if(s.getAttribute('fill')){this.setFillColor(s.getAttribute('fill'));}}else{q.sap.log('Redlining SVG import: Wrong element type');}return this;};return a;});\n",
	"sap/ui/vk/RedlineElementFreehand.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./RedlineElement'],function(q,R){'use strict';var a=R.extend('sap.ui.vk.RedlineElementFreehand',{metadata:{library:'sap.ui.vk',properties:{path:{type:'float[]',defaultValue:null}}}});a.prototype.setPath=function(p){this.setProperty('path',p,true);var d=this.getDomRef();if(d){d.setAttribute('d',this._getProcessedPath());}};a.prototype.edit=function(o,b){var p=this.getParent();var t=p._toVirtualSpace(o,b);var c=this.getPath()||[];c.push(t.x-this.getOriginX(),t.y-this.getOriginY());this.setPath(c);var d=this.getDomRef();if(d){d.setAttribute('d',this._getProcessedPath());}return this;};a.prototype.applyZoom=function(z){this.setProperty('path',this.getPath().map(function(v){return v*z;}),true);return this;};a.prototype._getProcessedPath=function(){var p=this.getParent(),o=p._toPixelSpace(this.getOriginX(),this.getOriginY());var d='';(this.getPath()||[]).forEach(function(e,i){e=p._toPixelSpace(e);if(i===0){d+='M '+(o.x+e);}else if(i===1){d+=' '+(o.y+e);}else{d+=' '+(i%2===0?'L '+(o.x+e):(o.y+e));}});return d;};a.prototype.renderElement=function(r,h){r.write('<path');r.writeElementData(this);r.writeAttribute('d',this._getProcessedPath());r.writeAttribute('stroke',this.getStrokeColor());r.writeAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){r.writeAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}r.writeAttribute('opacity',this.getOpacity());r.writeAttribute('fill','none');if(h){r.writeAttribute('filter','url(#halo)');}r.write('></path>');};a.prototype.exportJSON=function(){return q.extend(true,R.prototype.exportJSON.call(this),{type:sap.ui.vk.Redline.ElementType.Freehand,version:1,path:(this.getPath()||[]).slice()});};a.prototype.importJSON=function(j){if(j.type===sap.ui.vk.Redline.ElementType.Freehand){if(j.version===1){R.prototype.importJSON.call(this,j);if(j.hasOwnProperty('path')){this.setPath(j.path.slice());}}else{q.sap.log.error('wrong version number');}}else{q.sap.log.error('Redlining JSON import: Wrong element type');}return this;};a.prototype.exportSVG=function(){var e=document.createElementNS(sap.ui.vk.Redline.svgNamespace,'path');e.setAttribute('x',this.getOriginX());e.setAttribute('y',this.getOriginY());e.setAttribute('d',this.getPath());e.setAttribute('fill','none');e.setAttribute('stroke',this.getStrokeColor());e.setAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){e.setAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}if(this.getOpacity()<1){e.setAttribute('opacity',this.getOpacity());}e.setAttribute('data-sap-element-id',this.getElementId());e.setAttribute('data-sap-halo',this.getHalo());return e;};a.prototype.importSVG=function(s){if(s.tagName==='path'){R.prototype.importSVG.call(this,s);if(s.getAttribute('d')){this.setPath(s.getAttribute('d').split(',').map(parseFloat));}}else{q.sap.log.error('Redlining SVG import: Wrong element type');}return this;};return a;});\n",
	"sap/ui/vk/RedlineElementLine.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./RedlineElement'],function(q,R){'use strict';var a=R.extend('sap.ui.vk.RedlineElementLine',{metadata:{library:'sap.ui.vk',properties:{deltaX:{type:'float',defaultValue:0},deltaY:{type:'float',defaultValue:0}}}});a.prototype.edit=function(o,b){var p=this.getParent(),t=p._toVirtualSpace(o,b);this.setDeltaX(t.x-this.getOriginX());this.setDeltaY(t.y-this.getOriginY());return this;};a.prototype.applyZoom=function(z){this.setProperty('deltaX',this.getDeltaX()*z);this.setProperty('deltaY',this.getDeltaY()*z);return this;};a.prototype.getP2=function(v){return this.getParent()._toPixelSpace(this.getOriginX()+this.getDeltaX(),this.getOriginY()+this.getDeltaY());};a.prototype.setDeltaX=function(v){this.setProperty('deltaX',v);var d=this.getDomRef();if(d){d.setAttribute('x2',this.getP2().x);}};a.prototype.setDeltaY=function(v){this.setProperty('deltaY',v);var d=this.getDomRef();if(d){d.setAttribute('y2',this.getP2().y);}};a.prototype.renderElement=function(r,h){var p=this.getParent()._toPixelSpace(this.getOriginX(),this.getOriginY());var b=this.getP2();r.write('<line');r.writeElementData(this);r.writeAttribute('x1',p.x);r.writeAttribute('y1',p.y);r.writeAttribute('x2',b.x);r.writeAttribute('y2',b.y);r.writeAttribute('stroke',this.getStrokeColor());r.writeAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){r.writeAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}r.writeAttribute('opacity',this.getOpacity());if(h){r.writeAttribute('filter','url(#halo)');}r.write('></line>');};a.prototype.exportJSON=function(){return q.extend(true,R.prototype.exportJSON.call(this),{type:sap.ui.vk.Redline.ElementType.Line,version:1,deltaX:this.getDeltaX(),deltaY:this.getDeltaY()});};a.prototype.importJSON=function(j){if(j.type===sap.ui.vk.Redline.ElementType.Line){if(j.version===1){R.prototype.importJSON.call(this,j);if(j.hasOwnProperty('deltaX')){this.setDeltaX(j.deltaX);}if(j.hasOwnProperty('deltaY')){this.setDeltaY(j.deltaY);}}else{q.sap.log.error('wrong version number');}}else{q.sap.log.error('Redlining JSON import: Wrong element type');}return this;};a.prototype.exportSVG=function(){var e=document.createElementNS(sap.ui.vk.Redline.svgNamespace,'line');e.setAttribute('x1',this.getOriginX());e.setAttribute('y1',this.getOriginY());e.setAttribute('x2',this.getOriginX()+this.getDeltaX());e.setAttribute('y2',this.getOriginY()+this.getDeltaY());e.setAttribute('stroke',this.getStrokeColor());e.setAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){e.setAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}if(this.getOpacity()<1){e.setAttribute('opacity',this.getOpacity());}e.setAttribute('data-sap-element-id',this.getElementId());e.setAttribute('data-sap-halo',this.getHalo());return e;};a.prototype.importSVG=function(s){if(s.tagName==='line'){R.prototype.importSVG.call(this,s);if(s.getAttribute('x1')){this.setOriginX(parseFloat(s.getAttribute('x1')));}if(s.getAttribute('y1')){this.setOriginY(parseFloat(s.getAttribute('y1')));}if(s.getAttribute('x2')){this.setDeltaX(parseFloat(s.getAttribute('x2'))-this.getOriginX());}if(s.getAttribute('y2')){this.setDeltaY(parseFloat(s.getAttribute('y2'))-this.getOriginY());}}else{q.sap.log('Redlining SVG import: Wrong element type');}return this;};return a;});\n",
	"sap/ui/vk/RedlineElementRectangle.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./RedlineElement'],function(q,R){'use strict';var a=R.extend('sap.ui.vk.RedlineElementRectangle',{metadata:{library:'sap.ui.vk',properties:{width:{type:'float',defaultValue:0.001},height:{type:'float',defaultValue:0.001},fillColor:{type:'sap.ui.core.CSSColor',defaultValue:'rgba(0, 0, 0, 0)'}}}});a.prototype.init=function(){R.prototype.init.apply(this);this._originX=0;this._originY=0;};a.prototype.setOriginX=function(o){this.setProperty('originX',o);this._originX=o;};a.prototype.setOriginY=function(o){this.setProperty('originY',o);this._originY=o;};a.prototype.edit=function(o,b){var p=this.getParent(),t=p._toVirtualSpace(o,b),w=t.x-this._originX,h=t.y-this._originY;this.setProperty('originX',w<0?t.x:this._originX);this.setProperty('originY',h<0?t.y:this._originY);this.setWidth(Math.abs(w));this.setHeight(Math.abs(h));return this;};a.prototype.applyZoom=function(z){this.setProperty('width',this.getWidth()*z,true);this.setProperty('height',this.getHeight()*z,true);return this;};a.prototype.setWidth=function(w){this.setProperty('width',w,true);var d=this.getDomRef();if(d){d.setAttribute('width',this.getParent()._toPixelSpace(w));}};a.prototype.setHeight=function(h){this.setProperty('height',h,true);var d=this.getDomRef();if(d){d.setAttribute('height',this.getParent()._toPixelSpace(h));}};a.prototype.renderElement=function(r,h){var p=this.getParent();r.write('<rect');r.writeElementData(this);var o=p._toPixelSpace(this.getOriginX(),this.getOriginY());r.writeAttribute('x',o.x);r.writeAttribute('y',o.y);r.writeAttribute('width',p._toPixelSpace(this.getWidth()));r.writeAttribute('height',p._toPixelSpace(this.getHeight()));r.writeAttribute('fill',this.getFillColor());r.writeAttribute('stroke',this.getStrokeColor());r.writeAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){r.writeAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}r.writeAttribute('opacity',this.getOpacity());if(h){r.writeAttribute('filter','url(#halo)');}r.write('></rect>');};a.prototype.exportJSON=function(){return q.extend(true,R.prototype.exportJSON.call(this),{type:sap.ui.vk.Redline.ElementType.Rectangle,version:1,width:this.getWidth(),height:this.getHeight(),fillColor:this.getFillColor()});};a.prototype.importJSON=function(j){if(j.type===sap.ui.vk.Redline.ElementType.Rectangle){if(j.version===1){R.prototype.importJSON.call(this,j);if(j.hasOwnProperty('width')){this.setWidth(j.width);}if(j.hasOwnProperty('height')){this.setHeight(j.height);}if(j.hasOwnProperty('fillColor')){this.setFillColor(j.fillColor);}}else{q.sap.log('wrong version number');}}else{q.sap.log('Redlining JSON import: Wrong element type');}return this;};a.prototype.exportSVG=function(){var e=document.createElementNS(sap.ui.vk.Redline.svgNamespace,'rect');e.setAttribute('x',this.getOriginX());e.setAttribute('y',this.getOriginY());e.setAttribute('height',this.getHeight());e.setAttribute('width',this.getWidth());e.setAttribute('fill',this.getFillColor());e.setAttribute('stroke',this.getStrokeColor());e.setAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){e.setAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}if(this.getOpacity()<1){e.setAttribute('opacity',this.getOpacity());}e.setAttribute('data-sap-element-id',this.getElementId());e.setAttribute('data-sap-halo',this.getHalo());return e;};a.prototype.importSVG=function(s){if(s.tagName==='rect'){R.prototype.importSVG.call(this,s);if(s.getAttribute('width')){this.setWidth(parseFloat(s.getAttribute('width')));}if(s.getAttribute('height')){this.setHeight(parseFloat(s.getAttribute('height')));}if(s.getAttribute('fill')){this.setFillColor(s.getAttribute('fill'));}}else{q.sap.log('Redlining SVG import: Wrong element type');}return this;};return a;});\n",
	"sap/ui/vk/RedlineElementText.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./RedlineElement'],function(q,R){'use strict';var a=R.extend('sap.ui.vk.RedlineElementText',{metadata:{library:'sap.ui.vk',properties:{text:{type:'string',defaultValue:'Text'},font:{type:'string',defaultValue:''},fontSize:{type:'float',defaultValue:32},fillColor:{type:'sap.ui.core.CSSColor',defaultValue:'rgba(0,0,0,0)'}}}});a.prototype.edit=function(p,b){var c=this.getParent(),d=c._toVirtualSpace(p,b);this.setOriginX(d.x);this.setOriginY(d.y);return this;};a.prototype.applyZoom=function(z){this.setFontSize(this.getFontSize()*z);return this;};a.prototype.renderElement=function(r,h){var p=this.getParent()._toPixelSpace(this.getOriginX(),this.getOriginY());r.write('<text');r.writeElementData(this);r.writeAttribute('x',p.x);r.writeAttribute('y',p.y);if(this.getFont()){r.writeAttribute('font-family',this.getFont());}r.writeAttribute('font-size',this.getFontSize());r.writeAttribute('fill',this.getFillColor());r.writeAttribute('stroke',this.getStrokeColor());r.writeAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){r.writeAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}r.writeAttribute('opacity',this.getOpacity());if(h){r.writeAttribute('filter','url(#halo)');}r.write('>');r.write(this.getText());r.write('</text>');};a.prototype.exportJSON=function(){return q.extend(true,R.prototype.exportJSON.call(this),{type:sap.ui.vk.Redline.ElementType.Text,version:1,text:this.getText(),font:this.getFont(),fontSize:this.getFontSize(),fillColor:this.getFillColor()});};a.prototype.importJSON=function(j){if(j.type===sap.ui.vk.Redline.ElementType.Text){if(j.version===1){R.prototype.importJSON.call(this,j);if(j.hasOwnProperty('text')){this.setText(j.text);}if(j.hasOwnProperty('font')){this.setFont(j.font);}if(j.hasOwnProperty('fontSize')){this.setFontSize(j.fontSize);}if(j.hasOwnProperty('fillColor')){this.setFillColor(j.fillColor);}}else{q.sap.log.error('wrong version number');}}else{q.sap.log.error('Redlining JSON import: Wrong element type');}return this;};a.prototype.exportSVG=function(){var e=document.createElementNS(sap.ui.vk.Redline.svgNamespace,'text');e.setAttribute('x',this.getOriginX());e.setAttribute('y',this.getOriginY());if(this.getFont()){e.setAttribute('font-family',this.getFont());}e.setAttribute('font-size',this.getFontSize());e.setAttribute('fill',this.getFillColor());e.setAttribute('stroke',this.getStrokeColor());e.setAttribute('stroke-width',this.getStrokeWidth());if(this.getStrokeDashArray().length>0){e.setAttribute('stroke-dasharray',this.getStrokeDashArray().toString());}if(this.getOpacity()<1){e.setAttribute('opacity',this.getOpacity());}e.setAttribute('data-sap-element-id',this.getElementId());e.setAttribute('data-sap-halo',this.getHalo());e.textContent=this.getText();return e;};a.prototype.importSVG=function(e){if(e.tagName==='text'){R.prototype.importSVG.call(this,e);if(e.getAttribute('x')){this.setOriginX(parseFloat(e.getAttribute('x')));}if(e.getAttribute('y')){this.setOriginY(parseFloat(e.getAttribute('y')));}if(e.getAttribute('text')){this.setText(e.getAttribute('text'));}if(e.getAttribute('font-family')){this.setFont(e.getAttribute('font-family'));}if(e.getAttribute('font-size')){this.setFontSize(parseFloat(e.getAttribute('font-size')));}if(e.getAttribute('fill')){this.setFillColor(e.getAttribute('fill'));}}else{q.sap.log('Redlining SVG import: Wrong element type');}return this;};return a;});\n",
	"sap/ui/vk/RedlineGesturesHandler.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider','sap/ui/core/ResizeHandler'],function(q,E,R){'use strict';var a=E.extend('RedlineGesturesHandler',{metadata:{publicMethods:['beginGesture','move','endGesture','click','doubleClick','contextMenu','getViewport']},constructor:function(r){this._redlineDesign=r;this._x=0;this._y=0;this._gesture=false;var v=this.getViewport();v._currentPosition={x:0,y:0};v._totalMoveX=0;v._totalMoveY=0;}});a.prototype.destroy=function(){this._redlineDesign=null;this._rect=null;this._gesture=false;};a.prototype._getOffset=function(d){var r=d.getBoundingClientRect();return{x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};};a.prototype._inside=function(e,r){var b=r.getDomRef(),i=false;if(b!==null){var c=this._getOffset(b);var d={x:c.x,y:c.y,width:b.getBoundingClientRect().width,height:b.getBoundingClientRect().height};i=(e.x>=d.x&&e.x<=d.x+d.width&&e.y>=d.y&&e.y<=d.y+d.height);}return i;};a.prototype._onresize=function(e){this._gesture=false;};a.prototype.beginGesture=function(e){var v=this.getViewport();if(this._inside(e,v)){this._gesture=true;this._x=e.x;this._y=e.y;var o=this._getOffset(v.getDomRef());this._gestureOriginX=e.x-o.x;this._gestureOriginY=e.y-o.y;this._distanceBetweenTouchPoints=null;if(e.n===1){this._lastMoveCoordinates={};this._totalDeltaMove={x:0,y:0};}e.handled=true;}return this;};a.prototype._pan=function(e){if(this._totalDeltaMove){var v=this.getViewport(),d=e.x-(this._lastMoveCoordinates.x||e.x),b=e.y-(this._lastMoveCoordinates.y||e.y);this._totalDeltaMove.x+=d;this._totalDeltaMove.y+=b;if(d||b){var p=v.getPanningRatio();v.firePan({deltaX:d*p,deltaY:b*p});v.getRedlineElements().forEach(function(c){c.setOriginX(c.getOriginX()+v._toVirtualSpace(d));c.setOriginY(c.getOriginY()+v._toVirtualSpace(b));});this._manualRender(v);}this._lastMoveCoordinates.x=e.x;this._lastMoveCoordinates.y=e.y;}else{this._totalDeltaMove={x:0,y:0};this._lastMoveCoordinates={};}};a.prototype._zoom=function(e){var v=this.getViewport(),z;if(e.scroll!==undefined){if(e.scroll>0){z=1.05;}else if(e.scroll<0){z=1/1.05;}else if(this._distanceBetweenTouchPoints!==null){var d=e.d-this._distanceBetweenTouchPoints;if(d>0){z=1.05;}else if(d<0){z=1/1.05;}else{return;}this._distanceBetweenTouchPoints=e.d;}else{this._distanceBetweenTouchPoints=e.d;return;}}else if(e.points[0].y<e.points[1].y){z=1.05;}else{z=1/1.05;}var t=v._getTargetViewport();if(t instanceof sap.ui.vk.NativeViewport){var b=t._getZoomInLimit();var c=t._getZoomOutLimit();var f=t._getZoomFactor();var n=f*z;if(n>b){z=b/f;}else if(n<c){z=c/f;}}var s=1-z,p=v._toVirtualSpace(this._gestureOriginX,this._gestureOriginY);v.getRedlineElements().forEach(function(g){g.applyZoom(z);var o=g.getOriginX(),h=g.getOriginY();o+=(p.x-o)*s;h+=(p.y-h)*s;g.setOriginX(o);g.setOriginY(h);});this._manualRender(v);v.fireZoom({originX:this._gestureOriginX,originY:this._gestureOriginY,zoomFactor:z});};a.prototype.move=function(e){if(this.getViewport().getDomRef()){if(e.n===2&&(e.buttons===4||e.buttons===3)||e.n===1){this._pan(e);}else if((e.n===2&&e.buttons===2)||(sap.ui.Device.system.tablet&&e.n===2&&e.buttons===0)){this._zoom(e);}}e.handled=true;return this;};a.prototype._manualRender=function(r){if(sap.ui.Device.browser.msie||sap.ui.Device.browser.edge){r.invalidate();}else{var b=sap.ui.getCore().createRenderManager();r.getRedlineElements().forEach(function(e){e.render(b);});b.flush(r.getDomRef(),false,false);b.destroy();var x=r.$();x.html(x.html());}};a.prototype.endGesture=function(e){this._gestureOriginX=0;this._gestureOriginY=0;this._lastMoveCoordinates={};this._totalDeltaMove={x:0,y:0};this._gesture=false;e.handled=true;return this;};a.prototype.click=function(e){};a.prototype.doubleClick=function(e){};a.prototype.contextMenu=function(e){e.handled=true;};a.prototype.getViewport=function(){return this._redlineDesign;};return a;},true);\n",
	"sap/ui/vk/RedlineSurface.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','./Loco','./RedlineGesturesHandler','./RedlineSurfaceRenderer'],function(q,l,C,L,R){'use strict';var a=C.extend('sap.ui.vk.RedlineSurface',{metadata:{library:'sap.ui.vk',aggregations:{redlineElements:{type:'sap.ui.vk.RedlineElement'}},properties:{virtualLeft:{type:'float'},virtualTop:{type:'float'},virtualSideLength:{type:'float'},panningRatio:{type:'float',defaultValue:1}},events:{pan:{parameters:{deltaX:'float',deltaY:'float'}},zoom:{parameters:{originX:'float',originY:'float',zoomFactor:'float'}}}}});a.prototype.init=function(){};a.prototype.onAfterRendering=function(){};a.prototype.exportJSON=function(){return this.getRedlineElements().map(function(e){return e.exportJSON();});};a.prototype.importJSON=function(j){if(!q.isArray(j)){j=[j];}j.forEach(function(b){var E;switch(b.type){case sap.ui.vk.Redline.ElementType.Rectangle:E=sap.ui.vk.RedlineElementRectangle;break;case sap.ui.vk.Redline.ElementType.Ellipse:E=sap.ui.vk.RedlineElementEllipse;break;case sap.ui.vk.Redline.ElementType.Freehand:E=sap.ui.vk.RedlineElementFreehand;break;case sap.ui.vk.Redline.ElementType.Line:E=sap.ui.vk.RedlineElementLine;break;case sap.ui.vk.Redline.ElementType.Text:E=sap.ui.vk.RedlineElementText;break;default:q.sap.log.warning('Unsupported JSON element type '+b.type);}this.addRedlineElement(new E().importJSON(b));}.bind(this));return this;};a.prototype._toVirtualSpace=function(x,y){if(arguments.length===1){return x/this.getVirtualSideLength();}else{return{x:(x-this.getVirtualLeft())/this.getVirtualSideLength(),y:(y-this.getVirtualTop())/this.getVirtualSideLength()};}};a.prototype._toPixelSpace=function(x,y){if(arguments.length===1){return x*this.getVirtualSideLength();}else{return{x:x*this.getVirtualSideLength()+this.getVirtualLeft(),y:y*this.getVirtualSideLength()+this.getVirtualTop()};}};a.prototype.setPanningRatio=function(p){this.setProperty('panningRatio',p,true);};a.prototype.updatePanningRatio=function(){var v=this.getVirtualLeft(),b=this.getVirtualTop(),r=this.getDomRef(),c=r.getBoundingClientRect(),h=c.height,w=c.width,p;if(v===0&&(h<w&&b<0||(h>w&&b>0))){p=h/w;}else{p=1;}this.setPanningRatio(p);return this;};a.prototype.exportSVG=function(){var s=document.createElementNS(sap.ui.vk.Redline.svgNamespace,'svg');this.getRedlineElements().map(function(e){s.appendChild(e.exportSVG());});return s;};a.prototype.importSVG=function(s){s.childNodes.forEach(function(t){if(t.getAttribute){var E;switch(t.tagName){case'rect':E=sap.ui.vk.RedlineElementRectangle;break;case'ellipse':E=sap.ui.vk.RedlineElementEllipse;break;case'path':E=sap.ui.vk.RedlineElementFreehand;break;case'line':E=sap.ui.vk.RedlineElementLine;break;case'text':E=sap.ui.vk.RedlineElementText;break;default:q.sap.log.warning('Unsupported SVG element type '+E);}if(E){this.addRedlineElement(new E().importSVG(t));}}}.bind(this));return this;};return a;});\n",
	"sap/ui/vk/RedlineSurfaceRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var R={};R.render=function(r,c){r.write('<svg');r.writeControlData(c);r.addClass('sapUiVizkitRedlineSurface');r.writeClasses();r.write('>');r.write(\"\t\t\t<defs>\t\t\t\t<filter id='halo' filterUnits='userSpaceOnUse' >\t\t\t\t\t<feGaussianBlur in='SourceAlpha' stdDeviation='4' result='blur' />\t\t\t\t\t<feMerge>\t\t\t\t\t\t<feMergeNode in='blur' />\t\t\t\t\t\t<feMergeNode in='SourceGraphic' />\t\t\t\t\t</feMerge>\t\t\t\t</filter>\t\t\t</defs>\t\t\");c.getRedlineElements().forEach(function(a){a.render(r);});this.renderAfterRedlineElements(r,c);r.write('</svg>');};R.renderAfterRedlineElements=function(r,c){};return R;},true);\n",
	"sap/ui/vk/Scene.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,B){'use strict';var S=B.extend('sap.ui.vk.Scene',{metadata:{'abstract':true,properties:{doubleSided:{type:'boolean',defaultValue:false}}}});return S;});\n",
	"sap/ui/vk/SceneTree.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','sap/ui/table/TreeTable','sap/ui/table/Column','sap/ui/model/json/JSONModel','sap/ui/core/ResizeHandler','sap/m/Title','sap/m/SearchField','sap/m/Toolbar','sap/m/ToolbarLayoutData','sap/m/ToolbarSpacer','sap/m/Text','sap/ui/core/Icon','./ContentConnector','./ViewStateManager','./SceneTreeRenderer'],function(q,a,C,T,b,J,R,c,S,d,e,f,g,I,h,V,j){'use strict';var k=C.extend('sap.ui.vk.SceneTree',{metadata:{library:'sap.ui.vk',properties:{title:{type:'string',defaultValue:sap.ui.vk.getResourceBundle().getText('SCENETREE_TITLE')},showTitle:{type:'boolean',defaultValue:true},showSearchField:{type:'boolean',defaultValue:true}},aggregations:{treeTable:{type:'sap.ui.table.TreeTable',multiple:false}},associations:{contentConnector:{type:'sap.ui.vk.ContentConnector',multiple:false},viewStateManager:{type:'sap.ui.vk.ViewStateManager',multiple:false}},events:{contentChanged:{enableEventBubbling:true}}}});var m='sap-icon://show',n='sap-icon://hide';var t=sap.ui.vk.getResourceBundle().getText('SCENETREE_VISIBILITYSTATEVISIBLE'),o=sap.ui.vk.getResourceBundle().getText('SCENETREE_VISIBILITYSTATEHIDDEN');k.prototype._createNodeForSceneTree=function(i,l,v){var p=v.getVisibilityState(l);return{name:i,id:l,visible:p};};k.prototype.setScene=function(s,v){this.setViewStateManager(v);this._setScene(s);};k.prototype._setScene=function(s){this._scene=s;this.refresh();};k.prototype.init=function(){if(C.prototype.init){C.prototype.init.apply(this);}var i=this;this._title=new c({width:'100%',textAlign:sap.ui.core.TextAlign.Center,text:this.getTitle()});this._searchField=new S({layoutData:new e({shrinkable:true,maxWidth:'400px'}),search:function(l){var p=l.getParameter('query'),r=i._scene.getDefaultNodeHierarchy(),s=i._viewStateManager;if(r&&s){var u=!p?[]:r.findNodesByName({value:p,predicate:'contains'});var w=new Set(u);var x=[];s.enumerateSelection(function(y){if(!w.has(y)){x.push(y);}});s.setSelectionState(x,false,false);s.setSelectionState(u,true,false);}}});this._toolbar=new d({content:[this._title,new f(),this._searchField]});var v=new I({src:m,tooltip:t,width:'2em',height:'1.3em',size:'1.2em',press:function(l){var p=this.getSrc()!==m;this.setSrc(p?m:n);this.setTooltip(p?t:o);i._toggleVisibilityForAllChildren(i._model.getData(),p);}});this._tree=new T({title:this._toolbar,columnHeaderHeight:32,columns:[new b({label:sap.ui.vk.getResourceBundle().getText('SCENETREE_NAME'),tooltip:sap.ui.vk.getResourceBundle().getText('SCENETREE_NAME'),template:new g({text:'{name}',maxLines:1,tooltip:'{name}'}),resizable:false}),new b(this.getId()+'-visibilityColumn',{label:v,template:new I({src:{path:'',formatter:function(l){if(!l){return null;}return l.visible?m:n;}},tooltip:{path:'',formatter:function(l){if(!l){return null;}return l.visible?t:o;}},height:'1.3em',size:'1.2em',press:function(l){var p=i._tree.getContextByIndex(this.getParent().getIndex());var r=p?p.getObject():null;if(r){i._viewStateManager.setVisibilityState(r.id,!r.visible,true);}}}),width:'2.5em',resizable:false,hAlign:'Center'})],enableSelectAll:false,selectionMode:'MultiToggle',selectionBehavior:'RowSelector',visibleRowCountMode:'Fixed',expandFirstLevel:false,collapseRecursive:false,rowHeight:32});this.setAggregation('treeTable',this._tree);this.attachContentChanged(function(l){v.setSrc(m);v.setTooltip(t);});this._scene=null;this._syncing=false;this._updateSelectionTimer=0;this._updateVisibilityTimer=0;this._model=new J();this._tree.setModel(this._model);this._tree.bindRows({path:'/'});this._tree.attachRowSelectionChange(this._handleRowSelectionChange.bind(this));this._tree.attachFirstVisibleRowChanged(this._updateSelection.bind(this));this._tree.getBinding('rows').attachChange(this._dataChange.bind(this));};k.prototype.setTitle=function(v){this.setProperty('title',v,true);this._title.setText(v);return this;};k.prototype.setShowTitle=function(v){this.setProperty('showTitle',v,true);this._title.setVisible(v);this._updateTitleBar();return this;};k.prototype.setShowSearchField=function(v){this.setProperty('showSearchField',v,true);this._searchField.setVisible(v);this._updateTitleBar();return this;};k.prototype._updateTitleBar=function(){this._tree.setTitle(this.getShowTitle()||this.getShowSearchField()?this._toolbar:null);this._handleResize();};k.prototype.onBeforeRendering=function(){this._tree.setVisible(true);if(!this._resizeListenerId){this._resizeListenerId=R.register(this,this._handleResize.bind(this));}};k.prototype._handleRowSelectionChange=function(l){if(this._syncing||this._tree.getBinding('rows')._aSelectedContexts!=undefined){return;}var s=[];var p=[];var r=l.getParameter('rowIndices');for(var i in r){var u=r[i];var v=this._tree.getContextByIndex(u);var w=v?v.getObject().id:null;if(w){(this._tree.isIndexSelected(u)?s:p).push(w);}}if(s.length>0){this._viewStateManager.setSelectionState(s,true);}if(p.length>0){this._viewStateManager.setSelectionState(p,false);}};k.prototype._handleSelectionChanged=function(p){if(this._syncing){return;}function r(u,v){var w=u.getBinding('rows');if(w){for(var i=u.getFirstVisibleRow(),l=Math.min(i+u.getVisibleRowCount(),w.getLength());i<l;i++){var x=w.getContextByIndex(i);if(x&&x.getObject().id===v){return true;}}}return false;}var s=p.getParameter('selected');if(s.length===1&&!r(this._tree,s[0])){if(this._updateSelectionTimer>0){clearTimeout(this._updateSelectionTimer);this._updateSelectionTimer=0;}this._expandToNode(s[0],this._updateSelection.bind(this));}else if(this._updateSelectionTimer===0){this._updateSelectionTimer=setTimeout(this._updateSelection.bind(this),0);}};k.prototype._updateSelection=function(){this._updateSelectionTimer=0;if(this._syncing){return;}this._syncing=true;var v=this._viewStateManager,p=this._tree,r=p.getBinding('rows');if(v&&r){for(var i=p.getFirstVisibleRow(),l=Math.min(i+p.getVisibleRowCount(),r.getLength());i<l;i++){var s=r.getContextByIndex(i);if(s){var u=s.getObject().id;if(u){var w=v.getSelectionState(u);if(w!=p.isIndexSelected(i)){p[w?'addSelectionInterval':'removeSelectionInterval'](i,i);}}}}}this._syncing=false;};k.prototype._expandToNode=function(i,l){var p={tree:this._tree,rows:this._tree.getBinding('rows'),index:0,nodeRef:i,ancestors:new Set(this._scene.getDefaultNodeHierarchy().getAncestors(i)),callback:l};function s(u,v,w){var x=u.getFirstVisibleRow(),y=u.getVisibleRowCount();if((v<x)||(v>=(x+y))){x=Math.min(Math.max(v-(y>>1),0),w-y);setTimeout(function(){u.setFirstVisibleRow(x);},0);}}function r(p,u){if(u&&u.getParameter('reason')!=='expand'){return;}var v=p.rows.getLength();while(p.index<v){var w=p.rows.getContextByIndex(p.index);if(!w){break;}var i=w.getObject().id;if(i===p.nodeRef){s(p.tree,p.index,v);break;}if(p.ancestors.has(i)&&!p.tree.isExpanded(p.index)){p.tree.expand(p.index++);return;}p.index++;}p.rows.detachChange(p.expandHandlerProxy);p.callback();}p.expandHandlerProxy=r.bind(this,p);p.rows.attachChange(p.expandHandlerProxy);r(p);};k.prototype._dataChange=function(i){var r=i.getParameter('reason');if((r==='expand'||r==='collapse')&&this._updateSelectionTimer===0){this._updateSelectionTimer=setTimeout(this._updateSelection.bind(this),0);}};k.prototype._toggleVisibilityForAllChildren=function(l,p){var r=l.hasOwnProperty('children')?l.children:l;for(var i=0;r[i]!=null;i++){this._viewStateManager.setVisibilityState(r[i].id,p,true);}};k.prototype._handleVisibilityChanged=function(i){if(this._updateVisibilityTimer===0){this._updateVisibilityTimer=setTimeout(this._updateVisibility.bind(this),0);}};k.prototype._updateVisibility=function(){this._updateVisibilityTimer=0;this._getNodeVisibilityRecursive(this._model.getData());this._tree.getModel().refresh(true);};k.prototype._getNodeVisibilityRecursive=function(l){if(l.id!=null){l.visible=this._viewStateManager.getVisibilityState(l.id);}var p=l.hasOwnProperty('children')?l.children:l;for(var i=0;p[i]!=null;i++){this._getNodeVisibilityRecursive(p[i]);}};k.prototype._handleResize=function(i){var l=i?i.size.height:this.getDomRef().clientHeight;var p=this._tree.getTitle()?2.1:1.1;this._tree.setVisibleRowCount(Math.max(Math.floor(l/(this._tree.getRowHeight()+1)-p),0));this._updateSelection();};k.prototype.refresh=function(){if(!this._scene||!this._viewStateManager||!this._viewStateManager.getNodeHierarchy()){this._model.setData([]);return;}var i=this._scene.getDefaultNodeHierarchy();var l=[];var p=function(l,r){r.forEach(function(s,u){var v=i.createNodeProxy(s);var w=this._createNodeForSceneTree(v.getName(),v.getNodeRef(),this._viewStateManager);l[u]=w;i.destroyNodeProxy(v);w.children=[];p(w.children,i.getChildren(s));}.bind(this));}.bind(this);p(l,i.getChildren());this._model.setData(l);this._tree.setModel(this._model);this._tree.bindRows({path:'/',parameters:{arrayNames:['children']}});this._tree.getBinding('rows').attachChange(this._dataChange.bind(this));this.fireContentChanged();};k.prototype._onBeforeClearContentConnector=k.prototype._onBeforeClearViewStateManager=function(){this._setScene(null);};k.prototype._onAfterUpdateContentConnector=k.prototype._onAfterUpdateViewStateManager=function(){if(this._contentConnector){this._setContent(this._contentConnector.getContent());}};k.prototype._setContent=function(i){this._setScene(i);};k.prototype._handleContentReplaced=function(i){this._setContent(i.getParameter('newContent'));};k.prototype._handleNodeHierarchyReplaced=function(i){this._setScene(this._scene);};k.prototype._handleContentChangesFinished=function(i){this.refresh();};h.injectMethodsIntoClass(k);V.injectMethodsIntoClass(k);return k;},true);\n",
	"sap/ui/vk/SceneTreeRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var S={};S.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapUiSizeCompact');r.addClass('sapUiVkSceneTree');r.writeClasses();r.write('>');r.renderControl(c.getAggregation('treeTable'));r.write('</div>');};return S;},true);\n",
	"sap/ui/vk/Smart2DHandler.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider','sap/ui/core/ResizeHandler'],function(q,E,R){'use strict';var S=E.extend('Smart2DHandler',{metadata:{publicMethods:['beginGesture','move','endGesture','click','doubleClick','contextMenu','getViewport']},constructor:function(v,a){this._viewport=v;this._rect=null;this._x=0;this._y=0;this._gesture=false;this._hitEndTimer=0;this._lastRender=0;this._viewport.attachEvent('resize',this,this._onresize);this._viewStateManager=a;this._previousColoring={nodeRef:null,nodeId:null,color:null};}});S.prototype.destroy=function(){this._viewport=null;this._rect=null;this._gesture=false;this._viewport.detachEvent('resize',this,this._onresize);this._viewStateManager=null;this._previousColoring=null;};S.prototype._getOffset=function(d){var r=d.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};S.prototype._inside=function(e){var v=this._viewport.getDomRef();if(v==null){return false;}var a=this._getOffset(v);this._rect={x:a.x,y:a.y,w:v.offsetWidth,h:v.offsetHeight};return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};S.prototype._onresize=function(e){this._gesture=false;this._rect=null;};S.prototype.beginGesture=function(e){if(this._inside(e)){this._gesture=true;this._x=e.x;this._y=e.y;}};S.prototype.callbackHover=function(){var n=this._viewStateManager.getNodeHierarchy();this._lastRender=Date.now();this._hitEndTimer=0;var h=this._viewport.hitTest(this._x,this._y);if(this._highlightedNodeRef!==h){if(this._highlightedNodeRef!==sap.ve.dvl.DVLID_INVALID){var t=this._highlightedNodeRef===this._previousColoring.nodeRef?this._previousColoring.color:0;this._viewport.showHotspots(this._highlightedNodeRef,true,t);}if(n.getHotspotNodeIds().indexOf(h)!==-1){var a=n.createNodeProxy(h);this._previousColoring={nodeRef:h,nodeId:h,color:a.getTintColorABGR()};n.destroyNodeProxy(a);this._viewport.showHotspots(h,true);}this._highlightedNodeRef=h;}this._viewport.renderFrame();};S.prototype.hover=function(e){if(e.n==1&&this._inside(e)){this._x=e.x-this._rect.x;this._y=e.y-this._rect.y;if(!this.getViewport().getShowAllHotspots()){var t=Date.now();if(t-this._lastRender>20){this.callbackHover();}if(this._hitEndTimer!=0){clearTimeout(this._hitEndTimer);}this._hitEndTimer=setTimeout(this.callbackHover.bind(this),20);}e.handled=true;}};S.prototype.move=function(e){if(this._gesture&&e.n==1){this._viewport.pan(e.x-this._x,e.y-this._y);this._x=e.x;this._y=e.y;e.handled=true;}};S.prototype.endGesture=function(e){this._gesture=false;};S.prototype.click=function(e){};S.prototype.doubleClick=function(e){};S.prototype.contextMenu=function(e){};S.prototype.getViewport=function(){return this._viewport;};return S;},true);\n",
	"sap/ui/vk/StepNavigation.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/Control','./Messages','./DvlException','./ContentConnector','./StepNavigationRenderer'],function(q,C,M,D,a,S){'use strict';var b=C.extend('sap.ui.vk.StepNavigation',{metadata:{library:'sap.ui.vk',properties:{settings:'object',width:{type:'sap.ui.core.CSSSize',defaultValue:'100%'},height:{type:'sap.ui.core.CSSSize',defaultValue:'100%'},showThumbnails:{type:'boolean',group:'Appearance',defaultValue:true},showToolbar:{type:'boolean',group:'Appearance',defaultValue:true},showStepInfo:{type:'boolean',group:'Appearance',defaultValue:false}},publicMethods:['setScene','playStep','pauseStep','playAllSteps','getStep','getNextStep','getPreviousStep','getProceduresAndSteps','refresh','clear'],associations:{contentConnector:{type:'sap.ui.vk.ContentConnector'}},aggregations:{procedureItemTemplate:{type:'sap.ui.core.Item',multiple:false},stepInfoPopup:{type:'sap.ui.core.Control',multiple:false},layout:{type:'sap.m.Toolbar',multiple:false},thumbnailsContainer:{type:'sap.m.ScrollContainer',multiple:false}},events:{'resize':{parameters:{oldSize:'object',size:'object'}},'stepChanged':{parameters:{clientId:'object',type:'object',stepId:'object'}}}}});b.prototype._onStepEvent=function(p){var s=this.getSettings();this.instanceSettings.currentStepId=p.stepId;switch(p.type){case sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_FINISHED:s.currentStepFinished=true;s.currentStepPaused=false;s.playAllActive=false;s.isPlaying=false;this._togglePlayPause(true);break;case sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_SWITCHED:case sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_STARTED:s.currentStepId=p.stepId;s.currentStepFinished=false;this._highlightStep(p.stepId);if(s.currentStepPaused){this.pauseStep();}break;default:q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT12.summary),M.VIT12.code,'sap.ui.vk.StepNavigation');}this.fireStepChanged({clientId:p.clientId,type:p.type,stepId:p.stepId});};b.prototype.setScene=function(s){if(this._scene){this.oDvl.Client.detachStepEvent(this._onStepEvent,this);this.oDvl=null;}if(s){var c=s.getMetadata().getName();if(c!=='sap.ui.vk.dvl.Scene'){return;}}this._scene=s;this.instanceSettings={};if(this._scene){this.oDvl=s.getGraphicsCore().getApi(sap.ui.vk.dvl.GraphicsCoreApi.LegacyDvl);this.oDvl.Client.attachStepEvent(this._onStepEvent,this);}delete this._procedures;var p=this.getProcedureList();var o=this.getSettings();o.reset();p.unbindItems();p.setSelectedItem(p.getFirstItem());if(o.stepInfo.stepMessagePopup){if(!o.stepInfo.stepMessagePopup.isOpen()){o.stepInfo.stepMessagePopup.close();}o.stepInfo.stepMessagePopup.destroy();o.stepInfo.stepMessagePopup=null;this.getShowStepInfoButton().setText(sap.ui.vk.getResourceBundle().getText('STEP_NAV_STEPDESCRIPTIONHEADING'));}var e=this._getStepThumbnails();this.oModel.setData(e);this._togglePlayPause(true);this._refreshControl();this.refresh();};b.prototype.init=function(){this._emptyThumbnail='iVBORw0KGgoAAAANSUhEUgAAAE4AAAA8CAYAAADIQIzXAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTA2LTA1VDEzOjU1OjAzKzEyOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0wNi0wNVQxNDowMDo1MCsxMjowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOC0wNi0wNVQxNDowMDo1MCsxMjowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNGZiYjQ5MS1mNzFkLTRmMTgtODA2Zi1iYjcxZjhhZTdhNjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjRmYmI0OTEtZjcxZC00ZjE4LTgwNmYtYmI3MWY4YWU3YTYwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MjRmYmI0OTEtZjcxZC00ZjE4LTgwNmYtYmI3MWY4YWU3YTYwIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoyNGZiYjQ5MS1mNzFkLTRmMTgtODA2Zi1iYjcxZjhhZTdhNjAiIHN0RXZ0OndoZW49IjIwMTgtMDYtMDVUMTM6NTU6MDMrMTI6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6QcBQiAAAGO0lEQVR4nO2ca1MbRxaGn+6emR7dzMUEOxRbla04H+LE+f+/YlO1oWIiA8IGhGQZJCSkkeZ28mEsOxtYRxoGIVx6vwip5tI8OrfuPho1DuIzoMZK82igxkEsDz2KxygNDB56EI9QA/3QI3isWoHLqRW4nHLmOdgYg1IgX0E6USp7TZKUNJVP72fVXOCiKEJEUPPeZUklIhhj0Hp+Y5gJnFIKx9EcHBxzeXmJtTbPOJdKIkIcx7x48QObm0+YTJK5zp/b4iaTyVw3WFZNwaVpmuv8uWOc4zg4zlynLaXko2/mDTuFEJBHki2KjM13AqeUIkkSoiieOystUiKgtcJ13cKueSdwYRiyvr7O8+fPiOMUWE7LM8YQBAHNZhMoxvLuBC5JYqz12dhcyz5YTm6gYDQscXZ2lr19aHBTV5UUoihd2ljneYYwDAu95mrKlVMrcDn1qAqyLDtqXFehFCQJxPF8FX9RWig4EXAcgzFZTJx3cu2XDEkMvd6AJEkol8uUKx5xJMRxutCSaGHgRMB1DXGcMByOqVQqwOwJxfMMve6Ak5MTrq+vSdMUz/PY2dnh22+f4zh6ofAWEuNEwPUMIsL+/mt+/fU/XF1d4Vk906qEtYbBYMje3h69Xg/HcbDWEscx9Xqdw6MG2ii0XpzJ3Ts4ETBGYwy8e3dCt9vFdV0ajSPCMMH3zUzwWq0WaZpSLpc/1WGu61KplGm3WvS6fTxvcbnu3u+ktcL1FCfvzmk2m1QqFXzfZzwOqP9RJ0kEx/n/w8iq/pjB4BrP8264ttYGgPE4gAXGuHsH51lN67zD4eEBruugtUZE8P0SnU6Hs7NzHFfNYHVfPmDRtfe9gRMB6xtGw5Dj4wbWWhzH+R+LKZVKtFrnBMMQv3S7y6Zpil9yqFSqhGF4Y7qUpsmnay1yyncv4ESy0mE0GrO3t0eayq1u5rouURSx/8c+cZTieTfhiQgI7O7u4jgOo9GIKaE4jhmNRuzu7rKx8YQwzLcomUeFgxMRrG9IYuH17/tMJmOstbeWHZnL+vT7VzQax2jDrZkxDBOqVZ+XL3+kVqsxmYSMx2OUUnz//Qu+++5fJImQposzuULruKxWc1AK3rw5ZDgcUqlUvliriQjlcoV2u8Xm5lOebq0xDpIb9dhkkrC+8YSfq6/o9XrEcUy1WqVa84lCIUkecQFsjMI4cFA/pt1u/SO0qbTWGGM4OjqkWv0Fax0mk5vwxkGCMZqtrXVQkCYwGWcxbtELqYW6qutpTk/anDVPKZfLM58nInieJQgCDg+PUCqr/f4upbJkMR4nRKGgTZaArG8+Zusi/5svqzBwntVcXlzx9m0D31q0nu/SmcuW6XTec3raxvXUjSwpkq0B+iWD1ormWZs39SPety/QOvvccWYrqO+qQlxVabgeBNTr9WwP1nVzLWoqpbDWcnr6ls3NDcoVj3GQuaIxOoMJdN5f0GyeMxj0SdOUdrvN2toaW99ssbmxiV9yQCCKJPf23z+psBg3HI6I4xjf93OvBIsIrusSBAEHB2/46eeXWGtQGpIYPnS6dD50uPhwkVmeX0IphYjQ7/fpdrtUq1W2t7+hVntCpVLF2vuxwMLAGWMwxty5RUJEKJVK9Ho9Dg8avPjh33x43+X8vEm/n7Xy2Y+hQEQ+fUnT7oIwDGk0jnEch1KpxM7ODtvbTwtv21jKhczP8Lr89t8R19dDIKv5/nrMbZpumIsIl5eXKKXYfva08DEuJTjISpQ0TRmNRnieO7fFTOOl53n3Mr6lBTd1+SI3kYvUarMmp1bgcmoFLqdW4HJqBS6nCsuqItn0Jk3TpekRno7nPlQYuCms7HU5wEGxzYR/VQHgsoHVajVevfplaawNPneVQ/Ff5Z3AZUVq9rfnGaw/+xrcwjSdmRW8WX0ncJ5nGQz6vP69vrS9cfC5j08pVZhH3AmcMYYoihiNRkvlon+XiHzsclqSHuDpgL6GH4zMq1Udl1MzW5xS2SJhEIyWOp7NKhEhiqKszssRZWYGlyTC9vYzarUaxiztatQcygp23/dJcvy6Xo2DuM8MDzMQEax1UF+Zc+fczB7M4aqKMHyYftv7Vp6C4Cuzn8VpBS6nVuByavXAlpxygCarRwTNq8GfDrbV1CI5dZUAAAAASUVORK5CYII=';if(C.prototype.init){C.prototype.init.call(this);}if(this.getSettings()==undefined){this.setSettings(new this._settings());}this._scene=null;this.oModel=new sap.ui.model.json.JSONModel();this._layout=new sap.m.Toolbar({design:sap.m.ToolbarDesign.Solid});this.setAggregation('layout',this._layout);if(this.getShowThumbnails()){this._thumbnailsScroller=new sap.m.ScrollContainer(this.getId()+'-scroller',{width:'100%',horizontal:true,vertical:false,focusable:true});this.setAggregation('thumbnailsContainer',this._thumbnailsScroller);}this.playPreviousButton=new sap.m.Button(this.getId()+'-playPreviousButton',{type:sap.m.ButtonType.Transparent,icon:'sap-icon://slim-arrow-left',tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PREVIOUSSTEPBUTTON'),press:function(e){var s=this.getSettings();var p=this.getPreviousStep(s.currentProcedureIndex);if(p){s.currentStepPaused=false;this.playStep(p.id,true,s.playAllActive);this._togglePlayPause(false);}}.bind(this)});this.playNextButton=new sap.m.Button(this.getId()+'-playNextButton',{type:sap.m.ButtonType.Transparent,icon:'sap-icon://slim-arrow-right',tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_NEXTSTEPBUTTON'),press:function(e){var s=this.getSettings();var n=this.getNextStep(s.currentProcedureIndex);if(n){s.currentStepPaused=false;this.playStep(n.id,true,s.playAllActive);this._togglePlayPause(false);}}.bind(this)});this.playOptionButton=new sap.m.Button(this.getId()+'-playOptionButton',{type:sap.m.ButtonType.Transparent,icon:'sap-icon://media-play',tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYBUTTON_PLAY'),visible:true,press:function(e){var k=this.getPlayMenuButton().getSelectedKey();var s=this.getSettings();var f=null;switch(k){case'0':if(!s.currentStepId){f=this.getNextStep(s.currentProcedureIndex);if(f){s.currentStepId=f.id;}else{return;}}s.playAllActive=false;this.playStep(s.currentStepId,!s.currentStepPaused,s.playAllActive);s.isPlaying=true;s.currentStepPaused=false;this._togglePlayPause(false);break;case'1':s.playAllActive=true;s.currentStepPaused=false;this.playAllSteps(s.currentProcedureId);s.isPlaying=true;this._togglePlayPause(false);break;case'2':if(!s.currentStepId){f=this.getNextStep(s.currentProcedureIndex);if(f){s.currentStepId=f.id;}else{return;}}s.playAllActive=true;var p=!s.currentStepPaused;s.currentStepPaused=false;this.playStep(s.currentStepId,p,s.playAllActive);s.isPlaying=true;this._togglePlayPause(false);break;default:break;}}.bind(this)});this.procedureList=new sap.m.Select(this.getId()+'-procedureList',{tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PROCEDURESLISTHEADING'),selectedKey:'0',type:sap.m.SelectType.Default,enabled:true,width:'30%',autoAdjustWidth:true,change:function(c){var p=this.getProcedureList();var s=this.getSettings();s.currentProcedureIndex=0;s.currentProcedureId=this.instanceSettings.currentProcedureId=p.getSelectedKey();s.currentStepId=this.instanceSettings.currentStepId=null;for(var i=0;i<this.oModel.oData.procedures.length;i++){if(this.oModel.oData.procedures[i].id==s.currentProcedureId){s.currentProcedureIndex=i;s.currentProcedure=this.oModel.oData.procedures[i];break;}}if(s.stepInfo.stepMessagePopup){if(!s.stepInfo.stepMessagePopup.isOpen()){s.stepInfo.stepMessagePopup.close();}s.stepInfo.stepMessagePopup.destroy();s.stepInfo.stepMessagePopup=null;}this._refreshItems();}.bind(this)});this.procedureList.addStyleClass('sapVizKitStepNavigationProcedureList');this.setAggregation('procedureItemTemplate',(new sap.ui.core.ListItem().bindProperty('text','name').bindProperty('key','id').bindProperty('tooltip','name')));this.playMenuButton=(new sap.m.Select(this.getId()+'-playMenuButtonIcon',{selectedKey:'0',type:sap.m.SelectType.Default,tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PLAYOPTIONS'),enabled:true,autoAdjustWidth:false,items:[new sap.ui.core.ListItem({key:'0',icon:'sap-icon://media-play',text:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PLAY'),tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PLAY')}),new sap.ui.core.ListItem({key:'1',icon:'sap-icon://media-play',text:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PLAYALL'),tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PLAYALL')}),new sap.ui.core.ListItem({key:'2',icon:'sap-icon://media-play',text:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PLAYALLREMAINING'),tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PLAYALLREMAINING')})]}));this.playMenuButton.addStyleClass('sapVizKitStepNavigationPlayOptionsSelect');this.pauseButton=new sap.m.Button(this.getId()+'-pauseButton',{type:sap.m.ButtonType.Transparent,icon:'sap-icon://media-pause',visible:false,tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PAUSE'),press:function(e){var s=this.getSettings();this.pauseStep();s.currentStepPaused=true;s.isPlaying=false;this._togglePlayPause(true);}.bind(this)});this.showStepInfoButton=new sap.m.ToggleButton(this.getId()+'-showStepInfoButton',{icon:'sap-icon://hide',type:sap.m.ButtonType.Transparent,pressed:false,text:sap.ui.vk.getResourceBundle().getText('STEP_NAV_STEPDESCRIPTIONHEADING'),tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_STEPDESCRIPTIONHEADING'),press:function(e){var t=e.getSource();if(t.getPressed()){this.setShowStepInfo(true);t.setIcon('sap-icon://show');t.setTooltip(sap.ui.vk.getResourceBundle().getText('STEP_NAV_HIDESTEPDESCRIPTIONBUTTON'));}else{this.setShowStepInfo(false);t.setIcon('sap-icon://hide');t.setTooltip(sap.ui.vk.getResourceBundle().getText('STEP_NAV_SHOWSTEPDESCRIPTIONBUTTON'));}}.bind(this)});this._layout.addContent(this.playPreviousButton).addContent(this.playOptionButton).addContent(this.pauseButton).addContent(this.playMenuButton).addContent(this.procedureList).addContent(this.showStepInfoButton).addContent(new sap.m.ToolbarSpacer()).addContent(this.playNextButton);};b.prototype.destroy=function(){return C.prototype.destroy.call(this);};b.prototype.getScroller=function(){return this._thumbnailsScroller;};b.prototype.getProcedureList=function(){var i=this.getId()+'-procedureList';var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};b.prototype.getPlayMenuButton=function(){var i=this.getId()+'-playMenuButtonIcon';var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};b.prototype.getPlayOptionButton=function(){var i=this.getId()+'-playOptionButton';var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};b.prototype.getPauseButton=function(){var i=this.getId()+'-pauseButton';var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};b.prototype.getPlayNextButton=function(){var i=this.getId()+'-playNextButton';var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};b.prototype.getPlayPreviousButton=function(){var i=this.getId()+'-playPreviousButton';var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};b.prototype.getShowStepInfoButton=function(){var i=this.getId()+'-showStepInfoButton';var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};b.prototype._settings=function(){return{enabled:false,toggle:{addCss:function(k,p,o,c){if(!this.targets[k]){this.targets[k]={'type':'css','property':p,'onValue':o,'offValue':c};}},addMethod:function(t,m,o,c,u){var k=t.getId();if(!this.targets[k]){this.targets[k]={'type':'method','target':t,'method':m,'onValue':o,'offValue':c,'useJQuery':u};}},targets:{}},currentProcedureIndex:0,currentProcedureId:'',currentProcedure:null,currentStepId:null,currentStep:null,currentStepPaused:false,isPlaying:false,currentStepFinished:true,playAllActive:false,showToolbar:true,showThumbnails:true,portfolioMode:false,reset:function(){this.currentStep=null;this.currentProcedure=null;this.currentProcedureIndex=0;this.currentProcedureId='';this.currentStepId=null;this.currentStepPaused=false;this.currentStepFinished=true;this.playAllActive=false;this.portfolioMode=false;},stepInfo:{lastTop:null,lastLeft:null,stepMessagePopup:null,openPopup:function(p,t,c,e){this._customHeaderText=this._customHeaderText||new sap.m.Text({width:'100%',textAlign:sap.ui.core.TextAlign.Center}).addStyleClass('sapVizKitStepNavigationPopoverTitle');this._customHeaderText.setText(p);this._customHeaderText.setTooltip(p);this._customHeader=this._customHeader||new sap.m.Bar({contentLeft:[this._customHeaderText]});this._textContent=this._textContent||new sap.m.Text({});this._textContent.addStyleClass('sapVizKitStepNavigationPopoverContent');this._textContent.setText(t);this.stepMessagePopup=this.stepMessagePopup||new sap.m.ResponsivePopover({placement:e,showCloseButton:true,verticalScrolling:true,contentHeight:'10%',contentWidth:'30%',content:[this._textContent],customHeader:this._customHeader});this.stepMessagePopup.addStyleClass('sapVizKitStepNavigationPopoverStepInfo');this.stepMessagePopup.openBy(c);}}};};b.prototype.refresh=function(s){q.sap.log.info('StepNavigation refresh() called.');if(this.getVisible()&&(this['_getStepThumbnails']&&this._scene!=null)){var p=this.getProcedureList();var o=this.getSettings();o.reset();p.setSelectedItem(p.getFirstItem());var c=this._getStepThumbnails();if(o.stepInfo.stepMessagePopup){if(!o.stepInfo.stepMessagePopup.isOpen()){o.stepInfo.stepMessagePopup.close();}o.stepInfo.stepMessagePopup.destroy();o.stepInfo.stepMessagePopup=null;}this.oModel.setData(c);this._togglePlayPause(true);this._refreshControl();}else if(this.getVisible()){this._refreshControl();}return true;};b.prototype.clear=function(){q.sap.log.info('StepNavigation clear() called.');return true;};b.prototype.onBeforeRendering=function(){if(this.getShowToolbar()){var p=this.getProcedureList();p.setModel(this.oModel);var P=this.getProcedureItemTemplate();p.bindItems('/procedures',P);}};b.prototype.onAfterRendering=function(){var s=this.getSettings();this._togglePlayPause(!s.isPlaying);if(s.currentStepId){this._highlightStep(s.currentStepId);}};var d={onAfterRendering:function(e){e.srcControl.focus();e.srcControl.removeEventDelegate(this);}};b.prototype._togglePlayPause=function(p){this.togglePlayPauseActive=true;if(this.getSettings().showToolbar){var c=this.getPlayOptionButton(),e=this.getPauseButton();if(p){if(sap.ui.getCore().getCurrentFocusedControlId()===e.getId()){c.addEventDelegate(d);}e.setVisible(false);c.setVisible(true);}else{if(sap.ui.getCore().getCurrentFocusedControlId()===c.getId()){e.addEventDelegate(d);}c.setVisible(false);e.setVisible(true);}}};b.prototype._refreshControl=function(){if(!this.oModel.oData.procedures){return;}var p=this.getProcedureList();var P=this.getProcedureItemTemplate();var s=this.getSettings();if(s.stepInfo.stepMessagePopup){if(!s.stepInfo.stepMessagePopup.isOpen()){s.stepInfo.stepMessagePopup.close();}s.stepInfo.stepMessagePopup.destroy();s.stepInfo.stepMessagePopup=null;this.getShowStepInfoButton().setText(sap.ui.vk.getResourceBundle().getText('STEP_NAV_STEPDESCRIPTIONHEADING'));}p.unbindItems();if(this.oModel.oData.procedures.length>0){var f=this.oModel.oData.procedures[0];if(this.getShowToolbar()){p.bindItems('/procedures',P);p.selectedKey=f.id;p.enabled=true;}this._refreshItems();}else{if(this.getShowToolbar()){p.bindItems('/procedures',P);p.enabled=false;}if(this.getShowThumbnails()){var o=this.getScroller();o.destroyContent();}}};b.prototype._refreshItems=function(){var t=this;var s=[];var p=this.getProcedureList();var o=t.getSettings();var c=new sap.m.HBox();if(!o.currentProcedure){o.currentProcedure=t.oModel.oData.procedures[o.currentProcedureIndex];p.setSelectedItem(p.getFirstItem());}if(o.currentProcedureId!=''||t.oModel.oData.procedures.length>0){if(t.getShowThumbnails()){var e=t.getScroller();e.removeAllContent();s=t.oModel.oData.procedures[o.currentProcedureIndex].steps;var f=function(h){o.currentStepPaused=false;var j=sap.ui.getCore().byId(h.getSource().getId());t.playStep(j.getCustomData()[0].getValue('stepId'));o.playAllActive=false;t._togglePlayPause(false);};for(var i=0;i<s.length;i++){var g=new sap.m.Image({alt:s[i].name,src:'data:image/'+s[i].thumbnailType+';base64,'+s[i].thumbnailData,densityAware:false,tooltip:s[i].name,press:f.bind(t),layoutData:new sap.m.FlexItemData({shrinkFactor:0})});g.data('stepId',s[i].id);g.addCustomData(new sap.ui.core.CustomData({key:'stepId',value:s[i].id}));g.addStyleClass('sapVizKitStepNavigationStepItem');c.addItem(g);}e.addContent(c);}}};b.prototype._getPopupPlacement=function(e){var p=null;var y=0;while(e){y+=e.offsetTop;e=e.offsetParent;}if(y>200){p=sap.m.PlacementType.Top;}else{p=sap.m.PlacementType.Bottom;}return p;};b.prototype._isScrollingNecessary=function(i,s){var c;if(i&&s){var e=q(i).offset().left+q(i).width();var t=q(s).width();if(e-q(i).width()<0){c=true;}else if((t-e)<q(i).width()){c=true;}else{c=false;}}else{c=false;}return c;};b.prototype._scrollToItem=function(i,s){var p={},o=q(i).offset(),c=q(s).scrollLeft();p.scrollLeft=o.left+(c-q(s).offset().left);p.scrollLeft-=parseInt(q(i).css('marginLeft'),10)||0;p.scrollLeft-=parseInt(q(i).css('borderLeftWidth'),10)||0;q(s).animate(p,50);};b.prototype._highlightStep=function(s){var t=this;if(t.getVisible()){var o=t.getSettings();var c=t.getStep(0,o.currentProcedureIndex,s);if(!o.currentProcedure){o.currentProcedure=t.oModel.oData.procedures[t.oSettings.currentProcedureIndex];}var e=t.getShowStepInfoButton();var p;var f=document.getElementById(e.getId());p=t._getPopupPlacement(f);if(t.getShowStepInfo()){o.stepInfo.openPopup.call(this,c.name,c.description,e,p);}else if(o.stepInfo.stepMessagePopup&&o.stepInfo.stepMessagePopup.isOpen()){o.stepInfo.stepMessagePopup.close();}if(t.getShowThumbnails()){var g=t.getScroller();var T=g.getContent()[0].getItems();for(var i=0;i<T.length;i++){if(T[i].getCustomData()[0].getValue('stepId')==s){T[i].addStyleClass('selected');if(t._isScrollingNecessary(T[i].$()[0],q('#'+g.sId)[0])){t._scrollToItem(T[i].$()[0],q('#'+g.sId)[0]);}}else{T[i].removeStyleClass('selected');}}}}};b.prototype.getProceduresAndSteps=function(){return this._getStepThumbnails();};b.prototype._getStepThumbnails=function(){var p=function(s,e,f){var t,i,g;try{var h=e.Scene.RetrieveThumbnail(s,f.id);if(h===sap.ve.dvl.DVLRESULT.NOTFOUND){t=this._emptyThumbnail;}else{t=sap.ui.vk.dvl.getPointer(h);}g=t.substring(0,3);if(g==='iVB'){i='png';}else{i='jpg';}f.thumbnailData=t;f.thumbnailType=i;}catch(j){if(j.code!==sap.ve.dvl.DVLRESULT.NOTFOUND){q.sap.log.error(j.message,j.code,'sap.ui.vk.StepNavigation');}f.thumbnailData=null;f.thumbnailType=null;}};var c=this._retrieveProcedures();if(c.sceneId!=null){c.procedures.forEach(function(e){e.steps.forEach(p.bind(this,c.sceneId,this.oDvl));},this);c.portfolios.forEach(function(e){e.steps.forEach(p.bind(this,c.sceneId,this.oDvl));},this);c.hasThumbnails=true;}this._procedures=c;return c;};b.prototype._retrieveProcedures=function(c){var t=this;var p={};if(!t._procedures){p={sceneId:null,hasThumbnails:false,'procedures':[],'portfolios':[]};}else{p=t._procedures;}if(t._scene&&(p.sceneId!=(c||t._scene._dvlSceneRef))){var s=c||t._scene._dvlSceneRef;if(s!=null){p={sceneId:null,hasThumbnails:false,'procedures':[],'portfolios':[]};try{var f=sap.ui.vk.dvl.getJSONObject(t.oDvl.Scene.RetrieveProcedures(s));if(f!=null){p.hasThumbnails=false;p.sceneId=t._scene._dvlSceneRef;p.procedures=f.procedures;p.portfolios=f.portfolios;}}catch(e){if(!(e instanceof D&&e.code===sap.ve.dvl.DVLRESULT.NOTIMPLEMENTED)){throw e;}}}}return p;};b.prototype.getStep=function(r,c,s){var t=this;var e=t.oDvl.Settings.LastLoadedSceneId;var f=null;if(e!=null){c=c!=null?c:0;var g=s?s:t.instanceSettings.currentStepId;var p=t._retrieveProcedures(e);var h=p.procedures[c];if(h&&h.steps.length>0){f=h.steps[0];}else{return null;}if(g!=''){for(var i=0;i<h.steps.length;i++){var _=h.steps[i];if(_.id==g){var x=i+r;if(x<h.steps.length&&x>=0){f=h.steps[x];}else{f=null;}break;}}}}return f;};b.prototype.pauseStep=function(){var t=this;var s=t.oDvl.Settings.LastLoadedSceneId;if(s!=null){t.oDvl.Scene.PauseCurrentStep(s);}};b.prototype._stepCount=function(c){var t=this;var s=t.oDvl.Settings.LastLoadedSceneId;var e=0;if(s!=null){var p=t._retrieveProcedures(s);for(var f=0;f<p.procedures.length;f++){if(p.procedures[f].id==c){e=p.procedures[f].steps.length;break;}else if(c==null){e+=p.procedures[f].steps.length;}}}return e;};b.prototype.getPreviousStep=function(p){var t=this;return t.getStep(-1,p);};b.prototype.getNextStep=function(p){var t=this;return t.getStep(1,p);};b.prototype.playStep=function(c,f,e){var t=this;var s=t.oDvl.Settings.LastLoadedSceneId;if(s!=null){t.instanceSettings.currentStepId=c;t.oDvl.Scene.ActivateStep(s,c,f!=null?f:true,e!=null?e:false);}};b.prototype.playAllSteps=function(p){var t=this;var c=t.oDvl.Settings.LastLoadedSceneId;if(c!=null){var e=t._retrieveProcedures(c);var f=0;if(p!=null&&e.procedures.length>1){for(var i=0;i<e.procedures.length;i++){if(e.procedures[i].id==p){f=i;break;}}}if(e.procedures.length>0){var s=e.procedures[f].steps[0];if(s){t.instanceSettings.currentStepId=s.id;t.oDvl.Scene.ActivateStep(c,s.id,true,true);}}}};b.prototype._setContent=function(c){var s=null;if(c&&c instanceof sap.ui.vk.dvl.Scene){s=c;}this.setScene(s);};b.prototype._onAfterUpdateContentConnector=function(){this._setContent(this._contentConnector.getContent());};b.prototype._onBeforeClearContentConnector=function(){this.setScene(null);};b.prototype._handleContentReplaced=function(e){var c=e.getParameter('newContent');this._setContent(c);};a.injectMethodsIntoClass(b);return b;});\n",
	"sap/ui/vk/StepNavigationRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var S={};S.render=function(r,c){if(!c.getVisible()){return;}if(c.getShowToolbar()||c.getShowThumbnails){var w=c.getWidth()!=='auto'?c.getWidth():'100%';var h=c.getHeight()!=='auto'?c.getHeight():'auto';r.write('<div');r.addStyle('width',w);r.addStyle('height',h);r.writeControlData(c);r.addClass('sapVizKitStepNavigation');r.writeClasses();var t=c.getTooltip_AsString();if(t){r.writeAttributeEscaped('title',t);}if(!c.getVisible()){r.addStyle('visibility','hidden');}r.writeStyles();r.write('>');r.renderControl(c.getAggregation('layout'));if(c.getShowThumbnails()){S._renderScrollerDiv(r,c);}r.write('</div>');}};S._renderScrollerDiv=function(r,c){r.renderControl(c.getAggregation('thumbnailsContainer'));};return S;},true);\n",
	"sap/ui/vk/Texture.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,M){'use strict';var T=M.extend('sap.ui.vk.Texture',{metadata:{properties:{'Id':{type:'string'},'filterMode':{type:'int',defaultValue:0},'uvRotationAngle':{type:'float',defaultValue:0.0},'uvHorizontalOffset':{type:'float',defaultValue:0.0},'uvVerticalOffset':{type:'float',defaultValue:0.0},'uvHorizontalScale':{type:'float',defaultValue:0.0},'uvVerticalScale':{type:'float',defaultValue:0.0},'uvHorizontalTilingEnabled':{type:'bloolean',defaultValue:true},'uvVerticalTilingEnabled':{type:'bloolean',defaultValue:true}}}});T.prototype.load=function(i){return this;};T.prototype.getTextRef=function(){return null;};return T;});\n",
	"sap/ui/vk/Toolbar.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','./ToolbarRenderer'],function(q,l,C,T){'use strict';var a=C.extend('sap.ui.vk.Toolbar',{metadata:{library:'sap.ui.vk',properties:{title:{type:'string',group:'Appearance',defaultValue:''}},events:{},associations:{viewer:{type:'sap.ui.vk.Viewer',cardinality:'0..1'}},aggregations:{_toolbar:{type:'sap.m.Toolbar',multiple:false,visibility:'hidden'},_helpButton:{type:'sap.m.Button',multiple:false,visibility:'hidden'},_stepNavigationButton:{type:'sap.m.ToggleButton',multiple:false,visibility:'hidden'},_sceneTreeButton:{type:'sap.m.ToggleButton',multiple:false,visibility:'hidden'},_enterFullScreenButton:{type:'sap.m.ToggleButton',multiple:false,visibility:'hidden'},_exitFullScreenButton:{type:'sap.m.Button',multiple:false,visibility:'hidden'},_toolbarTitle:{type:'sap.m.Title',multiple:false,visibility:'hidden'}}}});a.prototype._isUsingIOS=function(){return(sap.ui.Device.system.tablet||sap.ui.Device.system.phone)&&sap.ui.Device.os.ios;};a.prototype._onSceneTree=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());if(this.oViewer!=null){this.oViewer._componentsState.sceneTree.userInteractionShow=this._sceneTreeButton.getPressed();this.oViewer.setShowSceneTree(this.oViewer._componentsState.sceneTree.userInteractionShow);}};a.prototype._onStepNavigation=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());if(this.oViewer!=null){this.oViewer._componentsState.stepNavigation.userInteractionShow=this._stepNavigationButton.getPressed();this.oViewer.setShowStepNavigation(this.oViewer._componentsState.stepNavigation.userInteractionShow);}};a.prototype._onFullScreen=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());if(this.oViewer!=null){var n=this._enterFullScreenButton.getPressed();this.oViewer.activateFullScreenMode(n);}};a.prototype._fullScreenHandler=function(e){var f=e.mParameters.isFullScreen;this._enterFullScreenButton.setPressed(f);if(f){this._enterFullScreenButton.setIcon('sap-icon://exit-full-screen');}else{this._enterFullScreenButton.setIcon('sap-icon://full-screen');}};a.prototype.init=function(){if(C.prototype.init){C.prototype.init.apply(this);}var _=new sap.m.Button({icon:'sap-icon://sys-help',type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText('VIEWER_HELPBUTTONTOOLTIP')});this.setAggregation('_helpButton',_);this._stepNavigationButton=new sap.m.ToggleButton({icon:'sap-icon://step',type:sap.m.ButtonType.Transparent,enabled:false,tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_MENUBUTTONTOOLTIP'),press:this._onStepNavigation.bind(this)});this.setAggregation('_stepNavigationButton',this._stepNavigationButton);this._sceneTreeButton=new sap.m.ToggleButton({icon:'sap-icon://tree',type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText('SCENETREE_MENUBUTTONTOOLTIP'),press:this._onSceneTree.bind(this)});this.setAggregation('_sceneTreeButton',this._sceneTreeButton);this._toolbarTitle=new sap.m.Title();this.setAggregation('_toolbarTitle',this._toolbarTitle);var t=t=[new sap.m.ToolbarSpacer(),this._toolbarTitle,new sap.m.ToolbarSpacer(),new sap.m.ToolbarSeparator(),this._sceneTreeButton,new sap.m.ToolbarSeparator(),this._stepNavigationButton];if(!this._isUsingIOS()){this._enterFullScreenButton=new sap.m.ToggleButton({icon:'sap-icon://full-screen',type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText('VIEWER_FULLSCREENBUTTONTOOLTIP'),press:this._onFullScreen.bind(this)});this.setAggregation('_enterFullScreenButton',this._enterFullScreenButton);var b=new sap.m.Button({icon:'sap-icon://exit-full-screen',type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText('VIEWER_FULLSCREENBUTTONTOOLTIP')});this.setAggregation('_exitFullScreenButton',b);t.push(new sap.m.ToolbarSeparator(),this._enterFullScreenButton);}this._toolbar=new sap.m.Toolbar({design:sap.m.ToolbarDesign.Solid,content:t});this.setAggregation('_toolbar',this._toolbar,true);};a.prototype.exit=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());if(this.oViewer){this.oViewer.detachFullScreen(this._fullScreenHandler.bind(this));}};a.prototype.onBeforeRendering=function(){this._toolbar.setVisible(true);this._toolbarTitle.setText(this.getTitle());};a.prototype.refresh=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());this._stepNavigationButton.setPressed(this.oViewer.getShowStepNavigation());this._stepNavigationButton.setEnabled(this.oViewer.getEnableStepNavigation());this._sceneTreeButton.setPressed(this.oViewer.getShowSceneTree());this._sceneTreeButton.setEnabled(this.oViewer.getEnableSceneTree());this.oViewer.attachFullScreen(this._fullScreenHandler.bind(this));return true;};a.prototype.onAfterRendering=function(){this.refresh();};return a;},true);\n",
	"sap/ui/vk/ToolbarRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var T={};T.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapVizKitToolbar');r.writeClasses();r.write('>');r.renderControl(c.getAggregation('_toolbar'));r.write('</div>');};return T;},true);\n",
	"sap/ui/vk/TransformationMatrix.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/DataType'],function(q,D){'use strict';var T=D.getType('float[]');T.parseValue=function(v){var c=T.getComponentType();return v.split(/\\s*,\\s*|\\s+/).map(c.parseValue.bind(c));};T.convertTo4x4=function(a){var m=a;return[m[0],m[1],m[2],0,m[3],m[4],m[5],0,m[6],m[7],m[8],0,m[9],m[10],m[11],1];};T.convertTo4x3=function(a){var m=a;return[m[0],m[1],m[2],m[4],m[5],m[6],m[8],m[9],m[10],m[12],m[13],m[14]];};q.sap.setObject('sap.ui.vk.TransformationMatrix',T);return T;});\n",
	"sap/ui/vk/View.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject'],function(q,M){'use strict';var V=M.extend('sap.ui.vk.View',{metadata:{library:'sap.ui.vk',properties:{name:{type:'string'},cameraInfo:{type:'object'},nodeInfos:{type:'object[]'},playbacks:{type:'object[]'}}}});return V;});\n",
	"sap/ui/vk/ViewGallery.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['sap/ui/core/Control','./Messages','./ContentConnector','./ViewGalleryRenderer'],function(C,M,a,V){'use strict';var b=C.extend('sap.ui.vk.ViewGallery',{metadata:{library:'sap.ui.vk',properties:{showStepInfo:{type:'boolean',group:'Appearance',defaultValue:false}},associations:{viewport:{type:'sap.ui.vk.threejs.Viewport'},contentConnector:{type:'sap.ui.vk.ContentConnector'}},aggregations:{items:{type:'sap.ui.core.Control',forwarding:{getter:'_getHBox',aggregation:'items',forwardBinding:true}},stepInfoPopup:{type:'sap.ui.core.Control',multiple:false},toolbar:{type:'sap.m.Toolbar',multiple:false},container:{type:'sap.m.ScrollContainer',multiple:false}},events:{selectionChange:{parameters:{item:'sap.ui.core.Control'}}}}});b.prototype.init=function(){if(C.prototype.init){C.prototype.init.call(this);}var t=this;this._scene=null;this._items=new Map();this._cdsLoader=null;this.oModel=new sap.ui.model.json.JSONModel();this._toolbar=new sap.m.Toolbar({design:sap.m.ToolbarDesign.Solid});this.setAggregation('toolbar',this._toolbar);this._hbox=new sap.m.HBox();this._scrollContainer=new sap.m.ScrollContainer(this.getId()+'-scroller',{width:'100%',horizontal:true,vertical:false,focusable:true,content:[this._hbox]});this.setAggregation('container',this._scrollContainer);this._previousItemButton=new sap.m.Button(this.getId()+'-previousItemButton',{type:sap.m.ButtonType.Transparent,icon:'sap-icon://slim-arrow-left',tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PREVIOUSSTEPBUTTON'),press:function(e){var i=t.getSelectedIndex();if(i>0){t.setSelectedItem(t.getItems()[i-1]);}}});this._nextItemButton=new sap.m.Button(this.getId()+'-nextItemButton',{type:sap.m.ButtonType.Transparent,icon:'sap-icon://slim-arrow-right',tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_NEXTSTEPBUTTON'),press:function(e){var i=t.getSelectedIndex(),d=t.getItems();if(i>=0&&i+1<d.length){t.setSelectedItem(d[i+1]);}}});this._procedureList=new sap.m.Select(this.getId()+'-procedureList',{tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PROCEDURESLISTHEADING'),selectedKey:'0',type:sap.m.SelectType.Default,enabled:true,width:'30%',change:function(o){var i=this.getSelectedIndex();if(t._viewportGroups){t._modelViews=t._viewportGroups[i].modelViews;if((!t._modelViews||t._modelViews.length===0)&&t._cdsLoader){var d=t._viewportGroups[i].originalId;var s=t._viewportGroups[i].sceneId;var r=t._cdsLoader.loadViewGroup(s,d);r.then(function(v){t._viewportGroups[i].modelViews=v;t._modelViews=v;t._refreshItems();});}else{t._refreshItems();}}}});this.showStepInfoButton=new sap.m.ToggleButton(this.getId()+'-showStepInfoButton',{icon:'sap-icon://hide',type:sap.m.ButtonType.Transparent,pressed:false,text:sap.ui.vk.getResourceBundle().getText('STEP_NAV_STEPDESCRIPTIONHEADING'),tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_STEPDESCRIPTIONHEADING'),press:function(e){var d=e.getSource();if(d.getPressed()){this.setShowStepInfo(true);d.setIcon('sap-icon://show');d.setTooltip(sap.ui.vk.getResourceBundle().getText('STEP_NAV_HIDESTEPDESCRIPTIONBUTTON'));}else{this.setShowStepInfo(false);d.setIcon('sap-icon://hide');d.setTooltip(sap.ui.vk.getResourceBundle().getText('STEP_NAV_SHOWSTEPDESCRIPTIONBUTTON'));}}.bind(this)});this._playButton=new sap.m.Button(this.getId()+'-playButton',{type:sap.m.ButtonType.Transparent,icon:'sap-icon://media-play',visible:true,tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PLAY'),press:function(e){this._playProcedure();}.bind(this)});this._stopButton=new sap.m.Button(this.getId()+'-stopButton',{type:sap.m.ButtonType.Transparent,icon:'sap-icon://media-pause',visible:true,tooltip:sap.ui.vk.getResourceBundle().getText('STEP_NAV_PLAYMENU_PAUSE'),press:function(e){this._stopAnimation();}.bind(this)});this._toolbar.addContent(this._previousItemButton).addContent(this._procedureList).addContent(this.showStepInfoButton).addContent(new sap.m.ToolbarSpacer()).addContent(this._nextItemButton).addContent(this._previousItemButton).addContent(this._playButton).addContent(this._stopButton);};b.prototype._getHBox=function(){return this._hbox;};b.prototype._playProcedure=function(){if(this._modelViews){var v=sap.ui.getCore().byId(this.getViewport());v.playProcedure(this._modelViews);}};b.prototype._stopAnimation=function(){var v=sap.ui.getCore().byId(this.getViewport());v.stopAnimation();};b.prototype.setScene=function(s){var i;if(s&&s.loaders){for(i=0;i<s.loaders.length;i++){if(s.loaders[i]instanceof sap.ui.vk.threejs.ContentDeliveryService){this._cdsLoader=s.loaders[i];this._cdsLoader.attachViewGroupUpdated(this._handleCdsViewGroupUpdate,this);break;}}}this._scene=s?s.getSceneRef():null;this._refreshProcdures();this._refreshItems();};b.prototype._refreshProcdures=function(){this._procedureList.removeAllItems();this._viewportGroups=null;this._modelViews=null;if(this._scene&&this._scene.userData){this._viewportGroups=this._scene.userData.viewportGroups;if(this._viewportGroups&&this._viewportGroups.length>0){this._viewportGroups.forEach(function(v){v.id=THREE.Math.generateUUID();this._procedureList.addItem(new sap.ui.core.Item({key:v.id,text:v.name}));}.bind(this));this._modelViews=this._viewportGroups[0].modelViews;}}this._refreshItems();};b.prototype.refresh=function(s){this.setScene(s);};var c='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAAA8CAYAAADIQIzXAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFFmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTA2LTA1VDEzOjU1OjAzKzEyOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0wNi0wNVQxNDowMDo1MCsxMjowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOC0wNi0wNVQxNDowMDo1MCsxMjowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNGZiYjQ5MS1mNzFkLTRmMTgtODA2Zi1iYjcxZjhhZTdhNjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjRmYmI0OTEtZjcxZC00ZjE4LTgwNmYtYmI3MWY4YWU3YTYwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MjRmYmI0OTEtZjcxZC00ZjE4LTgwNmYtYmI3MWY4YWU3YTYwIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoyNGZiYjQ5MS1mNzFkLTRmMTgtODA2Zi1iYjcxZjhhZTdhNjAiIHN0RXZ0OndoZW49IjIwMTgtMDYtMDVUMTM6NTU6MDMrMTI6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6QcBQiAAAGO0lEQVR4nO2ca1MbRxaGn+6emR7dzMUEOxRbla04H+LE+f+/YlO1oWIiA8IGhGQZJCSkkeZ28mEsOxtYRxoGIVx6vwip5tI8OrfuPho1DuIzoMZK82igxkEsDz2KxygNDB56EI9QA/3QI3isWoHLqRW4nHLmOdgYg1IgX0E6USp7TZKUNJVP72fVXOCiKEJEUPPeZUklIhhj0Hp+Y5gJnFIKx9EcHBxzeXmJtTbPOJdKIkIcx7x48QObm0+YTJK5zp/b4iaTyVw3WFZNwaVpmuv8uWOc4zg4zlynLaXko2/mDTuFEJBHki2KjM13AqeUIkkSoiieOystUiKgtcJ13cKueSdwYRiyvr7O8+fPiOMUWE7LM8YQBAHNZhMoxvLuBC5JYqz12dhcyz5YTm6gYDQscXZ2lr19aHBTV5UUoihd2ljneYYwDAu95mrKlVMrcDn1qAqyLDtqXFehFCQJxPF8FX9RWig4EXAcgzFZTJx3cu2XDEkMvd6AJEkol8uUKx5xJMRxutCSaGHgRMB1DXGcMByOqVQqwOwJxfMMve6Ak5MTrq+vSdMUz/PY2dnh22+f4zh6ofAWEuNEwPUMIsL+/mt+/fU/XF1d4Vk906qEtYbBYMje3h69Xg/HcbDWEscx9Xqdw6MG2ii0XpzJ3Ts4ETBGYwy8e3dCt9vFdV0ajSPCMMH3zUzwWq0WaZpSLpc/1WGu61KplGm3WvS6fTxvcbnu3u+ktcL1FCfvzmk2m1QqFXzfZzwOqP9RJ0kEx/n/w8iq/pjB4BrP8264ttYGgPE4gAXGuHsH51lN67zD4eEBruugtUZE8P0SnU6Hs7NzHFfNYHVfPmDRtfe9gRMB6xtGw5Dj4wbWWhzH+R+LKZVKtFrnBMMQv3S7y6Zpil9yqFSqhGF4Y7qUpsmnay1yyncv4ESy0mE0GrO3t0eayq1u5rouURSx/8c+cZTieTfhiQgI7O7u4jgOo9GIKaE4jhmNRuzu7rKx8YQwzLcomUeFgxMRrG9IYuH17/tMJmOstbeWHZnL+vT7VzQax2jDrZkxDBOqVZ+XL3+kVqsxmYSMx2OUUnz//Qu+++5fJImQposzuULruKxWc1AK3rw5ZDgcUqlUvliriQjlcoV2u8Xm5lOebq0xDpIb9dhkkrC+8YSfq6/o9XrEcUy1WqVa84lCIUkecQFsjMI4cFA/pt1u/SO0qbTWGGM4OjqkWv0Fax0mk5vwxkGCMZqtrXVQkCYwGWcxbtELqYW6qutpTk/anDVPKZfLM58nInieJQgCDg+PUCqr/f4upbJkMR4nRKGgTZaArG8+Zusi/5svqzBwntVcXlzx9m0D31q0nu/SmcuW6XTec3raxvXUjSwpkq0B+iWD1ormWZs39SPety/QOvvccWYrqO+qQlxVabgeBNTr9WwP1nVzLWoqpbDWcnr6ls3NDcoVj3GQuaIxOoMJdN5f0GyeMxj0SdOUdrvN2toaW99ssbmxiV9yQCCKJPf23z+psBg3HI6I4xjf93OvBIsIrusSBAEHB2/46eeXWGtQGpIYPnS6dD50uPhwkVmeX0IphYjQ7/fpdrtUq1W2t7+hVntCpVLF2vuxwMLAGWMwxty5RUJEKJVK9Ho9Dg8avPjh33x43+X8vEm/n7Xy2Y+hQEQ+fUnT7oIwDGk0jnEch1KpxM7ODtvbTwtv21jKhczP8Lr89t8R19dDIKv5/nrMbZpumIsIl5eXKKXYfva08DEuJTjISpQ0TRmNRnieO7fFTOOl53n3Mr6lBTd1+SI3kYvUarMmp1bgcmoFLqdW4HJqBS6nCsuqItn0Jk3TpekRno7nPlQYuCms7HU5wEGxzYR/VQHgsoHVajVevfplaawNPneVQ/Ff5Z3AZUVq9rfnGaw/+xrcwjSdmRW8WX0ncJ5nGQz6vP69vrS9cfC5j08pVZhH3AmcMYYoihiNRkvlon+XiHzsclqSHuDpgL6GH4zMq1Udl1MzW5xS2SJhEIyWOp7NKhEhiqKszssRZWYGlyTC9vYzarUaxiztatQcygp23/dJcvy6Xo2DuM8MDzMQEax1UF+Zc+fczB7M4aqKMHyYftv7Vp6C4Cuzn8VpBS6nVuByavXAlpxygCarRwTNq8GfDrbV1CI5dZUAAAAASUVORK5CYII=';b.prototype._refreshItems=function(){this._hbox.removeAllItems();this._items.clear();if(this._modelViews){var p=function(e){this.setSelectedItem(e.getSource());}.bind(this);this._modelViews.forEach(function(m){var i=new sap.m.Image({alt:m.name,src:m.thumbnailData||c,densityAware:false,tooltip:m.name,press:p,layoutData:new sap.m.FlexItemData({shrinkFactor:0})});i.data('modelView',m);i.addStyleClass('sapVizKitStepNavigationStepItem');this._items.set(m,i);this._hbox.addItem(i);}.bind(this));}};b.prototype.setSelectedItem=function(i){if(this._selectedItem){if(this._selectedItem!==i){this._selectedItem.removeStyleClass('selected');}}this._selectedItem=i;if(i){i.addStyleClass('selected');if(this._isScrollingNecessary(i.getDomRef(),this._scrollContainer.getDomRef())){this._scrollContainer.scrollToElement(i,500);}var v=sap.ui.getCore().byId(this.getViewport());if(v&&i.getCustomData().length>0){var m=i.getCustomData()[0].getValue();v.activateView(m);}}this.fireSelectionChange({item:i});return this;};b.prototype.getSelectedItem=function(){return this._selectedItem;};b.prototype.getSelectedIndex=function(){return this.indexOfItem(this.getSelectedItem());};b.prototype._isScrollingNecessary=function(i,s){if(i&&s){var r=i.getBoundingClientRect();return r.left<0||r.right>s.clientWidth;}return false;};b.prototype._getPopupPlacement=function(e){var y=0;while(e){y+=e.offsetTop;e=e.offsetParent;}return y>200?sap.m.PlacementType.Top:sap.m.PlacementType.Bottom;};b.prototype._setContent=function(d){this.setScene((d&&d instanceof sap.ui.vk.threejs.Scene)?d:null);if(d&&d instanceof sap.ui.vk.threejs.Scene&&d.builders){for(var i=0;i<d.builders.length;i++){d.builders[i]._fireThumbnailLoaded=function(e){var f=this._items.get(e.modelView);if(f){f.setSrc(e.modelView.thumbnailData);}}.bind(this);}}};b.prototype._onAfterUpdateContentConnector=function(){this._setContent(this._contentConnector.getContent());};b.prototype._onBeforeClearContentConnector=function(){this.setScene(null);};b.prototype._handleContentReplaced=function(e){var d=e.getParameter('newContent');this._setContent(d);};b.prototype._handleCdsViewGroupUpdate=function(e){if(this._modelViews){this._refreshItems();}else{this._refreshProcdures();this._refreshItems();}};a.injectMethodsIntoClass(b);return b;});\n",
	"sap/ui/vk/ViewGalleryRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var V={};V.render=function(r,c){r.write('<div');r.writeControlData(c);r.writeClasses();r.write('>');r.renderControl(c.getAggregation('toolbar'));r.renderControl(c.getAggregation('container'));r.write('</div>');};return V;},true);\n",
	"sap/ui/vk/ViewStateManager.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/Element','./ContentConnector','./Scene','./ViewStateManagerBase','./Core'],function(q,E,C,S,V,a){'use strict';var b=V.extend('sap.ui.vk.ViewStateManager',{metadata:{}});var c=b.getMetadata().getParent().getClass().prototype;b.prototype.init=function(){if(c.init){c.init.call(this);}this._implementation=null;};b.prototype.exit=function(){this._destroyImplementation();if(c.exit){c.exit.call(this);}};b.prototype._destroyImplementation=function(){if(this._implementation){this._implementation.destroy();this._implementation=null;}return this;};b.prototype.getImplementation=function(){return this._implementation;};b.prototype._setContent=function(d){var s=null;if(d&&d instanceof sap.ui.vk.Scene){s=d;}this._setScene(s);};b.prototype._onAfterUpdateContentConnector=function(){this._setContent(this._contentConnector.getContent());};b.prototype._onBeforeClearContentConnector=function(){this._setScene(null);};b.prototype._handleContentReplaced=function(e){this._setContent(e.getParameter('newContent'));};b.prototype._setScene=function(s){if(s&&s instanceof S){var d=s.getMetadata().getName(),i=this._implementation&&this._implementation.getMetadata().getName(),r=d==='sap.ui.vk.dvl.Scene'&&i==='sap.ui.vk.dvl.ViewStateManager'||d==='sap.ui.vk.threejs.Scene'&&i==='sap.ui.vk.threejs.ViewStateManager';if(!r){this._destroyImplementation();var n;if(d==='sap.ui.vk.dvl.Scene'){n='sap.ui.vk.dvl.ViewStateManager';}else if(d==='sap.ui.vk.threejs.Scene'){n='sap.ui.vk.threejs.ViewStateManager';}if(n){var t=this;q.sap.require(n);this._implementation=new(q.sap.getObject(n))({shouldTrackVisibilityChanges:this.getShouldTrackVisibilityChanges(),recursiveSelection:this.getRecursiveSelection(),contentConnector:this.getContentConnector(),visibilityChanged:function(e){t.fireVisibilityChanged({visible:e.getParameter('visible'),hidden:e.getParameter('hidden')});},selectionChanged:function(e){t.fireSelectionChanged({selected:e.getParameter('selected'),unselected:e.getParameter('unselected')});},opacityChanged:function(e){t.fireOpacityChanged({changed:e.getParameter('changed'),opacity:e.getParameter('opacity')});},tintColorChanged:function(e){t.fireTintColorChanged({changed:e.getParameter('changed'),tintColor:e.getParameter('tintColor'),tintColorABGR:e.getParameter('tintColorABGR')});},nodeHierarchyReplaced:function(e){t.fireNodeHierarchyReplaced({oldNodeHierarchy:e.getParameter('oldNodeHierarchy'),newNodeHierarchy:e.getParameter('newNodeHierarchy')});}});}}}else{this._destroyImplementation();}return this;};b.prototype.getNodeHierarchy=function(){return this._implementation&&this._implementation.getNodeHierarchy();};b.prototype.getVisibilityChanges=function(){return this._implementation&&this._implementation.getVisibilityChanges();};b.prototype.getVisibilityComplete=function(){return this._implementation&&this._implementation.getVisibilityComplete();};b.prototype.getVisibilityState=function(n){return this._implementation&&this._implementation.getVisibilityState(n);};b.prototype.setVisibilityState=function(n,v,r){if(this._implementation){this._implementation.setVisibilityState(n,v,r);}return this;};b.prototype.resetVisibility=function(){return this._implementation&&this._implementation.resetVisibility();};b.prototype.enumerateSelection=function(d){if(this._implementation){this._implementation.enumerateSelection(d);}return this;};b.prototype.setShowSelectionBoundingBox=function(v){if(this._implementation){this._implementation.setShowSelectionBoundingBox(v);}};b.prototype.getShowSelectionBoundingBox=function(){if(this._implementation){return this._implementation.getShowSelectionBoundingBox();}};b.prototype.getSelectionState=function(n){return this._implementation&&this._implementation.getSelectionState(n);};b.prototype.setSelectionState=function(n,s,r){if(this._implementation){this._implementation.setSelectionState(n,s,r);}return this;};b.prototype.setSelectionStates=function(s,u,r){if(this._implementation){this._implementation.setSelectionStates(s,u,r);}return this;};b.prototype.getOpacity=function(n){return this._implementation&&this._implementation.getOpacity(n);};b.prototype.setOpacity=function(n,o,r){if(this._implementation){this._implementation.setOpacity(n,o,r);}return this;};b.prototype.getTintColor=function(n,i){return this._implementation&&this._implementation.getTintColor(n,i);};b.prototype.setTintColor=function(n,t,r){if(this._implementation){this._implementation.setTintColor(n,t,r);}return this;};b.prototype.setHighlightColor=function(d){if(this._implementation&&this._implementation.setHighlightColor){this._implementation.setHighlightColor(d);}return this;};b.prototype.getHighlightColor=function(i){if(this._implementation&&this._implementation.getHighlightColor){return this._implementation.getHighlightColor(i);}};b.prototype.setRecursiveSelection=function(p){this.setProperty('recursiveSelection',p,true);if(this._implementation){this._implementation.setRecursiveSelection(p);}return this;};var f=b.getMetadata().getName();var m={init:function(){this._viewStateManager=null;sap.ui.vk.getCore().attachEvent(f+'-created',this._handleViewStateManagerCreated,this).attachEvent(f+'-destroying',this._handleViewStateManagerDestroying,this);},exit:function(){this.setViewStateManager(null);sap.ui.vk.getCore().detachEvent(f+'-destroying',this._handleViewStateManagerDestroying,this).detachEvent(f+'-created',this._handleViewStateManagerCreated,this);},setViewStateManager:function(v){this.setAssociation('viewStateManager',v,true);this._updateViewStateManager();return this;},_updateViewStateManager:function(){var n=this.getViewStateManager(),d=n&&sap.ui.getCore().byId(n)||null;if(this._viewStateManager!==d){this._clearViewStateManager();if(d){if(this._handleNodeHierarchyReplaced){d.attachNodeHierarchyReplaced(this._handleNodeHierarchyReplaced,this);}if(this._handleVisibilityChanged){d.attachVisibilityChanged(this._handleVisibilityChanged,this);}if(this._handleSelectionChanged){d.attachSelectionChanged(this._handleSelectionChanged,this);}if(this._handleOpacityChanged){d.attachOpacityChanged(this._handleOpacityChanged,this);}if(this._handleTintColorChanged){d.attachTintColorChanged(this._handleTintColorChanged,this);}this._viewStateManager=d;if(this._onAfterUpdateViewStateManager){this._onAfterUpdateViewStateManager();}}}return this;},_clearViewStateManager:function(){if(this._viewStateManager){if(this._onBeforeClearViewStateManager){this._onBeforeClearViewStateManager();}if(this._handleTintColorChanged){this._viewStateManager.detachTintColorChanged(this._handleTintColorChanged,this);}if(this._handleOpacityChanged){this._viewStateManager.detachOpacityChanged(this._handleOpacityChanged,this);}if(this._handleSelectionChanged){this._viewStateManager.detachSelectionChanged(this._handleSelectionChanged,this);}if(this._handleVisibilityChanged){this._viewStateManager.detachVisibilityChanged(this._handleVisibilityChanged,this);}if(this._handleNodeHierarchyReplaced){this._viewStateManager.detachNodeHierarchyReplaced(this._handleNodeHierarchyReplaced,this);}this._viewStateManager=null;}return this;},_handleViewStateManagerCreated:function(e){if(this.getViewStateManager()===e.getParameter('object').getId()){this._updateViewStateManager();}},_handleViewStateManagerDestroying:function(e){if(this.getViewStateManager()===e.getParameter('object').getId()){this._clearViewStateManager();}}};b.injectMethodsIntoClass=function(d){var p=d.prototype,i=p.init,e=p.exit;p.init=function(){if(i){i.call(this);}m.init.call(this);};p.exit=function(){m.exit.call(this);if(e){e.call(this);}};p.setViewStateManager=m.setViewStateManager;p._updateViewStateManager=m._updateViewStateManager;p._clearViewStateManager=m._clearViewStateManager;p._handleViewStateManagerCreated=m._handleViewStateManagerCreated;p._handleViewStateManagerDestroying=m._handleViewStateManagerDestroying;};sap.ui.vk.getCore().registerClass(b);C.injectMethodsIntoClass(b);return b;});\n",
	"sap/ui/vk/ViewStateManagerBase.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/Element','./ContentConnector','./Scene'],function(q,E,C,S){'use strict';var V=E.extend('sap.ui.vk.ViewStateManagerBase',{metadata:{'abstract':true,properties:{shouldTrackVisibilityChanges:{type:'boolean',defaultValue:false},recursiveSelection:{type:'boolean',defaultValue:false}},associations:{contentConnector:{type:'sap.ui.vk.ContentConnector'}},events:{visibilityChanged:{parameters:{visible:{type:'any[]'},hidden:{type:'any[]'}},enableEventBubbling:true},selectionChanged:{parameters:{selected:{type:'any[]'},unselected:{type:'any[]'}},enableEventBubbling:true},opacityChanged:{parameters:{changed:{type:'any[]'},opacity:{type:'float'}},enableEventBubbling:true},tintColorChanged:{parameters:{changed:{type:'any[]'},tintColor:{type:'sap.ui.core.CSSColor'},tintColorABGR:{type:'int'}},enableEventBubbling:true},nodeHierarchyReplaced:{parameters:{oldNodeHierarchy:{type:'sap.ui.vk.NodeHierarchy'},newNodeHierarchy:{type:'sap.ui.vk.NodeHierarchy'}}},highlightColorChanged:{parameters:{highlightColor:{type:'sap.ui.core.CSSColor'},highlightColorABGR:{type:'int'}},enableEventBubbling:true}}}});return V;});\n",
	"sap/ui/vk/Viewer.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control','./Scene','./ContentResource','./ContentConnector','./dvl/ContentManager','./FlexibleControl','sap/m/VBox','sap/m/FlexItemData','sap/ui/layout/Splitter','sap/ui/layout/SplitterLayoutData','./DvlException','./Messages','./ProgressIndicator','./Notifications','./ViewStateManager','./Toolbar','./SceneTree','./StepNavigation','./ViewGallery','./Viewport','./NativeViewport','./RedlineDesign','./ViewerRenderer'],function(q,a,C,S,b,c,D,F,V,d,e,f,g,M,P,N,h,T,j,k,m,n,o,R,p){'use strict';var r=q.sap.log;var s=C.extend('sap.ui.vk.Viewer',{metadata:{library:'sap.ui.vk',properties:{enableOverlay:{type:'boolean',defaultValue:false},enableSceneTree:{type:'boolean',defaultValue:true},showSceneTree:{type:'boolean',defaultValue:true},enableStepNavigation:{type:'boolean',defaultValue:true},enableNotifications:{type:'boolean',defaultValue:true},showStepNavigation:{type:'boolean',defaultValue:false},showStepNavigationThumbnails:{type:'boolean',defaultValue:true},enableToolbar:{type:'boolean',defaultValue:true},enableProgressIndicator:{type:'boolean',defaultValue:true},width:{type:'sap.ui.core.CSSSize',defaultValue:null},height:{type:'sap.ui.core.CSSSize',defaultValue:null},toolbarTitle:{type:'string',defaultValue:''},shouldTrackVisibilityChanges:{type:'boolean',defaultValue:false},recursiveSelection:{type:'boolean',defaultValue:false},runtimeSettings:{type:'object',defaultValue:{}},webGLContextAttributes:{type:'object',defaultValue:{antialias:true,alpha:true,premultipliedAlpha:false}},showAllHotspots:{type:'boolean',defaultValue:false},hotspotColorABGR:{type:'int',defaultValue:0xc00000ff},hotspotColor:{type:'sap.ui.core.CSSColor',defaultValue:'rgba(255, 0, 0, 0.7529411764705882)'}},aggregations:{contentResources:{type:'sap.ui.vk.ContentResource',forwarding:{getter:'_getContentConnector',aggregation:'contentResources'}},overlay:{type:'sap.ui.vk.Overlay',multiple:false},progressIndicator:{type:'sap.ui.vk.ProgressIndicator',multiple:false,visibility:'hidden'},layout:{type:'sap.m.VBox',multiple:false,visibility:'hidden'},contentConnector:{type:'sap.ui.vk.ContentConnector',multiple:false,visibility:'hidden'},viewStateManager:{type:'sap.ui.vk.ViewStateManager',multiple:false,visibility:'hidden'}},defaultAggregation:'contentResources',events:{contentResourceChangesProcessed:{},sceneLoadingSucceeded:{parameters:{scene:{type:'sap.ui.vk.Scene'}}},sceneLoadingFailed:{parameters:{reason:{type:'object'}}},sceneDestroying:{parameters:{scene:{type:'sap.ui.vk.Scene'},preventGarbageCollection:{type:'function'}}},selectionChanged:{parameters:{selected:{type:'any[]'},unselected:{type:'any[]'}}},fullScreen:{parameters:{isFullScreen:{type:'boolean'}}},urlClicked:{parameters:{nodeRef:'any',url:'string'}},nodeClicked:{parameters:{nodeRef:'any',x:'int',y:'int'}}}}});s.prototype.applySettings=function(i){this._inApplySettings=true;C.prototype.applySettings.apply(this,arguments);delete this._inApplySettings;if(this._viewStateManager){this._viewStateManager.setShouldTrackVisibilityChanges(this.getShouldTrackVisibilityChanges());this._viewStateManager.setRecursiveSelection(this.getRecursiveSelection());}this._componentsState={sceneTree:{defaultEnable:this.getEnableSceneTree(),shouldBeEnabled:true,userInteractionShow:this.getShowSceneTree()},stepNavigation:{defaultEnable:this.getEnableStepNavigation(),userInteractionShow:this.getShowStepNavigation()},progressIndicator:{defaultEnable:this.getEnableProgressIndicator()},messagePopover:{defaultEnable:this.getEnableNotifications()}};this.setEnableSceneTree(false);this.setEnableStepNavigation(false);};s.prototype.init=function(){if(C.prototype.init){C.prototype.init.apply(this);}this._contentConnector=new c(this.getId()+'-contentconnector');this.setAggregation('contentConnector',this._contentConnector);this._contentConnector.attachContentReplaced(this._handleContentReplaced,this);this._contentConnector.attachContentChangesStarted(this._handleContentChangesStarted,this);this._contentConnector.attachContentChangesFinished(this._handleContentChangesFinished,this);this._contentConnector.attachContentChangesProgress(this._handleContentChangesProgress,this);this._viewStateManager=new h(this.getId()+'-viewstatemanager',{contentConnector:this._contentConnector});this.setAggregation('viewStateManager',this._viewStateManager);r.debug('sap.ui.vk.Viewer.init() called.');this._mainScene=null;this._busyIndicatorCounter=0;this._viewport=null;this._nativeViewport=null;this._redlineDesign=null;this._stepNavigation=null;this._sceneTree=null;this._overlayManager={initialized:false,changed:false,control:null,onNativeViewportMove:function(i){var l=i.getParameter('pan');var z=i.getParameter('zoom');this.control.setPanAndZoom(l.x,l.y,z);},onViewportZoom:function(i){var z=i.getParameter('zoomFactor');this.control.setPanAndZoom(0,0,z);},onViewportPan:function(i){var l=i.getParameter('dx');var u=i.getParameter('dy');this.control.setPanAndZoom(l,u,1);}};this._overlayManager.delegate={onAfterRendering:this._onAfterRenderingOverlay.bind(this,this._viewport,this._nativeViewport,this._overlayManager)};this._toolbar=new T({title:this.getToolbarTitle(),visible:this.getEnableToolbar(),viewer:this});this._stackedViewport=new F(this.getId()+'-stackedViewport',{width:'100%',height:'100%',layout:'Stacked',layoutData:new f({size:'auto',minSize:200})});this._splitter=new e(this.getId()+'-splitter',{layoutData:new sap.m.FlexItemData({growFactor:1,minHeight:'200px'}),contentAreas:[this._stackedViewport]}).addStyleClass('sapUiVizKitSplitter');this._messagePopover=new N({visible:true});this._messagePopover.attachAllMessagesCleared(this._updateLayout,this);this._messagePopover.attachMessageAdded(this._updateLayout,this);this._layout=new V(this.getId()+'-vbox',{height:'100%',items:[this._toolbar,this._splitter,this._messagePopover]}).addStyleClass('sapUiVizKitLayout');this.setAggregation('layout',this._layout);this.setTooltip(sap.ui.vk.getResourceBundle().getText('VIEWER_TITLE'));if(this.getEnableProgressIndicator()){this._progressIndicator=new P({visible:false}).addStyleClass('sapUiVizKitProgressIndicator');this.setAggregation('progressIndicator',this._progressIndicator);}};s.prototype.exit=function(){r.debug('sap.ui.vk.Viewer.exit() called.');if(this._viewport){this._viewport.detachEvent('viewActivated',this._onViewportViewActivated,this);this._viewport.destroy();this._viewport=null;}if(this._nativeViewport){this._nativeViewport.destroy();this._nativeViewport=null;}this._setMainScene(null);this._toolbar=null;this._messagePopover=null;this._sceneTree=null;this._stepNavigation=null;this._componentsState=null;this._viewStateManager=null;this._contentConnector=null;if(C.prototype.exit){C.prototype.exit.apply(this);}};s.prototype._setMainScene=function(i){if(i){if(i!==this._mainScene){this._mainScene=i;this._showViewport();if(this._componentsState.sceneTree.defaultEnable){this._instantiateSceneTree();this.setEnableSceneTree(true);if(this._componentsState.sceneTree.userInteractionShow&&this._componentsState.sceneTree.shouldBeEnabled){this.setShowSceneTree(true);this._sceneTree.setVisible(true);}else{this.setShowSceneTree(false);}}else if(this._sceneTree&&this._viewStateManager){this._sceneTree.setScene(i,this._viewStateManager);}this.setEnableStepNavigation(this.getEnableStepNavigation()||this._componentsState.stepNavigation.defaultEnable);if(this.getEnableStepNavigation()){this._instantiateStepNavigation();this.setShowStepNavigation(this._componentsState.stepNavigation.userInteractionShow);}}if(this._stepNavigation){this._stepNavigation.refresh(i);}}else{this._mainScene=null;this.setEnableSceneTree(false);this.setEnableStepNavigation(false);}return this;};s.prototype.getGraphicsCore=function(){return this._mainScene instanceof sap.ui.vk.dvl.Scene?this._mainScene.getGraphicsCore():null;};s.prototype.getScene=function(){return this._mainScene;};s.prototype.getViewStateManager=function(){return this._viewStateManager;};s.prototype.getViewport=function(){if(!this._viewport){this._viewport=new n(this.getId()+'-viewport',{viewStateManager:this._viewStateManager,selectionMode:sap.ui.vk.SelectionMode.Exclusive,contentConnector:this._contentConnector});this._viewport.attachEvent('viewActivated',this._onViewportViewActivated,this);}return this._viewport;};s.prototype.getNativeViewport=function(){return this._nativeViewport;};s.prototype.getToolbar=function(){return this._toolbar;};s.prototype.getSceneTree=function(){return this._sceneTree;};s.prototype.getRedlineDesign=function(){return this._redlineDesign;};s.prototype.getOverlay=function(){return this._overlayManager.control;};s.prototype.setEnableOverlay=function(i){if(i!==this.getProperty('enableOverlay')){this.setProperty('enableOverlay',i);this._overlayManager.changed=true;}return this;};s.prototype.setEnableSceneTree=function(i){this.setProperty('enableSceneTree',i,true);if(!i){this.setProperty('showSceneTree',false);}this._updateLayout();return this;};s.prototype.setEnableNotifications=function(i){this.setProperty('enableNotifications',i,true);this._messagePopover.setVisible(false);this._updateLayout();return this;};s.prototype.setShowSceneTree=function(i){this.setProperty('showSceneTree',i,true);this._updateLayout();return this;};s.prototype.setEnableStepNavigation=function(i){this.setProperty('enableStepNavigation',i,true);if(!i){this.setProperty('showStepNavigation',false);}this._updateLayout();return this;};s.prototype.setShowStepNavigation=function(i){this.setProperty('showStepNavigation',i,true);this._updateLayout();return this;};s.prototype.setEnableToolbar=function(v){this.setProperty('enableToolbar',v,true);this._toolbar.setVisible(v);return this;};s.prototype.setRecursiveSelection=function(i){this.setProperty('recursiveSelection',i,true);if(this._viewStateManager){this._viewStateManager.setRecursiveSelection(i);}return this;};s.prototype.setToolbarTitle=function(v){this.setProperty('toolbarTitle',v);this._toolbar.setTitle(v);return this;};s.prototype.activateFullScreenMode=function(v){var i=function(w){return!!(w.fullScreen||w.webkitIsFullScreen||w.mozFullScreen||w.msFullscreenElement);};if(v){if(!i(document)){if(!this._fullScreenHandler){var l=this;this._fullScreenHandler=function(w){var x=i(document);if(!x){l.removeStyleClass('sapVizKitViewerFullScreen');document.removeEventListener('fullscreenchange',l._fullScreenHandler);document.removeEventListener('mozfullscreenchange',l._fullScreenHandler);document.removeEventListener('webkitfullscreenchange',l._fullScreenHandler);document.removeEventListener('MSFullscreenChange',l._fullScreenHandler);}l.fireFullScreen({isFullScreen:x});};}var u=document.getElementsByTagName('body')[0];if(u.requestFullScreen){document.addEventListener('fullscreenchange',this._fullScreenHandler);u.requestFullScreen();}else if(u.webkitRequestFullScreen){document.addEventListener('webkitfullscreenchange',this._fullScreenHandler);u.webkitRequestFullScreen();}else if(u.mozRequestFullScreen){document.addEventListener('mozfullscreenchange',this._fullScreenHandler);u.mozRequestFullScreen();}else if(u.msRequestFullscreen){document.addEventListener('MSFullscreenChange',this._fullScreenHandler);u.msRequestFullscreen();}}this.addStyleClass('sapVizKitViewerFullScreen');}else{if(i(document)){if(document.cancelFullScreen){document.cancelFullScreen();}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}}this.removeStyleClass('sapVizKitViewerFullScreen');}return this;};function t(v){if(!v){return false;}return v instanceof sap.ui.vk.dvl.Viewport;}s.prototype.getShowAllHotspots=function(){var v=this.getViewport().getImplementation();return t(v)?v.getShowAllHotspots():this.getProperty('showAllHotspots');};s.prototype.setShowAllHotspots=function(v){this.setProperty('showAllHotspots',v,true);var i=this.getViewport().getImplementation();if(t(i)){i.setShowAllHotspots(v);}return this;};s.prototype.getHotspotColorABGR=function(){var v=this.getViewport().getImplementation();return t(v)?v.getHotspotColorABGR():this.getProperty('hotspotColorABGR');};s.prototype.setHotspotColorABGR=function(v){this.setProperty('hotspotColorABGR',v,true);this.setProperty('hotspotColor',sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(v)),true);var i=this.getViewport().getImplementation();if(t(i)){i.setHotspotColorABGR(v);}return this;};s.prototype.getHotspotColor=function(){var v=this.getViewport().getImplementation();return t(v)?v.getHotspotColor():this.getProperty('hotspotColor');};s.prototype.setHotspotColor=function(v){this.setProperty('hotspotColor',v,true);this.setProperty('hotspotColorABGR',sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(v)),true);var i=this.getViewport().getImplementation();if(t(i)){i.setHotspotColor(v);}return this;};s.prototype.setRuntimeSettings=function(i){if(this._inApplySettings){this.setProperty('runtimeSettings',i,true);D.setRuntimeSettings(i);}else{r.error(sap.ui.vk.getResourceBundle().getText(M.VIT29.summary),M.VIT29.code,'sap.ui.vk.Viewer');}return this;};s.prototype.setWebGLContextAttributes=function(i){if(this._inApplySettings){this.setProperty('webGLContextAttributes',i,true);D.setWebGLContextAttributes(i);}else{r.error(sap.ui.vk.getResourceBundle().getText(M.VIT30.summary),M.VIT30.code,'sap.ui.vk.Viewer');}return this;};s.prototype.invalidate=function(i){if(i instanceof b){this._contentConnector.invalidate(i);return;}C.prototype.invalidate.apply(this,arguments);};s.prototype._getContentConnector=function(){return this._contentConnector;};s.prototype.onBeforeRendering=function(){this._showOverlay();};s.prototype.isTreeBinding=function(i){return i==='contentResources';};s.prototype.setBusy=function(i){if(i){if(this._busyIndicatorCounter===0){this.setBusyIndicatorDelay(0);C.prototype.setBusy.call(this,true);}this._busyIndicatorCounter+=1;}else{this._busyIndicatorCounter-=1;if(this._busyIndicatorCounter==0){C.prototype.setBusy.call(this,false);}}};s.prototype._updateLayout=function(){if(this._sceneTree){if(this.getShowSceneTree()&&this.getEnableSceneTree()){this._sceneTree.setVisible(true);if(this._splitter.indexOfContentArea(this._sceneTree)<0){this._splitter.insertContentArea(this._sceneTree,0);}}else{if(this._splitter.indexOfContentArea(this._sceneTree)>=0){this._splitter.removeContentArea(this._sceneTree);}this._sceneTree.setVisible(false);}}if(this._stepNavigation){this._stepNavigation.setVisible(this.getShowStepNavigation()&&this.getEnableStepNavigation());}if(this._messagePopover){this._messagePopover.setVisible(this.getEnableNotifications()&&this._messagePopover.getAggregation('_messagePopover').getItems().length>0);}if(this._toolbar){this._toolbar.refresh();}};s.prototype._instantiateSceneTree=function(){if(!this._sceneTree){this._sceneTree=new j({layoutData:new f({size:'320px',minSize:200}),viewStateManager:this._viewStateManager,contentConnector:this._contentConnector});}return this;};s.prototype._instantiateStepNavigation=function(){if(!this._stepNavigation){if(this._mainScene instanceof sap.ui.vk.dvl.Scene){this._stepNavigation=new k(this.getId()+'-stepNavigation',{showThumbnails:this.getShowStepNavigationThumbnails(),contentConnector:this._contentConnector});}else if(this._mainScene instanceof sap.ui.vk.threejs.Scene){this._stepNavigation=new m({viewport:this.getViewport(),contentConnector:this._contentConnector});}this._layout.insertItem(this._stepNavigation,3);}return this;};s.prototype._showViewport=function(){var v=this.getViewport().getImplementation();if(t(v)){v.setHotspotColor(this.getProperty('hotspotColor'));v.setHotspotColorABGR(this.getProperty('hotspotColorABGR'));v.setShowAllHotspots(this.getProperty('showAllHotspots'));}if(this._nativeViewport){this._nativeViewport.setVisible(false);}this._stackedViewport.removeAllContent();this._stackedViewport.addContent(this._viewport);this._viewport.setVisible(true);return this;};s.prototype._showNativeViewport=function(){if(!this._nativeViewport){this._nativeViewport=new o(this.getId()+'-nativeViewport',{limitZoomOut:true,contentConnector:this._contentConnector});}if(this._viewport){this._viewport.setVisible(false);}this._stackedViewport.removeAllContent();this._stackedViewport.addContent(this._nativeViewport);this._nativeViewport.setVisible(true);return this;};s.prototype._showOverlay=function(){var O=this._overlayManager;if(O.changed){var i;if(this.getEnableOverlay()){sap.ui.require(['sap/ui/vk/Overlay'],function(l){if(!O.initialized){if(!(i=this.getAggregation('overlay'))){i=new l();}i.setZoomOnResize(false);O.control=i;O.initialized=true;}else{i=O.control;i.reset();}if(this._nativeViewport&&this._nativeViewport.getVisible()){i.setTarget(this._nativeViewport);O.savedLimitZoomOutState=this._nativeViewport.getLimitZoomOut();this._nativeViewport.setLimitZoomOut(true);this._nativeViewport.attachEvent('move',O.onNativeViewportMove,O);}else if(this._viewport&&this._viewport.getVisible()){i.setTarget(this._viewport);O.savedLimitZoomOutState=false;this._viewport.attachEvent('zoom',O.onViewportZoom,O);this._viewport.attachEvent('pan',O.onViewportPan,O);}this._stackedViewport.addContent(i);this._stackedViewport.addDelegate(O.delegate);}.bind(this));}else{this._nativeViewport.detachEvent('move',O.onNativeViewportMove,O);this._stackedViewport.removeDelegate(O.delegate);this._stackedViewport.removeContent(O.control);this._nativeViewport.setLimitZoomOut(O.savedLimitZoomOutState);}O.changed=false;}};s.prototype._onAfterRenderingOverlay=function(E){var i=this._overlayManager.control.getDomRef();if(i&&(this._nativeViewport||this._viewport)){var v=this._nativeViewport&&this._nativeViewport.getVisible()?this._nativeViewport.getDomRef():this._viewport.getDomRef();if(i.parentNode!==v){i.parentNode.style.display='none';}v.appendChild(i);i.style.width='100%';i.style.height='100%';}};s.prototype.setDecryptionHandler=function(i){this._contentConnector.setDecryptionHandler(i);return this;};s.prototype.setAuthorizationHandler=function(i){this._contentConnector.setAuthorizationHandler(i);return this;};s.prototype._instantiateRedlineDesign=function(i){var v=this.getViewport().getImplementation();if((v&&v.getVisible())||(this.getNativeViewport()&&this.getNativeViewport().getVisible())){var l=v&&v.getVisible()?v:this.getNativeViewport();var u=l.getOutputSize();this._redlineDesign=new R({visible:false,virtualTop:u.top,virtualLeft:u.left,virtualSideLength:u.sideLength,redlineElements:i});this._redlineDesign._setTargetViewport(l);}return this;};s.prototype.activateRedlineDesign=function(i){var v=this.getViewport().getImplementation();if(v instanceof sap.ui.vk.threejs.Viewport&&v.getCamera().getCameraRef().type==='PerspectiveCamera'){v._viewportGestureHandler._activateRedline();}if(v instanceof sap.ui.vk.dvl.Viewport&&v.getViewInfo().camera&&v.getViewInfo().camera.projectionType==='perspective'){v._activateRedline();}i=i||[];this._instantiateRedlineDesign(i);this.getRedlineDesign().placeAt(this._stackedViewport);this.getRedlineDesign().setVisible(true);var l=function(A){var B=A.getParameter('deltaX'),E=A.getParameter('deltaY');v.queueCommand(function(B,E){v.pan(B,E);v.endGesture();}.bind(this,B,E));};var u=function(A){var B=A.getParameter('originX'),E=A.getParameter('originY'),G=A.getParameter('zoomFactor');v.queueCommand(function(B,E,G){v.beginGesture(B,E);v.zoom(G);v.endGesture();}.bind(this,B,E,G));};var w=function(A){var B=A.getParameter('deltaX'),E=A.getParameter('deltaY');this.getNativeViewport().queueCommand(function(){this.getNativeViewport().pan(B,E);this.getNativeViewport().endGesture();}.bind(this));};var x=function(A){var B=A.getParameter('originX'),E=A.getParameter('originY'),G=A.getParameter('zoomFactor');this.getNativeViewport().queueCommand(function(B,E,G){this.getNativeViewport().beginGesture(B,E);this.getNativeViewport().zoom(G);this.getNativeViewport().endGesture();}.bind(this,B,E,G));};var y=function(A){var B=A.getParameter('deltaX'),E=A.getParameter('deltaY');v.queueCommand(function(B,E){v._viewportGestureHandler._cameraController.beginGesture(B,E);v._viewportGestureHandler._cameraController.pan(B,E);v._viewportGestureHandler._cameraController.endGesture();}.bind(this,B,E));};var z=function(A){var B=A.getParameter('originX'),E=A.getParameter('originY'),G=A.getParameter('zoomFactor');v.queueCommand(function(B,E,G){v._viewportGestureHandler._cameraController.beginGesture(B,E);v._viewportGestureHandler._cameraController.zoom(G);v._viewportGestureHandler._cameraController.endGesture();}.bind(this,B,E,G));};if(this.getNativeViewport()&&this.getNativeViewport().getVisible()){this.getRedlineDesign().attachEvent('pan',w.bind(this));this.getRedlineDesign().attachEvent('zoom',x.bind(this));}else if(v&&t(v)&&v.getVisible()){this.getRedlineDesign().attachEvent('pan',l.bind(this));this.getRedlineDesign().attachEvent('zoom',u.bind(this));}else if(v instanceof sap.ui.vk.threejs.Viewport&&v.getVisible()){this.getRedlineDesign().attachEvent('pan',y.bind(this));this.getRedlineDesign().attachEvent('zoom',z.bind(this));}else{q.sap.log.Error('Error: Viewport not supported');}return this;};s.prototype.destroyRedlineDesign=function(){if(this.getRedlineDesign()){var v=this.getViewport().getImplementation();if(v instanceof sap.ui.vk.dvl.Viewport){v._deactivateRedline();}else if(v instanceof sap.ui.vk.threejs.Viewport){v._viewportGestureHandler._deactivateRedline();}this.getRedlineDesign().destroy();this._redlineDesign=null;}return this;};s.prototype._onViewportViewActivated=function(i){this._componentsState.sceneTree.shouldBeEnabled=i.getParameter('type')==='3D';};s.prototype._handleContentReplaced=function(i){var l=i.getParameter('newContent');if(l&&l instanceof sap.ui.vk.Scene){this._showViewport();if(this.getRedlineDesign()){this.getRedlineDesign().updatePanningRatio();}this._setMainScene(l);}else if(l instanceof HTMLImageElement||l instanceof HTMLObjectElement){this._setMainScene(null);this._showNativeViewport();if(this.getEnableOverlay()){this._overlayManager.changed=true;this._showOverlay();}}else{this._setMainScene(null);if(this._viewport){this._viewport.setVisible(false);}if(this._nativeViewport){this._nativeViewport.setVisible(false);}this._stackedViewport.removeAllContent();}};s.prototype._handleContentChangesStarted=function(i){this.setBusy(true);if(this._componentsState.progressIndicator.defaultEnable){this._progressIndicator.setPercentValue(0.0);this._progressIndicator.setVisible(true);this.getViewport().stopAnimation();}};s.prototype._handleContentChangesFinished=function(i){r.info('Finished');setTimeout(function(){this._progressIndicator.setVisible(false);this._progressIndicator.setDisplayValue('');this._progressIndicator.setPercentValue(0);}.bind(this),0);this.setBusy(false);var l=i.getParameter('content');if(l){this.fireSceneLoadingSucceeded({scene:l});}var u=i.getParameter('failureReason');if(u){this.fireSceneLoadingFailed({reason:u});this._showNativeViewport();var v=sap.ui.vk.getResourceBundle().getText('VIEWER_UNKNOWN_CONTENT_RESOURCE_TYPE_CAUSE');if(u.errorMessage===v){this._nativeViewport.loadFailed();}else{var w=sap.ui.vk.getResourceBundle().getText('VIEWPORT_MESSAGEERRORLOADINGFILE');this._nativeViewport.loadFailed(w);}(Array.isArray(u)?u:[u]).forEach(function(x){r.error(sap.ui.vk.getResourceBundle().getText(M.VIT13.summary),x.errorMessage,'sap.ui.vk.Viewer');});}this.fireContentResourceChangesProcessed();};s.prototype._handleContentChangesProgress=function(u){function v(B,w){for(var i=0,l=B.length;i<l;i++){var E=B[i];var G=E.getSource();if((G===w)||(G instanceof File&&G.name===w)){return E;}E=v(E.getContentResources(),w);if(E){return E;}}return null;}if(this._progressIndicator.getVisible()){var w=u.getParameter('source'),x=u.getParameter('percentage'),y=u.getParameter('phase');var z=v(this.getContentResources(),w);if(z&&z.getName()!==undefined){w=z.getName();}else{var A=w.match(/\\..{3,4}$/);w=A&&A[0]?w.split(/\\\\|\\//).pop():'';}this._progressIndicator.setPercentValue(x);this._progressIndicator.setDisplayValue(w+' '+y+' '+(x?Math.floor(x)+'%':''));}};s.prototype._handleContentDestroying=function(i){this.fireSceneDestroying({scene:i.getParameter('content').scene,preventGarbageCollection:i.getParameter('preventGarbageCollection')});};return s;});\n",
	"sap/ui/vk/ViewerRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var V={};V.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapVizKitViewer');r.writeClasses();if(c.getWidth()){r.addStyle('width',c.getWidth());}if(c.getHeight()){r.addStyle('height',c.getHeight());}r.writeStyles();r.write('>');r.renderControl(c._layout);r.renderControl(c._progressIndicator);r.write('</div>');};return V;},true);\n",
	"sap/ui/vk/Viewport.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./ViewportBase','./ContentConnector','./ViewStateManager','./ViewportRenderer'],function(q,V,C,a,b){'use strict';var c=V.extend('sap.ui.vk.Viewport',{metadata:{library:'sap.ui.vk',designtime:'sap/ui/vk/designtime/Viewport.designtime'}});var d=c.getMetadata().getParent().getClass().prototype;c.prototype.init=function(){if(d.init){d.init.call(this);}this._implementation=null;this._deferred={};};c.prototype.exit=function(){this._deferred=null;this._destroyImplementation();if(d.exit){d.exit.call(this);}};c.prototype.getImplementation=function(){return this._implementation;};c.prototype._destroyImplementation=function(){if(this._implementation){this._implementation.destroy();this._implementation=null;}return this;};c.prototype.getShowDebugInfo=function(){if(this._implementation){return this._implementation.getShowDebugInfo();}return d.getShowDebugInfo.call(this);};c.prototype.setShowDebugInfo=function(v){d.setShowDebugInfo.call(this,v);if(this._implementation){this._implementation.setShowDebugInfo(v);}return this;};c.prototype.getBackgroundColorTop=function(){if(this._implementation){return this._implementation.getBackgroundColorTop();}return d.getBackgroundColorTop.call(this);};c.prototype.setBackgroundColorTop=function(v){d.setBackgroundColorTop.call(this,v);if(this._implementation){this._implementation.setBackgroundColorTop(v);}return this;};c.prototype.getBackgroundColorBottom=function(){if(this._implementation){return this._implementation.getBackgroundColorBottom();}return d.getBackgroundColorBottom.call(this);};c.prototype.setBackgroundColorBottom=function(v){d.setBackgroundColorBottom.call(this,v);if(this._implementation){this._implementation.setBackgroundColorBottom(v);}return this;};c.prototype.setWidth=function(v){d.setWidth.call(this,v);if(this._implementation){this._implementation.setWidth(v);}return this;};c.prototype.setHeight=function(v){d.setHeight.call(this,v);if(this._implementation){this._implementation.setHeight(v);}return this;};c.prototype.setSelectionMode=function(v){d.setSelectionMode.call(this,v);if(this._implementation){this._implementation.setSelectionMode(v);}return this;};c.prototype.getSelectionMode=function(){if(this._implementation){return this._implementation.getSelectionMode();}return d.getSelectionMode.call(this);};c.prototype.setCamera=function(v){d.setCamera.call(this,v);if(this._implementation){this._implementation.setCamera(v);return this;}return this;};c.prototype.getCamera=function(){if(this._implementation){return this._implementation.getCamera();}return d.getCamera.call(this);};c.prototype.setShouldRenderFrame=function(){if(this._implementation){this._implementation.setShouldRenderFrame();}return this;};c.prototype.shouldRenderFrame=function(){if(this._implementation){this._implementation.shouldRenderFrame();}};c.prototype.setFreezeCamera=function(v){d.setFreezeCamera.call(this,v);if(this._implementation){this._implementation.setFreezeCamera(v);}return this;};c.prototype.showHotspots=function(n,j,k){if(this._implementation&&this._implementation.showHotspots){this._implementation.showHotspots(n,j,k);}return this;};c.prototype.addTool=function(t){if(this._implementation){this._implementation.addTool(t);}};c.prototype.removeTool=function(t){if(this._implementation){this._implementation.removeTool(t);}};c.prototype.getTools=function(){if(this._implementation){return this._implementation.getTools();}return null;};c.prototype.removeAllTools=function(){if(this._implementation){this._implementation.removeAllTools();}};c.prototype.startAnimation=function(p){if(this._implementation&&this._implementation.startAnimation){this._implementation.startAnimation(p);}};c.prototype.stopAnimation=function(){if(this._implementation&&this._implementation.stopAnimation){this._implementation.stopAnimation();}};c.prototype.playProcedure=function(m){if(this._implementation&&this._implementation.playProcedure){this._implementation.playProcedure(m);}};c.prototype.activateView=function(v){if(this._implementation&&this._implementation.activateView){this._implementation.activateView(v);}};c.prototype._setContent=function(j){var k=null;var l=null;if(j){k=j;if(!(k instanceof sap.ui.vk.Scene)){k=null;}l=j.camera;if(!(l instanceof sap.ui.vk.Camera)){l=null;}}this._setScene(k);if(l){this.setCamera(l);}};c.prototype._onAfterUpdateContentConnector=function(){this._setContent(this._contentConnector.getContent());};c.prototype._onBeforeClearContentConnector=function(){if(d._onBeforeClearContentConnector){d._onBeforeClearContentConnector.call(this);}this._setScene(null);};c.prototype._handleContentReplaced=function(j){var k=j.getParameter('newContent');this._setContent(k);};c.prototype._setScene=function(j){if(j instanceof sap.ui.vk.Scene){var k=j.getMetadata().getName(),l=this._implementation&&this._implementation.getMetadata().getName(),r=k==='sap.ui.vk.dvl.Scene'&&l==='sap.ui.vk.dvl.Viewport'||k==='sap.ui.vk.threejs.Scene'&&l==='sap.ui.vk.threejs.Viewport';if(!r){this._destroyImplementation();var n;var t=this;var m=this.getCamera();if(k==='sap.ui.vk.dvl.Scene'){n='sap.ui.vk.dvl.Viewport';}else if(k==='sap.ui.vk.threejs.Scene'){n='sap.ui.vk.threejs.Viewport';}if(n){q.sap.require(n);this._implementation=new(q.sap.getObject(n))({viewStateManager:this.getViewStateManager(),urlClicked:function(o){t.fireUrlClicked({nodeRef:o.getParameter('nodeRef'),url:o.getParameter('url')});},nodeClicked:function(o){t.fireNodeClicked({nodeRef:o.getParameter('nodeRef'),x:o.getParameter('x'),y:o.getParameter('y')});},resize:function(o){t.fireResize({size:o.getParameter('size')});},showDebugInfo:this.getShowDebugInfo(),width:this.getWidth(),height:this.getHeight(),backgroundColorTop:this.getBackgroundColorTop(),backgroundColorBottom:this.getBackgroundColorBottom(),selectionMode:this.getSelectionMode(),contentConnector:this.getContentConnector(),freezeCamera:this.getFreezeCamera()});if(m){this._camera=null;this._implementation.setCamera(m);}if('graphicsCore'in this._deferred&&this._implementation.setGraphicsCore){this._implementation.setGraphicsCore(this._deferred.graphicsCore);}delete this._deferred.graphicsCore;if('scene'in this._deferred&&this._implementation.setScene){this._implementation.setScene(this._deferred.scene);}delete this._deferred.scene;this._implementation.attachNodesPicked(function(o){this.fireNodesPicked({picked:o.getParameter('picked')});},this);this._implementation.attachNodeZoomed(function(o){this.fireNodeZoomed({zoomed:o.getParameter('zoomed'),isZoomIn:o.getParameter('isZoomIn')});},this);}this.invalidate();}}else{this._destroyImplementation();this.invalidate();}return this;};c.prototype._onAfterUpdateViewStateManager=function(){if(this._implementation){this._implementation.setViewStateManager(this._viewStateManager);}};c.prototype._onBeforeClearViewStateManager=function(){if(this._implementation){this._implementation.setViewStateManager(null);}};c.prototype.activateView=function(v){if(this._implementation){this._implementation.activateView(v);return this;}else{q.sap.log.error('no implementation');return this;}};c.prototype.zoomTo=function(w,n,j,m){if(this._implementation){this._implementation.zoomTo(w,n,j,m);return this;}else{q.sap.log.error('no implementation');return this;}};c.prototype.tap=function(x,y,j){if(this._implementation){this._implementation.tap(x,y,j);}return this;};var s=function(j){j.camera={};};var e=function(j){if(typeof j.camera==='object'&&j.camera!==null){j.camera.matrices=false;}};var f=function(j){if(typeof j.camera==='object'&&j.camera!==null){j.camera.useTransitionCamera=false;}};var g=function(j){j.animation=true;};var h=function(j){j.visibility=false;};var i=function(j){if(typeof j.visibility==='object'&&j.visibility!==null){j.visibility.mode=sap.ui.vk.VisibilityMode.Complete;}};c.prototype.getViewInfo=function(j){if(!this._implementation){q.sap.log.error('no implementation');return null;}var k={};if(typeof j!=='object'||j===null){s(k);e(k);f(k);g(k);h(k);i(k);}else{if(typeof j.camera==='object'&&j.camera!==null){k.camera={};if(typeof j.camera.matrices==='boolean'){k.camera.matrices=j.camera.matrices;}else if('matrices'in j.camera){k.camera.matrices=false;}else{e(k);}if(typeof j.camera.useTransitionCamera==='boolean'){k.camera.useTransitionCamera=j.camera.useTransitionCamera;}else if('useTransitionCamera'in j.camera){k.camera.useTransitionCamera=false;}else{f(k);}}else if(typeof j.camera==='boolean'){if(j.camera===true){k.camera={};e(k);f(k);}else{k.camera=false;}}else if('camera'in j){k.camera=false;}else{s(k);e(k);f(k);}if(typeof j.animation==='boolean'){k.animation=j.animation;}else if('animation'in j){k.animation=false;}else{g(k);}if(typeof j.visibility==='object'&&j.visibility!==null){k.visibility={};if(j.visibility.mode===sap.ui.vk.VisibilityMode.Complete||j.visibility.mode===sap.ui.vk.VisibilityMode.Differences){k.visibility.mode=j.visibility.mode;}else{i(k);}}else if(typeof j.visibility==='boolean'){if(j.visibility===true){k.visibility={};i(k);}else{k.visibility=false;}}else if('visibility'in j){k.visibility=false;}else{h(k);i(k);}}return this._implementation.getViewInfo(k);};c.prototype.setViewInfo=function(v,j){if(this._implementation){this._implementation.setViewInfo(v,j);}else{q.sap.log.error('no implementation');}return this;};c.prototype.getImage=function(w,j,t,k,l){if(this._implementation&&this._implementation.getImage){return this._implementation.getImage(w,j,t,k,l);}return null;};C.injectMethodsIntoClass(c);a.injectMethodsIntoClass(c);return c;});\n",
	"sap/ui/vk/ViewportBase.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['sap/ui/core/Control'],function(C){'use strict';var V=C.extend('sap.ui.vk.ViewportBase',{metadata:{library:'sap.ui.vk','abstract':true,properties:{showDebugInfo:{type:'boolean',defaultValue:false},backgroundColorTop:{type:'sap.ui.core.CSSColor',defaultValue:'rgba(50, 50, 50, 1)'},backgroundColorBottom:{type:'sap.ui.core.CSSColor',defaultValue:'rgba(255, 255, 255, 1)'},width:{type:'sap.ui.core.CSSSize',defaultValue:'100%'},height:{type:'sap.ui.core.CSSSize',defaultValue:'100%'},selectionMode:{type:'sap.ui.vk.SelectionMode',defaultValue:sap.ui.vk.SelectionMode.Sticky},freezeCamera:{type:'boolean',defaultValue:false}},associations:{contentConnector:{type:'sap.ui.vk.ContentConnector',multiple:false},viewStateManager:{type:'sap.ui.vk.ViewStateManager',multiple:false},tools:{type:'sap.ui.vk.tools.Tool',multiple:true}},events:{urlClicked:{parameters:{nodeRef:'any',url:'string'},enableEventBubbling:true},nodeClicked:{parameters:{nodeRef:'any',x:'int',y:'int'},enableEventBubbling:true},resize:{parameters:{size:'object'}},nodesPicked:{parameters:{picked:{type:'any[]'}},enableEventBubbling:true},nodeZoomed:{parameters:{zoomed:{type:'any'},isZoomIn:{type:'boolean'}},enableEventBubbling:true}}}});var b=V.getMetadata().getParent().getClass().prototype;V.prototype.init=function(){if(b.init){b.init.call(this);}this._camera=null;};V.prototype.exit=function(){if(this._camera){if(this._contentConnector){var c=this._contentConnector.getContentManager();if(c){c.destroyCamera(this._camera);}this._camera=null;}}if(b.exit){b.exit.call(this);}};V.prototype.getImage=function(w,h){return null;};V.prototype.stickySelectionHandler=function(n){if(this._viewStateManager==null){return;}if(n.length===0){var c=[];this._viewStateManager.enumerateSelection(function(e){c.push(e);});if(c.length>0){this._viewStateManager.setSelectionStates([],c);}}else{var s=[];var d=[];var i=this._viewStateManager.getSelectionState(n);for(var a=0;a<i.length;a++){if(i[a]){d.push(n[a]);}else{s.push(n[a]);}}this._viewStateManager.setSelectionStates(s,d);}};V.prototype.exclusiveSelectionHandler=function(n){if(this._viewStateManager==null){return;}var a=true;if(n.length===1){a=!this._viewStateManager.getSelectionState(n[0]);}else if(n.length>1){var i=this._viewStateManager.getSelectionState(n);for(var c=0;c<i.length;c++){if(i[c]){a=false;break;}}}var u=[];if(n.length===0||a){this._viewStateManager.enumerateSelection(function(s){u.push(s);});}this._viewStateManager.setSelectionStates(n,u);};V.prototype.setCamera=function(c){if(c!==this._camera){if(this._camera&&this._contentConnector){var a=this._contentConnector.getContentManager();if(a){a.destroyCamera(this._camera);}}}this._camera=c;return this;};V.prototype.getCamera=function(){return this._camera;};V.prototype._onBeforeClearContentConnector=function(){this.setCamera(null);};V.prototype.activateView=function(v){return this;};return V;});\n",
	"sap/ui/vk/ViewportHandler.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var V=E.extend('sap.ui.vk.ViewportHandler',{metadata:{publicMethods:['beginGesture','move','endGesture','click','doubleClick','contextMenu','getViewport']},constructor:function(a){this._viewport=a;this._rect=null;this._evt={x:0,y:0,z:0,d:0,tdx:0,tdy:0,tdd:0,initd:0};this._gesture=false;this._viewport.attachEvent('resize',this,this._onresize);this._nomenu=false;}});V.prototype.destroy=function(){this._viewport=null;this._rect=null;this._evt=null;this._gesture=false;};V.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};V.prototype._inside=function(e){if(this._rect==null||true){var i=this._viewport.getIdForLabel();var d=document.getElementById(i);if(d==null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};}return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};V.prototype._onresize=function(e){this._gesture=false;this._rect=null;};V.prototype.beginGesture=function(a){if(this._inside(a)&&!this._gesture){this._gesture=true;var x=a.x-this._rect.x,y=a.y-this._rect.y;this._evt.tdx=0;this._evt.tdy=0;this._evt.tdd=0;this._evt.x=x;this._evt.y=y;this._evt.d=a.d;this._evt.initd=a.d;this._evt.avgd=a.d;this._evt.avgx=0;this._evt.avgy=0;q.sap.log.debug('Loco: beginGesture: '+x+', '+y);this._viewport.queueCommand(function(){this._viewport.beginGesture(x,y);}.bind(this));a.handled=true;if(document.activeElement){try{document.activeElement.blur();}catch(e){}}var d=document.getElementById(this._viewport.getIdForLabel());d.focus();}this._nomenu=false;};V.prototype.move=function(e){if(this._gesture){var x=e.x-this._rect.x,y=e.y-this._rect.y;var d=x-this._evt.x;var a=y-this._evt.y;var b=e.d-this._evt.d;this._evt.tdx=this._evt.tdx+d;this._evt.tdy=this._evt.tdy+a;this._evt.tdd=this._evt.tdd+b;this._evt.x=x;this._evt.y=y;this._evt.d=e.d;this._evt.avgx=this._evt.avgx*0.99+d*0.01;this._evt.avgy=this._evt.avgy*0.99+a*0.01;var z=1.0;if(this._evt.initd>0){z=1.0+b*(1.0/this._evt.initd);}else if(e.n==2){if(e.points[0].y>e.points[1].y){z=1.0-b*0.005;if(z<0.333){z=0.333;}}else{z=1.0+b*0.005;if(z>3){z=3;}}}if(this._evt.initd>0){var c=Math.sqrt(this._evt.avgx*this._evt.avgx+this._evt.avgy*this._evt.avgy);q.sap.log.debug('AvgDist: '+c);if((Math.abs(e.d-this._evt.avgd)/this._evt.avgd)<(c/10)){z=1.0;}}this._evt.avgd=this._evt.avgd*0.97+e.d*0.03;this._evt.n=e.n;switch(e.n){case 1:q.sap.log.debug('Loco: Rotate: '+(d)+', '+(a));this._viewport.queueCommand(function(){this._viewport.rotate(d,a);}.bind(this));break;case 2:q.sap.log.debug('Loco: Pan: '+(d)+', '+(a));if(z!=0&&z!=1.0){q.sap.log.debug('Loco: Zoom: '+(z));}this._viewport.queueCommand(function(){if(this._evt.tdx!==0&&this._evt.tdy!==0){this._viewport.pan(d,a);}if((d<10&&a<10&&z!=0&&z!=1.0)&&this._evt.tdd!==0){this._viewport.zoom(z);}}.bind(this));break;default:break;}this._nomenu=true;e.handled=true;}};V.prototype.endGesture=function(e){if(this._gesture){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug('Loco: endGesture: '+x+', '+y);this._viewport.queueCommand(function(){this._viewport.endGesture();}.bind(this));this._gesture=false;e.handled=true;}};V.prototype.click=function(e){if(this._inside(e)&&e.buttons<=1){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug('Loco: click: '+(x)+', '+(y));this._viewport.queueCommand(function(){this._viewport.tap(x,y,false);}.bind(this));e.handled=true;}};V.prototype.doubleClick=function(e){if(this._inside(e)&&e.buttons<=1){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug('Loco: doubleClick: '+(x)+', '+(y));this._viewport.queueCommand(function(){this._viewport.tap(x,y,true);}.bind(this));e.handled=true;}};V.prototype.contextMenu=function(e){if(this._inside(e)||this._nomenu||e.buttons==5){this._nomenu=false;e.handled=true;}};V.prototype.keyEventHandler=function(e){};V.prototype.getViewport=function(){return this._viewport;};return V;},true);\n",
	"sap/ui/vk/ViewportRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var V={};V.render=function(r,c){if(c._implementation){r.renderControl(c._implementation);}else{r.write('<div');r.writeControlData(c);r.addClass('sapVizKitViewport');r.writeClasses();r.writeAttribute('tabindex',0);r.writeAttribute('aria-label','Image');var a=false;var w=c.getWidth();if(w){r.addStyle('width',w);a=true;}var h=c.getHeight();if(h){r.addStyle('height',h);a=true;}if(a){r.writeStyles();}r.write('>');r.write('</div>');}};return V;},true);\n",
	"sap/ui/vk/dvl/BaseNodeProxy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../BaseNodeProxy'],function(q,l,B){'use strict';var g=sap.ui.vk.dvl.getJSONObject;var a=B.extend('sap.ui.vk.dvl.BaseNodeProxy',{metadata:{}});a.prototype.init=function(n,b){this._dvl=n?n.getGraphicsCore()._getDvl():null;this._dvlSceneRef=n?n.getSceneRef():null;this._dvlNodeRef=b;};a.prototype.reset=function(){this._dvlNodeRef=null;this._dvlSceneRef=null;this._dvl=null;};a.prototype.getNodeRef=function(){return this._dvlNodeRef;};a.prototype.getNodeId=function(){return this._dvlNodeRef;};a.prototype.getName=function(){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,this._dvlNodeRef,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_NAME)).NodeName;};a.prototype.getNodeMetadata=function(){return g(this._dvl.Scene.RetrieveMetadata(this._dvlSceneRef,this._dvlNodeRef)).metadata;};a.prototype.getHasChildren=function(){return(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,this._dvlNodeRef,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&(sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_MAPPED_HASCHILDREN|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED))===sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_MAPPED_HASCHILDREN;};a.prototype.getSceneRef=function(){return this._dvlNodeRef;};return a;});\n",
	"sap/ui/vk/dvl/ContentManager.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../DvlException','../Messages','../ContentManager'],function(q,D,M,C){'use strict';var a=C.extend('sap.ui.vk.dvl.ContentManager',{metadata:{library:'sap.ui.vk'}});var b=a.getMetadata().getParent().getClass().prototype;a.prototype.init=function(){if(b.init){b.init.call(this);}this._handleDownloadingProgressProxy=this._handleDownloadingProgress.bind(this);this._graphicsCore=null;this._failedSources=[];};a.prototype.exit=function(){if(this._graphicsCore){this._graphicsCore.destroy();this._graphicsCore=null;}if(b.exit){b.exit.call(this);}};var r={},w={antialias:true,alpha:true,premultipliedAlpha:true};a.getRuntimeSettings=function(){return r;};a.setRuntimeSettings=function(s){r=s;};a.getWebGLContextAttributes=function(){return w;};a.setWebGLContextAttributes=function(c){w=q.extend(w,c);};a.prototype._getGraphicsCore=function(){var t=this;return new Promise(function(c,d){if(t._graphicsCore){c(t._graphicsCore);}else{sap.ui.require(['sap/ui/vk/dvl/GraphicsCore'],function(G){t._graphicsCore=new G(r,w);t._graphicsCore.attachSceneLoadingStarted(t._handleDvlSceneLoadingStarted,t);t._graphicsCore.attachSceneLoadingFinished(t._handleDvlSceneLoadingFinished,t);t._graphicsCore.attachSceneLoadingProgress(t._handleDvlSceneLoadingProgress,t);c(t._graphicsCore);});}});};a.prototype._handleDownloadingProgress=function(e){var s=e.getParameter('source'),l=e.getParameter('loaded'),t=e.getParameter('total'),v=t?l/t*50:0;this.fireContentChangesProgress({phase:sap.ui.vk.getResourceBundle().getText('PROGRESS_INDICATOR_DOWNLOADING'),source:s,percentage:v});};a.prototype._handleDvlSceneLoadingProgress=function(e){this.fireContentChangesProgress({phase:sap.ui.vk.getResourceBundle().getText('PROGRESS_INDICATOR_RENDERING'),source:e.getParameter('source'),percentage:50+e.getParameter('percentage')*50});};a.prototype._handleDvlSceneLoadingStarted=function(e){};a.prototype._handleDvlSceneLoadingFinished=function(e){};a.prototype.loadContent=function(c,d){this.fireContentChangesStarted();var t=this;this._getGraphicsCore().then(function(g){g.setDecryptionHandler(t._decryptionHandler);g.loadContentResourcesAsync(d,function(s){var f=[];if(s){s.forEach(function(i){f.push({error:i,errorMessage:\"Failed to download source '\"+i.source+\"'.\"});});}var l=c?c:undefined;g.updateSceneTreeAsync(l,d).then(function(e){var h={content:e.scene};if(e.failureReason){f=f.concat(e.failureReason);}if(f.length>0){h.failureReason=f;}t.fireContentChangesFinished(h);}).catch(function(e){if(typeof e==='string'){f.push({error:e,errorMessage:e});}else{f.push({error:e,errorMessage:e.message?e.message:e.errorMessage});}t.fireContentChangesFinished({content:null,failureReason:f});});},t._handleDownloadingProgressProxy);},function(e){t.fireContentChangesFinished({content:null,failureReason:{error:e,errorMessage:'Failed to create DVL graphics core object.'}});});return this;};a.prototype.destroyContent=function(c){if(c){this._graphicsCore.destroyScene(c);}return this;};a.prototype.collectGarbage=function(){this._graphicsCore.collectGarbage();return this;};return a;});\n",
	"sap/ui/vk/dvl/GraphicsCore.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','sap/ui/base/EventProvider','../ve/thirdparty/html2canvas','../ve/dvl','./Scene','./NodeHierarchy','../ContentResource','../DownloadManager','./ViewStateManager','../DvlException','../Messages','sap/ui/thirdparty/URI'],function(q,l,E,H,D,S,N,C,a,V,b,M,U){'use strict';var c=q.sap.log;function g(e){return e instanceof File?'local':'remote';}function d(e){return e instanceof File?e.name:e;}var f=function(e){Object.defineProperties(this,{source:{value:e,writable:false,enumerable:true},_refCount:{value:0,writable:true,enumerable:false}});};f.prototype.isInUse=function(){return this._refCount>0;};f.prototype.addRef=function(){++this._refCount;return this;};f.prototype.release=function(){--this._refCount;return this;};f.prototype.destroy=function(){};var h=function(e,v,i){f.call(this,e);Object.defineProperties(this,{content:{value:i,writable:false,enumerable:true},vdsSourceDatum:{value:v,writable:false,enumerable:true}});};h.prototype=Object.create(f.prototype);h.prototype.constructor=h;h.prototype.destroy=function(){if(this.vdsSourceDatum){this.vdsSourceDatum.release();}f.prototype.destroy.call(this);};var j=function(e,i,m){Object.defineProperties(this,{dvlSceneId:{value:e,writable:false,enumerable:true},sourceDatum:{value:i,writable:false,enumerable:true},root:{value:!!m,writable:false,enumerable:true},_refCount:{value:0,writable:true,enumerable:false}});};j.prototype.isInUse=function(){return this._refCount>0;};j.prototype.addRef=function(){++this._refCount;return this;};j.prototype.release=function(){--this._refCount;return this;};j.prototype.destroy=function(){if(this.sourceDatum){this.sourceDatum.release();}};var k=function(e,i){Object.defineProperties(this,{source:{value:e.getSource()},sourceType:{value:e.getSourceType()},sourceId:{value:e.getSourceId(),writable:true},name:{value:e.getName()},localMatrix:{value:e.getLocalMatrix(),writable:true},password:{value:e.getPassword()},children:{value:e.getContentResources().map(function(e){return new k(e);})},dvlSceneDatum:{value:null,writable:true},nodeProxy:{value:null,writable:true},fake:{value:!!i},sourceProperties:{value:null,writable:true}});e._shadowContentResource=this;};k.prototype.destroy=function(){if(this.dvlSceneDatum){this.dvlSceneDatum.release();}};var n=function(v,e){Object.defineProperties(this,{vkScene:{value:v},shadowContentResource:{value:e}});};var G=E.extend('sap.ui.vk.dvl.GraphicsCore',{metadata:{publicMethods:['attachSceneLoadingFinished','attachSceneLoadingProgress','attachSceneLoadingStarted','buildSceneTree','buildSceneTreeAsync','createViewStateManager','destroyScene','destroyViewStateManager','detachSceneLoadingFinished','detachSceneLoadingProgress','detachSceneLoadingStarted','getApi','loadContentResourcesAsync','showDebugInfo','updateSceneTree','updateSceneTreeAsync']},constructor:function(e,w){E.apply(this);var i=q.extend({},e,{filePackagePrefixURL:q.sap.getResourcePath('sap/ve')+'/'});this._dvlClientId=q.sap.uid();this._dvl=sap.ve.dvl.createRuntime(i);this._dvl.CreateCoreInstance(this._dvlClientId);sap.ui.vk.dvl.checkResult(this._dvl.Core.Init(this._DVLMajorVersion,this._DVLMinorVersion));var u=sap.ui.getCore();u.attachLocalizationChanged(this._onlocalizationChanged,this);sap.ui.vk.dvl.checkResult(this._dvl.Core.SetLocale(u.getConfiguration().getLanguageTag()));this._canvas=this._createRenderingCanvasAndContext(w);this._rendererId=sap.ui.vk.dvl.getPointer(this._dvl.Core.CreateRenderer());this._dvl.Renderer.SetOptionF(sap.ve.dvl.DVLRENDEROPTIONF.DVLRENDEROPTIONF_DPI,96*window.devicePixelRatio,this._rendererId);this._sourceData=[];this._dvlSceneData=[];this._vkSceneData=[];this._viewports=[];this._renderLoopRequestId=null;this._renderLoopFunction=this._renderLoop.bind(this);this._viewStateManagers=[];},_DVLMajorVersion:7,_DVLMinorVersion:2});G.prototype.destroy=function(){sap.ui.getCore().detachLocalizationChanged(this._onlocalizationChanged,this);var v=this._viewports.slice();v.reverse();v.forEach(function(e){e.control.setGraphicsCore(null);});this._viewports=null;this._cleanupVkSceneData();this._vkSceneData=null;this._cleanupDvlSceneData();this._dvlSceneData=null;this._cleanupSourceData();this._sourceData=null;this._viewStateManagers.slice().forEach(this.destroyViewStateManager.bind(this));this._viewStateManagers=null;this._webGLContext=null;this._canvas=null;this._dvl.Core.DeleteRenderer(this._rendererId);this._rendererId=null;this._dvl.Core.Release();this._dvl=null;E.prototype.destroy.apply(this);};G.prototype._createRenderingCanvasAndContext=function(w){var e=document.createElement('canvas');e.id=q.sap.uid();this._webGLContext=this._dvl.Core.CreateWebGLContext(e,w);return e;};G.prototype._getCanvas=function(){return this._canvas;};G.prototype._getWebGLContext=function(){return this._webGLContext;};G.prototype._getDvl=function(){return this._dvl;};G.prototype._getDvlClientId=function(){return this._dvlClientId;};G.prototype._findSourceData=function(e){var i=Object.getOwnPropertyNames(e);return this._sourceData.filter(function(m){return i.every(function(t){return e[t]===m[t];});});};G.prototype._destroySourceDatum=function(e){if(!(e instanceof h)){this._dvl.Core.DeleteFileByUrl(d(e.source),g(e.source));}e.destroy();return this;};G.prototype._cleanupSourceData=function(){var e=false;for(var i=this._sourceData.length-1;i>=0;--i){var m=this._sourceData[i];if(!m.isInUse()){var t=m instanceof h?m.vdsSourceDatum:null;this._sourceData.splice(i,1);this._destroySourceDatum(m);if(t&&!t.isInUse()){e=true;}}}if(e){this._cleanupSourceData();}return this;};G.prototype._findDvlSceneData=function(e){var i=Object.getOwnPropertyNames(e);return this._dvlSceneData.filter(function(m){return i.every(function(t){return e[t]===m[t];});});};G.prototype._destroyDvlSceneDatum=function(e){this._dvl.Scene.Release(e.dvlSceneId);e.destroy();return this;};G.prototype._cleanupDvlSceneData=function(){for(var i=this._dvlSceneData.length-1;i>=0;--i){var e=this._dvlSceneData[i];if(!e.isInUse()){this._dvlSceneData.splice(i,1);this._destroyDvlSceneDatum(e);}}};G.prototype._findVkSceneData=function(e){var i=Object.getOwnPropertyNames(e);return this._vkSceneData.filter(function(m){return i.every(function(t){return e[t]===m[t];});});};G.prototype._cleanupVkSceneData=function(){for(var i=this._vkSceneData.length-1;i>=0;--i){this.destroyScene(this._vkSceneData[i].vkScene);}};G.prototype._destroyShadowContentResource=function(v,i){if(i.children){i.children.forEach(this._destroyShadowContentResource.bind(this,v));}if(i.nodeProxy){var m=v.getDefaultNodeHierarchy();try{m.removeNode(i.nodeProxy.getNodeRef());}catch(e){var t='Failed to delete node with ID = '+i.nodeProxy.getNodeRef()+'.';if(e instanceof b){t+=' Error code: '+e.code+'. Message: '+e.message+'.';}c.error(t);}m.destroyNodeProxy(i.nodeProxy);}i.destroy();};G.prototype._filterContentResources=function(e,i){var m=[];e.forEach(function enumerate(t){if(i(t)){m.push(t);}t.getContentResources().forEach(enumerate);});return m;};G.prototype._getContentResourcesWithMissingPasswords=function(i){var l=this._dvl.Library;return this._filterContentResources(i,function(m){var t=m.getSource();try{return t&&(sap.ui.vk.dvl.getJSONObject(l.RetrieveInfo(d(t),g(t))).flags&sap.ve.dvl.DVLFILEFLAG.ENCRYPTED)&&!m.getPassword();}catch(e){c.warning(\"Failed to get information from Emscripten virtual file system about file '\"+d(t)+\"'\");return false;}});};G.prototype._getContentResourcesWithEncryptedVds3=function(i){var l=this._dvl.Library;return this._filterContentResources(i,function(m){var t=m.getSource();if(t){try{var u=sap.ui.vk.dvl.getJSONObject(l.RetrieveInfo(d(t),g(t)));return u.major<=3&&(u.flags&sap.ve.dvl.DVLFILEFLAG.ENCRYPTED);}catch(e){c.warning(\"Failed to get information from Emscripten virtual file system about file '\"+d(t)+\"'\");return false;}}else{return false;}});};G.prototype._collectAndCheckSourceProperties=function(i){var m=i.dvlSceneDatum.sourceDatum;if(!m){return this;}try{if(m instanceof h){m=m.vdsSourceDatum;}var t=sap.ui.vk.dvl.getJSONObject(this._dvl.Library.RetrieveInfo(d(m.source),g(m.source)));i.sourceProperties={version:{major:t.major,minor:t.minor}};if(t.flags&(sap.ve.dvl.DVLFILEFLAG.PAGESCOMPRESSED|sap.ve.dvl.DVLFILEFLAG.WHOLEFILECOMPRESSED)){i.sourceProperties.compressed=true;}if(t.flags&sap.ve.dvl.DVLFILEFLAG.ENCRYPTED){i.sourceProperties.encrypted=true;}}catch(e){c.warning(\"Failed to get information from Emscripten virtual file system about file '\"+d(i.source)+\"'\");}return this;};G.prototype.loadContentResourcesAsync=function(e,i,t){var u=this,v=[],w=new Map();e.forEach(function enumerate(m){var A=m.getSource();if(A&&v.indexOf(A)<0&&u._findSourceData({source:A}).length===0){v.push(A);var B=m.getSource();var F;if(B instanceof Object){F=B.name;}else{F=B;}if(m.getSourceType()==='vdsl'||m.getSourceType()==='vds'&&F.split('.').pop()==='vdsl'){w.set(A,{});}}m.getContentResources().forEach(enumerate);});var x=[];if(v.length>0){var y;var z=new a(v).attachItemSucceeded(function(A){var B=A.getParameter('source');var F=A.getParameter('response');if(w.has(B)){var I=sap.ui.vk.utf8ArrayBufferToString(F);if(I.trim().length===0){y=y||[];y.push({source:B,status:M.VIT22.code,statusText:sap.ui.vk.getResourceBundle().getText(M.VIT22.summary)});c.error(sap.ui.vk.getResourceBundle().getText(M.VIT22.summary),M.VIT22.code,'sap.ui.vk.dvl.GraphicsCore');return;}else{var J=I.split(/\\n|\\r\\n/);var m=J[0].match(/^file=(.+)$/);if(!m){y=y||[];y.push({source:B,status:M.VIT23.code,statusText:sap.ui.vk.getResourceBundle().getText(M.VIT23.summary)});c.error(sap.ui.vk.getResourceBundle().getText(M.VIT23.summary),M.VIT23.code,'sap.ui.vk.dvl.GraphicsCore');return;}else{var K=w.get(B);K.content=J;var L=m[1];var O=L;var P=new U(O);if(P.is('relative')){if(B instanceof File){y=y||[];y.push({source:B,status:M.VIT24.code,statusText:sap.ui.vk.getResourceBundle().getText(M.VIT24.summary)});c.error(sap.ui.vk.getResourceBundle().getText(M.VIT24.summary),M.VIT24.code,'sap.ui.vk.dvl.GraphicsCore');return;}else{var Q=new U(B);L=P.absoluteTo(Q).href();}}K.referencedSource=L;K.content[0]=K.content[0].replace(O,this._dvl.Core.GetFilename(K.referencedSource,'remote'));if(v.indexOf(K.referencedSource)<0&&this._findSourceData({source:K.referencedSource}).length===0){v.push(K.referencedSource);z.queue(K.referencedSource);}}}}else{var R=B instanceof File;var T=R?B.name:B;var W=g(B);this._dvl.Core.CreateFileFromArrayBuffer(F,T,W);x.push(new f(B));}},this).attachAllItemsCompleted(function(m){Array.prototype.push.apply(this._sourceData,x);w.forEach(function(A,B){var F=this._findSourceData({source:A.referencedSource})[0];var I=new h(B,F,A.content.join('\\n'));this._sourceData.push(I);F.addRef();}.bind(this));if(i){i(y);}},this).attachItemFailed(function(m){y=y||[];y.push({source:m.getParameter('source'),status:m.getParameter('status'),statusText:m.getParameter('statusText')});},this);if(t){z.attachItemProgress(t,this);}z.start();}else if(i){i();}return this;};G.prototype._buildPlaceholders=function(e,i,m,t){var u=[];t.forEach(function build(i,m,v){var w=e.createNode(i,v.name,m);v.nodeProxy=e.createNodeProxy(w);if(v.localMatrix){v.nodeProxy.setLocalMatrix(v.localMatrix);}if(v.source){u.push(v);}v.children.forEach(build.bind(this,w,null));}.bind(this,i,m));return u;};G.prototype._updatePlaceholders=function(v,e,m){var t=this,u=v.getDefaultNodeHierarchy(),w=[];(function update(x,m,y){function z(F,I){if(!F&&!I){return true;}else if(!!F^!!I){return false;}else{return F.source===I.getSource()&&F.sourceType===I.getSourceType()&&F.name===I.getName()&&F.password===I.getPassword();}}function A(F,I){I._shadowContentResource=F;F.sourceId=I.getSourceId();F.localMatrix=I.getLocalMatrix();if(F.nodeProxy){F.nodeProxy.setLocalMatrix(F.localMatrix);}}var i=0;var B=q.sap.arrayDiff(x,m,z,true);B.forEach(function(F){for(;i<F.index;++i){update(x[i].children,m[i].getContentResources(),x[i].nodeProxy.getNodeRef());A(x[i],m[i]);}if(F.type==='delete'){t._destroyShadowContentResource(v,x[F.index]);x.splice(F.index,1);}else if(F.type==='insert'){var I;if(i<x.length&&x[i].nodeProxy){I=x[i].nodeProxy.getNodeRef();}var J=new k(m[F.index]);w=w.concat(t._buildPlaceholders(u,y,I,[J]));x.splice(F.index,0,J);++i;}});for(;i<x.length;++i){update(x[i].children,m[i].getContentResources(),x[i].nodeProxy&&x[i].nodeProxy.getNodeRef());A(x[i],m[i]);}})(e.fake?e.children:[e],m,null);return w;};G.prototype._loadAndMergeContentResource=function(i,m){if(m.source){var t=this._findSourceData({source:m.source})[0];if(!t){c.warning(\"Failed to load content resource with sourceId '\"+m.sourceId+\"' due to failed downloading from URL '\"+d(m.source)+\"'.\");}else{var u=m.nodeProxy.getNodeRef();var v=this._findDvlSceneData({sourceDatum:t,root:false})[0];if(!v){try{v=new j(sap.ui.vk.dvl.getPointer(t instanceof h?this._dvl.Core.LoadSceneFromVDSL(t.content,m.password):this._dvl.Core.LoadSceneByUrl(d(m.source),m.password,g(m.source))),t,false);}catch(e){c.error(sap.ui.vk.getResourceBundle().getText(M.VIT34.summary)+': '+d(m.source),M.VIT34.code,'sap.ui.vk.dvl.GraphicsCore');return;}this._dvlSceneData.push(v);t.addRef();}m.dvlSceneDatum=v;v.addRef();this._collectAndCheckSourceProperties(m);this._dvl.Renderer.ResetView(sap.ve.dvl.DVLRESETVIEWFLAG.CAMERA,this._rendererId);this._dvl.Scene.Merge(i._dvlSceneRef,v.dvlSceneId,u);}}};G.prototype.buildSceneTree=function(i){if(i.length===0){return null;}var m;var t;var u=i.map(function(y){return new k(y);});if(u.length===1&&u[0].name==null){t=u[0];if(t.source){var v=this._findSourceData({source:t.source})[0];try{m=new j(sap.ui.vk.dvl.getPointer(v instanceof h?this._dvl.Core.LoadSceneFromVDSL(v.content,t.password):this._dvl.Core.LoadSceneByUrl(d(t.source),t.password,g(t.source))),v,true);}catch(e){c.error(sap.ui.vk.getResourceBundle().getText(M.VIT34.summary)+': '+d(t.source),M.VIT34.code,'sap.ui.vk.dvl.GraphicsCore');return null;}v.addRef();}else{m=new j(this._dvl.Core.CreateEmptyScene(),null,true);}}else{var w=new C({sourceType:'vds',sourceId:q.sap.uid()});t=new k(w,true);w.destroy();w=null;Array.prototype.push.apply(t.children,u);u=[t];m=new j(this._dvl.Core.CreateEmptyScene(),null,true);}this._dvlSceneData.push(m);t.dvlSceneDatum=m;m.addRef();this._collectAndCheckSourceProperties(t);var x=new S(this,m.dvlSceneId);this._vkSceneData.push(new n(x,t));this._buildPlaceholders(x.getDefaultNodeHierarchy(),null,null,t.children).forEach(this._loadAndMergeContentResource.bind(this,x.getDefaultNodeHierarchy()));return x;};G.prototype.updateSceneTree=function(v,e,i){if(e.length===0){return null;}var m;var t=this._getContentResourcesWithEncryptedVds3(e);if(t.length>0){c.error(sap.ui.vk.getResourceBundle().getText(M.VIT25.summary),M.VIT25.code,'sap.ui.vk.dvl.GraphicsCore');m=m||{};m.contentResourcesWithEncryptedVds3=t;}var u=this._getContentResourcesWithMissingPasswords(e);if(u.length>0){c.error(sap.ui.vk.getResourceBundle().getText(M.VIT21.summary),M.VIT21.code,'sap.ui.vk.dvl.GraphicsCore');m=m||{};m.contentResourcesWithMissingPasswords=u;}if(m&&i){i(m);}if(!v){return this.buildSceneTree(e);}var w=this._findVkSceneData({vkScene:v})[0].shadowContentResource;var x=!!w.source;var y=e.length===1&&!!e[0].getSource();if(!(x&&y&&w.source===e[0].getSource()||!x&&!y&&w.fake===e.length>1)||!w.fake&&e.length===1&&w.name!==e[0].getName()){return this.buildSceneTree(e);}this._updatePlaceholders(v,w,e).forEach(this._loadAndMergeContentResource.bind(this,v.getDefaultNodeHierarchy()));v.getDefaultNodeHierarchy().fireChanged();return v;};G.prototype._loadDvlSceneAsync=function(i,m){return new Promise(function(t,u){var v;var w=function(z){v();this.fireSceneLoadingFinished({source:i.source,sceneId:z.sceneId});t(z.sceneId);};var x=function(z){v();var A=z.errorMessage;if(A==null){A=sap.ve.dvl.DVLRESULT.getDescription?sap.ve.dvl.DVLRESULT.getDescription(z.errorCode):'';}var B={source:i.source,errorCode:z.errorCode,errorMessage:A};this.fireSceneLoadingFinished(B);u(B);};var y=function(z,A){this.fireSceneLoadingProgress({source:d(i.source),percentage:A});return true;}.bind(this);v=function(){this._dvl.Client.NotifyFileLoadProgress=null;this._dvl.Client.detachSceneFailed(x,this);this._dvl.Client.detachSceneLoaded(w,this);}.bind(this);this._dvl.Client.attachSceneLoaded(w,this);this._dvl.Client.attachSceneFailed(x,this);this._dvl.Client.NotifyFileLoadProgress=y;this.fireSceneLoadingStarted({source:d(i.source)});try{sap.ui.vk.dvl.checkResult(i instanceof h?this._dvl.Core.LoadSceneFromVDSLAsync(i.content,m):this._dvl.Core.LoadSceneByUrlAsync(d(i.source),m,g(i.source)));}catch(e){v();x.call(this,{errorCode:e instanceof b?e.code:sap.ve.dvl.DVLRESULT.FAIL,errorMessage:e instanceof b?null:e});}}.bind(this));};var o=function(e,i){return new Promise(function(m){(function step(t){if(t>=e.length){m();}else{i(e[t]).catch(function(){}).then(function(){step(t+1);});}})(0);});};G.prototype._loadAndMergeContentResourcesAsync=function(e,i){var m,t=this;return o(i,function(u){if(u.source){var v=t._findSourceData({source:u.source})[0];if(!v){var w=\"Failed to load content resource with sourceId '\"+u.sourceId+\"' due to failed downloading from URL '\"+d(u.source)+\"'.\";c.warning(w);m=m||[];m.push({errorMessage:w,source:u.source});return Promise.reject();}return(function(){var x=t._findDvlSceneData({sourceDatum:v,root:false})[0];if(x){return Promise.resolve(x);}else{return t._loadDvlSceneAsync(v,u.password).then(function(y){x=new j(y,v,false);t._dvlSceneData.push(x);v.addRef();return Promise.resolve(x);},function(y){m=m||[];m.push(y);return Promise.reject();});}})().then(function(x){u.dvlSceneDatum=x;x.addRef();t._collectAndCheckSourceProperties(u);var y=u.nodeProxy.getNodeRef();t._dvl.Renderer.ResetView(sap.ve.dvl.DVLRESETVIEWFLAG.CAMERA,t._rendererId);t._dvl.Scene.Merge(e._dvlSceneRef,x.dvlSceneId,y);return Promise.resolve();});}return Promise.resolve();}).then(function(){return Promise.resolve(m);});};G.prototype.buildSceneTreeAsync=function(e){if(e.length===0){return Promise.resolve(null);}var i=e.map(function(m){return new k(m);});return function(){var m;if(i.length===1&&i[0].name==null){m=i[0];if(m.source){var t=this._findSourceData({source:m.source})[0];if(t){return this._loadDvlSceneAsync(t,m.password).then(function(v){var w=new j(v,t,true);t.addRef();return Promise.resolve({shadowContentResource:m,dvlSceneDatum:w});});}else{return Promise.reject({errorMessage:'Failed to download the root content resource.',source:m.source});}}return Promise.resolve({shadowContentResource:m,dvlSceneDatum:new j(this._dvl.Core.CreateEmptyScene(),null,true)});}else{var u=new C({sourceType:'vds',sourceId:q.sap.uid()});m=new k(u,true);u.destroy();u=null;Array.prototype.push.apply(m.children,i);i=[m];return Promise.resolve({shadowContentResource:m,dvlSceneDatum:new j(this._dvl.Core.CreateEmptyScene(),null,true)});}}.call(this).then(function(m){this._dvlSceneData.push(m.dvlSceneDatum);m.shadowContentResource.dvlSceneDatum=m.dvlSceneDatum;m.dvlSceneDatum.addRef();this._collectAndCheckSourceProperties(m.shadowContentResource);var v=new S(this,m.dvlSceneDatum.dvlSceneId);this._vkSceneData.push(new n(v,m.shadowContentResource));var t=v.getDefaultNodeHierarchy();return this._loadAndMergeContentResourcesAsync(t,this._buildPlaceholders(v.getDefaultNodeHierarchy(),null,null,m.shadowContentResource.children)).then(function(u){return Promise.resolve({scene:v,failureReason:u});});}.bind(this));};G.prototype.updateSceneTreeAsync=function(v,e){if(e.length===0){return Promise.resolve(null);}var i=this._getContentResourcesWithEncryptedVds3(e);if(i.length>0){c.error(sap.ui.vk.getResourceBundle().getText(M.VIT25.summary),M.VIT25.code,'sap.ui.vk.dvl.GraphicsCore');}var m=this._getContentResourcesWithMissingPasswords(e);if(m.length>0){c.error(sap.ui.vk.getResourceBundle().getText(M.VIT21.summary),M.VIT21.code,'sap.ui.vk.dvl.GraphicsCore');}if(!v){return this.buildSceneTreeAsync(e);}var t=this._findVkSceneData({vkScene:v})[0].shadowContentResource;var u=!!t.source;var w=e.length===1&&!!e[0].getSource();if(!(u&&w&&t.source===e[0].getSource()||!u&&!w&&t.fake===e.length>1)||!t.fake&&e.length===1&&t.name!==e[0].getName()){return this.buildSceneTreeAsync(e);}return new Promise(function(x,y){var z=v.getDefaultNodeHierarchy();this._loadAndMergeContentResourcesAsync(z,this._updatePlaceholders(v,t,e)).then(function(A){x({scene:v,failureReason:A});z.fireChanged();});}.bind(this));};G.prototype.destroyScene=function(v){var e;for(e=0;e<this._vkSceneData.length;++e){if(this._vkSceneData[e].vkScene===v){break;}}if(e===this._vkSceneData.length){c.warning(\"Scene with id '\"+v.getId()+\"' is not created by this GraphicsCore.\");return this;}var i=this._vkSceneData.splice(e,1)[0];this._destroyShadowContentResource(v,i.shadowContentResource);v.destroy();return this;};var p=function(e,m,t){for(var i=0,u=e.length;i<u;++i){if(m.call(t,e[i],i,e)){return i;}}return-1;};var r=function(v,e){return p(v,function(i){return i.control===e;});};var s=function(v,e){return p(v,function(i){return i.rendererId===e;});};G.prototype._registerViewport=function(v){if(r(this._viewports,v)>=0){return false;}var e={control:v,canvas:null,rendererId:null};if(this._viewports.length===0){e.canvas=this._canvas;e.rendererId=this._rendererId;this._startRenderLoop();}else{if(this._viewports.length===1){var i=this._viewports[0];i.control._setCanvas(i.canvas=document.createElement('canvas'));this._dvl.Client.attachFrameFinished(this._handleFrameFinished,this);}e.canvas=document.createElement('canvas');e.rendererId=this._dvl.Core.CreateRenderer();}v._setCanvas(e.canvas);v._setRenderer(e.rendererId);v.attachResize(this._handleViewportResize,this);this._viewports.push(e);return true;};G.prototype._deregisterViewport=function(v){var i=r(this._viewports,v);if(i<0){return false;}var e=this._viewports.splice(i,1)[0];if(this._viewports.length===0){this._stopRenderLoop();}else{if(this._viewports.length===1){this._dvl.Client.detachFrameFinished(this._handleFrameFinished,this);var m=this._viewports[1-i];m.control._setCanvas(m.canvas=this._canvas);}this._dvl.Core.DeleteRenderer(e.rendererId);}v.detachResize(this._handleViewportResize,this);v._setRenderer(null);v._setCanvas(null);return true;};G.prototype._getViewportCount=function(){return this._viewports.length;};G.prototype._handleViewportResize=function(e){if(this._viewports.length>1){this._canvas.width=Math.max.apply(null,this._viewports.map(function(v){return v.canvas.width;}));this._canvas.height=Math.max.apply(null,this._viewports.map(function(v){return v.canvas.height;}));}};G.prototype._startRenderLoop=function(){if(!this._renderLoopRequestId){this._renderLoopRequestId=window.requestAnimationFrame(this._renderLoopFunction);}return this;};G.prototype._stopRenderLoop=function(){if(this._renderLoopRequestId){window.cancelAnimationFrame(this._renderLoopRequestId);this._renderLoopRequestId=null;}return this;};G.prototype._renderLoop=(function(){var e;return function(){var m=this._viewports.length>1;this._viewports.forEach(function(v){var i=v.canvas,t=v.rendererId;this._dvl.Renderer._processCommandQueue(t);if(i.width>0&&i.height>0&&this._dvl.Renderer.ShouldRenderFrame(t)){if(m&&e!==t){this._dvl.Renderer.SetDimensions(i.width,i.height,t);}v.control.renderFrame();e=t;}},this);this._renderLoopRequestId=window.requestAnimationFrame(this._renderLoopFunction);};})();G.prototype._handleFrameFinished=function(e){if(this._viewports.length>1){var i=s(this._viewports,e.rendererId);if(i>=0){var t=this._viewports[i].canvas,m=t.getContext('2d'),u=t.width,v=t.height;m.drawImage(this._canvas,0,this._canvas.height-v,u,v,0,0,u,v);}}};G.prototype.createViewStateManager=function(e,i){var v=new sap.ui.vk.dvl.ViewStateManager();v._setNodeHierarchy(e).setShouldTrackVisibilityChanges(i);this._viewStateManagers.push(v);return v;};G.prototype.destroyViewStateManager=function(v){var i=this._viewStateManagers.indexOf(v);if(i>=0){this._viewStateManagers.splice(i,1)[0].destroy();}return this;};G.prototype.showDebugInfo=function(e){this._viewports.forEach(function(v){v.control.setShowDebugInfo(e);});return this;};G.prototype.getApi=function(e){switch(e){case sap.ui.vk.dvl.GraphicsCoreApi.LegacyDvl:return this._dvl;default:return null;}};G.prototype.collectGarbage=function(){this._cleanupDvlSceneData();this._cleanupSourceData();return this;};G.prototype._onlocalizationChanged=function(e){if(e.getParameter('changes').language){sap.ui.vk.dvl.checkResult(this._dvl.Core.SetLocale(sap.ui.getCore().getConfiguration().getLanguageTag()));}};G.prototype.setDecryptionHandler=function(e){this._dvl.Client.setDecryptionHandler(e);return this;};G.prototype.getDecryptionHandler=function(){return this._dvl.Client.getDecryptionHandler();};G.prototype.attachSceneLoadingFinished=function(e,i,m){return this.attachEvent('sceneLoadingFinished',e,i,m);};G.prototype.detachSceneLoadingFinished=function(e,i){return this.detachEvent('sceneLoadingFinished',e,i);};G.prototype.fireSceneLoadingFinished=function(e,i,m){return this.fireEvent('sceneLoadingFinished',e,i,m);};G.prototype.attachSceneLoadingProgress=function(e,i,m){return this.attachEvent('sceneLoadingProgress',e,i,m);};G.prototype.detachSceneLoadingProgress=function(e,i){return this.detachEvent('sceneLoadingProgress',e,i);};G.prototype.fireSceneLoadingProgress=function(e,i,m){return this.fireEvent('sceneLoadingProgress',e,i,m);};G.prototype.attachSceneLoadingStarted=function(e,i,m){return this.attachEvent('sceneLoadingStarted',e,i,m);};G.prototype.detachSceneLoadingStarted=function(e,i){return this.detachEvent('sceneLoadingStarted',e,i);};G.prototype.fireSceneLoadingStarted=function(e,i,m){return this.fireEvent('sceneLoadingStarted',e,i,m);};return G;});\n",
	"sap/ui/vk/dvl/LayerProxy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../LayerProxy'],function(q,l,L){'use strict';var g=sap.ui.vk.dvl.getJSONObject;var a=L.extend('sap.ui.vk.dvl.LayerProxy',{metadata:{publicMethods:['getDescription','getLayerId','getLayerMetadata','getName','getNodes','getVeIds']},constructor:function(n,b){L.call(this);this._dvl=n?n.getGraphicsCore()._getDvl():null;this._dvlSceneRef=n?n.getSceneRef():null;this._dvlLayerId=b;}});a.prototype.destroy=function(){this._dvlLayerId=null;this._dvlSceneRef=null;this._dvl=null;L.prototype.destroy.call(this);};a.prototype.getLayerId=function(){return this._dvlLayerId;};a.prototype.getVeIds=function(){return g(this._dvl.Scene.RetrieveVEIDs(this._dvlSceneRef,this._dvlLayerId));};a.prototype.getName=function(){return g(this._dvl.Scene.RetrieveLayerInfo(this._dvlSceneRef,this._dvlLayerId)).name;};a.prototype.getDescription=function(){return g(this._dvl.Scene.RetrieveLayerInfo(this._dvlSceneRef,this._dvlLayerId)).description;};a.prototype.getLayerMetadata=function(){return g(this._dvl.Scene.RetrieveMetadata(this._dvlSceneRef,this._dvlLayerId)).metadata;};a.prototype.getNodes=function(){return g(this._dvl.Scene.RetrieveLayerInfo(this._dvlSceneRef,this._dvlLayerId)).nodes;};return a;});\n",
	"sap/ui/vk/dvl/NodeHierarchy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../NodeHierarchy','sap/ui/base/ObjectPool','./BaseNodeProxy','./NodeProxy','./LayerProxy','../Messages','../DvlException'],function(q,l,N,O,B,a,L,M,D){'use strict';var g=sap.ui.vk.dvl.getJSONObject;var b=q.sap.log;var s={modeDictionary:{equals:function(i){return i?sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_EQUAL:sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_EQUAL_CASE_INSENSITIVE;},contains:function(i){return i?sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_SUBSTRING:sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_SUBSTRING_CASE_INSENSITIVE;},startsWith:function(i){return i?sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_STARTS_WITH:sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_STARTS_WITH_CASE_INSENSITIVE;}}};var c=N.extend('sap.ui.vk.dvl.NodeHierarchy',{metadata:{},_baseNodeProxyPool:new O(B),constructor:function(d){N.call(this);this._graphicsCore=d.getGraphicsCore();this._scene=d;this._dvlSceneRef=this._scene.getSceneRef();this._dvl=this._graphicsCore._getDvl();this._nodeProxies=[];this._layerProxies=[];}});c.prototype.destroy=function(){this._layerProxies.slice().forEach(this.destroyLayerProxy,this);this._nodeProxies.slice().forEach(this.destroyNodeProxy,this);this._dvl=null;this._dvlSceneRef=null;this._scene=null;this._graphicsCore=null;N.prototype.destroy.call(this);};c.prototype.getGraphicsCore=function(){return this._graphicsCore;};c.prototype.getScene=function(){return this._scene;};c.prototype.getSceneRef=function(){return this._dvlSceneRef;};c.prototype.enumerateChildren=function(n,d,e,p){if(typeof n==='function'){p=e;e=d;d=n;n=undefined;}var f;if(n){if(e||(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED)===0){f=g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN)).ChildNodes;}else{f=[];}}else{f=g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneRef,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_CHILDREN)).ChildNodes;}if(p){f.forEach(d);}else{var h=this._baseNodeProxyPool.borrowObject();try{f.forEach(function(n){h.init(this,n);d(h);h.reset();}.bind(this));}finally{this._baseNodeProxyPool.returnObject(h);}}return this;};c.prototype.enumerateAncestors=function(n,d,p){var e=g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_PARENTS)).ParentNodes;if(p){e.forEach(d);}else{var f=this._baseNodeProxyPool.borrowObject();try{e.forEach(function(n){f.init(this,n);d(f);f.reset();}.bind(this));}finally{this._baseNodeProxyPool.returnObject(f);}}return this;};c.prototype.createNodeProxy=function(n){var d=new a(this,n);this._nodeProxies.push(d);return d;};c.prototype.destroyNodeProxy=function(n){var i=this._nodeProxies.indexOf(n);if(i>=0){this._nodeProxies.splice(i,1)[0].destroy();}return this;};c.prototype.getChildren=function(n,d){if(typeof n==='boolean'){d=n;n=undefined;}if(n){if(d||(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED)===0){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN)).ChildNodes;}else{return[];}}else{return g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneRef,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_CHILDREN)).ChildNodes;}};c.prototype.getAncestors=function(n){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_PARENTS)).ParentNodes;};c.prototype.findNodesByName=function(d){var e=sap.ve.dvl.DVLFINDNODETYPE.DVLFINDNODETYPE_NODE_NAME,f=[],h,j;if(d===undefined||d===null||q.isEmptyObject(d)){h=s.modeDictionary.contains(false);j=[''];}else{if(d.value===undefined||d.value===null||d.value===''){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT6.summary),M.VIT6.code,'sap.ui.vk.dvl.NodeHierarchy');return[];}var p=d.hasOwnProperty('predicate')?d.predicate:'equals';if(p===undefined||p===null||p===''){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT7.summary),M.VIT7.code,'sap.ui.vk.dvl.NodeHierarchy');return[];}else if(['equals','contains','startsWith'].indexOf(p)===-1){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT8.summary),M.VIT8.code,'sap.ui.vk.dvl.NodeHierarchy');return[];}h=s.modeDictionary[p](d.caseSensitive);j=(typeof d.value==='string')?[d.value]:d.value;}for(var i=0;i<j.length;i++){f=f.concat(g(this._dvl.Scene.FindNodes(this._dvlSceneRef,e,h,j[i])).nodes);}return q.sap.unique(f);};c.prototype.createLayerProxy=function(d){var e=new L(this,d);this._layerProxies.push(e);return e;};c.prototype.destroyLayerProxy=function(d){var i=this._layerProxies.indexOf(d);if(i>=0){this._layerProxies.splice(i,1)[0].destroy();}return this;};c.prototype.getLayers=function(){return g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneRef,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_LAYERS)).Layers;};c.prototype.getHotspotNodeIds=function(){var h=g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneRef,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_HOTSPOTS).ChildNodes);return h.length>0?h:this._getLegacyHotspotNodeIds();};c.prototype._getLegacyHotspotNodeIds=function(){var d=this.getLayers(),h=[];for(var i=0;i<d.length;i++){var e=this.createLayerProxy(d[i]),f=e.getName();if(f.toLowerCase()==='hotspots'){h=e.getNodes();this.destroyLayerProxy(e);break;}this.destroyLayerProxy(e);}return h;};c.prototype.createNode=function(p,n,i){var d=this._dvl.Scene.CreateNode(this._dvlSceneRef,p,n,i);this.fireNodeCreated({nodeRef:d,nodeId:d});this.fireChanged();return d;};c.prototype.createNodeCopy=function(n,p,d,i){var e=this._dvl.Scene.CreateNodeCopy(this._dvlSceneRef,n,p,sap.ve.dvl.DVLCREATENODECOPYFLAG.COPY_CHILDREN,d,i);this.fireNodeCreated({nodeRef:e,nodeId:e});this.fireChanged();return e;};c.prototype.removeNode=function(n){var d=[].concat(n);d.forEach(function(n){this.fireNodeRemoving({nodeRef:n,nodeId:n});try{sap.ui.vk.dvl.checkResult(this._dvl.Scene.DeleteNode(this._dvlSceneRef,n));}catch(e){var m='Failed to delete node with ID = '+n+'.';if(e instanceof D){m+=' Error code: '+e.code+'. Message: '+e.message+'.';}b.error(m);}}.bind(this));this.fireChanged();return this;};return c;});\n",
	"sap/ui/vk/dvl/NodeProxy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../NodeProxy'],function(q,l,N){'use strict';var g=sap.ui.vk.dvl.getJSONObject;var a=N.extend('sap.ui.vk.dvl.NodeProxy',{metadata:{},constructor:function(n,b){N.call(this);this._dvl=n?n.getGraphicsCore()._getDvl():null;this._dvlSceneRef=n?n.getSceneRef():null;this._dvlNodeRef=b;}});a.prototype.destroy=function(){this._dvlNodeRef=null;this._dvlSceneRef=null;this._dvl=null;N.prototype.destroy.call(this);};a.prototype.getNodeRef=function(){return this._dvlNodeRef;};a.prototype.getNodeId=function(){return this._dvlNodeRef;};a.prototype.getVeIds=function(){return g(this._dvl.Scene.RetrieveVEIDs(this._dvlSceneRef,this._dvlNodeRef));};a.prototype.getName=function(){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,this._dvlNodeRef,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_NAME)).NodeName;};a.prototype.getLocalMatrix=function(){return sap.ui.vk.TransformationMatrix.convertTo4x3(g(this._dvl.Scene.GetNodeLocalMatrix(this._dvlSceneRef,this._dvlNodeRef)).matrix);};a.prototype.setLocalMatrix=function(v){this._dvl.Scene.SetNodeLocalMatrix(this._dvlSceneRef,this._dvlNodeRef,v&&sap.ui.vk.TransformationMatrix.convertTo4x4(v));this.setProperty('localMatrix',v,true);return this;};a.prototype.getWorldMatrix=function(){return sap.ui.vk.TransformationMatrix.convertTo4x3(g(this._dvl.Scene.GetNodeWorldMatrix(this._dvlSceneRef,this._dvlNodeRef)).matrix);};a.prototype.setWorldMatrix=function(v){this._dvl.Scene.SetNodeWorldMatrix(this._dvlSceneRef,this._dvlNodeRef,v&&sap.ui.vk.TransformationMatrix.convertTo4x4(v));this.setProperty('worldMatrix',v,true);return this;};a.prototype.getOpacity=function(){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,this._dvlNodeRef,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_OPACITY)).Opacity;};a.prototype.setOpacity=function(v){this._dvl.Scene.SetNodeOpacity(this._dvlSceneRef,this._dvlNodeRef,v);this.setProperty('opacity',v,true);return this;};a.prototype.getTintColorABGR=function(){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,this._dvlNodeRef,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_HIGHLIGHT_COLOR)).HighlightColor;};a.prototype.setTintColorABGR=function(v){this._dvl.Scene.SetNodeHighlightColor(this._dvlSceneRef,this._dvlNodeRef,v);this.setProperty('tintColorABGR',v,true);this.setProperty('tintColor',sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(v)),true);return this;};a.prototype.getTintColor=function(){return sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(this.getTintColorABGR()));};a.prototype.setTintColor=function(v){var b=sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(v));this._dvl.Scene.SetNodeHighlightColor(this._dvlSceneRef,this._dvlNodeRef,b);this.setProperty('tintColorABGR',b,true);this.setProperty('tintColor',v,true);return this;};a.prototype.getNodeMetadata=function(){return g(this._dvl.Scene.RetrieveMetadata(this._dvlSceneRef,this._dvlNodeRef)).metadata;};a.prototype.getHasChildren=function(){return(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,this._dvlNodeRef,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&(sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_MAPPED_HASCHILDREN|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED))===sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_MAPPED_HASCHILDREN;};a.prototype.getClosed=function(){return(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,this._dvlNodeRef,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED)!==0;};return a;});\n",
	"sap/ui/vk/dvl/Scene.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../Scene','./NodeHierarchy'],function(q,l,S,N){'use strict';var a=S.extend('sap.ui.vk.dvl.Scene',{metadata:{},constructor:function(g,d){S.call(this);this._id=q.sap.uid();this._graphicsCore=g;this._dvlSceneRef=d;this._defaultNodeHierarchy=null;}});a.prototype.destroy=function(){if(this._defaultNodeHierarchy){this._defaultNodeHierarchy.destroy();this._defaultNodeHierarchy=null;}this._dvlSceneRef=null;this._graphicsCore=null;S.prototype.destroy.call(this);};a.prototype.getId=function(){return this._id;};a.prototype.getGraphicsCore=function(){return this._graphicsCore;};a.prototype.getDefaultNodeHierarchy=function(){if(!this._defaultNodeHierarchy){this._defaultNodeHierarchy=new N(this);}return this._defaultNodeHierarchy;};a.prototype.getSceneRef=function(){return this._dvlSceneRef;};a.prototype.setDoubleSided=function(v){this.setProperty('doubleSided',v,true);this._graphicsCore._dvl.Renderer.SetOption(sap.ve.dvl.DVLRENDEROPTION.DVLRENDEROPTION_SHOW_BACKFACING,v);return this;};return a;});\n",
	"sap/ui/vk/dvl/ViewStateManager.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/Element','../ContentConnector','../ViewStateManagerBase'],function(q,E,C,V){'use strict';var a;var b=V.extend('sap.ui.vk.dvl.ViewStateManager',{metadata:{}});var c=b.getMetadata().getParent().getClass().prototype;b.prototype.init=function(){if(c.init){c.init.call(this);}this._nodeHierarchy=null;this._dvl=null;this._nodeStates=new Map();this._selectedNodes=new Set();this._visibilityTracker=new a();this._closedNodeProcessed=false;};b.prototype._setContent=function(d){var e=null;if(d&&d instanceof sap.ui.vk.dvl.Scene){e=d;}this._setScene(e);};b.prototype._onAfterUpdateContentConnector=function(){this._setContent(this._contentConnector.getContent());};b.prototype._onBeforeClearContentConnector=function(){this._setScene(null);};b.prototype._handleContentReplaced=function(e){var d=e.getParameter('newContent');this._setContent(d);};b.prototype._setScene=function(d){if(d){this._setNodeHierarchy(d.getDefaultNodeHierarchy());}else{this._setNodeHierarchy(null);}return this;};b.prototype._setNodeHierarchy=function(n){var o=this._nodeHierarchy;if(this._nodeHierarchy){this._nodeHierarchy.detachNodeCreated(this._handleNodeCreated,this);this._nodeHierarchy.detachNodeRemoving(this._handleNodeRemoving,this);this._dvl.Client.detachStepEvent(this._handleStepEvent,this);this._nodeHierarchy=null;this._dvl=null;this._nodeStates.clear();this._selectedNodes.clear();this._visibilityTracker.clear();}if(n){var d=n.getScene(),e=d.getSceneRef();this._nodeHierarchy=n;this._dvl=d.getGraphicsCore().getApi(sap.ui.vk.dvl.GraphicsCoreApi.LegacyDvl);this._dvl.Client.attachStepEvent(this._handleStepEvent,this);this._nodeHierarchy.attachNodeCreated(this._handleNodeCreated,this);this._nodeHierarchy.attachNodeRemoving(this._handleNodeRemoving,this);this._populateNodeStates(this._dvl.Scene.RetrieveSceneInfo(e,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_CHILDREN|sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_HOTSPOTS).ChildNodes);}if(n!==o){this.fireNodeHierarchyReplaced({oldNodeHierarchy:o,newNodeHierarchy:n});}return this;};b.prototype._populateNodeStates=function(n){var t=this,v=[],h=[],d=[],u=[],e=this._nodeHierarchy.getScene(),f=e.getSceneRef();n.forEach(function addNodeRecursive(i){var j=t._dvl.Scene.RetrieveNodeInfo(f,i,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS|sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN);t._nodeStates.set(i,{flags:j.Flags});if(j.Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED){t._selectedNodes.add(i);}(j.Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE?v:h).push(i);(j.Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED?d:u).push(i);j.ChildNodes.forEach(addNodeRecursive);});this.fireSelectionChanged({selected:d,unselected:u});this.fireVisibilityChanged({visible:v,hidden:h});return this;};b.prototype._handleNodeCreated=function(e){this._populateNodeStates([e.getParameter('nodeRef')]);};b.prototype._handleNodeRemoving=function(e){var n=e.getParameter('nodeRef'),t=this;var r=function(n){t._nodeHierarchy.enumerateChildren(n,r,true,true);t._nodeStates.delete(n);};r(n);};b.prototype.getNodeHierarchy=function(){return this._nodeHierarchy;};b.prototype.getVisibilityChanges=function(){return this.getShouldTrackVisibilityChanges()?this._visibilityTracker.getInfo(this.getNodeHierarchy()):null;};b.prototype.getVisibilityComplete=function(){var n=this.getNodeHierarchy(),d=n.findNodesByName(),v=[],h=[];d.forEach(function(e){var f=n.createNodeProxy(e),i=q.grep(f.getVeIds(),function(i){return i.type==='VE_LOCATOR';});i=Array.isArray(i)&&i.length>0?i[0].fields[0].value:null;n.destroyNodeProxy(f);if(i){if(this.getVisibilityState(e)){v.push(i);}else{h.push(i);}}},this);return{visible:v,hidden:h};};b.prototype.resetVisibility=function(){this._dvl.Renderer.ResetView(sap.ve.dvl.DVLRESETVIEWFLAG.VISIBILITY,this._scene);return this;};var g=function(n,f,d){return n.has(d)&&(n.get(d).flags&f)!==0;};b.prototype._getVisibilityFlagState=function(n){return g(this._nodeStates,sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE,n);};b.prototype._getSelectionFlagState=function(n){return g(this._nodeStates,sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED,n);};var s=function(n,f,d,e){if(n.has(e)){var i=n.get(e);i.flags=i.flags&~d|f&d;}else{n.set(e,{flags:f&d});}};b.prototype._setFlags=function(n,f,d){if(d&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE){this.setVisibilityState(n,(f&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE)!==0,false);}if(d&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED){this.setSelectionState(n,(f&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED)!==0,false);}s(this._nodeStates,f,d&~(sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED),n);return this;};b.prototype._getFlags=function(n,f){var d=this._nodeStates.get(n),e=d&&d.flags;return e!==undefined?e&f:null;};b.prototype.getVisibilityState=function(n){return Array.isArray(n)?n.map(this._getVisibilityFlagState,this):this._getVisibilityFlagState(n);};b.prototype.setVisibilityState=function(n,v,r){if(!Array.isArray(n)){n=[n];}var d=q.sap.unique(r?this._collectNodesRecursively(n,true):n).filter(function(e){return e&&this._getVisibilityFlagState(e)!==v;},this);if(d.length>0){d.forEach(function(e){var f=this._nodeStates.get(e);if(f){if(f.flags===undefined){f.flags=0;}if(v){f.flags|=sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE;}else{f.flags&=~sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE;}}else{this._nodeStates.set(e,{flags:v?sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE:0});}},this);if(this.getShouldTrackVisibilityChanges()){d.forEach(this._visibilityTracker.trackNodeRef,this._visibilityTracker);}this.fireVisibilityChanged({visible:v?d:[],hidden:v?[]:d});}return this;};b.prototype.enumerateSelection=function(d){this._selectedNodes.forEach(d);return this;};b.prototype.getSelectionState=function(n){return Array.isArray(n)?n.map(this._getSelectionFlagState,this):this._getSelectionFlagState(n);};b.prototype.setSelectionState=function(n,d,r,e){if(!Array.isArray(n)){n=[n];}var f=q.sap.unique(r||this.getRecursiveSelection()?this._collectNodesRecursively(n):n);if(this.getRecursiveSelection()&&!d){f=this._nodeHierarchy._appendAncestors(f);}f=f.filter(function(h){return h&&this._getSelectionFlagState(h)!==d;},this);if(f.length>0){f.forEach(function(h){var i=this._nodeStates.get(h);if(i){if(i.flags===undefined){i.flags=this._dvl.Scene.RetrieveNodeInfo(this._nodeHierarchy.getScene().getSceneRef(),h,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS).Flags;}if(d){i.flags|=sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED;}else{i.flags&=~sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED;}}else{var j=this._dvl.Scene.RetrieveNodeInfo(this._nodeHierarchy.getScene().getSceneRef(),h,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS).Flags;this._nodeStates.set(h,{flags:j|(d?sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED:0)});}this._selectedNodes[d?'add':'delete'](h);},this);if(!e){this.fireSelectionChanged({selected:d?f:[],unselected:d?[]:f});}}return this;};b.prototype.setSelectionStates=function(d,u,r,e){if(!Array.isArray(d)){d=[d];}if(!Array.isArray(u)){u=[u];}var f=q.sap.unique(r||this.getRecursiveSelection()?this._collectNodesRecursively(d):d);var h=q.sap.unique(r||this.getRecursiveSelection()?this._collectNodesRecursively(u):u);if(this.getRecursiveSelection()){h=this._nodeHierarchy._appendAncestors(h,f);}f=f.filter(function(n){return n&&this._getSelectionFlagState(n)===false;},this);h=h.filter(function(n){return n&&this._getSelectionFlagState(n)===true;},this);if(f.length>0){f.forEach(function(n){var i=this._nodeStates.get(n);if(i){if(i.flags===undefined){i.flags=this._dvl.Scene.RetrieveNodeInfo(this._nodeHierarchy.getScene().getSceneRef(),n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS).Flags;}i.flags|=sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED;}else{var j=this._dvl.Scene.RetrieveNodeInfo(this._nodeHierarchy.getScene().getSceneRef(),n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS).Flags;this._nodeStates.set(n,{flags:j|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED});}this._selectedNodes['add'](n);},this);}if(h.length>0){h.forEach(function(n){var i=this._nodeStates.get(n);if(i){if(i.flags===undefined){i.flags=this._dvl.Scene.RetrieveNodeInfo(this._nodeHierarchy.getScene().getSceneRef(),n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS).Flags;}i.flags&=~sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED;}else{var j=this._dvl.Scene.RetrieveNodeInfo(this._nodeHierarchy.getScene().getSceneRef(),n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS).Flags;this._nodeStates.set(n,{flags:j});}this._selectedNodes['delete'](n);},this);}if(!e){if(f.length>0||h.length>0){this.fireSelectionChanged({selected:f,unselected:h});}}return this;};b.prototype._handleStepEvent=function(e){if(e.type===sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_STARTED){this._visibilityTracker.clear();}};b.prototype._collectNodesRecursively=function(n,i){var r=[],t=this;if(i===undefined){i=false;}n.forEach(function collectChildNodes(d){r.push(d);t._nodeHierarchy.enumerateChildren(d,collectChildNodes,i,true);});return r;};b.prototype._getOpacity=function(n){if(this._nodeStates.has(n)){var o=this._nodeStates.get(n).opacity;return o===undefined?null:o;}else{return null;}};b.prototype.getOpacity=function(n){if(Array.isArray(n)){return n.map(this._getOpacity,this);}else{return this._getOpacity(n);}};b.prototype.setOpacity=function(n,o,r){if(!Array.isArray(n)){n=[n];}var d=q.sap.unique(r?this._collectNodesRecursively(n,true):n).filter(function(e){return e&&this._getOpacity(e)!==o;},this);if(d.length>0){d.forEach(function(e){var f=this._nodeStates.get(e);if(f){if(o===null){delete f.opacity;}else{f.opacity=o;}}else if(o!==null){this._nodeStates.set(e,{opacity:o});}},this);this.fireOpacityChanged({changed:d,opacity:o});}return this;};b.prototype._getTintColorABGR=function(n){if(this._nodeStates.has(n)){var t=this._nodeStates.get(n).tintColorABGR;return t===undefined?null:t;}else{return null;}};b.prototype._getTintColor=function(n){if(this._nodeStates.has(n)){var t=this._nodeStates.get(n).tintColorABGR;return t===undefined?null:sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(t));}else{return null;}};b.prototype.getTintColor=function(n,i){var d=i?'_getTintColorABGR':'_getTintColor';if(Array.isArray(n)){return n.map(this[d],this);}else{return this[d](n);}};b.prototype.setTintColor=function(n,t,r){if(!Array.isArray(n)){n=[n];}var d=null;switch(typeof t){case'number':d=t;break;case'string':if(sap.ui.core.CSSColor.isValid(t)){d=sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(t));}break;default:t=null;break;}var e=q.sap.unique(r?this._collectNodesRecursively(n,true):n).filter(function(f){return f&&this._getTintColorABGR(f)!==d;},this);if(e.length>0){e.forEach(function(f){var h=this._nodeStates.get(f);if(h){if(d===null){delete h.tintColorABGR;}else{h.tintColorABGR=d;}}else if(d!==null){this._nodeStates.set(f,{tintColorABGR:d});}},this);this.fireTintColorChanged({changed:e,tintColor:t,tintColorABGR:d});}return this;};a=function(){this._visibilityChanges=new Set();};a.prototype.getInfo=function(n){var f=function(v){return v.type==='VE_LOCATOR';};var d=[];this._visibilityChanges.forEach(function(e){var h=n.createNodeProxy(e),v=q.grep(h.getVeIds(),f);v=Array.isArray(v)&&v.length>0?v[0].fields[0].value:null;n.destroyNodeProxy(h);if(v){d.push(v);}});return d;};a.prototype.clear=function(){this._visibilityChanges.clear();};a.prototype.trackNodeRef=function(n){if(this._visibilityChanges.has(n)){this._visibilityChanges.delete(n);}else{this._visibilityChanges.add(n);}};C.injectMethodsIntoClass(b);return b;});\n",
	"sap/ui/vk/dvl/Viewport.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../ViewportBase','sap/ui/core/ResizeHandler','../Loco','../ViewportHandler','../Smart2DHandler','../Messages','../ContentConnector','../ViewStateManager','./GraphicsCore','./ViewportRenderer'],function(q,l,V,R,L,a,S,M,C,b,G,c){'use strict';var d={encodedProjectionType:{},decodedProjectionType:{},encodedBindingType:{},decodedBindingType:{},decodedZoomTo:{}};d.decodedProjectionType[sap.ui.vk.CameraProjectionType.Perspective]=sap.ve.dvl.DVLCAMERAPROJECTION.PERSPECTIVE;d.decodedProjectionType[sap.ui.vk.CameraProjectionType.Orthographic]=sap.ve.dvl.DVLCAMERAPROJECTION.ORTHOGRAPHIC;d.encodedProjectionType[sap.ve.dvl.DVLCAMERAPROJECTION.PERSPECTIVE]=sap.ui.vk.CameraProjectionType.Perspective;d.encodedProjectionType[sap.ve.dvl.DVLCAMERAPROJECTION.ORTHOGRAPHIC]=sap.ui.vk.CameraProjectionType.Orthographic;d.decodedBindingType[sap.ui.vk.CameraFOVBindingType.Minimum]=sap.ve.dvl.DVLCAMERAFOVBINDING.MIN;d.decodedBindingType[sap.ui.vk.CameraFOVBindingType.Maximum]=sap.ve.dvl.DVLCAMERAFOVBINDING.Max;d.decodedBindingType[sap.ui.vk.CameraFOVBindingType.Horizontal]=sap.ve.dvl.DVLCAMERAFOVBINDING.HORZ;d.decodedBindingType[sap.ui.vk.CameraFOVBindingType.Vertical]=sap.ve.dvl.DVLCAMERAFOVBINDING.VERT;d.encodedBindingType[sap.ve.dvl.DVLCAMERAFOVBINDING.MIN]=sap.ui.vk.CameraFOVBindingType.Minimum;d.encodedBindingType[sap.ve.dvl.DVLCAMERAFOVBINDING.MAX]=sap.ui.vk.CameraFOVBindingType.Maximum;d.encodedBindingType[sap.ve.dvl.DVLCAMERAFOVBINDING.HORZ]=sap.ui.vk.CameraFOVBindingType.Horizontal;d.encodedBindingType[sap.ve.dvl.DVLCAMERAFOVBINDING.VERT]=sap.ui.vk.CameraFOVBindingType.Vertical;d.decodedZoomTo[sap.ui.vk.ZoomTo.All]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_ALL;d.decodedZoomTo[sap.ui.vk.ZoomTo.Visible]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_VISIBLE;d.decodedZoomTo[sap.ui.vk.ZoomTo.Selected]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_SELECTED;d.decodedZoomTo[sap.ui.vk.ZoomTo.Node]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_NODE;d.decodedZoomTo[sap.ui.vk.ZoomTo.NodeSetIsolation]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_NODE_SETISOLATION;d.decodedZoomTo[sap.ui.vk.ZoomTo.Restore]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_RESTORE;d.decodedZoomTo[sap.ui.vk.ZoomTo.RestoreRemoveIsolation]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_RESTORE_REMOVEISOLATION;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewLeft]=sap.ve.dvl.DVLZOOMTO.VIEW_LEFT;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewRight]=sap.ve.dvl.DVLZOOMTO.VIEW_RIGHT;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewTop]=sap.ve.dvl.DVLZOOMTO.VIEW_TOP;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewBottom]=sap.ve.dvl.DVLZOOMTO.VIEW_BOTTOM;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewBack]=sap.ve.dvl.DVLZOOMTO.VIEW_BACK;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewFront]=sap.ve.dvl.DVLZOOMTO.VIEW_FRONT;var e=V.extend('sap.ui.vk.dvl.Viewport',{metadata:{library:'sap.ui.vk',properties:{showAllHotspots:{type:'boolean',defaultValue:false},hotspotColorABGR:{type:'int',defaultValue:0xc00000ff},hotspotColor:{type:'sap.ui.core.CSSColor',defaultValue:'rgba(255, 0, 0, 0.7529411764705882)'},backgroundColorTopABGR:{type:'int',defaultValue:0xff000000},backgroundColorBottomABGR:{type:'int',defaultValue:0xffffffff}},events:{pan:{parameters:{dx:'int',dy:'int'}},zoom:{parameters:{zoomFactor:'float'}},rotate:{parameters:{dx:'int',dy:'int'}},viewActivated:{parameters:{type:{type:'string'}}},frameRenderingFinished:{}}}});var g=e.getMetadata().getParent().getClass().prototype;e.prototype.init=function(){if(g.init){g.init.call(this);}this._graphicsCore=null;this._dvl=null;this._dvlRendererId=null;this._viewStateManager=null;this._canvas=null;this._resizeListenerId=null;this._is2D=false;this._viewportHandler=new a(this);this._loco=new L();this._loco.addHandler(this._viewportHandler);this._smart2DHandler=null;this._lastPlayedStep=null;this._contentConnector=null;};e.prototype.exit=function(){this._loco.removeHandler(this._viewportHandler);this._viewportHandler.destroy();if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}this._clearContentConnector();this.setViewStateManager(null);this.setScene(null);this.setGraphicsCore(null);if(g.exit){g.exit.call(this);}};e.prototype.setGraphicsCore=function(f){if(f!=this._graphicsCore){if(this._graphicsCore){this._dvl.Client.detachFrameFinished(this._handleFrameFinished,this);this._dvl.Client.detachStepEvent(this._updateLastPlayedStep,this);this._dvl.Renderer.SetViewStateManager(null,this._dvlRendererId);this._graphicsCore._deregisterViewport(this);this._dvl=null;}this._graphicsCore=f;if(this._graphicsCore){this._dvl=this._graphicsCore._getDvl();this._graphicsCore._registerViewport(this);this.setShowDebugInfo(this.getShowDebugInfo());this._dvl.Client.attachStepEvent(this._updateLastPlayedStep,this);this._dvl.Client.attachFrameFinished(this._handleFrameFinished,this);this._dvl.Renderer.SetViewStateManager(this._viewStateManager,this._dvlRendererId);}}return this;};e.prototype.getGraphicsCore=function(){return this._graphicsCore;};e.prototype._setCanvas=function(f){var i=this.getDomRef()&&this._canvas!==f;this._canvas=f;if(i){this.invalidate();}return this;};e.prototype._setRenderer=function(f){this._dvlRendererId=f;return this;};e.prototype._updateLastPlayedStep=function(f){if(f.type===sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_STARTED){this._lastPlayedStep=f.stepId;}};e.prototype.setScene=function(f){if(this._dvlRendererId){this._dvl.Renderer.AttachScene(f&&f.getSceneRef()||null,this._dvlRendererId);this._dvlSceneRef=f?f.getSceneRef():null;if(f){this._dvl.Client.attachUrlClicked(this._fireUrlClicked,this);var i=this._isSmart2DContent()||this._isSmart2DContentLegacy();if(i){this._dvl.Renderer.SetBackgroundColor(1,1,1,1,1,1,1,1,this._dvlRendererId);}else{var j=this._getDecomposedABGR(this.getBackgroundColorTopABGR());var m=this._getDecomposedABGR(this.getBackgroundColorBottomABGR());this._dvl.Renderer.SetBackgroundColor(j.red,j.green,j.blue,j.alpha,m.red,m.green,m.blue,m.alpha,this._dvlRendererId);}this.fireViewActivated({type:i?'2D':'3D'});}else{this._dvl.Client.detachUrlClicked(this._fireUrlClicked,this);if(this._smart2DHandler){var x=new L();x.removeHandler(this._smart2DHandler);}this.invalidate();}}return this;};e.prototype._isSmart2DContent=function(){var f=sap.ui.vk.dvl.getJSONObject(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneRef,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_HOTSPOTS).ChildNodes);return f&&f.length>0;};e.prototype._isSmart2DContentLegacy=function(){var f=this._dvl.Scene.GetCurrentCamera(this._dvlSceneRef),i=this._dvl.Camera.GetRotation(f),j=this._dvl.Camera.GetProjection(f);return i[0]===90&&i[1]===-90&&i[2]===0&&j===sap.ve.dvl.DVLCAMERAPROJECTION.ORTHOGRAPHIC;};e.prototype._initializeSmart2DHandler=function(){if(this._viewStateManager){if(this._smart2DHandler){this._loco.removeHandler(this._smart2DHandler);}this._smart2DHandler=new S(this,this._viewStateManager);this._loco.addHandler(this._smart2DHandler);}if(this.getShowAllHotspots()){var f=this._viewStateManager.getNodeHierarchy(),i=f.getHotspotNodeIds();this.showHotspots(i,true);}};e.prototype._fireUrlClicked=function(f){this.fireUrlClicked({url:f.url,nodeRef:f.nodeId});};e.prototype.setHotspotColorABGR=function(f){this.setProperty('hotspotColorABGR',f,true);this.setProperty('hotspotColor',sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(this.getProperty('hotspotColorABGR'))),true);return this;};e.prototype.setHotspotColor=function(f){this.setProperty('hotspotColor',f,true);this.setProperty('hotspotColorABGR',sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(this.getProperty('hotspotColor'))),true);return this;};e.prototype._getStepAndProcedureIndexes=function(f,m){var x=-1,y=-1,z=false;for(var i=0;i<f.length;i++){if(!z){for(var j=0;j<f[i].steps.length;j++){if(f[i].steps[j].id===m){y=j;x=i;z=true;break;}}}else{break;}}return{stepIndex:y,procedureIndex:x};};e.prototype._getStepVeIdById=function(f){if(f){var i=this._dvl.Scene.RetrieveVEIDs(this._dvlSceneRef,f);if(Array.isArray(i)){for(var j=0,m=i.length;j<m;++j){var x=i[j];if(x.source==='SAP'&&x.type==='VE_VIEWPORT'&&Array.isArray(x.fields)){for(var y=0,z=x.fields.length;y<z;++y){var A=x.fields[y];if(A.name==='ID'){return A.value;}}}}}}return null;};e.prototype._getStepIdByVeId=function(f,i){for(var j=0,m=f.length;j<m;++j){var x=f[j].steps;for(var y=0,z=x.length;y<z;++y){var A=x[y].id;if(this._getStepVeIdById(A)===i){return A;}}}return null;};var s=function(f){f.camera={};};var h=function(f){if(typeof f.camera==='object'&&f.camera!==null){f.camera.matrices=false;}};var k=function(f){if(typeof f.camera==='object'&&f.camera!==null){f.camera.useTransitionCamera=false;}};var n=function(f){f.animation=true;};var o=function(f){f.visibility=false;};var p=function(f){if(typeof f.visibility==='object'&&f.visibility!==null){f.visibility.mode=sap.ui.vk.VisibilityMode.Complete;}};e.prototype.getViewInfo=function(f){if(!this._dvlSceneRef){return null;}var i={};if(typeof f!=='object'||f===null){s(i);h(i);k(i);n(i);o(i);p(i);}else{if(typeof f.camera==='object'&&f.camera!==null){i.camera={};if(typeof f.camera.matrices==='boolean'){i.camera.matrices=f.camera.matrices;}else if('matrices'in f.camera){i.camera.matrices=false;}else{h(i);}if(typeof f.camera.useTransitionCamera==='boolean'){i.camera.useTransitionCamera=f.camera.useTransitionCamera;}else if('useTransitionCamera'in f.camera){i.camera.useTransitionCamera=false;}else{k(i);}}else if(typeof f.camera==='boolean'){if(f.camera===true){i.camera={};h(i);k(i);}else{i.camera=false;}}else if('camera'in f){i.camera=false;}else{s(i);h(i);k(i);}if(typeof f.animation==='boolean'){i.animation=f.animation;}else if('animation'in f){i.animation=false;}else{n(i);}if(typeof f.visibility==='object'&&f.visibility!==null){i.visibility={};if(f.visibility.mode===sap.ui.vk.VisibilityMode.Complete||f.visibility.mode===sap.ui.vk.VisibilityMode.Differences){i.visibility.mode=f.visibility.mode;}else{p(i);}}else if(typeof f.visibility==='boolean'){if(f.visibility===true){i.visibility={};p(i);}else{i.visibility=false;}}else if('visibility'in f){i.visibility=false;}else{o(i);p(i);}}var j={};if(i.camera){var m=null;if(i.camera.useTransitionCamera){m=this._dvl.Renderer.GetTransitionCamera(this._dvlRendererId);if(m===sap.ve.dvl.DVLID_INVALID){m=null;}}if(m===null){m=this._dvl.Renderer.GetCurrentCamera(this._dvlRendererId);}var x=this._dvl.Camera.GetRotation(m),y=this._dvl.Camera.GetOrigin(m);j.camera={rotation:{yaw:x[0],pitch:x[1],roll:x[2]},position:{x:y[0],y:y[1],z:y[2]},projectionType:d.encodedProjectionType[this._dvl.Camera.GetProjection(m)],bindingType:d.encodedBindingType[this._dvl.Camera.GetFOVBinding(m)]};if(this._matView){j.viewMatrix=this._matView.slice();}if(this._matProj){j.projectionMatrix=this._matProj.slice();}if(j.camera.projectionType===sap.ui.vk.CameraProjectionType.Perspective){j.camera.fieldOfView=this._dvl.Camera.GetFOV(m);}else if(j.camera.projectionType===sap.ui.vk.CameraProjectionType.Orthographic){j.camera.zoomFactor=this._dvl.Camera.GetOrthoZoomFactor(m);}if(i.camera.matrices){var z=this._dvl.Renderer.GetCameraMatrices(this._dvlRendererId);j.camera.matrices={view:z.view,projection:z.projection};}}if(i.animation){var A=this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneRef,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_STEP_INFO),B=A.StepId!==sap.ve.dvl.DVLID_INVALID;var D=B?A.StepId:this._lastPlayedStep,E=B?A.StepTime:0,F=this._dvl.Scene.RetrieveProcedures(this._dvlSceneRef),H=this._getStepAndProcedureIndexes(F.procedures,D),I=this._getStepVeIdById(D);j.animation={animationTime:E,stepIndex:H.stepIndex,procedureIndex:H.procedureIndex};if(I){j.animation.stepVeId=I;}}if(i.visibility&&this._viewStateManager){j.visibility={mode:i.visibility.mode};if(i.visibility.mode===sap.ui.vk.VisibilityMode.Complete){var J=this._viewStateManager.getVisibilityComplete();j.visibility.visible=J.visible;j.visibility.hidden=J.hidden;}else if(this._viewStateManager.getShouldTrackVisibilityChanges()){j.visibility.changes=this._viewStateManager.getVisibilityChanges();}else{q.sap.log.warning(sap.ui.vk.getResourceBundle().getText(M.VIT32.summary),M.VIT32.code,'sap.ui.vk.dvl.Viewport');}}return j;};e.prototype.setViewInfo=function(f,i){var j=false;if(f.animation){var m=this._dvl.Scene.RetrieveProcedures(this._dvlSceneRef),x=f.animation.procedureIndex,y=f.animation.stepIndex,z=f.animation.stepVeId,A,B=f.animation.animationTime||0;if(z||y>=0&&x>=0){if(z){A=this._getStepIdByVeId(m.procedures,f.animation.stepVeId);}else if(x>=0&&x<m.procedures.length){if(y>=0&&y<m.procedures[x].steps.length){A=m.procedures[x].steps[y].id;}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT26.summary),M.VIT26.code,'sap.ui.vk.dvl.Viewport');}}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT27.summary),M.VIT27.code,'sap.ui.vk.dvl.Viewport');}if(A){this._dvl.Renderer.ActivateStep(this._dvlRendererId,A,false,false,B);this._dvl.Renderer.PauseCurrentStep(this._dvlRendererId);}}else{j=true;}}if(f.camera){var D;if(f.camera.projectionType===sap.ui.vk.CameraProjectionType.Perspective||f.camera.projectionType===sap.ui.vk.CameraProjectionType.Orthographic){D=d.decodedProjectionType[f.camera.projectionType];}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT19.summary),M.VIT19.code,'sap.ui.vk.dvl.Viewport');D=sap.ve.dvl.DVLCAMERAPROJECTION.PERSPECTIVE;}var E=this._dvl.Scene.CreateCamera(this._dvlSceneRef,D,sap.ve.dvl.DVLID_INVALID);if(D===sap.ve.dvl.DVLCAMERAPROJECTION.PERSPECTIVE){this._dvl.Camera.SetFOV(E,f.camera.fieldOfView);}else if(D===sap.ve.dvl.DVLCAMERAPROJECTION.ORTHOGRAPHIC){this._dvl.Camera.SetOrthoZoomFactor(E,f.camera.zoomFactor);}if(f.camera.position){this._dvl.Camera.SetOrigin(E,f.camera.position.x,f.camera.position.y,f.camera.position.z);}if(f.camera.rotation){this._dvl.Camera.SetRotation(E,f.camera.rotation.yaw,f.camera.rotation.pitch,f.camera.rotation.roll);}if(f.camera.bindingType){var F=d.decodedBindingType[f.camera.bindingType]||sap.ve.dvl.DVLCAMERAFOVBINDING.MIN;this._dvl.Camera.SetFOVBinding(E,F);}i=i||0;this._dvl.Renderer.ActivateCamera(this._dvlRendererId,E,i);this._dvl.Scene.DeleteNode(this._dvlSceneRef,E);}if(f.viewMatrix){this._matView=f.viewMatrix.slice();}if(f.projectionMatrix){this._matProj=f.projectionMatrix.slice();}if(f.visibility){var H=this._viewStateManager.getNodeHierarchy(),I=new Map(),J=H.findNodesByName();J.forEach(function(O){var P=H.createNodeProxy(O),Q=q.grep(P.getVeIds(),function(Q){return Q.type==='VE_LOCATOR';});Q=Array.isArray(Q)&&Q.length>0?Q[0].fields[0].value:null;H.destroyNodeProxy(P);if(Q){I.set(Q,O);}});switch(f.visibility.mode){case sap.ui.vk.VisibilityMode.Complete:var K=f.visibility.visible,N=f.visibility.hidden;K.forEach(function(O){this._viewStateManager.setVisibilityState(I.get(O),true,false);},this);N.forEach(function(O){this._viewStateManager.setVisibilityState(I.get(O),false,false);},this);break;case sap.ui.vk.VisibilityMode.Differences:if(j){this.resetView({camera:false,visibility:true,transition:false});}f.visibility.changes.forEach(function(O){var P=I.get(O);if(P){this._viewStateManager.setVisibilityState(P,!this._viewStateManager.getVisibilityState(P),false);}},this);break;default:q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT28.summary),M.VIT28.code,'sap.ui.vk.dvl.Viewport');break;}}return this;};e.prototype.setSelectionRect=function(f){if(!f){this._dvl.Renderer.DrawSelectionRect(0,0,0,0,this._dvlRendererId);}else{this._dvl.Renderer.DrawSelectionRect(f.x1,f.y1,f.x2,f.y2,this._dvlRendererId);}};e.prototype.getOutputSize=function(){var f=this.getViewInfo().camera.bindingType,i=this.getDomRef().getBoundingClientRect(),j=i.width,m=i.height,x;switch(d.decodedBindingType[f]){case sap.ve.dvl.DVLCAMERAFOVBINDING.MIN:x=Math.min(j,m);break;case sap.ve.dvl.DVLCAMERAFOVBINDING.MAX:x=Math.max(j,m);break;case sap.ve.dvl.DVLCAMERAFOVBINDING.HORZ:x=j;break;case sap.ve.dvl.DVLCAMERAFOVBINDING.VERT:x=m;break;default:break;}return{left:(j-x)/2,top:(m-x)/2,sideLength:x};};e.prototype.onBeforeRendering=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}};e.prototype.onAfterRendering=function(){var f=this.getDomRef();if(this._canvas){f.appendChild(this._canvas);}this._resizeListenerId=R.register(this,this._handleResize.bind(this));this._handleResize({size:{width:f.clientWidth,height:f.clientHeight}});};e.prototype._handleResize=function(f){if(this._dvlRendererId&&this._canvas){var i=f.size.width*window.devicePixelRatio;var j=f.size.height*window.devicePixelRatio;if(this._matProj){var m=this._matProj[0];var x=this._matProj[5];var y=Math.max(m,x);if(i>j){m=y*j/i;x=y;}else{m=y;x=y*i/j;}this._matProj[8]*=m/this._matProj[0];this._matProj[9]*=x/this._matProj[5];this._matProj[0]=m;this._matProj[5]=x;}this._dvl.Renderer.SetDimensions(i,j,this._dvlRendererId);this._dvl.Renderer.SetOptionF(sap.ve.dvl.DVLRENDEROPTIONF.DVLRENDEROPTIONF_DPI,96*window.devicePixelRatio,this._dvlRendererId);this._canvas.width=i;this._canvas.height=j;this._canvas.style.width=f.size.width+'px';this._canvas.style.height=f.size.height+'px';this.fireResize({size:{width:f.size.width,height:f.size.height}});return true;}};e.prototype._handleVisibilityChanged=e.prototype._handleSelectionChanged=e.prototype._handleOpacityChanged=e.prototype._handleTintColorChanged=function(f){if(this._dvlRendererId){this._dvl.Renderer.ForceRenderFrame(this._dvlRendererId);}};e.prototype.showHotspots=function(f,i,j){var m=sap.ui.vk.dvl.NodeProxy.prototype[typeof j==='string'?'setTintColor':'setTintColorABGR'];var x=function(z,j,E){var F=z.createNodeProxy(E);m.call(F,j);z.destroyNodeProxy(F);};if(!Array.isArray(f)){f=[f];}var y=j===undefined?this.getHotspotColorABGR():j;if(!i){y=0;}var z=this._viewStateManager.getNodeHierarchy();if(this._isSmart2DContent()){var A=[];f.forEach(function(E){var F=sap.ui.vk.dvl.getJSONObject(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneRef,E,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN).ChildNodes);Array.prototype.push.apply(A,F);}.bind(this));Array.prototype.push.apply(A,f);A.forEach(x.bind(null,z,y));}else{var B=[];var D=function(E){var A=z.getChildren(E);Array.prototype.push.apply(B,A);A.forEach(D);};f.forEach(D);Array.prototype.push.apply(B,f);B.forEach(x.bind(null,z,y));}return this;};e.prototype._getDecomposedABGR=function(i){return{red:(i>>>0&0xff)/255,green:(i>>>8&0xff)/255,blue:(i>>>16&0xff)/255,alpha:(i>>>24&0xff)/255};};e.prototype._setBackgroundColor=function(){if(this._dvl){var f=this._getDecomposedABGR(this.getBackgroundColorTopABGR()),i=this._getDecomposedABGR(this.getBackgroundColorBottomABGR());this._dvl.Renderer.SetBackgroundColor(f.red,f.green,f.blue,f.alpha,i.red,i.green,i.blue,i.alpha,this._dvlRendererId);}};e.prototype.setBackgroundColorTopABGR=function(i){this.setProperty('backgroundColorTopABGR',i,true);this._setBackgroundColor();return this;};e.prototype.setBackgroundColorTop=function(f){this.setProperty('backgroundColorTop',f,true);return this.setBackgroundColorTopABGR(sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(f)));};e.prototype.setBackgroundColorBottomABGR=function(i){this.setProperty('backgroundColorBottomABGR',i,true);this._setBackgroundColor();return this;};e.prototype.setBackgroundColorBottom=function(f){this.setProperty('backgroundColorBottom',f,true);return this.setBackgroundColorBottomABGR(sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(f)));};e.prototype.setShouldRenderFrame=function(){if(this._dvlRendererId){this._dvl.Renderer.ForceRenderFrame(this._dvlRendererId);}return this;};e.prototype.shouldRenderFrame=function(){return this._dvlRendererId&&this._dvl.Renderer.ShouldRenderFrame(this._dvlRendererId);};e.prototype.renderFrame=function(){if(this._dvlRendererId){if(this._matView&&this._matProj){this.renderFrameEx(this._matView,this._matProj,this._dvlRendererId);}else{this._dvl.Renderer.RenderFrame(this._dvlRendererId);}}return this;};e.prototype.renderFrameEx=function(f,i){if(this._dvlRendererId){this._dvl.Renderer.RenderFrameEx.apply(this,[].concat(f,i),this._dvlRendererId);}return this;};e.prototype.resetView=function(f){if(f!==undefined&&!q.isPlainObject(f)){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT31.summary),M.VIT31.code,'sap.ui.vk.dvl.Viewport');}var i={camera:true,transition:true,visibility:false};q.extend(i,f);if(i.camera||i.visibility){var j=(i.camera?sap.ve.dvl.DVLRESETVIEWFLAG.CAMERA:0)|(i.transition?sap.ve.dvl.DVLRESETVIEWFLAG.SMOOTHTRANSITION:0)|(i.visibility?sap.ve.dvl.DVLRESETVIEWFLAG.VISIBILITY:0);if(this._dvlRendererId){this._dvl.Renderer.ResetView(j,this._dvlRendererId);this._lastPlayedStep=null;}}return this;};e.prototype.canIsolateNode=function(f){if(this._dvlRendererId){return this._dvl.Renderer.CanIsolateNode(f,this._dvlRendererId);}else{return false;}};e.prototype.setIsolatedNode=function(f){if(this._dvlRendererId){this._dvl.Renderer.SetIsolatedNode(f,this._dvlRendererId);}return this;};e.prototype.getIsolatedNode=function(){if(this._dvlRendererId){return this._dvl.Renderer.GetIsolatedNode(this._dvlRendererId);}else{return sap.ve.dvl.DVLID_INVALID;}};e.prototype.hitTest=function(x,y){if(this._dvlRendererId){var f=this._dvl.Renderer.HitTest(x*window.devicePixelRatio,y*window.devicePixelRatio,this._dvlRendererId).id;this.setShouldRenderFrame();return f;}else{return null;}};e.prototype.setShowDebugInfo=function(f){this.setProperty('showDebugInfo',f,true);if(this._dvlRendererId){this._dvl.Renderer.SetOption(sap.ve.dvl.DVLRENDEROPTION.DVLRENDEROPTION_SHOW_DEBUG_INFO,f,this._dvlRendererId);}return this;};e.prototype._handleFrameFinished=function(f){if(f.rendererId===this._dvlRendererId){this.fireFrameRenderingFinished();}};e.prototype.beginGesture=function(x,y){if(this._dvlRendererId){this._gesturePoint={x:x,y:y};this._dvl.Renderer.BeginGesture(x*window.devicePixelRatio,y*window.devicePixelRatio,this._dvlRendererId);}return this;};e.prototype.endGesture=function(){if(this._dvlRendererId){this._dvl.Renderer.EndGesture(this._dvlRendererId);}return this;};e.prototype._activateRedline=function(){this.renderFrame();var m=this._dvl.Renderer.GetCameraMatrices();this._matView=m.view;this._matProj=m.projection;};e.prototype._deactivateRedline=function(){this._matView=null;this._matProj=null;};e.prototype.pan=function(f,i){if(this._dvlRendererId&&!this.getFreezeCamera()){if(this._matProj){var j=this.getDomRef();this._matProj[8]-=f*2/j.clientWidth;this._matProj[9]+=i*2/j.clientHeight;this.setShouldRenderFrame();}else{this._dvl.Renderer.Pan(f*window.devicePixelRatio,i*window.devicePixelRatio,this._dvlRendererId);}this.firePan({dx:f,dy:i});}return this;};e.prototype.rotate=function(f,i){if(this._dvlRendererId&&!this.getFreezeCamera()){this._dvl.Renderer.Rotate(f*window.devicePixelRatio,i*window.devicePixelRatio,this._dvlRendererId);this.fireRotate({dx:f,dy:i});}return this;};function r(f){var m=f;var i=m[15]===1;var j=2/m[0];var x=2/m[5];var y,z;if(i){y=-m[12]*j;z=-m[13]*x;}else{y=m[8]*j;z=m[9]*x;}var A=(j+y)*0.5;var B=y-A;var D=(x+z)*0.5;var E=z-D;return{left:B,top:D,right:A,bottom:E};}function t(f,i){var m=f;var j=m[15]===1;m[0]=2/(i.right-i.left);m[5]=2/(i.top-i.bottom);if(j){m[12]=-(i.right+i.left)/(i.right-i.left);m[13]=-(i.top+i.bottom)/(i.top-i.bottom);}else{m[8]=(i.right+i.left)/(i.right-i.left);m[9]=(i.top+i.bottom)/(i.top-i.bottom);}}e.prototype.zoom=function(i){if(this._dvlRendererId&&!this.getFreezeCamera()){if(this._matProj){var j=this.getDomRef();var m=r(this._matProj);var x=m.left+(m.right-m.left)*this._gesturePoint.x/j.clientWidth;var y=m.top+(m.bottom-m.top)*this._gesturePoint.y/j.clientHeight;var f=1/i;m.left=x+(m.left-x)*f;m.right=x+(m.right-x)*f;m.top=y+(m.top-y)*f;m.bottom=y+(m.bottom-y)*f;t(this._matProj,m);this.setShouldRenderFrame();}else{this._dvl.Renderer.Zoom(i,this._dvlRendererId);}this.fireZoom({zoomFactor:i});}return this;};e.prototype.zoomTo=function(f,j,m,x){if(this._dvlRendererId){var y=0;if(Array.isArray(f)){for(var i in f){y|=d.decodedZoomTo[f[i]];}}else{y=d.decodedZoomTo[f];}this._dvl.Renderer.ZoomTo(y,j,m,x,this._dvlRendererId);}return this;};e.prototype.tap=function(x,y,i){if(this._dvlRendererId){var f=x*window.devicePixelRatio,j=y*window.devicePixelRatio;if(!i){var m=this.hitTest(x,y);var z={picked:m===sap.ve.dvl.DVLID_INVALID||m==null?[]:[m]};this.fireNodesPicked(z);if(this.getSelectionMode()===sap.ui.vk.SelectionMode.Exclusive){this.exclusiveSelectionHandler(z.picked);}else if(this.getSelectionMode()===sap.ui.vk.SelectionMode.Sticky){this.stickySelectionHandler(z.picked);}if(m!==sap.ve.dvl.DVLID_INVALID){this.fireNodeClicked({nodeRef:m,nodeId:m,x:x,y:y},true,true);}this._dvl.Renderer.Tap(f,j,false,false,this._dvlRendererId);}else if(!this.getFreezeCamera()){this._dvl.Renderer.Tap(f,j,true,false,this._dvlRendererId);}}return this;};e.prototype.rectSelect=function(x,y,f,i){var j=[];if(this._dvlRendererId){var m=sap.ui.vk.dvl.getJSONObject(this._dvl.Renderer.RectSelect(x,y,f,i,this._dvlRendererId));if(m.SelectedNodes){j=m.SelectedNodes;}}return j;};e.prototype.queueCommand=function(f){if(this._dvlRendererId){this._dvl.Renderer._queueCommand(f,this._dvlRendererId);}return this;};e.prototype._setContent=function(f){var i=null;if(f&&f instanceof sap.ui.vk.dvl.Scene){i=f;}this._setScene(i);};e.prototype._onAfterUpdateContentConnector=function(){this._setContent(this._contentConnector.getContent());};e.prototype._onBeforeClearContentConnector=function(){this._setScene(null);};e.prototype._handleContentReplaced=function(f){var i=f.getParameter('newContent');this._setContent(i);};e.prototype._setScene=function(f){var i=f&&f.getGraphicsCore();this.setGraphicsCore(i);this.setScene(f);if(f&&(this._isSmart2DContent()||this._isSmart2DContentLegacy())){this._initializeSmart2DHandler();}};e.prototype._handleContentChangesFinished=function(f){if(f.getSource().getContentResources().length>1){this.zoomTo(sap.ui.vk.ZoomTo.Visible,sap.ve.dvl.DVLID_INVALID,0,0);}this.setShouldRenderFrame();};e.prototype._onAfterUpdateViewStateManager=function(){if(this._dvl){this._dvl.Renderer.SetViewStateManager(this._viewStateManager,this._dvlRendererId);}};e.prototype._onBeforeClearViewStateManager=function(){if(this._dvl){this._dvl.Renderer.SetViewStateManager(null,this._dvlRendererId);}};var u={x:-2,y:-2};var v=2;var w=5;[{key:'left',dx:-v,dy:0},{key:'right',dx:+v,dy:0},{key:'up',dx:0,dy:-v},{key:'down',dx:0,dy:+v}].forEach(function(i){e.prototype['onsap'+i.key]=function(f){this.beginGesture(u.x,u.y);this.rotate(i.dx,i.dy);this.endGesture();this.setShouldRenderFrame();f.preventDefault();f.stopPropagation();};});[{key:'left',dx:-w,dy:0},{key:'right',dx:+w,dy:0},{key:'up',dx:0,dy:-w},{key:'down',dx:0,dy:+w}].forEach(function(i){e.prototype['onsap'+i.key+'modifiers']=function(f){if(f.shiftKey&&!(f.ctrlKey||f.altKey||f.metaKey)){this.beginGesture(u.x,u.y);this.pan(i.dx,i.dy);this.endGesture();this.setShouldRenderFrame();f.preventDefault();f.stopPropagation();}};});[{key:'minus',d:0.98},{key:'plus',d:1.02}].forEach(function(i){e.prototype['onsap'+i.key]=function(f){this.beginGesture(this.$().width()/2,this.$().height()/2);this.zoom(i.d);this.endGesture();this.setShouldRenderFrame();f.preventDefault();f.stopPropagation();};});C.injectMethodsIntoClass(e);b.injectMethodsIntoClass(e);return e;});\n",
	"sap/ui/vk/dvl/ViewportRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var V={};V.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapVizKitViewport');r.writeClasses();r.writeAttribute('tabindex',0);r.writeAttribute('aria-label','Image');var a=false;var w=c.getWidth();if(w){r.addStyle('width',w);a=true;}var h=c.getHeight();if(h){r.addStyle('height',h);a=true;}if(a){r.writeStyles();}r.write('>');var t=c.getTools();for(var i=0;i<t.length;i++){var _=sap.ui.getCore().byId(t[i]);var b=_.getGizmoForContainer(c);if(b&&b.render===undefined){r.renderControl(b);}}r.write('</div>');};return V;},true);\n",
	"sap/ui/vk/helpers/RotateOrbitHelperDvl.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var R=E.extend('sap.ui.vk.helpers.RotateOrbitHelperDvl',{metadata:{publicMethods:['rotate']},constructor:function(a,D){this._tool=a;this._dvl=D;this._dvlRendererId=this._tool._viewport._dvlRendererId;}});R.prototype.destroy=function(){this._rotateOrbitTool=null;};R.prototype.activateOrbitMode=function(){if(this._dvlRendererId){this._dvl.Renderer.SetOption(sap.ve.dvl.DVLRENDEROPTION.DVLRENDEROPTION_CAMERA_ROTATION_MODE_ORBIT,true);}return this;};R.prototype.deactivateOrbitMode=function(){if(this._dvlRendererId){this._dvl.Renderer.SetOption(sap.ve.dvl.DVLRENDEROPTION.DVLRENDEROPTION_CAMERA_ROTATION_MODE_ORBIT,false);}return this;};R.prototype.rotate=function(d,a){if(this._dvlRendererId){this._dvl.Renderer.Rotate(d*window.devicePixelRatio,a*window.devicePixelRatio,this._dvlRendererId);this._tool.fireRotate({dx:d,dy:a});}return this;};return R;},true);\n",
	"sap/ui/vk/helpers/RotateOrbitHelperThree.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var R=E.extend('sap.ui.vk.helpers.RotateOrbitHelperThree',{metadata:{publicMethods:['rotate']},constructor:function(r){this._tool=r;}});R.prototype.destroy=function(){this._tool=null;};R.prototype.activateOrbitMode=function(){this._tool._viewport._viewportGestureHandler._cameraController.isTurnTableMode=false;return this;};R.prototype.deactivateOrbitMode=function(){this._tool._viewport._viewportGestureHandler._cameraController.isTurnTableMode=true;return this;};R.prototype.rotate=function(d,a){this._tool._viewport._viewportGestureHandler._cameraController.rotate(d,a,false);return this;};return R;},true);\n",
	"sap/ui/vk/helpers/RotateTurntableHelperDvl.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var R=E.extend('sap.ui.vk.helpers.RotateTurntableHelperDvl',{metadata:{publicMethods:['rotate']},constructor:function(a,D){this._tool=a;this._dvl=D;this._dvlRendererId=this._tool._viewport._dvlRendererId;}});R.prototype.destroy=function(){this._rotateOrbitTool=null;};R.prototype.activateTurntableMode=function(){if(this._dvlRendererId){this._dvl.Renderer.SetOption(sap.ve.dvl.DVLRENDEROPTION.DVLRENDEROPTION_CAMERA_ROTATION_MODE_ORBIT,false);}return this;};R.prototype.deactivateTurntableMode=function(){if(this._dvlRendererId){this._dvl.Renderer.SetOption(sap.ve.dvl.DVLRENDEROPTION.DVLRENDEROPTION_CAMERA_ROTATION_MODE_ORBIT,true);}return this;};R.prototype.rotate=function(d,a){if(this._dvlRendererId){this._dvl.Renderer.Rotate(d*window.devicePixelRatio,a*window.devicePixelRatio,this._dvlRendererId);this._tool.fireRotate({dx:d,dy:a});}return this;};return R;},true);\n",
	"sap/ui/vk/helpers/RotateTurntableHelperThree.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var R=E.extend('sap.ui.vk.helpers.RotateTurntableHelperThree',{metadata:{publicMethods:['rotate']},constructor:function(r){this._tool=r;}});R.prototype.destroy=function(){this._tool=null;};R.prototype.activateTurntableMode=function(){this._tool._viewport._viewportGestureHandler._cameraController.isTurnTableMode=true;return this;};R.prototype.deactivateTurntableMode=function(){this._tool._viewport._viewportGestureHandler._cameraController.isTurnTableMode=false;return this;};R.prototype.rotate=function(d,a){this._tool._viewport._viewportGestureHandler._cameraController.rotate(d,a,true);this._tool.fireRotate({dx:d,dy:a});return this;};return R;},true);\n",
	"sap/ui/vk/library.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./TransformationMatrix','./DvlException','./Core'],function(q,T,D,C){'use strict';var l=q.sap.log;sap.ui.getCore().initLibrary({name:'sap.ui.vk',dependencies:['sap.ui.core'],types:['sap.ui.vk.CameraFOVBindingType','sap.ui.vk.CameraProjectionType','sap.ui.vk.ContentResourceSourceCategory','sap.ui.vk.dvl.GraphicsCoreApi','sap.ui.vk.SelectionMode','sap.ui.vk.TransformationMatrix','sap.ui.vk.VisibilityMode','sap.ui.vk.ZoomTo'],interfaces:['sap.ui.vk.DecryptionHandler','sap.ui.vk.AuthorizationHandler'],controls:['sap.ui.vk.ContainerBase','sap.ui.vk.ContainerContent','sap.ui.vk.FlexibleControl','sap.ui.vk.LegendItem','sap.ui.vk.ListPanel','sap.ui.vk.ListPanelStack','sap.ui.vk.MapContainer','sap.ui.vk.NativeViewport','sap.ui.vk.Notifications','sap.ui.vk.Overlay','sap.ui.vk.RedlineDesign','sap.ui.vk.RedlineSurface','sap.ui.vk.SceneTree','sap.ui.vk.StepNavigation','sap.ui.vk.Toolbar','sap.ui.vk.Viewer','sap.ui.vk.ViewGallery','sap.ui.vk.Viewport','sap.ui.vk.ViewportBase','sap.ui.vk.dvl.Viewport','sap.ui.vk.threejs.Viewport'],elements:['sap.ui.vk.ContentConnector','sap.ui.vk.OverlayArea','sap.ui.vk.RedlineElement','sap.ui.vk.RedlineElementEllipse','sap.ui.vk.RedlineElementFreehand','sap.ui.vk.RedlineElementLine','sap.ui.vk.RedlineElementText','sap.ui.vk.RedlineElementRectangle','sap.ui.vk.ViewStateManager','sap.ui.vk.ViewStateManagerBase','sap.ui.vk.dvl.ViewStateManager','sap.ui.vk.threejs.ViewStateManager'],noLibraryCSS:false,version:'1.64.0',designtime:'sap/ui/vk/designtime/library.designtime'});q.sap.registerModuleShims({'sap/ui/vk/threejs/thirdparty/three':{exports:'THREE',amd:true},'sap/ui/vk/ve/thirdparty/html2canvas':{exports:'html2canvas',amd:true},'sap/ui/vk/threejs/thirdparty/totara':{exports:'Totara',amd:true}});var a=function(b,s){var m='new extend getMetadata';if(s){m+=' '+s;}sap.ui.lazyRequire('sap.ui.vk.'+b,m);};a('Camera');a('ContentConnector','registerSourceType');a('ContentResource');a('ContentManager');a('DownloadManager');a('ImageContentManager');a('Loco');a('LayerProxy');a('NodeHierarchy');a('NodeProxy');a('Scene');a('View');a('ViewportHandler');a('dvl.GraphicsCore');a('dvl.BaseNodeProxy');a('dvl.ContentManager','getRuntimeSettings setRuntimeSettings getWebGLContextAttributes setWebGLContextAttributes getDecryptionHandler setDecryptionHandler');a('dvl.LayerProxy');a('dvl.NodeHierarchy');a('dvl.NodeProxy');a('dvl.Scene');a('threejs.BaseNodeProxy');a('threejs.ContentManager','registerLoader');a('threejs.LayerProxy');a('threejs.NodeHierarchy');a('threejs.NodeProxy');a('threejs.Billboard');a('threejs.Callout');a('threejs.DetailView');a('threejs.OrthographicCamera');a('threejs.PerspectiveCamera');a('threejs.Scene');sap.ui.vk.dvl.GraphicsCoreApi={LegacyDvl:'LegacyDvl'};sap.ui.vk.ContentResourceSourceCategory={'3D':'3D','2D':'2D'};sap.ui.vk.CameraProjectionType={Perspective:'perspective',Orthographic:'orthographic'};sap.ui.vk.CameraFOVBindingType={Minimum:'minimum',Maximum:'maximum',Horizontal:'horizontal',Vertical:'vertical'};sap.ui.vk.VisibilityMode={Complete:'complete',Differences:'differences'};sap.ui.vk.ZoomTo={All:'all',Visible:'visible',Selected:'selected',Node:'node',NodeSetIsolation:'node_setisolation',Restore:'restore',RestoreRemoveIsolation:'restore_removeisolation',ViewLeft:'view_left',ViewRight:'view_right',ViewTop:'view_top',ViewBottom:'view_bottom',ViewBack:'view_back',ViewFront:'view_front'};sap.ui.vk.SelectionMode={None:'none',Exclusive:'exclusive',Sticky:'sticky'};sap.ui.vk.RenderMode={Default:'Default',XRay:'XRay',LineIllustration:'LineIllustration',ShadedIllustration:'ShadedIllustration',SolidOutline:'SolidOutline'};sap.ui.vk.BillboardCoordinateSpace={Viewport:'Viewport',Screen:'Screen',World:'World'};sap.ui.vk.BillboardTextEncoding={PlainText:'PlainText',HtmlText:'HtmlText'};sap.ui.vk.BillboardStyle={RectangularShape:'RectangularShape',CircularShape:'CircularShape',None:'None',TextGlow:'TextGlow'};sap.ui.vk.BillboardBorderLineStyle={None:'None',Solid:'Solid',Dash:'Dash',Dot:'Dot',DashDot:'DashDot',DashDotDot:'DashDotDot'};sap.ui.vk.BillboardHorizontalAlignment={Left:'left',Center:'center',Right:'right'};sap.ui.vk.LeaderLineMarkStyle={None:'None',Point:'Point',Arrow:'Arrow'};sap.ui.vk.DetailViewType={DetailView:'DetailView',Cutaway:'Cutaway'};sap.ui.vk.DetailViewShape={Box:'Box',Circle:'Circle',CircleLine:'CircleLine',CirclePointer:'CirclePointer',CircleArrow:'CircleArrow',CircleBubbles:'CircleBubbles',BoxLine:'BoxLine',BoxNoOutline:'BoxNoOutline',SolidPointer:'SolidPointer',SolidArrow:'SolidArrow'};sap.ui.vk.MapContainerButtonType={Click:'Click',Toggle:'Toggle'};sap.ui.vk.ContentResourceSourceTypeToCategoryMap={'vds':sap.ui.vk.ContentResourceSourceCategory['3D'],'vdsl':sap.ui.vk.ContentResourceSourceCategory['3D'],'cgm':sap.ui.vk.ContentResourceSourceCategory['3D'],'png':sap.ui.vk.ContentResourceSourceCategory['2D'],'jpg':sap.ui.vk.ContentResourceSourceCategory['2D'],'jpeg':sap.ui.vk.ContentResourceSourceCategory['2D'],'gif':sap.ui.vk.ContentResourceSourceCategory['2D'],'bmp':sap.ui.vk.ContentResourceSourceCategory['2D'],'tiff':sap.ui.vk.ContentResourceSourceCategory['2D'],'tif':sap.ui.vk.ContentResourceSourceCategory['2D'],'svg':sap.ui.vk.ContentResourceSourceCategory['2D']};var d='sap.ve.dvl';sap.ui.vk.dvl.checkResult=function(r){if(r<0){var m=sap.ve.dvl.DVLRESULT.getDescription?sap.ve.dvl.DVLRESULT.getDescription(r):'';l.error(m,JSON.stringify({errorCode:r}),d);throw new D(r,m);}return r;};sap.ui.vk.dvl.getPointer=function(p){if(typeof p==='number'){var r=p;var m=sap.ve.dvl.DVLRESULT.getDescription?sap.ve.dvl.DVLRESULT.getDescription(r):'';l.error(m,JSON.stringify({errorCode:r}),d);throw new D(r,m);}return p;};sap.ui.vk.dvl.getJSONObject=function(o){if(typeof o==='number'){var r=o;var m=sap.ve.dvl.DVLRESULT.getDescription?sap.ve.dvl.DVLRESULT.getDescription(r):'';l.error(m,JSON.stringify({errorCode:r}),d);throw new D(r,m);}return o;};sap.ui.vk.getResourceBundle=function(){var r=sap.ui.getCore().getLibraryResourceBundle('sap.ui.vk.i18n');sap.ui.vk.getResourceBundle=function(){return r;};return r;};sap.ui.vk.utf8ArrayBufferToString=function(b){return decodeURIComponent(escape(String.fromCharCode.apply(null,new Uint8Array(b))));};sap.ui.vk.Redline={ElementType:{Line:'line',Rectangle:'rectangle',Ellipse:'ellipse',Freehand:'freehand',Text:'text'},svgNamespace:'http://www.w3.org/2000/svg'};sap.ui.vk.cssColorToColor=(function(){var i=false;var b=document.createElement('div');b.id='sap.ui.vk.colorConverter';b.style.setProperty('display','none','important');return function(c){if(!i){if(document.body){document.body.appendChild(b);i=true;}else{return{red:0,green:0,blue:0,alpha:1};}}b.style.setProperty('color','rgba(0, 0, 0, 0)','important');b.style.setProperty('color',c,'important');var e=window.getComputedStyle(b).color;if(e==='transparent'){return{red:0,green:0,blue:0,alpha:0};}else{var f=e.split('(')[1].split(')')[0].split(',');return{red:parseInt(f[0],10),green:parseInt(f[1],10),blue:parseInt(f[2],10),alpha:f.length===4?parseFloat(f[3]):1};}};})();sap.ui.vk.colorToCSSColor=function(c){return'rgba('+c.red+','+c.green+','+c.blue+','+c.alpha+')';};sap.ui.vk.abgrToColor=function(b){return{red:b&0xff,green:b>>>8&0xff,blue:b>>>16&0xff,alpha:(b>>>24&0xff)/255};};sap.ui.vk.colorToABGR=function(c){return(c.alpha*255<<24|c.blue<<16|c.green<<8|c.red)>>>0;};return sap.ui.vk;});\n",
	"sap/ui/vk/manifest.json":"{\n  \"_version\": \"1.9.0\",\n  \"sap.app\": {\n    \"id\": \"sap.ui.vk\",\n    \"type\": \"library\",\n    \"embeds\": [],\n    \"applicationVersion\": {\n      \"version\": \"1.64.0\"\n    },\n    \"title\": \"SAPUI5 Visualization Toolkit.\",\n    \"description\": \"SAPUI5 Visualization Toolkit.\",\n    \"ach\": \"CA-UI5-VTK\",\n    \"resources\": \"resources.json\",\n    \"offline\": true\n  },\n  \"sap.ui\": {\n    \"technology\": \"UI5\",\n    \"supportedThemes\": [\n      \"base\",\n      \"sap_belize\",\n      \"sap_belize_hcb\",\n      \"sap_belize_hcw\",\n      \"sap_belize_plus\",\n      \"sap_bluecrystal\",\n      \"sap_fiori_3\",\n      \"sap_hcb\"\n    ]\n  },\n  \"sap.ui5\": {\n    \"dependencies\": {\n      \"minUI5Version\": \"1.64\",\n      \"libs\": {\n        \"sap.ui.core\": {\n          \"minVersion\": \"1.64.0\"\n        },\n        \"sap.ui.unified\": {\n          \"minVersion\": \"1.64.0\",\n          \"lazy\": true\n        },\n        \"sap.m\": {\n          \"minVersion\": \"1.64.0\",\n          \"lazy\": true\n        },\n        \"sap.ui.layout\": {\n          \"minVersion\": \"1.64.0\",\n          \"lazy\": true\n        }\n      }\n    },\n    \"library\": {\n      \"i18n\": false,\n      \"content\": {\n        \"controls\": [\n          \"sap.ui.vk.ContainerBase\",\n          \"sap.ui.vk.ContainerContent\",\n          \"sap.ui.vk.FlexibleControl\",\n          \"sap.ui.vk.LegendItem\",\n          \"sap.ui.vk.ListPanel\",\n          \"sap.ui.vk.ListPanelStack\",\n          \"sap.ui.vk.MapContainer\",\n          \"sap.ui.vk.NativeViewport\",\n          \"sap.ui.vk.Notifications\",\n          \"sap.ui.vk.Overlay\",\n          \"sap.ui.vk.RedlineDesign\",\n          \"sap.ui.vk.RedlineSurface\",\n          \"sap.ui.vk.SceneTree\",\n          \"sap.ui.vk.StepNavigation\",\n          \"sap.ui.vk.Toolbar\",\n          \"sap.ui.vk.Viewer\",\n          \"sap.ui.vk.ViewGallery\",\n          \"sap.ui.vk.Viewport\",\n          \"sap.ui.vk.ViewportBase\",\n          \"sap.ui.vk.dvl.Viewport\",\n          \"sap.ui.vk.threejs.Viewport\"\n        ],\n        \"elements\": [\n          \"sap.ui.vk.ContentConnector\",\n          \"sap.ui.vk.OverlayArea\",\n          \"sap.ui.vk.RedlineElement\",\n          \"sap.ui.vk.RedlineElementEllipse\",\n          \"sap.ui.vk.RedlineElementFreehand\",\n          \"sap.ui.vk.RedlineElementLine\",\n          \"sap.ui.vk.RedlineElementText\",\n          \"sap.ui.vk.RedlineElementRectangle\",\n          \"sap.ui.vk.ViewStateManager\",\n          \"sap.ui.vk.ViewStateManagerBase\",\n          \"sap.ui.vk.dvl.ViewStateManager\",\n          \"sap.ui.vk.threejs.ViewStateManager\"\n        ],\n        \"types\": [\n          \"sap.ui.vk.CameraFOVBindingType\",\n          \"sap.ui.vk.CameraProjectionType\",\n          \"sap.ui.vk.ContentResourceSourceCategory\",\n          \"sap.ui.vk.dvl.GraphicsCoreApi\",\n          \"sap.ui.vk.SelectionMode\",\n          \"sap.ui.vk.TransformationMatrix\",\n          \"sap.ui.vk.VisibilityMode\",\n          \"sap.ui.vk.ZoomTo\"\n        ],\n        \"interfaces\": [\n          \"sap.ui.vk.DecryptionHandler\",\n          \"sap.ui.vk.AuthorizationHandler\"\n        ]\n      }\n    }\n  }\n}",
	"sap/ui/vk/threejs/BBoxSubdivider.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';var U=function(){this.unpack=function(p){if(!p||(p.bytelength<1)){return false;}try{this.nLevel=p[0];if(this.nLevel>5){return false;}this.numDivision=Math.pow(2,this.nLevel);this.octree=new Uint8Array(Math.pow(this.numDivision,3));this.streamOffset=1;this._decodeRecursive(p,0,0,0,0);}catch(e){return false;}return true;};this.GetUnpacked=function(){return this.octree;};this._setValue=function(g,a,b,v){this.octree[b*this.numDivision*this.numDivision+a*this.numDivision+g]=v?1:0;};this._decodeRecursive=function(p,g,a,b,l){if(l===this.nLevel){this._setValue(g,a,b,true);return true;}if(this.streamOffset>=p.length){return false;}var c=p[this.streamOffset];this.streamOffset++;g*=2;a*=2;b*=2;if(l>=this.nLevel){return true;}for(var z=0;z<2;z++){for(var y=0;y<2;y++){for(var x=0;x<2;x++){if((c&(1<<(z*4+y*2+x)))!==0){if(!this._decodeRecursive(p,g+x,a+y,b+z,l+1)){return false;}}else{this._clearBitsRecursive(g+x,a+y,b+z,l+1);}}}}return true;};this._clearBitsRecursive=function(g,a,b,l){if(l===this.nLevel){this._setValue(g,a,b,false);return;}g*=2;a*=2;b*=2;if(l>=this.nLevel){return;}for(var z=0;z<2;z++){for(var y=0;y<2;y++){for(var x=0;x<2;x++){this._clearBitsRecursive(g+x,a+y,b+z,l+1);}}}};};var C=function(n){this.numDivision=n;this.xyzToIndexMap=new Map();this.points=[];this.getOrCreatePointAt=function(x,y,z,f,d){var k=x+':'+y+':'+z+':'+f+':'+d;var i=this.xyzToIndexMap.get(k);if(i){return i;}this.points.push(x/this.numDivision-0.5,y/this.numDivision-0.5,z/this.numDivision-0.5);i=this.points.length/3-1;this.xyzToIndexMap.set(k,i);return i;};};var S=function(l,n,u){this.level=l;this.numDivision=n;this.unpacked=u;this.getValue=function(g,a,b){if(g<0||a<0||b<0||g>=this.numDivision||a>=this.numDivision||b>=this.numDivision){return 0;}return this.unpacked[b*this.numDivision*this.numDivision+a*this.numDivision+g];};};var B=function(){};B.unpackSubDividedBoundingBox=function(p){var u=new U();if(u.unpack(p)){return new S(u.nLevel,u.numDivision,u.unpacked);}return null;};B.makeSubDividedBoundingBoxGeometry=function(s){if(!s){return null;}var i=[];var n=s.level;var e=Math.pow(2,n);var m=new C(e);var x,y,z,f,a,b,c,d;for(x=0;x<=e;x++){for(y=0;y<e;y++){for(z=0;z<e;z++){f=s.getValue(x,y,z)-s.getValue(x-1,y,z);if(f!==0){a=m.getOrCreatePointAt(x,y,z,0,f);b=m.getOrCreatePointAt(x,y+1,z,0,f);c=m.getOrCreatePointAt(x,y+1,z+1,0,f);d=m.getOrCreatePointAt(x,y,z+1,0,f);if(f<0){i.push(a,b,c);i.push(a,c,d);}else{i.push(c,b,a);i.push(d,c,a);}}}}}for(y=0;y<=e;y++){for(x=0;x<e;x++){for(z=0;z<e;z++){f=s.getValue(x,y,z)-s.getValue(x,y-1,z);if(f!==0){a=m.getOrCreatePointAt(x,y,z,1,f);b=m.getOrCreatePointAt(x+1,y,z,1,f);c=m.getOrCreatePointAt(x+1,y,z+1,1,f);d=m.getOrCreatePointAt(x,y,z+1,1,f);if(f>0){i.push(a,b,c);i.push(a,c,d);}else{i.push(c,b,a);i.push(d,c,a);}}}}}for(z=0;z<=e;z++){for(x=0;x<e;x++){for(y=0;y<e;y++){f=s.getValue(x,y,z)-s.getValue(x,y,z-1);if(f!==0){a=m.getOrCreatePointAt(x,y,z,2,f);b=m.getOrCreatePointAt(x+1,y,z,2,f);c=m.getOrCreatePointAt(x+1,y+1,z,2,f);d=m.getOrCreatePointAt(x,y+1,z,2,f);if(f<0){i.push(a,b,c);i.push(a,c,d);}else{i.push(c,b,a);i.push(d,c,a);}}}}}var g=new THREE.BufferGeometry();var h=new THREE.BufferAttribute(new Uint16Array(i),1);var p=new THREE.BufferAttribute(new Float32Array(m.points),3);g.setIndex(h);g.addAttribute('position',p);g.computeFaceNormals();g.computeVertexNormals();g.computeBoundingSphere();return g;};return B;});\n",
	"sap/ui/vk/threejs/BaseNodeProxy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../BaseNodeProxy'],function(q,l,B){'use strict';var a=B.extend('sap.ui.vk.threejs.BaseNodeProxy',{metadata:{}});a.prototype.init=function(n,b){this._object3D=b;};a.prototype.reset=function(){this._object3D=null;};a.prototype.getNodeRef=function(){return this._object3D;};a.prototype.getNodeId=function(){return this._object3D;};a.prototype.getName=function(){return this._object3D.name||('<'+this._object3D.type+'>');};a.prototype.getNodeMetadata=function(){return this._object3D.userData.metadata;};a.prototype.getHasChildren=function(){return this._object3D.children.length>0;};a.prototype.getSceneRef=function(){return this._object3D;};return a;});\n",
	"sap/ui/vk/threejs/Billboard.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','./thirdparty/three','sap/ui/base/ManagedObject','../ve/thirdparty/html2canvas'],function(q,l,t,B,h){'use strict';var b=B.extend('sap.ui.vk.threejs.Billboard',{metadata:{properties:{text:{type:'string',defaultValue:'Annotation'},font:{type:'string',defaultValue:''},fontSize:{type:'float',defaultValue:20},fontWeight:{type:'string',defaultValue:'normal'},fontItalic:{type:'boolean',defaultValue:false},textColor:{type:'sap.ui.core.CSSColor',defaultValue:'#fff'},borderColor:{type:'sap.ui.core.CSSColor',defaultValue:'#fff'},borderOpacity:{type:'float',defaultValue:1},backgroundColor:{type:'sap.ui.core.CSSColor',defaultValue:'#fff'},backgroundOpacity:{type:'float',defaultValue:0.5},encoding:{type:'sap.ui.vk.BillboardTextEncoding',defaultValue:sap.ui.vk.BillboardTextEncoding.PlainText},width:{type:'float',defaultValue:100},height:{type:'float',defaultValue:100},style:{type:'sap.ui.vk.BillboardStyle',defaultValue:sap.ui.vk.BillboardStyle.None},borderLineStyle:{type:'sap.ui.vk.BillboardBorderLineStyle',defaultValue:sap.ui.vk.BillboardBorderLineStyle.Solid},borderWidth:{type:'float',defaultValue:2},horizontalAlignment:{type:'sap.ui.vk.BillboardHorizontalAlignment',defaultValue:sap.ui.vk.BillboardHorizontalAlignment.Left},texture:{type:'any',defaultValue:null},link:{type:'string',defaultValue:''},coordinateSpace:{type:'sap.ui.vk.BillboardCoordinateSpace',defaultValue:sap.ui.vk.BillboardCoordinateSpace.Viewport},position:{type:'any',defaultValue:new THREE.Vector3(0,0,0)},renderOrder:{type:'int',defaultValue:0}}},constructor:function(i,s,S){B.apply(this,arguments);var g=new THREE.BufferGeometry();g.setIndex([0,1,2,2,1,3]);g.addAttribute('position',new THREE.Float32BufferAttribute([-0.5,-0.5,0,0.5,-0.5,0,-0.5,0.5,0,0.5,0.5,0],3));g.addAttribute('normal',new THREE.Float32BufferAttribute([0,0,1,0,0,1,0,0,1,0,0,1],3));g.addAttribute('uv',new THREE.Float32BufferAttribute([0,0,1,0,0,1,1,1],2));var m=new THREE.MeshBasicMaterial({map:this.getTexture(),depthTest:false,depthWrite:false,transparent:true,alphaTest:0.05,premultipliedAlpha:true,side:THREE.DoubleSide});this._billboard=new THREE.Mesh(g,m);this._billboard.renderOrder=this.getRenderOrder();this._updateTexture();this._node=new THREE.Group();this._node.add(this._billboard);this._node.matrixAutoUpdate=false;this._node.isBillboard=true;this._node.userData.billboard=this;}});b.prototype.setEncoding=function(v){this.setProperty('encoding',v,true);this._updateTexture();return this;};b.prototype.setText=function(v){this.setProperty('text',v,true);this._updateTexture();return this;};b.prototype.setFont=function(v){this.setProperty('font',v,true);this._updateTexture();return this;};b.prototype.setFontSize=function(v){this.setProperty('fontSize',v,true);this._updateTexture();return this;};b.prototype.setFontWeight=function(v){this.setProperty('fontWeight',v,true);this._updateTexture();return this;};b.prototype.setFontItalic=function(v){this.setProperty('fontItalic',v,true);this._updateTexture();return this;};b.prototype.setStyle=function(v){this.setProperty('style',v,true);this._updateTexture();return this;};b.prototype.setWidth=function(v){this.setProperty('width',v,true);this._updateTexture();return this;};b.prototype.setHeight=function(v){this.setProperty('height',v,true);this._updateTexture();return this;};b.prototype.setTextColor=function(v){this.setProperty('textColor',v,true);this._updateTexture();return this;};b.prototype.setBackgroundColor=function(v){this.setProperty('backgroundColor',v,true);this._updateTexture();return this;};b.prototype.setBackgroundOpacity=function(v){this.setProperty('backgroundOpacity',v,true);this._updateTexture();return this;};b.prototype.setBorderWidth=function(v){this.setProperty('borderWidth',v,true);this._updateTexture();return this;};b.prototype.setBorderLineStyle=function(v){this.setProperty('borderLineStyle',v,true);this._updateTexture();return this;};b.prototype.setBorderColor=function(v){this.setProperty('borderColor',v,true);this._updateTexture();return this;};b.prototype.setBorderOpacity=function(v){this.setProperty('borderOpacity',v,true);this._updateTexture();return this;};b.prototype.setHorizontalAlignment=function(v){this.setProperty('horizontalAlignment',v,true);this._updateTexture();return this;};b.prototype.setLink=function(v){this.setProperty('link',v,true);this._updateTexture();return this;};b.prototype.setTexture=function(v){this.setProperty('texture',v,true);if(this._billboard){this._billboard.material.map=v;}return this;};b.prototype.setRenderOrder=function(v){this.setProperty('renderOrder',v,true);if(this._billboard){this._billboard.renderOrder=v;}return this;};b.prototype._renderBackground=function(a,w,e,f){a.fillStyle=this.getBackgroundColor();a.strokeStyle=this.getBorderColor();a.lineWidth=f;switch(this.getBorderLineStyle()){default:a.setLineDash([]);break;case sap.ui.vk.BillboardBorderLineStyle.Dash:a.setLineDash([f*5,f]);break;case sap.ui.vk.BillboardBorderLineStyle.Dot:a.setLineDash([f*2,f]);break;case sap.ui.vk.BillboardBorderLineStyle.DashDot:a.setLineDash([f*5,f,f*2,f]);break;case sap.ui.vk.BillboardBorderLineStyle.DashDotDot:a.setLineDash([f*5,f,f*2,f,f*2,f]);break;}var g=f/2;if(this.getStyle()===sap.ui.vk.BillboardStyle.RectangularShape){a.globalAlpha=this.getBackgroundOpacity();if(a.globalAlpha>0){a.fillRect(0,0,w,e);}a.globalAlpha=f>0?this.getBorderOpacity():0;if(a.globalAlpha>0){a.strokeRect(g,g,w-f,e-f);}}else if(this.getStyle()===sap.ui.vk.BillboardStyle.CircularShape){var x=w/2;var y=e/2;var r=w/2;a.beginPath();a.arc(x,y,r-g,0,2*Math.PI);a.closePath();a.globalAlpha=this.getBackgroundOpacity();if(a.globalAlpha>0){a.fill();}a.globalAlpha=f>0?this.getBorderOpacity():0;if(a.globalAlpha>0){a.stroke();}}a.globalAlpha=1;a.setLineDash([]);};b.prototype._getFont=function(a){return(this.getFontItalic()?'italic ':'')+this.getFontWeight()+' '+(this.getFontSize()*a)+'px '+(this.getFont()||'Arial');};b.prototype._renderPlainText=function(e){var f=document.createElement('canvas');var g=f.getContext('2d');var j=this.getFontSize()*e;var k=this._getFont(e);g.font=k;var m=Math.ceil(j);var n=this.getBorderLineStyle()!==sap.ui.vk.BillboardBorderLineStyle.None?this.getBorderWidth()*e:0;var o=Math.ceil(j*0.2+n);var r=this.getText().split('\\n');var s=0;r.forEach(function(C){s=Math.max(s,g.measureText(C).width);});var u=this.getLink();if(u.length>0){s=Math.max(s,g.measureText(u).width);}s=Math.ceil(s*0.5)*2;var v=r.length+(u.length>0?1:0);var w=Math.ceil(m*v*0.5)*2;var z=s+o*2;var A=w+o*2;if(this.getStyle()===sap.ui.vk.BillboardStyle.CircularShape){z=A=Math.max(z,A);}this._width=z/e;this._height=A/e;f.width=THREE.Math.ceilPowerOfTwo(z);f.height=THREE.Math.ceilPowerOfTwo(A);this._renderBackground(g,z,A,n);g.font=k;g.textAlign=this.getHorizontalAlignment();g.textBaseline='middle';var a=['left','center','right'].indexOf(g.textAlign);var x=(z+s*(a-1))>>1;var y=(A-(v-1)*m)>>1;g.fillStyle=this.getTextColor();g.filter='blur(0px)';for(var i in r){g.fillText(r[i],x,y+m*i);}if(u.length>0){g.fillStyle='#00f';g.textAlign='right';g.textBaseline='bottom';g.fillText(u,z-o,A-o);}this._setBillboardTexture(f,z,A);};b.prototype._renderHtmlText=function(a){var e=document.createElement('canvas');var f=e.getContext('2d');var g=this.getBorderLineStyle()!==sap.ui.vk.BillboardBorderLineStyle.None?this.getBorderWidth()*a:0;var m=Math.ceil(g);var w=Math.ceil(this.getWidth()*a)+m*2;var i=Math.ceil(this.getHeight()*a)+m*2;if(this.getStyle()===sap.ui.vk.BillboardStyle.CircularShape){w=i=Math.max(w,i);}this._width=w/a;this._height=i/a;e.width=THREE.Math.ceilPowerOfTwo(w);e.height=THREE.Math.ceilPowerOfTwo(i);this._renderBackground(f,w,i,g);var j=this.getLink();if(j.length>0){f.font=this._getFont(a);f.fillStyle='#00f';f.textAlign='right';f.textBaseline='bottom';f.fillText(j,w-m,i-m);}var k=document.createElement('iframe');k.style.visibility='hidden';k.width=(w-m*2)/a;k.height=(i-m*2)/a;document.body.appendChild(k);var n=k.contentDocument||k.contentWindow.document;n.open();n.close();n.body.innerHTML=this.getText();var o=document.createElement('canvas');o.width=k.width*a;o.height=k.height*a;o.style.width=k.width+'px';o.style.height=k.height+'px';var r=o.getContext('2d');r.scale(a,a);this._billboard.material.visible=false;h(n.body,{canvas:o}).then(function(o){if(o.width>0&&o.height>0){e.getContext('2d').drawImage(o,m,m);}setTimeout(this._setBillboardTexture.bind(this,e,w,i),0);document.body.removeChild(k);}.bind(this));};b.prototype._setBillboardTexture=function(a,w,e){var u=w/a.width,v=e/a.height;this._billboard.geometry.addAttribute('uv',new THREE.Float32BufferAttribute([0,1-v,u,1-v,0,1,u,1],2));var f=new THREE.CanvasTexture(a);f.magFilter=THREE.NearestFilter;this._billboard.material.map=f;this._billboard.material.needsUpdate=true;this._billboard.material.visible=true;};b.prototype._updateTexture=function(){if(!this._billboard||this.getTexture()){this._width=this.getWidth();this._height=this.getHeight();return;}switch(this.getEncoding()){default:case sap.ui.vk.BillboardTextEncoding.PlainText:this._renderPlainText(window.devicePixelRatio);break;case sap.ui.vk.BillboardTextEncoding.HtmlText:this._renderHtmlText(window.devicePixelRatio);break;}};var p=new THREE.Vector4(),c=new THREE.Vector3(),d=new THREE.Vector3();b.prototype._update=function(r,a){this._node.matrix.getInverse(this._node.parent.matrixWorld);this._node.matrix.decompose(this._node.position,this._node.rotation,this._node.scale);this._node.matrixWorld.identity();this._billboard.rotation.copy(a.rotation);var v=r.getSize(),s=this.getPosition(),e=this._billboard.position,f=1;if(s){e.copy(s);}else{e.setScalar(0);}var g=this.getCoordinateSpace();if(g===sap.ui.vk.BillboardCoordinateSpace.Screen){e.multiplyScalar(2/a.projectionMatrix.elements[5]);e.z=-1;f=(a.near+a.far)*0.5;e.multiplyScalar(f).applyMatrix4(a.matrixWorld);}else if(g===sap.ui.vk.BillboardCoordinateSpace.Viewport){if(v.width>v.height){e.x*=v.height/v.width;}else{e.y*=v.width/v.height;}e.unproject(a);p.copy(e).applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix);var i=(p.x/p.w)*0.5*v.width,j=(p.y/p.w)*0.5*v.height;f=p.w*2/(v.width*a.projectionMatrix.elements[0]);c.setFromMatrixColumn(a.matrixWorld,0).multiplyScalar(f*(Math.round(i)-i));d.setFromMatrixColumn(a.matrixWorld,1).multiplyScalar(f*(Math.round(j)-j));e.add(c).add(d);}this._billboard.scale.set(this._width*f,this._height*f,1);this._billboard.updateMatrixWorld();};return b;});\n",
	"sap/ui/vk/threejs/Callout.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','./thirdparty/three','sap/ui/base/ManagedObject','./Billboard','../ve/thirdparty/html2canvas','./PolylineGeometry','./PolylineMaterial','./PolylineMesh'],function(Q,a,b,B,c,d,P,e,f){'use strict';var C=c.extend('sap.ui.vk.threejs.Callout',{metadata:{properties:{anchorNode:{type:'any',defaultValue:null},depthTest:{type:'boolean',defaultValue:true}}},constructor:function(i,s,S){c.apply(this,arguments);this._billboard.material.depthTest=this.getDepthTest();this._lines=[];}});C.prototype.setRenderOrder=function(h){c.prototype.setRenderOrder.call(this,h);if(this._lines){this._lines.forEach(function(l){l.renderOrder=h;});}return this;};C.prototype.setDepthTest=function(h){this.setProperty('depthTest',h,true);if(this._billboard){this._billboard.material.depthTest=h;this._lines.forEach(function(l){l.material.depthTest=h;});}return this;};var g=new THREE.Vector4(),j=new THREE.Vector4(),k=new THREE.Vector4(),m=new THREE.Vector2(),n=new THREE.Vector2(),o=new THREE.Vector2(),q=new THREE.Quaternion(),r=new THREE.Matrix4(),u=new THREE.Vector2(),v=new THREE.Vector3(),w=new THREE.Vector3(),z=new THREE.Vector3(0,0,1),A=new THREE.Vector2(),D=new THREE.Matrix4(),E=new THREE.Matrix4();C.prototype._update=function(h,i){this._node.matrix.getInverse(this._node.parent.matrixWorld);this._node.matrix.decompose(this._node.position,this._node.rotation,this._node.scale);this._node.matrixWorld.identity();var l=h.getSize(),s=this.getPosition(),x=this._billboard.position;if(s){x.copy(s);}else{x.setScalar(0);}var y=this.getAnchorNode();if(y){x.applyMatrix4(y.matrixWorld);}this._billboard.rotation.copy(i.rotation);A.set(l.width,l.height);D.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse);g.copy(x).applyMatrix4(D);m.copy(g).multiplyScalar(1/g.w).multiply(A);var F=g.w*2/(A.x*i.projectionMatrix.elements[0]);this._billboard.scale.set(F*this._width,F*this._height,1);v.setFromMatrixColumn(i.matrixWorld,0).multiplyScalar(F*(Math.round(m.x*0.5)-m.x*0.5));w.setFromMatrixColumn(i.matrixWorld,1).multiplyScalar(F*(Math.round(m.y*0.5)-m.y*0.5));x.add(v).add(w);this._billboard.updateMatrixWorld();var G=this.getStyle()===sap.ui.vk.BillboardStyle.CircularShape;var H=i.near;function I(p,t,J){if(p<t){return p-t;}else if(p>J){return p-J;}return 0;}this._lines.forEach(function(p){if(p.userData.targetNode){p.matrix.copy(p.userData.targetNode.matrixWorld);}else{p.matrix.identity();}p.matrixWorld.copy(p.matrix);if(p.isPolylineMesh){p.material.resolution.copy(A);}if(p.isHaloMesh){return;}var J=p.geometry.vertices;var K=J[0];var L=J[J.length-2];var M=J[J.length-1];var N=p.userData.startPointMesh;var O=false;var R=[0,J.length-1];if(N!==undefined){K.copy(N.userData.targetVertex);}E.multiplyMatrices(D,p.matrixWorld);if(p.userData.extensionLength>0&&J.length>2){R.push(J.length-2);g.copy(J[J.length-3]).applyMatrix4(E);n.copy(g).multiplyScalar(1/g.w).multiply(A);L.set(Math.sign(n.x-m.x)*0.5*(1+p.userData.extensionLength/this._width),0,0);L.applyMatrix4(this._billboard.matrixWorld).applyMatrix4(r.getInverse(p.matrixWorld));}g.copy(L).applyMatrix4(E);n.copy(g).multiplyScalar(1/g.w).multiply(A);if(G){var S=u.copy(n).sub(m).length();O=S<this._width;u.multiplyScalar(0.5/S);M.set(u.x,u.y,0);}else{var T=I(n.x,m.x-this._width,m.x+this._width),U=I(n.y,m.y-this._height,m.y+this._height);O=(T===0&&U===0);if(Math.abs(T)>Math.abs(U)){M.set(Math.sign(T)*0.5,0,0);}else{M.set(0,Math.sign(U)*0.5,0);}}if(O){M.copy(L);}else{M.applyMatrix4(this._billboard.matrixWorld).applyMatrix4(r.getInverse(p.matrixWorld));}p.geometry.verticesNeedUpdate=true;if(N!==undefined){N.position.copy(N.userData.targetVertex).applyMatrix4(p.matrixWorld);g.copy(N.position).applyMatrix4(D);var V=g.w/(A.x*i.projectionMatrix.elements[0]);N.scale.setScalar(V);N.visible=false;var W=false;if(g.w>=H){j.copy(g);k.copy(J[1]).applyMatrix4(E);if(k.w<H){var t=(j.w-H)/(j.w-k.w);k.sub(j).multiplyScalar(t).add(j);}o.copy(j).multiplyScalar(1/j.w);n.copy(k).multiplyScalar(1/k.w);u.copy(n).sub(o).multiply(A);W=u.length()<N.userData.lineOffset;q.setFromAxisAngle(z,Math.atan2(u.y,u.x));N.quaternion.copy(i.quaternion).multiply(q);N.matrix.compose(N.position,N.quaternion,N.scale);N.matrixWorld.copy(N.matrix);o.multiply(A).sub(m);N.visible=G?o.length()>this._width:Math.abs(o.x)>this._width||Math.abs(o.y)>this._height;if(W||!N.visible){K.copy(J[1]);}else{K.set(N.userData.lineOffset,0,0).applyMatrix4(N.matrixWorld).applyMatrix4(r.getInverse(p.matrixWorld));}}}p.geometry._updateVertices(R);p.computeLineDistances(E,A,H);if(p.userData.haloMesh){p.userData.haloMesh.material.lineLength=p.material.lineLength;}}.bind(this));};C.prototype._createMarkMesh=function(p,t,F,G){var H=F===sap.ui.vk.LeaderLineMarkStyle.Arrow;var I=window.devicePixelRatio;var J=t.width;var K=J*t.haloWidth;G=(Array.isArray(G)||G instanceof Float32Array)&&G.length===2?G:[1,1];var L,M;if(H){L=Math.max(35*G[0],J*5);M=Math.max(15*G[1],J*2);}else{L=M=Math.max(2*G[0],J*2);}L=Math.ceil(L+K*2);M=Math.ceil(M+K*2);var N=document.createElement('canvas');N.width=THREE.Math.ceilPowerOfTwo(L*I);N.height=THREE.Math.ceilPowerOfTwo(M*I);var O=N.getContext('2d');var x=L/2,y=M/2;O.fillStyle='#FFF';O.scale(I,I);if(H){O.beginPath();O.moveTo(0,y);O.lineTo(L,0);O.lineTo(L,M);O.closePath();O.fill();var h=L*y/Math.sqrt(L*L+y*y),s=(h-K)/h;var R=L-L*s,S=y*(L*s-K)/L;O.fillStyle=p.getStyle();O.beginPath();O.moveTo(R,y);O.lineTo(L-K,y-S);O.lineTo(L-K,y+S);O.closePath();O.fill();}else{var T=L*0.5,U=T-K;O.beginPath();O.ellipse(x,y,T,T,0,0,Math.PI*2);O.fill();O.fillStyle=p.getStyle();O.beginPath();O.ellipse(x,y,U,U,0,0,Math.PI*2);O.fill();}O.fillRect(L-K,y-J*0.5,K,J);var V=new THREE.MeshBasicMaterial({map:new THREE.CanvasTexture(N),flatShading:true,transparent:true,alphaTest:0.05,premultipliedAlpha:true,side:THREE.DoubleSide,depthTest:this.getDepthTest()});var W=new THREE.PlaneBufferGeometry(L*2,M*2);if(H){W.translate(L,0,0);}var X=new THREE.Mesh(W,V);X.matrixAutoUpdate=false;X.renderOrder=this.getRenderOrder();X.userData.lineOffset=(H?L*2-1:L-K*2);var Y=new THREE.Vector2(L*I/N.width,M*I/N.height);var Z=X.geometry.attributes.uv.array;for(var i=0,l=Z.length;i<l;i+=2){Z[i]*=Y.x;Z[i+1]=1-(1-Z[i+1])*Y.y;}return X;};C.prototype.addLeaderLine=function(h,t,i,s,l,p,x){if(x>0&&h.length<3){h.push(h[h.length-1].clone());}var y=i.userData.lineStyle||{};y.width=y.width||1;y.haloWidth=y.haloWidth||0;y.endCapStyle=y.endCapStyle||0;var F=y.endCapStyle||h.length>2?1:0;var G=(F&&(s!==sap.ui.vk.LeaderLineMarkStyle.None||y.endCapStyle===0)?1:0)|(F&&(l!==sap.ui.vk.LeaderLineMarkStyle.None||y.endCapStyle===0)?2:0);var H=new P();H.setVertices(h);var I;if(y.haloWidth>0){var J=new e({color:0xFFFFFF,lineColor:0xFFFFFF,linewidth:y.width*(y.haloWidth*2+1),dashCapStyle:y.endCapStyle,segmentCapStyle:F,trimStyle:G,transparent:true,depthTest:this.getDepthTest()});I=new f(H,J);I.userData.targetNode=t;I.matrixAutoUpdate=false;I.renderOrder=this.getRenderOrder();I.isHaloMesh=true;this._node.add(I);this._lines.push(I);}var K=new e({color:0xFFFFFF,lineColor:i.color,linewidth:y.width,dashCapStyle:y.endCapStyle,segmentCapStyle:F,trimStyle:G,dashPattern:y.dashPattern||[],dashScale:y.dashPatternScale||1,transparent:true,depthTest:this.getDepthTest()});var L=new f(H,K);L.userData.targetNode=t;L.userData.extensionLength=x;L.userData.haloMesh=I;L.matrixAutoUpdate=false;L.renderOrder=this.getRenderOrder();this._node.add(L);this._lines.push(L);if(s!==sap.ui.vk.LeaderLineMarkStyle.None){var M=this._createMarkMesh(i.color,y,s,p);M.userData.targetVertex=H.vertices[0].clone();L.userData.startPointMesh=M;this._node.add(M);}return L;};return C;});\n",
	"sap/ui/vk/threejs/ContentDeliveryService.js":"/*!\n* SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n*/\nsap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject','./thirdparty/three','sap/ui/vk/totara/TotaraLoader','./PerspectiveCamera','./OrthographicCamera','sap/ui/vk/View','./Material'],function(q,M,t,T,P,O,V,a){'use strict';var C=M.extend('sap.ui.vk.threejs.ContentDeliveryService',{metadata:{properties:{authorizationHandler:'any'},events:{cameraChanged:{parameters:{sceneId:{type:'string'},camera:{type:'any'}},enableEventBubbling:true},sceneUpdated:{parameters:{},enableEventBubbling:true},viewGroupUpdated:{parameters:{},enableEventBubbling:true},errorReported:{parameters:{error:{type:'any'}}}}}});var b=C.getMetadata().getParent().getClass().prototype;C.prototype.init=function(){if(b.init){b.init.call(this);}this._loader=null;this._transientSceneMap=new Map();this._currentNodeHierarchy=null;};C.prototype.initUrl=function(u,k){var c=this;function n(){c.fireSceneUpdated({});}function d(){c.fireViewGroupUpdated({});}if(!c._loader||c._loader.getUrl()!==u){this._loader=new T();var s=this._loader.getState();s.onErrorCallbacks.attach(this._reportError.bind(c));s.onMaterialFinishedCallbacks.attach(n);s.onImageFinishedCallbacks.attach(n);s.onSetGeometryCallbacks.attach(n);s.onViewGroupUpdatedCallbacks.attach(d);return this._loader.init(u);}else if(!k){var e=this._loader.getState();if(e){e.cleanup();}}return Promise.resolve('Loader is ready');};C.prototype._reportError=function(e){this.fireErrorReported(e);};C.prototype._createLoadParam=function(r,c,p,d){var e=this;var i;var s=false;var f={root:p,includeHidden:d.getIncludeHidden(),includeAnimation:d.getIncludeAnimation(),pushPMI:d.getPushPMI(),metadataFilter:d.getMetadataFilter(),useSecureConnection:d.getUseSecureConnection(),activateView:d.getActivateView(),enableLogger:d.getEnableLogger()===true,pushViewGroups:d.getPushViewGroups(),onActiveCamera:function(n){var h=false;var j=e._loader.getState();if(j){var k=j.contextMap.get(d.getVeid());if(k&&k.phase<2){i=n;h=true;}}if(!h){e.fireCameraChanged({sceneId:d.getVeid(),camera:n});}},onInitialSceneFinished:function(){s=true;r({node:p,camera:i,contentResource:d,loader:e});}};var g=function(h){var j;if(h.getParameter('errorText')){j=h.getParameter('errorText');}else if(h.getParameter('error')){j=h.getParameter('error');}else if(h.getParameter('reason')){j=h.getParameter('reason');}else{j='failed to load: unknown reason';}if(s){var k=h.getParameter('error');if(k&&k===4){this.initUrl(this._loader.getUrl(),true);}}else{e.detachErrorReported(g);if(h.getParameter('events')){j=j+'\\n'+JSON.stringify(h.getParameter('events'));}c(j);}};e.attachErrorReported(g);return f;};C.prototype.load=function(p,c,d){var e=this;var n=c.getNodeProxy();if(n){this._currentNodeHierarchy=n.getNodeHierarchy();}return new Promise(function(r,f){if(!c.getSource()||!c.getVeid()){f('url or veid not specified');return;}e.initUrl(c.getSource(),true);var g=e._createLoadParam(r,f,p,c);if(e._loader){e._loader.request(c.getVeid(),g,d);}});};C.prototype.getState=function(){if(this._loader){return this._loader.getState();}return null;};C.prototype.getSceneBuilder=function(){if(this._loader){return this._loader.getSceneBuilder();}return null;};C.prototype.decrementResourceCountersForDeletedTreeNode=function(s){var c=this.getState();if(c){var d=c.getContext(c.currentSceneInfo.id);this._loader.decrementResourceCountersForDeletedTreeNode(c,d,s);}};C.prototype.loadTransientScene=function(s,p,u){var c=this;return new Promise(function(r,d){if(!s||!p){d('invalid arguments');return;}if(c._transientSceneMap.has(s)){var e=c._transientSceneMap.get(s).clone();p.add(e);r({nodeRef:e});return;}if(!c._loader){d('ContentDeliveryService is not initialised');return;}var f=new THREE.Object3D();f.name='transient';var o=function(){var h=c._loader.getState().getContext(s);h.onSceneCompletedCallbacks.detach(o);c._transientSceneMap.set(s,f);var e=f.clone();p.add(e);r({nodeRef:e});};var g={root:f,onSceneCompleted:o,useSecureConnection:u};c._loader.request(s,g);});};C.prototype.update=function(s,c,v){var d=this;return new Promise(function(r,e){if(!d._loader){e('ContentDeliveryService is not initialised');return;}d._loader.update(s,c,v).then(function(f){if(d._currentNodeHierarchy){for(var i=0;i<f.replacedNodeRefs.length;i++){d._currentNodeHierarchy.fireNodeReplaced({ReplacedNodeRef:f.replacedNodeRefs[i],ReplacementNodeRef:f.replacementNodeRefs[i],ReplacedNodeId:f.replacedNodeRefs[i],ReplacementNodeId:f.replacementNodeRefs[i]});}}r({sceneVeId:f.sceneVeId,sids:f.sidArray});}).catch(function(f){return e(f);});});};C.prototype.exit=function(){if(b.exit){b.exit.call(this);}if(this._loader){this._loader.dispose();this._loader=null;}this._transientSceneMap=null;};C.prototype.loadView=function(s,v,c,u){if(typeof c==='undefined'){c='static';}var d=this;return this._loader.requestView(s,c,v,u).then(function(e){if(d._currentNodeHierarchy){for(var i=0;i<e.updatedNodes.length;i++){d._currentNodeHierarchy.fireNodeUpdated({nodeRef:e.updatedNodes[i]});}}d.fireSceneUpdated({});return e;}).catch(function(e){q.sap.log.error(e);return null;});};C.prototype.loadViewGroup=function(s,v){var c=this;return this._loader.requestViewGroup(s,v).then(function(d){c.fireSceneUpdated({});return d;}).catch(function(e){q.sap.log.error(e);return null;});};C.prototype.assignMaterialToNodes=function(s,m,n,c){var d=this;return this._loader.requestMaterial(m).then(function(e){function f(e,k,r){if(!k){return;}if(k.userData.markedForNotAssigningMaterial){delete k.userData.markedForNotAssigningMaterial;return;}if(d._currentNodeHierarchy){var l=d._currentNodeHierarchy.createNodeProxy(k);var o=new a();o.setMaterialRef(e);l.assignMaterial(o);}if(r){k.children.forEach(function(p){if(!p){return;}f(e,p,r);});}}if(!c){for(var i=0;i<n.length;i++){f(e,n[i]);}}else{for(var j=0;j<n.length;j++){n[j].userData.markedForNotAssigningMaterial=true;}var g=d._loader.getState().contextMap.get(s);var h=g.root;f(e,h,true);}d.fireSceneUpdated({});return true;}).catch(function(e){q.sap.log.error(e);return false;});};C.prototype.printLogTokens=function(){if(this._loader){this._loader.printLogTokens();return true;}else{return false;}};return C;});\n",
	"sap/ui/vk/threejs/ContentManager.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./thirdparty/three','../ContentManager','./Scene','../TransformationMatrix','./PerspectiveCamera','./OrthographicCamera','../Messages'],function(q,t,C,S,T,P,O,M){'use strict';var a=C.extend('sap.ui.vk.threejs.ContentManager',{metadata:{library:'sap.ui.vk'}});var b=a.getMetadata().getParent().getClass().prototype;a.prototype.init=function(){if(b.init){b.init.call(this);}};a.prototype.exit=function(){if(b.exit){b.exit.call(this);}};function s(o){if(o&&o.isMesh){o.castShadow=true;o.receiveShadow=false;}if(o&&o.children){for(var n=0;n<o.children.length;n++){s(o.children[n]);}}}function c(n,e){if(n){var f=new THREE.Group();n.add(f);f.name='DefaultLights';f.private=true;var g=new THREE.Box3().setFromObject(n);var h=new THREE.Vector3();g.getSize(h);var m=h.length();var p=new THREE.PointLight();p.color.copy(new THREE.Color(0.72,0.72,0.81));g.getCenter(p.position);p.visible=true;p.private=true;f.add(p);var i=[new THREE.Color(0.2,0.2,0.2),new THREE.Color(0.32,0.32,0.36),new THREE.Color(0.36,0.36,0.36)];var j=[new THREE.Vector3(2.0,1.5,0.5),new THREE.Vector3(-2.0,-1.1,2.5),new THREE.Vector3(-0.04,-0.01,-2.0)];for(var l=0,k=i.length;l<k;l++){var o=new THREE.DirectionalLight();o.color.copy(i[l]);o.position.copy(j[l]);o.private=true;f.add(o);}if(e){s(n);var r=new THREE.DirectionalLight();r.color.copy(new THREE.Color(0.5,0.5,0.5));r.position.copy(new THREE.Vector3(0,1.0,0));r.castShadow=true;r.shadow.mapSize.width=512;r.shadow.mapSize.height=512;var d=2000;r.shadow.camera.left=-d;r.shadow.camera.right=d;r.shadow.camera.top=d;r.shadow.camera.bottom=-d;r.shadow.camera.far=3500;r.shadow.bias=-0.0001;r.private=true;f.add(r);var u=new THREE.PlaneBufferGeometry(g.getSize().x,g.getSize().z);var v=new THREE.ShadowMaterial();v.opacity=0.2;var w=new THREE.Mesh(u,v);w.rotation.x=-Math.PI/2;w.position.x=g.getCenter().x;w.position.y=g.min.y-m*0.1;w.position.z=g.getCenter().z;n.add(w);w.receiveShadow=true;}}}a.prototype.loadContent=function(d,e){var f=this;var l=function(){f.fireContentChangesStarted();var g=new THREE.Scene(),h=new S(g);f._loadContentResources(h,e).then(function(v){var d=h;for(var n=0;n<v.length;n++){if(v[n].camera){d.camera=v[n].camera;break;}}for(var i=0;i<v.length;i++){if(v[i].loader){d.loaders=d.loaders||[];d.loaders.push(v[i].loader);}if(v[i].builder){d.builders=d.builders||[];d.builders.push(v[i].builder);}}if(d.loaders){f._initSceneWithCDSLoaderIfExists(h,d.loaders);}c(h.getSceneRef(),false);f.fireContentChangesFinished({content:d});},function(r){q.sap.log.error('Failed to load content resources.',r);f.fireContentChangesFinished({content:null,failureReason:[{error:r,errorMessage:typeof r==='string'?r:sap.ui.vk.getResourceBundle().getText(M.VIT37.summary)}]});});};l();return this;};a.prototype._findLoader=function(d){if(d._contentManagerResolver&&d._contentManagerResolver.settings&&d._contentManagerResolver.settings.loader){return d._contentManagerResolver.settings.loader;}if(d.getSource()){var e=d.getSourceType();if(e==='stream'){if(this.defaultCdsLoader==null){q.sap.require('sap.ui.vk.threejs.ContentDeliveryService');this.defaultCdsLoader=new sap.ui.vk.threejs.ContentDeliveryService({authorizationHandler:this._authorizationHandler});}return this.defaultCdsLoader;}}return null;};a.prototype._loadContentResources=function(d,e){var p=[];e.forEach(function loadContentResource(f,g){var n=new THREE.Group();n.name=g.getName();n.sourceId=g.getSourceId();g._shadowContentResource={nodeProxy:d.getDefaultNodeHierarchy().createNodeProxy(n)};var l=g.getLocalMatrix();if(l){n.applyMatrix(new THREE.Matrix4().fromArray(T.convertTo4x4(l)));}f.add(n);var h=this._findLoader(g);if(typeof h==='function'){p.push(h(n,g,this._authorizationHandler));}else if(h&&h.load){p.push(h.load(n,g,this._authorizationHandler));}else{p.push(Promise.resolve({node:n,contentResource:g}));}g.getContentResources().forEach(loadContentResource.bind(this,n));}.bind(this,d.getSceneRef()));return Promise.all(p);};a.prototype._initSceneWithCDSLoaderIfExists=function(d,l){var e;if(l){for(var i=0;i<l.length;i++){if(l[i]instanceof sap.ui.vk.threejs.ContentDeliveryService){e=l[i];break;}}if(e){d._setState(e.getState());d.getDefaultNodeHierarchy().attachNodeRemoving(function(f){var r=f.getParameter('nodeRef');if(r.userData&&r.userData.treeNode&&r.userData.treeNode.sid){e.decrementResourceCountersForDeletedTreeNode(r.userData.treeNode.sid);}});return true;}}return false;};a.prototype.createOrthographicCamera=function(){return new O();};a.prototype.createPerspectiveCamera=function(){return new P();};return a;});\n",
	"sap/ui/vk/threejs/DetailView.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','./thirdparty/three','sap/ui/base/ManagedObject','../ve/thirdparty/html2canvas'],function(q,c,t,B,d){'use strict';var D=B.extend('sap.ui.vk.threejs.DetailView',{metadata:{properties:{name:{type:'string',defaultValue:''},camera:{type:'any',defaultValue:null},type:{type:'sap.ui.vk.DetailViewType',defaultValue:sap.ui.vk.DetailViewType.DetailView},shape:{type:'sap.ui.vk.DetailViewShape',defaultValue:sap.ui.vk.DetailViewShape.Box},borderWidth:{type:'float',defaultValue:2},backgroundColor:{type:'sap.ui.core.CSSColor',defaultValue:'#fff'},borderColor:{type:'sap.ui.core.CSSColor',defaultValue:'#000'},renderOrder:{type:'int',defaultValue:0},origin:{type:'any',defaultValue:new THREE.Vector3(0,0)},size:{type:'any',defaultValue:new THREE.Vector3(0.5,0.5)},attachmentPoint:{type:'any',defaultValue:null},metadata:{type:'any',defaultValue:{}},veId:{type:'any',defaultValue:{}}}},constructor:function(i,S,a){this._backgroundColor=new THREE.Color();B.apply(this,arguments);var m=new THREE.MeshBasicMaterial({depthTest:false,depthWrite:false,transparent:true});this._billboard=new THREE.Mesh(new THREE.BufferGeometry(),m);var b=new THREE.MeshBasicMaterial({depthTest:false,depthWrite:false,transparent:true});this._border=new THREE.Mesh(new THREE.BufferGeometry(),b);this._line=new THREE.Mesh(new THREE.BufferGeometry(),b);var f=new THREE.BufferGeometry();f.setIndex([0,1,2]);var h=new THREE.MeshBasicMaterial({color:this._backgroundColor,depthTest:false,depthWrite:false,transparent:true});this._triangle=new THREE.Mesh(f,h);this._node=new THREE.Group();this._node.add(this._billboard);this._node.add(this._border);this._node.add(this._line);this._node.add(this._triangle);this._node.isDetailView=true;this._node.traverse(function(l){if(l.geometry!==undefined){l.geometry.boundingBox=new THREE.Box3();}l.matrixAutoUpdate=false;});this.setRenderOrder(this.getRenderOrder());}});D.prototype.setCamera=function(a){if(a instanceof sap.ui.vk.threejs.PerspectiveCamera||a instanceof sap.ui.vk.threejs.OrthographicCamera){this.setProperty('camera',a,true);}return this;};D.prototype.setShape=function(a){this.setProperty('shape',a,true);return this;};D.prototype.setBackgroundColor=function(a){this.setProperty('backgroundColor',a,true);this._backgroundColor.setStyle(a);if(this._triangle){this._triangle.material.color.copy(this._backgroundColor);}return this;};D.prototype.setBorderColor=function(a){this.setProperty('borderColor',a,true);if(this._border){this._border.material.map=null;}return this;};D.prototype.setBorderWidth=function(a){this.setProperty('borderWidth',a,true);if(this._border){this._border.material.map=null;}return this;};D.prototype.setOrigin=function(a){if(a instanceof THREE.Vector2){this.setProperty('origin',a,true);}return this;};D.prototype.setSize=function(a){if(a instanceof THREE.Vector2){this.setProperty('size',a,true);}return this;};D.prototype.setRenderOrder=function(a){this.setProperty('renderOrder',a,true);if(this._billboard){this._billboard.renderOrder=a;this._border.renderOrder=a+0.1;this._triangle.renderOrder=a-0.1;this._line.renderOrder=a-0.1;}return this;};var e=-0.5,g=1.5,p=new THREE.Vector4(),j=new THREE.Vector3(),k=new THREE.Vector3(),P=new THREE.Vector3(),n=new THREE.Vector2(),s=new THREE.Vector2(),o=new THREE.Vector2(),r=new THREE.Matrix4();function v(a,b){return Math.PI*(3*(a+b)-Math.sqrt((3*a+b)*(a+3*b)));}function z(a,b,h,i,l,m){var u=a[b],w=a[b+1],x=a[l],y=a[l+1],H=a[m],I=a[m+1],J=i-w,K=u-h;var f=((x-u)*J+(y-w)*K)/((x-H)*J+(y-I)*K);a[l]=x+(H-x)*f;a[l+1]=y+(I-y)*f;}function A(f,a,b,h){n.set(f[b+1]-f[a+1],f[a]-f[b]).normalize().multiplyScalar(h);f[a]+=n.x;f[a+1]+=n.y;f[b]+=n.x;f[b+1]+=n.y;}function C(a,b){var f=a.length;for(var h=0;h<6;h+=3){var l=h===0?b*e:b*g;var m=a[h],u=a[h+1];for(var i=h;i<f-6;i+=6){var w=a[i],x=a[i+1];a[i]=m;a[i+1]=u;m=a[i+6];u=a[i+7];A(a,i,i+6,l);if(i>h){z(a,i-6,w,x,i,i+6);}}}}D.prototype._createBoxViewport=function(a,b,f,h){var l=[-a,-b,0,a,-b,0,a,b,0,-a,b,0];var m=this._billboard.geometry;m.setIndex([0,1,2,0,2,3]);m.addAttribute('position',new THREE.Float32BufferAttribute(l,3));m.addAttribute('uv',new THREE.Float32BufferAttribute([0,0,1,0,1,1,0,1],2));if(this._border.visible){var u=[],i;for(i=0;i<l.length;i+=3){var x=l[i],y=l[i+1];u.push(x,y,0,x,y,0);}u.push(u[0],u[1],0,u[0],u[1],0);C(u,this._borderWidth);i=u.length-6;u[0]=u[i];u[i+1]=u[1];u[3]=u[i+3];u[i+4]=u[4];this._createBorderGeometry(this._border.geometry,u);}};D.prototype._createCircleViewport=function(b,f,h,l){var m=[0,0,0],u=[0.5,0.5],w=[];var x=THREE.Math.clamp(Math.round(v(b,f)/24),32,256);var y=2*Math.PI/x;for(var i=0;i<x;i++){var a=i*y,H=Math.cos(a),I=Math.sin(a);m.push(H*b,I*f,0);u.push(H*0.5+0.5,I*0.5+0.5);w.push(0,i+1,i+1<x?i+2:1);}var J=this._billboard.geometry;J.setIndex(w);J.addAttribute('position',new THREE.Float32BufferAttribute(m,3));J.addAttribute('uv',new THREE.Float32BufferAttribute(u,2));var K=this._borderWidth*g;this._createCircleBorder(m,b,f,h&&n.set(h.x/(b+K),h.y/(f+K)).length()>1?h:null,l);};D.prototype._createCircleBorder=function(b,f,h,m,u){var w=this._borderWidth,H=[],i,x,y;if(m&&(u!==sap.ui.vk.DetailViewShape.Circle&&u!==sap.ui.vk.DetailViewShape.CircleLine)){H.push(m.x,m.y,0,m.x,m.y,0);var I=Math.PI*0.05;var J=Math.atan2(m.y*f,m.x*h)+I;var K=(b.length/3)-3;I=2*(Math.PI-I)/K;for(i=0;i<=K;i++){var a=J+i*I;x=Math.cos(a)*f;y=Math.sin(a)*h;H.push(x,y,0,x,y,0);}var L=[m.x,m.y,0,H[6],H[7],0,H[H.length-3],H[H.length-2],0];H.push(m.x,m.y,0,m.x,m.y,0);C(H,w);i=H.length-6;var M=n.set(H[9],H[10]).sub(m).length();var N=n.set(H[9]-H[i-3],H[10]-H[i-2]).length()*0.5;var l=m.length();l=1-w*2*M/(N*l);H[i+0]=H[0]=m.x*l;H[i+1]=H[1]=m.y*l;H[i+3]=H[3]=m.x;H[i+4]=H[4]=m.y;var O=this._triangle.geometry;l=(1+l)*0.5;L[0]*=l;L[1]*=l;O.addAttribute('position',new THREE.Float32BufferAttribute(L,3));this._triangle.visible=true;this._triangle.material.color.set(u===sap.ui.vk.DetailViewShape.SolidPointer||u===sap.ui.vk.DetailViewShape.SolidArrow?this.getBorderColor():this._backgroundColor);}else{this._line.visible=this._line.visible&&m!==null;for(i=3;i<b.length;i+=3){x=b[i];y=b[i+1];H.push(x,y,0,x,y,0);}H.push(H[0],H[1],0,H[0],H[1],0);C(H,w);i=H.length-6;H[i]=H[0]=b[3]+w*e;H[i+3]=H[3]=b[3]+w*g;H[i+1]=H[1]=b[4];H[i+4]=H[4]=b[4];}this._createBorderGeometry(this._border.geometry,H);};D.prototype._createBorderGeometry=function(a,b){var i,f=b.length/3;var h=[];for(i=2;i<f;i+=2){h.push(i-2,i,i-1,i-1,i,i+1);}var l=[];var u=this._borderU;for(i=0;i<f;i+=2){l.push(0,0.5,u,0.5);}a.setIndex(h);a.addAttribute('position',new THREE.Float32BufferAttribute(b,3));a.addAttribute('uv',new THREE.Float32BufferAttribute(l,2));};D.prototype._createLine=function(a){var b=[0,0,0,0,0,0,a.x,a.y,0,a.x,a.y,0];A(b,0,6,-this._borderWidth);A(b,3,9,this._borderWidth);this._createBorderGeometry(this._line.geometry,b);};D.prototype._updateGeometry=function(s,a,b){var f=this.getShape(),h=this.getAttachmentPoint(),i=this.getOrigin();this._border.visible=f!==sap.ui.vk.DetailViewShape.BoxNoOutline;this._line.visible=f===sap.ui.vk.DetailViewShape.BoxLine||f===sap.ui.vk.DetailViewShape.CircleLine;this._triangle.visible=false;if(h){p.copy(h).applyMatrix4(b.matrixWorldInverse).applyMatrix4(b.projectionMatrix);h=p.w>0?h:null;var l=(p.x/p.w)*a.width/a.height,m=p.y/p.w;P.set(l-i.x,m-i.y,0).multiplyScalar(a.height);}switch(f){default:case sap.ui.vk.DetailViewShape.Box:case sap.ui.vk.DetailViewShape.BoxLine:case sap.ui.vk.DetailViewShape.BoxNoOutline:this._createBoxViewport(s.x,s.y,h?P:null,f);break;case sap.ui.vk.DetailViewShape.Circle:case sap.ui.vk.DetailViewShape.CircleLine:case sap.ui.vk.DetailViewShape.CirclePointer:case sap.ui.vk.DetailViewShape.CircleArrow:case sap.ui.vk.DetailViewShape.CircleBubbles:case sap.ui.vk.DetailViewShape.SolidPointer:case sap.ui.vk.DetailViewShape.SolidArrow:this._createCircleViewport(s.x,s.y,h?P:null,f);break;}if(this._line.visible){this._createLine(P);}};D.prototype._updateBorderTexture=function(a){var b=Math.round(this.getBorderWidth()*a);this._borderWidth=b+2;var f=THREE.Math.ceilPowerOfTwo(this._borderWidth);this._borderU=this._borderWidth/f;this._borderWidth/=a;var h=new ArrayBuffer(f*4);var l=new Uint32Array(h);var m=new THREE.Color(this.getBorderColor());m=(m.r*255)|((m.g*255)<<8)|((m.b*255)<<16)|0xFF000000;l.fill(m&0xFFFFFF);for(var i=1;i<=b;i++){l[i]=m;}var u=new THREE.DataTexture(new Uint8Array(h),f,1,THREE.RGBAFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.LinearFilter,THREE.LinearFilter);u.needsUpdate=true;this._border.material.map=u;this._border.material.needsUpdate=true;this._line.material=this._border.material;};function E(a){var m=a.elements;var i=m[15]===1;var b=2/m[0];var f=2/m[5];var h,l;if(i){h=-m[12]*b;l=-m[13]*f;}else{h=m[8]*b;l=m[9]*f;}var u=(b+h)*0.5;var w=h-u;var x=(f+l)*0.5;var y=l-x;return{left:w,top:x,right:u,bottom:y};}function F(a,b){var m=a.elements;var i=m[15]===1;m[0]=2/(b.right-b.left);m[5]=2/(b.top-b.bottom);if(i){m[12]=-(b.right+b.left)/(b.right-b.left);m[13]=-(b.top+b.bottom)/(b.top-b.bottom);}else{m[8]=(b.right+b.left)/(b.right-b.left);m[9]=(b.top+b.bottom)/(b.top-b.bottom);}}function G(a,b,s,f){var w=s.x/f.width;var h=s.y/f.height;p.copy(b).applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix);var x=((p.x/p.w)-w)*0.5+0.5;var y=((p.y/p.w)-h)*0.5+0.5;var i=E(a.projectionMatrix);var l={};l.left=THREE.Math.lerp(i.left,i.right,x);l.right=THREE.Math.lerp(i.left,i.right,x+w);l.top=THREE.Math.lerp(i.top,i.bottom,1-y-h);l.bottom=THREE.Math.lerp(i.top,i.bottom,1-y);F(a.projectionMatrix,l);}D.prototype._update=function(a,b,f,h){var i=a.getSize(),l=a.getPixelRatio(),m=this.getOrigin(),u=this._node,w=u.position;if(!this._border.material.map){this._updateBorderTexture(l);}s.copy(this.getSize()).multiplyScalar(i.height*0.5);s.set(Math.round(s.x)<<1,Math.round(s.y)<<1);w.set(m.x*i.height/i.width,m.y,0).unproject(b);p.copy(w).applyMatrix4(b.matrixWorldInverse).applyMatrix4(b.projectionMatrix);var x=((p.x/p.w)*0.5+0.5)*i.width,y=((p.y/p.w)*0.5+0.5)*i.height;var H=p.w/(i.width*b.projectionMatrix.elements[0]);u.scale.setScalar(H);j.setFromMatrixColumn(b.matrixWorld,0).multiplyScalar(H*2*(Math.round(x)-x));k.setFromMatrixColumn(b.matrixWorld,1).multiplyScalar(H*2*(Math.round(y)-y));w.add(j).add(k);u.matrixWorld.compose(u.position,b.quaternion,u.scale);u.matrix.getInverse(u.parent.matrixWorld).multiply(u.matrixWorld);u.matrix.decompose(u.position,u.rotation,u.scale);this._updateGeometry(s,i,b);o.copy(s).multiplyScalar(l);if(!this._renderTarget||this._renderTarget.width!==o.x||this._renderTarget.height!==o.y){this._renderTarget=new THREE.WebGLRenderTarget(o.x,o.y,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat});this._billboard.material.map=this._renderTarget.texture;this._billboard.material.needsUpdate=true;}if(this.getType()===sap.ui.vk.DetailViewType.Cutaway){r.copy(b.projectionMatrix);G(b,w,s,i);}else{b=this.getCamera();b.adjustClipPlanes(h);b.update(s.x,s.y);b=b.getCameraRef();}f.children.forEach(function(I){if(I.userData._vkCallouts){I.userData._vkCallouts.forEach(function(J){J._update(a,b);});}});a.setClearColor(this._backgroundColor,1);a.render(f,b,this._renderTarget,true);if(this.getType()===sap.ui.vk.DetailViewType.Cutaway){b.projectionMatrix.copy(r);}};return D;});\n",
	"sap/ui/vk/threejs/MataiLoader.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['sap/base/Log'],function(L){'use strict';var S=function(b,c,e,i){this._id=S._nextId++;S.add(this);this._parentNode=b;this._contentResource=c;this._resolve=e;this._reject=i;this._nodes=new Map();this._meshes=new Map();this._callouts=new Map();this._cameras=new Map();this._detailViews=new Map();this._materials=new Map();this._images=new Map();this._viewportGroups=new Map();this._modelViews=new Map();this._modelViewThumbnails=new Map();this._animations=new Map();this._animationTracks=new Map();this._sequences=new Map();var l=this._parentNode;while(l.parent){l=l.parent;}if(!l.userData){l.userData={};}l.userData.animations=this._animations;l.userData.animationTracks=this._animationTracks;l.userData.sequences=this._sequences;};S._nextId=1;S._map=new Map();S.add=function(s){this._map.set(s.getId(),s);return this;};S.getById=function(i){return this._map.get(i);};S.prototype.getId=function(){return this._id;};S.prototype.setScene=function(i){if(i.result!==1){this._reject(i.result);}else{var c=this._cameras.get(i.cameraRef);this._resolve({node:this._parentNode,camera:c,contentResource:this._contentResource,builder:this});}};S.prototype.createNode=function(i){var b=this._nodes.get(i.parentRef)||null;var c=new THREE.Group();c.name=i.name;c.visible=i.visible;c.matrix.set(i.matrix[0],i.matrix[4],i.matrix[8],i.matrix[12],i.matrix[1],i.matrix[5],i.matrix[9],i.matrix[13],i.matrix[2],i.matrix[6],i.matrix[10],i.matrix[14],i.matrix[3],i.matrix[7],i.matrix[11],i.matrix[15]);c.matrix.decompose(c.position,c.quaternion,c.scale);c.userData.metadata=i.metadata;c.userData.veids=i.veids;(b||this._parentNode).add(c);this._nodes.set(i.nodeRef,c);};var n=new Float32Array([0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,0.0]);var a=new Uint16Array([0,1,2,2,1,3,4,6,5,5,6,7,8+0,8+1,8+2,8+2,8+1,8+3,8+4,8+6,8+5,8+5,8+6,8+7,16+0,16+1,16+2,16+2,16+1,16+3,16+4,16+6,16+5,16+5,16+6,16+7]);S.prototype.createMesh=function(i){var b=i.boundingBox;var c=new Float32Array([b[0],b[1],b[5],b[3],b[1],b[5],b[0],b[4],b[5],b[3],b[4],b[5],b[0],b[1],b[2],b[3],b[1],b[2],b[0],b[4],b[2],b[3],b[4],b[2],b[0],b[4],b[5],b[3],b[4],b[5],b[0],b[4],b[2],b[3],b[4],b[2],b[0],b[1],b[5],b[3],b[1],b[5],b[0],b[1],b[2],b[3],b[1],b[2],b[3],b[1],b[5],b[3],b[1],b[2],b[3],b[4],b[5],b[3],b[4],b[2],b[0],b[1],b[5],b[0],b[1],b[2],b[0],b[4],b[5],b[0],b[4],b[2]]);var e=new THREE.BufferGeometry();e.setIndex(new THREE.BufferAttribute(a,1));e.addAttribute('position',new THREE.BufferAttribute(c,3));e.addAttribute('normal',new THREE.BufferAttribute(n,3));var m=new THREE.Mesh(e,this._materials.get(i.materialRef));this._meshes.set(i.meshRef,m);if(i.matrix){m.matrix.set(i.matrix[0],i.matrix[4],i.matrix[8],i.matrix[12],i.matrix[1],i.matrix[5],i.matrix[9],i.matrix[13],i.matrix[2],i.matrix[6],i.matrix[10],i.matrix[14],i.matrix[3],i.matrix[7],i.matrix[11],i.matrix[15]);m.matrix.decompose(m.position,m.quaternion,m.scale);}};S.prototype.setMeshGeometry=function(b){var m=this._meshes.get(b.meshRef);var c=b.data;var e=new THREE.BufferGeometry();e.setIndex(new THREE.BufferAttribute(c.index,1));e.addAttribute('position',new THREE.BufferAttribute(c.position,3));if(c.normal){e.addAttribute('normal',new THREE.BufferAttribute(c.normal,3));}if(c.uv){e.addAttribute('uv',new THREE.BufferAttribute(c.uv,2));}if(b.flags&1){for(var i=0,l=m.parent.children.length;i<l;i++){if(m.parent.children[i]===m){m.parent.children[i]=new THREE.LineSegments(e,new THREE.LineBasicMaterial({color:m.material.color}));break;}}}else{m.geometry.copy(e);}if(this._fireSceneUpdated){this._fireSceneUpdated();}};S.prototype.insertMesh=function(b,m){var c=this._nodes.get(b);var e=this._meshes.get(m);c.add(e.parent?e.clone():e);};var d=[sap.ui.vk.BillboardTextEncoding.PlainText,sap.ui.vk.BillboardTextEncoding.HtmlText];var f=[sap.ui.vk.BillboardStyle.RectangularShape,sap.ui.vk.BillboardStyle.CircularShape,sap.ui.vk.BillboardStyle.None,sap.ui.vk.BillboardStyle.TextGlow];var g=[sap.ui.vk.BillboardBorderLineStyle.None,sap.ui.vk.BillboardBorderLineStyle.Solid,sap.ui.vk.BillboardBorderLineStyle.Dash,sap.ui.vk.BillboardBorderLineStyle.Dot,sap.ui.vk.BillboardBorderLineStyle.DashDot,sap.ui.vk.BillboardBorderLineStyle.DashDotDot];var h=[sap.ui.vk.BillboardHorizontalAlignment.Left,sap.ui.vk.BillboardHorizontalAlignment.Center,sap.ui.vk.BillboardHorizontalAlignment.Right];var j=[sap.ui.vk.LeaderLineMarkStyle.None,sap.ui.vk.LeaderLineMarkStyle.Point,sap.ui.vk.LeaderLineMarkStyle.Arrow];function k(c){var b=c.toString(16);return'#'+'000000'.substring(b.length)+b;}function o(b){for(var i=0,l=b.length;i<l;i++){if(!isFinite(b[i])){return false;}}return true;}S.prototype.createTextAnnotation=function(i){if(!o(i.position)){return;}var b=new sap.ui.vk.threejs.Billboard({coordinateSpace:sap.ui.vk.BillboardCoordinateSpace.Viewport,renderOrder:3,position:new THREE.Vector3().fromArray(i.position),encoding:d[i.encoding],text:i.text,font:i.font,fontSize:i.fontSize,fontWeight:Math.min(i.fontWeight,900),fontItalic:i.fontItalic,style:f[i.style],width:i.width,height:i.height,textColor:k(i.textColor),backgroundColor:k(i.backgroundColor),backgroundOpacity:i.backgroundOpacity,borderColor:k(i.borderColor),borderOpacity:i.borderOpacity,borderWidth:i.borderWidth,borderLineStyle:g[i.borderLineStyle],horizontalAlignment:h[i.horizontalAlignment],link:i.link});var c=this._nodes.get(i.nodeRef);(c||this._parentNode).add(b._node);if(!this._parentNode.userData._vkBillboards){this._parentNode.userData._vkBillboards=[];}this._parentNode.userData._vkBillboards.push(b);};S.prototype.createImageNote=function(i){var m=this._materials.get(i.materialRef);var b=new sap.ui.vk.threejs.Billboard({coordinateSpace:sap.ui.vk.BillboardCoordinateSpace.Screen,renderOrder:2,position:new THREE.Vector3().fromArray(i.position),width:i.width,height:i.height,texture:m?m.emissiveMap:null});var c=this._nodes.get(i.nodeRef);(c||this._parentNode).add(b._node);if(!this._parentNode.userData._vkBillboards){this._parentNode.userData._vkBillboards=[];}this._parentNode.userData._vkBillboards.push(b);};S.prototype.createTextNote=function(i){var c=new sap.ui.vk.threejs.Callout({anchorNode:this._nodes.get(i.targetNodeRef)||this._parentNode,coordinateSpace:sap.ui.vk.BillboardCoordinateSpace.World,position:new THREE.Vector3().fromArray(i.position),renderOrder:i.alwaysOnTop?1:0,depthTest:!i.alwaysOnTop,encoding:d[i.encoding],text:i.text,font:i.font,fontSize:i.fontSize,fontWeight:Math.min(i.fontWeight,900),fontItalic:i.fontItalic,style:f[i.style],width:i.width,height:i.height,textColor:k(i.textColor),backgroundColor:k(i.backgroundColor),backgroundOpacity:i.backgroundOpacity,borderColor:k(i.borderColor),borderOpacity:i.borderOpacity,borderWidth:i.borderWidth,borderLineStyle:g[i.borderLineStyle],horizontalAlignment:h[i.horizontalAlignment],link:i.link});var b=this._nodes.get(i.nodeRef);this._callouts.set(b,c);(b||this._parentNode).add(c._node);if(!this._parentNode.userData._vkCallouts){this._parentNode.userData._vkCallouts=[];}this._parentNode.userData._vkCallouts.push(c);};S.prototype.insertLeaderLine=function(b){var c=this._nodes.get(b.nodeRef);var e=this._nodes.get(b.targetNodeRef)||this._parentNode;var m=this._materials.get(b.materialRef);var l=this._callouts.get(c);if(l){var s=[];for(var i=0;i<b.points.length;i+=3){s.push(new THREE.Vector3().fromArray(b.points,i));}l.addLeaderLine(s,e,m,j[b.startPointStyle],j[b.endPointStyle],b.styleConstant,b.extensionLength);}};S.prototype.createCamera=function(i){var c=null;if(i.projection==='perspective'){c=new sap.ui.vk.threejs.PerspectiveCamera();c.setFov(i.fov);}else if(i.projection==='orthographic'){c=new sap.ui.vk.threejs.OrthographicCamera();c.setZoomFactor(i.orthoZoomFactor);}if(c){c.setNearClipPlane(i.nearClip);c.setFarClipPlane(i.farClip);c.setUsingDefaultClipPlanes(i.autoEvaluateClipPlanes);var b=new THREE.Vector3().fromArray(i.origin);var e=new THREE.Vector3().fromArray(i.target).sub(b);var l=new THREE.Vector3().fromArray(i.up).sub(b);c.setUpDirection(l.toArray());c.setPosition(b.toArray());c.setTargetDirection(e.toArray());}this._parentNode.userData.camera=c;this._cameras.set(i.cameraRef,c);};S.prototype.insertCamera=function(b,c){var e=this._nodes.get(b);var i=this._cameras.get(c);i=i?i.getCameraRef():null;if(e&&i){(e||this._parentNode).add(i.parent?i.clone():i);}};S.prototype.createViewportGroup=function(i){var b=this._parentNode;while(b.parent){b=b.parent;}var c={name:i.name,type:i.type,description:i.description,metadata:i.metadata,veids:i.veids,modelViews:[]};b.userData.viewportGroups=b.userData.viewportGroups||[];b.userData.viewportGroups.push(c);this._viewportGroups.set(i.viewportGroupRef,c);};S.prototype.insertModelView=function(i){var m={name:i.name,description:i.description,camera:this._cameras.get(i.cameraRef),type:i.type,flyToTime:i.flyToTime,preDelay:i.preDelay,postDelay:i.postDelay,navigationMode:i.navigationMode,topColor:i.topColor,bottomColor:i.bottomColor,renderMethod:i.renderMethod,dimension:i.dimension,query:i.query,metadata:i.metadata,veids:i.veids,visibleNodes:[],highlights:[]};var b=this._viewportGroups.get(i.viewportGroupRef);if(b){b.modelViews.push(m);}this._modelViews.set(i.modelViewRef,m);this._modelViewThumbnails.set(i.thumbnail,m);};S.prototype.setModelViewVisibilitySet=function(i){var m=this._modelViews.get(i.modelViewRef);var b=new Set();i.visibleNodes.forEach(function(c){var e=this._nodes.get(c);if(e){while(e&&!b.has(e)){b.add(e);e=e.parent;}}else{}}.bind(this));m.visibleNodes=Array.from(b);};S.prototype.insertModelViewHighlight=function(i){var m=this._modelViews.get(i.modelViewRef);if(m){var b=[];i.highlightNodes.forEach(function(e){var l=this._nodes.get(e);if(l){b.push(l);}else{}}.bind(this));var c={highlightNodes:b,color1:i.color1,color2:i.color2,opacity1:i.opacity1,opacity2:i.opacity2,duration:i.duration,cycles:i.cycles};m.highlights.push(c);}};S.prototype.createThumbnail=function(i){var m=this._modelViewThumbnails.get(i.imageRef);if(m){m.thumbnailData='data:image/'+'jpeg'+';base64,'+window.btoa(String.fromCharCode.apply(null,i.data));if(this._fireThumbnailLoaded){this._fireThumbnailLoaded({modelView:m});}}};var p=[sap.ui.vk.DetailViewType.DetailView,sap.ui.vk.DetailViewType.Cutaway];var q=[sap.ui.vk.DetailViewShape.Box,sap.ui.vk.DetailViewShape.Circle,sap.ui.vk.DetailViewShape.CircleLine,sap.ui.vk.DetailViewShape.CirclePointer,sap.ui.vk.DetailViewShape.CircleArrow,sap.ui.vk.DetailViewShape.CircleBubbles,sap.ui.vk.DetailViewShape.BoxLine,sap.ui.vk.DetailViewShape.BoxNoOutline,sap.ui.vk.DetailViewShape.SolidPointer,sap.ui.vk.DetailViewShape.SolidArrow];S.prototype.createDetailView=function(i){var b=new sap.ui.vk.threejs.DetailView({name:i.name,camera:this._cameras.get(i.cameraRef),type:p[i.type],shape:q[i.shape],borderWidth:i.borderWidth,backgroundColor:k(i.backgroundColor),borderColor:k(i.borderColor),renderOrder:i.renderOrder||0,origin:new THREE.Vector2().fromArray(i.origin),size:new THREE.Vector2().fromArray(i.size),attachmentPoint:new THREE.Vector3().fromArray(i.attachmentPoint),metadata:i.metadata,veId:i.veid});this._detailViews.set(i.detailViewRef,b);var c=this._nodes.get(i.nodeRef);(c||this._parentNode).add(b._node);if(!this._parentNode.userData._vkDetailViews){this._parentNode.userData._vkDetailViews=[];}this._parentNode.userData._vkDetailViews.push(b);};S.prototype.createMaterial=function(i){var m;var l=i.linestyle;if(l.width>0){m=new THREE.LineBasicMaterial({color:new THREE.Color(l.color[0],l.color[1],l.color[2]),depthTest:false,linewidth:l.width});m.userData.lineStyle=l;}else{if(i.textures){i.textures.forEach(function(b){var c=new THREE.Texture(this._images.get(b.imageRef),b.type==='reflection'?THREE.SphericalReflectionMapping:THREE.UVMapping,b.repeatX?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,b.repeatY?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,b.filterMode===1?THREE.NearestFilter:THREE.LinearFilter,b.filterMode===1?THREE.NearestFilter:THREE.LinearMipMapLinearFilter,undefined,undefined,4);c.offset.set(b.offsetX,b.offsetX);c.repeat.set(b.scaleX,b.scaleY);i[b.type+'Texture']=c;c.needsUpdate=true;c.influence=b.amount;},this);}m=new THREE.MeshPhongMaterial({opacity:i.opacity,color:new THREE.Color(i.diffuse[0],i.diffuse[1],i.diffuse[2]),shininess:i.glossiness*2+i.specularLevel*3,emissive:new THREE.Color(i.emissive[0]+i.ambient[0]*0.2,i.emissive[1]+i.ambient[1]*0.2,i.emissive[2]+i.ambient[2]*0.2),specular:new THREE.Color(i.specular[0],i.specular[1],i.specular[2]),map:i.diffuseTexture?i.diffuseTexture:null,specularMap:i.specularTexture?i.specularTexture:null,emissiveMap:i.emissiveTexture?i.emissiveTexture:null,envMap:i.reflectionTexture?i.reflectionTexture:null,alphaMap:i.opacityTexture?i.opacityTexture:null,bumpMap:i.bumpTexture?i.bumpTexture:null,transparent:i.opacity<1||!!i.opacityTexture||(i.diffuseTexture&&i.diffuseTexture.image.hasAlpha)||false});if(m.map){m.color.lerp(new THREE.Color(1,1,1),m.map.influence?m.map.influence:0);}if(m.bumpMap){m.bumpScale=m.bumpMap.influence?m.bumpMap.influence:0;}if(m.envMap){m.mapping=THREE.SphericalReflectionMapping;m.combine=THREE.AddOperation;m.reflectivity=m.envMap.influence?m.envMap.influence:0;}}this._materials.set(i.materialRef,m);};S.prototype.createImage=function(i){var b=window.btoa(i.data.reduce(function(b,e){return b+String.fromCharCode(e);},''));var c=new THREE.ImageLoader().load('data:image/'+i.format+';base64,'+b);this._images.set(i.imageRef,c);c.hasAlpha=i.format==='png'&&i.data[25]===6;};S.prototype.insertAnimationGroup=function(i){var b=this._sequences.get(i.animationGroupRef);if(!b){var c=[];b=new THREE.AnimationClip(i.name,-1,c);if(!b.userData){b.userData={};}b.userData.startTime=i.startTime;b.userData.endTime=i.endTime;b.userData.frameRate=i.frameRate;b.userData.active=i.active;b.userData.cyclic=i.cyclic;b.userData.currentTime=i.currentTime;b.userData.name=i.name;b.userData.animations=[];b.userData.nodesEndData=new Map();b.userData.nodesStartData=new Map();this._sequences.set(i.animationGroupRef,b);}if(i.modelViewRef){var m=this._modelViews.get(i.modelViewRef);if(m){if(!m.playbacks){m.playbacks=[];}var e={sequenceId:i.animationGroupRef,playbackSpeed:i.playbackSpeed,playbackPreDelay:i.playbackPreDelay,playbackPostDelay:i.playbackPostDelay,playbackRepeat:i.playbackRepeat,playbackReversed:i.playbackReversed};m.playbacks.push(e);}}};S.prototype.insertAnimation=function(i){var b=this._animations.get(i.animationRef);if(!b){b={};b.type=i.animationType;b.targetRefs=[];b.targetPivots=[];b.sequenceId=i.animationGroupRef;b.animationTracks=new Set();this._animations.set(i.animationRef,b);}if(i.animationGroupRef){var c=this._sequences.get(i.animationGroupRef);if(!c.userData.animations.includes(i.animationRef)){c.userData.animations.push(i.animationRef);}}};S.prototype.insertAnimationTarget=function(i){var b=this._animations.get(i.animationRef);if(b){if(!b.targetRefs.includes(i.targetRef)){b.targetRefs.push(i.targetRef);b.targetPivots.push({x:i.targetPivotX,y:i.targetPivotY,z:i.targetPivotZ});}}};S.prototype.insertAnimationTrack=function(i){var b=this._animationTracks.get(i.animationTrackRef);var e=i.animationRef;if(!b){delete i.animationRef;b=i;this._animationTracks.set(i.animationTrackRef,b);}if(b.keyCount<2){return;}if(!e){return;}var l=this._animations.get(e);if(!l||!l.sequenceId){return;}var A=this._sequences.get(l.sequenceId);if(l.animationTracks.has(b.animationTrackRef)){return;}else{l.animationTracks.add(b.animationTrackRef);}var B=function(x,y,z,Y){var c=Math.cos(Y);var s=Math.sin(Y);var _=c+x*x*(1-c);var a1=x*y*(1-c)-z*s;var b1=x*z*(1-c)+y*s;var c1=0;var d1=y*x*(1-c)+z*s;var e1=c+y*y*(1-c);var f1=y*z*(1-c)-x*s;var g1=0;var h1=z*x*(1-c)-y*s;var i1=z*y*(1-c)+x*s;var j1=c+z*z*(1-c);var k1=0;var m=new THREE.Matrix4();m.set(_,a1,b1,c1,d1,e1,f1,g1,h1,i1,j1,k1,0,0,0,1);return m;};var C=function(Y,_){var c=Math.cos(Y);var s=Math.sin(Y);var a1=1;var b1=0;var c1=0;var d1=0;var e1=0;var f1=1;var g1=0;var h1=0;var i1=0;var j1=0;var k1=1;var l1=0;if(_==='X'){f1=c;g1=-s;j1=s;k1=c;}else if(_==='Y'){a1=c;c1=s;i1=-s;k1=c;}else{a1=c;b1=-s;e1=s;f1=c;}var m=new THREE.Matrix4();m.set(a1,b1,c1,d1,e1,f1,g1,h1,i1,j1,k1,l1,0,0,0,1);return m;};for(var D=0;l.targetRefs&&D<l.targetRefs.length;D++){var E=l.targetRefs[D];var F=l.targetPivots[D];var G='';var H=[];var I=[];var J=null;var K,M,N,x,y,z,O;var P;var m,Q;if(l.type===0){var R=this._nodes.get(E);if(!R){continue;}G=R.uuid;var T={};A.userData.nodesEndData.set(R,T);if(!R.userData){R.userData={};}if(b.dataType===0){if(b.type===0){if(!R.material&&R.children&&R.children.length===1){R=R.children[0];G=R.uuid;if(!R.userData){R.userData={};}}if(R.material&&R.material.opacity){G+='.material.opacity';P=R.material.opacity;}else{continue;}}else if(b.type===3&&R.scale){G+='.scale';P=R.scale.clone();}else{continue;}if(b.values.length!==b.keyCount||b.times.length!==b.keyCount){continue;}for(K=0;K<b.keyCount;K++){H.push(b.times[K]);if(b.type===0){I.push(b.values[K]);if(K===b.keyCount-1){T.opacity=b.values[K];}}else if(b.type===3){for(var U=0;U<3;U++){I.push(b.values[K]);}if(K===b.keyCount-1){var V=new THREE.Vector3(b.values[K],b.values[K],b.values[K]);T.scale=V;}}}if(b.type===0){J=new THREE.NumberKeyframeTrack(G,H,I);}else if(b.type===3){J=new THREE.VectorKeyframTrack(G,H,I);}}else if(b.dataType===1){if(b.type===1&&R.material&&R.material.color){G+='.material.color';P=R.material.color.clone();}else{continue;}if(b.values.length!==3*b.keyCount||b.times.length!==b.keyCount){continue;}for(K=0;K<b.keyCount;K++){H.push(i.times[K]);}for(M=0;M<b.valueCount;M++){I.push(i.values[M]);}J=new THREE.ColorKeyframeTrack(G,H,I);}else if(b.dataType===2){}else if(b.dataType===3){if(b.type===2&&R.position){G+='.position';P=R.position.clone();}else if(b.type===3&&R.scale){G+='.scale';P=R.scale.clone();}else{continue;}if(b.values.length!==3*b.keyCount||b.times.length!==b.keyCount){continue;}for(K=0;K<b.keyCount;K++){H.push(b.times[K]);}for(M=0;M<b.valueCount;M++){I.push(b.values[M]);if(M===b.valueCount-1){var W=new THREE.Vector3(b.values[M-2],b.values[M-1],b.values[M]);if(b.type===2){T.position=W;}else if(b.type===3){T.scale=W;}}}J=new THREE.VectorKeyframeTrack(G,H,I);}else if(b.dataType===4){if(b.type===4&&R.quaternion){G+='.quaternion';P=R.quaternion.clone();}else{continue;}if(b.values.length!==4*b.keyCount||b.times.length!==b.keyCount){continue;}for(K=0;K<b.keyCount;K++){H.push(i.times[K]);}m=new THREE.Matrix4();var w;for(K=0;K<b.keyCount;K++){x=b.values[K*4];y=b.values[K*4+1];z=b.values[K*4+2];w=b.values[K*4+3];Q=B(x,y,z,w);m.premultiply(Q);N=new THREE.Quaternion();N.setFromRotationMatrix(m);I.push(N.x);I.push(N.y);I.push(N.z);I.push(N.w);if(K===b.keyCount-1){T.quaternion=N;}}J=new THREE.QuaternionKeyframeTrack(G,H,I);}else if(b.dataType===5){if(b.type===4&&R.quaternion){G+='.quaternion';if(R.userData.previousQuaternion){P=R.userData.previousQuaternion;}else{P=R.quaternion.clone();}}else{continue;}if(b.values.length!==4*b.keyCount||b.times.length!==b.keyCount){continue;}for(K=0;K<b.keyCount;K++){H.push(b.times[K]);}for(M=0;M<b.valueCount;M++){I.push(b.values[M]);}var X=new THREE.Quaternion(I[I.length-4],I[I.length-3],I[I.length-2],I[I.length-1]);T.quaternion=X;J=new THREE.QuaternionKeyframeTrack(G,H,I);}else if(b.dataType===6){if(b.type===4&&R.quaternion){G+='.quaternion';if(R.userData.previousQuaternion){P=R.userData.previousQuaternion;}else{P=R.quaternion.clone();}}else{continue;}if(b.values.length!==4*b.keyCount||b.times.length!==b.keyCount){continue;}for(K=0;K<b.keyCount;K++){H.push(b.times[K]);}for(K=0;K<b.keyCount;K++){O=b.values[K*4+3];O=Math.round(O);var Y;m=new THREE.Matrix4();for(var Z=0;Z<3;Z++){if(Z===0){Y=b.values[K*4];}else if(Z===1){Y=b.values[K*4+1];}else{Y=b.values[K*4+2];}if((O>>(Z*2)&3)===0){Q=C(Y,'X');m.multiply(Q);}else if((O>>(Z*2)&3)===1){Q=C(Y,'Y');m.multiply(Q);}else if((O>>(Z*2)&3)===2){Q=C(Y,'Z');m.multiply(Q);}}N=new THREE.Quaternion();N.setFromRotationMatrix(m);I.push(N.x);I.push(N.y);I.push(N.z);I.push(N.w);if(K===b.keyCount-1){T.quaternion=N;}}J=new THREE.QuaternionKeyframeTrack(G,H,I);}else{continue;}if(!J.userData){J.userData={};}J.userData.targetNode=R;J.userData.targetPivot=F;}else{var $=this._materials.get(E);if(!$){continue;}G=$.uuid;if(b.dataType===0){if(b.type===0&&$&&$.opactiy){G+='.opacity';P=$.opacity;}else{continue;}for(K=0;K<b.keyCount;K++){H.push(b.times[K]);I.push(b.values[K]);}}J=new THREE.NumberKeyframeTrack(G,H,I);if(!J.userData){J.userData={};}J.userData.targetMaterial=$;}if(b.type===0){J.userData.type='OPACITY';}else if(b.type===1){J.userData.type='COLOUR';}else if(b.type===2){J.userData.type='TRANSLATE';}else if(b.type===3){J.userData.type='SCALE';}else if(b.type===4){J.userData.type='ROTATE';}J.userData.originalValue=P;J.userData.info=b;if(b.interpolationType===1){J.setInterpolation(THREE.InterpolateSmooth);}else{J.setInterpolation(THREE.InterpolateLinear);}A.tracks.push(J);}};S.prototype.finalizeAnimation=function(b){var c=this._animations.get(b);if(!c||!c.sequenceId){return;}var e=this._sequences.get(c.sequenceId);if(e){e.resetDuration();e.optimize();e.hasOptimized=true;}};S.prototype.finalizePlaybacks=function(i){var b=this._viewportGroups.get(i.viewportGroupRef);var c=new Map();var m;var e,l,s;for(m=0;m<b.modelViews.length-1;m++){var w=b.modelViews[m];var x=b.modelViews[m+1];var y;if(w.playbacks&&w.playbacks.length){y=w.playbacks[w.playbacks.length-1];}if(y){e=this._sequences.get(y.sequenceId);l=e.userData.nodesEndData.entries();s=l.next();while(!s.done){c.set(s.value[0],s.value[1]);s=l.next();}}var z;if(x.playbacks&&x.playbacks.length){z=x.playbacks[x.playbacks.length-1];}if(z){e=this._sequences.get(z.sequenceId);l=c.entries();s=l.next();while(!s.done){e.userData.nodesStartData.set(s.value[0],s.value[1]);s=l.next();}}}var A,B,C;for(m=0;m<b.modelViews.length;m++){var D=b.modelViews[m];var E;if(D.playbacks&&D.playbacks.length){E=D.playbacks[D.playbacks.length-1];}if(E){e=this._sequences.get(E.sequenceId);A=c.keys();s=A.next();while(!s.done){B=s.value;C=e.userData.nodesStartData.get(B);if(!C){C={};C.position=B.position.clone();C.scale=B.scale.clone();C.quaternion=B.quaternion.clone();e.userData.nodesStartData.set(B,C);}s=A.next();}}else{D.animationNodeOriginalData=new Map();A=c.keys();s=A.next();while(!s.done){B=s.value;C={};C.position=B.position.clone();C.scale=B.scale.clone();C.quaternion=B.quaternion.clone();D.animationNodeOriginalData.set(B,C);s=A.next();}}}var F=this._parentNode;while(F.parent){F=F.parent;}if(!F.userData){F.userData={};}if(!F.userData.animationNodeOriginalData){F.userData.animationNodeOriginalData=new Map();}A=c.keys();s=A.next();while(!s.done){B=s.value;C={};C.position=B.position.clone();C.scale=B.scale.clone();C.quaternion=B.quaternion.clone();F.userData.animationNodeOriginalData.set(B,C);s=A.next();}};S.prototype.progress=function(b){L.log('reading progress:',b);};var r=function(e){var b=e.data;if(b.ready){r.resolve();}else{var s=S.getById(b.sceneBuilderId);s[b.method].apply(s,b.args);}};var t=function(e){L.error('Error in WebWorker',e);};var u=(function(){var b;return function(){return b||(b=new Promise(function(c){var w=new Worker(sap.ui.require.toUrl('sap/ui/vk/threejs/MataiLoaderWorker.js'));r.resolve=c.bind(null,w);w.onmessage=r;w.onerror=t;}));};})();var v=function(b,c,e,i,l,m){u().then(function(w){var s=new S(e,i,l,m);w.postMessage({method:'loadSceneFromArrayBuffer',sceneBuilderId:s.getId(),buffer:b,fileName:c,sourceLocation:'remote'},[b]);});};return function(b,c){return new Promise(function(i,l){if(typeof c.getSource()==='string'){var m=c.getSource();fetch(m).then(function(e){if(e.ok){return e.arrayBuffer();}throw(new Error(e.statusText));}).then(function(e){v(e,m,b,c,i,l);}).catch(function(e){l(e);});}else if(c.getSource()instanceof File){var s=new FileReader();s.onload=function(e){v(e.target.result,c.getSource().name,b,c,i,l);};s.onerror=function(e){l(e);};s.readAsArrayBuffer(c.getSource());}});};});\n",
	"sap/ui/vk/threejs/MataiLoaderWorker.js":"console.log('MataiLoaderWorker started.');var scriptDirectory=self.location.href.slice(0,self.location.href.lastIndexOf('/')+1);self.importScripts(scriptDirectory+'thirdparty/matai.js');sap.ve.matai.createRuntime({prefixURL:scriptDirectory+'thirdparty/'}).then(function(m){'use strict';console.log('MataiLoaderWorker runtime created.');function S(s){this.sceneBuilderId=s;}S.prototype.setScene=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'setScene',args:[i]});};S.prototype.createNode=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createNode',args:[i]},[i.matrix.buffer]);};S.prototype.createMesh=function(i){var t=[i.boundingBox.buffer];if(i.matrix){t.push(i.matrix.buffer);}self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createMesh',args:[i]},t);};S.prototype.setMeshGeometry=function(i){var t=[i.data.index.buffer,i.data.position.buffer];if(i.data.normal){t.push(i.data.normal.buffer);}if(i.data.uv){t.push(i.data.uv.buffer);}self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'setMeshGeometry',args:[i]},t);};S.prototype.insertMesh=function(n,a){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertMesh',args:[n,a]});};S.prototype.createTextAnnotation=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createTextAnnotation',args:[i]});};S.prototype.createTextNote=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createTextNote',args:[i]});};S.prototype.createImageNote=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createImageNote',args:[i]});};S.prototype.insertLeaderLine=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertLeaderLine',args:[i]});};S.prototype.createCamera=function(i){var t=[i.origin.buffer,i.up.buffer,i.target.buffer];if(i.matrix){t.push(i.matrix.buffer);}self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createCamera',args:[i]},t);};S.prototype.insertCamera=function(n,c){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertCamera',args:[n,c]});};S.prototype.createViewportGroup=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createViewportGroup',args:[i]});};S.prototype.finalizePlaybacks=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'finalizePlaybacks',args:[i]});};S.prototype.insertModelView=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertModelView',args:[i]});};S.prototype.setModelViewVisibilitySet=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'setModelViewVisibilitySet',args:[i]});};S.prototype.insertModelViewHighlight=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertModelViewHighlight',args:[i]});};S.prototype.createThumbnail=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createThumbnail',args:[i]});};S.prototype.createDetailView=function(i){var t=[i.origin.buffer,i.size.buffer];if(i.attachmentPoint){t.push(i.attachmentPoint.buffer);}self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createDetailView',args:[i]},t);};S.prototype.createMaterial=function(i){var t=[i.ambient.buffer,i.diffuse.buffer,i.specular.buffer,i.emissive.buffer];if(i.linestyle){t.push(i.linestyle.color.buffer,i.linestyle.dashPattern.buffer);}if(i.textures){i.textures.forEach(function(a){t.push(a.matrix.buffer);});}self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createMaterial',args:[i]},t);};S.prototype.createImage=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'createImage',args:[i]},[i.data.buffer]);};S.prototype.progress=function(p){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'progress',args:[p]});};S.prototype.insertAnimationGroup=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertAnimationGroup',args:[i]});};S.prototype.insertAnimation=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertAnimation',args:[i]});};S.prototype.insertAnimationTarget=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertAnimationTarget',args:[i]});};S.prototype.insertAnimationTrack=function(i){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'insertAnimationTrack',args:[i]});};S.prototype.finalizeAnimation=function(a){self.postMessage({sceneBuilderId:this.sceneBuilderId,method:'finalizeAnimation',args:[a]});};self.onmessage=function(e){var d=e.data;switch(d.method){case'loadSceneFromArrayBuffer':var p=new S(d.sceneBuilderId);m.loadSceneFromArrayBuffer(p,d.buffer,d.fileName,null,d.sourceLocation);break;default:break;}};self.postMessage({ready:true});console.log('MataiLoaderWorker initialized.');});console.log('MataiLoaderWorker starting runtime.');\n",
	"sap/ui/vk/threejs/Material.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../Material','./thirdparty/three','./Texture'],function(q,l,M,t,T){'use strict';var a=M.extend('sap.ui.vk.threejs.Material',{metadata:{},constructor:function(i){if(i){this._nativeMaterial=new THREE.LineBasicMaterial({color:0xaaaaaa});}else{this._nativeMaterial=new THREE.MeshPhongMaterial({color:0xaaaaaa});}}});var b=a.getMetadata().getParent().getClass().prototype;a.prototype.init=function(){if(b.init){b.init.call(this);}};a.prototype.getMaterialRef=function(){return this._nativeMaterial;};a.prototype.setMaterialRef=function(m){this._nativeMaterial=m;return this;};a.prototype.getId=function(){if(this._nativeMaterial.userData&&this._nativeMaterial.userData.materialId){return this._nativeMaterial.userData.materialId;}};a.prototype.setId=function(v){this._nativeMaterial.userData.materialId=v;return this;};a.prototype.getName=function(){if(this._nativeMaterial.userData&&this._nativeMaterial.userData.name){return this._nativeMaterial.userData.name;}};a.prototype.setName=function(v){this._nativeMaterial.userData.name=v;return this;};a.prototype.getAmbientColour=function(){};a.prototype.setAmbientColour=function(v){return this;};a.prototype.getDiffuseColour=function(){if(this._nativeMaterial.isMeshPhongMaterial&&this._nativeMaterial.color){var c={red:Math.round(this._nativeMaterial.color.r*255),green:Math.round(this._nativeMaterial.color.g*255),blue:Math.round(this._nativeMaterial.color.b*255),alpha:1.0};return sap.ui.vk.colorToCSSColor(c);}};a.prototype.setDiffuseColour=function(v){if(this._nativeMaterial.isMeshPhongMaterial){var c=sap.ui.vk.cssColorToColor(v);this._nativeMaterial.color=new THREE.Color(c.red/255.0,c.green/255.0,c.blue/255.0);}return this;};a.prototype.getEmissiveColour=function(){if(this._nativeMaterial.isMeshPhongMaterial&&this._nativeMaterial.emissive){var c={red:Math.round(this._nativeMaterial.emissive.r*255),green:Math.round(this._nativeMaterial.emissive.g*255),blue:Math.round(this._nativeMaterial.emissive.b*255),alpha:1.0};return sap.ui.vk.colorToCSSColor(c);}};a.prototype.setEmissiveColour=function(v){if(this._nativeMaterial.isMeshPhongMaterial){var c=sap.ui.vk.cssColorToColor(v);this._nativeMaterial.emissive=new THREE.Color(c.red/255.0,c.green/255.0,c.blue/255.0);}return this;};a.prototype.getSpecularColour=function(){if(this._nativeMaterial.isMeshPhongMaterial&&this._nativeMaterial.specular){var c={red:Math.round(this._nativeMaterial.specular.r*255),green:Math.round(this._nativeMaterial.specular.g*255),blue:Math.round(this._nativeMaterial.specular.b*255),alpha:1.0};return sap.ui.vk.colorToCSSColor(c);}};a.prototype.setSpecularColour=function(v){if(this._nativeMaterial.isMeshPhongMaterial){var c=sap.ui.vk.cssColorToColor(v);this._nativeMaterial.specular=new THREE.Color(c.red/255.0,c.green/255.0,c.blue/255.0);}return this;};a.prototype.getOpacity=function(){if(this._nativeMaterial.opacity){return this._nativeMaterial.opacity;}};a.prototype.setOpacity=function(v){if(v>=0.0&&v<=1.0){this._nativeMaterial.opacity=v;this._nativeMaterial.transparent=this._nativeMaterial.opacity<1;}return this;};a.prototype.getGlossness=function(){if(this._nativeMaterial.isMeshPhongMaterial&&this._nativeMaterial.shininess){return this._nativeMaterial.shininess/100.0;}};a.prototype.setGlossness=function(v){if(this._nativeMaterial.isMeshPhongMaterial){this._nativeMaterial.shininess=v*100.0;}return this;};a.prototype.getLineColour=function(){if(this._nativeMaterial.isLineBasicMaterial&&this._nativeMaterial.color){var c={red:Math.round(this._nativeMaterial.color.r*255),green:Math.round(this._nativeMaterial.color.g*255),blue:Math.round(this._nativeMaterial.color.b*255),alpha:1.0};return sap.ui.vk.colorToCSSColor(c);}};a.prototype.setLineColour=function(v){if(this._nativeMaterial.isLineBasicMaterial){var c=sap.ui.vk.cssColorToColor(v);this._nativeMaterial.color=new THREE.Color(c.red/255.0,c.green/255.0,c.blue/255.0);}return this;};a.prototype.getLineWidth=function(){if(this._nativeMaterial.isLineBasicMaterial&&this._nativeMaterial.linewidth!==undefined){return this._nativeMaterial.linewidth;}};a.prototype.setLineWidth=function(v){if(this._nativeMaterial.isLineBasicMaterial){this._nativeMaterial.linewidth=v;}return this;};a.prototype.getTextureDiffuse=function(){if(this._nativeMaterial.map){var c=new T();c.setTextureRef(this._nativeMaterial.map);return c;}};a.prototype.setTextureDiffuse=function(v){if(this._nativeMaterial.isMeshPhongMaterial&&v){this._nativeMaterial.map=v.getTextureRef();}return this;};a.prototype.getTextureBump=function(){if(this._nativeMaterial.bumpMap){var c=new T();c.setTextureRef(this._nativeMaterial.bumpMap);return c;}};a.prototype.setTextureBump=function(v){if(this._nativeMaterial.isMeshPhongMaterial&&v){this._nativeMaterial.bumpMap=v.getTextureRef();}return this;};a.prototype.getTextureOpacity=function(){if(this._nativeMaterial.alphaMap){var c=new T();c.setTextureRef(this._nativeMaterial.alphaMap);return c;}};a.prototype.setTextureOpacity=function(v){if(this._nativeMaterial.isMeshPhongMaterial&&v){this._nativeMaterial.alphaMap=v.getTextureRef();}return this;};a.prototype.getTextureReflection=function(){if(this._nativeMaterial.envMap){var c=new sap.ui.vk.threejs.Texture();c.setTextureRef(this._nativeMaterial.envMap);return c;}};a.prototype.setTextureReflection=function(v){if(this._nativeMaterial.isMeshPhongMaterial&&v){this._nativeMaterial.envMap=v.getTextureRef();if(this._nativeMaterial.envMap){this._nativeMaterial.envMap.mapping=THREE.SphericalReflectionMapping;this._nativeMaterial.combine=THREE.AddOperation;}}return this;};a.prototype.getTextureEmissive=function(){if(this._nativeMaterial.emissiveMap){var c=new T();c.setTextureRef(this._nativeMaterial.emissiveMap);return c;}};a.prototype.setTextureEmissive=function(v){if(this._nativeMaterial.isMeshPhongMaterial&&v){this._nativeMaterial.emissiveMap=v.getTextureRef();}return this;};a.prototype.getTextureAmbientOcclusion=function(){if(this._nativeMaterial.aoMap){var c=new T();c.setTextureRef(this._nativeMaterial.aoMap);return c;}};a.prototype.setTextureAmbientOcclusion=function(v){if(this._nativeMaterial.isMeshPhongMaterial&&v){this._nativeMaterial.aoMap=v.getTextureRef();}return this;};return a;});\n",
	"sap/ui/vk/threejs/NodeHierarchy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../NodeHierarchy','sap/ui/base/ObjectPool','./BaseNodeProxy','./NodeProxy','../Messages'],function(q,N,O,B,a,M){'use strict';var s={equals:function(c,d){return c===d;},contains:function(c,d){return c.indexOf(d)!==-1;},startsWith:function(c,d){return c.indexOf(d)===0;}};var b=N.extend('sap.ui.vk.threejs.NodeHierarchy',{metadata:{},_baseNodeProxyPool:new O(B),constructor:function(c){N.call(this);this._scene=c;this._nodeProxies=[];}});b.prototype.destroy=function(){this._nodeProxies.slice().forEach(this.destroyNodeProxy,this);this._scene=null;N.prototype.destroy.call(this);};b.prototype.getScene=function(){return this._scene;};b.prototype.getSceneRef=function(){return this._scene.getSceneRef();};b.prototype.enumerateChildren=function(n,c,d,p){if(typeof n==='function'){p=d;d=c;c=n;n=undefined;}var e=this.getChildren(n,d);if(p){e.forEach(c);}else{var f=this._baseNodeProxyPool.borrowObject();try{e.forEach(function(n){f.init(this,n);c(f);f.reset();}.bind(this));}finally{this._baseNodeProxyPool.returnObject(f);}}return this;};b.prototype.enumerateAncestors=function(n,c,p){var d=this.getAncestors(n);if(p){d.forEach(c);}else{var e=this._baseNodeProxyPool.borrowObject();try{d.forEach(function(n){e.init(this,n);c(e);e.reset();}.bind(this));}finally{this._baseNodeProxyPool.returnObject(e);}}return this;};b.prototype.createNodeProxy=function(n){var c=new a(this,n);this._nodeProxies.push(c);return c;};b.prototype.destroyNodeProxy=function(n){var i=this._nodeProxies.indexOf(n);if(i>=0){this._nodeProxies.splice(i,1)[0].destroy();}return this;};b.prototype.getChildren=function(n,c){if(typeof n==='boolean'){c=n;n=undefined;}if(!n){n=this._scene.getSceneRef();}var d=[];if(c||!n.userData.closed){n.children.forEach(function(e){if(!e.private&&(e.geometry===undefined||e.name||e.children.length>0)){d.push(e);}});}return d;};b.prototype.getAncestors=function(n){var c=[];n.traverseAncestors(function(p){c.unshift(p);});if(c.length>0&&c[0]===this._scene.getSceneRef()){c.shift();}return c;};b.prototype.findNodesByName=function(c){var r=[];if(c===undefined||c===null||q.isEmptyObject(c)){this._scene.getSceneRef().children.forEach(function(f){f.traverse(function(o){if(!o.private&&(o.geometry===undefined||o.name||o.children.length>0)){r.push(o);}});});}else{var d=s[c.predicate||'equals'];if(d===undefined){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT8.summary),M.VIT8.code,'sap.ui.vk.threejs.NodeHierarchy');}else if(!Array.isArray(c.value)&&typeof c.value!=='string'){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT6.summary),M.VIT6.code,'sap.ui.vk.threejs.NodeHierarchy');}else{var e=Array.isArray(c.value)?c.value:[c.value];if(!c.caseSensitive){for(var i in e){e[i]=e[i].toLowerCase();}}this._scene.getSceneRef().children.forEach(function(f){f.traverse(function(o){if(!o.private&&(o.geometry===undefined||o.name||o.children.length>0)){var n=o.name||'';if(!c.caseSensitive){n=n.toLowerCase();}for(var i in e){if(d(n,e[i])){r.push(o);break;}}}});});}}return r;};b.prototype.createLayerProxy=function(l){return null;};b.prototype.destroyLayerProxy=function(l){return this;};b.prototype.getLayers=function(){return[];};b.prototype.getHotspotNodeIds=function(){return null;};b.prototype.attachChanged=function(d,f,l){return this.attachEvent('changed',d,f,l);};b.prototype.detachChanged=function(d,f,l){return this.detachEvent('changed',d,f,l);};b.prototype.fireChanged=function(p,c,e){return this.fireEvent('changed',p,c,e);};b.prototype.attachNodeCreated=function(d,f,l){return this.attachEvent('nodeCreated',d,f,l);};b.prototype.detachNodeCreated=function(d,f,l){return this.detachEvent('nodeCreated',d,f,l);};b.prototype.fireNodeCreated=function(p,c,e){return this.fireEvent('nodeCreated',p,c,e);};b.prototype.attachNodeRemoving=function(d,f,l){return this.attachEvent('nodeRemoving',d,f,l);};b.prototype.detachNodeRemoving=function(d,f,l){return this.detachEvent('nodeRemoving',d,f,l);};b.prototype.fireNodeRemoving=function(p,c,e){return this.fireEvent('nodeRemoving',p,c,e);};b.prototype.attachNodeReplaced=function(d,f,l){return this.attachEvent('nodeReplaced',d,f,l);};b.prototype.detachNodeReplaced=function(d,f,l){return this.detachEvent('nodeReplaced',d,f,l);};b.prototype.fireNodeReplaced=function(p,c,e){return this.fireEvent('nodeReplaced',p,c,e);};b.prototype.attachNodeUpdated=function(d,f,l){return this.attachEvent('nodeUpdated',d,f,l);};b.prototype.detachNodeUpdated=function(d,f,l){return this.detachEvent('nodeUpdated',d,f,l);};b.prototype.fireNodeUpdated=function(p,c,e){return this.fireEvent('nodeUpdated',p,c,e);};b.prototype.createNode=function(p,n,i){if(!p){p=this._scene.getSceneRef();}var c=p.children.indexOf(i);var o=new THREE.Group();o.name=n;p.add(o);if(c>=0){p.children.splice(c,0,p.children.pop());}this.fireNodeCreated({nodeRef:o,nodeId:o});this.fireChanged();return o;};b.prototype.createNodeCopy=function(n,p,c,i){if(!p){p=this._scene.getSceneRef();}var d=p.children.indexOf(i);var e=n.clone(true);e.name=c;p.add(e);if(d>=0){p.children.splice(d,0,p.children.pop());}this.fireNodeCreated({nodeRef:e,nodeId:e});this.fireChanged();return e;};b.prototype.removeNode=function(n){var c=[].concat(n);c.forEach(function(n){if(n&&n.parent){this.fireNodeRemoving({nodeRef:n,nodeId:n});n.parent.remove(n);}}.bind(this));this.fireChanged();return this;};return b;});\n",
	"sap/ui/vk/threejs/NodeProxy.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['../NodeProxy','./Material'],function(N,M){'use strict';var a=N.extend('sap.ui.vk.threejs.NodeProxy',{metadata:{},constructor:function(n,o){N.call(this);this._object3D=o;this._nodeHierarchy=n;}});a.prototype.destroy=function(){this._object3D=null;N.prototype.destroy.call(this);};a.prototype.getNodeHierarchy=function(){return this._nodeHierarchy;};a.prototype.getNodeRef=function(){return this._object3D;};a.prototype.getNodeId=function(){return this._object3D;};a.prototype.getVeId=function(){if(this._object3D.userData.treeNode){return this._object3D.userData.treeNode.sid;}else{return null;}};a.prototype.getMaterialId=function(){var r=this._object3D;if(this._object3D&&!this._object3D.geometry){if(this._object3D.children.length===1&&this._object3D.children[0].geometry&&(this._object3D.children[0].name===''||this._object3D.children[0].name===undefined)){r=this._object3D.children[0];}}if(r.material!==undefined&&r.material.userData!==undefined&&r.material.userData.materialId!==undefined){return r.material.userData.materialId;}else if(r.userData.originalMaterial!==undefined&&r.userData.originalMaterial.userData!==undefined&&r.userData.originalMaterial.userData.materialId!==undefined){return r.userData.originalMaterial.userData.materialId;}return undefined;};a.prototype.getName=function(){return this._object3D.name||('<'+this._object3D.type+'>');};a.prototype._updateAncestorsBoundingBox=function(){var p=this._object3D.parent;while(p){if(p.userData.boundingBox!==undefined){p._vkCalculateObjectOrientedBoundingBox();}p=p.parent;}};a.prototype.getLocalMatrix=function(){return sap.ui.vk.TransformationMatrix.convertTo4x3(this._object3D.matrix.elements);};a.prototype.setLocalMatrix=function(v){if(v){var o=this._object3D;o.matrix.fromArray(sap.ui.vk.TransformationMatrix.convertTo4x4(v));o.matrix.decompose(o.position,o.quaternion,o.scale);o.updateMatrixWorld(true);this._updateAncestorsBoundingBox();}this.setProperty('localMatrix',v,true);return this;};a.prototype.setLocalMatrixNotUpdatingBBox=function(v){if(v){var o=this._object3D;o.matrix.fromArray(sap.ui.vk.TransformationMatrix.convertTo4x4(v));o.matrix.decompose(o.position,o.quaternion,o.scale);o.updateMatrixWorld(true);}this.setProperty('localMatrix',v,true);return this;};a.prototype.getWorldMatrix=function(){return sap.ui.vk.TransformationMatrix.convertTo4x3(this._object3D.matrixWorld.elements);};a.prototype.setWorldMatrix=function(v){if(v){var o=this._object3D;o.matrixWorld.fromArray(sap.ui.vk.TransformationMatrix.convertTo4x4(v));if(o.parent){o.matrix.multiplyMatrices(new THREE.Matrix4().getInverse(o.parent.matrixWorld),o.matrixWorld);}else{o.matrix.copy(o.matrixWorld);}o.matrix.decompose(o.position,o.quaternion,o.scale);o.updateMatrixWorld(true);this._updateAncestorsBoundingBox();}this.setProperty('worldMatrix',v,true);return this;};a.prototype.getOpacity=function(){return this._object3D.userData.opacity;};a.prototype.setOpacity=function(v){var b=this._nodeHierarchy.getScene().getViewStateManager();if(b){b.setOpacity(this._object3D,v);}else{this._object3D._vkSetOpacity(v);}this.setProperty('opacity',v,true);return this;};a.prototype.getTintColorABGR=function(){return this._object3D.userData.tintColor;};a.prototype.setTintColorABGR=function(v){var b=this._nodeHierarchy.getScene().getViewStateManager();if(b){b.setTintColor(this._object3D,v);}else{this._object3D._vkSetTintColor(v);}this.setProperty('tintColorABGR',v,true);this.setProperty('tintColor',sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(v)),true);return this;};a.prototype.getTintColor=function(){return sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(this._object3D.userData.tintColor));};a.prototype.setTintColor=function(v){var b=sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(v));var c=this._nodeHierarchy.getScene().getViewStateManager();if(c){c.setOpacity(this._object3D,b);}else{this._object3D._vkSetTintColor(b);}this.setProperty('tintColorABGR',b,true);this.setProperty('tintColor',v,true);return this;};a.prototype.getNodeMetadata=function(){return this._object3D.userData.metadata;};a.prototype.getHasChildren=function(){return this._object3D.children.length>0;};a.prototype.getClosed=function(){return!!this._object3D.userData.closed;};a.prototype.assignMaterial=function(v){var s=function(m,n){var b;if(m.userData){b=m.userData.materialId;n.userData.materialId=b;}if(n.material!==undefined){if(n.userData.highlightColor!==undefined){if(n.userData.originalMaterial.side){m.side=n.userData.originalMaterial.side;}n.userData.originalMaterial=m;m.userData.materialUsed++;n.material=m.clone();var c=sap.ui.vk.abgrToColor(n.userData.highlightColor);n.material.color.lerp(new THREE.Color(c.red/255.0,c.green/255.0,c.blue/255.0),c.alpha);if(m.userData.defaultHighlightingEmissive){n.material.emissive.copy(m.userData.defaultHighlightingEmissive);}if(m.userData.defaultHighlightingSpecular){n.material.specular.copy(m.userData.defaultHighlightingSpecular);}}else{if(n.material.side){m.side=n.material.side;}n.material=m;m.userData.materialUsed++;delete n.userData.originalMaterial;}if(n.userData.opacity){if(!n.userData.originalMaterial){n.userData.originalMaterial=m;n.material=m.clone();}n.material.opacity*=n.userData.opacity;n.material.transparent=n.material.opacity<0.99;}}};s(v.getMaterialRef(),this._object3D);if(!this._object3D.children){return this;}this._object3D.children.forEach(function(c){if(!c){return;}s(v.getMaterialRef(),c);});return this;};a.prototype.enumerateMaterials=function(r){var c=function(n,f,r){if(n){if(n.userData.originalMaterial){f.add(n.userData.originalMaterial);}else if(n.material){f.add(n.material);}if(n.children){n.children.forEach(function(g){if(g){if(r){c(g,f,r);}else if(g.userData.originalMaterial){f.add(g.userData.originalMaterial);}else if(g.material){f.add(g.material);}}});}}};var m=new Set();c(this._object3D,m,r);var b=[];m.forEach(function(v){b.push(v);});var d=[];for(var i=0;i<b.length;i++){var e=new M();e.setMaterialRef(b[i]);d.push(e);}return d;};a.prototype.replaceMaterials=function(m,b){var c=m.getMaterialRef();var d=b.getMaterialRef();if(this._object3D.userData.originalMaterial&&this._object3D.userData.originalMaterial===c){this._object3D.userData.originalMaterial=d;}else if(this._object3D.material&&this._object3D.material===c){this._object3D.material=d;}if(!this._object3D.children){return this;}this._object3D.children.forEach(function(e){if(e&&e.userData.originalMaterial&&e.userData.originalMaterial===c){e.userData.originalMaterial=d;}else if(e&&e.material&&e.material===c){e.material=d;}});return this;};return a;});\n",
	"sap/ui/vk/threejs/NodesTransitionHelper.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/Element'],function(q,E){'use strict';var N=E.extend('sap.ui.vk.threejs.NodesTransitionHelper',{metadata:{properties:{},publicMethods:['setViewport','setNodeForDisplay','setDisappearingNode','setAppearingNode','clear','startDisplay','displayNodesMoving'],events:{displaying:{},displayed:{}}}});N.prototype.init=function(){this._viewport=null;this._nodeLocalmMatrixMap=new Map();this._nodeLocalMatrixMapForVisibility=new Map();this._timeIntervalForDisplay=500;this._startTimeForDisplay=0;};N.prototype.destroy=function(){this._viewport=null;this._nodeLocalmMatrixMap=null;this._nodeLocalMatrixMapForVisibility=new Map();};N.prototype.setViewport=function(v){this._viewport=v;};N.prototype.setNodeForDisplay=function(n){this._nodeLocalmMatrixMap.set(n,{oldMatrix:n.getLocalMatrix(),newMatrix:null});};N.prototype.setDisappearingNode=function(n,v){var o=n.getLocalMatrix();var a=[o[0]*0.0001,o[1],o[2],o[3],o[4]*0.0001,o[5],o[6],o[7],o[8]*0.0001,o[9],o[10],o[11]];this._nodeLocalMatrixMapForVisibility.set(n,{oldMatrix:o,newMatrix:a,visible:false});var b=n.getNodeRef();b.visible=true;};N.prototype.setAppearingNode=function(n){var o=n.getLocalMatrix();var a=[o[0]*0.0001,o[1],o[2],o[3],o[4]*0.0001,o[5],o[6],o[7],o[8]*0.0001,o[9],o[10],o[11]];this._nodeLocalMatrixMapForVisibility.set(n,{oldMatrix:a,newMatrix:o,visible:true});};N.prototype._interpolateNodePositionForVisibility=function(n,d,i){this._interpolateNodePosition(n,d.oldMatrix,d.newMatrix,i);if(i>=1){var a=n.getNodeRef();a.visible=d.visible;if(!a.visible){n.setLocalMatrixNotUpdatingBBox(d.oldMatrix);}}};N.prototype._interpolateNodePosition=function(n,o,a,i){var b=new THREE.Matrix4().fromArray(sap.ui.vk.TransformationMatrix.convertTo4x4(o));var c=new THREE.Vector3();var d=new THREE.Quaternion();var e=new THREE.Vector3();b.decompose(c,d,e);var f=new THREE.Matrix4().fromArray(sap.ui.vk.TransformationMatrix.convertTo4x4(a));var g=new THREE.Vector3();var h=new THREE.Quaternion();var j=new THREE.Vector3();f.decompose(g,h,j);var p=new THREE.Vector3().lerpVectors(c,g,i);var k=new THREE.Quaternion().copy(d).slerp(h,i);var s=new THREE.Vector3().lerpVectors(e,j,i);var t=new THREE.Matrix4().compose(p,k,s);n.setLocalMatrixNotUpdatingBBox(sap.ui.vk.TransformationMatrix.convertTo4x3(t.elements));};N.prototype.startDisplay=function(t){if(this._nodeLocalmMatrixMap.size===0){return;}this._timeIntervalForDisplay=t!==undefined?t:500;this._startTimeForDisplay=Date.now();this._nodeLocalmMatrixMap.forEach(function(m,n){m.newMatrix=n.getLocalMatrix();});this.fireDisplaying();};N.prototype.displayNodesMoving=function(){if(this._startTimeForDisplay===0||this._nodeLocalmMatrixMap===null||this._nodeLocalmMatrixMap.size===0){return;}var i=Math.min((Date.now()-this._startTimeForDisplay)/this._timeIntervalForDisplay,1);i=1-Math.pow(1-i,3);this._nodeLocalmMatrixMap.forEach(function(m,n){if(n&&m.oldMatrix&&m.newMatrix){this._interpolateNodePosition(n,m.oldMatrix,m.newMatrix,i);}}.bind(this));this._nodeLocalMatrixMapForVisibility.forEach(function(d,n){if(n&&d){this._interpolateNodePositionForVisibility(n,d,i);}}.bind(this));if(i===1){this.clear();this.fireDisplayed();}this._viewport.setShouldRenderFrame();};N.prototype.clear=function(){this._nodeLocalmMatrixMap.clear();this._nodeLocalMatrixMapForVisibility.clear();this._startTimeForDisplay=0;};return N;});\n",
	"sap/ui/vk/threejs/OrthographicCamera.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../OrthographicCamera','./thirdparty/three'],function(q,O,t){'use strict';var T=O.extend('sap.ui.vk.threejs.OrthographicCamera',{metadata:{}});var b=O.getMetadata().getParent().getClass().prototype;T.prototype.init=function(){if(b.init){b.init.call(this);}var n=1;var f=200000;this._nativeCamera=new THREE.OrthographicCamera(-1,1,1,-1,n,f);this._nativeCamera.position.set(0,0,10000);this._nativeCamera.zoom=0.02;this.setUsingDefaultClipPlanes(true);};T.prototype.update=function(w,h){var f=1/Math.max(w,h);this.setLeft(w*-f);this.setRight(w*f);this.setTop(h*f);this.setBottom(h*-f);this._nativeCamera.updateProjectionMatrix();};T.prototype.exit=function(){if(b.exit){b.exit.call(this);}this._nativeCamera=null;};T.prototype.getLeft=function(){return this._nativeCamera.left;};T.prototype.setLeft=function(v){this._nativeCamera.left=v;return this;};T.prototype.getRight=function(){return this._nativeCamera.right;};T.prototype.setRight=function(v){this._nativeCamera.right=v;return this;};T.prototype.getTop=function(){return this._nativeCamera.top;};T.prototype.setTop=function(v){this._nativeCamera.top=v;return this;};T.prototype.getBottom=function(){return this._nativeCamera.bottom;};T.prototype.setBottom=function(v){this._nativeCamera.bottom=v;return this;};T.prototype.getZoomFactor=function(){return this._nativeCamera.zoom;};T.prototype.setZoomFactor=function(v){this._nativeCamera.zoom=v;return this;};T.prototype.getCameraRef=function(){return this._nativeCamera;};T.prototype.setCameraRef=function(c){this._nativeCamera=c;return this;};T.prototype.getNearClipPlane=function(){return this._nativeCamera.near;};T.prototype.setNearClipPlane=function(v){this._nativeCamera.near=v;this.setUsingDefaultClipPlanes(false);return this;};T.prototype.getFarClipPlane=function(){return this._nativeCamera.far;};T.prototype.setFarClipPlane=function(v){this._nativeCamera.far=v;this.setUsingDefaultClipPlanes(false);return this;};T.prototype.getPosition=function(){return this._nativeCamera.position.toArray();};T.prototype.setPosition=function(v){this._nativeCamera.position.fromArray(v);this._nativeCamera.updateMatrixWorld();return this;};T.prototype.getUpDirection=function(){return this._nativeCamera.up.toArray();};T.prototype.setUpDirection=function(v){this._nativeCamera.up.fromArray(v);this._nativeCamera.updateMatrixWorld();return this;};T.prototype.getTargetDirection=function(){return this._nativeCamera.getWorldDirection().toArray();};T.prototype.setTargetDirection=function(v){var a=new THREE.Vector3().fromArray(v);a.add(this._nativeCamera.position);this._nativeCamera.lookAt(a);return this;};T.prototype.setUsingDefaultClipPlanes=function(v){this._nativeCamera.userData.usingDefaultClipPlanes=v;return this;};T.prototype.getUsingDefaultClipPlanes=function(){return this._nativeCamera.userData.usingDefaultClipPlanes;};T.prototype.adjustClipPlanes=function(a){var c=this._nativeCamera;c.updateMatrixWorld();a=a.clone().applyMatrix4(c.matrixWorldInverse);c.near=-a.max.z;c.far=-a.min.z;var e=Math.max((c.far-c.near)*0.0025,0.001);c.near-=e;c.far+=e;var p=1.0/(c.far-c.near);var z=(c.far+c.near)*p;c.projectionMatrix.elements[10]=-2*p;c.projectionMatrix.elements[14]=-z;return this;};T.prototype.getZoomNeedRecalculate=function(){if(this._nativeCamera.userData){return this._nativeCamera.userData.zoomNeedRecalculate;}};T.prototype.setZoomNeedRecalculate=function(v){this._nativeCamera.userData.zoomNeedRecalculate=v;};T.prototype.adjustZoom=function(a){var c=this._nativeCamera;c.updateMatrixWorld();a=a.clone().applyMatrix4(c.matrixWorldInverse);c.zoom=1/Math.max(a.min.x/c.left,a.max.y/c.top,a.max.x/c.right,a.min.y/c.bottom);c.updateProjectionMatrix();this.setZoomNeedRecalculate(false);return this;};return T;});\n",
	"sap/ui/vk/threejs/PerspectiveCamera.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../PerspectiveCamera','./thirdparty/three'],function(q,P,t){'use strict';var T=P.extend('sap.ui.vk.threejs.PerspectiveCamera',{metadata:{}});var b=P.getMetadata().getParent().getClass().prototype;T.prototype.init=function(){if(b.init){b.init.call(this);}var n=1;var f=10000;this._nativeCamera=new THREE.PerspectiveCamera(30,1,n,f);this._nativeCamera.position.set(0,0,100);this.setUsingDefaultClipPlanes(true);};T.prototype.update=function(w,h){this._nativeCamera.aspect=w/h;this._nativeCamera.updateProjectionMatrix();};T.prototype.exit=function(){if(b.exit){b.exit.call(this);}this._nativeCamera=null;};T.prototype.getFov=function(){return this._nativeCamera.fov;};T.prototype.setFov=function(v){this._nativeCamera.fov=v;this._nativeCamera.updateProjectionMatrix();this.setIsModified(true);return this;};T.prototype.getCameraRef=function(){return this._nativeCamera;};T.prototype.setCameraRef=function(c){this._nativeCamera=c;return this;};T.prototype.getNearClipPlane=function(){return this._nativeCamera.near;};T.prototype.setNearClipPlane=function(v){this._nativeCamera.near=v;this.setUsingDefaultClipPlanes(false);return this;};T.prototype.getFarClipPlane=function(){return this._nativeCamera.far;};T.prototype.setFarClipPlane=function(v){this._nativeCamera.far=v;this.setUsingDefaultClipPlanes(false);return this;};T.prototype.getPosition=function(){return this._nativeCamera.position.toArray();};T.prototype.setPosition=function(v){this._nativeCamera.position.fromArray(v);this._nativeCamera.updateMatrixWorld();return this;};T.prototype.getUpDirection=function(){return this._nativeCamera.up.toArray();};T.prototype.setUpDirection=function(v){this._nativeCamera.up.fromArray(v);this._nativeCamera.updateMatrixWorld();return this;};T.prototype.getTargetDirection=function(){return this._nativeCamera.getWorldDirection().toArray();};T.prototype.setTargetDirection=function(v){var a=new THREE.Vector3().fromArray(v);a.add(this._nativeCamera.position);this._nativeCamera.lookAt(a);return this;};T.prototype.setUsingDefaultClipPlanes=function(v){this._nativeCamera.userData.usingDefaultClipPlanes=v;return this;};T.prototype.getUsingDefaultClipPlanes=function(){return this._nativeCamera.userData.usingDefaultClipPlanes;};T.prototype.adjustClipPlanes=function(a){var e=this._nativeCamera;e.updateMatrixWorld();a=a.clone().applyMatrix4(e.matrixWorldInverse);e.near=-a.max.z;e.far=-a.min.z;var f=Math.max((e.far-e.near)*0.0025,0.001);e.far=Math.max(e.far,0.1);f=Math.max(f,e.far*0.0025);e.near-=f;e.far+=f;e.near=Math.max(e.near,e.far*0.0025);var c=-(e.far+e.near)/(e.far-e.near);var d=-2*e.far*e.near/(e.far-e.near);e.projectionMatrix.elements[10]=c;e.projectionMatrix.elements[14]=d;return this;};return T;});\n",
	"sap/ui/vk/threejs/PolylineGeometry.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['../library','./thirdparty/three'],function(l,t){'use strict';function P(){THREE.InstancedBufferGeometry.call(this);this.type='PolylineGeometry';var p=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0];var u=[2,-1,2,1,1,-1,1,1,-1,-1,-1,1,-2,-1,-2,1];var i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i);this.addAttribute('position',new THREE.Float32BufferAttribute(p,3));this.addAttribute('uv',new THREE.Float32BufferAttribute(u,2));}P.prototype=Object.assign(Object.create(THREE.InstancedBufferGeometry.prototype),{constructor:P,isPolylineGeometry:true,setVertices:function(v){this.vertices=v;var d=v.length-1;var e=new Float32Array(6*d);for(var i=0,c=0;i<d;i++){var a=v[i],b=v[i+1];e[c++]=a.x;e[c++]=a.y;e[c++]=a.z;e[c++]=b.x;e[c++]=b.y;e[c++]=b.z;}var f=new THREE.InstancedInterleavedBuffer(e,6,1);this.addAttribute('instanceStart',new THREE.InterleavedBufferAttribute(f,3,0));this.addAttribute('instanceEnd',new THREE.InterleavedBufferAttribute(f,3,3));var g=new THREE.InstancedInterleavedBuffer(new Float32Array(2*d),2,1);this.addAttribute('instanceDistance',new THREE.InterleavedBufferAttribute(g,2,0));this.computeBoundingBox();this.computeBoundingSphere();return this;},computeBoundingBox:function(){if(this.boundingBox===null){this.boundingBox=new THREE.Box3();}this.boundingBox.setFromPoints(this.vertices);},computeBoundingSphere:function(){if(this.boundingSphere===null){this.boundingSphere=new THREE.Sphere();}this.boundingSphere.setFromPoints(this.vertices);},_updateVertices:function(a){var b=this.vertices;var d=this.attributes.instanceStart.data;var c=d.array;a.forEach(function(e){var v=b[e];var i=e*6-3;if(i>=0){c[i+0]=v.x;c[i+1]=v.y;c[i+2]=v.z;}if(i+5<c.length){c[i+3]=v.x;c[i+4]=v.y;c[i+5]=v.z;}});d.needsUpdate=true;}});return P;});\n",
	"sap/ui/vk/threejs/PolylineMaterial.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['../library','./thirdparty/three'],function(l,t){'use strict';var p={lineColor:{value:new THREE.Color(1,1,1)},linewidth:{value:1},resolution:{value:new THREE.Vector2(1,1)},dashScale:{value:1},dashPeriod:{value:new THREE.Vector3(1,1,1)},dashAtlas:{value:null},lineLength:{value:1e5}};var u=THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,p]);var v=['#include <common>','#include <color_pars_vertex>','#include <fog_pars_vertex>','#include <logdepthbuf_pars_vertex>','#include <clipping_planes_pars_vertex>','','uniform float linewidth;','uniform vec2 resolution;','','attribute vec3 instanceStart;','attribute vec3 instanceEnd;','','varying vec2 vTC;','','#if defined(USE_DASH) || TRIM_STYLE','attribute vec2 instanceDistance;','varying float vLineDistance;','#endif','','void trimSegment(const in vec4 start, inout vec4 end) {','\t// trim end segment so it terminates between the camera plane and the near plane','','\t// conservative estimate of the near plane','\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column','\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column','\tfloat nearEstimate = -0.5 * b / a;','','\tfloat t = (nearEstimate - start.z) / (end.z - start.z);','','\tend.xyz = mix(start.xyz, end.xyz, t);','}','','void main() {','\tvTC = uv * linewidth;','','\t// camera space','\tvec4 start = modelViewMatrix * vec4(instanceStart, 1.0);','\tvec4 end = modelViewMatrix * vec4(instanceEnd, 1.0);','','\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane','\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space','\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly','\t// perhaps there is a more elegant solution -- WestLangley','','\tbool perspective = (projectionMatrix[ 2 ][ 3 ] == -1.0); // 4th entry in the 3rd column','\tif (perspective) {','\t\tif (start.z < 0.0 && end.z >= 0.0) {','\t\t\ttrimSegment(start, end);','\t\t} else if (end.z < 0.0 && start.z >= 0.0) {','\t\t\ttrimSegment(end, start);','\t\t}','\t}','','\t// clip space','\tvec4 clipStart = projectionMatrix * start;','\tvec4 clipEnd = projectionMatrix * end;','','\t// ndc space','\tvec2 ndcStart = clipStart.xy / clipStart.w;','\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;','','\t// direction','\tvec2 dir = (ndcEnd - ndcStart) * resolution;','\tfloat l = length(dir);','\tdir = normalize(dir);','','\t// perpendicular to dir','\tvec2 offset = vec2(dir.y, -dir.x) * position.x;','','#if defined(USE_DASH) || TRIM_STYLE','\tvLineDistance = mix(instanceDistance.x, instanceDistance.y, position.y);','#endif','','\t// endcaps','\tif ( position.y < 0.0 ) {','\t\toffset -= dir;','#if defined(USE_DASH)','\t\tvLineDistance = mix(instanceDistance.x, instanceDistance.y, position.y * linewidth / l);','#endif','\t} else if ( position.y > 1.0 ) {','\t\toffset += dir;','#if defined(USE_DASH)','\t\tvLineDistance = mix(instanceDistance.x, instanceDistance.y, 1.0 + (position.y - 1.0) * linewidth / l);','#endif','\t}','','\t// select end','\tvec4 clip = (position.y < 0.5) ? clipStart : clipEnd;','\tclip /= clip.w; // remove perspective correction','','\tclip.xy += offset * (linewidth / resolution);','','\tgl_Position = clip;','','\tvec4 mvPosition = (position.y < 0.5) ? start : end; // this is an approximation','','#include <logdepthbuf_vertex>','#include <clipping_planes_vertex>','#include <fog_vertex>','}'].join('\\n');var f=['uniform vec3 diffuse;','uniform vec3 lineColor;','uniform float opacity;','uniform float linewidth;','','#ifdef USE_DASH','uniform float dashScale;','uniform vec3 dashPeriod;','uniform sampler2D dashAtlas;','#endif','','#if (TRIM_STYLE & 2)','uniform float lineLength;','#endif','','varying float vLineDistance;','','#include <common>','#include <color_pars_fragment>','#include <fog_pars_fragment>','#include <logdepthbuf_pars_fragment>','#include <clipping_planes_pars_fragment>','','varying vec2 vTC;','','void main() {','','#include <clipping_planes_fragment>','','\tvec4 diffuseColor = vec4(diffuse * lineColor, opacity);','','\tvec2 uv = abs(vTC);','\tdiffuseColor.a *= clamp(linewidth + 0.5 - uv.y, 0.0, 1.0); // line antialiasing','','#if (TRIM_STYLE & 1)','\tif (vLineDistance < 0.0)','\t\tdiscard;','#endif','','#if (TRIM_STYLE & 2)','\tif (vLineDistance > lineLength)','\t\tdiscard;','#endif','','\tif (uv.x > linewidth) { // apply segment cap','#if (SEGMENT_CAP_STYLE == 1) // round cap','\t\tvec2 delta = vec2(uv.y, uv.x - linewidth);','\t\tdiffuseColor.a *= clamp(linewidth - length(delta), 0.0, 1.0);','#else','\t\tdiffuseColor.a *= clamp(linewidth + 1.0 - uv.x, 0.0, 1.0);','#endif','\t}','','#include <logdepthbuf_fragment>','#include <color_fragment>','','#ifdef USE_DASH','\tfloat x = fract(vLineDistance * dashPeriod.y / dashScale);','\tvec4 dash = texture2D(dashAtlas, vec2(x * dashPeriod.z, 0.5));','\tdash.zw *= 255.0;','\tx *= dashPeriod.x;','\tdash.zw = vec2(dash.z - x, x - dash.w);','\tx = min(dash.z, dash.w) * dashScale;','#if (DASH_CAP_STYLE == 1) // round cap','\tvec2 delta = vec2(x * 2.0, uv.y);','\tdiffuseColor.a *= max(step(x / linewidth, 0.0), clamp(linewidth + 0.5 - length(delta), 0.0, 1.0));','#else // no cap','\tdiffuseColor.a *= clamp(0.5 - x, 0.0, 1.0);','#endif','#endif','','\tgl_FragColor = diffuseColor;','','#include <premultiplied_alpha_fragment>','#include <tonemapping_fragment>','#include <encodings_fragment>','#include <fog_fragment>','}'].join('\\n');function P(a){THREE.ShaderMaterial.call(this,{type:'PolylineMaterial',uniforms:THREE.UniformsUtils.clone(u),vertexShader:v,fragmentShader:f});this.defines.DASH_CAP_STYLE=0;this.defines.SEGMENT_CAP_STYLE=0;this.defines.TRIM_STYLE=0;this._dashPattern=[];Object.defineProperties(this,{color:{enumerable:true,get:function(){return this.uniforms.diffuse.value;},set:function(b){this.uniforms.diffuse.value=b;}},lineColor:{enumerable:true,get:function(){return this.uniforms.lineColor.value;},set:function(b){this.uniforms.lineColor.value=b;}},linewidth:{enumerable:true,get:function(){return this.uniforms.linewidth.value;},set:function(b){this.uniforms.linewidth.value=b;}},dashCapStyle:{enumerable:true,get:function(){return this.defines.DASH_CAP_STYLE;},set:function(b){this.defines.DASH_CAP_STYLE=b;}},segmentCapStyle:{enumerable:true,get:function(){return this.defines.SEGMENT_CAP_STYLE;},set:function(b){this.defines.SEGMENT_CAP_STYLE=b;}},trimStyle:{enumerable:true,get:function(){return this.defines.TRIM_STYLE;},set:function(b){this.defines.TRIM_STYLE=b;}},dashScale:{enumerable:true,get:function(){return this.uniforms.dashScale.value;},set:function(b){this.uniforms.dashScale.value=b;}},dashPattern:{enumerable:true,get:function(){return this._dashPattern;},set:function(b){this._dashPattern=b;this._updateDashAtlas();}},resolution:{enumerable:true,get:function(){return this.uniforms.resolution.value;},set:function(b){this.uniforms.resolution.value.copy(b);}},lineLength:{enumerable:true,get:function(){return this.uniforms.lineLength.value;},set:function(b){this.uniforms.lineLength.value=b;}}});this.setValues(a);}P.prototype=Object.create(THREE.ShaderMaterial.prototype);P.prototype.constructor=P;P.prototype.isLineMaterial=true;P.prototype._updateDashAtlas=function(){if(!this._dashPattern.length){delete this.defines.USE_DASH;this.uniforms.dashAtlas.value=null;this.needsUpdate=true;return;}var d=Array.from(this._dashPattern);if(d.length&1){d=d.concat(d);}var a=d.reduce(function(m,n){return m+Math.ceil(n);});var b=THREE.Math.ceilPowerOfTwo(a);this.uniforms.dashPeriod.value.set(a,1/a,a/b);var e=new Uint8Array(b*4);for(var i=0,x=0,c=0;i<d.length;i++){var w=d[i];var g=(i&1)?x+w:x;var h=(i&1)?x:x+w;var j=(i&1)?0:255;while(w-->0){e[c++]=j;e[c++]=0;e[c++]=g;e[c++]=h;x++;}}var k=new THREE.DataTexture(e,b,1,THREE.RGBAFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter);k.needsUpdate=true;this.defines.USE_DASH='';this.uniforms.dashAtlas.value=k;this.needsUpdate=true;};P.prototype.copy=function(s){THREE.ShaderMaterial.prototype.copy.call(this,s);this.color.copy(s.color);this.lineColor.copy(s.lineColor);this.linewidth=s.linewidth;this.dashCapStyle=s.dashCapStyle;this.segmentCapStyle=s.segmentCapStyle;this.trimStyle=s.trimStyle;this.dashPattern=s.dashPattern;this.resolution=s.resolution;this.lineLength=s.lineLength;return this;};return P;});\n",
	"sap/ui/vk/threejs/PolylineMesh.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','./thirdparty/three','./PolylineGeometry','./PolylineMaterial'],function(q,c,d,P,e){'use strict';function f(g,m){THREE.Mesh.call(this);this.type='PolylineMesh';this.geometry=g!==undefined?g:new P();this.material=m!==undefined?m:new e();}f.prototype=Object.assign(Object.create(THREE.Mesh.prototype),{constructor:f,isPolylineMesh:true,computeLineDistances:(function(){var a=new THREE.Vector4();var b=new THREE.Vector4();var g=new THREE.Vector2();var h=new THREE.Vector2();return function(m,v,n){var k=this.geometry;var o=k.attributes.instanceDistance.data;var p=o.array;var r=k.vertices;var s=0,t;a.copy(r[0]).applyMatrix4(m);for(var i=0,j=0,l=o.count;i<l;i++,j+=2){b.copy(r[i+1]).applyMatrix4(m);if(a.w>=n){g.copy(a).multiplyScalar(1/a.w);if(b.w>=n){h.copy(b).multiplyScalar(1/b.w);}else{t=(a.w-n)/(a.w-b.w);h.copy(b).sub(a).multiplyScalar(t).add(a).multiplyScalar(1/n);}}else if(b.w>=n){h.copy(b).multiplyScalar(1/b.w);t=(b.w-n)/(b.w-a.w);g.copy(a).sub(b).multiplyScalar(t).add(b).multiplyScalar(1/n);}else{g.set(0,0,0);h.set(0,0,0);}p[j]=s;s+=h.sub(g).multiply(v).length()*0.5;p[j+1]=s;a.copy(b);}this.material.lineLength=s;o.needsUpdate=true;return this;};}())});return f;});\n",
	"sap/ui/vk/threejs/Scene.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../Scene','./NodeHierarchy'],function(q,S,N){'use strict';var c=S.extend('sap.ui.vk.threejs.Scene',{metadata:{},constructor:function(a){S.call(this);this._id=q.sap.uid();this._scene=a;this._state=null;this._defaultNodeHierarchy=null;this._currentViewStateManager=null;}});c.prototype.init=function(){var a=['attribute vec3 normal1;','attribute vec3 normal2;','#include <clipping_planes_pars_vertex>','uniform vec4 color;','varying vec4 vColor;','void main() {','\t#include <begin_vertex>','\t#include <project_vertex>','\t#include <clipping_planes_vertex>','\tvec3 eyeDirection = mvPosition.xyz;','\tvec3 n1 = normalMatrix * normal1;','\tvec3 n2 = normalMatrix * normal2;','\tvColor = color;','\tvColor.a *= step(dot(eyeDirection, n1) * dot(eyeDirection, n2), 0.0);','}'].join('\\n');var b=['#include <clipping_planes_pars_fragment>','varying vec4 vColor;','void main() {','\t#include <clipping_planes_fragment>','\tif (vColor.a < ALPHATEST) discard;','\tgl_FragColor = vColor;','}'].join('\\n');this._outlineColor=new THREE.Vector4(0,0,0,1);this._outlineMaterial=new THREE.ShaderMaterial({uniforms:{color:{value:this._outlineColor}},vertexShader:a,fragmentShader:b,depthWrite:false,depthFunc:THREE.LessEqualDepth,polygonOffset:true,polygonOffsetFactor:-4,blending:THREE.NormalBlending,alphaTest:0.01,clipping:true});this._solidWhiteMaterial=new THREE.MeshBasicMaterial({color:0xFFFFFF});};c.prototype.destroy=function(){if(this._defaultNodeHierarchy){this._defaultNodeHierarchy.destroy();this._defaultNodeHierarchy=null;}this._state=null;this._scene=null;S.prototype.destroy.call(this);};c.prototype.setDoubleSided=function(v){this.setProperty('doubleSided',v,true);this._scene.traverse(function(a){if(a.material!==undefined){var b=a.userData;var e=THREE.FrontSide;var m;if(b.originalMaterial){if(b.originalMaterial.userData===undefined){b.originalMaterial.userData={};}m=b.originalMaterial.userData;if(m.originalMaterialSide===undefined){m.originalMaterialSide=b.originalMaterial.side;}e=m.originalMaterialSide;}else{if(a.material.userData===undefined){a.material.userData={};}m=a.material.userData;if(m.originalMaterialSide===undefined){m.originalMaterialSide=a.material.side;}e=m.originalMaterialSide;}a.material.side=v?THREE.DoubleSide:e;}});return this;};c.prototype.setViewStateManager=function(v){this._currentViewStateManager=v;return this;};c.prototype.getViewStateManager=function(){return this._currentViewStateManager;};c.prototype.getId=function(){return this._id;};c.prototype.getDefaultNodeHierarchy=function(){if(!this._defaultNodeHierarchy){this._defaultNodeHierarchy=new N(this);}return this._defaultNodeHierarchy;};function d(b,a){var e=b.min,i=b.max,m=a.elements,j=(e.x+i.x)*0.5,l=(e.y+i.y)*0.5,v=(e.z+i.z)*0.5,w=i.x-j,x=i.y-l,y=i.z-v;var z=m[0]*j+m[4]*l+m[8]*v+m[12];var A=m[1]*j+m[5]*l+m[9]*v+m[13];var B=m[2]*j+m[6]*l+m[10]*v+m[14];var C=Math.abs(m[0]*w)+Math.abs(m[4]*x)+Math.abs(m[8]*y);var D=Math.abs(m[1]*w)+Math.abs(m[5]*x)+Math.abs(m[9]*y);var E=Math.abs(m[2]*w)+Math.abs(m[6]*x)+Math.abs(m[10]*y);e.set(z-C,A-D,B-E);i.set(z+C,A+D,B+E);}THREE.Object3D.prototype._expandBoundingBox=function(b,v){var a=new THREE.Box3();function e(i){var j=i.geometry;if(j!==undefined){if(!j.boundingBox){j.computeBoundingBox();}if(!j.boundingBox.isEmpty()){a.copy(j.boundingBox);d(a,i.matrixWorld);b.min.min(a.min);b.max.max(a.max);}}var l=i.userData.boundingBox;if(l!==undefined&&!l.isEmpty()&&!v){a.copy(l);d(a,i.matrixWorld);b.min.min(a.min);b.max.max(a.max);}}this.updateMatrixWorld();if(v){this.traverseVisible(e);}else{this.traverse(e);}return b;};c.prototype._computeBoundingBox=function(v){var b=new THREE.Box3();if(this._scene){this._scene._expandBoundingBox(b,v);}return b;};c.prototype.getSceneRef=function(){return this._scene;};c.prototype._setState=function(a){this._state=a;};c.prototype.nodeRefToPersistentId=function(a){var b=this._state;if(Array.isArray(a)){if(!b){return[];}var i=[];a.forEach(function(e){i.push(b.object3DToSid(e));});return i;}else{if(!b){return null;}return b.object3DToSid(a);}};c.prototype.persistentIdToNodeRef=function(a){var b=this._state;if(Array.isArray(a)){if(!b){return[];}var e=[];a.forEach(function(i){e.push(b.sidToObject3D(i));});return e;}else{if(!b){return null;}return b.sidToObject3D(a);}};c.prototype.enumerateMaterials=function(){if(!this._defaultNodeHierarchy){return[];}var a=this._defaultNodeHierarchy.createNodeProxy(this._scene);if(a){return a.enumerateMaterials(true);}else{return[];}};var f=0;function g(a,b){var e=a.x-b.x;if(e<-f){return true;}if(e>f){return false;}var i=a.y-b.y;if(i<-f){return true;}if(i>f){return false;}return a.z-b.z<-f;}function h(a,b,e){if(b<e){var i=p(a,b,e);h(a,b,i-1);h(a,i+1,e);}return a;}function p(a,b,e){var j=a[e],l=b;for(var i=b;i<e;i++){if(g(a[i],j)){s(a,i,l);l++;}}s(a,e,l);return l;}function s(a,i,j){if(i!=j){var b=a[i];a[i]=a[j];a[j]=b;}}var k=new THREE.Vector3();function n(a){a.computeBoundingBox();a.boundingBox.getSize(k);f=Math.max(k.x,k.y,k.z)*1e-4;var v=a.vertices,b=v.length,e=a.faces.length;if(b===0||e===0){return;}var i,j;for(i=0;i<b;i++){v[i].index=i;}h(v,0,v.length-1);var l=[],m=[];l.push(v[0]);m[v[0].index]=l.length-1;for(i=1;i<b;i++){if(g(l[l.length-1],v[i])){l.push(v[i]);}m[v[i].index]=l.length-1;}a.vertices=l;for(i=0,e=a.faces.length,j=0;i<e;i++){var w=a.faces[i];var x=a.faces[j];x.a=m[w.a];x.b=m[w.b];x.c=m[w.c];if(x.a!==x.b&&x.b!==x.c&&x.c!==x.a){j++;}}a.faces.length=j;}function O(a,b){THREE.BufferGeometry.call(this);this.type='OutlineGeometry';var m=Math.cos(THREE.Math.DEG2RAD*((b!==undefined)?b:1));var w={},x,y;var z,A=['a','b','c'];var v=new THREE.Vector3();var B;if(a.isBufferGeometry){B=new THREE.Geometry();B.fromBufferGeometry(a);}else{B=a.clone();}n(B);B.computeFaceNormals();var C=B.vertices;var D=B.faces;for(var E=0,l=D.length;E<l;E++){var F=D[E];for(var i=0,j=2;i<3;j=i++){x=F[A[j]];y=F[A[i]];z=Math.min(x,y)+','+Math.max(x,y);if(w[z]===undefined){w[z]={index1:x,index2:y,face1:E,face2:undefined};}else{w[z].face2=E;}}}var G=[];var H=[];var I=[];for(z in w){var e=w[z];if(e.face2===undefined||(D[e.face1].normal.dot(D[e.face2].normal)<=m&&v.copy(C[e.index2]).sub(C[e.index1]).cross(D[e.face1].normal).dot(D[e.face2].normal)>0)){var J=C[e.index1];G.push(J.x,J.y,J.z);J=C[e.index2];G.push(J.x,J.y,J.z);var K=D[e.face1].normal;H.push(K.x,K.y,K.z);H.push(K.x,K.y,K.z);if(e.face2!==undefined){var L=D[e.face2].normal;I.push(L.x,L.y,L.z);I.push(L.x,L.y,L.z);}else{I.push(0,0,0);I.push(0,0,0);}}}this.addAttribute('position',new THREE.Float32BufferAttribute(G,3));this.addAttribute('normal1',new THREE.Float32BufferAttribute(H,3));this.addAttribute('normal2',new THREE.Float32BufferAttribute(I,3));}O.prototype=Object.create(THREE.BufferGeometry.prototype);O.prototype.constructor=O;function o(b){return b.min.x>=b.max.x&&b.min.y>=b.max.y&&b.min.z>=b.max.z;}function r(a){var b=null;if(a.isMesh&&a.geometry&&!o(a.geometry.boundingBox)&&(a.name||a.children.length>0)){b=a.geometry;if(b.isBufferGeometry){b=new THREE.Geometry().fromBufferGeometry(b);}}for(var i=0,l=a.children.length;i<l;i++){var e=a.children[i];if(e.isMesh&&e.geometry&&!o(e.geometry.boundingBox)&&!e.name&&e.children.length===0){if(b===null){b=new THREE.Geometry();}var j=e.geometry;if(j.isBufferGeometry){j=new THREE.Geometry().fromBufferGeometry(j);}b.merge(j,e.matrix);}}return b;}function t(a,b){var e=a.userData;if(e.defaultMaterial===undefined){e.defaultMaterial=e.originalMaterial||a.material;}a.material=b;e.originalMaterial=null;a._vkUpdateMaterialColor();a._vkUpdateMaterialOpacity();}function u(a){var b=a.userData;if(b.defaultMaterial){a.material=b.defaultMaterial;delete b.defaultMaterial;b.originalMaterial=null;a._vkUpdateMaterialColor();a._vkUpdateMaterialOpacity();}}THREE.Object3D.prototype._vkTraverseMeshNodes=function(a){if(this.isSprite||this.isBillboard||this.isDetailView){return;}a(this);var b=this.children;for(var i=0,l=b.length;i<l;i++){b[i]._vkTraverseMeshNodes(a);}};c.prototype._createOutlineGeometry=function(a){if(this._scene){this._scene._vkTraverseMeshNodes(function(b){if(b.isOutline){b.visible=true;}else{if(!b.hasOutline){b.hasOutline=true;var m=r(b);if(m!==null){var e=new O(m);e.boundingBox=new THREE.Box3();var l=new THREE.LineSegments(e,this._outlineMaterial);l.isOutline=true;l.renderOrder=b.renderOrder+0.5;b.add(l);}}if(b.isMesh&&b.material){switch(a){case sap.ui.vk.RenderMode.LineIllustration:t(b,this._solidWhiteMaterial);break;case sap.ui.vk.RenderMode.ShadedIllustration:var i=(b.userData.defaultMaterial||b.userData.originalMaterial||b.material).clone();if(i.emissive){i.color.multiplyScalar(0.5);i.emissive.multiplyScalar(0.5).addScalar(0.5);}else{i.color.multiplyScalar(0.5).addScalar(0.5);}t(b,i);break;default:u(b);break;}}}}.bind(this));}};c.prototype._hideOutlineGeometry=function(){if(this._scene){this._scene._vkTraverseMeshNodes(function(a){if(a.isOutline){a.visible=false;}if(a.isMesh){u(a);}});}};return c;});\n",
	"sap/ui/vk/threejs/SceneBuilder.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/base/Log','./thirdparty/three','./BBoxSubdivider','./UsageCounter','../totara/ListMap','./OrthographicCamera','./PerspectiveCamera','sap/ui/vk/View'],function(q,L,t,B,U,a,O,P,V){'use strict';var S=function(r){this._id=S._nextId++;S._add(this);this._submeshes=new Map();this._callouts=new Map();this._cameras=new Map();this._materials=new Map();this._images=new Map();this._geometries=new Map();if(r){this._rootNode=r;this._nodes=new Map();this._NodeMeshIdSubmeshIdsMap=new Map();this._sequences=new Map();this._tracks=new Map();this._trackIdSequenceNodeMap=new a();this._viewGroups=new Map();this._views=new Map();}else{this._rootNode=null;this._nodes=null;this._NodeMeshIdSubmeshIdsMap=null;this._sequences=null;this._tracks=null;this._trackIdSequenceNodeMap=null;this._viewGroups=null;this._views=null;}this._currentSceneId=null;this._sceneIdTreeNodesMap=new Map();this._sceneIdRootNodeMap=new Map();this._sceneIdNodMeshIdMap=new Map();this._sceneIdViewGroupMap=new Map();this._sceneIdViewMap=new Map();};S._nextId=1;S._map=new Map();S.prototype.getId=function(){return this._id;};S._add=function(s){S._map.set(s.getId(),s);return this;};S.prototype.setRootNode=function(r,c,s){this._rootNode=r;this._nodes=new Map();this._nodes.set(c,r);this._NodeMeshIdSubmeshIdsMap=new Map();if(!this._rootNode.userData){this._rootNode.userData={};}this._sequences=new Map();this._tracks=new Map();this._trackIdSequenceNodeMap=new a();this._viewGroups=new Map();this._views=new Map();if(s){this._sceneIdTreeNodesMap.set(s,this._nodes);this._sceneIdRootNodeMap.set(s,r);this._sceneIdNodMeshIdMap.set(s,this._NodeMeshIdSubmeshIdsMap);this._sceneIdViewGroupMap.set(s,this._viewGroups);this._sceneIdViewMap.set(s,this._views);this._currentSceneId=s;}return this;};S.prototype._resetCurrentScene=function(s){if(s&&s!==this._currentSceneId){var c=this._sceneIdTreeNodesMap.get(s);if(c){this._nodes=c;}else{this._nodes=null;}var e=this._sceneIdRootNodeMap.get(s);if(e){this._rootNode=e;}else{this._rootNode=null;}this._currentSceneId=s;}};S.prototype.getNode=function(c,s){this._resetCurrentScene(s);if(!this._nodes){return null;}return this._nodes.get(c);};S.prototype.getObjectId=function(c){do{if(c.userData&&c.userData.treeNode&&c.userData.treeNode.sid){return c.userData.treeNode.sid;}c=c.parent;}while(c);return null;};var b=function(c){var m=new THREE.Matrix4();if(c.length===3){m.setPosition(new THREE.Vector3().fromArray(c));}else if(c.length===12){m.set(c[0],c[3],c[6],c[9],c[1],c[4],c[7],c[10],c[2],c[5],c[8],c[11],0.0,0.0,0.0,1.0);}else if(c.length===16){m.set(c[0],c[4],c[8],c[12],c[1],c[5],c[9],c[13],c[2],c[6],c[10],c[14],c[3],c[7],c[11],c[15]);}else{throw'Invalid matrix format';}return m;};var D={r:0.0235,g:0.0235,b:0.0235};var d={r:0.0602,g:0.0602,b:0.0602};S.prototype._createTemporaryMaterial=function(m){var c=new THREE.MeshPhongMaterial({color:0xaaaaaa});if(!c.userData){c.userData={};}c.userData.defaultHighlightingEmissive=D;c.userData.defaultHighlightingSpecular=d;c.userData.materialUsed=0;c.userData.materialId=m;c.userData.toBeUpdated=true;this._materials.set(m,c);return c;};S.prototype.createNode=function(c,e,s){var r={needUpdateMaterial:false,needSetSubmesh:false,idOfGeometriesToUpdate:null,materialIds:[]};this._resetCurrentScene(s);var i=this._nodes.get(e)||null;var l=new THREE.Group();l.userData.treeNode=c;if(c.renderOrder){l.renderOrder=c.renderOrder;}l.visible=c.visible!==undefined?c.visible:true;if(c.name){l.name=c.name;}l.userData.opacity=c.opacity;if(c.transform){l.applyMatrix(b(c.transform));}(i||this._rootNode).add(l);this._nodes.set(c.sid,l);var m=this.attachSubMeshesToNode(c.sid,s);var v=this.applyNodeMaterialToSubmeshes(c.sid,s);var w=this.applyNodeOpacityToSubmeshes(c.sid,s);r.needUpdateMaterial=v.needUpdateMaterial;r.needSetSubmesh=m.needSetSubmesh;r.idOfGeometriesToUpdate=m.idOfGeometriesToUpdate;r.materialIds=w.materialIds;return r;};S.prototype.applyNodeMaterialToSubmeshes=function(c,s){var r={needUpdateMaterial:false};this._resetCurrentScene(s);var e=this._nodes.get(c);if(!e){return r;}var l=e.userData.treeNode;e.userData.materialId=l.materialId;if(!l.meshId||!e.userData.materialId){return r;}var m=this._materials.get(e.userData.materialId);if(!m){m=this._createTemporaryMaterial(e.userData.materialId);r.needUpdateMaterial=true;}if(e&&e.children){for(var i=0;i<e.children.length;i++){var v=e.children[i];v.material=m;v.userData.materialId=e.userData.materialId;U.increaseMaterialUsed(m);if(l.renderOrder){v.material.depthTest=false;}}}return r;};S.prototype.applyNodeOpacityToSubmeshes=function(c,s,m){var r={materialIds:[]};this._resetCurrentScene(s);var e=this._nodes.get(c);if(!e){return r;}var l=e.userData.treeNode;if(!l.meshId||!l.opacity){return r;}if(e&&e.children){var w=new Set();for(var i=0;i<e.children.length;i++){var x=e.children[i];if(x.material&&(!m||m===x.material.userData.materialId)){if(!x.material.userData.toBeUpdated){x.userData.opacity=l.opacity;x.userData.originalMaterial=x.material;x.material=x.material.clone();x.material.opacity*=x.userData.opacity;x.material.transparent=x.material.opacity<0.99;}else{w.add(x.material.userData.materialId);}}}w.forEach(function(v){r.materialIds.push(v);});}return r;};S.prototype.attachSubMeshesToNode=function(c,s){var r={needSetSubmesh:false,idOfGeometriesToUpdate:new Set()};this._resetCurrentScene(s);var e=this._nodes.get(c);var l=e.userData.treeNode;if(!l.meshId){return r;}var m=this._NodeMeshIdSubmeshIdsMap.get(l.meshId);if(!m){r.needSetSubmesh=true;return r;}var v=[];m.forEach(function(y){v.push(y);});var i;var w;for(i=0;i<v.length;i++){w=v[i];this._insertSubmesh(l.sid,w,s);}for(i=0;i<v.length;i++){w=v[i];var x=this._submeshes.get(w);if(x&&x.userData&&x.userData.isBoundingBox&&x.userData.geometryId){r.idOfGeometriesToUpdate.add(x.userData.geometryId);}}return r;};S.prototype.updateMaterialInNode=function(c,s){this._resetCurrentScene(s);var r={needUpdateMaterial:false,nodeUpdated:false};var e=this._nodes.get(c.sid);var l=e.userData.materialId;var m=e.userData.opacity;e.userData.treeNode=c;e.userData.materialId=c.materialId;e.userData.opacity=c.opacity;var v=false;if(l===undefined){if(e.userData.materialId!==undefined){v=true;}}else if(l!==e.userData.materialId){v=true;}var w=false;if(m===undefined){if(e.userData.opacity!==undefined){w=true;}}else if(m!==e.userData.opacity){w=true;}if(!v&&!w){return r;}r.nodeUpdated=true;var x=null;if(e.userData.materialId){x=this._materials.get(e.userData.materialId);if(x===undefined){x=this._createTemporaryMaterial(e.userData.materialId);r.needUpdateMaterial=true;}if(c.renderOrder){x.depthTest=false;}}if(e&&e.children){for(var i=0;i<e.children.length;i++){var y=e.children[i];if(x){y.material=x;y.userData.materialId=c.materialId;U.increaseMaterialUsed(x);}else{var z=this._materials.get(y.userData.initialMaterialId);y.material=z;y.userData.materialId=y.userData.initialMaterialId;U.increaseMaterialUsed(z);}delete y.userData.originalMaterial;if(e.userData.opacity!==undefined&&(y.material.userData&&!y.material.userData.toBeUpdated)){y.userData.opacity=e.userData.opacity;y.userData.originalMaterial=y.material;y.material=y.material.clone();y.material.opacity*=y.userData.opacity;y.material.transparent=y.material.opacity<0.99;}else{y.userData.opacity=undefined;}}}return r;};S.prototype.updateGeometryInNode=function(c,e,s){this._resetCurrentScene(s);var l=this._nodes.get(c);if(l&&l.children){for(var i=0;i<l.children.length;i++){var m=l.children[i];if(!m.isMesh){continue;}if(m.userData.geometryId===e){var r=this._geometries.get(e);if(r){if(r.isPolyline&&!m.isLineSegment){var v=m.parent;var w=m.material;v.remove(m);var x=new THREE.LineBasicMaterial({color:0xff0000,linewidth:1,depthTest:false});x.color.copy(w.color);var y=new THREE.LineSegments(r,x);v.add(y);y.userData.meshId=m.userData.meshId;if(r.isPositionQuantized){y.position.copy(m.position);y.scale.copy(m.scale);}y.userData.initialMaterialId=m.userData.initialMaterialId;y.userData.isBoundingBox=false;y.userData.geometryId=m.userData.geometryId;y.userData.meshId=m.userData.meshId;y.userData.materialId=m.userData.materialId;y.userData.submeshInfo=m.userData.submeshInfo;y.userData.submeshId=m.userData.submeshId;var z=this._submeshes.get(y.userData.submeshId);if(z&&z.renderOrder){y.renderOrder=z.renderOrder;}this._submeshes.set(y.userData.submeshId,y);}else{m.geometry=r;m.userData.isBoundingBox=false;if(!r.isPositionQuantized){m.position.set(0,0,0);m.scale.set(1,1,1);}}U.increaseGeometryUsed(r);}}}}return this;};S.prototype.getChildNodeIds=function(c,s,e){this._resetCurrentScene(s);var l=this._nodes.get(c);var m=[];if(!l){return m;}if(l&&l.children){for(var i=0;i<l.children.length;i++){var r=l.children[i];if(r.userData&&r.userData.treeNode&&r.userData.treeNode.sid){m.push(r.userData.treeNode.sid);}else if(e&&r.userData&&r.userData.submeshInfo&&r.userData.submeshInfo.id){m.push(r.userData.submeshInfo.id);}}}return m;};function f(c){var e=atob(c);var l=e.length;var m=new Uint8Array(l);for(var i=0;i<l;i++){m[i]=e.charCodeAt(i);}return m;}function g(l){if(l){for(var i=0;i<l.length;i++){if(l[i].type==='box'&&l[i].data){return l[i];}}}return null;}function h(v){if(v===0){return Number.EPSILON;}return v;}function u(m,c){m.position.set((c[3]+c[0])/2,(c[4]+c[1])/2,(c[5]+c[2])/2);m.scale.set(h(c[3]-c[0]),h(c[4]-c[1]),h(c[5]-c[2]));}S.prototype.setSubmesh=function(m,s){var r={needUpdataMaterial:false,geometryIdToRequest:null,geometryPriority:0};var c=this._NodeMeshIdSubmeshIdsMap.get(m);if(!c){c=new Set();this._NodeMeshIdSubmeshIdsMap.set(m,c);}c.add(s.id);if(!s.lods){return false;}var l=null;for(var i=0;i<s.lods.length;i++){if(s.lods[i].type===undefined||s.lods[i].type==='mesh'||s.lods[i].type==='line'){l=s.lods[i];}}if(!l){return false;}var v=null;if(s.materialId){v=this._materials.get(s.materialId);if(!v){v=this._createTemporaryMaterial(s.materialId);r.needUpdataMaterial=true;}}var w=null;var x=this._geometries.get(l.id);if(x){if(v){w=new THREE.Mesh(x,v);}else{w=new THREE.Mesh(x);}w.userData.initialMaterialId=s.materialId;w.userData.isBoundingBox=false;w.userData.geometryId=l.id;w.userData.meshId=m;w.userData.submeshId=s.id;w.userData.materialId=s.materialId;if(x.isPositionQuantized){u(w,l.boundingBox);}U.increaseGeometryUsed(x);}else{r.geometryIdToRequest=l.id;var y;try{var z=g(s.lods);if(z&&z.data){var E=f(z.data);var F=B.unpackSubDividedBoundingBox(E);y=B.makeSubDividedBoundingBoxGeometry(F);}}catch(e){}var G=new THREE.BoxBufferGeometry(1,1,1);w=new THREE.Mesh(y?y:G,v);var H=l.boundingBox;if(Array.isArray(H)&&H.length===6){r.geometryPriority=new THREE.Vector3(H[3]-H[0],H[4]-H[1],H[5]-H[2]).length();}else{H=[0,0,0,1,1,1];}u(w,H);w.userData.initialMaterialId=s.materialId;w.userData.isBoundingBox=true;w.userData.geometryId=l.id;w.userData.meshId=m;w.userData.materialId=s.materialId;w.userData.submeshId=s.id;}w.userData.submeshInfo=s;this._submeshes.set(s.id,w);return r;};S.prototype.getSubmesh=function(s){return this._submeshes.get(s);};S.prototype.setGeometry=function(c){if(c.error){return this;}var e=new THREE.BufferGeometry();var i=new THREE.BufferAttribute(new Uint16Array(c.data.indices),1);var l=new THREE.BufferAttribute(new Float32Array(c.data.points),3);e.setIndex(i);e.addAttribute('position',l);if(!c.isPolyline){if(c.data.normals.length===c.data.points.length){var m=new THREE.BufferAttribute(new Float32Array(c.data.normals),3);e.addAttribute('normal',m);}if(c.data.uvs&&c.data.uvs.length*3===c.data.points.length*2){e.addAttribute('uv',new THREE.BufferAttribute(new Float32Array(c.data.uvs),2));}}else{e.isPolyline=true;}try{e.computeBoundingSphere();}catch(r){return this;}e.isPositionQuantized=c.isPositionQuantized;if(!e.userData){e.userData={};}e.userData.geometryId=c.id;e.userData.geometryUsed=0;this._geometries.set(c.id,e);return this;};S.prototype.getGeometry=function(c){return this._geometries.get(c);};S.prototype._insertSubmesh=function(c,s,e){this._resetCurrentScene(e);var i=this._nodes.get(c);var l=this._submeshes.get(s);if(!i||!l){return false;}if(l.parent){l=l.clone();if(l.userData){if(l.userData.submeshInfo&&l.userData.initialMaterialId){var m=this._materials.get(l.userData.initialMaterialId);if(m){l.material=m;U.increaseMaterialUsed(m);}}if(l.userData&&l.userData.opacity){delete l.userData.opacity;}}}i.add(l);if(i.renderOrder){l.renderOrder=i.renderOrder;var M=this._materials.get(l.userData.initialMaterialId);if(M){M.depthTest=false;}}return true;};var j=[sap.ui.vk.BillboardStyle.RectangularShape,sap.ui.vk.BillboardStyle.CircularShape,sap.ui.vk.BillboardStyle.None,sap.ui.vk.BillboardStyle.TextGlow];var k=[sap.ui.vk.BillboardCoordinateSpace.Viewport,sap.ui.vk.BillboardCoordinateSpace.Screen,sap.ui.vk.BillboardCoordinateSpace.World];var n=[sap.ui.vk.BillboardBorderLineStyle.None,sap.ui.vk.BillboardBorderLineStyle.Solid,sap.ui.vk.BillboardBorderLineStyle.Dash,sap.ui.vk.BillboardBorderLineStyle.Dot,sap.ui.vk.BillboardBorderLineStyle.DashDot,sap.ui.vk.BillboardBorderLineStyle.DashDotDot];var o=[sap.ui.vk.LeaderLineMarkStyle.None,sap.ui.vk.LeaderLineMarkStyle.Point,sap.ui.vk.LeaderLineMarkStyle.Arrow];function p(c){var e=(((c[0]*255)<<16)|((c[1]*255)<<8)|(c[2]*255)).toString(16);return'#'+'000000'.substring(e.length)+e;}S.prototype.createAnnotation=function(s,c,e){this._resetCurrentScene(s);var i=this._nodes.get(c);var l=e.position;var m={coordinateSpace:k[e.coordinateSpace],text:e.text,style:j[e.shape||0],width:e.width,height:e.height,backgroundColor:e.backgroundColour?p(e.backgroundColour):'#fff',backgroundOpacity:e.backgroundColour?e.backgroundColour[3]:0,borderColor:e.borderColour?p(e.borderColour):'#000',borderOpacity:e.borderColour?e.borderColour[3]:0,borderWidth:e.borderWidth,borderLineStyle:n[e.borderLineStyle]};if(e.fontFace){m.encoding=sap.ui.vk.BillboardTextEncoding.PlainText;m.font=e.fontFace;m.fontSize=Math.abs(e.fontSize);m.fontWeight=Math.min(e.fontWeight,900);m.textColor=p(e.textColour);}else{m.encoding=sap.ui.vk.BillboardTextEncoding.HtmlText;}if(e.coordinateSpace<2){m.position=new THREE.Vector3(l[0]*2-1,l[1]*-2+1,l[2]);m.renderOrder=2;var r=new sap.ui.vk.threejs.Billboard(m);i.add(r._node);if(!this._rootNode.userData._vkBillboards){this._rootNode.userData._vkBillboards=[];}this._rootNode.userData._vkBillboards.push(r);}else{m.anchorNode=this._nodes.get(e.sid);m.position=new THREE.Vector3().fromArray(l);m.depthTest=false;m.renderOrder=1;var v=new sap.ui.vk.threejs.Callout(m);this._callouts.set(e.id,v);i.add(v._node);if(!this._rootNode.userData._vkCallouts){this._rootNode.userData._vkCallouts=[];}this._rootNode.userData._vkCallouts.push(v);}};S.prototype.insertLeaderLine=function(s,c,e){var m=this._callouts.get(c);if(m){var v=[];for(var i=0,l=e.points.length;i<l;i++){v.push(new THREE.Vector3().fromArray(e.points[i]));}var r=this._nodes.get(e.startPointSid);m.addLeaderLine(v,r,e.material,o[e.startPointHeadStyle],o[e.endPointHeadStyle],e.pointHeadConstant,e.extensionLength);}};S.prototype._decrementResourceCounters=function(c){c.traverse(function(e){if(e.isMesh){U.decreaseMaterialUsed(e.material);U.decreaseGeometryUsed(e.geometry);}});};S.prototype.decrementResourceCountersForDeletedTreeNode=function(c,s){this._resetCurrentScene(s);var e=this;c=[].concat(c);c.forEach(function(i){var l=e._nodes.get(i);if(l){e._decrementResourceCounters(l);e._nodes.delete(i);}});return this;};S.prototype.remove=function(c,s){this._resetCurrentScene(s);var e=this;c=[].concat(c);c.forEach(function(l){var m=e._nodes.get(l);if(m){e._decrementResourceCounters(m);if(m.parent){m.parent.remove(m);}e._nodes.delete(l);for(var i=0;i<m.children.length;i++){var r=m.children[i];if(r.userData&&r.userData.treeNode&&r.userData.treeNode.sid){e.remove(r.userData.treeNode.sid,s);}}}});return this;};S.prototype.resourcesCleanUp=function(){var c=this._geometries;c.forEach(function(e){var i=e.userData.geometryUsed;if(i<=0){e.dispose();}});var m=this._materials;if(m){m.forEach(function(e){var i=e.userData.materialUsed;if(i<=0){e.dispose();}});}return this;};S.prototype.createCamera=function(c,s){this._resetCurrentScene(s);var e=null;var i=c.id;e=this._cameras.get(i);var l;if(e){l=e.getCameraRef();}if(!e||!l||(!l.isOrthographicCamera&&c.ortho)){if(c.ortho){l=new THREE.OrthographicCamera(-1,1,1,-1,c.near,c.far);}else{l=new THREE.PerspectiveCamera(c.fov*180/Math.PI,1,c.near,c.far);}}if(c.origin){var m=new THREE.Vector3().fromArray(c.origin);l.position.copy(m);}if(c.up){var r=new THREE.Vector3().fromArray(c.up).normalize();l.up.copy(r);}if(c.target){l.lookAt((new THREE.Vector3().fromArray(c.target)).add(l.position));}if(c.ortho){l.zoom=c.zoom||0.02;}this._rootNode.userData.camera=l;if(l.isOrthographicCamera){e=new sap.ui.vk.threejs.OrthographicCamera();}else if(l.isPerspectiveCamera){e=new sap.ui.vk.threejs.PerspectiveCamera();}e.setCameraRef(l);e.setUsingDefaultClipPlanes(true);if(c.zoom===-1){e.setZoomNeedRecalculate(true);}e.cameraInfo=c;if(i){this._cameras.set(i,e);}return e;};S.prototype.insertCamera=function(c,e,s){this._resetCurrentScene(s);var i=this._nodes.get(c);var l=this._cameras.get(e);if(i&&l){i.add(l.parent?l.clone():l);}return this;};S.prototype.getCamera=function(c){return this._cameras.get(c);};S.prototype.updateMaterialForGeometryWithoutNormal=function(m){var c=this._materials.get(m);if(c){c.emissive.copy(c.color);c.side=THREE.DoubleSide;}return this;};S.prototype.createMaterial=function(m){var r=[];var c=this._materials.get(m.id);if(m.lineWidth>0){if(!c||!c.isLineBasicMaterial){c=new THREE.LineBasicMaterial();this._materials.set(m.id,c);}c.color=new THREE.Color(m.lineColour[0],m.lineColour[1],m.lineColour[2]);c.depthTest=false;c.linewidth=m.lineWidth;c.userData.lineStyle={width:m.lineWidth,haloWidth:m.lineHaloWidth||0,endCapStyle:m.lineEndRound?1:0,dashPattern:m.lineDashPattern||[],dashPatternScale:m.lineDashPatternScale};c.userData.mateialInfo=m;c.userData.materialId=m.id;return r;}if(!c){c=this._createTemporaryMaterial(m.id);}if(c.userData&&c.userData.toBeUpdated){delete c.userData.toBeUpdated;}c.userData.materialInfo=m;if(m.diffuseColour){c.color.fromArray(m.diffuseColour);}if(m.specularColour){c.specular.fromArray(m.specularColour);}var e=true;if(m.emissiveColour){c.emissive.fromArray(m.emissiveColour);if(c.emissive.r!==0||c.emissive.g!==0||c.emissive.b!==0){e=false;}}if(e&&m.ambientColour){c.emissive.fromArray(m.ambientColour);c.emissive.multiplyScalar(0.2);}if(c.opacity!==undefined){c.opacity=m.opacity;c.transparent=m.opacity<1;if(c.transparent){c.side=THREE.DoubleSide;}}var i=c.glossiness?c.glossiness:0;var s=c.specularLevel?c.specularLevel:0;c.shininess=i*2+s*3;c.userData.defaultHighlightingEmissive=D;c.userData.defaultHighlightingSpecular=d;r=this.updateTextureMaps(m.id);return r;};S.prototype.getMaterial=function(m){return this._materials.get(m);};var A=function(c){var i='';try{var l=0x8000;var m=0;var r=c.length;var s;while(m<r){s=c.slice(m,Math.min(m+l,r));i+=String.fromCharCode.apply(null,s);m+=l;}}catch(e){i='';}return i;};S.prototype.createImage=function(i){var c=new DataView(i.binaryData.buffer);var e=true;if(c.getUint8(0,true)===parseInt('0xFF',16)&&c.getUint8(1,true)===parseInt('0xD8',16)){e=false;}var l=A(i.binaryData);var m='data:image/'+(e?'png':'jpeg')+';base64,'+btoa(l);this._images.set(i.id,m);return this;};var C=new THREE.TextureLoader();S.TextureType={Diffuse:0,Bump:1,Opacity:2,Reflection:3,Refraction:4,Specular:5,Ambient:6,Emissive:7,SpecularLevel:8,Glosiness:9,AmbientOcclusion:10,Decal:11};S.prototype.updateTextureMaps=function(m){var r=[];var c=this._materials.get(m);if(!c){return r;}var e=c.userData.materialInfo;if(!e){return r;}if(e.textureDiffuse){var i=this.updateTextureMap(e.id,S.TextureType.Diffuse);if(i.imageId){r.push(i);}}if(e.textureBump){var l=this.updateTextureMap(e.id,S.TextureType.Bump);if(l.imageId){r.push(l);}}if(e.textureOpacity){var s=this.updateTextureMap(e.id,S.TextureType.Opacity);if(s.imageId){r.push(s);}}if(e.textureEmissive){var v=this.updateTextureMap(e.id,S.TextureType.Emissive);if(v.imageId){r.push(v);}}if(e.textureAmbientOcclusion){var w=this.updateTextureMap(e.id,S.TextureType.AmbientOcclusion);if(w.imageId){r.push(w);}}if(e.textureReflection){var x=this.updateTextureMap(e.id,S.TextureType.Reflection);if(x.imageId){r.push(x);}}return r;};S.prototype.updateTextureMap=function(m,c){var r={textureType:c,imageId:null};var e=this._materials.get(m);if(!e){return r;}var i=e.userData.materialInfo;if(!i){return r;}var l=null;switch(c){case S.TextureType.Diffuse:l=i.textureDiffuse;break;case S.TextureType.Bump:l=i.textureBump;break;case S.TextureType.Opacity:l=i.textureOpacity;break;case S.TextureType.Reflection:l=i.textureReflection;break;case S.TextureType.Emissive:l=i.textureEmissive;break;case S.TextureType.AmbientOcclusion:l=i.textureAmbientOcclusion;break;default:break;}if(!l){return r;}var s=l[0];var v=this._images.get(s.imageId);if(!v){r.imageId=s.imageId;return r;}var w=C.load(v);w.wrapS=s.uvHorizontalTilingEnabled?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;w.wrapT=s.uvVerticalTilingEnabled?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;w.magFilter=s.filterMode===1?THREE.NearestFilter:THREE.LinearFilter;w.minFilter=s.filterMode===1?THREE.NearestFilter:THREE.LinearMipMapLinearFilter;w.anisotropy=4;var x=s.influence!==undefined?s.influence:0;var y=s.uvHorizontalScale!==undefined?s.uvHorizontalScale:1;var z=s.uvVerticalScale!==undefined?s.uvVerticalScale:1;var E=s.uvHorizontalOffset!==undefined?s.uvHorizontalOffset:0;var F=s.uvVerticalOffset!==undefined?s.uvVerticalOffset:0;w.repeat.set(y,z);w.center.set(-E,-F);w.offset.set(E,F);w.rotation=-s.uvRotationAngle;switch(c){case S.TextureType.Diffuse:e.map=w;e.transparent|=v.startsWith('data:image/png');break;case S.TextureType.Bump:e.bumpMap=w;e.bumpScale=x;break;case S.TextureType.Opacity:e.alphaMap=w;break;case S.TextureType.Reflection:w.mapping=THREE.SphericalReflectionMapping;e.envMap=w;e.combine=THREE.AddOperation;e.reflectivity=x;break;case S.TextureType.Emissive:e.emissiveMap=w;break;case S.TextureType.AmbientOcclusion:e.aoMap=w;break;default:}e.userData.textureAdded=true;e.needsUpdate=true;return r;};S.prototype.insertPlayback=function(c,v,s){this._resetCurrentScene(s);var e={id:c.id,sequenceId:c.sequenceId,playbackSpeed:c.speed?c.speed:0,playbackPreDelay:c.preDelay?c.preDelay:0,playbackPostDelay:c.postDelay?c.postDelay:0,playbackRepeat:c.repeat?Math.abs(c.repeat):0,playbackReversed:c.reversed?true:false};var i=this._views.get(v);if(i){var l=i.getPlaybacks();if(!l){l=[];}l.push(e);i.setPlaybacks(l);}return this;};S.prototype.insertSequence=function(i){var s=this._sequences.get(i.id);if(!s){var c=[];var e=new THREE.AnimationClip(i.name,-1,c);if(!e.userData){e.userData={};}e.userData.startTime=i.startTime?i.startTime:0;e.userData.endTime=i.endTime?i.endTime:1;e.userData.frameRate=i.frameRate?i.frameRate:30;e.userData.active=i.active?i.active:true;e.userData.cyclic=i.cyclic?i.cyclic:false;e.userData.currentTime=i.currentTime?i.currentTime:0;e.userData.name=i.name?i.name:'';e.userData.nodesEndData=new Map();e.userData.nodesStartData=new Map();this._sequences.set(i.id,e);for(var l=0;l<i.nodes.length;l++){var m=i.nodes[l];var r=this._trackIdSequenceNodeMap.getOrCreate(m.trackId);r.push({sequenceId:i.id,targetId:m.sid,type:m.binding,pivot:m.pivot});}}return this;};S.prototype.insertTrack=function(i){if(!this._nodes){return this;}var e=this._trackIdSequenceNodeMap.get(i.id);var l=function(x,y,z,_){var c=Math.cos(_);var s=Math.sin(_);var r=Math.sqrt(x*x+y*y+z*z);x=x/r;y=y/r;z=z/r;var a1=c+x*x*(1-c);var c1=x*y*(1-c)-z*s;var d1=x*z*(1-c)+y*s;var e1=0;var f1=y*x*(1-c)+z*s;var g1=c+y*y*(1-c);var h1=y*z*(1-c)-x*s;var i1=0;var j1=z*x*(1-c)-y*s;var k1=z*y*(1-c)+x*s;var l1=c+z*z*(1-c);var m1=0;var m=new THREE.Matrix4();m.set(a1,c1,d1,e1,f1,g1,h1,i1,j1,k1,l1,m1,0,0,0,1);return m;};var v=function(_,r){var c=Math.cos(_);var s=Math.sin(_);var a1=1;var c1=0;var d1=0;var e1=0;var f1=0;var g1=1;var h1=0;var i1=0;var j1=0;var k1=0;var l1=1;var m1=0;if(r==='X'){g1=c;h1=-s;k1=s;l1=c;}else if(r==='Y'){a1=c;d1=s;j1=-s;l1=c;}else{a1=c;c1=-s;f1=s;g1=c;}var m=new THREE.Matrix4();m.set(a1,c1,d1,e1,f1,g1,h1,i1,j1,k1,l1,m1,0,0,0,1);return m;};if(e){for(var E=0;E<e.length;E++){var F=this._sequences.get(e[E].sequenceId);if(!F){continue;}var G=this._nodes.get(e[E].targetId);if(!G){continue;}var H=F.userData.nodesEndData.get(G);if(!H){H={};F.userData.nodesEndData.set(G,H);}var I=G.uuid;var J;var K=[];var M=[];var N,Q;var R;var T;var m,W;var X;if(e[E].type==='TRANSLATE'){I+='.position';J=G.position.clone();for(N=0;N<i.keys.length;N++){T=i.keys[N];K.push(T.time);if(T.values.length===3){for(Q=0;Q<3;Q++){M.push(T.values[Q]);}}}if(K.length*3!==M.length){continue;}var Y=new THREE.Vector3(M[M.length-3],M[M.length-2],M[M.length-1]);H.position=Y;R=new THREE.VectorKeyframeTrack(I,K,M);}else if(e[E].type==='SCALE'){I+='.scale';J=G.scale.clone();for(N=0;N<i.keys.length;N++){T=i.keys[N];K.push(T.time);if(T.values.length===1){M.push(T.values[0]);M.push(T.values[0]);M.push(T.values[0]);}else if(T.values.length===3){for(Q=0;Q<3;Q++){M.push(T.values[Q]);}}}if(K.length*3!==M.length){continue;}var Z=new THREE.Vector3(M[M.length-3],M[M.length-2],M[M.length-1]);H.scale=Z;R=new THREE.VectorKeyframeTrack(I,K,M);}else if(e[E].type==='ROTATE'){I+='.quaternion';J=G.quaternion.clone();if(i.type==='euler'){for(N=0;N<i.keys.length;N++){T=i.keys[N];K.push(T.time);var $=T.values[3];$=Math.round($);var _;m=new THREE.Matrix4();for(var oi=0;oi<3;oi++){if(oi===0){_=T.values[0];}else if(oi===1){_=T.values[1];}else{_=T.values[2];}if(($>>(oi*2)&3)===0){W=v(_,'X');m.multiply(W);}else if(($>>(oi*2)&3)===1){W=v(_,'Y');m.multiply(W);}else if(($>>(oi*2)&3)===2){W=v(_,'Z');m.multiply(W);}}X=new THREE.Quaternion();X.setFromRotationMatrix(m);M.push(X.x);M.push(X.y);M.push(X.z);M.push(X.w);}}else if(i.type==='angleAxis'){m=new THREE.Matrix4();for(N=0;N<i.keys.length;N++){T=i.keys[N];K.push(T.time);var x=T.values[0];var y=T.values[1];var z=T.values[2];var w=T.values[3];W=l(x,y,z,w);m.premultiply(W);X=new THREE.Quaternion();X.setFromRotationMatrix(m);M.push(X.x);M.push(X.y);M.push(X.z);M.push(X.w);}}else{for(N=0;N<i.keys.length;N++){T=i.keys[N];K.push(T.time);if(T.values.length===4){for(Q=0;Q<4;Q++){M.push(T.values[Q]);}}}}if(K.length*4!==M.length){continue;}var b1=new THREE.Quaternion(M[M.length-4],M[M.length-3],M[M.length-2],M[M.length-1]);H.quaternion=b1;R=new THREE.QuaternionKeyframeTrack(I,K,M);}else if(e[E].type==='OPACITY'){if(!G.material&&G.children&&G.children.length===1){G=G.children[0];I=G.uuid;}if(G.material&&G.material.opacity){I+='.material.opacity';J=G.material.opacity;}else{continue;}for(N=0;N<i.keys.length;N++){T=i.keys[N];K.push(T.time);M.push(T.values[0]);}H.opacity=M[M.length-1];R=new THREE.NumberKeyframeTrack(I,K,M);}else{continue;}R.userData={};R.userData.originalValue=J;R.userData.info=i;R.userData.type=e[E].type;R.userData.targetNode=G;if(i.interpolationType===1){R.setInterpolation(THREE.InterpolateSmooth);}else{R.setInterpolation(THREE.InterpolateLinear);}F.tracks.push(R);}this._trackIdSequenceNodeMap.delete(i.id);}return this;};S.prototype.finalizeAnimation=function(){var c=this._rootNode;if(c){while(c.parent){c=c.parent;}if(!c.userData){c.userData={};}c.userData.sequences=this._sequences;c.userData.tracks=this._tracks;}return this;};S.prototype.finalizePlaybacks=function(){var c=this._rootNode;if(c){while(c.parent){c=c.parent;}if(!c.userData){c.userData={};}}else{return this;}if(!c.userData.animationNodeOriginalData){c.userData.animationNodeOriginalData=new Map();}var v=this._viewGroups.values();var e=v.next();while(!e.done){var i=e.value;if(!i||!i.views||!i.views.length){e=v.next();continue;}var l=new Map();var m;var r,s,w;for(m=0;m<i.views.length-1;m++){var x=i.views[m].id;var y=i.views[m+1].id;var z=this._views.get(x);var E=this._views.get(y);var F;if(z){var G=z.getPlaybacks();if(G&&G.length){F=G[G.length-1];}}if(F){r=this._sequences.get(F.sequenceId);s=r.userData.nodesEndData.entries();w=s.next();while(!w.done){l.set(w.value[0],w.value[1]);w=s.next();}}var H;if(E){var I=E.getPlaybacks();if(I&&I.length){H=I[I.length-1];}}if(H){r=this._sequences.get(H.sequenceId);s=l.entries();w=s.next();while(!w.done){r.userData.nodesStartData.set(w.value[0],w.value[1]);w=s.next();}}}var J,K,M;for(m=0;m<i.views.length;m++){var N=i.views[m].id;var Q=this._views.get(N);var R;if(Q){var T=Q.getPlaybacks();if(T&&T.length){R=T[T.length-1];}}if(R){r=this._sequences.get(R.sequenceId);J=l.keys();w=J.next();while(!w.done){K=w.value;M=r.userData.nodesStartData.get(K);if(!M){M={};M.position=K.position.clone();M.scale=K.scale.clone();M.quaternion=K.quaternion.clone();r.userData.nodesStartData.set(K,M);}w=J.next();}}else if(Q){Q.animationNodeOriginalData=new Map();J=l.keys();w=J.next();while(!w.done){K=w.value;M={};M.position=K.position.clone();M.scale=K.scale.clone();M.quaternion=K.quaternion.clone();Q.animationNodeOriginalData.set(K,M);w=J.next();}}}J=l.keys();w=J.next();while(!w.done){K=w.value;M={};M.position=K.position.clone();M.scale=K.scale.clone();M.quaternion=K.quaternion.clone();c.userData.animationNodeOriginalData.set(K,M);w=J.next();}e=v.next();}return this;};S.prototype.finalizeViewGroups=function(s){this._resetCurrentScene(s);var c=this._rootNode;if(c){while(c.parent){c=c.parent;}if(!c.userData){c.userData={};}}else{return this;}var v=[];var e=this._viewGroups.entries();var i=e.next();while(!i.done){var l=i.value[1];if(!l||!l.views||!l.views.length){i=e.next();continue;}var m=[];for(var r=0;r<l.views.length;r++){var w=l.views[r].id;var x=this._views.get(w);if(x&&x.userData.viewInfo.thumbnailId&&!x.thumbnailData){var y=this._images.get(x.userData.viewInfo.thumbnailId);if(y){x.thumbnailData=y;}}if(x){m.push(x);}}var z={};z.originalId=i.value[0];z.name=l.name;z.modelViews=m;z.sceneId=i.value[1].sceneId;v.push(z);i=e.next();}c.userData.viewportGroups=v;return this;};S.prototype.insertViewGroup=function(i,s){this._resetCurrentScene(s);this._viewGroups.set(i.id,i);return this;};S.prototype.getViewGroup=function(v,s){this._resetCurrentScene(s);var c=this._viewGroups.get(v);var e=[];if(c&&c.views){for(var i=0;i<c.views.length;i++){var l=c.views[i].id;var m=this._views.get(l);if(m){e.push(m);}}}return e;};S.prototype.insertView=function(v,s){this._resetCurrentScene(s);var c=new sap.ui.vk.View({name:v.name});c.userData={};c.userData.viewInfo=v;if(v.thumbnailId){var i=this._images.get(c.thumbnailId);if(i){c.thumbnailData=i;}}this._views.set(v.id,c);return this;};S.prototype.getView=function(v,s){this._resetCurrentScene(s);return this._views.get(v);};S.prototype.getSequence=function(s){return this._sequences.get(s);};S.prototype.setViewCamera=function(c,v,s){this._resetCurrentScene(s);var e=this._cameras.get(c);var i=this._views.get(v);if(e&&i){i.camera=e;var l=e.getCameraRef();if(e.cameraInfo&&l){var m=true;var r=false;if(e.cameraInfo.zoom===-1){r=true;}if(l.type==='PerspectiveCamera'){i.setCameraInfo({type:l.type,fov:e.cameraInfo.fov*180/Math.PI,position:l.position.toArray(),nearClipPlane:l.near,farClipPlane:l.far,upDirection:l.up.toArray(),targetDirection:l.getWorldDirection().toArray(),usingDefaultClipPlanes:m});}if(l.type==='OrthographicCamera'){i.setCameraInfo({type:l.type,zoomFactor:l.zoom,position:l.position.toArray(),nearClipPlane:l.near,farClipPlane:l.far,upDirection:l.up.toArray(),targetDirection:l.getWorldDirection().toArray(),usingDefaultClipPlanes:m,zoomNeedRecalculate:r});}}}return this;};S.prototype.setViewNodeInfos=function(c,v,s){this._resetCurrentScene(s);var e=this._views.get(v);e.setNodeInfos(c);return this;};S.prototype.setViewThumbnail=function(i,v,s){this._resetCurrentScene(s);var c=this._views.get(v);var e=this._images.get(i);if(c&&e){c.thumbnailData=e;}return this;};S.prototype.cleanup=function(){this._rootNode=null;if(this._nodes){this._nodes.clear();}if(this._NodeMeshIdSubmeshIdsMap){this._NodeMeshIdSubmeshIdsMap.clear();}this._submeshes.clear();this._callouts.clear();this._cameras.clear();this._materials.clear();this._images.clear();this._geometries.clear();this._currentSceneId=null;this._sceneIdTreeNodesMap.clear();this._sceneIdRootNodeMap.clear();this._sceneIdNodMeshIdMap.clear();this._sequences.clear();this._tracks.clear();this._trackIdSequenceNodeMap.clear();this._viewGroups.clear();this._views.clear();this._sceneIdTreeNodesMap.clear();this._sceneIdRootNodeMap.clear();this._sceneIdNodMeshIdMap.clear();this._sceneIdViewGroupMap.clear();this._sceneIdViewMap.clear();S._map.delete(this._id);};return S;});\n",
	"sap/ui/vk/threejs/Texture.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../Texture','./thirdparty/three'],function(q,T,t){'use strict';var a=T.extend('sap.ui.vk.threejs.Texture',{metadata:{},constructor:function(i){if(i){var c=new THREE.TextureLoader();this._nativeTexture=c.load(i);if(!this._nativeTexture.userData){this._nativeTexture.userData={};}}}});var b=a.getMetadata().getParent().getClass().prototype;a.prototype.init=function(){if(b.init){b.init.call(this);}};a.prototype.load=function(i){var c=new THREE.TextureLoader();this._nativeTexture=c.load(i);if(!this._nativeTexture.userData){this._nativeTexture.userData={};}return this;};a.prototype.getTextureRef=function(){return this._nativeTexture;};a.prototype.setTextureRef=function(c){this._nativeTexture=c;if(!this._nativeTexture.userData){this._nativeTexture.userData={};}return this;};a.prototype.getId=function(){if(this._nativeTexture&&this._nativeTexture.userData&&this._nativeTexture.userData.id){return this._nativeTexture.userData.id;}};a.prototype.setId=function(v){if(this._nativeTexture){if(!this._nativeTexture.userData){this._nativeTexture.userData={};}this._nativeTexture.userData.id=v;}return this;};a.prototype.getFilterMode=function(){if(this._nativeTexture){return this._nativeTexture.magFilter===THREE.NearestFilter?1:0;}};a.prototype.setFilterMode=function(v){if(this._nativeTexture){this._nativeTexture.magFilter=v===1?THREE.NearestFilter:THREE.LinearFilter;}};a.prototype.getUvRotationAngle=function(){if(this._nativeTexture){return this._nativeTexture.rotation;}};a.prototype.setUvRotationAngle=function(v){if(this._nativeTexture){this._nativeTexture.rotation=v;}};a.prototype.getUvHorizontalOffset=function(){if(this._nativeTexture){return this._nativeTexture.offset.x;}};a.prototype.setUvHorizontalOffset=function(v){if(this._nativeTexture){this._nativeTexture.offset.x=v;}};a.prototype.getUvVerticalOffset=function(){if(this._nativeTexture){return this._nativeTexture.offset.y;}};a.prototype.setUvVerticalOffset=function(v){if(this._nativeTexture){this._nativeTexture.offset.y=v;}};a.prototype.getUvHorizontalScale=function(){if(this._nativeTexture){return this._nativeTexture.repeat.x;}};a.prototype.setUvHorizontalScale=function(v){if(this._nativeTexture){this._nativeTexture.repeat.x=v;}};a.prototype.getUvVerticalScale=function(){if(this._nativeTexture){return this._nativeTexture.repeat.y;}};a.prototype.setUvVerticalScale=function(v){if(this._nativeTexture){this._nativeTexture.repeat.y=v;}};a.prototype.getUvHorizontalTilingEnabled=function(){if(this._nativeTexture){return this._nativeTexture.wrapS===THREE.RepeatWrapping;}};a.prototype.setUvHorizontalTilingEnabled=function(v){if(this._nativeTexture){this._nativeTexture.wrapS=v?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;}};a.prototype.getUvVerticalTilingEnabled=function(){if(this._nativeTexture){return this._nativeTexture.wrapT===THREE.RepeatWrapping;}};a.prototype.setUvVerticalTilingEnabled=function(v){if(this._nativeTexture){this._nativeTexture.wrapT=v?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;}};return a;});\n",
	"sap/ui/vk/threejs/UsageCounter.js":"sap.ui.define(['jquery.sap.global','./thirdparty/three'],function(q,t){'use strict';var U=function(){};U.increaseMaterialUsed=function(m){if(m&&m.userData&&m.userData.materialUsed!==undefined){m.userData.materialUsed++;return true;}return false;};U.decreaseMaterialUsed=function(m){if(m&&m.userData&&m.userData.materialUsed!==undefined){m.userData.materialUsed--;return true;}return false;};U.increaseGeometryUsed=function(g){if(g&&g.userData&&g.userData.geometryUsed!==undefined){g.userData.geometryUsed++;return true;}return false;};U.decreaseGeometryUsed=function(g){if(g&&g.userData&&g.userData.geometryUsed!==undefined){g.userData.geometryUsed--;return true;}return false;};return U;});\n",
	"sap/ui/vk/threejs/ViewStateManager.js":"/*!\n* SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n*/\nsap.ui.define(['jquery.sap.global','sap/ui/core/Element','../ContentConnector','../ViewStateManagerBase','./thirdparty/three'],function(q,E,C,V,t){'use strict';var a;var b=V.extend('sap.ui.vk.threejs.ViewStateManager',{metadata:{}});var d=b.getMetadata().getParent().getClass().prototype;b.prototype.init=function(){if(d.init){d.init.call(this);}this._nodeHierarchy=null;this._nodeStates=new Map();this._selectedNodes=new Set();this._visibilityTracker=new a();this._showSelectionBoundingBox=true;this._boundingBoxesScene=new THREE.Scene();this.setHighlightColor('rgba(255, 0, 0, 1.0)');};b.prototype._setContent=function(c){var s=null;if(c&&c instanceof sap.ui.vk.threejs.Scene){s=c;}this._setScene(s);};b.prototype._onAfterUpdateContentConnector=function(){this._setContent(this._contentConnector.getContent());};b.prototype._onBeforeClearContentConnector=function(){this._setScene(null);};b.prototype._handleContentReplaced=function(e){var c=e.getParameter('newContent');this._setContent(c);};b.prototype._setScene=function(s){this._boundingBoxesScene=new THREE.Scene();this._setNodeHierarchy(s?s.getDefaultNodeHierarchy():null);if(s){s.setViewStateManager(this);}return this;};b.prototype._setNodeHierarchy=function(n){var o=this._nodeHierarchy;if(this._nodeHierarchy){this._nodeHierarchy=null;this._nodeStates.clear();this._selectedNodes.clear();this._visibilityTracker.clear();}if(n){this._nodeHierarchy=n;this._nodeHierarchy.attachNodeReplaced(this._handleNodeReplaced,this);this._nodeHierarchy.attachNodeUpdated(this._handleNodeUpdated,this);this._initialState={visible:[],hidden:[]};var c=this;var e=n.findNodesByName();e.forEach(function(f){(f.visible?c._initialState.visible:c._initialState.hidden).push(f);});this.fireVisibilityChanged({visible:this._initialState.visible,hidden:this._initialState.hidden});}if(n!==o){this.fireNodeHierarchyReplaced({oldNodeHierarchy:o,newNodeHierarchy:n});}return this;};b.prototype._handleNodeReplaced=function(e){var r=e.getParameter('ReplacedNodeRef');var c=e.getParameter('ReplacementNodeRef');if(this.getSelectionState(r)){this.setSelectionState(c,true);this.setSelectionState(r,false);}};b.prototype._handleNodeUpdated=function(e){var n=e.getParameter('nodeRef');if(this.getSelectionState(n)){this.setSelectionState(n,false);this.setSelectionState(n,true);}};b.prototype.getNodeHierarchy=function(){return this._nodeHierarchy;};b.prototype.getVisibilityChanges=function(){return this.getShouldTrackVisibilityChanges()?this._visibilityTracker.getInfo(this.getNodeHierarchy()):null;};b.prototype.getVisibilityComplete=function(){var n=this.getNodeHierarchy(),c=n.findNodesByName(),v=[],h=[];c.forEach(function(e){var f=n.createNodeProxy(e);var g=f.getVeId();n.destroyNodeProxy(f);if(g){if(this.getVisibilityState(e)){v.push(g);}else{h.push(g);}}},this);return{visible:v,hidden:h};};b.prototype.resetVisibility=function(){this.setVisibilityState(this._initialState.visible,true,false);this.setVisibilityState(this._initialState.hidden,false,false);this._visibilityTracker.clear();};b.prototype.getVisibilityState=function(n){return Array.isArray(n)?n.map(function(c){return c.visible;}):n.visible;};b.prototype.setVisibilityState=function(n,v,r){if(!Array.isArray(n)){n=[n];}n=(r?this._collectNodesRecursively(n):n).filter(function(e,i,s){return s.indexOf(e)===i;});var c=n.filter(function(e){return e.visible!=v;},this);if(c.length>0){c.forEach(function(e){e.visible=v;if(v){var f=this._nodeHierarchy.getAncestors(e);this.setVisibilityState(f,true,false);}},this);if(this.getShouldTrackVisibilityChanges()){c.forEach(this._visibilityTracker.trackNodeRef,this._visibilityTracker);}this.fireVisibilityChanged({visible:v?c:[],hidden:v?[]:c});}return this;};b.prototype.enumerateSelection=function(c){this._selectedNodes.forEach(c);return this;};b.prototype.getSelectionState=function(n){var s=this._selectedNodes;function i(c){return s.has(c);}return Array.isArray(n)?n.map(i):i(n);};b.prototype._isAChild=function(c,n){var e=c.parent;while(e){if(n.has(e)){return true;}e=e.parent;}return false;};THREE.Box3.prototype._setFromObjectExcludingHotSpotAndPMI=function(o){this.makeEmpty();var v=new THREE.Vector3();var c=this;o.updateMatrixWorld(true);o.traverse(function(n){var u=n.userData;if(u){if(u.treeNode){if(u.treeNode.contentType==='HOTSPOT'){u.isHotspot=true;}else if(u.treeNode.contentType==='PMI'){u.isPMI=true;}}if(n.parent){if(n.parent.userData){if(n.parent.userData.isHotspot){u.isHotspot=true;}else if(n.parent.userData.isPMI){u.isPMI=true;}}}if(u.isHotspot||u.isPMI){return;}}var i,l;var g=n.geometry;if(g!==undefined){if(g.isGeometry){var e=g.vertices;for(i=0,l=e.length;i<l;i++){v.copy(e[i]);v.applyMatrix4(n.matrixWorld);c.expandByPoint(v);}}else if(g.isBufferGeometry){var f=g.attributes.position;if(f!==undefined){for(i=0,l=f.count;i<l;i++){v.fromBufferAttribute(f,i).applyMatrix4(n.matrixWorld);c.expandByPoint(v);}}}}});return this;};THREE.Object3D.prototype._vkCalculateObjectOrientedBoundingBox=function(){var p=this.parent,m=this.matrix.clone(),c=this.matrixAutoUpdate;this.parent=null;this.matrix.identity();this.matrixAutoUpdate=false;this.userData.boundingBox._setFromObjectExcludingHotSpotAndPMI(this);this.matrixAutoUpdate=c;this.matrix.copy(m);this.parent=p;this.updateMatrixWorld(true);};b.prototype._AddBoundingBox=function(n){if(n.userData.boundingBox===undefined){n.userData.boundingBox=new THREE.Box3();n._vkCalculateObjectOrientedBoundingBox();}if(!n.userData.boundingBox.isEmpty()&&this._boundingBoxesScene&&n.userData.boxHelper===undefined){var c=new THREE.Box3Helper(n.userData.boundingBox,0xffff00);this._boundingBoxesScene.add(c);c.parent=n;n.userData.boxHelper=c;}};b.prototype._RemoveBoundingBox=function(n){if(n.userData.boundingBox!==undefined){delete n.userData.boundingBox;}if(n.userData.boxHelper!==undefined){this._boundingBoxesScene.remove(n.userData.boxHelper);delete n.userData.boxHelper;}};b.prototype._updateBoundingBoxesIfNeeded=function(){var u=new Set();this._selectedNodes.forEach(function(n){var p=n.parent;while(p){if(this._selectedNodes.has(p)){u.add(p);}p=p.parent;}}.bind(this));u.forEach(function(n){n._vkCalculateObjectOrientedBoundingBox();});};b.prototype.setShowSelectionBoundingBox=function(v){this._showSelectionBoundingBox=v;if(this._showSelectionBoundingBox){this._selectedNodes.forEach(function(n){this._AddBoundingBox(n);}.bind(this));}else{this._selectedNodes.forEach(function(n){this._RemoveBoundingBox(n);}.bind(this));}this.fireSelectionChanged({selected:this._selectedNodes,unselected:[]});};b.prototype.getShowSelectionBoundingBox=function(){return this._showSelectionBoundingBox;};THREE.Object3D.prototype.defaultEmissive={r:0.0235,g:0.0235,b:0.0235};THREE.Object3D.prototype.defaultSpecular={r:0.0602,g:0.0602,b:0.0602};THREE.Object3D.prototype._vkTraverseNodeGeometry=function(c){c(this);for(var i=0,l=this.children.length;i<l;i++){var e=this.children[i];if(e.geometry!==undefined&&!e.name&&e.children.length===0){c(e);}}};THREE.Object3D.prototype._vkSetTintColor=function(c){this._vkTraverseNodeGeometry(function(n){n.userData.tintColor=c;n._vkUpdateMaterialColor();});};THREE.Object3D.prototype._vkSetOpacity=function(o){this._vkTraverseNodeGeometry(function(n){n.userData.opacity=o;n._vkUpdateMaterialOpacity();});};THREE.Object3D.prototype._vkUpdateMaterialColor=function(){if(!this.material||!this.material.color){return;}var u=this.userData;if(u.originalMaterial){if(u.originalMaterial.color.r===undefined){u.originalMaterial=null;}else if(u.originalMaterial.userData&&u.originalMaterial.userData.textureAdded){this.material=u.originalMaterial.clone();if(u.opacity){this.material.opacity*=u.opacity;this.material.transparent=this.material.transparent||this.material.opacity<0.99;}delete u.originalMaterial.userData.textureAdded;}else{this.material.color.copy(u.originalMaterial.color);if(this.material.emissive!==undefined){this.material.emissive.copy(u.originalMaterial.emissive);}if(this.material.specular!==undefined){this.material.specular.copy(u.originalMaterial.specular);}}}if(u.highlightColor!==undefined||u.tintColor!==undefined){if(!u.originalMaterial){u.originalMaterial=this.material;this.material=this.material.clone();}var c;if(u.tintColor!==undefined){c=sap.ui.vk.abgrToColor(u.tintColor);this.material.color.lerp(new THREE.Color(c.red/255.0,c.green/255.0,c.blue/255.0),c.alpha);if(this.material.emissive!==undefined){if(this.material.userData.defaultHighlightingEmissive){this.material.emissive.copy(this.material.userData.defaultHighlightingEmissive);}else{this.material.emissive.copy(THREE.Object3D.prototype.defaultEmissive);}}if(this.material.specular!==undefined){if(this.material.userData.defaultHighlightingSpecular){this.material.specular.copy(this.material.userData.defaultHighlightingSpecular);}else{this.material.specular.copy(THREE.Object3D.prototype.defaultSpecular);}}}if(u.highlightColor!==undefined){c=sap.ui.vk.abgrToColor(u.highlightColor);this.material.color.lerp(new THREE.Color(c.red/255.0,c.green/255.0,c.blue/255.0),c.alpha);if(this.material.emissive!==undefined){if(this.material.userData.defaultHighlightingEmissive){this.material.emissive.copy(this.material.userData.defaultHighlightingEmissive);}else{this.material.emissive.copy(THREE.Object3D.prototype.defaultEmissive);}}if(this.material.specular!==undefined){if(this.material.userData.defaultHighlightingSpecular){this.material.specular.copy(this.material.userData.defaultHighlightingSpecular);}else{this.material.specular.copy(THREE.Object3D.prototype.defaultSpecular);}}}}};THREE.Object3D.prototype._vkUpdateMaterialOpacity=function(){if(!this.material){return;}var u=this.userData;if(u.originalMaterial){this.material.opacity=u.originalMaterial.opacity;this.material.transparent=u.originalMaterial.transparent;}if(u.opacity!==undefined){if(!u.originalMaterial){u.originalMaterial=this.material;this.material=this.material.clone();}if(this.material.opacity){this.material.opacity*=u.opacity;this.material.transparent=this.material.transparent||this.material.opacity<0.99;}}};b.prototype._isAncestorSelected=function(n){n=n.parent;while(n){if(this._selectedNodes.has(n)){return true;}n=n.parent;}return false;};b.prototype._updateHighlightColor=function(n,p){var s=p||this._selectedNodes.has(n);n.userData.highlightColor=s?this._highlightColorABGR:undefined;n._vkUpdateMaterialColor();var c=n.children;for(var i=0,l=c.length;i<l;i++){var u=c[i].userData;if(u&&u.treeNode&&u.treeNode.contentType==='HOTSPOT'){continue;}this._updateHighlightColor(c[i],s);}};b.prototype.setSelectionState=function(n,s,r,c){if(!Array.isArray(n)){n=[n];}n=(r||this.getRecursiveSelection()?this._collectNodesRecursively(n):n).filter(function(v,i,f){return f.indexOf(v)===i;});if(this.getRecursiveSelection()&&!s){n=this._nodeHierarchy._appendAncestors(n);}var e=n.filter(function(f){return this._selectedNodes.has(f)!==s;},this);if(e.length>0){e.forEach(function(f){this._selectedNodes[s?'add':'delete'](f);if(this._showSelectionBoundingBox){this[s?'_AddBoundingBox':'_RemoveBoundingBox'](f);}},this);e.forEach(function(f){this._updateHighlightColor(f,s||this._isAncestorSelected(f));},this);if(!c){this.fireSelectionChanged({selected:s?e:[],unselected:s?[]:e});}}return this;};b.prototype.setSelectionStates=function(s,u,r,c){if(!Array.isArray(s)){s=[s];}if(!Array.isArray(u)){u=[u];}s=(r||this.getRecursiveSelection()?this._collectNodesRecursively(s):s);u=(r||this.getRecursiveSelection()?this._collectNodesRecursively(u):u);if(this.getRecursiveSelection()){u=this._nodeHierarchy._appendAncestors(u,s);}var e=s.filter(function(n){return this._selectedNodes.has(n)===false;},this);var f=u.filter(function(n){return this._selectedNodes.has(n)===true;},this);if(e.length>0||f.length>0){e.forEach(function(n){this._selectedNodes.add(n);this._updateHighlightColor(n,true);if(this._showSelectionBoundingBox){this._AddBoundingBox(n);}},this);f.forEach(function(n){this._selectedNodes.delete(n);if(this._showSelectionBoundingBox){this._RemoveBoundingBox(n);}},this);f.forEach(function(n){this._updateHighlightColor(n,this._isAncestorSelected(n));},this);if(!c){this.fireSelectionChanged({selected:e,unselected:f});}}return this;};b.prototype._collectNodesRecursively=function(n){var r=[],c=this;n.forEach(function collectChildNodes(e){r.push(e);c._nodeHierarchy.enumerateChildren(e,collectChildNodes,false,true);});return r;};b.prototype._getOpacity=function(n){return n.userData.opacity!==undefined?n.userData.opacity:null;};b.prototype.getOpacity=function(n){if(Array.isArray(n)){return n.map(this._getOpacity,this);}else{return this._getOpacity(n);}};b.prototype.setOpacity=function(n,o,r){if(!Array.isArray(n)){n=[n];}n=(r?this._collectNodesRecursively(n):n).filter(function(v,i,s){return s.indexOf(v)===i;});if(o===null){o=undefined;}var c=n.filter(function(e){return e.userData.opacity!==o;},this);if(c.length>0){c.forEach(function(e){e._vkSetOpacity(o);},this);this.fireOpacityChanged({changed:c,opacity:o});}return this;};b.prototype._getTintColorABGR=function(n){return n.userData.tintColor!==undefined?n.userData.tintColor:null;};b.prototype._getTintColor=function(n){return n.userData.tintColor!==undefined?sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(n.userData.tintColor)):null;};b.prototype.getTintColor=function(n,i){var g=i?'_getTintColorABGR':'_getTintColor';if(Array.isArray(n)){return n.map(this[g],this);}else{return this[g](n);}};b.prototype.setTintColor=function(n,c,r){if(!Array.isArray(n)){n=[n];}var e=null;switch(typeof c){case'number':e=c;break;case'string':if(sap.ui.core.CSSColor.isValid(c)){e=sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(c));}break;default:c=null;break;}n=(r?this._collectNodesRecursively(n):n).filter(function(v,i,s){return s.indexOf(v)===i;});var f=n.filter(function(g){return g.userData.tintColor!==e;},this);if(f.length>0){f.forEach(function(g){g._vkSetTintColor(e);},this);this.fireTintColorChanged({changed:f,tintColor:c,tintColorABGR:e});}return this;};b.prototype.setHighlightColor=function(c){switch(typeof c){case'number':this._highlightColorABGR=c;break;case'string':if(sap.ui.core.CSSColor.isValid(c)){this._highlightColorABGR=sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(c));}break;default:return this;}if(this._selectedNodes.size>0){this._selectedNodes.forEach(function(n){this._updateHighlightColor(n,true);},this);}this.fireHighlightColorChanged({highlightColor:sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(this._highlightColorABGR)),highlightColorABGR:this._highlightColorABGR});return this;};b.prototype.getHighlightColor=function(i){return i?this._highlightColorABGR:sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(this._highlightColorABGR));};a=function(){this._visibilityChanges=new Set();};a.prototype.getInfo=function(n){var c=[];this._visibilityChanges.forEach(function(e){var f=n.createNodeProxy(e);var v=f.getVeId();n.destroyNodeProxy(f);if(v){c.push(v);}else{c.push(n.getScene().nodeRefToPersistentId(e));}});return c;};a.prototype.clear=function(){this._visibilityChanges.clear();};a.prototype.trackNodeRef=function(n){if(this._visibilityChanges.has(n)){this._visibilityChanges.delete(n);}else{this._visibilityChanges.add(n);}};C.injectMethodsIntoClass(b);return b;});\n",
	"sap/ui/vk/threejs/Viewport.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','../library','../ViewportBase','sap/ui/core/ResizeHandler','../Loco','./thirdparty/three','../ContentConnector','../ViewStateManager','./ViewportGestureHandler','./OrthographicCamera','./PerspectiveCamera','./NodesTransitionHelper','../Messages','sap/ui/base/ManagedObjectObserver','./ViewportRenderer'],function(q,l,V,R,L,a,C,b,c,O,P,N,M,d,f){'use strict';var g=V.extend('sap.ui.vk.threejs.Viewport',{metadata:{library:'sap.ui.vk',properties:{renderMode:{type:'sap.ui.vk.RenderMode',defaultValue:sap.ui.vk.RenderMode.Default}},events:{cameraChanged:{parameters:{position:'float[]',quaternion:'float[]',zoom:'float'},enableEventBubbling:true},cameraUpdateCompleted:{parameters:{position:'float[]',quaternion:'float[]',zoom:'float'},enableEventBubbling:true}}}});var j=g.getMetadata().getParent().getClass().prototype;g.prototype.init=function(){if(j.init){j.init.call(this);}this._resizeListenerId=null;this._renderLoopRequestId=0;this._renderLoopFunction=this._renderLoop.bind(this);this._shouldRenderFrame=true;this._clippingPlanes=[];this._animationMixer=null;this._currentPlaybacks=null;this._clock=new THREE.Clock(false);this._renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});this._renderer.setPixelRatio(window.devicePixelRatio);this._renderer.setSize(1,1);this._renderer.shadowMap.enabled=true;this._camera=new P();var e=['varying float vPos;','void main() {','\tgl_Position = vec4(position, 1.0);','\tvPos = position.y * -0.5 + 0.5;','}'].join('\\n');var h=['uniform vec4 topColor;','uniform vec4 bottomColor;','varying float vPos;','void main() {','\tgl_FragColor = mix(topColor, bottomColor, vPos);','}'].join('\\n');var i=new THREE.Vector4();var k=new THREE.Vector4();this._updateColor(i,this.getBackgroundColorTop());this._updateColor(k,this.getBackgroundColorBottom());this._checkBackgroundColor();this._backgroundMaterial=new THREE.ShaderMaterial({uniforms:{topColor:{value:i},bottomColor:{value:k}},vertexShader:e,fragmentShader:h,side:THREE.DoubleSide,depthTest:false,depthWrite:false,blending:THREE.NoBlending});var m=new THREE.Geometry();m.vertices.push(new THREE.Vector3(-1,1,0),new THREE.Vector3(1,1,0),new THREE.Vector3(-1,-1,0),new THREE.Vector3(1,-1,0));m.faces.push(new THREE.Face3(0,2,1),new THREE.Face3(1,2,3));this._backgroundCamera=new THREE.Camera();this._backgroundScene=new THREE.Scene();this._backgroundScene.add(new THREE.Mesh(m,this._backgroundMaterial));var x=['#include <clipping_planes_pars_vertex>','varying vec3 vNormal;','void main() {','#include <begin_vertex>','#include <project_vertex>','#include <clipping_planes_vertex>','#include <beginnormal_vertex>','#include <defaultnormal_vertex>','\tvNormal = normalize( transformedNormal );','}'].join('\\n');var n=['#include <clipping_planes_pars_fragment>','uniform vec4 color1;','uniform vec4 color2;','varying vec3 vNormal;','void main() {','#include <clipping_planes_fragment>','\tgl_FragColor = mix(color1, color2, abs(normalize(vNormal).z));','}'].join('\\n');this._xrayColor1=new THREE.Vector4(0,0.75,1,0.45);this._xrayColor2=new THREE.Vector4(0,0,1,0);this._xrayMaterial=new THREE.ShaderMaterial({uniforms:{color1:{value:this._xrayColor1},color2:{value:this._xrayColor2}},vertexShader:x,fragmentShader:n,side:THREE.DoubleSide,depthWrite:false,depthFunc:THREE.LessDepth,blending:THREE.NormalBlending,clipping:true,transparent:true});this._viewportGestureHandler=new c(this);this._loco=new L();this._loco.addHandler(this._viewportGestureHandler);this._zoomedObject=null;this._nodesTransitionHelper=new N();this._nodesTransitionHelper.setViewport(this);this._cdsLoader=null;this.attachCameraChanged(function(s){this.setShouldRenderFrame();});this.attachCameraUpdateCompleted(function(s){var t=function(v){v.startAnimation();};var u=this;setTimeout(t,20,u);});this._sceneObserver=new d(this.setShouldRenderFrame.bind(this));this._currentViews=null;this._currentViewIndex=0;this._playingProcedure=false;};g.prototype.exit=function(){this._loco.removeHandler(this._viewportGestureHandler);this._viewportGestureHandler.destroy();if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}this._stopRenderLoop();this.setScene(null);this.setCamera(null);this._renderer=null;this._backgroundCamera=null;this._backgroundMaterial=null;this._backgroundScene=null;this._loco=null;this._viewportGestureHandler=null;if(this._cdsLoader){this._cdsLoader.detachSceneUpdated(this._handleCdsSceneUpdate,this);}if(j.exit){j.exit.call(this);}};g.prototype._startRenderLoop=function(){if(!this._renderLoopRequestId){this._renderLoopRequestId=window.requestAnimationFrame(this._renderLoopFunction);}return this;};g.prototype._stopRenderLoop=function(){if(this._renderLoopRequestId){window.cancelAnimationFrame(this._renderLoopRequestId);this._renderLoopRequestId=0;}return this;};g.prototype.setBackgroundColorTop=function(v){j.setBackgroundColorTop.call(this,v);if(this._backgroundMaterial!==null){this._updateColor(this._backgroundMaterial.uniforms.topColor.value,v);this._checkBackgroundColor();}return this;};g.prototype.setBackgroundColorBottom=function(v){j.setBackgroundColorBottom.call(this,v);if(this._backgroundMaterial!==null){this._updateColor(this._backgroundMaterial.uniforms.bottomColor.value,v);this._checkBackgroundColor();}return this;};g.prototype.setClippingPlanes=function(e){this._clippingPlanes=e;return this;};g.prototype.onBeforeRendering=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}this._stopRenderLoop();};g.prototype.onAfterRendering=function(){var e=this.getDomRef();e.appendChild(this._renderer.domElement);this._resizeListenerId=R.register(this,this._handleResize.bind(this));this._handleResize({size:{width:e.clientWidth,height:e.clientHeight}});this._startRenderLoop();};g.prototype._handleResize=function(e){if(!this._camera||!this._renderer){return false;}var w=e.size.width;var h=e.size.height;if(this._camera){this._camera.update(w,h);}this._renderer.setSize(w,h);this.fireResize({size:{width:w,height:h}});this.setShouldRenderFrame();return true;};g.prototype.setScene=function(s){this._scene=s;this._homeCamera=null;this._sceneObserver.disconnect();var n=this._scene?this._scene.getSceneRef():undefined;if(n){this._sceneObserver.observe(this._scene,{properties:['doubleSided']});var e;for(var i=0;i<n.children.length;i++){e=n.children[i];if(e.private&&e.name==='DefaultLights'&&e.children.length){if(e.children[0]instanceof THREE.PointLight){this._eyePointLight=e.children[0];}}}}this.setShouldRenderFrame();return this;};g.prototype.getScene=function(){return this._scene;};g.prototype.setCamera=function(e){if(j.setCamera){j.setCamera.call(this,e);}var h=this.getCamera();if(h&&this._renderer){var s=this._renderer.getSize();h.update(s.width,s.height);if(!this._homeCamera&&h.getCameraRef()){this._homeCamera=h.getCameraRef().clone();}}this.setShouldRenderFrame();return this;};g.prototype.getRenderer=function(){return this._renderer;};g.prototype._getViewStateManagerThreeJS=function(){if(this._viewStateManager){if(this._viewStateManager instanceof sap.ui.vk.threejs.ViewStateManager){return this._viewStateManager;}if(this._viewStateManager instanceof sap.ui.vk.ViewStateManager&&this._viewStateManager._implementation instanceof sap.ui.vk.threejs.ViewStateManager){return this._viewStateManager._implementation;}}return null;};g.prototype._updateBoundingBoxesIfNeeded=function(){var v=this._getViewStateManagerThreeJS();if(v){v._updateBoundingBoxesIfNeeded();}};g.prototype._updateColor=function(e,h){var i=sap.ui.vk.cssColorToColor(h);e.color=new THREE.Color(i.red/255,i.green/255,i.blue/255);e.alpha=i.alpha;e.x=e.color.r*e.alpha;e.y=e.color.g*e.alpha;e.z=e.color.b*e.alpha;e.w=e.alpha;};g.prototype._checkBackgroundColor=function(){var e=this.getBackgroundColorTop();if(e===this.getBackgroundColorBottom()){if(this._backgroundColor===null){this._backgroundColor=new THREE.Vector4();}this._updateColor(this._backgroundColor,e);}else{this._backgroundColor=null;}this.setShouldRenderFrame();};g.prototype._handleCdsSceneUpdate=function(){this.setShouldRenderFrame();};g.prototype.setShouldRenderFrame=function(){this._shouldRenderFrame=true;return this;};g.prototype.shouldRenderFrame=function(){return this._shouldRenderFrame;};g.prototype.setRenderMode=function(e){this.setProperty('renderMode',e,true);if(this._scene){switch(e){case sap.ui.vk.RenderMode.LineIllustration:case sap.ui.vk.RenderMode.ShadedIllustration:case sap.ui.vk.RenderMode.SolidOutline:this._scene._createOutlineGeometry(e);break;default:this._scene._hideOutlineGeometry();break;}}this.setShouldRenderFrame();return this;};g.prototype.hitTest=function(x,y){var n=this._scene?this._scene.getSceneRef():undefined;var e=this._camera?this._camera.getCameraRef():undefined;if(!e||!n){return null;}var h=this._renderer.domElement;var m=new THREE.Vector2((x-h.clientLeft)/h.clientWidth*2-1,(h.clientTop-y)/h.clientHeight*2+1);var k=new THREE.Raycaster();k.setFromCamera(m,e);if(this._clippingPlanes){for(var i in this._clippingPlanes){var s=this._clippingPlanes[i];var u=s.distanceToPoint(k.ray.origin),t=-u/s.normal.dot(k.ray.direction);if(t>0){if(u<0){k.near=Math.max(k.near,t);}else{k.far=Math.min(k.far,t);}}else if(u<0){return null;}}}var v=k.intersectObjects(n.children,true);if(v&&v.length){var w=v[0];if(!w.object.name&&w.object.children.length===0){w.object=w.object.parent;}return w;}return null;};g.prototype.tap=function(x,y,i){if(!i){if(this._viewStateManager){var h=this.hitTest(x,y);var n=h&&h.object;var e={picked:n?[n]:[]};this.fireNodesPicked(e);if(this.getSelectionMode()===sap.ui.vk.SelectionMode.Exclusive){this.exclusiveSelectionHandler(e.picked);}else if(this.getSelectionMode()===sap.ui.vk.SelectionMode.Sticky){this.stickySelectionHandler(e.picked);}if(n!==null){this.fireNodeClicked({nodeRef:n,x:x,y:y},true,true);}}}else if(!this.getFreezeCamera()){var k=this.hitTest(x,y);if(k&&(this._zoomedObject===null||this._zoomedObject!==k.object)){this._zoomedObject=k.object;this._viewportGestureHandler.zoomObject(this._zoomedObject,true);}else{this._viewportGestureHandler.zoomObject(this._zoomedObject,false);this._zoomedObject=null;}}return this;};var o={x:-2,y:-2};var r=2;var p=5;[{key:'left',dx:-r,dy:0},{key:'right',dx:+r,dy:0},{key:'up',dx:0,dy:-r},{key:'down',dx:0,dy:+r}].forEach(function(i){g.prototype['onsap'+i.key]=function(e){var h=this._viewportGestureHandler._cameraController;h.beginGesture(o.x,o.y);h.rotate(i.dx,i.dy,true);h.endGesture();this.setShouldRenderFrame();e.preventDefault();e.stopPropagation();};});[{key:'left',dx:-p,dy:0},{key:'right',dx:+p,dy:0},{key:'up',dx:0,dy:-p},{key:'down',dx:0,dy:+p}].forEach(function(i){g.prototype['onsap'+i.key+'modifiers']=function(e){if(e.shiftKey&&!(e.ctrlKey||e.altKey||e.metaKey)){var h=this._viewportGestureHandler._cameraController;h.beginGesture(o.x,o.y);h.pan(i.dx,i.dy);h.endGesture();this.setShouldRenderFrame();e.preventDefault();e.stopPropagation();}};});[{key:'minus',d:0.98},{key:'plus',d:1.02}].forEach(function(i){g.prototype['onsap'+i.key]=function(e){var h=this._viewportGestureHandler._cameraController;h.beginGesture(this.$().width()/2,this.$().height()/2);h.zoom(i.d);h.endGesture();this.setShouldRenderFrame();e.preventDefault();e.stopPropagation();};});g.prototype._handleVisibilityChanged=g.prototype._handleOpacityChanged=g.prototype._handleTintColorChanged=g.prototype._handleHighlightColorChanged=function(e){this.setShouldRenderFrame();};g.prototype._handleSelectionChanged=function(e){var t=this.getTools();for(var i=0;i<t.length;i++){var h=sap.ui.getCore().byId(t[i]);var k=h.getGizmoForContainer(this);if(k&&k.handleSelectionChanged){k.handleSelectionChanged(e);}}this.setShouldRenderFrame();};g.prototype.setSelectionRect=function(e){this.setShouldRenderFrame();if(!e){this._selectionRect=null;return;}var s=this._renderer.getSize();var x=(e.x1/s.width)*2-1,y=(e.y1/s.height)*-2+1,h=(e.x2/s.width)*2-1,i=(e.y2/s.height)*-2+1;if(!this._selectionRect){var k=new THREE.Geometry();k.vertices.push(new THREE.Vector3(x,i,-1),new THREE.Vector3(h,i,-1),new THREE.Vector3(h,y,-1),new THREE.Vector3(x,y,-1));this._selectionRect=new THREE.LineLoop(k,new THREE.LineBasicMaterial({color:0xFFFF00,linewidth:window.devicePixelRatio}));}else{var v=this._selectionRect.geometry.vertices;v[0].set(x,i,-1);v[1].set(h,i,-1);v[2].set(h,y,-1);v[3].set(x,y,-1);this._selectionRect.geometry.verticesNeedUpdate=true;}};g.prototype._renderLoop=function(){if(!this._renderer||!this.getDomRef()){this._renderLoopRequestId=0;return;}if(this._viewportGestureHandler){this._viewportGestureHandler.animateCameraUpdate();}if(this._nodesTransitionHelper){this._nodesTransitionHelper.displayNodesMoving();}if(this.getCamera()){var n=this.getCamera().getCameraRef();if(this._eyePointLight&&n){this._eyePointLight.position.copy(n.position);}if(this.getCamera().getIsModified()){this.getCamera().setIsModified(false);this._shouldRenderFrame=true;}}if(this._shouldRenderFrame){this._shouldRenderFrame=false;this.render();}this._renderLoopRequestId=window.requestAnimationFrame(this._renderLoopFunction);};g.prototype._updateDynamicObjects=function(e,n,h,i){var k=false;h.children.forEach(function(m){if(m.userData._vkDetailViews&&m.userData._vkDetailViews.length>0){k=true;}});function s(v){h.children.forEach(function(m){if(m.userData._vkBillboards){m.userData._vkBillboards.forEach(function(t){t._node.visible=v;});}if(m.userData._vkDetailViews){m.userData._vkDetailViews.forEach(function(t){t._node.visible=v;});}});}if(k){i=i||this._scene._computeBoundingBox();s(false);h.children.forEach(function(m){if(m.userData._vkDetailViews){m.userData._vkDetailViews.forEach(function(t){t._update(e,n,h,i);});}});s(true);}h.children.forEach(function(m){if(m.userData._vkCallouts){m.userData._vkCallouts.forEach(function(t){t._update(e,n);});}if(m.userData._vkBillboards){m.userData._vkBillboards.forEach(function(t){t._update(e,n);});}});};g.prototype.render=function(){var e=this._renderer;if(!e){return;}var n=this._scene?this._scene.getSceneRef():null;var h=this._camera?this._camera.getCameraRef():null;if(!n||!h){return;}var t=this.getTools();var i,k,m,s;if(this._camera.getUsingDefaultClipPlanes()||(h.isOrthographicCamera&&this._camera.getZoomNeedRecalculate())){s=this._scene._computeBoundingBox();if(!s.isEmpty()){if(h.isOrthographicCamera&&this._camera.getZoomNeedRecalculate()){this._camera.adjustZoom(s);}if(this._camera.getUsingDefaultClipPlanes()){for(i=0;i<t.length;i++){k=sap.ui.getCore().byId(t[i]);m=k.getGizmoForContainer(this);if(m&&m.expandBoundingBox){m.expandBoundingBox(s);}}this._camera.adjustClipPlanes(s);}}}this._updateDynamicObjects(e,h,n,s);e.autoClear=this._backgroundColor!=null;if(e.autoClear){e.setClearColor(this._backgroundColor.color,this._backgroundColor.alpha);}else{e.render(this._backgroundScene,this._backgroundCamera);}var v=this._getViewStateManagerThreeJS();e.clippingPlanes=this._clippingPlanes;switch(this.getRenderMode()){case sap.ui.vk.RenderMode.XRay:if(v){var u=n.children[n.children.length-1].clone();v._selectedNodes.forEach(function(y){if(y.visible){y.add(u);e.render(y,h);e.autoClear=false;y.remove(u);}});}n.overrideMaterial=this._xrayMaterial;break;case sap.ui.vk.RenderMode.LineIllustration:case sap.ui.vk.RenderMode.ShadedIllustration:case sap.ui.vk.RenderMode.SolidOutline:this._scene._outlineMaterial.linewidth=this._renderer.getPixelRatio();break;default:break;}if(this._animationMixer){this.setShouldRenderFrame();var w=this._clock.getDelta();q.sap.log.debug('animationMixer delta: '+w.toString());this._animationMixer.update(w);}e.render(n,h);e.autoClear=false;e.clippingPlanes=[];n.overrideMaterial=null;if(v){var x=v._boundingBoxesScene;if(x){e.render(x,h);}}for(i=0;i<t.length;i++){k=sap.ui.getCore().byId(t[i]);m=k.getGizmoForContainer(this);if(m&&m.render){m.render(this);}}if(this._selectionRect){e.render(this._selectionRect,this._backgroundCamera);}};g.prototype.getImage=function(e,i,t,k,m){if(this._scene===null){return null;}e=e||16;i=i||16;if(e>2048){e=2048;}if(i>2048){i=2048;}var n=new THREE.WebGLRenderer({preserveDrawingBuffer:true});n.setSize(e,i);var s=this.getBackgroundColorTop();var u=this.getBackgroundColorBottom();if(t&&!k){n.setClearColor(t,1);}else if(!t&&k){n.setClearColor(k,1);}else{if(t&&k){this.setBackgroundColorTop(t);this.setBackgroundColorBottom(k);}n.render(this._backgroundScene,this._backgroundCamera);n.autoClear=false;}document.body.appendChild(n.domElement);var v=this.getCamera().getCameraRef().clone();var x=e/i;if(v.isOrthographicCamera){var w=v.right-v.left;var h=v.top-v.bottom;if(w>h){v.top=w/x/2;v.bottom=-w/x/2;}else{v.left=-h*x/2;v.right=h*x/2;}}else{var y=2*Math.atan(v.aspect*Math.tan(v.fov*Math.PI/360));if(v.fov<y*180/Math.PI){v.fov=360*Math.atan(Math.tan(y*0.5)/x)/Math.PI;}v.aspect=x;}v.updateProjectionMatrix();var z=[];var A=this._getViewStateManagerThreeJS();if(!m){if(A!==null){A.enumerateSelection(function(D){z.push(D);});A.setSelectionState(z,false,false,true);}}n.render(this._scene.getSceneRef(),v);var B=n.getContext().canvas.toDataURL();if(A!==null&&z.length>0){A.setSelectionState(z,true,false,true);}n.forceContextLoss();document.body.removeChild(n.domElement);if(u&&t){this.setBackgroundColorBottom(u);}if(s&&k){this.setBackgroundColorTop(s);}return B;};g.prototype._setContent=function(e){var s;var h;if(e){s=e;if(!(s instanceof sap.ui.vk.threejs.Scene)){s=null;}h=e.camera;if(!(h instanceof O||h instanceof P)){h=new P();}if(h instanceof sap.ui.vk.threejs.OrthographicCamera){var k=new THREE.Box3().setFromObject(s.getSceneRef());var m=k.getCenter();var n=h.getTargetDirection();var t=h.getPosition();var u=[m.x-t[0],m.y-t[1],m.z-t[2]];var v=u[0]*n[0]+u[1]*n[1]+u[2]*n[2];if(v<0){var w=k.getSize().length()/2;w-=v;t[0]-=n[0]*w;t[1]-=n[1]*w;t[2]-=n[2]*w;h.setPosition(t);}}var i;if(e.loaders){for(i=0;i<e.loaders.length;i++){if(e.loaders[i]instanceof sap.ui.vk.threejs.ContentDeliveryService){this._cdsLoader=e.loaders[i];this._cdsLoader.attachSceneUpdated(this._handleCdsSceneUpdate,this);break;}}}if(e.builders){for(i=0;i<e.builders.length;i++){e.builders[i]._fireSceneUpdated=this.setShouldRenderFrame.bind(this);}}}if(this._animationMixer){this._animationMixer.stopAllAction();this._animationMixer=null;}this._currentPlaybacks=null;this.setScene(s);if(h){this.setCamera(h);}};g.prototype._onAfterUpdateContentConnector=function(){this._setContent(this._contentConnector.getContent());};g.prototype._onBeforeClearContentConnector=function(){if(j._onBeforeClearContentConnector){j._onBeforeClearContentConnector.call(this);}this.setScene(null);};g.prototype._handleContentReplaced=function(e){var h=e.getParameter('newContent');this._setContent(h);};g.prototype._onAfterUpdateViewStateManager=function(){};g.prototype._onBeforeClearViewStateManager=function(){};C.injectMethodsIntoClass(g);b.injectMethodsIntoClass(g);g.prototype._restoreOriginalValueAfterAnimiation=function(){if(!this._currentPlaybacks||!this._currentPlaybacks.length){return;}var n=this._scene?this._scene.getSceneRef():undefined;if(!n){return;}for(var e=0;e<this._currentPlaybacks.length;e++){var h;if(n.userData&&n.userData.sequences){h=n.userData.sequences.get(this._currentPlaybacks[e].sequenceId);}if(h){if(h&&h.tracks){for(var t=0;t<h.tracks.length;t++){var k=h.tracks[t];var i=k.userData;if(!i){continue;}var m=i.originalValue;if(!m){continue;}var s=i.targetNode;if(!s){continue;}if(i.type==='SCALE'){s.scale.x=m.x;s.scale.y=m.y;s.scale.z=m.z;}else if(i.type==='TRANSLATE'){s.position.x=m.x;s.position.y=m.y;s.position.z=m.z;}else if(i.type==='ROTATE'){s.quaternion.w=m.w;s.quaternion.x=m.x;s.quaternion.y=m.y;s.quaternion.z=m.z;}}}}}};g.prototype._resetPlaybacks=function(e){if(this._animationMixer){this._animationMixer.stopAllAction();this._animationMixer=null;}this._restoreOriginalValueAfterAnimiation();if(e&&e.length){this._currentPlaybacks=e;}else{this._currentPlaybacks=null;}return;};g.prototype._resetNodePositionsAfterAnimation=function(){var n=this._scene?this._scene.getSceneRef():undefined;if(!n||!n.userData){return;}if(n.userData.animationNodeOriginalData){var e=n.userData.animationNodeOriginalData.entries();var h=e.next();while(!h.done){var i=h.value[0];var k=h.value[1];if(k.scale){i.scale.x=k.scale.x;i.scale.y=k.scale.y;i.scale.z=k.scale.z;}if(k.position){i.position.x=k.position.x;i.position.y=k.position.y;i.position.z=k.position.z;}if(k.quaternion){i.quaternion.w=k.quaternion.w;i.quaternion.x=k.quaternion.x;i.quaternion.y=k.quaternion.y;i.quaternion.z=k.quaternion.z;}h=e.next();}}return;};g.prototype._runAnimation=function(){if(!this._currentPlaybacks){return;}var n=this._scene?this._scene.getSceneRef():undefined;if(!n){return;}var t=0;for(var e=0;e<this._currentPlaybacks.length;e++){var h;if(n.userData&&n.userData.sequences){h=n.userData.sequences.get(this._currentPlaybacks[e].sequenceId);}if(h&&!h.hasOptimized){h.resetDuration();h.optimize();h.hasOptimized=true;}if(h){var i=this._animationMixer.clipAction(h);i.clampWhenFinished=true;if(this._currentPlaybacks[e].playbackRepeat>0){i.setLoop(THREE.LoopRepeat,this._currentPlaybacks[e].playbackRepeat-1);}else{i.setLoop(THREE.LoopOnce,1);}t+=this._currentPlaybacks[e].playbackPreDelay;i.startAt(t);if(this._currentPlaybacks[e].playbackReversed){i.timeScale=-1;}if(this._currentPlaybacks[e].playbackSpeed>0){i.timeScale*=this._currentPlaybacks[e].playbackSpeed;}i.play();t+=h.duration+this._currentPlaybacks[e].playbackPostDelay;}}this.setShouldRenderFrame();this._clock.start();};g.prototype.startAnimation=function(){if(!this._currentPlaybacks||!this._currentPlaybacks.length){this._playStep();return;}var n=this._scene?this._scene.getSceneRef():undefined;if(!n){return;}if(this._animationMixer){this._animationMixer.stopAllAction();this._animationMixer=null;}this._animationMixer=new THREE.AnimationMixer(n);if(!this._animationMixer.userData){this._animationMixer.userData={};}this._animationMixer.userData.viewport=this;this._animationMixer.addEventListener('finished',function(e){if(this.userData.viewport){if(this.userData.viewport._curentView){this.userData.viewport._curentView.animationCompleted=true;}var h=function(v){v._playStep();};setTimeout(h,200,this.userData.viewport);q.sap.log.debug('Animation finished');}},false);this._runAnimation();return;};g.prototype.stopAnimation=function(){if(this._animationMixer){this._animationMixer.stopAllAction();this._animationMixer=null;}this._playingProcedure=false;this.setShouldRenderFrame();};g.prototype._activateSingleView=function(v){var e=v.playbacks;if(!e&&v.getPlaybacks){e=v.getPlaybacks();}this._resetPlaybacks(e);var h=v.camera;if(!h){var i=v.getCameraInfo();if(i.type==='PerspectiveCamera'){h=new P();h.setFov(i.fov);}if(i.type==='OrthographicCamera'){h=new O();h.setZoomFactor(i.zoomFactor);if(i.zoomNeedRecalculate){h.setZoomNeedRecalculate(true);}}h.setPosition(i.position);h.setNearClipPlane(i.nearClipPlane);h.setFarClipPlane(i.farClipPlane);h.setUpDirection(i.upDirection);h.setTargetDirection(i.targetDirection);h.setUsingDefaultClipPlanes(i.usingDefaultClipPlanes);v.camera=h;}var n=this._scene?this._scene.getSceneRef():undefined;if(h){var k=h.getCameraRef();if(k.type==='OrthographicCamera'&&n){var m=h.getPosition();var s=this.getScene();if(s){var t=new THREE.Box3().setFromObject(n);var u=t.getCenter();var w=h.getTargetDirection();var x=[u.x-m[0],u.y-m[1],u.z-m[2]];var y=x[0]*w[0]+x[1]*w[1]+x[2]*w[2];if(y<0){var z=t.getSize().length()/2;z-=y;m[0]-=w[0]*z;m[1]-=w[1]*z;m[2]-=w[2]*z;}}h.setPosition(m);}}var A;if(v.getNodeInfos){A=v.getNodeInfos();}function B(T){return new THREE.Matrix4().set(T[0],T[1],T[2],T[3],T[4],T[5],T[6],T[7],T[8],T[9],T[10],T[11],0,0,0,1);}if(A){var D=this._viewStateManager.getNodeHierarchy();this._nodesTransitionHelper.clear();A.forEach(function(H){if(H.target===null){return;}function T(X,Y,Z){for(var $=0;$<X.elements.length;$++){if(Math.abs(X.elements[$]-Y.elements[$])>Z){return false;}}return true;}if(H.transform){var U=B(H.transform);if(!T(U,H.target.matrix,1e-6)){if(!this._currentPlaybacks){var W=D.createNodeProxy(H.target);this._nodesTransitionHelper.setNodeForDisplay(W);}U.decompose(H.target.position,H.target.quaternion,H.target.scale);H.target.updateMatrix();}}}.bind(this));}var E;if(v.animationNodeOriginalData){E=v.animationNodeOriginalData.entries();}else if(this._currentPlaybacks&&this._currentPlaybacks.length&&n){var F;if(n.userData&&n.userData.sequences){F=n.userData.sequences.get(this._currentPlaybacks[0].sequenceId);}if(F&&F.userData.nodesStartData){E=F.userData.nodesStartData.entries();}}if(E){var G=E.next();while(!G.done){var H=G.value[0];var I=G.value[1];if(I.scale){H.scale.x=I.scale.x;H.scale.y=I.scale.y;H.scale.z=I.scale.z;}if(I.position){H.position.x=I.position.x;H.position.y=I.position.y;H.position.z=I.position.z;}if(I.quaternion){H.quaternion.w=I.quaternion.w;H.quaternion.x=I.quaternion.x;H.quaternion.y=I.quaternion.y;H.quaternion.z=I.quaternion.z;}G=E.next();}}if(A){var J=[];var K=[];for(var Q=0;Q<A.length;Q++){if(A[Q].visible){J.push(A[Q].target);}else{K.push(A[Q].target);}}this._viewStateManager.setVisibilityState(J,true,false);this._viewStateManager.setVisibilityState(K,false,false);this._nodesTransitionHelper.startDisplay(500);}else if(v.visibleNodes&&n){this._viewStateManager.setVisibilityState(n.children[0],false,true);this._viewStateManager.setVisibilityState(n.children[0],true,false);this._viewStateManager.setVisibilityState(v.visibleNodes,true,false);}if(h){var S=2000;if(v.flyToTime){S=v.flyToTime;}this._viewportGestureHandler._activateCamera(h.getCameraRef(),S);}};g.prototype.activateView=function(v){this._playingProcedure=false;this._activateSingleView(v);return this;};g.prototype._playStep=function(){if(!this._playingProcedure){return;}var v=this._currentViews[this._currentViewIndex];this._activateSingleView(v);this._currentViewIndex++;if(this._currentViews.length<=this._currentViewIndex){this._playingProcedure=false;}};g.prototype.playProcedure=function(v){this._resetNodePositionsAfterAnimation();if(v){this._currentViews=v;}if(!this._currentViews){return this;}this._currentViewIndex=0;this._playingProcedure=true;var e=function(h){h._playStep();};var t=this;setTimeout(e,200,t);return this;};g.prototype.zoomTo=function(w,n,e,m){var h=this._scene?this._scene.getSceneRef():null;var i=this._camera?this._camera.getCameraRef():null;if(!i||!h){return this;}m=m||0;var k=new THREE.Box3();var s=null;var t=null;(Array.isArray(w)?w:[w]).forEach(function(w){switch(w){case sap.ui.vk.ZoomTo.All:h._expandBoundingBox(k,false);break;case sap.ui.vk.ZoomTo.Visible:h._expandBoundingBox(k,true);break;case sap.ui.vk.ZoomTo.Selected:var v=this._getViewStateManagerThreeJS();if(v){v.enumerateSelection(function(n){n._expandBoundingBox(k,false);});}break;case sap.ui.vk.ZoomTo.Node:if(!n){return this;}t=n;if(Array.isArray(n)){n.forEach(function(n){n._expandBoundingBox(k,false);});}else{n._expandBoundingBox(k,false);}break;case sap.ui.vk.ZoomTo.Restore:q.sap.log.error('sap.ui.vk.ZoomTo.Restore is not implemented');return this;case sap.ui.vk.ZoomTo.NodeSetIsolation:q.sap.log.error('sap.ui.vk.ZoomTo.NodeSetIsolation is not implemented');return this;case sap.ui.vk.ZoomTo.RestoreRemoveIsolation:q.sap.log.error('sap.ui.vk.ZoomTo.RestoreRemoveIsolation is not implemented');return this;case sap.ui.vk.ZoomTo.ViewLeft:s=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),-Math.PI/2);break;case sap.ui.vk.ZoomTo.ViewRight:s=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI/2);break;case sap.ui.vk.ZoomTo.ViewTop:s=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/2);break;case sap.ui.vk.ZoomTo.ViewBottom:s=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1,0,0),Math.PI/2);break;case sap.ui.vk.ZoomTo.ViewBack:s=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI);break;case sap.ui.vk.ZoomTo.ViewFront:s=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),0);break;default:break;}}.bind(this));if(!k.isEmpty()){this._viewportGestureHandler.zoomTo(k,s,m,e*1000,t,t!==null);}return this;};g.prototype.getViewInfo=function(e){var v={};if(e==null){e={};}if(e.camera==null){e.camera=true;}var n=this._camera?this._camera.getCameraRef():null;if(e.camera&&n){var h=n.rotation.clone();h.reorder('YXZ');v.camera={rotation:{yaw:THREE.Math.radToDeg(h.y),pitch:THREE.Math.radToDeg(h.x),roll:THREE.Math.radToDeg(h.z)},position:{x:n.position.x,y:n.position.y,z:n.position.z},projectionType:n.isOrthographicCamera?sap.ui.vk.CameraProjectionType.Orthographic:sap.ui.vk.CameraProjectionType.Perspective,bindingType:sap.ui.vk.CameraFOVBindingType.Vertical};if(v.camera.projectionType===sap.ui.vk.CameraProjectionType.Perspective){v.camera.fieldOfView=n.fov;}else if(v.camera.projectionType===sap.ui.vk.CameraProjectionType.Orthographic){v.camera.zoomFactor=n.zoom;}if(e.camera.matrices){v.camera.matrices={view:n.matrixWorldInverse.elements.slice(),projection:n.projectionMatrix.elements.slice()};}}if(e.visibility&&this._viewStateManager){var i=e.visibility.mode==null?sap.ui.vk.VisibilityMode.Complete:e.visibility.mode;v.visibility={mode:i};if(i===sap.ui.vk.VisibilityMode.Complete){var k=this._viewStateManager.getVisibilityComplete();v.visibility.visible=k.visible;v.visibility.hidden=k.hidden;}else if(this._viewStateManager.getShouldTrackVisibilityChanges()){v.visibility.changes=this._viewStateManager.getVisibilityChanges();}else{q.sap.log.warning(sap.ui.vk.getResourceBundle().getText(M.VIT32.summary),M.VIT32.code,'sap.ui.vk.threejs.Viewport');}}return v;};g.prototype.setViewInfo=function(v,e){var n=this._camera?this._camera.getCameraRef():null;if(v.camera&&n){var h=v.camera;var i=h.projectionType===sap.ui.vk.CameraProjectionType.Orthographic?new THREE.OrthographicCamera():new THREE.PerspectiveCamera();i.userData=n.userData;i.aspect=n.aspect;i.position.copy(h.position);var k=h.rotation;i.quaternion.setFromEuler(new THREE.Euler(THREE.Math.degToRad(k.pitch),THREE.Math.degToRad(k.yaw),THREE.Math.degToRad(k.roll),'YXZ'));i.fov=h.fieldOfView||i.fov;i.zoom=h.zoomFactor||i.zoom;this._viewportGestureHandler._activateCamera(i,(e||0)*1000);}if(v.visibility){var m=this._viewStateManager.getNodeHierarchy(),s=new Map(),t=m.findNodesByName();t.forEach(function(x){var y=m.createNodeProxy(x);var z=y.getVeId();m.destroyNodeProxy(y);if(z){s.set(z,x);}});switch(v.visibility.mode){case sap.ui.vk.VisibilityMode.Complete:var u=v.visibility.visible,w=v.visibility.hidden;u.forEach(function(x){this._viewStateManager.setVisibilityState(s.get(x),true,false);},this);w.forEach(function(x){this._viewStateManager.setVisibilityState(s.get(x),false,false);},this);break;case sap.ui.vk.VisibilityMode.Differences:this._viewStateManager.resetVisibility();v.visibility.changes.forEach(function(x){var y=s.get(x);if(y){this._viewStateManager.setVisibilityState(y,!this._viewStateManager.getVisibilityState(y),false);}},this);break;default:q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT28.summary),M.VIT28.code,'sap.ui.vk.threejs.Viewport');break;}}return this;};g.prototype.queueCommand=function(e){if(this instanceof sap.ui.vk.threejs.Viewport){e();}return this;};g.prototype.getOutputSize=function(){var e=this.getDomRef().getBoundingClientRect();var v=e.width;var h=e.height;var i;i=Math.min(v,h);return{left:(v-i)/2,top:(h-i)/2,sideLength:i};};return g;});\n",
	"sap/ui/vk/threejs/ViewportGestureHandler.js":"/*!\n* SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n*/\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider','./thirdparty/three'],function(q,E,t){'use strict';var V=E.extend('sap.ui.vk.threejs.ViewportGestureHandler',{metadata:{},constructor:function(v){this._matProj=null;this._viewport=v;this._rect=null;this._evt={x:0,y:0,z:0,d:0,initd:0};this._gesture=false;this._viewport.attachEvent('resize',this,this._onresize);this._nomenu=false;var T=function(a){var v=a;var b=new THREE.Vector3();var z=new THREE.Vector2();var A=0.001;var M=-Math.PI/2+A;var c=Math.PI/2-A;this.isTurnTableMode=true;this._timeIntervalForCameraAnimation=500;this._startTimeForCameraAnimation=0;this._newCamera=null;this._oldCamera=null;this._animationType=null;this._zoomedNodeRef=null;this._isZoomIn=true;this.beginGesture=function(x,y){var d=v.getScene();if(d==null){return;}var e=d.getSceneRef();var f=v.getCamera().getCameraRef();var h=v.getRenderer().getSize();z.x=x/h.width*2-1;z.y=y/h.height*-2+1;v._gesturePoint={x:x,y:y};var i=v.hitTest(x,y,e,f);if(i){b.copy(i.point);}else{var j=new THREE.Box3();e._expandBoundingBox(j,true);if(!j.isEmpty()){j.getCenter(b);}else{b.setScalar(0);}}};this.endGesture=function(){};this.pan=function(d,e){if(v.getFreezeCamera()||v.getCamera()==null){return;}if(d===0&&e===0){return;}var f=v.getCamera().getCameraRef();var h=v.getRenderer().getSize();if(v._viewportGestureHandler._matProj){var m=v._viewportGestureHandler._matProj;m[8]-=d*2/h.width;m[9]+=e*2/h.height;}else{var o=b.clone().project(f);o.x-=d*2/h.width;o.y+=e*2/h.height;o.unproject(f).sub(b);f.position.add(o);}f.updateMatrixWorld();v.fireCameraChanged({position:f.position.toArray()});};this.rotate=function(d,e,i){if(v.getFreezeCamera()||v.getCamera()==null){return;}if(i!==undefined){this.isTurnTableMode=i;}if(d===0&&e===0){return;}var f=v.getCamera().getCameraRef(),h=d*-0.01,j=e*-0.01;var o=f.position.clone().sub(b);var l=new THREE.Vector3(),u=new THREE.Vector3().setFromMatrixColumn(f.matrixWorld,1).normalize(),r=new THREE.Vector3().setFromMatrixColumn(f.matrixWorld,0).normalize();f.getWorldDirection(l);l.normalize();var k=new THREE.Quaternion(),m=new THREE.Quaternion();if(this.isTurnTableMode){var n=new THREE.Vector3(0,1,0);r.crossVectors(l,n).normalize();u.crossVectors(r,l);var p=Math.atan2(l.y,Math.sqrt(l.x*l.x+l.z*l.z));k.setFromAxisAngle(n,h);m.setFromAxisAngle(r,THREE.Math.clamp(j,M-p,c-p));}else{k.setFromAxisAngle(u,h);m.setFromAxisAngle(r,j);}k.multiply(m);o.applyQuaternion(k);l.applyQuaternion(k);u.applyQuaternion(k);o.add(b);f.position.copy(o);f.up.copy(u);f.lookAt(o.add(l));f.updateMatrixWorld();v.fireCameraChanged({position:f.position.toArray(),quaternion:f.quaternion.toArray()});};this.zoom=function(d){if(v.getFreezeCamera()||v.getCamera()==null){return;}var e=v.getScene();if(e==null){return;}var h=e.getSceneRef();if(d===0||d===1){return;}if(d>1.12){d=1.12;}else if(d<0.88){d=0.88;}var i=100;var j=v.getCamera().getCameraRef();var k=new THREE.Vector3();var l=new THREE.Box3();var m=new THREE.Vector3();h._expandBoundingBox(l,true);l.applyMatrix4(j.matrixWorldInverse);l.min.z=Math.max(l.min.z,j.near);l.max.z=Math.max(l.max.z,j.near);l.applyMatrix4(j.projectionMatrix);l.getSize(m);var n=v.getRenderer().getSize();var o=m.x*n.width*0.5;var p=m.y*n.height*0.5;if(o<i&&p<i&&d<1){return;}if(j.isPerspectiveCamera){if(v._viewportGestureHandler._matProj){this._matProj=v._viewportGestureHandler._matProj;var r=v.getDomRef();var u=g(this._matProj);var w=u.left+(u.right-u.left)*v._gesturePoint.x/r.clientWidth;var x=u.top+(u.bottom-u.top)*v._gesturePoint.y/r.clientHeight;var f=1/d;u.left=w+(u.left-w)*f;u.right=w+(u.right-w)*f;u.top=x+(u.top-x)*f;u.bottom=x+(u.bottom-x)*f;s(this._matProj,u);}else{k.set(z.x,z.y,1).unproject(j);k.sub(new THREE.Vector3(z.x,z.y,-1).unproject(j));var y=b.clone().sub(j.position).length()*(1-1/d);k.setLength(y);j.position.add(k);}}else if(j.isOrthographicCamera){k.set(z.x,z.y,1).unproject(j);k.sub(new THREE.Vector3(0,0,1).unproject(j));k.multiplyScalar(1-1/d);j.zoom*=d;j.updateProjectionMatrix();j.position.add(k);}else{q.sap.log.error('threejs.ViewportGestureHandler: unsupported camera type');}j.updateMatrixWorld();var B={position:j.position.toArray()};if(j.isOrthographicCamera){B.zoom=j.zoom;}v.fireCameraChanged(B);};this.animateCameraUpdate=function(){if(this._newCamera===null||this._oldCamera===null){return;}if(v.getCamera()==null){this._newCamera=null;this._oldCamera=null;return;}function d(f,h,x){x=THREE.Math.clamp((x-f)/(h-f),0.0,1.0);return x*x*x*(x*(x*6-15)+10);}var i=Math.min((Date.now()-this._startTimeForCameraAnimation)/this._timeIntervalForCameraAnimation,1);i=d(0,1,i);var e=v.getCamera().getCameraRef();if(e.isOrthographicCamera&&this._newCamera.isOrthographicCamera&&this._oldCamera.isOrthographicCamera){e.left=THREE.Math.lerp(this._oldCamera.left,this._newCamera.left,i);e.right=THREE.Math.lerp(this._oldCamera.right,this._newCamera.right,i);e.top=THREE.Math.lerp(this._oldCamera.top,this._newCamera.top,i);e.bottom=THREE.Math.lerp(this._oldCamera.bottom,this._newCamera.bottom,i);e.zoom=THREE.Math.lerp(this._oldCamera.zoom,this._newCamera.zoom,i);}if(e.isPerspectiveCamera&&this._newCamera.isPerspectiveCamera&&this._oldCamera.isPerspectiveCamera){e.fov=THREE.Math.lerp(this._oldCamera.fov,this._newCamera.fov,i);e.aspect=THREE.Math.lerp(this._oldCamera.aspect,this._newCamera.aspect,i);}e.far=THREE.Math.lerp(this._oldCamera.far,this._newCamera.far,i);e.near=THREE.Math.lerp(this._oldCamera.near,this._newCamera.near,i);e.updateProjectionMatrix();e.position.lerpVectors(this._oldCamera.position,this._newCamera.position,i);e.quaternion.copy(this._oldCamera.quaternion).slerp(this._newCamera.quaternion,i);e.scale.lerpVectors(this._oldCamera.scale,this._newCamera.scale,i);e.updateMatrixWorld();if(i===1){this._newCamera=null;this._oldCamera=null;if(this._animationType==='zooming'&&this._zoomedNodeRef){v.fireNodeZoomed({zoomed:this._zoomedNodeRef,isZoomIn:this._isZoomIn});}v.fireCameraUpdateCompleted({position:e.position.toArray(),quaternion:e.quaternion.toArray()});}v.fireCameraChanged({position:e.position.toArray(),quaternion:e.quaternion.toArray()});};this.zoomObject=function(n,i,d){if(v.getScene()==null){return;}var e=new THREE.Box3();(i&&n?n:v.getScene().getSceneRef())._expandBoundingBox(e,true);this.zoomBox(e,0,d,n,i);};this.zoomBox=function(d,m,e,n,f){this._zoomedNodeRef=n;this._isZoomIn=f;this._animationType='zooming';var h=v.getCamera().getCameraRef();var j=new THREE.Vector3();d.getSize(j);var k=new THREE.Vector3();h.getWorldDirection(k);k.multiplyScalar(j.length());var l=new THREE.Vector3();d.getCenter(l);var o=[new THREE.Vector3(d.min.x,d.min.y,d.min.z),new THREE.Vector3(d.max.x,d.max.y,d.max.z),new THREE.Vector3(d.min.x,d.min.y,d.max.z),new THREE.Vector3(d.min.x,d.max.y,d.max.z),new THREE.Vector3(d.max.x,d.min.y,d.max.z),new THREE.Vector3(d.max.x,d.max.y,d.min.z),new THREE.Vector3(d.min.x,d.max.y,d.min.z),new THREE.Vector3(d.max.x,d.min.y,d.min.z)];var p=new THREE.Matrix4(),r=new THREE.Vector3();function u(h){p.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse);for(var i in o){r.copy(o[i]).applyMatrix4(p);if(r.x<-1.0||r.x>1.0||r.y<-1.0||r.y>1.0){return false;}}return true;}this._newCamera=h.clone();this._newCamera.position.copy(l).sub(k);this._newCamera.updateMatrixWorld(true);if(h.isPerspectiveCamera){while(!u(this._newCamera)){this._newCamera.position.sub(k);this._newCamera.updateMatrixWorld(true);}var w=10;var P=this._newCamera.position.clone();var x=l.clone();for(var y=0;y<w;y++){this._newCamera.position.copy(P).add(x).multiplyScalar(0.5);this._newCamera.updateMatrixWorld(true);if(u(this._newCamera)){P.copy(this._newCamera.position);}else{x.copy(this._newCamera.position);}}this._newCamera.position.copy(P).sub(l).multiplyScalar(m).add(P);this._newCamera.updateMatrixWorld(true);}if(h.isOrthographicCamera){var B=new THREE.Box2();o.forEach(function(i){r=i.project(this._newCamera);B.expandByPoint(new THREE.Vector2(r.x,r.y));}.bind(this));this._newCamera.zoom/=Math.max(B.getSize().x,B.getSize().y)*0.5*(1+m);this._newCamera.updateProjectionMatrix();}this._startTimeForCameraAnimation=Date.now();this._timeIntervalForCameraAnimation=e!==undefined?e:500;};this.prepareForCameraUpdateAnimation=function(){this._oldCamera=v.getCamera().getCameraRef().clone();};this.startAnimatingCameraUpdate=function(d){var e=v.getCamera().getCameraRef();if(!this._oldCamera){return;}var f=0.0001;var n=false;if(e.isOrthographicCamera&&this._oldCamera.isOrthographicCamera){if(Math.abs(e.left-this._oldCamera.left)>f||Math.abs(e.right-this._oldCamera.right)>f||Math.abs(e.top-this._oldCamera.top)>f||Math.abs(e.bottom-this._oldCamera.bottom)>f||Math.abs(e.zoom-this._oldCamera.zoom)>f){n=true;}}else if(e.isPerspectiveCamera&&this._oldCamera.isPerspectiveCamera){if(Math.abs(e.fov-this._oldCamera.fov)>f||Math.abs(e.aspect-this._oldCamera.aspect)>f){n=true;}}if(!n){if(Math.abs(e.position.x-this._oldCamera.position.x)>f||Math.abs(e.position.y-this._oldCamera.position.y)>f||Math.abs(e.position.z-this._oldCamera.position.z)>f||Math.abs(e.scale.x-this._oldCamera.scale.x)>f||Math.abs(e.scale.y-this._oldCamera.scale.y)>f||Math.abs(e.scale.z-this._oldCamera.scale.z)>f||Math.abs(e.quaternion.x-this._oldCamera.quaternion.x)>f||Math.abs(e.quaternion.y-this._oldCamera.quaternion.y)>f||Math.abs(e.quaternion.z-this._oldCamera.quaternion.z)>f||Math.abs(e.quaternion.w-this._oldCamera.quaternion.w)>f){n=true;}}if(!n){v.fireCameraUpdateCompleted({position:e.position.toArray(),quaternion:e.quaternion.toArray()});return;}this._newCamera=v.getCamera().getCameraRef().clone();this._timeIntervalForCameraAnimation=d!==undefined?d:500;this._startTimeForCameraAnimation=Date.now();};};this._cameraController=new T(v);}});function g(a){var m=a;var i=m[15]===1;var r=2/m[0];var b=2/m[5];var c,d;if(i){c=-m[12]*r;d=-m[13]*b;}else{c=m[8]*r;d=m[9]*b;}var e=(r+c)*0.5;var l=c-e;var f=(b+d)*0.5;var h=d-f;return{left:l,top:f,right:e,bottom:h};}function s(a,r){var m=a;var i=m[15]===1;m[0]=2/(r.right-r.left);m[5]=2/(r.top-r.bottom);if(i){m[12]=-(r.right+r.left)/(r.right-r.left);m[13]=-(r.top+r.bottom)/(r.top-r.bottom);}else{m[8]=(r.right+r.left)/(r.right-r.left);m[9]=(r.top+r.bottom)/(r.top-r.bottom);}}V.prototype._activateRedline=function(){var c=this._viewport.getCamera().getCameraRef();this._matProj=c.projectionMatrix.elements;};V.prototype._deactivateRedline=function(){this._matProj=null;};V.prototype.destroy=function(){this._viewport=null;this._rect=null;this._evt=null;this._gesture=false;};V.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};V.prototype._inside=function(e){if(this._rect===null||true){var i=this._viewport.getIdForLabel();var d=document.getElementById(i);if(!d){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};}return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};V.prototype._onresize=function(e){this._gesture=false;this._rect=null;};V.prototype.beginGesture=function(a){if(this._inside(a)&&!this._gesture){this._gesture=true;var x=a.x-this._rect.x,y=a.y-this._rect.y;this._evt.x=x;this._evt.y=y;this._evt.d=a.d;this._evt.initd=a.d;this._evt.avgd=a.d;this._evt.avgx=0;this._evt.avgy=0;q.sap.log.debug('Loco: beginGesture: '+x+', '+y);this._cameraController.beginGesture(x,y);a.handled=true;if(document.activeElement){try{document.activeElement.blur();}catch(e){}}var d=document.getElementById(this._viewport.getIdForLabel());d.focus();}this._nomenu=false;};V.prototype.move=function(e){if(this._gesture){var x=e.x-this._rect.x,y=e.y-this._rect.y;var d=x-this._evt.x;var a=y-this._evt.y;var b=e.d-this._evt.d;this._evt.x=x;this._evt.y=y;this._evt.d=e.d;this._evt.avgx=this._evt.avgx*0.99+d*0.01;this._evt.avgy=this._evt.avgy*0.99+a*0.01;var z=1.0;if(this._evt.initd>0){z=1.0+b*(1.0/this._evt.initd);}else if(e.n===2){if(e.points[0].y>e.points[1].y){z=1.0-b*0.005;if(z<0.333){z=0.333;}}else{z=1.0+b*0.005;if(z>3){z=3;}}}if(this._evt.initd>0){var c=Math.sqrt(this._evt.avgx*this._evt.avgx+this._evt.avgy*this._evt.avgy);q.sap.log.debug('AvgDist: '+c);if((Math.abs(e.d-this._evt.avgd)/this._evt.avgd)<(c/10)){z=1.0;}}this._evt.avgd=this._evt.avgd*0.97+e.d*0.03;switch(e.n){case 1:q.sap.log.debug('Loco: Rotate: '+(d)+', '+(a));this._cameraController.rotate(d,a);break;case 2:q.sap.log.debug('Loco: Pan: '+(d)+', '+(a));if(z!=0&&z!=1.0){q.sap.log.debug('Loco: Zoom: '+(z));}this._cameraController.pan(d,a);if(d<10&&a<10&&z!=0&&z!=1.0){this._cameraController.zoom(z);}break;default:break;}this._nomenu=true;e.handled=true;}};V.prototype.endGesture=function(e){if(this._gesture){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug('Loco: endGesture: '+x+', '+y);this._cameraController.endGesture();this._gesture=false;e.handled=true;}};V.prototype.click=function(e){if(this._inside(e)&&e.buttons<=1){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug('Loco: click: '+(x)+', '+(y));if(this._viewport){this._viewport.tap(x,y,false);}e.handled=true;}};V.prototype.doubleClick=function(e){if(this._inside(e)&&e.buttons<=1){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug('Loco: doubleClick: '+(x)+', '+(y));if(this._viewport){this._viewport.tap(x,y,true);}e.handled=true;}};V.prototype.contextMenu=function(e){if(this._inside(e)||this._nomenu||e.buttons===5){this._nomenu=false;e.handled=true;}};V.prototype.keyEventHandler=function(e){};V.prototype.getViewport=function(){return this._viewport;};V.prototype._activateCamera=function(c,a){this._cameraController.prepareForCameraUpdateAnimation();if(this._viewport.getCamera().getCameraRef().isPerspectiveCamera!=c.isPerspectiveCamera){this._viewport.setCamera(c.isPerspectiveCamera?new sap.ui.vk.threejs.PerspectiveCamera():new sap.ui.vk.threejs.OrthographicCamera());}this._viewport.getCamera().getCameraRef().copy(c);var b=this._viewport.getRenderer().getSize();this._viewport.getCamera().update(b.width,b.height);this._cameraController.startAnimatingCameraUpdate(a);return this;};V.prototype.setView=function(a,b){this._cameraController.prepareForCameraUpdateAnimation();var c=this._viewport.getCamera().getCameraRef();if(a){c.quaternion.copy(a);c.updateMatrixWorld();c.up.setFromMatrixColumn(c.matrixWorld,1).normalize();this._cameraController.zoomObject(null,false,b);}else{c.copy(this._viewport._homeCamera?this._viewport._homeCamera:new sap.ui.vk.threejs.PerspectiveCamera().getCameraRef());var d=this._viewport.getRenderer().getSize();this._viewport.getCamera().update(d.width,d.height);this._cameraController.startAnimatingCameraUpdate(b);}return this;};V.prototype.zoomTo=function(b,a,m,c,n,i){this._cameraController.prepareForCameraUpdateAnimation();if(a){var d=this._viewport.getCamera().getCameraRef();d.quaternion.copy(a);d.updateMatrixWorld();d.up.setFromMatrixColumn(d.matrixWorld,1).normalize();}this._cameraController.zoomBox(b,m,c,n,i);return this;};V.prototype.zoomObject=function(n,i,a){this._cameraController.prepareForCameraUpdateAnimation();this._cameraController.zoomObject(n,i,a);return this;};V.prototype.animateCameraUpdate=function(){this._cameraController.animateCameraUpdate();};V.prototype.prepareForCameraUpdateAnimation=function(){this._cameraController.prepareForCameraUpdateAnimation();};V.prototype.startAnimatingCameraUpdate=function(a){this._cameraController.startAnimatingCameraUpdate(a);};return V;},true);\n",
	"sap/ui/vk/threejs/ViewportRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var V={};V.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapVizKitViewport');r.writeClasses();r.writeAttribute('tabindex',0);r.writeAttribute('aria-label','Image');r.addStyle('width',c.getWidth());r.addStyle('height',c.getHeight());r.writeStyles();r.write('>');var t=c.getTools();for(var i=0;i<t.length;i++){var _=sap.ui.getCore().byId(t[i]);var a=_.getGizmoForContainer(c);if(a&&a.hasDomElement()){r.renderControl(a);}}r.write('</div>');};return V;},true);\n",
	"sap/ui/vk/tools/CrossSectionTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','./CrossSectionToolHandler','./CrossSectionToolGizmo'],function(q,l,T,C,a){'use strict';var b=T.extend('sap.ui.vk.tools.CrossSectionTool',{metadata:{},constructor:function(i,s){if(b._instance){return b._instance;}T.apply(this,arguments);this._viewport=null;this._handler=null;this._gizmo=null;b._instance=this;}});b.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.threejs.Viewport']);this.setAggregation('gizmo',new a());};b.prototype.isViewportType=function(t){if(this._viewport&&this._viewport.getMetadata().getName()===t){return true;}return false;};b.prototype.setActive=function(v,c,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,c,g);}if(v){this._activateTool(c);}else{this._deactivateTool();}if(c){c.setShouldRenderFrame();}return this;};b.prototype._activateTool=function(c){this._viewport=this.getViewportImplementation(c);this._handler=new C(this);this._gizmo=this.getGizmo();if(this._gizmo){this._gizmo.show(this._viewport,this);}this._prepare();};b.prototype._deactivateTool=function(){if(this._handler){if(this._viewport._loco){this._viewport._loco.removeHandler(this._handler);}this._handler=null;}if(this._gizmo){this._gizmo.hide();this._gizmo=null;}};b.prototype._prepare=function(){var o=false;if(this._viewport._loco){this._viewport._loco.addHandler(this._handler);o=true;}return o;};b.prototype.setAxis=function(i){if(this._gizmo){this._gizmo.setAxis(i);}return this;};b.prototype.setFlip=function(f){if(this._gizmo){this._gizmo.setFlip(f);}return this;};b.prototype.queueCommand=function(c){if(this._prepare()){if(this.isViewportType('sap.ui.vk.threejs.Viewport')){c();}}return this;};b.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._handler=null;};return b;});\n",
	"sap/ui/vk/tools/CrossSectionToolGizmo.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Gizmo'],function(q,l,G){'use strict';var C=G.extend('sap.ui.vk.tools.CrossSectionToolGizmo',{metadata:{library:'sap.ui.vk.tools'}});C.prototype.init=function(){if(G.prototype.init){G.prototype.init.apply(this);}this._viewport=null;this._tool=null;this._position=new THREE.Vector3(0,0,0);this._plane=new THREE.Plane(new THREE.Vector3(0,0,1),0);this._flip=false;this._matViewProj=new THREE.Matrix4();this._pos4=new THREE.Vector4();this._gizmoSize=144;this.setAxis(0);};C.prototype.hasDomElement=function(){return false;};C.prototype.show=function(v,t){this._viewport=v;this._tool=t;var b=v._scene?v._scene._computeBoundingBox():new THREE.Box3();this._position.copy(b.getCenter());this._plane.constant=-this._plane.normal.dot(this._position);v.setClippingPlanes([this._plane]);};C.prototype.hide=function(){if(this._viewport){this._viewport.setClippingPlanes([]);this._viewport=null;}this._tool=null;};C.prototype._getOffset=function(){return this._position.getComponent(this._axis);};C.prototype.getAxis=function(){return this._axis;};C.prototype.setAxis=function(i){this._axis=i;var d=new THREE.Vector3().setComponent(i,1);this._plane.normal.set(0,0,0).setComponent(i,this._flip?-1:1);this._plane.constant=-this._plane.normal.dot(this._position);var g=new THREE.BufferGeometry();var v=new Array(15);var a=new THREE.Vector3(d.y,d.z,d.x),b=new THREE.Vector3(d.z,d.x,d.y),p=new THREE.Vector3();p.sub(a).sub(b).multiplyScalar(0.5).toArray(v,0);p.toArray(v,12);p.add(a).toArray(v,3);p.add(b).toArray(v,6);p.sub(a).toArray(v,9);g.addAttribute('position',new THREE.Float32BufferAttribute(v,3));this._gizmoPlane=new THREE.Line(g,new THREE.LineBasicMaterial({color:0xFFFFFF,transparent:true,linewidth:window.devicePixelRatio}));var c=144,e=window.devicePixelRatio*0.5,f=32,h=6,t=48;d=this._plane.normal.clone().multiplyScalar(1/c);var j=0xFF<<(8*(2-i));var k=new THREE.CylinderBufferGeometry(e,e,c-f,4);var m=new THREE.Matrix4().makeBasis(new THREE.Vector3(d.y,d.z,d.x),d,new THREE.Vector3(d.z,d.x,d.y));m.setPosition(d.clone().multiplyScalar((c-f)*0.5));k.applyMatrix(m);this._gizmoArrow=new THREE.Mesh(k,new THREE.MeshBasicMaterial({color:j}));this._gizmoArrow.userData.color=j;var n=new THREE.CylinderBufferGeometry(0,h,f,12,1);m.setPosition(d.clone().multiplyScalar(c-f*0.5));n.applyMatrix(m);var o=new THREE.Mesh(n,new THREE.MeshBasicMaterial({color:j}));o.matrixAutoUpdate=false;this._gizmoArrow.add(o);var r=new THREE.CylinderGeometry(t*0.5,t*0.5,c,12,1);m.setPosition(d.clone().multiplyScalar(c*0.5));r.applyMatrix(m);this._touchMesh=new THREE.Mesh(r,new THREE.MeshBasicMaterial({visible:false,side:THREE.DoubleSide}));this._gizmoArrow.add(this._touchMesh);if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};C.prototype.setFlip=function(f){this._flip=!!f;this.setAxis(this._axis);return this;};C.prototype.getTouchObject=function(){return this._touchMesh;};C.prototype._setOffset=function(o){var b=this._viewport._scene._computeBoundingBox();o=THREE.Math.clamp(o,b.min.getComponent(this._axis),b.max.getComponent(this._axis));this._position.setComponent(this._axis,o);this._plane.constant=-this._plane.normal.dot(this._position);this._viewport.setShouldRenderFrame();};C.prototype.highlightArrowHandle=function(h){var c=h?0xFFFF00:this._gizmoArrow.userData.color;this._gizmoArrow.material.color.setHex(c);this._gizmoArrow.children[0].material.color.setHex(c);};C.prototype._adjustBoundingBox=function(b){var s=b.getSize();var d=Math.max(s.x,s.y,s.z)*0.2;b.expandByScalar(d);};C.prototype._updateGizmo=function(b){var i=this._axis;var o=THREE.Math.clamp(this._position.getComponent(i),b.min.getComponent(i),b.max.getComponent(i));this._position.setComponent(i,o);this._plane.constant=-this._plane.normal.dot(this._position);this._adjustBoundingBox(b);this._gizmoPlane.position.copy(b.getCenter());this._gizmoPlane.position.setComponent(i,o);this._gizmoPlane.scale.copy(b.getSize());this._gizmoPlane.updateMatrixWorld(true);var r=this._viewport.getRenderer(),c=this._viewport.getCamera().getCameraRef();this._gizmoArrow.position.copy(this._gizmoPlane.position);this._matViewProj.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);this._pos4.copy(this._gizmoArrow.position).applyMatrix4(this._matViewProj);var s=this._gizmoSize*this._pos4.w*r.getPixelRatio()/(r.getSize().width*c.projectionMatrix.elements[0]);this._gizmoArrow.scale.setScalar(s);this._gizmoArrow.updateMatrixWorld(true);};C.prototype.expandBoundingBox=function(b){if(this._viewport){var s=this._viewport._scene._computeBoundingBox();this._updateGizmo(s);b.min.min(s.min);b.max.max(s.max);b.expandByPoint(this._plane.normal.clone().multiply(this._gizmoArrow.scale).add(this._gizmoArrow.position));}};C.prototype.render=function(){var s=this._viewport._scene._computeBoundingBox();this._updateGizmo(s);var r=this._viewport.getRenderer(),c=this._viewport.getCamera().getCameraRef();r.render(this._gizmoPlane,c);r.clearDepth();r.render(this._gizmoArrow,c);};C.prototype.onBeforeRendering=function(){};C.prototype.onAfterRendering=function(){};return C;},true);\n",
	"sap/ui/vk/tools/CrossSectionToolHandler.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var C=E.extend('sap.ui.vk.tools.CrossSectionToolHandler',{metadata:{},constructor:function(t){this._tool=t;this._gizmo=t.getGizmo();this._rect=null;this._mouse=new THREE.Vector2();this._rayCaster=new THREE.Raycaster();this._rayCaster.linePrecision=0;this._gizmoOrigin=new THREE.Vector3();this._gizmoAxis=new THREE.Vector3();}});C.prototype.destroy=function(){this._tool=null;this._gizmo=null;this._rect=null;this._rayCaster=null;this._gizmoAxis=null;this._gizmoOrigin=null;this._mouse=null;};C.prototype._updateRayCaster=function(e){var s=this.getViewport().getRenderer().getSize();this._mouse.x=((e.x-this._rect.x)/s.width)*2-1;this._mouse.y=((e.y-this._rect.y)/s.height)*-2+1;this._rayCaster.setFromCamera(this._mouse,this.getViewport().getCamera().getCameraRef());};C.prototype._updateArrowHandle=function(e){var t=this._gizmo.getTouchObject();var i=this._rayCaster.intersectObject(t,true);var a=i.length>0?this._gizmo.getAxis():-1;if(a!==this._axisIndex){this._axisIndex=a;this._gizmo.highlightArrowHandle(a>=0);if(a>=0){this._gizmoOrigin.setFromMatrixPosition(t.matrixWorld);this._gizmoAxis.setScalar(0).setComponent(this._axisIndex,1);}this.getViewport().setShouldRenderFrame();}};C.prototype._getAxisOffset=function(){var r=this._rayCaster.ray;var d=this._gizmoAxis.clone().cross(r.direction).cross(r.direction).normalize();var a=r.origin.clone().sub(this._gizmoOrigin);return d.dot(a)/d.dot(this._gizmoAxis);};C.prototype.hover=function(e){if(this._inside(e)&&!this._gesture&&e.n===1){this._updateRayCaster(e);this._updateArrowHandle(e);}};C.prototype.beginGesture=function(e){if(this._inside(e)&&!this._gesture&&e.n===1){this._updateRayCaster(e);this._updateArrowHandle(e);if(this._axisIndex>=0&&e.n===1){this._gesture=true;e.handled=true;this._dragOrigin=this._getAxisOffset()-this._gizmo._getOffset();}}};C.prototype.move=function(e){if(this._gesture){e.handled=true;this._updateRayCaster(e);if(!isNaN(this._dragOrigin)){this._gizmo._setOffset(this._getAxisOffset()-this._dragOrigin);}}};C.prototype.endGesture=function(e){if(this._gesture){this._gesture=false;e.handled=true;this._updateRayCaster(e);this._updateArrowHandle(e);}};C.prototype.click=function(e){};C.prototype.doubleClick=function(e){};C.prototype.contextMenu=function(e){};C.prototype.getViewport=function(){return this._tool._viewport;};C.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};C.prototype._inside=function(e){if(this._rect===null||true){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d===null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};}return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};return C;},true);\n",
	"sap/ui/vk/tools/Gizmo.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Control'],function(q,a,C){'use strict';var G=C.extend('sap.ui.vk.tools.Gizmo',{metadata:{library:'sap.ui.vk.tools'}});G.prototype.hasDomElement=function(){return true;};G.prototype._createAxisTitles=function(s,f,d){s=s||32;f=f||20;function c(t,b){var e=document.createElement('canvas');e.width=e.height=s*window.devicePixelRatio;var h=e.getContext('2d');var i=e.width*0.5;h.font='Bold '+f*window.devicePixelRatio+'px Arial';h.textAlign='center';h.textBaseline='middle';h.fillStyle='#000';h.globalAlpha=0.5;h.filter='blur(3px)';h.fillText(t,i+1,i+1);h.fillStyle='#fff';h.globalAlpha=1;h.filter='blur(0px)';h.fillText(t,i,i);if(d){h.beginPath();h.arc(i,i,i-window.devicePixelRatio,0,2*Math.PI,false);h.closePath();h.lineWidth=window.devicePixelRatio*2;h.strokeStyle='#fff';h.stroke();}var j=new THREE.Texture(e);j.needsUpdate=true;var m=new THREE.MeshBasicMaterial({map:j,color:b,transparent:true,alphaTest:0.05,premultipliedAlpha:true,side:THREE.DoubleSide});var k=new THREE.Mesh(new THREE.PlaneGeometry(s,s),m);k.userData.color=b;return k;}var g=new THREE.Group();g.add(c('X',0xFF0000));g.add(c('Y',0x00FF00));g.add(c('Z',0x0000FF));return g;};G.prototype._extractBasis=function(m){var b=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()];m.extractBasis(b[0],b[1],b[2]);b[0].normalize();b[1].normalize();b[2].normalize();return b;};G.prototype._updateAxisTitles=function(o,g,c,d,s){var b=this._extractBasis(g.matrixWorld);o.children.forEach(function(e,i){e.position.copy(b[i]).multiplyScalar(d.constructor===THREE.Vector3?d.getComponent(i):d);e.quaternion.copy(c.quaternion);});o.position.copy(g.position);o.scale.setScalar(s);};G.prototype._updateSelection=function(b){var n=[];b.enumerateSelection(function(c){n.push({node:c});});if(this._nodes.length===n.length&&this._nodes.every(function(v,i){return n[i].node===v.node;})){return false;}this._nodes=n;n.forEach(function(c){c.ignore=false;var p=c.node.parent;while(p&&!c.ignore){for(var i=0,l=n.length;i<l;i++){if(n[i].node===p){c.ignore=true;break;}}p=p.parent;}});return true;};G.prototype._updateGizmoObjectTransformation=function(o,i){var r=this._viewport.getRenderer(),c=this._viewport.getCamera().getCameraRef();var p,s;if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local){var n=this._nodes[i].node;o.matrixAutoUpdate=false;n.matrixWorld.decompose(o.position,o.quaternion,o.scale);p=new THREE.Vector4().copy(o.position).applyMatrix4(this._matViewProj);s=p.w*r.getPixelRatio()/(r.getSize().width*c.projectionMatrix.elements[0]);var b=this._extractBasis(n.matrixWorld);o.matrix.makeBasis(b[0],b[1],b[2]);o.matrix.scale(new THREE.Vector3().setScalar(this._gizmoSize*s));o.matrix.copyPosition(n.matrixWorld);}else if(this._nodes.length>0){o.matrixAutoUpdate=true;if(this._nodes.length===1){o.position.setFromMatrixPosition(this._nodes[0].node.matrixWorld);}else{o.position.setScalar(0);var d=new THREE.Vector3();this._nodes.forEach(function(e){var n=e.node;if(n.userData.boundingBox){n.userData.boundingBox.getCenter(d);o.position.add(d.applyMatrix4(n.matrixWorld));}else{o.position.add(d.setFromMatrixPosition(n.matrixWorld));}});o.position.multiplyScalar(1/this._nodes.length);}if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Screen){o.quaternion.copy(c.quaternion);}else if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.World){o.quaternion.set(0,0,0,1);}p=new THREE.Vector4().copy(o.position).applyMatrix4(this._matViewProj);s=p.w*r.getPixelRatio()/(r.getSize().width*c.projectionMatrix.elements[0]);o.scale.setScalar(this._gizmoSize*s);}o.updateMatrixWorld(true);return s;};G.prototype._expandBoundingBox=function(b,c){var g=this.getGizmoCount();if(g>0){this._matViewProj.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);for(var i=0;i<g;i++){this._updateGizmoTransformation(i,c);this._sceneGizmo._expandBoundingBox(b,true);}}};return G;},true);\n",
	"sap/ui/vk/tools/HitTestTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['./Tool','./HitTestToolHandler'],function(T,H){'use strict';var a=T.extend('sap.ui.vk.tools.HitTestTool',{metadata:{properties:{IdMode:{type:'sap.ui.vk.tools.HitTestIdMode',defaultValue:sap.ui.vk.tools.HitTestIdMode.ThreeJS}},events:{hit:{parameters:{id:'any',object:'any',point:'any',clickType:'sap.ui.vk.tools.HitTestClickType'}}}},constructor:function(i,s){if(a._instance){return a._instance;}T.apply(this,arguments);this.setToolid('63150593-75f6-c330-2a7a-c1f85d36b2b9');this._viewport=null;this._handler=null;this._loco=null;a._instance=this;}});a.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.threejs.Viewport']);};a.prototype.setActive=function(v,b,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,b,g);}if(v){this._activateTool(b);}else{this._deactivateTool();}return this;};a.prototype._activateTool=function(b){this._viewport=this.getViewportImplementation(b);this._handler=new H(this);this._prepare();};a.prototype._deactivateTool=function(){if(this._handler){this._viewport._loco.removeHandler(this._handler);}this._handler=null;};a.prototype._prepare=function(){var o=false;if(this._viewport._loco){this._viewport._loco.addHandler(this._handler);o=true;}if(o){if(this.isViewportType('sap.ui.vk.dvl.Viewport')&&this._viewport._dvl){this._dvlRendererId=this._viewport._dvlRendererId;this._dvl=this._viewport._dvl;o=true;}else if(this.isViewportType('sap.ui.vk.threejs.Viewport')&&(this._viewport._scene&&this._viewport._scene.getSceneRef())){o=true;}}return o;};a.prototype.queueCommand=function(c){if(this._prepare()){if(this._dvlRendererId){this._dvl.Renderer._queueCommand(c,this._dvlRendererId);}}return this;};a.prototype.hitTest=function(x,y,s,c,b){if(this._prepare()){var h=null;if(this.isViewportType('sap.ui.vk.dvl.Viewport')&&this._viewport._dvl){return null;}else if(this.isViewportType('sap.ui.vk.threejs.Viewport')){if(!s||!c){h=null;}else if(this._viewport._renderer){var e=this._viewport._renderer.domElement;var m=new THREE.Vector2((x-e.offsetLeft)/e.clientWidth*2-1,(e.offsetTop-y)/e.clientHeight*2+1);var r=new THREE.Raycaster();r.setFromCamera(m,c.getCameraRef());var i=r.intersectObjects(s.getSceneRef().children,true);if(i&&i.length){h=i[0];}}}var d=null;if(h){var f;switch(this.getIdMode()){case sap.ui.vk.tools.HitTestIdMode.VEsID:f=this._viewport._scene.nodeRefToPersistentId(h.object);break;case sap.ui.vk.tools.HitTestIdMode.ThreeJS:f=h.object.id;break;default:f=h.object.id;break;}d={id:f,object:h.object,point:h.point,clickType:b};this.fireHit(d);}return d;}};a.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._handler=null;};return a;});\n",
	"sap/ui/vk/tools/HitTestToolHandler.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var H=E.extend('sap.ui.vk.tools.HitTestToolHandler',{metadata:{},constructor:function(T){this._tool=T;this._rect=null;this._gesture=false;this._nomenu=false;}});H.prototype.destroy=function(){this._tool=null;this._rect=null;this._gesture=false;};H.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};H.prototype._inside=function(e){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d==null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};H.prototype.beginGesture=function(e){e.handled=false;};H.prototype.move=function(e){e.handled=false;};H.prototype.endGesture=function(e){e.handled=false;};H.prototype._executeHittest=function(e,c){if(this._inside(e)&&!this._gesture){this._gesture=false;var x=e.x-this._rect.x,y=e.y-this._rect.y;this._gizmo=this._tool.getGizmo();if(this._gizmo){this._gizmo.show(this._tool._viewport);this._gizmo.moveGizmo(x,y);}var s=this._tool._viewport.getScene();var a=this._tool._viewport.getCamera();this._tool.hitTest(x,y,s,a,c);if(this._gizmo){this._gizmo.hide();}}};H.prototype.click=function(e){this._executeHittest(e,sap.ui.vk.tools.HitTestClickType.Single);e.handled=true;};H.prototype.doubleClick=function(e){this._executeHittest(e,sap.ui.vk.tools.HitTestClickType.Double);e.handled=false;};H.prototype.contextMenu=function(e){this._executeHittest(e,sap.ui.vk.tools.HitTestClickType.Context);e.handled=false;};H.prototype.getViewport=function(){return this._tool._viewport;};return H;},true);\n",
	"sap/ui/vk/tools/MoveTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','./MoveToolHandler','./MoveToolGizmo'],function(q,l,T,M,a){'use strict';var b=T.extend('sap.ui.vk.tools.MoveTool',{metadata:{events:{moving:{parameters:{x:'float',y:'float',z:'float'}},moved:{parameters:{x:'float',y:'float',z:'float'}}}},constructor:function(i,s){T.apply(this,arguments);this._viewport=null;this._handler=null;this._gizmo=null;}});b.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.threejs.Viewport']);this.setAggregation('gizmo',new a());};b.prototype.isViewportType=function(t){if(this._viewport&&this._viewport.getMetadata().getName()===t){return true;}return false;};b.prototype.setActive=function(v,c,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,c,g);}if(v){this._activateTool(c);}else{this._deactivateTool();}if(c){c.setShouldRenderFrame();}return this;};b.prototype._activateTool=function(c){this._viewport=this.getViewportImplementation(c);this._handler=new M(this);this._gizmo=this.getGizmo();if(this._gizmo){this._gizmo.show(this._viewport,this);}this._prepare();};b.prototype._deactivateTool=function(){if(this._handler){if(this._viewport._loco){this._viewport._loco.removeHandler(this._handler);}this._handler=null;}if(this._gizmo){this._gizmo.hide();this._gizmo=null;}};b.prototype._prepare=function(){var o=false;if(this._viewport._loco){this._viewport._loco.addHandler(this._handler);o=true;}return o;};b.prototype.queueCommand=function(c){if(this._prepare()){if(this.isViewportType('sap.ui.vk.threejs.Viewport')){c();}}return this;};b.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._handler=null;};b.prototype.getCoordinateSystem=function(){return this.getGizmo().getCoordinateSystem();};b.prototype.setCoordinateSystem=function(v){this.getGizmo().setCoordinateSystem(v);if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};b.prototype.move=function(v){if(this._gizmo){this._gizmo.move(v);}if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};return b;});\n",
	"sap/ui/vk/tools/MoveToolGizmo.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Gizmo'],function(q,c,G){'use strict';var M=G.extend('sap.ui.vk.tools.MoveToolGizmo',{metadata:{library:'sap.ui.vk.tools'}});M.prototype.init=function(){if(G.prototype.init){G.prototype.init.apply(this);}this._viewport=null;this._tool=null;this._sceneGizmo=new THREE.Scene();this._gizmo=new THREE.Group();this._touchAreas=new THREE.Group();this._sceneGizmo.add(this._gizmo);this._coordinateSystem=sap.ui.vk.tools.CoordinateSystem.Local;this._nodes=[];this._matViewProj=new THREE.Matrix4();this._gizmoSize=144;this._gizmoOffset=new THREE.Vector3();function d(a,b,t){var f=144,l=window.devicePixelRatio*0.5,h=32,i=6,j=48;a.multiplyScalar(1/f);var k=new THREE.CylinderBufferGeometry(l,l,f-h,4);var m=new THREE.Matrix4().makeBasis(new THREE.Vector3(a.y,a.z,a.x),a,new THREE.Vector3(a.z,a.x,a.y));m.setPosition(a.clone().multiplyScalar((f-h)*0.5));k.applyMatrix(m);var n=new THREE.Mesh(k,new THREE.MeshBasicMaterial({color:b,transparent:true}));n.matrixAutoUpdate=false;n.userData.color=b;var o=new THREE.CylinderBufferGeometry(0,i,h,12,1);m.setPosition(a.clone().multiplyScalar(f-h*0.5));o.applyMatrix(m);var p=new THREE.Mesh(o,new THREE.MeshBasicMaterial({color:b,transparent:true}));p.matrixAutoUpdate=false;n.add(p);var r=new THREE.CylinderGeometry(j*0.5,j*0.5,j,12,1);r.applyMatrix(m);var s=new THREE.CylinderGeometry(j*0.5,j*0.2,j,12,1);m.setPosition(a.clone().multiplyScalar(f*0.5));r.merge(s,m);t.add(new THREE.Mesh(r,new THREE.MeshBasicMaterial()));return n;}function e(a,b,t){var f=new Float32Array(9);f[a]=f[b+6]=1;f[a+3]=f[b+3]=0.5;var v=new THREE.Vector3().setComponent(a,0.333);var h=new THREE.Vector3().setComponent(b,0.333);var g=new THREE.Geometry();g.vertices.push(new THREE.Vector3(),v,h,v.clone().add(h));g.faces.push(new THREE.Face3(0,2,1),new THREE.Face3(1,2,3));var m=new THREE.MeshBasicMaterial({color:0xFFFF00,opacity:0.5,transparent:true,visible:false,side:THREE.DoubleSide});var p=new THREE.Mesh(g,m);p.matrixAutoUpdate=false;p.userData.colors=f;var l=new THREE.BufferGeometry();var i=new Float32Array(9);i[a]=i[a+3]=i[b+3]=i[b+6]=0.333;l.addAttribute('position',new THREE.Float32BufferAttribute(i,3));l.addAttribute('color',new THREE.Float32BufferAttribute(f,3));var j=new THREE.Line(l,new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,transparent:true,linewidth:window.devicePixelRatio}));j.matrixAutoUpdate=false;p.add(j);var k=new THREE.Geometry();k.vertices.push(new THREE.Vector3(),v,h,v.clone().add(h));k.faces.push(new THREE.Face3(0,1,2),new THREE.Face3(2,1,3));t.add(new THREE.Mesh(k,new THREE.MeshBasicMaterial({side:THREE.DoubleSide})));return p;}this._gizmo.add(d(new THREE.Vector3(1,0,0),0xFF0000,this._touchAreas));this._gizmo.add(d(new THREE.Vector3(0,1,0),0x00FF00,this._touchAreas));this._gizmo.add(d(new THREE.Vector3(0,0,1),0x0000FF,this._touchAreas));this._gizmo.add(e(1,2,this._touchAreas));this._gizmo.add(e(2,0,this._touchAreas));this._gizmo.add(e(0,1,this._touchAreas));this._axisTitles=this._createAxisTitles();this._sceneGizmo.add(this._axisTitles);var g=new THREE.Geometry();g.vertices.push(new THREE.Vector3(),new THREE.Vector3());this._line=new THREE.LineSegments(g,new THREE.LineBasicMaterial());this._line.frustumCulled=false;this._line.visible=false;this._gizmo.add(this._line);};M.prototype.hasDomElement=function(){return false;};M.prototype.getCoordinateSystem=function(){return this._coordinateSystem;};M.prototype.setCoordinateSystem=function(a){this._coordinateSystem=a;var s=a===sap.ui.vk.tools.CoordinateSystem.Screen;var g=this._gizmo.children,t=this._touchAreas.children;g[2].visible=g[3].visible=g[4].visible=!s;t[2].visible=t[3].visible=t[4].visible=!s;this._axisTitles.children[2].visible=!s;};M.prototype.show=function(v,t){this._viewport=v;this._tool=t;this._nodes.length=0;this._updateSelection(v._viewStateManager);};M.prototype.hide=function(){this._viewport=null;this._tool=null;};M.prototype.getGizmoCount=function(){if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local){return this._nodes.length;}else{return this._nodes.length>0?1:0;}};M.prototype.getTouchObject=function(i){if(this._nodes.length===0){return null;}this._updateGizmoObjectTransformation(this._touchAreas,i);return this._touchAreas;};M.prototype.highlightHandle=function(a,h){var i,b=[];for(i=0;i<3;i++){var d=this._gizmo.children[i];var e=(a<3?i===a:((i===(a+1)%3)||(i===(a+2)%3)));b[i]=e;var f=e?0xFFFF00:d.userData.color;d.material.color.setHex(f);d.material.opacity=(e||h)?1:0.35;d.children[0].material.color.setHex(f);d.children[0].material.opacity=(e||h)?1:0.35;}for(i=3;i<6;i++){var p=this._gizmo.children[i];p.material.visible=i===a;var g=p.children[0].geometry.attributes.color;if(i===a){g.copyArray([1,1,0,1,1,0,1,1,0]);}else{g.copyArray(p.userData.colors);}g.needsUpdate=true;p.children[0].material.opacity=(i===a||h)?1:0.35;}this._axisTitles.children.forEach(function(o,i){o.material.color.setHex(b[i]?0xFFFF00:o.userData.color);o.material.opacity=b[i]||h?1:0.35;});};M.prototype.beginGesture=function(){this._matOrigin=this._gizmo.matrixWorld.clone();this._nodes.forEach(function(n){var a=n.node;n.matOrigin=a.matrixWorld.clone();n.originLocal=a.position.clone();n.origin=new THREE.Vector3().setFromMatrixPosition(a.matrixWorld);n.matParentInv=new THREE.Matrix4().getInverse(a.parent.matrixWorld);});};M.prototype.endGesture=function(){this._line.visible=false;this._tool.fireMoved({x:this._gizmoOffset.x,y:this._gizmoOffset.y,z:this._gizmoOffset.z});};M.prototype._setOffset=function(o,g){if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local){var n=this._nodes[g];var m=new THREE.Matrix4().getInverse(n.node.matrixWorld);var s=new THREE.Vector3().setFromMatrixScale(n.node.matrixWorld);var a=n.origin.clone().applyMatrix4(m);o=n.origin.clone().add(o).applyMatrix4(m).sub(a).multiply(s);}else if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Screen){var b=this._viewport.getRenderer().getSize();var p=this._gizmo.position.clone().applyMatrix4(this._matViewProj);var d=this._gizmo.position.clone().add(o).applyMatrix4(this._matViewProj);o.set(Math.round((d.x-p.x)*0.5*b.width),Math.round((d.y-p.y)*0.5*b.height),0);}if(this._tool.fireEvent('moving',{x:o.x,y:o.y,z:o.z},true)){this._move(o);if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Screen){o.set(new THREE.Vector3().setFromMatrixColumn(this._matOrigin,0).normalize().dot(o),new THREE.Vector3().setFromMatrixColumn(this._matOrigin,1).normalize().dot(o),0);}this._line.geometry.vertices[0].setScalar(0).sub(o);this._line.geometry.verticesNeedUpdate=true;this._line.geometry.computeBoundingBox();o.set(Math.abs(o.x),Math.abs(o.y),Math.abs(o.z));o.multiplyScalar(1/Math.max(o.x,o.y,o.z));this._line.material.color.setRGB(o.x,o.y,o.z);this._line.visible=true;}};M.prototype._move=function(o){this._gizmoOffset.copy(o);if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local){this._nodes.forEach(function(n){var f=n.node;var g=this._extractBasis(f.matrixWorld);var p=n.origin.clone();p.add(g[0].multiplyScalar(o.x)).add(g[1].multiplyScalar(o.y)).add(g[2].multiplyScalar(o.z));f.matrixWorld.setPosition(p);f.matrix.multiplyMatrices(n.matParentInv,f.matrixWorld);f.position.setFromMatrixPosition(f.matrix);}.bind(this));this._viewport._updateBoundingBoxesIfNeeded();}else{if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Screen){var s=this._viewport.getRenderer().getSize();var a=this._viewport.getCamera().getCameraRef();var b=new THREE.Vector4().copy(this._gizmo.position).applyMatrix4(this._matViewProj);var d=o.x*2*b.w/(a.projectionMatrix.elements[0]*s.width);var e=o.y*2*b.w/(a.projectionMatrix.elements[5]*s.height);o.setFromMatrixColumn(a.matrixWorld,0).multiplyScalar(d);o.add(new THREE.Vector3().setFromMatrixColumn(a.matrixWorld,1).multiplyScalar(e));}this._gizmo.position.setFromMatrixPosition(this._matOrigin).add(o);this._nodes.forEach(function(n){if(!n.ignore){var f=n.node;f.matrixWorld.setPosition(n.origin.clone().add(o));f.matrix.multiplyMatrices(n.matParentInv,f.matrixWorld);f.position.setFromMatrixPosition(f.matrix);}});}this._viewport.setShouldRenderFrame();};M.prototype.move=function(o){this.beginGesture();this._move(new THREE.Vector3(o.x,o.y,o.z||0));};M.prototype.expandBoundingBox=function(b){if(this._viewport){this._expandBoundingBox(b,this._viewport.getCamera().getCameraRef());}};M.prototype.handleSelectionChanged=function(e){if(this._viewport){this._updateSelection(this._viewport._viewStateManager);}};M.prototype._updateGizmoTransformation=function(i,a){var s=this._updateGizmoObjectTransformation(this._gizmo,i);this._updateAxisTitles(this._axisTitles,this._gizmo,a,this._gizmoSize+18,s);this._line.scale.setScalar(1/(this._gizmoSize*s));};M.prototype.render=function(){if(this._nodes.length>0){var r=this._viewport.getRenderer(),a=this._viewport.getCamera().getCameraRef();this._matViewProj.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse);r.clearDepth();for(var i=0,l=this.getGizmoCount();i<l;i++){this._updateGizmoTransformation(i,a);r.render(this._sceneGizmo,a);}}};M.prototype.onBeforeRendering=function(){};M.prototype.onAfterRendering=function(){};return M;},true);\n",
	"sap/ui/vk/tools/MoveToolHandler.js":"sap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var M=E.extend('sap.ui.vk.tools.MoveToolHandler',{metadata:{},constructor:function(t){this._tool=t;this._gizmo=t.getGizmo();this._rect=null;this._rayCaster=new THREE.Raycaster();this._handleIndex=-1;this._gizmoIndex=-1;this._handleAxis=new THREE.Vector3();this._gizmoOrigin=new THREE.Vector3();this._mouse=new THREE.Vector2();}});M.prototype.destroy=function(){this._tool=null;this._gizmo=null;this._rect=null;this._rayCaster=null;this._handleAxis=null;this._gizmoOrigin=null;this._mouse=null;};M.prototype._updateMouse=function(e){var s=this.getViewport().getRenderer().getSize();this._mouse.x=((e.x-this._rect.x)/s.width)*2-1;this._mouse.y=((e.y-this._rect.y)/s.height)*-2+1;this._rayCaster.setFromCamera(this._mouse,this.getViewport().getCamera().getCameraRef());};M.prototype._updateHandles=function(e,h){var p=this._handleIndex;this._handleIndex=-1;for(var i=0,l=this._gizmo.getGizmoCount();i<l;i++){var t=this._gizmo.getTouchObject(i);var a=this._rayCaster.intersectObject(t,true);if(a.length>0){this._handleIndex=t.children.indexOf(a[0].object);if(this._handleIndex>=0){this._gizmoIndex=i;this._gizmoOrigin.setFromMatrixPosition(t.matrixWorld);if(this._handleIndex<3){this._handleAxis.setFromMatrixColumn(t.matrixWorld,this._handleIndex).normalize();}else if(this._handleIndex<6){this._handleAxis.setFromMatrixColumn(t.matrixWorld,this._handleIndex-3).normalize();}}}}this._gizmo.highlightHandle(this._handleIndex,h||this._handleIndex===-1);if(p!==this._handleIndex){this.getViewport().setShouldRenderFrame();}};M.prototype.hover=function(e){if(this._inside(e)&&!this._gesture){this._updateMouse(e);this._updateHandles(e,true);e.handled|=this._handleIndex>0;}};M.prototype._getAxisOffset=function(){var r=this._rayCaster.ray;var d=this._handleAxis.clone().cross(r.direction).cross(r.direction).normalize();var a=r.origin.clone().sub(this._gizmoOrigin);return d.dot(a)/d.dot(this._handleAxis);};M.prototype._getPlaneOffset=function(){var r=this._rayCaster.ray;var d=this._gizmoOrigin.clone().sub(r.origin);var a=this._handleAxis.dot(d)/this._handleAxis.dot(r.direction);return r.direction.clone().multiplyScalar(a).sub(d);};M.prototype.beginGesture=function(e){if(this._inside(e)&&!this._gesture){this._updateMouse(e);this._updateHandles(e,false);if(this._handleIndex>=0&&e.n===1){this._gesture=true;e.handled=true;this._gizmo.beginGesture();if(this._handleIndex<3){this._dragOrigin=this._getAxisOffset();}else if(this._handleIndex<6){this._dragOrigin=this._getPlaneOffset();}}}};M.prototype.move=function(e){if(this._gesture){e.handled=true;this._updateMouse(e);if(this._handleIndex<3){if(!isNaN(this._dragOrigin)){this._gizmo._setOffset(this._handleAxis.clone().multiplyScalar(this._getAxisOffset()-this._dragOrigin),this._gizmoIndex);}}else if(this._handleIndex<6){if(!isNaN(this._dragOrigin.x)&&!isNaN(this._dragOrigin.y)&&!isNaN(this._dragOrigin.z)){this._gizmo._setOffset(this._getPlaneOffset().sub(this._dragOrigin),this._gizmoIndex);}}}};M.prototype.endGesture=function(e){if(this._gesture){this._gesture=false;e.handled=true;this._updateMouse(e);this._gizmo.endGesture();this._dragOrigin=undefined;this._updateHandles(e,true);this.getViewport().setShouldRenderFrame();}};M.prototype.click=function(e){};M.prototype.doubleClick=function(e){};M.prototype.contextMenu=function(e){};M.prototype.getViewport=function(){return this._tool._viewport;};M.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};M.prototype._inside=function(e){if(this._rect===null||true){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d===null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};}return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};return M;},true);\n",
	"sap/ui/vk/tools/RectSelectTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','./RectSelectToolHandler','sap/ui/vk/Loco'],function(q,a,T,R,L){'use strict';var b=T.extend('sap.ui.vk.tools.RectSelectTool',{metadata:{properties:{subtractMode:{type:'boolean',defaultValue:false}}},constructor:function(i,s){if(b._instance){return b._instance;}T.apply(this,arguments);this._viewport=null;this._handler=new R(this);this._loco=null;b._instance=this;}});b.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.dvl.Viewport','sap.ui.vk.threejs.Viewport']);};b.prototype.setActive=function(v,d,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,d,g);}if(v){this._activateTool(d);}else{this._deactivateTool();}if(d){d.setShouldRenderFrame();}return this;};b.prototype._activateTool=function(d){this._viewport=this.getViewportImplementation(d);if(this._prepare()){this._handler.activate(this._viewport);}};b.prototype._deactivateTool=function(){this._handler.deactivate();};b.prototype._prepare=function(){if(this.isViewportType('sap.ui.vk.dvl.Viewport')&&this._viewport._dvl){return true;}else if(this.isViewportType('sap.ui.vk.threejs.Viewport')&&this._viewport._scene&&this._viewport._scene.getSceneRef()){return true;}else{return false;}};b.prototype.queueCommand=function(d){if(this._prepare()){if(this.isViewportType('sap.ui.vk.threejs.Viewport')){d();}}return this;};function c(d,e,v){var m=d.elements;var i=m[15]===1;var r=2/m[0];var t=2/m[5];var f,g;if(i){f=-m[12]*r;g=-m[13]*t;}else{f=m[8]*r;g=m[9]*t;}var h=(r+f)*0.5;var l=f-h;var j=(t+g)*0.5;var k=g-j;var n=THREE.Math.lerp(l,h,Math.min(e.x1,e.x2)/v.width);var o=THREE.Math.lerp(l,h,Math.max(e.x1,e.x2)/v.width);var p=THREE.Math.lerp(j,k,Math.min(e.y1,e.y2)/v.height);var s=THREE.Math.lerp(j,k,Math.max(e.y1,e.y2)/v.height);m[0]=2/(o-n);m[5]=2/(p-s);if(i){m[12]=-(o+n)/(o-n);m[13]=-(p+s)/(p-s);}else{m[8]=(o+n)/(o-n);m[9]=(p+s)/(p-s);}}b.prototype.select=function(x,y,d,e,s,f){var n=[];if(!this._prepare()){return n;}if(this.isViewportType('sap.ui.vk.dvl.Viewport')){n=this._viewport.rectSelect(x,y,d,e);if(n.length>0){var p={picked:n};this._viewport.fireNodesPicked(p);if(this.getSubtractMode()){this._viewport._viewStateManager.setSelectionStates([],n);}else{this._viewport._viewStateManager.setSelectionStates(n,[]);}}return n;}var g=s?s.getSceneRef():undefined;var h=f?f.getCameraRef():undefined;var v=this._viewport._getViewStateManagerThreeJS();if(!h||!g||!v||x===d||y===e){return n;}var r={x1:x,y1:y,x2:d,y2:e};var m=h.projectionMatrix.clone();c(m,r,this._viewport._renderer.getSize());var j=new THREE.Matrix4().multiplyMatrices(m,h.matrixWorldInverse);var k=new THREE.Frustum().setFromMatrix(j);var o=new THREE.Vector3();function t(z){var A=z.geometry;if(A!==undefined&&k.intersectsObject(z)){var i,l=0;if(A.isGeometry){var B=A.vertices;for(i=0,l=B.length;i<l;i++){o.copy(B[i]).applyMatrix4(z.matrixWorld);if(!k.containsPoint(o)){break;}}}else if(A.isBufferGeometry){var C=A.attributes.position;if(C!==undefined){for(i=0,l=C.count;i<l;i++){o.fromBufferAttribute(C,i).applyMatrix4(z.matrixWorld);if(!k.containsPoint(o)){break;}}}}return l>0&&i===l;}return false;}function u(l){if(l.visible===false){return;}var z=0,A=0;if(l.geometry!==undefined){z++;if(t(l)){A++;}}var B=l.children;if(B.length>0){for(var i=0;i<B.length;i++){var C=B[i];if(C.geometry!==undefined&&!C.name&&C.children.length===0){if(C.visible===true){z++;if(t(C)){A++;}}}else{u(C);}}}if(A>0&&z===A){n.push(l);}}u(g);if(n.length>0){var w={picked:n};this._viewport.fireNodesPicked(w);if(this.getSubtractMode()){v.setSelectionStates([],n);}else{v.setSelectionStates(n,[]);}}return n;};b.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._handler=null;};return b;});\n",
	"sap/ui/vk/tools/RectSelectToolHandler.js":"sap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var R=E.extend('sap.ui.vk.tools.RectSelectToolHandler',{metadata:{publicMethods:['beginGesture','endGesture','move','click','doubleClick','contextMenu']},constructor:function(T){this._tool=T;this._rect=null;this._gesture=false;this._nomenu=false;this._selectionRect=null;}});R.prototype.destroy=function(){this._tool=null;this._rect=null;this._gesture=false;};R.prototype.activate=function(v){this._deactivate=false;if(v._loco){this._viewport=v;v._loco.addHandler(this);}};R.prototype.deactivate=function(){if(this._gesture){this._deactivate=true;}else if(this._viewport){this._deactivate=false;this._viewport._loco.removeHandler(this);this._viewport=null;}};R.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};R.prototype._inside=function(e){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d==null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};R.prototype.beginGesture=function(e){if(this._inside(e)&&!this._gesture){this._gesture=true;e.handled=true;var x=e.x-this._rect.x,y=e.y-this._rect.y;this._selectionRect={x1:x,y1:y,x2:x,y2:y};return;}};R.prototype.move=function(e){if(this._gesture){e.handled=true;this._nomenu=true;if(this._selectionRect){this._selectionRect.x2=e.x-this._rect.x;this._selectionRect.y2=e.y-this._rect.y;if(this._viewport){this._viewport.setSelectionRect(this._selectionRect);}}}};R.prototype.click=function(e){e.handled=false;};R.prototype.doubleClick=function(e){e.handled=false;};R.prototype.contextMenu=function(e){e.handled=false;};R.prototype.endGesture=function(e){if(this._gesture){this._gesture=false;e.handled=true;if(this._selectionRect){if(this._viewport){var x=e.x-this._rect.x,y=e.y-this._rect.y;if(this._tool.isViewportType('sap.ui.vk.dvl.Viewport')){this._tool.select(this._selectionRect.x1,this._selectionRect.y1,x,y,null,null);}else if(this._tool.isViewportType('sap.ui.vk.threejs.Viewport')){this._tool.select(this._selectionRect.x1,this._selectionRect.y1,x,y,this._viewport.getScene(),this._viewport.getCamera());}}this._viewport.setSelectionRect(null);this._selectionRect=null;}if(this._deactivate){this.deactivate();}}};R.prototype.getViewport=function(){return this._viewport;};return R;},true);\n",
	"sap/ui/vk/tools/RotateOrbitTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','sap/ui/vk/helpers/RotateOrbitHelperDvl','sap/ui/vk/helpers/RotateOrbitHelperThree'],function(q,l,T,R,a){'use strict';var b=T.extend('sap.ui.vk.tools.RotateOrbitTool',{metadata:{events:{rotate:{parameters:{dx:'int',dy:'int'}}}},constructor:function(i,s){if(b._instance){return b._instance;}T.apply(this,arguments);this.setToolid('1a1fced1-9b42-d7f3-5fdf-8d338b3591a6');this._viewport=null;this._rotateOrbitHelper=null;b._instance=this;}});b.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.dvl.Viewport','sap.ui.vk.threejs.Viewport']);};b.prototype.setActive=function(v,c,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,c,g);}if(v){this._activateTool(c);}else{this._deactivateTool();}return this;};b.prototype._activateTool=function(c){this._viewport=this.getViewportImplementation(c);if(this._prepare()){this._rotateOrbitHelper.activateOrbitMode();}};b.prototype._deactivateTool=function(){if(this._rotateOrbitHelper){this._rotateOrbitHelper.deactivateOrbitMode();this._rotateOrbitHelper=null;}};b.prototype._prepare=function(){if(this.isViewportType('sap.ui.vk.dvl.Viewport')&&this._viewport._dvl){if(this._rotateOrbitHelper==null){this._dvlRendererId=this._viewport._dvlRendererId;this._dvl=this._viewport._dvl;this._rotateOrbitHelper=new R(this,this._dvl);}}else if(this.isViewportType('sap.ui.vk.threejs.Viewport')){if(this._rotateOrbitHelper==null){this._rotateOrbitHelper=new a(this);}}else{return false;}return true;};b.prototype.rotate=function(d,c){if(this._prepare()){this._rotateOrbitHelper.rotate(d,c);}};b.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._rotateOrbitHelper=null;};return b;});\n",
	"sap/ui/vk/tools/RotateTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','./RotateToolHandler','./RotateToolGizmo'],function(q,l,T,R,a){'use strict';var b=T.extend('sap.ui.vk.tools.RotateTool',{metadata:{events:{rotating:{parameters:{x:'float',y:'float',z:'float'}},rotated:{parameters:{x:'float',y:'float',z:'float'}}}},constructor:function(i,s){T.apply(this,arguments);this._viewport=null;this._handler=null;this._gizmo=null;}});b.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.threejs.Viewport']);this.setAggregation('gizmo',new a());};b.prototype.isViewportType=function(t){if(this._viewport&&this._viewport.getMetadata().getName()===t){return true;}return false;};b.prototype.setActive=function(v,c,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,c,g);}if(v){this._activateTool(c);}else{this._deactivateTool();}if(c){c.setShouldRenderFrame();}return this;};b.prototype._activateTool=function(c){this._viewport=this.getViewportImplementation(c);this._handler=new R(this);this._gizmo=this.getGizmo();if(this._gizmo){this._gizmo.show(this._viewport,this);}this._prepare();};b.prototype._deactivateTool=function(){if(this._handler){if(this._viewport._loco){this._viewport._loco.removeHandler(this._handler);}this._handler=null;}if(this._gizmo){this._gizmo.hide();this._gizmo=null;}};b.prototype._prepare=function(){var o=false;if(this._viewport._loco){this._viewport._loco.addHandler(this._handler);o=true;}return o;};b.prototype.queueCommand=function(c){if(this._prepare()){if(this.isViewportType('sap.ui.vk.threejs.Viewport')){c();}}return this;};b.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._handler=null;};b.prototype.getCoordinateSystem=function(){return this.getGizmo().getCoordinateSystem();};b.prototype.setCoordinateSystem=function(v){this.getGizmo().setCoordinateSystem(v);if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};b.prototype.rotate=function(v){if(this._gizmo){this._gizmo.rotate(v);}if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};return b;});\n",
	"sap/ui/vk/tools/RotateToolGizmo.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Gizmo'],function(q,b,G){'use strict';var R=G.extend('sap.ui.vk.tools.RotateToolGizmo',{metadata:{library:'sap.ui.vk.tools'}});R.prototype.init=function(){if(G.prototype.init){G.prototype.init.apply(this);}this._viewport=null;this._tool=null;this._sceneGizmo=new THREE.Scene();this._gizmo=new THREE.Group();this._touchAreas=new THREE.Group();this._sceneGizmo.add(this._gizmo);this._coordinateSystem=sap.ui.vk.tools.CoordinateSystem.Local;this._nodes=[];this._matViewProj=new THREE.Matrix4();this._gizmoSize=144;this._gizmoRotation=new THREE.Vector3();function c(e,f,r,s){var g=new THREE.TorusBufferGeometry(r,window.devicePixelRatio/288,4,s);if(e===0){g.rotateY(Math.PI/2);}else if(e===1){g.rotateX(Math.PI/2);}var h=new THREE.Mesh(g,new THREE.MeshBasicMaterial({color:f,transparent:true}));h.matrixAutoUpdate=false;h.userData.color=f;return h;}function a(e,r,s){var g=new THREE.TorusBufferGeometry(r,24/144,4,s);if(e===0){g.rotateY(Math.PI/2);}else if(e===1){g.rotateX(Math.PI/2);}return new THREE.Mesh(g,new THREE.MeshBasicMaterial({opacity:0.2,transparent:true}));}for(var i=0;i<3;i++){this._gizmo.add(c(i,0xFF<<8*(2-i),1,128));this._touchAreas.add(a(i,1,24));}this._gizmo.add(new THREE.AxisHelper(0.75));var d=new THREE.MeshBasicMaterial({color:0x0080FF,opacity:0.5,transparent:true,side:THREE.DoubleSide});this._arcMesh=new THREE.Mesh(new THREE.Geometry(),d);this._arcMesh.drawMode=THREE.TriangleFanDrawMode;this._arcMesh.visible=false;this._gizmo.add(this._arcMesh);this._axisTitles=this._createAxisTitles();this._sceneGizmo.add(this._axisTitles);};R.prototype.hasDomElement=function(){return false;};R.prototype.getCoordinateSystem=function(){return this._coordinateSystem;};R.prototype.setCoordinateSystem=function(c){this._coordinateSystem=c;var s=c===sap.ui.vk.tools.CoordinateSystem.Screen;this._gizmo.children[0].visible=this._gizmo.children[1].visible=!s;this._touchAreas.children[0].visible=this._touchAreas.children[1].visible=!s;this._axisTitles.visible=!s;};R.prototype.show=function(v,t){this._viewport=v;this._tool=t;this._nodes.length=0;this._updateSelection(v._viewStateManager);};R.prototype.hide=function(){this._viewport=null;this._tool=null;};R.prototype.getGizmoCount=function(){if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local){return this._nodes.length;}else{return this._nodes.length>0?1:0;}};R.prototype.getTouchObject=function(i){if(this._nodes.length===0){return null;}this._updateGizmoObjectTransformation(this._touchAreas,i);return this._touchAreas;};R.prototype.getGizmoObject=function(){return this._nodes.length>0?this._gizmo:null;};R.prototype.highlightHandle=function(a,h){for(var i=0;i<3;i++){var c=this._gizmo.children[i];var d=i===a?0xFFFF00:c.userData.color;c.material.color.setHex(d);c.material.opacity=a===-1||i===a?1:0.35;c.material.visible=h||i===a;}this._axisTitles.children.forEach(function(o,i){o.material.color.setHex(i===a?0xFFFF00:o.userData.color);o.material.opacity=a===-1||i===a?1:0.35;o.material.visible=h||i===a;});};R.prototype.beginGesture=function(){this._matOrigin=this._gizmo.matrixWorld.clone();this._nodes.forEach(function(n){n.node.parent.updateMatrixWorld(true);n.matOrigin=n.node.matrixWorld.clone();n.matLocalOrigin=n.node.matrix.clone();n.matParentInv=new THREE.Matrix4().getInverse(n.node.parent.matrixWorld);n.quaternion=n.node.quaternion.clone();});};R.prototype.endGesture=function(){this._arcMesh.visible=false;this._tool.fireRotated({x:this._gizmoRotation.x,y:this._gizmoRotation.y,z:this._gizmoRotation.z});};R.prototype._rotate=function(e){this._gizmoRotation.set(THREE.Math.radToDeg(e.x),THREE.Math.radToDeg(e.y),THREE.Math.radToDeg(e.z));var a=new THREE.Quaternion();if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local){a.setFromEuler(e);this._nodes.forEach(function(h){h.node.quaternion.copy(h.quaternion).multiply(a);h.node.matrixWorldNeedsUpdate=true;});this._viewport._updateBoundingBoxesIfNeeded();}else{e=e.toArray();for(var i=0;i<3;i++){var c=e[i];if(c){var d=e[3].charCodeAt(i)-88;if(d>=0&&d<3){var f=new THREE.Vector3().setFromMatrixColumn(this._matOrigin,d).normalize();var m=new THREE.Matrix4().makeRotationAxis(f,c);var p=new THREE.Vector3().setFromMatrixPosition(this._matOrigin);m.setPosition(p.sub(p.clone().applyMatrix4(m)));for(var n=0,g=this._nodes.length;n<g;n++){var h=this._nodes[n];if(!h.ignore){var j=h.node;j.position.setFromMatrixPosition(h.matOrigin).applyMatrix4(m).applyMatrix4(h.matParentInv);var s=new THREE.Vector3().setFromMatrixScale(h.matOrigin);var l=f.clone().transformDirection(new THREE.Matrix4().getInverse(h.matOrigin)).multiply(s).normalize();a.setFromAxisAngle(l,c);j.quaternion.copy(h.quaternion).multiply(a);j.matrixWorldNeedsUpdate=true;}}}}}}this._viewport.setShouldRenderFrame();};R.prototype._setRotationAxisAngle=function(c,d,e){var f=e-d;if(Math.abs(f)>Math.PI){f-=Math.PI*2*Math.sign(f);}var g=[0,0,0];g[c]=f;g=new THREE.Euler().fromArray(g);if(this._tool.fireEvent('rotating',{x:THREE.Math.radToDeg(g.x),y:THREE.Math.radToDeg(g.y),z:THREE.Math.radToDeg(g.z)},true)){this._rotate(g);var v=[0,0,0];var h=new THREE.Vector3();var j=(c+1)%3,k=(c+2)%3;var n=Math.max(Math.ceil(Math.abs(f)*64/Math.PI),1);f*=this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local?-1:1;for(var i=0;i<=n;i++){var a=d+f*(i/n);h.set(0,0,0).setComponent(j,Math.cos(a)).setComponent(k,Math.sin(a));v.push(h.x,h.y,h.z);}this._arcMesh.geometry=new THREE.BufferGeometry().addAttribute('position',new THREE.Float32BufferAttribute(v,3));this._arcMesh.visible=true;}};R.prototype.rotate=function(a){this.beginGesture();this._rotate(new THREE.Euler(THREE.Math.degToRad(a.x||0),THREE.Math.degToRad(a.y||0),THREE.Math.degToRad(a.z||0)));};R.prototype.expandBoundingBox=function(a){if(this._viewport){this._expandBoundingBox(a,this._viewport.getCamera().getCameraRef());}};R.prototype.handleSelectionChanged=function(e){if(this._viewport){this._updateSelection(this._viewport._viewStateManager);}};R.prototype._updateGizmoTransformation=function(i,c){var s=this._updateGizmoObjectTransformation(this._gizmo,i);this._updateAxisTitles(this._axisTitles,this._gizmo,c,this._gizmoSize-18,s);};R.prototype.render=function(){if(this._nodes.length>0){var r=this._viewport.getRenderer(),c=this._viewport.getCamera().getCameraRef();this._matViewProj.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);r.clearDepth();for(var i=0,l=this.getGizmoCount();i<l;i++){this._updateGizmoTransformation(i,c);r.render(this._sceneGizmo,c);}}};R.prototype.onBeforeRendering=function(){};R.prototype.onAfterRendering=function(){};return R;},true);\n",
	"sap/ui/vk/tools/RotateToolHandler.js":"sap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var R=E.extend('sap.ui.vk.tools.RotateToolHandler',{metadata:{},constructor:function(t){this._tool=t;this._gizmo=t.getGizmo();this._rect=null;this._rayCaster=new THREE.Raycaster();this._rayCaster.linePrecision=0.2;this._handleIndex=-1;this._gizmoIndex=-1;this._handleAxis=new THREE.Vector3();this._gizmoOrigin=new THREE.Vector3();this._matrixOrigin=new THREE.Matrix4();this._mouse=new THREE.Vector2();}});R.prototype.destroy=function(){this._tool=null;this._gizmo=null;this._rect=null;this._rayCaster=null;this._handleAxis=null;this._gizmoOrigin=null;this._mouse=null;};R.prototype._updateMouse=function(e){var s=this.getViewport().getRenderer().getSize();this._mouse.x=((e.x-this._rect.x)/s.width)*2-1;this._mouse.y=((e.y-this._rect.y)/s.height)*-2+1;this._rayCaster.setFromCamera(this._mouse,this.getViewport().getCamera().getCameraRef());};R.prototype._updateHandles=function(e,h){var p=this._handleIndex;this._handleIndex=-1;for(var i=0,l=this._gizmo.getGizmoCount();i<l;i++){var t=this._gizmo.getTouchObject(i);var a=this._rayCaster.intersectObject(t,true);if(a.length>0){this._handleIndex=t.children.indexOf(a[0].object);if(this._handleIndex>=0&&this._handleIndex<3){this._gizmoIndex=i;this._matrixOrigin.copy(t.matrixWorld);this._gizmoOrigin.setFromMatrixPosition(t.matrixWorld);var b=new THREE.Vector3().setFromMatrixColumn(t.matrixWorld,(this._handleIndex+1)%3),c=new THREE.Vector3().setFromMatrixColumn(t.matrixWorld,(this._handleIndex+2)%3);this._handleAxis.crossVectors(b,c).normalize();}}}this._gizmo.highlightHandle(this._handleIndex,h||this._handleIndex===-1);if(p!==this._handleIndex){this.getViewport().setShouldRenderFrame();}};R.prototype.hover=function(e){if(this._inside(e)&&!this._gesture){this._updateMouse(e);this._updateHandles(e,true);e.handled|=this._handleIndex>0;}};R.prototype._getPlaneOffset=function(){var r=this._rayCaster.ray;var d=this._gizmoOrigin.clone().sub(r.origin);var a=this._handleAxis.dot(d)/this._handleAxis.dot(r.direction);return r.direction.clone().multiplyScalar(a).sub(d);};R.prototype.beginGesture=function(e){if(this._inside(e)&&!this._gesture){this._updateMouse(e);this._updateHandles(e,false);if(this._handleIndex>=0&&this._handleIndex<3&&e.n===1){this._gesture=true;e.handled=true;this._gizmo.beginGesture();if(this._handleIndex<3){this._dragOriginDirection=this._getPlaneOffset().normalize();}}}};R.prototype.move=function(e){if(this._gesture){e.handled=true;this._updateMouse(e);if(this._dragOriginDirection){var d=this._dragOriginDirection,a=this._getPlaneOffset().normalize(),b=new THREE.Vector3().setFromMatrixColumn(this._matrixOrigin,(this._handleIndex+1)%3).normalize(),c=new THREE.Vector3().setFromMatrixColumn(this._matrixOrigin,(this._handleIndex+2)%3).normalize();var f=Math.atan2(d.dot(c),d.dot(b));var g=Math.atan2(a.dot(c),a.dot(b));if(!isNaN(f)&&!isNaN(g)){this._gizmo._setRotationAxisAngle(this._handleIndex,f,g);}}}};R.prototype.endGesture=function(e){if(this._gesture){this._gesture=false;e.handled=true;this._updateMouse(e);this._gizmo.endGesture();this._dragOriginDirection=undefined;this._updateHandles(e,true);this.getViewport().setShouldRenderFrame();}};R.prototype.click=function(e){};R.prototype.doubleClick=function(e){};R.prototype.contextMenu=function(e){};R.prototype.getViewport=function(){return this._tool._viewport;};R.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};R.prototype._inside=function(e){if(this._rect===null||true){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d===null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};}return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};return R;},true);\n",
	"sap/ui/vk/tools/RotateTurntableTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','sap/ui/vk/helpers/RotateTurntableHelperDvl','sap/ui/vk/helpers/RotateTurntableHelperThree'],function(q,l,T,R,a){'use strict';var b=T.extend('sap.ui.vk.tools.RotateTurntableTool',{metadata:{events:{rotate:{parameters:{dx:'int',dy:'int'}}}},constructor:function(i,s){if(b._instance){return b._instance;}T.apply(this,arguments);this.setToolid('f271c082-676c-adc6-167f-0d5ce602aa45');this._viewport=null;this._rotateTurntableHelper=null;b._instance=this;}});b.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.dvl.Viewport','sap.ui.vk.threejs.Viewport']);};b.prototype.setActive=function(v,c,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,c,g);}if(v){this._activateTool(c);}else{this._deactivateTool();}return this;};b.prototype._activateTool=function(c){this._viewport=this.getViewportImplementation(c);if(this._prepare()){this._rotateTurntableHelper.activateTurntableMode();}};b.prototype._deactivateTool=function(){if(this._rotateTurntableHelper){this._rotateTurntableHelper.deactivateTurntableMode();this._rotateTurntableHelper=null;}};b.prototype._prepare=function(){if(this.isViewportType('sap.ui.vk.dvl.Viewport')&&this._viewport._dvl){if(this._rotateTurntableHelper==null){this._dvlRendererId=this._viewport._dvlRendererId;this._dvl=this._viewport._dvl;this._rotateTurntableHelper=new R(this,this._dvl);}}else if(this.isViewportType('sap.ui.vk.threejs.Viewport')){if(this._rotateTurntableHelper==null){this._rotateTurntableHelper=new a(this);}}else{return false;}return true;};b.prototype.rotate=function(d,c){if(this._prepare()){this._rotateTurntableHelper.rotate(d,c);}};b.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._rotateTurntableHelper=null;};return b;});\n",
	"sap/ui/vk/tools/ScaleTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','./ScaleToolHandler','./ScaleToolGizmo'],function(q,l,T,S,a){'use strict';var b=T.extend('sap.ui.vk.tools.ScaleTool',{metadata:{events:{scaling:{parameters:{x:'float',y:'float',z:'float'}},scaled:{parameters:{x:'float',y:'float',z:'float'}}}},constructor:function(i,s){T.apply(this,arguments);this._viewport=null;this._handler=null;this._gizmo=null;}});b.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.threejs.Viewport']);this.setAggregation('gizmo',new a());};b.prototype.isViewportType=function(t){if(this._viewport&&this._viewport.getMetadata().getName()===t){return true;}return false;};b.prototype.setActive=function(v,c,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,c,g);}if(v){this._activateTool(c);}else{this._deactivateTool();}if(c){c.setShouldRenderFrame();}return this;};b.prototype._activateTool=function(c){this._viewport=this.getViewportImplementation(c);this._handler=new S(this);this._gizmo=this.getGizmo();if(this._gizmo){this._gizmo.show(this._viewport,this);}this._prepare();};b.prototype._deactivateTool=function(){if(this._handler){if(this._viewport._loco){this._viewport._loco.removeHandler(this._handler);}this._handler=null;}if(this._gizmo){this._gizmo.hide();this._gizmo=null;}};b.prototype._prepare=function(){var o=false;if(this._viewport._loco){this._viewport._loco.addHandler(this._handler);o=true;}return o;};b.prototype.queueCommand=function(c){if(this._prepare()){if(this.isViewportType('sap.ui.vk.threejs.Viewport')){c();}}return this;};b.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._handler=null;};b.prototype.getNonUniformScaleEnabled=function(){return this.getGizmo().getNonUniformScaleEnabled();};b.prototype.setNonUniformScaleEnabled=function(v){this.getGizmo().setNonUniformScaleEnabled(v);if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};b.prototype.getCoordinateSystem=function(){return this.getGizmo().getCoordinateSystem();};b.prototype.setCoordinateSystem=function(v){this.getGizmo().setCoordinateSystem(v);if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};b.prototype.scale=function(v){if(this._gizmo){this._gizmo.scale(v);}if(this._viewport){this._viewport.setShouldRenderFrame();}return this;};return b;});\n",
	"sap/ui/vk/tools/ScaleToolGizmo.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Gizmo'],function(q,c,G){'use strict';var S=G.extend('sap.ui.vk.tools.ScaleToolGizmo',{metadata:{library:'sap.ui.vk.tools'}});S.prototype.init=function(){if(G.prototype.init){G.prototype.init.apply(this);}this._viewport=null;this._tool=null;this._nonUniformScaleEnabled=false;this._sceneGizmo=new THREE.Scene();this._gizmo=new THREE.Group();this._touchAreas=new THREE.Group();this._sceneGizmo.add(this._gizmo);this._gizmoScale=new THREE.Vector3().setScalar(1);this._coordinateSystem=sap.ui.vk.tools.CoordinateSystem.Local;this._nodes=[];this._matViewProj=new THREE.Matrix4();this._gizmoSize=132;var d=144,e=24/d,t=48/d;function f(a,b,i){var m=new THREE.Matrix4().makeBasis(new THREE.Vector3(a.y,a.z,a.x),a,new THREE.Vector3(a.z,a.x,a.y));var j=new THREE.BoxBufferGeometry(e,e,e);j.applyMatrix(m);var k=new THREE.Mesh(j,new THREE.MeshBasicMaterial({color:b,transparent:true}));k.userData.color=b;if(a){k.position.copy(a);var l=window.devicePixelRatio*0.5/d;var n=new THREE.CylinderBufferGeometry(l,l,1,4);m.setPosition(a.clone().multiplyScalar(-0.5));n.applyMatrix(m);var o=new THREE.Mesh(n,new THREE.MeshBasicMaterial({color:b,transparent:true}));o.renderOrder=1;k.add(o);m.setPosition(a);}var p=new THREE.BoxBufferGeometry(t,t,t);p.applyMatrix(m);i.add(new THREE.Mesh(p,new THREE.MeshBasicMaterial({opacity:0.2,transparent:true})));return k;}function g(a,b,i){var l=new THREE.BufferGeometry();var v=new Float32Array(6);v[a]=v[b+3]=0.7;l.addAttribute('position',new THREE.Float32BufferAttribute(v,3));var j=new Float32Array(6);j[a]=j[b+3]=1;l.addAttribute('color',new THREE.Float32BufferAttribute(j,3));var k=new THREE.Line(l,new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,transparent:true,linewidth:window.devicePixelRatio}));k.userData.colors=j;var m=new THREE.Geometry();var n=new THREE.Vector3().setComponent(a,0.7);var o=new THREE.Vector3().setComponent(b,0.7);m.vertices.push(new THREE.Vector3(),n,o);m.faces.push(new THREE.Face3(0,1,2));var p=new THREE.Mesh(m,new THREE.MeshBasicMaterial({color:0xFFFF00,opacity:0.5,transparent:true,side:THREE.DoubleSide,visible:false}));p.renderOrder=1;k.add(p);i.add(p.clone());return k;}this._gizmo.add(f(new THREE.Vector3(1,0,0),0xFF0000,this._touchAreas));this._gizmo.add(f(new THREE.Vector3(0,1,0),0x00FF00,this._touchAreas));this._gizmo.add(f(new THREE.Vector3(0,0,1),0x0000FF,this._touchAreas));this._gizmo.add(g(1,2,this._touchAreas));this._gizmo.add(g(2,0,this._touchAreas));this._gizmo.add(g(0,1,this._touchAreas));e-=0.1/d;var h=new THREE.MeshBasicMaterial({color:0xC0C0C0,transparent:true});this._gizmo.add(new THREE.Mesh(new THREE.BoxBufferGeometry(e,e,e),h));this._touchAreas.add(new THREE.Mesh(new THREE.BoxBufferGeometry(t,t,t),new THREE.MeshBasicMaterial()));this._axisTitles=this._createAxisTitles();this._sceneGizmo.add(this._axisTitles);this._updateGizmoPartVisibility();};S.prototype.hasDomElement=function(){return false;};S.prototype._updateGizmoPartVisibility=function(){var s=this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Screen;var g=this._gizmo.children,t=this._touchAreas.children;g[2].visible=t[2].visible=!s;g[3].visible=g[4].visible=t[3].visible=t[4].visible=!s&&this._nonUniformScaleEnabled;g[5].visible=t[5].visible=this._nonUniformScaleEnabled;this._axisTitles.children[2].visible=!s;};S.prototype.getCoordinateSystem=function(){return this._coordinateSystem;};S.prototype.setCoordinateSystem=function(a){this._coordinateSystem=a;this._updateGizmoPartVisibility();};S.prototype.getNonUniformScaleEnabled=function(v){return this._nonUniformScaleEnabled;};S.prototype.setNonUniformScaleEnabled=function(v){this._nonUniformScaleEnabled=!!v;this._updateGizmoPartVisibility();};S.prototype.show=function(v,t){this._viewport=v;this._tool=t;this._nodes.length=0;this._updateSelection(v._viewStateManager);};S.prototype.hide=function(){this._viewport=null;this._tool=null;};S.prototype.getGizmoCount=function(){if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local){return this._nodes.length;}else{return this._nodes.length>0?1:0;}};S.prototype.getTouchObject=function(i){if(this._nodes.length===0){return null;}this._updateGizmoObjectTransformation(this._touchAreas,i);return this._touchAreas;};S.prototype.highlightHandle=function(a,h){var b=(a===6)||(a>=0&&!this._nonUniformScaleEnabled);var d=[];var i,o;for(i=0;i<3;i++){o=this._gizmo.children[i];var e=b||(a<3?i===a:((i===(a+1)%3)||(i===(a+2)%3)));d[i]=e;var f=e?0xFFFF00:o.userData.color;o.material.color.setHex(f);o.children[0].material.color.setHex(f);o.children[0].material.opacity=o.material.opacity=e||h?1:0.35;}for(i=3;i<6;i++){o=this._gizmo.children[i];var g=o.geometry.attributes.color;if(b||i===a){g.copyArray([1,1,0,1,1,0]);}else{g.copyArray(o.userData.colors);}g.needsUpdate=true;o.material.opacity=h||i===a?1:0.35;o.children[0].material.visible=i===a;}this._axisTitles.children.forEach(function(o,i){o.material.color.setHex(d[i]?0xFFFF00:o.userData.color);o.material.opacity=d[i]||h?1:0.35;});o=this._gizmo.children[6];o.material.color.setHex(b?0xFFFF00:0xC0C0C0);o.material.opacity=b||h?1:0.35;};S.prototype.beginGesture=function(){this._matOrigin=this._gizmo.matrixWorld.clone();this._nodes.forEach(function(n){n.scaleOrigin=n.node.scale.clone();n.matOrigin=n.node.matrixWorld.clone();n.matParentInv=new THREE.Matrix4().getInverse(n.node.parent.matrixWorld);});};S.prototype.endGesture=function(){this._tool.fireScaled({x:this._gizmoScale.x,y:this._gizmoScale.y,z:this._gizmoScale.z});this._gizmoScale.setScalar(1);};S.prototype._scale=function(s){this._gizmoScale.copy(s);if(this._coordinateSystem===sap.ui.vk.tools.CoordinateSystem.Local){this._nodes.forEach(function(n){n.node.scale.copy(n.scaleOrigin).multiply(s);n.node.matrixWorldNeedsUpdate=true;});this._viewport._updateBoundingBoxesIfNeeded();}else{var m=this._matOrigin.clone().scale(s).multiply(new THREE.Matrix4().getInverse(this._matOrigin));this._nodes.forEach(function(n){if(!n.ignore){var a=n.node;a.matrixWorld.multiplyMatrices(m,n.matOrigin);a.matrix.multiplyMatrices(n.matParentInv,a.matrixWorld);a.matrix.decompose(a.position,new THREE.Quaternion(),a.scale);a.matrixWorldNeedsUpdate=true;}});}this._viewport.setShouldRenderFrame();};S.prototype.scale=function(s){this.beginGesture();this._scale(s);};S.prototype._setScale=function(s){if(this._tool.fireEvent('scaling',{x:s.x,y:s.y,z:s.z},true)){this._scale(s);}};S.prototype.expandBoundingBox=function(b){if(this._viewport){this._expandBoundingBox(b,this._viewport.getCamera().getCameraRef());}};S.prototype.handleSelectionChanged=function(e){if(this._viewport){this._updateSelection(this._viewport._viewStateManager);}};S.prototype._updateGizmoTransformation=function(g,a){var s=this._updateGizmoObjectTransformation(this._gizmo,g);this._updateAxisTitles(this._axisTitles,this._gizmo,a,this._gizmoSize+30,s);};S.prototype.render=function(){if(this._nodes.length>0){var r=this._viewport.getRenderer(),a=this._viewport.getCamera().getCameraRef();this._matViewProj.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse);r.clearDepth();for(var i=0,l=this.getGizmoCount();i<l;i++){this._updateGizmoTransformation(i,a);r.render(this._sceneGizmo,a);}}};S.prototype.onBeforeRendering=function(){};S.prototype.onAfterRendering=function(){};return S;},true);\n",
	"sap/ui/vk/tools/ScaleToolHandler.js":"sap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var S=E.extend('sap.ui.vk.tools.ScaleToolHandler',{metadata:{},constructor:function(t){this._tool=t;this._gizmo=t.getGizmo();this._rect=null;this._rayCaster=new THREE.Raycaster();this._handleIndex=-1;this._gizmoIndex=-1;this._handleAxis=new THREE.Vector3();this._handleDirection=new THREE.Vector3();this._gizmoOrigin=new THREE.Vector3();this._mouse=new THREE.Vector2();this._mouseOrigin=new THREE.Vector2();}});S.prototype.destroy=function(){this._tool=null;this._gizmo=null;this._rect=null;this._rayCaster=null;this._handleAxis=null;this._gizmoOrigin=null;this._mouse=null;};S.prototype._updateMouse=function(e){var s=this.getViewport().getRenderer().getSize();this._mouse.x=((e.x-this._rect.x)/s.width)*2-1;this._mouse.y=((e.y-this._rect.y)/s.height)*-2+1;this._rayCaster.setFromCamera(this._mouse,this.getViewport().getCamera().getCameraRef());};S.prototype._updateHandles=function(e,h){var p=this._handleIndex;this._handleIndex=-1;for(var i=0,l=this._gizmo.getGizmoCount();i<l;i++){var t=this._gizmo.getTouchObject(i);var a=this._rayCaster.intersectObjects(t.children,false);if(a.length>0){this._handleIndex=t.children.indexOf(a[0].object);if(this._handleIndex>=0){this._gizmoIndex=i;this._gizmoOrigin.setFromMatrixPosition(t.matrixWorld);this._handleAxis.setFromMatrixColumn(t.matrixWorld,this._handleIndex%3).normalize();var b=new THREE.Vector3().setFromMatrixColumn(t.matrixWorld,(this._handleIndex+1)%3).normalize();var c=new THREE.Vector3().setFromMatrixColumn(t.matrixWorld,(this._handleIndex+2)%3).normalize();this._handleDirection.addVectors(b,c).normalize();}}}this._gizmo.highlightHandle(this._handleIndex,h||this._handleIndex===-1);if(p!==this._handleIndex){this.getViewport().setShouldRenderFrame();}};S.prototype.hover=function(e){if(this._inside(e)&&!this._gesture){this._updateMouse(e);this._updateHandles(e,true);e.handled|=this._handleIndex>0;}};S.prototype._getAxisOffset=function(){var r=this._rayCaster.ray;var d=this._handleAxis.clone().cross(r.direction).cross(r.direction).normalize();var a=r.origin.clone().sub(this._gizmoOrigin);return d.dot(a)/d.dot(this._handleAxis);};S.prototype._getPlaneOffset=function(){var r=this._rayCaster.ray;var d=this._gizmoOrigin.clone().sub(r.origin);var a=this._handleAxis.dot(d)/this._handleAxis.dot(r.direction);return r.direction.clone().multiplyScalar(a).sub(d);};S.prototype.beginGesture=function(e){if(this._inside(e)&&!this._gesture){this._updateMouse(e);this._updateHandles(e,false);if(this._handleIndex>=0&&e.n===1){this._gesture=true;e.handled=true;this._mouseOrigin.set(e.x,e.y);this._gizmo.beginGesture();if(this._handleIndex<3){this._dragOrigin=this._getAxisOffset();}else if(this._handleIndex<6){this._dragOrigin=this._handleDirection.dot(this._getPlaneOffset());}}}};S.prototype.move=function(e){if(this._gesture){e.handled=true;this._updateMouse(e);var s=new THREE.Vector3().setScalar(1);if(this._handleIndex<3){if(this._gizmo.getNonUniformScaleEnabled()){s.setComponent(this._handleIndex,this._getAxisOffset()/this._dragOrigin);}else{s.setScalar(this._getAxisOffset()/this._dragOrigin);}}else if(this._handleIndex<6){s.setScalar(this._handleDirection.dot(this._getPlaneOffset())/this._dragOrigin).setComponent(this._handleIndex-3,1);}else{var d=(this._mouseOrigin.y-e.y)/60;s.setScalar(d>=0?1+d:1/(1-d));}if(s.x&&s.y&&s.z){this._gizmo._setScale(s);}}};S.prototype.endGesture=function(e){if(this._gesture){this._gesture=false;e.handled=true;this._updateMouse(e);this._gizmo.endGesture();this._dragOrigin=undefined;this._updateHandles(e,true);this.getViewport().setShouldRenderFrame();}};S.prototype.click=function(e){};S.prototype.doubleClick=function(e){};S.prototype.contextMenu=function(e){};S.prototype.getViewport=function(){return this._tool._viewport;};S.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};S.prototype._inside=function(e){if(this._rect===null||true){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d===null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};}return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};return S;},true);\n",
	"sap/ui/vk/tools/SceneOrientationTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','./SceneOrientationToolHandler','./SceneOrientationToolGizmo'],function(q,l,T,S,a){'use strict';var b=T.extend('sap.ui.vk.tools.SceneOrientationTool',{metadata:{properties:{enablePredefinedViews:{type:'boolean',defaultValue:true},enableInitialView:{type:'boolean',defaultValue:true}}},constructor:function(i,s){if(b._instance){return b._instance;}T.apply(this,arguments);this._viewport=null;this._handler=null;this._menu=null;b._instance=this;}});b.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.threejs.Viewport']);this.setAggregation('gizmo',new a());};b.prototype.setActive=function(v,c,g){if(T.prototype.setActive){T.prototype.setActive.call(this,v,c,g);}if(v){this._activateTool(c);}else{this._deactivateTool();}return this;};b.prototype._activateTool=function(c){this._viewport=this.getViewportImplementation(c);this._handler=new S(this);this._gizmo=this.getGizmo();this._prepare();};b.prototype._deactivateTool=function(){if(this._handler){if(this._viewport._loco){this._viewport._loco.removeHandler(this._handler);}this._handler=null;}this._gizmo=null;};b.prototype._prepare=function(){var o=false;if(this._viewport._loco){this._viewport._loco.addHandler(this._handler);o=true;}return o;};b.prototype.setView=function(v,m){if(this._gizmo){this._gizmo.setView(v,m);}return this;};b.prototype.queueCommand=function(c){if(this._prepare()){if(this.isViewportType('sap.ui.vk.dvl.Viewport')){if(this._dvlRendererId){this._dvl.Renderer._queueCommand(c,this._dvlRendererId);}}else if(this.isViewportType('sap.ui.vk.threejs.Viewport')){c();}}return this;};b.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._handler=null;delete b._instance;};return b;});\n",
	"sap/ui/vk/tools/SceneOrientationToolGizmo.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Gizmo','sap/ui/unified/Menu','sap/ui/unified/MenuItem','sap/ui/vk/threejs/thirdparty/three','./SceneOrientationToolGizmoRenderer'],function(q,l,G,M,a,t,S){'use strict';sap.ui.require('sap.m.Menu');var b=G.extend('sap.ui.vk.tools.SceneOrientationToolGizmo',{metadata:{library:'sap.ui.vk.tools'}});function c(d,e){var f=64,g=0.5,h=15,i=3,j=29,k=30;d.multiplyScalar(1/80);var n=new THREE.Vector3(d.y,d.z,d.x),o=new THREE.Vector3(d.z,d.x,d.y);var p=new THREE.MeshBasicMaterial({color:e}),r=new THREE.MeshBasicMaterial({color:0xFFFFFF,transparent:true,opacity:0.8}),s=new THREE.MeshBasicMaterial({color:0x000000,transparent:true,opacity:0.8});var u=new THREE.CylinderBufferGeometry(g,g,f-h,4);var m=new THREE.Matrix4().makeBasis(n,d,o).setPosition(d.clone().multiplyScalar((f-h)*0.5));u.applyMatrix(m);var v=new THREE.Mesh(u,p);var w=new THREE.CylinderBufferGeometry(0,i,h,12,1);m.setPosition(d.clone().multiplyScalar(f-h*0.5));w.applyMatrix(m);v.add(new THREE.Mesh(w,p));var x=new THREE.CylinderBufferGeometry(g,g,j,4);m.makeBasis(d,o,n).setPosition(o.clone().multiplyScalar(0.5).add(d).multiplyScalar(j));x.applyMatrix(m);v.add(new THREE.Mesh(x,r));x=new THREE.CylinderBufferGeometry(g,g,j,4);m.setPosition(o.clone().multiplyScalar(0.5).add(d).add(n).multiplyScalar(j));x.applyMatrix(m);v.add(new THREE.Mesh(x,r));x=new THREE.CylinderBufferGeometry(g,g,j,4);m.makeBasis(o,n,d).setPosition(n.clone().multiplyScalar(0.5).add(d).multiplyScalar(j));x.applyMatrix(m);v.add(new THREE.Mesh(x,r));x=new THREE.CylinderBufferGeometry(g,g,k,4);m.makeBasis(d,o,n).setPosition(o.clone().multiplyScalar(0.5).add(d).multiplyScalar(k));x.applyMatrix(m);v.add(new THREE.Mesh(x,s));x=new THREE.CylinderBufferGeometry(g,g,k,4);m.setPosition(o.clone().multiplyScalar(0.5).add(d).add(n).multiplyScalar(k));x.applyMatrix(m);v.add(new THREE.Mesh(x,s));x=new THREE.CylinderBufferGeometry(g,g,k,4);m.makeBasis(o,n,d).setPosition(n.clone().multiplyScalar(0.5).add(d).multiplyScalar(k));x.applyMatrix(m);v.add(new THREE.Mesh(x,s));return v;}b.prototype.init=function(){if(G.prototype.init){G.prototype.init.apply(this);}this._menu=null;this._viewport=null;this._renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});this._renderer.setPixelRatio(window.devicePixelRatio);this._renderer.setSize(1,1);this._camera=new THREE.OrthographicCamera(-1,1,1,-1,0.1,100);this._scene=new THREE.Scene();this._scene.add(c(new THREE.Vector3(1,0,0),0xFF0000));this._scene.add(c(new THREE.Vector3(0,1,0),0x00FF00));this._scene.add(c(new THREE.Vector3(0,0,1),0x0000FF));this._scene.traverse(function(o){o.matrixAutoUpdate=false;});this._axisTitles=this._createAxisTitles(32,16);this._scene.add(this._axisTitles);q(document).click(function(e){if(q('.sapUiVizKitSceneOrientationGizmoButton').length){var d=q('.sapUiVizKitSceneOrientationGizmoButton .sapUiIconMirrorInRTL');if(e.target!==d[0]){this._button.setPressed(false);}}}.bind(this));this._button=new sap.m.ToggleButton({icon:'sap-icon://drop-down-list',tooltip:sap.ui.vk.getResourceBundle().getText('PREDEFINED_VIEW_MENUBUTTONTOOLTIP'),press:function(e){if(!this._menu){this.createMenu();}if(this._button.getPressed()){var d=sap.ui.core.Popup.Dock;var r=sap.ui.getCore().getConfiguration().getRTL();this._menu.open(false,this.getFocusDomRef(),r?d.LeftCenter:d.RightCenter,r?d.LeftBottom:d.RightBottom,this.getDomRef());}else{this._menu.close();}}.bind(this)}).addStyleClass('sapUiVizKitSceneOrientationGizmoButton');this._button.addStyleClass('sapUiSizeCompact');};b.prototype.createMenu=function(){var d=1000;var m=this._menu=new M();if(this.oParent.getEnableInitialView()){m.addItem(new a({text:sap.ui.vk.getResourceBundle().getText('PREDEFINED_VIEW_INITIAL')}).attachSelect(function(){this.setView(sap.ui.vk.tools.PredefinedView.Initial,d);this._button.setPressed(false);}.bind(this)));}m.addItem(new a({text:sap.ui.vk.getResourceBundle().getText('PREDEFINED_VIEW_FRONT'),startsSection:this.oParent.getEnableInitialView()}).attachSelect(function(){this.setView(sap.ui.vk.tools.PredefinedView.Front,d);this._button.setPressed(false);}.bind(this)));m.addItem(new a({text:sap.ui.vk.getResourceBundle().getText('PREDEFINED_VIEW_BACK')}).attachSelect(function(){this.setView(sap.ui.vk.tools.PredefinedView.Back,d);this._button.setPressed(false);}.bind(this)));m.addItem(new a({text:sap.ui.vk.getResourceBundle().getText('PREDEFINED_VIEW_LEFT')}).attachSelect(function(){this.setView(sap.ui.vk.tools.PredefinedView.Left,d);this._button.setPressed(false);}.bind(this)));m.addItem(new a({text:sap.ui.vk.getResourceBundle().getText('PREDEFINED_VIEW_RIGHT')}).attachSelect(function(){this.setView(sap.ui.vk.tools.PredefinedView.Right,d);this._button.setPressed(false);}.bind(this)));m.addItem(new a({text:sap.ui.vk.getResourceBundle().getText('PREDEFINED_VIEW_TOP')}).attachSelect(function(){this.setView(sap.ui.vk.tools.PredefinedView.Top,d);this._button.setPressed(false);}.bind(this)));m.addItem(new a({text:sap.ui.vk.getResourceBundle().getText('PREDEFINED_VIEW_BOTTOM')}).attachSelect(function(){this.setView(sap.ui.vk.tools.PredefinedView.Bottom,d);this._button.setPressed(false);}.bind(this)));};b.prototype.setView=function(v,m){var d;switch(v){case sap.ui.vk.tools.PredefinedView.Initial:d=null;break;case sap.ui.vk.tools.PredefinedView.Front:d=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),0);break;case sap.ui.vk.tools.PredefinedView.Back:d=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI);break;case sap.ui.vk.tools.PredefinedView.Left:d=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),-Math.PI/2);break;case sap.ui.vk.tools.PredefinedView.Right:d=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI/2);break;case sap.ui.vk.tools.PredefinedView.Top:d=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/2);break;case sap.ui.vk.tools.PredefinedView.Bottom:d=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1,0,0),Math.PI/2);break;default:return this;}this._viewport._viewportGestureHandler.setView(d,m||0);return this;};b.prototype.render=function(v){this._viewport=v;this._camera.quaternion.copy(v.getCamera().getCameraRef().quaternion);this._camera.position.set(0,0,1).applyQuaternion(this._camera.quaternion);var w=this._renderer.getSize().width;this._updateAxisTitles(this._axisTitles,this._scene,this._camera,w*0.45,2/w);this._renderer.render(this._scene,this._camera);};b.prototype.onBeforeRendering=function(){};b.prototype.onAfterRendering=function(){var d=this.getDomRef();this._renderer.setSize(d.clientWidth,d.clientHeight);d.appendChild(this._renderer.domElement);};return b;},true);\n",
	"sap/ui/vk/tools/SceneOrientationToolGizmoRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var S={};S.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapUiVizKitSceneOrientationGizmo');r.writeClasses();r.write('>');if(c.getParent().getEnablePredefinedViews()){r.renderControl(c._button);}r.write('</div>');};return S;},true);\n",
	"sap/ui/vk/tools/SceneOrientationToolHandler.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var S=E.extend('sap.ui.vk.tools.SceneOrientationToolHandler',{metadata:{},constructor:function(t){this._tool=t;this._rect=null;this._mouse=new THREE.Vector2();}});S.prototype.destroy=function(){this._tool=null;this._rect=null;};S.prototype.hover=function(e){if(this._insideButton(e)){e.handled=true;}};S.prototype.beginGesture=function(e){if(this._insideButton(e)){e.handled=true;}};S.prototype.move=function(e){};S.prototype.endGesture=function(e){if(this._insideButton(e)){e.handled=true;}};S.prototype.click=function(e){if(this._insideButton(e)){e.handled=true;}};S.prototype.doubleClick=function(e){if(this._insideButton(e)){e.handled=true;}};S.prototype.contextMenu=function(e){if(this._insideButton(e)){e.handled=true;}};S.prototype._insideButton=function(e){var g=this._tool.getGizmo();var d=g?g._button.getDomRef():null;if(!d){return false;}var o=this._getOffset(d);return e.x>=o.x&&e.x<=o.x+d.offsetWidth&&e.y>=o.y&&e.y<=o.y+d.offsetHeight;};S.prototype.getViewport=function(){return this._tool._viewport;};S.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};S.prototype._inside=function(e){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d==null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};return S;},true);\n",
	"sap/ui/vk/tools/Tool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','sap/ui/core/Element'],function(q,l,E){'use strict';var T=E.extend('sap.ui.vk.tools.Tool',{metadata:{properties:{targetViewportType:'any',toolid:'string',active:{type:'boolean',defaultValue:false},footprint:{type:'string[]'}},associations:{gizmoContainer:{type:'sap.ui.core.Control',cardinality:'0..1'}},aggregations:{gizmo:{type:'sap.ui.vk.tools.Gizmo',multiple:false}},events:{enabled:{parameters:{enabled:'bool',reason:'string'}}}},constructor:function(i,s){E.apply(this,arguments);this._viewport=null;this._handler=null;}});T.prototype.init=function(){if(E.prototype.init){E.prototype.init.call(this);}};T.prototype.isViewportType=function(t){if(this._viewport&&this._viewport.getMetadata().getName()===t){return true;}return false;};T.prototype.getViewportImplementation=function(v){if(v&&typeof v.getImplementation==='function'){return v.getImplementation();}return v;};T.prototype.setActive=function(v,a,g){if(v){var _=this.getViewportImplementation(a);var b;var c='';b=_&&_.getMetadata().getName();if(this.getFootprint().indexOf(b)>=0){this.setProperty('active',v,true);}else{this.setProperty('active',false,true);c='Tool does not support Viewport type: '+b;q.sap.log.warning(c);}if(this.getGizmo()){if(g){this.setAssociation('gizmoContainer',g);g.rerender();}else{this.setAssociation('gizmoContainer',_);_.rerender();}}this.fireEnabled({enabled:this.getProperty('active'),reason:c});}else{this.setProperty('active',v,true);this.fireEnabled({enabled:v,reason:'Disabled by application logic.'});}};T.prototype.getGizmoForContainer=function(r){var _=this.getGizmo();if((r.getId()===this.getGizmoContainer())&&_&&this.getActive()){return _;}};T.prototype.destroy=function(){E.prototype.destroy.call(this);this._viewport=null;this._handler=null;};return T;});\n",
	"sap/ui/vk/tools/TooltipTool.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Tool','./TooltipToolHandler','./TooltipToolGizmo'],function(q,l,T,a,b){'use strict';var c=T.extend('sap.ui.vk.tools.TooltipTool',{metadata:{events:{hover:{parameters:{x:'int',y:'int',nodeRef:'any'}}}},constructor:function(i,s){if(c._instance){return c._instance;}T.apply(this,arguments);this._viewport=null;this._handler=null;c._instance=this;}});c.prototype.init=function(){if(T.prototype.init){T.prototype.init.call(this);}this.setFootprint(['sap.ui.vk.threejs.Viewport']);this.setAggregation('gizmo',new b());};c.prototype.setActive=function(v,d,g){T.prototype.setActive.call(this,v,d,g);if(this.getActive()){this._activateTool(d);}else{this._deactivateTool();}return this;};c.prototype._activateTool=function(d){this._viewport=this.getViewportImplementation(d);this._handler=new a(this);this._gizmo=this.getGizmo();if(this._gizmo){this._gizmo.show(this._viewport,this);}this._prepare();};c.prototype._deactivateTool=function(){if(this._handler){if(this._viewport._loco){this._viewport._loco.removeHandler(this._handler);}this._handler=null;}if(this._gizmo){this._gizmo.hide();this._gizmo=null;}};c.prototype._prepare=function(){var o=false;if(this._viewport._loco){this._viewport._loco.addHandler(this._handler);o=true;}return o;};c.prototype.setTitle=function(t){if(this._gizmo){this._gizmo.setTitle(t);}return this;};c.prototype.queueCommand=function(d){if(this._prepare()){if(this.isViewportType('sap.ui.vk.dvl.Viewport')){if(this._dvlRendererId){this._dvl.Renderer._queueCommand(d,this._dvlRendererId);}}else if(this.isViewportType('sap.ui.vk.threejs.Viewport')){d();}}return this;};c.prototype.destroy=function(){T.prototype.destroy.call(this);this._viewport=null;this._handler=null;};return c;});\n",
	"sap/ui/vk/tools/TooltipToolGizmo.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','./library','./Gizmo','./TooltipToolGizmoRenderer'],function(q,l,G,T){'use strict';var a=G.extend('sap.ui.vk.tools.TooltipToolGizmo',{metadata:{library:'sap.ui.vk.tools'}});a.prototype.init=function(){if(G.prototype.init){G.prototype.init.apply(this);}this._viewport=null;this._tool=null;};a.prototype.show=function(v,t){this._viewport=v;this._tool=t;var b=this.getDomRef();if(b){b.style.display='none';}};a.prototype.hide=function(){this._tool=null;var t=this.getDomRef();if(t){t.style.display='none';}};a.prototype.setTitle=function(t){var b=this.getDomRef();if(b){b.style.display=t?'block':'none';b.innerText=t;}};a.prototype.update=function(x,y,b,c,n){if(this._tool.fireEvent('hover',{x:x,y:y,nodeRef:n},true)){var t=this.getDomRef();if(t){var o=t.offsetParent;while(o){b-=o.offsetLeft||0;c-=o.offsetTop||0;o=o.offsetParent;}b+=10;c+=15;t.style.left=Math.round(b)+'px';t.style.top=Math.round(c)+'px';var v=this._viewport.getDomRef().getBoundingClientRect();var d=t.getBoundingClientRect();if(d.right>v.right){t.style.left=Math.round(b+v.right-d.right)+'px';}if(d.bottom>v.bottom){t.style.top=Math.round(c+v.bottom-d.bottom)+'px';}}}};a.prototype.onBeforeRendering=function(){};a.prototype.onAfterRendering=function(){};return a;},true);\n",
	"sap/ui/vk/tools/TooltipToolGizmoRenderer.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var T={};T.render=function(r,c){r.write('<div');r.writeControlData(c);r.addClass('sapUiVizKitTooltip');r.writeClasses();r.write('>');r.write('</div>');};return T;},true);\n",
	"sap/ui/vk/tools/TooltipToolHandler.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global','sap/ui/base/EventProvider'],function(q,E){'use strict';var T=E.extend('sap.ui.vk.tools.TooltipToolHandler',{metadata:{},constructor:function(t){this._tool=t;this._rect=null;this._rayCaster=new THREE.Raycaster();this._mouse=new THREE.Vector2();}});T.prototype.destroy=function(){this._tool=null;this._rect=null;};T.prototype._updateMouse=function(e){var s=this.getViewport().getRenderer().getSize();this._mouse.x=((e.x-this._rect.x)/s.width)*2-1;this._mouse.y=((e.y-this._rect.y)/s.height)*-2+1;this._rayCaster.setFromCamera(this._mouse,this.getViewport().getCamera().getCameraRef());};T.prototype.hover=function(e){var g=this._tool.getGizmo();if(g&&this._inside(e)&&this.getViewport().getScene()){this._updateMouse(e);var i=this._rayCaster.intersectObject(this.getViewport().getScene().getSceneRef(),true);g.update(e.x-this._rect.x,e.y-this._rect.y,e.x,e.y,i.length>0?i[0].object:null);e.handled=i.length>0;}};T.prototype.beginGesture=function(e){};T.prototype.move=function(e){};T.prototype.endGesture=function(e){};T.prototype.click=function(e){};T.prototype.doubleClick=function(e){};T.prototype.contextMenu=function(e){};T.prototype.getViewport=function(){return this._tool._viewport;};T.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};T.prototype._inside=function(e){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d==null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};return T;},true);\n",
	"sap/ui/vk/tools/library.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n        (c) Copyright 2009-2015 SAP SE. All rights reserved\n    \n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';sap.ui.getCore().initLibrary({name:'sap.ui.vk.tools',dependencies:['sap.ui.core'],types:['sap.ui.vk.tools.HitTestIdMode','sap.ui.vk.tools.HitTestClickType','sap.ui.vk.tools.CoordinateSystem','sap.ui.vk.tools.PredefinedView'],interfaces:[],controls:['sap.ui.vk.tools.MoveTool','sap.ui.vk.tools.RotateTool','sap.ui.vk.tools.ScaleTool','sap.ui.vk.tools.TooltipTool','sap.ui.vk.tools.SceneOrientationTool','sap.ui.vk.tools.RotateOrbitTool','sap.ui.vk.tools.RotateOrbitToolGizmo','sap.ui.vk.tools.RotateTurntableTool','sap.ui.vk.tools.RotateTurntableToolGizmo','sap.ui.vk.tools.HitTestTool','sap.ui.vk.tools.RectSelectTool','sap.ui.vk.tools.Tool'],elements:[],noLibraryCSS:true,version:'1.64.0'});sap.ui.vk.tools.HitTestIdMode={ThreeJS:'ThreeJS',VEsID:'VEsID',Callback:'Callback'};sap.ui.vk.tools.CoordinateSystem={Local:'Local',World:'World',Screen:'Screen'};sap.ui.vk.tools.PredefinedView={Initial:'Initial',Front:'Front',Back:'Back',Left:'Left',Right:'Right',Top:'Top',Bottom:'Bottom'};sap.ui.vk.tools.HitTestClickType={Single:'Single',Double:'Double',Context:'Context'};return sap.ui.vk.tools;});\n",
	"sap/ui/vk/totara/AnimationHandler.js":"sap.ui.define(['jquery.sap.global','./TotaraUtils'],function(q,T){'use strict';var A=function(){};A.setPlayback=function(s,c){if(T.checkError(c)){return c;}var r={};var a=s.viewIdSceneIdMap.get(c.viewId);if(!a){c.error='Try to extract play backs for unmatching scene';return c;}var b=new Set();for(var d=0;d<c.playbacks.length;d++){var p=c.playbacks[d];s.sceneBuilder.insertPlayback(p,c.viewId,a);var e=s.sceneBuilder.getSequence(p.sequenceId);if(e){continue;}else{b.add(p.sequenceId);s.sequenceIds.add(p.sequenceId);}}r.sequenceIdSet=b;r.viewId=c.viewId;s.currentViewId=r.viewId;return r;};A.setSequence=function(s,c){if(T.checkError(c)){return c;}var r={};var t=new Set();for(var a=0;a<c.sequences.length;a++){var b=c.sequences[a];s.sceneBuilder.insertSequence(b);for(var n=0;n<b.nodes.length;n++){var d=b.nodes[n];t.add(d.trackId);s.trackIds.add(d.trackId);}s.sequenceIds.delete(b.id);}r.trackIdSet=t;return r;};A.setTrack=function(s,c){if(T.checkError(c)){return c;}var r={};for(var t=0;t<c.tracks.length;t++){var a=c.tracks[t];s.sceneBuilder.insertTrack(a);s.trackIds.delete(a.id);}return r;};return A;});\n",
	"sap/ui/vk/totara/AnnotationHandler.js":"sap.ui.define(['jquery.sap.global','./TotaraUtils'],function(q,T){'use strict';var A=function(){};function a(s,b,c,l,m){l.material=m;s.sceneBuilder.insertLeaderLine(b,c,l);}A.setAnnotation=function(s,c){if(T.checkError(c)){return c;}c.annotations.forEach(function(b){var v=s.contextMap.values();var d=v.next();while(!d.done){var e=d.value;d=v.next();var n=e.annotationNodeMap.get(b.id);if(n){s.sceneBuilder.createAnnotation(e.sceneId,n,b);for(var i=0,l=b.leaderLines.length;i<l;i++){var f=b.leaderLines[i];var m=s.sceneBuilder.getMaterial(f.materialId);if(m){a(s,e.sceneId,b.id,f,m);}else{var g=s.leaderLineMaterialIdMap.get(f.materialId);if(!g){g=[];s.leaderLineMaterialIdMap.set(f.materialId,g);}g.push({sceneId:e.sceneId,annotationId:b.id,leaderLine:f});s.materialIdsToRequest.add(f.materialId);}}}}});};A.updateMaterials=function(s,c){c.materials.forEach(function(m){var l=s.leaderLineMaterialIdMap.get(m.id);if(l){s.leaderLineMaterialIdMap.delete(m.id);m=s.sceneBuilder.getMaterial(m.id);l.forEach(function(i){a(s,i.sceneId,i.annotationId,i.leaderLine,m);});}});};return A;});\n",
	"sap/ui/vk/totara/CallbackHandler.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';var C=function(){var c=[];this.attach=function(a){c.push(a);};this.detach=function(a){var i=c.indexOf(a);if(i!==-1){c.splice(i,1);return true;}return false;};this.execute=function(a){for(var i=0;i<c.length;i++){c[i](a);}};};return C;});\n",
	"sap/ui/vk/totara/CameraHandler.js":"sap.ui.define(['jquery.sap.global','./TotaraUtils'],function(q,T){'use strict';var C=function(){};C.setCameraSingle=function(s,c,a){if(!c.near){c.near=1;}if(!c.far){c.far=200000;}if(!c.zoom){c.zoom=0.02;}s.sceneBuilder.createCamera(c,a);return s.sceneBuilder.getCamera(c.id);};C.setCamera=function(s,c){if(T.checkError(c)){return c;}var r={};var a=c.cameras;if(Array.isArray(a)){for(var i=0;i<a.length;i++){C.setCameraSingle(s,a[i],c.sceneId);}}return r;};return C;});\n",
	"sap/ui/vk/totara/Coder.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';var C=function(){};C.encode=function(c){var u=unescape(encodeURIComponent(c));var a=new Uint8Array(u.length);for(var i=0;i<u.length;i++){a[i]=u.charCodeAt(i);}return a.buffer;};C.uint8ArrayToString=function(u){var f='';try{var a=0x8000;var i=0;var l=u.length;var s;while(i<l){s=u.slice(i,Math.min(i+a,l));f+=String.fromCharCode.apply(null,s);i+=a;}}catch(e){f='';}return f;};C.decode=function(u){var e=C.uint8ArrayToString(u);return decodeURIComponent(escape(e));};});\n",
	"sap/ui/vk/totara/Commands.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';var C=function(){};C.setStreamingToken='setStreamingToken';C.setCamera='setCamera';C.notifyFinishedTree='notifyFinishedTree';C.notifyFinishedMaterial='notifyFinishedMaterial';C.notifyFinishedImage='notifyFinishedImage';C.notifyFinishedMesh='notifyFinishedMesh';C.notifyFinishedGeometry='notifyFinishedGeometry';C.setMesh='setMesh';C.setAnnotation='setAnnotation';C.setMaterial='setMaterial';C.setGeometry='setGeometry';C.setImage='setImage';C.notifyError='notifyError';C.setTree='setTree';C.setTreeNode='setTreeNode';C.requestScene='requestScene';C.getTree='getTree';C.getMesh='getMesh';C.getAnnotation='getAnnotation';C.getMaterial='getMaterial';C.getGeometry='getGeometry';C.getImage='getImage';C.addClientLog='addClientLog';C.timestamp='timestamp';C.getView='getView';C.getDynamicView='getDynamicView';C.setView='setView';C.setViewNode='setViewNode';C.notifyFinishedView='notifyFinishedView';C.setPlayback='setPlayback';C.getSequence='getSequence';C.setSequence='setSequence';C.getTrack='getTrack';C.setTrack='setTrack';C.setViewGroup='setViewGroup';C.getViewGroups='getViewGroups';return C;});\n",
	"sap/ui/vk/totara/Generator.js":"sap.ui.define(['jquery.sap.global','./Commands'],function(q,C){'use strict';var G=function(){};G.createSetStreamingTokenCommand=function(o){var r=JSON.stringify(o);var c=C.setStreamingToken+('['+r.length+']')+r;return c;};G.createGetTreeCommand=function(o){var r=JSON.stringify(o);var c=C.getTree+('['+r.length+']')+r;return c;};G.createGetViewCommand=function(o){var r=JSON.stringify(o);var c=C.getView+('['+r.length+']')+r;return c;};G.createGetViewGroupsCommand=function(o){var r=JSON.stringify(o);var c=C.getViewGroups+('['+r.length+']')+r;return c;};G.createGetDynamicViewCommand=function(o){var r=JSON.stringify(o);var c=C.getDynamicView+('['+r.length+']')+r;return c;};G.createGetContentCommand=function(c,i,t,s){var a={ids:i.map(function(b){return parseInt(b,10);})};if(t){a.token=t;}if(s){a.sceneId=s;}a=JSON.stringify(a);return{command:c+('['+a.length+']')+a,method:c};};G.createRequestContentCommandWtihScenId=function(c,i,s,t){var a={ids:i.map(function(b){return parseInt(b,10);})};if(s){a.sceneId=s;}if(t){a.token=t;}a=JSON.stringify(a);return{command:c+('['+a.length+']')+a,method:c};};G.createAddClientLogCommand=function(l){var c={duration:l.duration};if(l.name){c.name=l.name;}if(l.message){c.message=l.message;}if(l.token){c.token=l.token;}if(l.error){c.error=l.error;}if(l.result&&l.result==='failuer'){c.error=l.message;}if(l.timestamp){c.timestamp=l.timestamp;}c=JSON.stringify(c);c=C.addClientLog+('['+c.length+']')+c;return c;};return G;});\n",
	"sap/ui/vk/totara/GeometryFactory.js":"sap.ui.define(['jquery.sap.global','./IndexCompressor'],function(q,I){'use strict';var a=1;var H=2;var b=4;var V=0;var c=3;var P=Math.PI*2;var G=function(){};G.getGeometryInfo=function(g,f){var h=new DataView(f.buffer,f.byteOffset,f.byteLength);var o=0;var k=(g.flags&H)>0;var l=(g.flags&b)>0;var m=(g.flags&a)>0;var n=false;var p=[];var r=[];var u=[];var s=[];var t=1;var v=1;var w=1;var x=new THREE.Vector3(0,0,0);var y=[x.x-t/2,x.y-v/2,x.z-w/2,x.x+t/2,x.y+v/2,x.z+w/2];var z=new I(f,f.length);z.setCurByte(o);if(!z.ReadCommand()){throw'buffer over flow';}var A=z.rvalue;var B;if(A){B=U(z,g.pointCount,A,y,p);if(B.isOk){p=B.array;n=true;}else{return false;}}var C=1;if(k){if(!z.ReadCommand()){return false;}C=z.rvalue;if(C){B=d(z,g.pointCount,C);if(B.isOk){r=B.array;}else{return false;}}}var D=1;var N=false;if(l){if(!z.ReadCommand()){return false;}D=z.rvalue;if(D){B=e(z,g.pointCount,D);if(B.isOk){N=true;u=B.array;}else{return false;}}}if(!A||!C||!D||N){if(N){o=z.getCurByte();var E=h.getFloat32(o,true);var F=h.getFloat32(o+4,true);z.moveCurByte(8);if((E!==0.0)||(F!==1.0)){var J=F-E;for(var K=0;K<g.pointCount*2;K++){u[K]=u[K]*J+E;}}}var L;if(!A){o=z.getCurByte();for(L=0;L<g.pointCount;L++){p.push(h.getFloat32(o+L*4,true));p.push(h.getFloat32(o+(L+g.pointCount)*4,true));p.push(h.getFloat32(o+(L+g.pointCount*2)*4,true));}z.moveCurByte(g.pointCount*3*4);}if(!C){o=z.getCurByte();for(L=0;L<g.pointCount;L++){r.push(h.getFloat32(o+(L)*4,true));r.push(h.getFloat32(o+(L+g.pointCount*1)*4,true));r.push(h.getFloat32(o+(L+g.pointCount*2)*4,true));}z.moveCurByte(g.pointCount*3*4);}if(!D){if(l){o=z.getCurByte();for(L=0;L<g.pointCount;L++){u.push(h.getFloat32(o+(L)*4,true));u.push(h.getFloat32(o+(L+g.pointCount*1)*4,true));}z.moveCurByte(g.pointCount*2*4);}}}var M=z.getCurByte();z.Reset();z.setCurByte(M);var O=[0,0,0];var Q=m?2:3;for(var i=0;i<g.elementCount;i++){for(var j=0;j<Q;j++){if(!z.ReadCommand(O[j])){throw'UIC1 Decompression error!!!';}else{s.push(z.rvalue);O[j]=z.rvalue;}}}var R={};R.isPolyline=m;R.isPositionQuantized=n;R.data={};R.data.indices=s;R.data.points=p;R.data.normals=r;R.data.uvs=u;R.id=g.id;return R;};function U(f,p,n,g){var r={array:new Array(p*3),isOk:false};for(var x=0;x<3;x++){var v=g[V+x];var h=(g[c+x]-v)/n;for(var i=0;i<p;i++){if(!f.ReadCommand()){return r;}r.array[i*3+x]=h*f.rvalue+v;}}r.isOk=true;return r;}function d(i,p,n){var r={array:[],isOk:false};var t=[];var f;for(f=0;f<p;f++){if(!i.ReadCommand()){return r;}t.push(i.rvalue);}var g=P/n;var h;var j;var k;for(f=0;f<p;f++){if(!i.ReadCommand()){return r;}h=g*t[f];j=g*i.rvalue;k=Math.sin(j);r.array.push(k*Math.cos(h));r.array.push(k*Math.sin(h));r.array.push(Math.cos(j));}r.isOk=true;return r;}function e(f,p,n){var r={array:new Array(p*2),isOk:false};var g=1.0/n;for(var u=0;u<2;u++){for(var i=0;i<p;i++){if(!f.ReadCommand()){return false;}r.array[i*2+u]=g*f.rvalue;}}r.isOk=true;return r;}return G;});\n",
	"sap/ui/vk/totara/ImageHandler.js":"sap.ui.define(['jquery.sap.global','./MaterialHandler','./TotaraUtils','./Coder'],function(q,M,T,C){'use strict';var I=function(){};I.setImage=function(s,i,a){if(T.checkError(i)){return i;}var r={};if(!a){if(T.checkError(i)){return i;}else{r.error='no image content for '+i.id;}return r;}i.binaryData=a;s.sceneBuilder.createImage(i);var b=s.thumbnailImageIdAndViewIdSceneIdMap.get(i.id);if(b){s.sceneBuilder.setViewThumbnail(i.id,b.viewId,b.sceneId);s.onViewGroupUpdatedCallbacks.execute();}M.updateTexture(s,i.id);r.id=i.id;return r;};return I;});\n",
	"sap/ui/vk/totara/IndexCompressor.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';var I=function(b,a){var V=32;var c=16;var C=13;var e=14;var f=0;var g=1;var h=3;var i=4;var k=5;var l=6;var m=7;var n=8;var o=9;var p=10;var r=11;var s=12;var t=15;var E=0;var u=1;var v=2;var w=3;var x=4;var y=5;var z=6;var A=7;var B=8;var D=9;var F=10;var G=11;var H=12;var J=13;var K=4294967295;var L=0;this.rvalue=0;var M=0;var N=b;var O=a;var P=0;var Q=new Array(V);var R=new Array(c);var S=V-1;var T=c-1;var U=false;this.Reset=function(){L=0;this.rvalue=0;M=0;P=0;var j;for(j=0;j<V;j++){Q[j]=V-j-1;}for(j=0;j<c;j++){R[j]=1;}S=V-1;T=c-1;};this.Reset();function W(d){return Q[(S>=d)?(S-d):(V+S-d)];}function X(d){return R[(T>=d)?(T-d):(c+T-d)];}function Y(d){S++;if(S>=V){S=0;}Q[S]=d;}function Z(d){T++;if(T>=c){T=0;}R[T]=d;}function $(){if(P<O){return N[P++];}U=true;return 0;}function _(){return $()+$()*256;}function a1(){return $()+$()*256+$()*65536+$()*16777216;}this.ReadCommand=function(j){if(j===undefined){j=K;}U=false;var b1=this.rvalue;if(L){L--;this.rvalue=W(M);}else{var c1=$();if(U){c1=g;}var d1=c1>>>4;switch(c1&0xF){case f:this.rvalue=W(d1);break;case k:this.rvalue=W(16+d1);break;case C:this.rvalue=W(d1>>>2);M=d1&3;L=1;break;case e:this.rvalue=W(0);M=0;L=d1+2;break;case l:this.rvalue+=X(d1);break;case g:if(c1&16){this.rvalue+=(c1>>>5)+1;}else{this.rvalue-=(c1>>>5)+1;}break;case h:this.rvalue=j+(d1+1);break;case i:this.rvalue=j-(d1+1);break;case m:this.rvalue=j+(d1+17);break;case n:this.rvalue=j-(d1+17);break;case o:this.rvalue+=d1+(($())<<4)+3;break;case p:this.rvalue-=d1+(($())<<4)+3;break;case r:this.rvalue=d1+(($())<<4);break;case s:var e1=_();this.rvalue=d1+(e1<<4);break;case t:switch(c1>>>4){case E:case u:case v:case w:case x:this.rvalue=c1>>>4;break;case y:this.rvalue=0x000000FF;break;case z:this.rvalue=0x0000FF00;break;case A:this.rvalue=0x00FF0000;break;case B:this.rvalue=0xFF000000;break;case D:this.rvalue=0x00FFFFFF;break;case F:this.rvalue=0xFFFFFFFF;break;case J:M=0;L=_()+36;break;case G:{var bl=$();this.rvalue=(_()<<8)+bl;}break;case H:this.rvalue=a1();break;default:return false;}break;default:return false;}}if(this.rvalue>0xFFFFFFFF){this.rvalue=this.rvalue-0xFFFFFFFF-1;}Y(this.rvalue);var d;if(this.rvalue!=b1){if(this.rvalue>b1){d=this.rvalue-b1;if(d<0x7FFFFFFF){Z(d);}}else{d=b1-this.rvalue;if(d<0x7FFFFFFF){Z(-d);}}}if(U){L=0;this.rvalue=0;return false;}return true;};this.getCurByte=function(){return P;};this.setCurByte=function(d){P=d;};this.moveCurByte=function(d){P=P+d;};};return I;});\n",
	"sap/ui/vk/totara/ListMap.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';var L=function(){this.map=new Map();};L.prototype.get=function(k){return this.map.get(k);};L.prototype.getOrCreate=function(k){var v=this.map.get(k);if(!v){v=[];this.map.set(k,v);}return v;};L.prototype.set=function(k,v){return this.map.set(k,v);};L.prototype.keys=function(){return this.map.keys();};L.prototype.values=function(){return this.map.values();};L.prototype.delete=function(k){return this.map.delete(k);};L.prototype.clear=function(){this.map.clear();};Object.defineProperty(L.prototype,'size',{get:function(){return this.map.size;}});return L;});\n",
	"sap/ui/vk/totara/MaterialHandler.js":"sap.ui.define(['jquery.sap.global','./TotaraUtils','./AnnotationHandler'],function(q,T,A){'use strict';var M=function(){};M.setMaterial=function(s,c){if(T.checkError(c)){return c;}var m=c.materials;var r={imageIdSet:new Set()};for(var i=0;i<m.length;i++){var a=m[i];var b=[];b=s.sceneBuilder.createMaterial(a);var t=s.sceneBuilder.getMaterial(a.id);if(!t.userData){t.userData={};}if(!t.userData.idsOfImagesToRead){t.userData.idsOfImagesToRead=new Set();}else{t.userData.idsOfImagesToRead.clear();}if(b.length){for(var d=0;d<b.length;d++){var p=b[d];var e=s.texturesToUpdate;var f=e.get(p.imageId);if(!f){f=[];e.set(p.imageId,f);}f.push({textureType:p.textureType,materialId:a.id});r.imageIdSet.add(p.imageId);t.userData.idsOfImagesToRead.add(p.imageId);}}var v=s.contextMap.values();var g=v.next();while(!g.done){var h=g.value;g=v.next();var n=h.materialIdNodeListMapForOpacityUpdate.get(a.id);if(n){for(var j=0;j<n.length;j++){s.sceneBuilder.applyNodeOpacityToSubmeshes(n[j],h.sceneId,a.id);}h.materialIdNodeListMapForOpacityUpdate.delete(a.id);}}s.materialIdsRequested.delete(a.id);}A.updateMaterials(s,c);return r;};M.updateTexture=function(s,a){var t=s.texturesToUpdate.get(a);if(t){for(var i=0,b=t.length;i<b;i++){var c=t[i];s.sceneBuilder.updateTextureMap(c.materialId,c.textureType);}s.texturesToUpdate.delete(a);}};return M;});\n",
	"sap/ui/vk/totara/MeshHandler.js":"sap.ui.define(['jquery.sap.global','./TotaraUtils','./GeometryFactory','./MaterialHandler','./SceneStateContext'],function(q,T,G,M,S){'use strict';var a=function(){};a.setMesh=function(s,c,b){if(T.checkError(c)){return c;}var r={updatedContexts:[],materialIdSet:new Set(),geometryIdMap:new Map()};var m=c.meshes;var d=s.materialIdsToRequest;var e;var v=s.contextMap.values();var f=v.next();while(!f.done){f.value.isUpdatedBySetMesh=false;f=v.next();}for(var i=0;i<m.length;i++){var g=m[i];var h=g.id;for(var j=0;j<g.submeshes.length;j++){var l=g.submeshes[j];var o=s.sceneBuilder.setSubmesh(h,l);if(o.needUpdataMaterial){r.materialIdSet.add(l.materialId);d.add(l.materialId);}if(o.geometryIdToRequest){r.geometryIdMap.set(o.geometryIdToRequest,o.geometryPriority);s.geometryIdMaterialIdMap.set(o.geometryIdToRequest,l.materialId);}}v=s.contextMap.values();f=v.next();while(!f.done){e=f.value;f=v.next();var p=e.meshGroupListMap.get(h);if(p){e.isUpdatedBySetMesh=true;var t=function(C){var D=[];C.forEach(function(E){D.push(E);});return D;};for(var k=0;k<p.length;k++){var u=p[k];var w=s.sceneBuilder.attachSubMeshesToNode(u,e.sceneId);s.sceneBuilder.applyNodeMaterialToSubmeshes(u,e.sceneId);var x=s.sceneBuilder.applyNodeOpacityToSubmeshes(u,e.sceneId);if(x.materialIds.length){for(var y=0;y<x.materialIds.length;y++){var z=e.materialIdNodeListMapForOpacityUpdate.getOrCreate(x.materialIds[y]);z.push(u);}}var A=t(w.idOfGeometriesToUpdate);for(var n=0;n<A.length;n++){var B=e.boundingBoxNodeIdsListMap.getOrCreate(A[n]);B.push(u);}}e.meshGroupListMap.delete(h);e.progressCount.mesh.count++;}}}v=s.contextMap.values();f=v.next();while(!f.done){e=f.value;f=v.next();if(e.isUpdatedBySetMesh){r.updatedContexts.push(e);delete e.isUpdatedBySetMesh;}}return r;};a.setGeometry=function(s,g,b){if(T.checkError(g)){return g;}var r={updatedContexts:[]};var c=g.id;if(!b||b.length===0){r.error='missing geometry '+c;return r;}var d=G.getGeometryInfo(g,b);s.sceneBuilder.setGeometry(d);var v=s.contextMap.values();var e=v.next();while(!e.done){var f=e.value;e=v.next();var n=f.boundingBoxNodeIdsListMap.get(c);if(n){r.updatedContexts.push(f);for(var i=0;i<n.length;i++){s.sceneBuilder.updateGeometryInNode(n[i],c,f.sceneId);}f.boundingBoxNodeIdsListMap.delete(c);}if(f.boundingBoxNodeIdsListMap.size===0){f.phase=S.Phase.FinishedGeometry;}f.progressCount.geometry.count++;}if(g&&g.flags){var h=(g.flags&2)>0;if(!h){var m=s.geometryIdMaterialIdMap.get(c);if(m){s.sceneBuilder.updateMaterialForGeometryWithoutNormal(m);}}}return r;};return a;});\n",
	"sap/ui/vk/totara/NotificationHandler.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';var N=function(){};N.notifyError=function(s,e){return e?e:{error:'unknown error'};};N.notifyFinishedMaterial=function(s,c){var r={};return r;};N.notifyFinishedImage=function(s,c){var r={};return r;};N.notifyFinishedMesh=function(s,c){var r={};return r;};N.notifyFinishedGeometry=function(s,c){var r={};return r;};N.timestamp=function(s,c){var r={};return r;};return N;});\n",
	"sap/ui/vk/totara/Parser.js":"sap.ui.define(['jquery.sap.global','./Coder'],function(q,C){'use strict';var P=function(){};P.createCommandList=function(a,o){var b=new Uint8Array(a);var c=[];var s=0;var d=0;var h;var j;var i;while(d<b.length){d=f('['.charCodeAt(0),s,b);if(d===-1){break;}var k=C.decode(b.slice(s,d)).replace(/\\n|\\r|\\s/g,'');s=d+1;d=f(']'.charCodeAt(0),s,b);if(d===-1){throw'No matching [] for command length. abort';}h=g(C.decode(b.slice(s,d)));s=d+1;d=s+h.jsonContentLength;j=C.decode(b.slice(s,d));try{j=JSON.parse(j);}catch(e){var l=k+': '+e;throw l;}if(h.binaryContentLength){s=d;d=s+h.binaryContentLength;i=b.slice(s,d);}else{i=undefined;}s=d;var m={name:k,jsonContent:j,binaryContent:i};if(o){o(m);}c.push(m);}return c;};function f(c,s,u){for(var i=s;i<u.length;i++){if(u[i]===c){return i;}}return-1;}function g(c){var l=c.split(',');if(l.length<0||l.length>2){throw'invalid content length';}var j=0;var b=0;try{j=parseInt(l[0],10);if(l.length===2){b=parseInt(l[1],10);}}catch(e){throw'invalid content length';}return{jsonContentLength:j,binaryContentLength:b};}});\n",
	"sap/ui/vk/totara/Processor.js":"sap.ui.define(['jquery.sap.global','./Commands','./CameraHandler','./TreeHandler','./NotificationHandler','./MeshHandler','./MaterialHandler','./ImageHandler','./ViewHandler','./AnimationHandler','./AnnotationHandler'],function(q,C,a,T,N,M,b,I,V,A,c){'use strict';var P=function(){var d=new Map();var n=0;this.setCommandCallback=function(e,f){d.set(e,f);};this.process=function(s,e){var r;var f=false;if(e.sceneId){s.currentSceneInfo.id=e.sceneId;}switch(e.name){case C.setCamera:r=a.setCamera(s,e.jsonContent,e.binaryContent);break;case C.notifyFinishedMaterial:r=N.notifyFinishedMaterial(s,e.jsonContent,e.binaryContent);break;case C.notifyFinishedImage:r=N.notifyFinishedImage(s,e.jsonContent,e.binaryContent);break;case C.notifyFinishedMesh:r=N.notifyFinishedMesh(s,e.jsonContent,e.binaryContent);break;case C.notifyFinishedGeometry:r=N.notifyFinishedGeometry(s,e.jsonContent,e.binaryContent);break;case C.setMesh:r=M.setMesh(s,e.jsonContent,e.binaryContent);break;case C.setMaterial:r=b.setMaterial(s,e.jsonContent,e.binaryContent);break;case C.setGeometry:r=M.setGeometry(s,e.jsonContent,e.binaryContent);break;case C.setAnnotation:r=c.setAnnotation(s,e.jsonContent,e.binaryContent);break;case C.setImage:r=I.setImage(s,e.jsonContent,e.binaryContent);break;case C.notifyError:r=N.notifyError(s,e.jsonContent,e.binaryContent);break;case C.timestamp:r=N.timestamp(s,e.jsonContent,e.binaryContent);break;case C.setTree:r=T.setTree(s,e.jsonContent);break;case C.setTreeNode:r=T.setTreeNode(s,e.jsonContent);break;case C.notifyFinishedTree:r=T.notifyFinishedTree(s,e.jsonContent);break;case C.setView:r=V.setView(s,e.jsonContent);break;case C.setPlayback:r=A.setPlayback(s,e.jsonContent);break;case C.setViewNode:r=V.setViewNode(s,e.jsonContent);break;case C.notifyFinishedView:r=V.notifyFinishedView(s,e.jsonContent);break;case C.setSequence:r=A.setSequence(s,e.jsonContent);break;case C.setTrack:r=A.setTrack(s,e.jsonContent);break;case C.setViewGroup:r=V.setViewGroup(s,e.jsonContent);break;default:f=true;break;}var g=e.name;if(r&&r.error&&g!==C.notifyError){var h=d.get(C.notifyError);if(h){h(r);}}var i=d.get(g);if(i){i(r);}if(f){n++;}return r;};this.getNumberOfCommandsSkipped=function(){return n;};};return P;});\n",
	"sap/ui/vk/totara/ProgressCounter.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';function C(){this._count=0;this._total=0;var o;this.setOnValueChanged=function(c){o=c;};this.callOnValueChanged=function(){if(o){o();}};}var p=C.prototype;Object.defineProperty(p,'count',{get:function(){return this._count;},set:function(v){if(v!==this._count){this._count=v;this.callOnValueChanged();}}});Object.defineProperty(p,'total',{get:function(){return this._total;},set:function(v){if(v!==this._total){this._total=v;this.callOnValueChanged();}}});var P=function(){var o;function a(){if(o){o(this);}}this.mesh=new C();this.geometry=new C();this.mesh.setOnValueChanged(a);this.geometry.setOnValueChanged(a);this.setOnProgressChanged=function(c){o=c;};};return P;});\n",
	"sap/ui/vk/totara/RequestCommandGenerator.js":"sap.ui.define(['jquery.sap.global','./Generator','./Coder','./Commands'],function(q,G,C,c){'use strict';var R=function(){var m=128;var d=128;var e=128;var s=128;var t=128;var g=32;var f;var h;var i;var j;var k;var l;var n;var o;var v;var p;var r;this.init=function(){f=new Set();h=new Set();i=new Set();k=new Map();j=[];l=[];n=new Set();o=new Set();v=new Set();p=null;r=null;};this.init();this.setSceneIdAndContext=function(a,b){p=a;r=b;};this.pushMeshIds=function(a){u(f,a);};this.pushMaterialIds=function(a){u(h,a);};this.pushImageIds=function(a){u(i,a);};this.pushGeometryIds=function(x){x.forEach(function(a,b){k.set(b,a);j.push(b);});j.sort(function(a,b){return k.get(a)-k.get(b);});};this.pushAnnotationIds=function(a){l=l.concat(a);};this.pushTrackIds=function(a){u(n,a);};this.pushSequenceIds=function(a,p){u(o,a);};this.pushViewIds=function(a,p){u(v,a);};this.canGenerateCommand=function(){return f.size>0||h.size>0||i.size>0||j.length>0||n.size>0||o.size>0||v.size>0;};this.clearContent=function(){f.clear();h.clear();i.clear();j=[];n.clear();o.clear();v.clear();};this.generateRequestCommand=function(a,b,x){var y;var z;if(f.size>0){y=w(f,m);z=G.createGetContentCommand(c.getMesh,y,x);}else if(l.length>0){y=l.splice(0,d);z=G.createGetContentCommand(c.getAnnotation,y,x,p);}else if(h.size>0){y=w(h,e);z=G.createGetContentCommand(c.getMaterial,y,x);}else if(j.length>0){y=j.splice(j.length-g);z=G.createGetContentCommand(c.getGeometry,y,x);z.resources=y;y.forEach(function(B){k.delete(B);});}else if(i.size>0){y=w(i,1);z=G.createGetContentCommand(c.getImage,y,x);z.resources=y;}else if(o.size>0){y=w(o,s);z=G.createRequestContentCommandWtihScenId(c.getSequence,y,p,x);}else if(n.size>0){y=w(n,t);z=G.createGetContentCommand(c.getTrack,y,x);}else if(v.size>0){var A=v.values(),B=A.next().value;if(B!=undefined){var D=r.includeHidden!==undefined?r.includeHidden:false;var E=r.includeAnimation!==undefined?r.includeAnimation:true;var F={sceneId:p,id:B,token:x,includeHidden:D,includeAnimation:E};var H=G.createGetViewCommand(F);z={command:H,method:c.getView};v.delete(B);}}if(z){if(!a){z.command=C.encode(z.command);}return z;}return null;};function u(a,b){b.forEach(function(x){a.add(x);});}function w(a,b){var x=[];for(var y=a.values(),z=y.next().value;z!=undefined&&x.length<b;z=y.next().value){x.push(z);a.delete(z);}return x;}};return R;});\n",
	"sap/ui/vk/totara/SceneHandler.js":"sap.ui.define(['jquery.sap.global'],function(q){'use strict';var S=function(){};S.rotateNodeByUpAxies=function(a,b,t,c){var x=0,y=0,z=0;if(b==='z_positive'){if(a==='x_positive'){x=-90*Math.PI/180;}else if(a==='y_positive'){x=-90*Math.PI/180;z=-90*Math.PI/180;}else if(a==='x_nagetive'){x=-90*Math.PI/180;z=180*Math.PI/180;}else{x=-90*Math.PI/180;z=90*Math.PI/180;}}else if(b==='y_positive'){if(a==='x_positive'){return;}else if(a==='x_nagetive'){y=180*Math.PI/180;}else if(a==='z_positive'){y=90*Math.PI/180;}else if(a==='z_negative'){y=-90*Math.PI/180;}}t.rotation.x=x;t.rotation.y=y;t.rotation.z=z;if(c){var e=new THREE.Euler(x,y,z,'XYZ');var n=new THREE.Matrix4().makeRotationFromEuler(e);c.updateMatrix();c.matrix.multiplyMatrices(n,c.matrix);c.matrix.decompose(c.position,c.quaternion,c.scale);}};return S;});\n",
	"sap/ui/vk/totara/SceneState.js":"sap.ui.define(['jquery.sap.global','./ListMap','./RequestCommandGenerator','./CallbackHandler','./SceneStateContext','sap/ui/vk/threejs/SceneBuilder'],function(q,L,R,C,S,a){'use strict';var b=function(){this.currentSceneInfo={};this.sceneBuilder=new a();this.contextMap=new Map();this.viewIdSceneIdMap=new Map();this.texturesToUpdate=new Map();this.materialIdsToRequest=new Set();this.materialIdsRequested=new Set();this.geometryIdMaterialIdMap=new Map();this.leaderLineMaterialIdMap=new Map();this.thumbnailImageIdAndViewIdSceneIdMap=new Map();this.viewIdAndThumbnailImageIdScneIdMap=new Map();this.requestCommandGenerator=new R();this.trackIds=new Set();this.sequenceIds=new Set();this.onErrorCallbacks=new C();this.onMaterialFinishedCallbacks=new C();this.onImageFinishedCallbacks=new C();this.onSetGeometryCallbacks=new C();this.onSetTrackCallbacks=new C();this.onSetSequenceCallbacks=new C();this.onViewGroupUpdatedCallbacks=new C();this.onViewGroupFinishedCallbacks=new C();this.getContext=function(s){if(!s){return null;}return this.contextMap.get(s);};this.createContext=function(u,p){var c=new S();Object.assign(c,p);c.sceneId=u;c.requestCommandGenerator.setSceneIdAndContext(u,c);if(c.onActiveCamera){c.onActiveCameraCallbacks.attach(c.onActiveCamera);delete c.onActiveCamera;}if(c.onMeshFinished){c.onMeshFinishedCallbacks.attach(c.onMeshFinished);delete c.onMeshFinished;}if(c.onInitialSceneFinished){c.onInitialSceneFinishedCallbacks.attach(c.onInitialSceneFinished);delete c.onInitialSceneFinished;}if(c.onPartialRetrievalFinished){c.onPartialRetrievalFinishedCallbacks.attach(c.onPartialRetrievalFinished);delete c.onPartialRetrievalFinished;}if(c.onViewFinished){c.onViewFinishedCallbacks.attach(c.onViewFinished);delete c.onViewFinished;}if(c.onSceneCompleted){c.onSceneCompletedCallbacks.attach(c.onSceneCompleted);delete c.onSceneCompleted;}if(c.onProgressChanged){c.setOnProgressChanged(c.onProgressChanged);delete c.onProgressChanged;}this.contextMap.set(u,c);return c;};this.sidToObject3D=function(s){var c=this.contextMap.values();var d=c.next();var n=null;while(!d.done){var e=d.value;d=c.next();n=this.sceneBuilder.getNode(s,e.sceneId);if(n){break;}}return n;};this.object3DToSid=function(o){return this.sceneBuilder.getObjectId(o);};this.dispose=function(){this.currentSceneInfo=null;this.contextMap=null;this.sceneBuilder.clearup();this.sceneBuilder=null;this.texturesToUpdate=null;this.materialIdsToRequest=null;this.materialIdsRequested=null;this.geometryIdMaterialIdMap=null;this.thumbnailImageIdAndViewIdSceneIdMap=null;this.viewIdAndThumbnailImageIdScneIdMap=null;this.onErrorCallbacks=null;this.onMaterialFinishedCallbacks=null;this.onImageFinishedCallbacks=null;this.onSetGeometryCallbacks=null;this.onSetTrackCallbacks=null;this.onSetSequenceCallbacks=null;};this.cleanup=function(){this.currentSceneInfo={};this.contextMap.clear();this.sceneBuilder.cleanup();this.texturesToUpdate.clear();this.materialIdsToRequest.clear();this.materialIdsRequested.clear();this.geometryIdMaterialIdMap.clear();this.viewIdSceneIdMap.clear();this.thumbnailImageIdAndViewIdSceneIdMap.clear();this.viewIdAndThumbnailImageIdScneIdMap.clear();this.trackIds.clear();this.sequenceIds.clear();this.requestCommandGenerator.clearContent();};};return b;});\n",
	"sap/ui/vk/totara/SceneStateContext.js":"sap.ui.define(['jquery.sap.global','./ListMap','./CallbackHandler','./ProgressCounter','./RequestCommandGenerator'],function(q,L,C,P,R){'use strict';var a={Started:0,FinishedHierarchy:1,FinishedMesh:2,FinishedGeometry:3};var b={Initial:0,Partial:1};var S=function(){this.phase=a.Started;this.retrievalType=b.Initial;this.sceneId=null;this.rootNodeId=null;this.root=null;this.requestCommandGenerator=new R();this.meshGroupListMap=new L();this.boundingBoxNodeIdsListMap=new L();this.annotationNodeMap=new Map();this.materialIdNodeListMapForOpacityUpdate=new L();this.progressCount=new P();this.treeNodes=[];this.viewIdTreeNodesMap=new Map();this.nodeSidsForPartialTree=new Set();this.replacedNodes=new Map();this.updatedNodes=new Set();this.viewIds=new Set();this.authorizationHandler=null;this.onActiveCameraCallbacks=new C();this.onInitialSceneFinishedCallbacks=new C();this.onPartialRetrievalFinishedCallbacks=new C();this.onSceneCompletedCallbacks=new C();this.onViewFinishedCallbacks=new C();this.onMeshFinishedCallbacks=new C();this.setOnProgressChanged=function(c){this.progressCount.setOnProgressChanged(c);};this.isSceneCompleted=function(){return this.meshGroupListMap.size===0&&this.boundingBoxNodeIdsListMap.size===0;};this.dispose=function(){this.sceneId=null;this.meshGroupListMap=null;this.progressCount=null;this.requestCommandGenerator=null;this.suppressedBoundingBoxListMap=null;this.boundingBoxNodeIdsListMap=null;this.treeNodes=null;this.nodeSidsForPartialTree=null;this.materialIdNodeListMapForOpacityUpdate=null;this.replacedNodes=null;this.updatedNodes=null;this.viewIds=null;this.viewIdTreeNodesMap=null;this.onActiveCameraCallbacks=null;this.onInitialSceneFinishedCallbacks=null;this.onPartialRetrievalFinishedCallbacks=null;this.onSceneCompletedCallbacks=null;this.onViewFinishedCallbacks=null;this.onMeshFinishedCallbacks=null;};};S.Phase={Started:0,FinishedHierarchy:1,FinishedMesh:2,FinishedGeometry:3};S.RetrievalType={Initial:0,Partial:1};return S;});\n",
	"sap/ui/vk/totara/TotaraLoader.js":"sap.ui.define(['jquery.sap.global','./ListMap','./RequestCommandGenerator','./CallbackHandler','./SceneStateContext','./Processor','./Commands','./Generator','./SceneState','./TotaraUtils','sap/ui/thirdparty/URI'],function(q,L,R,C,S,P,a,G,b,T,U){'use strict';var c=function(){var _=new b();var d=false;var e=false;var f=new P();var g=null;var h=this;_.loader=this;function s(r,t){if(!h._worker){return false;}var i=false;if(r){while(r.canGenerateCommand()){var n=r.generateRequestCommand(true,t);h._worker.postMessage(n);i=true;}}return i;}function j(){var i=false;var t;var v=_.contextMap.values();var k=v.next();while(!k.done){var m=k.value;k=v.next();if(s(m.requestCommandGenerator,m.token)){i=true;}t=m.token;}if(!i){s(_.requestCommandGenerator,t);}}this.getUrl=function(){return g;};this.init=function(k){g=k;function o(i){if(i){i.phase=S.Phase.FinishedHierarchy;}if(!d){var m=i.meshGroupListMap;var n=new Set(m.keys());i.requestCommandGenerator.pushMeshIds(n);if(n.size===0){if(i.retrievalType===S.RetrievalType.Initial){i.onInitialSceneFinishedCallbacks.execute();}if(i.retrievalType===S.RetrievalType.Partial){i.onPartialRetrievalFinishedCallbacks.execute();}if(i.isSceneCompleted()){i.onSceneCompletedCallbacks.execute();}}}var p=_.materialIdsToRequest;if(p&&p.size){p.forEach(function(r){_.materialIdsRequested.add(r);});_.requestCommandGenerator.pushMaterialIds(p);_.materialIdsToRequest.clear();}if(!e&&i.annotationNodeMap.size>0){i.requestCommandGenerator.pushAnnotationIds(Array.from(i.annotationNodeMap.keys()));}j();}f.setCommandCallback(a.notifyFinishedTree,function(i){if(i.error){return;}var m=i.context;o(m);});f.setCommandCallback(a.setMesh,function(m){if(m.error){return;}var n=_.materialIdsToRequest;if(n&&n.size){n.forEach(function(r){_.materialIdsRequested.add(r);});_.requestCommandGenerator.pushMaterialIds(n);_.materialIdsToRequest.clear();}_.requestCommandGenerator.pushGeometryIds(m.geometryIdMap);if(m.updatedContexts){for(var i=0;i<m.updatedContexts.length;i++){var p=m.updatedContexts[i];if(p.meshGroupListMap.size===0){p.phase=S.Phase.FinishedMesh;p.onMeshFinishedCallbacks.execute();if(p.retrievalType===S.RetrievalType.Initial){p.onInitialSceneFinishedCallbacks.execute();}else if(p.retrievalType===S.RetrievalType.Partial){p.onPartialRetrievalFinishedCallbacks.execute();}if(p.isSceneCompleted()){p.onSceneCompletedCallbacks.execute();}p.progressCount.geometry.total=p.boundingBoxNodeIdsListMap.size;var t=p.token;if(p.isSceneCompleted()){l(p,'sceneCompleted',t);}else{l(p,'meshFinished',t);}}}}j();});f.setCommandCallback(a.setGeometry,function(m){if(m.error){return;}_.onSetGeometryCallbacks.execute(m);if(m.updatedContexts){for(var i=0;i<m.updatedContexts.length;i++){var n=m.updatedContexts[i];if(n.isSceneCompleted()){n.onSceneCompletedCallbacks.execute();var t=n.token;if(n.isSceneCompleted()){l(n,'sceneCompleted',t);}else{l(n,'geometryFinished',t);}n.finishedTime=Date.now();}}}});f.setCommandCallback(a.setAnnotation,function(i){var m=_.materialIdsToRequest;if(m&&m.size){m.forEach(function(n){_.materialIdsRequested.add(n);});_.requestCommandGenerator.pushMaterialIds(m);_.materialIdsToRequest.clear();j();}});f.setCommandCallback(a.setTree,function(i){if(i.result&&i.result==='failure'&&i.context){_.contextMap.delete(i.context.sceneId);}});f.setCommandCallback(a.setViewGroup,function(r){if(r.context){r.context.requestCommandGenerator.pushViewIds(r.viewIdSet);_.requestCommandGenerator.pushImageIds(r.imageIdSet);j();}});f.setCommandCallback(a.notifyFinishedView,function(r){if(r.error){return;}var i=r.context;if(i){var m=_.materialIdsToRequest;if(m&&m.size){m.forEach(function(y){_.materialIdsRequested.add(y);});_.requestCommandGenerator.pushMaterialIds(m);_.materialIdsToRequest.clear();j();}if(r.view){var n=[];i.updatedNodes.forEach(function(y){n.push(y);});r.view.updatedNodes=n;i.viewIds.delete(r.viewId);}var p=true;var v=_.contextMap.values();var t=v.next();while(!t.done){var u=t.value;if(u.viewIds.size>0){p=false;break;}t=v.next();}if(p){_.sceneBuilder.finalizeViewGroups();_.onViewGroupUpdatedCallbacks.execute();_.onViewGroupFinishedCallbacks.execute();}if(i.meshGroupListMap.size===0){i.onViewFinishedCallbacks.execute(r.view);}else{var w=new Set(i.meshGroupListMap.keys());i.requestCommandGenerator.pushMeshIds(w);var x=function(){i.onPartialRetrievalFinishedCallbacks.detach(x);i.onViewFinishedCallbacks.execute(r.view);};i.onPartialRetrievalFinishedCallbacks.attach(x);l(i,'notifyFinishedView',i.token);j();}}j();});f.setCommandCallback(a.setMaterial,function(r){if(r.error){return;}_.requestCommandGenerator.pushImageIds(r.imageIdSet);if(_.materialIdsRequested.size===0){_.onMaterialFinishedCallbacks.execute();}j();});f.setCommandCallback(a.setImage,function(r){if(r.error){return;}if(_.texturesToUpdate.size===0){_.onImageFinishedCallbacks.execute(r);}});f.setCommandCallback(a.setView,function(r){if(r.error){return;}var i=r.context;var t=i?i.token:null;l(i,'setView',t);});f.setCommandCallback(a.setPlayback,function(r){if(r.error){return;}if(r.sequenceIdSet.size>0){_.hasAnimation=true;var i=_.viewIdSceneIdMap.get(r.viewId);var m=_.getContext(i);if(m){m.requestCommandGenerator.pushSequenceIds(r.sequenceIdSet);}j();}else{_.hasAnimation=false;}});f.setCommandCallback(a.setSequence,function(r){if(r.error){return;}if(_.sequenceIds.size>0){j();}if(r.trackIdSet.size>0){_.requestCommandGenerator.pushTrackIds(r.trackIdSet);j();}else{_.hasAnimation=false;_.onSetSequenceCallbacks.execute();}});f.setCommandCallback(a.setTrack,function(r){if(r.error){return;}if(_.trackIds.size>0){s();}else{_.sceneBuilder.finalizeAnimation();_.sceneBuilder.finalizePlaybacks();_.onSetTrackCallbacks.execute();}});f.setCommandCallback(a.notifyError,function(r){_.onErrorCallbacks.execute(r);});var h=this;return new Promise(function(r){if(!h._worker){var u=new U(sap.ui.require.toUrl('sap/ui/vk/totara/TotaraLoaderWorker.js'));if(u.is('relative')){u=u.absoluteTo(new U(location.href));}h._worker=new Worker((window.URL||window.webkitURL).createObjectURL(new Blob([\"importScripts('\"+u.toString()+\"');\"],{'type':'application/javascript'})));h._worker.onmessage=function(i){var m=i.data;if(m.ready){return;}if(m.name==='getAuthorization'){var n;if(m.sceneId){n=_.getContext(m.sceneId);}if(n&&n.authorizationHandler){n.authorizationHandler(m.jsonContent.url).then(function(t){h._worker.postMessage({'method':'setAuthorization','authorizationToken':t});}).catch(function(t){h._worker.postMessage({'method':'setAuthorization','authorizationToken':null,'error':t.toString()});});}else{h._worker.postMessage({'method':'setAuthorization','authorizationToken':null});}return;}var p={name:m.name,jsonContent:m.jsonContent};if(m.binaryContent){p.binaryContent=m.binaryContent;}f.process(_,p);};h._worker.onerror=function(i){};}});};this.enablePushMesh=function(i){d=i;};this.dispose=function(){f=null;if(_){if(_.contextMap){var v=_.contextMap.values();var i=v.next();while(!i.done){var k=i.value;i=v.next();k.dispose();}}_.dispose();_=null;}if(this._worker){this._worker.terminate();this._worker=undefined;}};function l(i,n,t){if(i&&i.progressLogger&&t&&n){i.progressLogger.logPerformance(n,t);}}this.request=function(i,k,m){if(!k.root){throw'context must include root where three js objects are attached to';}var n=_.createContext(i,k);_.currentSceneInfo.id=i;n.retrievalType=S.RetrievalType.Initial;n.authorizationHandler=m;n.initialRequestTime=Date.now();var t;if(n.enableLogger){var o=T.createLogger(i,n,this);if(o){t=T.generateToken();n.token=t;}}var p=k.includeHidden!==undefined?k.includeHidden:true;var r=k.includeAnimation!==undefined?k.includeAnimation:true;var u=k.$select!==undefined?k.$select:'name,transform,meshId,annotationId,materialId,contentType,visible,opacity,renderOrder';var v=k.pushViewGroups!==undefined?k.pushViewGroups:true;var w={pushMaterials:true,pushMeshes:d,includeHidden:p,includeAnimation:r,pushPMI:k.pushPMI||false,metadataFilter:k.metadataFilter,token:t,pushViewGroups:v,$select:u};if(k.activateView){w.activateView=k.activateView;}w.sceneId=i;w.context=i;var x=G.createGetTreeCommand(w);l(n,'modelRequested',t);this._worker.postMessage({method:'initializeConnection',url:g,useSecureConnection:k.useSecureConnection,token:n.token,command:x,sceneId:i});};this.postMessage=function(m){this._worker.postMessage(m);};this.update=function(i,k,v){var h=this;_.currentSceneInfo.id=i;return new Promise(function(r,m){var n=_.getContext(i);if(!n){m('no context for ${sceneVeId}.');}n.nodeSidsForPartialTree=new Set(k);n.retrievalType=S.RetrievalType.Partial;var o=n.includeHidden!==undefined?n.includeHidden:true;var p=n.includeAnimation!==undefined?n.includeAnimation:true;var t=n.$select!==undefined?n.$select:'name,transform,meshId,materialId,contentType,visible,opacity,renderOrder';var u=n.pushViewGroups!==undefined?n.pushViewGroups:true;var w={pushMaterials:true,pushMeshes:d,filter:k.join(),includeAnimation:p,includeHidden:o,pushPMI:n.pushPMI||false,metadataFilter:n.metadataFilter,pushViewGroups:u,$select:t,breadcrumbs:true};var x;if(n.progressLogger){x=T.generateToken();n.token=x;}w.sceneId=i;w.context=i;if(v){w.activateView=v;}var y=G.createGetTreeCommand(w);var z=function(){n.onPartialRetrievalFinishedCallbacks.detach(z);l(n,'updateFinished(mesh)',x);var A=[];var B=[];n.replacedNodes.forEach(function(F,H){B.push(F);A.push(H);});var D=A;var E=B;r({sceneVeId:i,sids:k,replacedNodeRefs:D,replacementNodeRefs:E});};n.onPartialRetrievalFinishedCallbacks.attach(z);l(n,'updateRequested',x);h._worker.postMessage({method:'update',command:y});});};this.requestViewGroup=function(i,v){if(!v){return Promise.reject('invalid arg: viewGroupId undefined');}var k=_.getContext(i);if(!k){return Promise.reject('no scene exist for ${sceneVeId}');}var h=this;var p=new Promise(function(r,m){var n=_.sceneBuilder.getViewGroup(v,i);if(n&&n.length){r(n);return;}var t;if(k.progressLogger){t=T.generateToken();k.token=t;}var o={sceneId:i,id:v,token:t};var u=G.createGetViewGroupsCommand(o);var w=a.getViewGroups;var x=function(){_.onViewGroupFinishedCallbacks.detach(x);l(k,'onViewGroupFinished',t);var y=_.sceneBuilder.getViewGroup(v,i);if(y&&y.length){r(y);}else{m('no view ground data');}};_.onViewGroupFinishedCallbacks.attach(x);k.currentViewGroupId=v;h._worker.postMessage({method:w,command:u});});return p;};this.requestView=function(i,v,k,u){_.currentSceneInfo.id=i;if(v!=='static'&&v!=='dynamic'){return Promise.reject('invalid arg: supported type - static, dynamic');}if(!k){return Promise.reject('invalid arg: viewId undefined');}var m=_.getContext(i);if(!m){return Promise.reject('no scene exist for ${sceneVeId}');}_.viewIdSceneIdMap.set(k,i);var t;if(m.progressLogger){t=T.generateToken();m.token=t;}var n=m.includeHidden!==undefined?m.includeHidden:false;var o=m.includeAnimation!==undefined?m.includeAnimation:true;var p=m.$select!==undefined?m.$select:undefined;_.hasAnimation=false;var h=this;var r;var w=new Promise(function(x,y){if(u){var z=_.sceneBuilder.getView(k,i);if(z){x(z);return;}}var A='';var B;if(v==='static'){r={sceneId:i,id:k,token:t,includeHidden:n,includeAnimation:o,$select:p};A+=G.createGetViewCommand(r);B=a.getView;}else{r={sceneId:i,type:k,token:t};A+=G.createGetDynamicViewCommand(r);B=a.getDynamicView;}var D=function(H){m.onViewFinishedCallbacks.detach(D);l(m,'onViewFinished',t);if(!_.hasAnimation){if(H){x(H);}else{y('no view data');}}else{m.currentView=H;}};m.onViewFinishedCallbacks.attach(D);var E=function(){_.onSetSequenceCallbacks.detach(E);l(m,'onSetSequence',t);if(m.currentView){x(m.currentView);}else{y('no view data');}};_.onSetSequenceCallbacks.attach(E);var F=function(H){_.onSetTrackCallbacks.detach(F);l(m,'onSetTrack',t);if(m.currentView){x(m.currentView);}else{y('no view data');}};_.onSetTrackCallbacks.attach(F);l(m,'viewRequested',t);h._worker.postMessage({method:B,command:A});});return w;};this.requestMaterial=function(i){if(!i){return Promise.reject('invalid arg: materialId undefined');}var p=new Promise(function(r,k){var n=_.sceneBuilder.getMaterial(i);if(n){r(n);return;}_.requestCommandGenerator.pushMaterialIds([i]);_.materialIdsRequested.add(i);var o=function(u){var m=_.sceneBuilder.getMaterial(i);if(m&&m.userData&&m.userData.idsOfImagesToRead){if(!m.userData.idsOfImagesToRead.has(u.id)){return;}else{m.userData.idsOfImagesToRead.delete(u.id);}if(m.userData.idsOfImagesToRead.size){return;}else{r(m);}}else{k('no material data');}_.onImageFinishedCallbacks.detach(o);};var t=function(){_.onMaterialFinishedCallbacks.detach(t);var m=_.sceneBuilder.getMaterial(i);if(m&&m.userData&&m.userData.idsOfImagesToRead&&m.userData.idsOfImagesToRead.size){return;}_.onImageFinishedCallbacks.detach(o);if(m!=null){r(m);}else{k('no material data');}};_.onMaterialFinishedCallbacks.attach(t);_.onImageFinishedCallbacks.attach(o);j();});return p;};this.getState=function(){return _;};this.decrementResourceCountersForDeletedTreeNode=function(i,k,n){i.sceneBuilder.decrementResourceCountersForDeletedTreeNode(n,k.sceneId);};this.printLogTokens=function(){if(!_||!_.contextMap){console.log('printLogTokens:no data to print');return;}var i=_.contextMap.entries();var k=i.next();while(!k.done){var m=k.key;var n=k.value;k=i.next();console.log('log tokens for scene => '+m);console.log('---------------------------------------');if(n.progressLogger){var o=n.progressLogger.getTokens();var p=o.keys();var r=p.next();while(!r.done){var t=r.value;p.next();console.log(t);}}console.log('---------------------------------------');}};this.getSceneBuilder=function(){if(_){return _.sceneBuilder;}return null;};};return c;});\n",
	"sap/ui/vk/totara/TotaraLoaderWorker.js":"\nfunction HttpConnection(){'use strict';var u;var a;var o;var r=[];var m=4;var b=0;function c(u){var p=new Promise(function(d,e){var x=new XMLHttpRequest();x.onload=function(){if(this.status>=200&&this.status<300){d(x.response);}else{e({status:this.status,statusText:x.statusText});}};x.onerror=function(){e({status:this.status,statusText:x.statusText});};x.open('GET',u,true);if(a){x.setRequestHeader('Authorization',a);}x.responseType='arraybuffer';x.send();});return p;}this.getUrl=function(){return u;};this.close=function(){};this.send=function(d,e,f){if(!d){return;}r.push({message:d,context:e,onResponse:f||this.onResponse});if(b<m){_();}};function _(){if(!r.length){return;}var d=r.shift();b++;c(encodeURI(u+d.message)).then(function(e){if(d.onResponse){d.onResponse(e);}b--;_();}).catch(function(e){if(o){o({errorText:'could not connect to server:'+u,error:e.status,reason:e,context:d.context});}b--;_();});}this.init=function(s,d){return new Promise(function(e,f){u=s;if(d!=null){d(s).then(function(t){if(t!=null){a=t.token_type+' '+t.access_token;}else{a=null;}e({});}).catch(function(g){return f(g);});}else{e({});}});};this.setOnErrorCallback=function(d){o=d;};this.onResponse=null;}\nfunction WebSocketConnection(){'use strict';var l;var t=this;var c;var o;function i(){if(c&&c.readyState===1){return true;}return false;}function a(m,e,h){if(o){o({errorText:m,error:h,context:e});}}this.setOnErrorCallback=function(e){o=e;};this.getUrl=function(){return l;};this.close=function(){if(c){c.close();c=null;}};this.send=function(m,h){if(!m){return;}if(!i()){a('websocket connection lost',h,4);}else{try{c.send(m);}catch(e){a(e,h);}}};var b=0;function k(){var e=60000;if(c.readyState==1){c.send('');}b=setTimeout(k,e);}function d(){if(b){clearTimeout(b);b=0;}}var f=false;var g=function(e){var r=JSON.stringify(e);var h='setStreamingToken'+('['+r.length+']')+r;return h;};this.init=function(s,h){return new Promise(function(r,j){if(s){l=s;}else{s=l;}c=new WebSocket(s);c.binaryType='arraybuffer';c.onopen=function(){f=true;if(h!=null){h(s).then(function(e){if(e!=null){var m=g({'token':e.access_token});c.send(m);}k();r({});}).catch(function(e){return j(e);});}else{k();r({});}};c.onclose=function(){d();};c.onmessage=function(e){var m=e.data;if(t.onResponse){t.onResponse(m);}};c.onerror=function(e){if(!f){j('error connecting to '+s);}else{a(e);}};});};this.onResponse=null;}\nfunction findChar(c,s,u){'use strict';for(var i=s;i<u.length;i++){if(u[i]===c){return i;}}return-1;}\nfunction getContentLength(c){'use strict';var l=c.split(',');if(l.length<0||l.length>2){throw'invalid content length';}var j=0;var b=0;try{j=parseInt(l[0],10);if(l.length===2){b=parseInt(l[1],10);}}catch(e){throw'invalid content length';}return{jsonContentLength:j,binaryContentLength:b};}\nfunction Parser(){'use strict';}\nParser.createCommandList=function(a,o){'use strict';var b=new Uint8Array(a);var c=[];var s=0;var d=0;var f;var j;var g;while(d<b.length){d=findChar('['.charCodeAt(0),s,b);if(d===-1){break;}var h=Decoder.decode(b.slice(s,d)).replace(/\\n|\\r|\\s/g,'');s=d+1;d=findChar(']'.charCodeAt(0),s,b);if(d===-1){throw'No matching [] for command length. abort';}f=getContentLength(Decoder.decode(b.slice(s,d)));s=d+1;d=s+f.jsonContentLength;j=Decoder.decode(b.slice(s,d));try{j=JSON.parse(j);}catch(e){var i=h+': '+e;throw i;}if(f.binaryContentLength){s=d;d=s+f.binaryContentLength;g=b.slice(s,d);}else{g=undefined;}s=d;var k={name:h,jsonContent:j,binaryContent:g};if(o){o(k);}c.push(k);}return c;};\nfunction Decoder(){'use strict';}\nDecoder.uint8ArrayToString=function(u){'use strict';var f='';try{var C=0x8000;var i=0;var l=u.length;var s;while(i<l){s=u.slice(i,Math.min(i+C,l));f+=String.fromCharCode.apply(null,s);i+=C;}}catch(e){f='';}return f;};\nDecoder.decode=function(u){'use strict';var e=Decoder.uint8ArrayToString(u);return decodeURIComponent(escape(e));};\nfunction LoaderProxy(){'use strict';this.init=function(a,h,b){this._connection=a;this._connectionHTTP=h;this._sceneBuilderId=b;if(!a){throw'no connection provided for loader!';}this._connection.onResponse=function(r){var c=Parser.createCommandList(r);p(c);};};function p(c){var d;for(var i=0;i<c.length;i++){var a=c[i];if(a.binaryContent){d={name:a.name,jsonContent:a.jsonContent,binaryContent:a.binaryContent};self.postMessage(d,[d.binaryContent.buffer]);}else{d={name:a.name,jsonContent:a.jsonContent};self.postMessage(d);}}}this.getConnection=function(){return this._connection;};this._sendGetImage=function(i,c){this._connectionHTTP.send('images/'+i,c,function(r){p([{name:'setImage',jsonContent:{id:i},binaryContent:new Uint8Array(r)}]);});};this._sendGetGeometries=function(g,c){var r='geometry?';for(var i=0;i<g.length;i++){r+=(i>0?'&id=':'id=')+g[i];}this._connectionHTTP.send(r,c,function(a){var d=new DataView(a);var b=d.getUint16(2,true),o=0;var e=[];while(b-->0){var f={id:d.getUint32(o+4,true).toString(),box:[d.getFloat32(o+14,true),d.getFloat32(o+18,true),d.getFloat32(o+22,true),d.getFloat32(o+26,true),d.getFloat32(o+30,true),d.getFloat32(o+34,true)]};var h=d.getUint16(o+8,true);if(h!==3){f.flags=d.getUint16(o+38,true);f.pointCount=d.getUint16(o+46,true);f.elementCount=d.getUint16(o+48,true);}var j=d.getUint32(o+52,true);var k=new Uint8Array(a,o+56,j);e.push({name:'setGeometry',jsonContent:f,binaryContent:k.slice()});o+=52+j;}p(e);});};this.send=function(c){if(this._connectionHTTP&&c.resources){switch(c.method){case'getImage':for(var i=0;i<c.resources.length;i++){this._sendGetImage(c.resources[i],c);}return;case'getGeometry':this._sendGetGeometries(c.resources,c);return;default:break;}}if(this._connection){this._connection.send(c.command);}};this.setSceneBuilderId=function(i){this._sceneBuilderId=i;};this.getSceneBuilderId=function(){return this._sceneBuilderId;};this.authorizationHandler=function(u){return new Promise(function(r,a){var d={name:'getAuthorization',jsonContent:{'url':u},sceneId:self.loader.sceneId};self.loader.resolveFunctions.push(r);self.loader.rejectFunctions.push(a);self.postMessage(d);});};}\nLoaderProxy.HttpConnection=HttpConnection;LoaderProxy.WebSocketConnection=WebSocketConnection;var loader=new LoaderProxy();loader.resolveFunctions=[];loader.rejectFunctions=[];var reportError=function(e){'use strict';postMessage({name:'notifyError',jsonContent:{error:e}});};var onmessage=function(e){'use strict';var d=e.data;switch(d.method){case'initializeConnection':if(!d.url){break;}if(d.sceneId){loader.sceneId=d.sceneId;}var a='';if(d.url[d.url.length-1]!=='/'){d.url+='/';}if(d.url.toLowerCase().startsWith('ws')){a=d.url+'streaming?';}else if(d.url.toLowerCase().startsWith('http')){a=d.url+'streaming-http?request=';}else{a=(d.useSecureConnection?'wss://':'ws://')+d.url+'streaming?';}var b=loader.getConnection();if(!b||b.getUrl()!==a){if(b){b.close();}var c;var f=null;if(d.url.toLowerCase().startsWith('ws')){c=new WebSocketConnection();}else if(d.url.toLowerCase().startsWith('http')){c=new HttpConnection();f=d.url;}else{c=new WebSocketConnection();f=(d.useSecureConnection?'https://':'http://')+d.url;}c.init(a,loader.authorizationHandler).then(function(){var i=function(c,h){loader.init(c,h,d.sceneBuilderId);if(d.command){loader.send(d);}};if(f){var h=new HttpConnection();h.init(f,loader.authorizationHandler).then(function(){i(c,h);}).catch(function(j){reportError(j);});}else{i(c,null);}}).catch(function(h){reportError(h);});}else if(d.command){loader.send(d);}break;case'setAuthorization':var r=loader.resolveFunctions.shift();var g=loader.rejectFunctions.shift();if(d.error==null){r(d.authorizationToken);}else{g(d.error);}break;default:if(d.command){loader.send(d);}break;}};self.onmessage=onmessage;postMessage({ready:true});\n",
	"sap/ui/vk/totara/TotaraUtils.js":"sap.ui.define(['jquery.sap.global','./Generator'],function(q,G){'use strict';var T=function(){};T.calculateVolumeFromBoundingBox=function(b){var m=new THREE.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);var a=new THREE.Vector3(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE);var c=new THREE.Vector3(-0.5,-0.5,-0.5);var d=new THREE.Vector3(0.5,0.5,0.5);for(var i=0;i<8;i++){var x=i&1?c.x:d.x;var y=i&2?c.y:d.y;var z=i&4?c.z:d.z;var p=new THREE.Vector3(x,y,z);p.applyMatrix4(b.matrixWorld);m.x=Math.min(m.x,p.x);m.y=Math.min(m.y,p.y);m.z=Math.min(m.z,p.z);a.x=Math.max(a.x,p.x);a.y=Math.max(a.y,p.y);a.z=Math.max(a.z,p.z);}var e=new THREE.Vector3().subVectors(a,m);return e.x*e.y*e.z;};function P(i,c,t){if(!i||!c||!t){throw'ProgressLogger: invalid args';}this.context=c;this.loader=t;var a=new Set();this.logPerformance=function(n,b){if(!n||!b){return;}a.add(b);var l={name:n,timestamp:Date.now(),token:b};var d=G.createAddClientLogCommand(l);var m={method:'AddClientLogCommand',url:this.loader.getUrl(),authorizationHandler:c.authorizationHandler,token:c.token,command:d};this.loader.postMessage(m);};this.getTokens=function(){return a;};}T.createLogger=function(i,c,a){if(!c){return null;}c.progressLogger=new P(i,c,a);return c.progressLogger;};T.arrayToMatrix=function(a){var m=new THREE.Matrix4();if(a.length===3){m.setPosition(new THREE.Vector3().fromArray(a));}else if(a.length===12){m.set(a[0],a[3],a[6],a[9],a[1],a[4],a[7],a[10],a[2],a[5],a[8],a[11],0.0,0.0,0.0,1.0);}else if(a.length===16){m.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);}else{throw'Invalid matrix format';}return m;};T.arrayToColumnMajorMatrixArray16=function(a){if(a.length===16){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]];}if(a.length===12){return[a[0],a[3],a[6],a[9],a[1],a[4],a[7],a[10],a[2],a[5],a[8],a[11],0.0,0.0,0.0,1.0];}if(a.length===3){return[1,0,0,a[0],0,1,0,a[1],0,0,1,a[2],0,0,0,1];}return null;};T.generateToken=function(){return g();};function g(){function s(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}return s()+s()+'-'+s()+'-'+s()+'-'+s()+'-'+s()+s()+s();}T.reportError=function(s,c,e){var a={error:e,context:c};s.onErrorCallbacks.execute(a);};T.checkError=function(c){if(!c){return true;}var r=c.result==='failure';if(r){if(c.message){c.error=c.message;delete c.message;}else{c.message='unknown error';}}return r;};return T;});\n",
	"sap/ui/vk/totara/TreeBuilder.js":"sap.ui.define(['jquery.sap.global','./ListMap','./TotaraUtils'],function(q,L,T){'use strict';var a=function(){};a.getPartialTreeNodes=function(t,c,s){var p=[];var b=[];var i,j,d;if(t&&t.length){for(i=0;i<t.length;i++){d=t[i];if(d&&d.children){for(j=0;j<d.children.length;j++){var e=d.children[j];t[e].parentNode=d;if(d.renderOrder){t[e].renderOrder=d.renderOrder;}}}}}if(t&&t.length){for(i=0;i<t.length;i++){d=t[i];if(d.parent){p.push(d);}else if(!d.parentNode){p.push(d);if(c&&c.rootNodeId){d.parent=c.rootNodeId;}}if(c&&c.nodeSidsForPartialTree.has(d.sid)){b.push(d);}}}if(c){c.nodeSidsForPartialTree.clear();}if(!b.length){return p;}p=[];for(j=0;j<b.length;j++){var n=b[j];var f=n.parentNode;while(f){if(s.sceneBuilder.getNode(f.sid,c.sceneId)){n.parent=f.sid;p.push(n);break;}else{n=f;f=f.parentNode;}}}if(p.length){return p;}else{return b;}};a.buildTree=function(s,c){var r={};if(!c.treeNodes||!c.treeNodes.length){r.error='no tree information';return r;}var t=c.treeNodes;var p=a.getPartialTreeNodes(t,c,s);c.replacedNodes.clear();var b=[];var i;var d;for(i=0;i<p.length;i++){d=p[i].parent;if(s.sceneBuilder.getNode(d,c.sceneId)){a.buildNode(s,c,p[i],d);}else{b.push(p[i]);}}for(i=0;i<b.length;i++){d=b[i].parent;if(s.sceneBuilder.getNode(d,c.sceneId)){a.buildNode(s,c,p[i],d);}else{if(!r.error){r.error='';}r.error+='parent ${parentSid} does not exist in the scene. \\n';}}c.treeNodes=[];c.progressCount.mesh.total=c.meshGroupListMap.size;return r;};a.buildNode=function(s,c,t,p){if(!t||!p){T.reportError(s,c,'totaraTreeBuilder - buildNode - invalid args');return;}var e=s.sceneBuilder.getNode(t.sid,c.sceneId);if(e){s.sceneBuilder.remove(t.sid,c.sceneId);}if(t.suppressed===true){return;}if(!t.sid){T.reportError(s,c,'sid is missing in treeNode');return;}var r=s.sceneBuilder.createNode(t,p,c.sceneId);if(r.needSetSubmesh){var m=c.meshGroupListMap;var g=m.getOrCreate(t.meshId);g.push(t.sid);}if(t.annotationId){c.annotationNodeMap.set(t.annotationId,t.sid);}if(r.needUpdateMaterial){s.materialIdsToRequest.add(t.materialId);}if(r.materialIds.length){for(var b=0;b<r.materialIds.length;b++){var n=c.materialIdNodeListMapForOpacityUpdate.getOrCreate(r.materialIds[b]);n.push(t.sid);}}var d=s.sceneBuilder.getNode(t.sid,c.sceneId);if(e&&d){c.replacedNodes.set(e,d);}if(t.children){var f=c.treeNodes;for(var i=0;i<t.children.length;i++){var h=t.children[i];a.buildNode(s,c,f[h],t.sid);}}};return a;});\n",
	"sap/ui/vk/totara/TreeHandler.js":"sap.ui.define(['jquery.sap.global','./ListMap','./CameraHandler','./TotaraUtils','./TreeBuilder'],function(q,L,C,T,a){'use strict';var b=function(){};b.setTree=function(s,c){if(T.checkError(c)){if(c.events&&c.events.length){var e=c.events[0];if(e.values&&e.values.id){var r=s.getContext(e.values.id);c.context=r;}}return c;}var d=s.getContext(c.sceneId);if(!d){c.error='setTree error: no context for scence '+c.sceneId;return c;}var f={};if(c.sid){var g=s.sceneBuilder.getNode(c.sid,d.sceneId);if(!g||g!==d.root){var h=d.root;h.userData.treeNode={sid:c.sid,name:'root'};if(d){s.sceneBuilder.setRootNode(h,c.sid,c.sceneId);d.rootNodeId=c.sid;}}}if(c.camera){var i=C.setCameraSingle(s,c.camera,c.sceneId);if(i){d.onActiveCameraCallbacks.execute(i);}}return f;};b.setTreeNode=function(s,c){if(T.checkError(c)){return c;}var r={};if(!c.sceneId){r.error='setTreeNode error: no sceneId';}var d=s.getContext(c.sceneId);if(!d){r.error='setTreeNode error: no loading context for scene '+c.sceneId;return r;}d.treeNodes=d.treeNodes.concat(c.nodes);return r;};b.notifyFinishedTree=function(s,c){var r={};if(T.checkError(c)){return c;}if(c.sceneId){r.context=s.getContext(c.sceneId);if(!r.context){r.error='notifyFinishedTree error: no loading context for scene '+c.sceneId;}else{a.buildTree(s,r.context);}}else{r.error='notifyFinishedTree error: no sceneId';}return r;};return b;});\n",
	"sap/ui/vk/totara/ViewBuilder.js":"sap.ui.define(['jquery.sap.global','./ListMap','./CameraHandler','./TotaraUtils','./TreeBuilder'],function(q,L,C,T,a){'use strict';var V=function(){};V.buildView=function(v,s,b){var r={};var t=b.viewIdTreeNodesMap.get(v);b.treeNodes=t;if(!b.treeNodes||!b.treeNodes.length){r.error='no tree information in view';return r;}var d=b.treeNodes;var p=a.getPartialTreeNodes(d);var n=[];for(var i=0;i<p.length;i++){var e=p[i].parent;V.processNode(s,b,p[i],n,e);}r.nodeInfos=n;b.treeNodes=[];b.viewIdTreeNodesMap.delete(v);return r;};V.buildViewNode=function(s,b,t,n){if(!t){T.reportError(s,b,'totaraTreeBuilder - buildNode - invalid args');return;}var d=s.sceneBuilder.getNode(t.sid,b.sceneId);var e={target:d};var r=s.sceneBuilder.updateMaterialInNode(t,b.sceneId);if(r.needUpdateMaterial){if(t.opacity){var f=b.materialIdNodeListMapForOpacityUpdate.getOrCreate(t.materialId);f.push(t.sid);}s.materialIdsToRequest.add(t.materialId);}if(r.nodeUpdated){b.updatedNodes.add(s.sceneBuilder.getNode(t.sid,b.sceneId));}if(t.transform){e.transform=T.arrayToColumnMajorMatrixArray16(t.transform);}else{e.transform=[1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0];}if(t.visible===undefined){e.visible=true;}else{e.visible=t.visible;}n.push(e);var g=s.sceneBuilder.getChildNodeIds(t.sid,b.sceneId);var h=c(b.treeNodes,t);var k;var i;for(i=0;i<g.length;i++){k=g[i];for(var j=0;j<h.length;j++){if(k===h[j]){g[i]=undefined;break;}}}for(i=0;i<g.length;i++){var l=g[i];if(l!==undefined){var m=s.sceneBuilder.getNode(l,b.sceneId);var o=false;n.push({target:m,visible:o});}}if(t.children){for(i=0;i<t.children.length;i++){var p=t.children[i];var u=b.treeNodes[p];V.processNode(s,b,u,n,t.sid);}}};V.processNode=function(s,b,t,n,p){var d=s.sceneBuilder.getNode(t.sid,b.sceneId);if(d){V.buildViewNode(s,b,t,n);}else{a.buildNode(s,b,t,p);var e=s.sceneBuilder.getNode(t.sid,b.sceneId);if(e){e.visible=false;n.push({target:e,visible:t.visible===undefined?true:t.visible});}}};function c(t,b){var s=[];var d=0;if(b&&b.children){for(var i=0;i<b.children.length;i++){d=b.children[i];s.push(t[d].sid);}}return s;}return V;});\n",
	"sap/ui/vk/totara/ViewHandler.js":"sap.ui.define(['jquery.sap.global','./ViewBuilder','./CameraHandler','./TotaraUtils'],function(q,V,C,T){'use strict';var a=function(){};a.setViewGroup=function(s,c){if(T.checkError(c)||!c.views){return c;}var r={};s.sceneBuilder.insertViewGroup(c,c.sceneId);var v=new Set();var i=new Set();var b=s.getContext(c.sceneId);if(!b){c.error='setViewGroup error: try to extract view group information for unmatching scene/context '+c.sceneId;return c;}if(!b.currentViewGroupId){b.currentViewGroupId=c.id;}if(b.currentViewGroupId!==c.id){return c;}for(var d=0;d<c.views.length;d++){var e=c.views[d];var f=s.sceneBuilder.getView(e.id,c.sceneId);if(f){continue;}b.viewIds.add(e.id);v.add(e.id);if(e.thumbnailId!==undefined){e.thumbnailId=e.thumbnailId.toString();var p={};p.viewId=e.id;p.sceneId=c.sceneId;s.thumbnailImageIdAndViewIdSceneIdMap.set(e.thumbnailId,p);var g={};g.thumbnailImageId=e.thumbnailId;g.sceneId=c.sceneId;s.viewIdAndThumbnailImageIdScneIdMap.set(e.id,g);i.add(e.thumbnailId);}s.viewIdSceneIdMap.set(e.id,c.sceneId);}r.context=b;r.viewIdSet=v;r.imageIdSet=i;return r;};a.setView=function(s,v){if(T.checkError(v)){return v;}var r={};if(v.sceneId){var c=s.getContext(v.sceneId);if(!c){v.error='setView error: try to extract view information for unmatching scene/context'+v.sceneId;return v;}r.context=c;v.id=v.viewId;var p=s.viewIdAndThumbnailImageIdScneIdMap.get(v.id);if(p&&p.sceneId===v.sceneId){v.thumbnailId=p.thumbnailImageId;s.viewIdAndThumbnailImageIdScneIdMap.delete(v.id);}s.sceneBuilder.insertView(v,v.sceneId);var b=[];c.viewIdTreeNodesMap.set(v.viewId,b);if(v.camera){C.setCameraSingle(s,v.camera,v.sceneId);s.sceneBuilder.setViewCamera(v.camera.id,v.id,v.sceneId);}}else{r.error='setView: no sceneId';}return r;};a.setViewNode=function(s,c){if(T.checkError(c)){return c;}var r={};if(c.sceneId){var b=s.getContext(c.sceneId);if(!b){c.error='setViewNode error: try to extract view node information for unmatching scene/context'+c.sceneId;return c;}r.context=b;var v=s.sceneBuilder.getView(c.viewId,c.sceneId);if(!v){r.error='setViewNode error: setViewNode - no setView was in the chain';return r;}var t=b.viewIdTreeNodesMap.get(c.viewId);t=t.concat(c.nodes);b.viewIdTreeNodesMap.set(c.viewId,t);}else{r.error='setViewNode error: no sceneId';}return r;};a.notifyFinishedView=function(s,c){var r={};if(c.sceneId){var b=s.getContext(c.sceneId);if(!b){c.error='notifyFinishedView error: try to notify finished view for unmatching scene/context';return c;}r.context=b;var v=s.sceneBuilder.getView(c.viewId,c.sceneId);if(!v){r.error='notifyFinishedView error: setViewNode - no setView was in the chain';return r;}if(v.activeCameraId!==undefined){v.camera=s.sceneBuilder.getCamera(v.activeCameraId);}b.updatedNodes.clear();var d=V.buildView(c.viewId,s,b);s.sceneBuilder.setViewNodeInfos(d.nodeInfos,c.viewId,c.sceneId);r.view=v;r.viewId=c.viewId;r.sceneId=c.sceneId;}else{r.error='notifyFinishedView error: no sceneId';}return r;};return a;});\n"
}}
