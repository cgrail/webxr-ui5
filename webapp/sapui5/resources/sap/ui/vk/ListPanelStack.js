/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./library","sap/ui/core/Control","sap/ui/layout/library","./ListPanelStackRenderer"],function(l,C,a,L){"use strict";var b=C.extend("sap.ui.vk.ListPanelStack",{metadata:{library:"sap.ui.vk",properties:{"width":{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},"expanded":{type:"boolean",group:"Misc",defaultValue:true},"expandAnimation":{type:"boolean",group:"Misc",defaultValue:true},"collapsible":{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{"content":{type:"sap.ui.vk.ListPanel",multiple:true,singularName:"content"},"layout":{type:"sap.ui.layout.VerticalLayout",multiple:false,visibility:"hidden"}}}});b.prototype.init=function(){this._oLayout=new sap.ui.layout.VerticalLayout();this._oLayout.addStyleClass("sapUiVkLPSTrans");this.setAggregation("layout",this._oLayout,true);this._bFirstTime=true;};b.prototype.exit=function(){if(this._oLayout){this._oLayout.destroy();this._oLayout=undefined;}};b.prototype.getContent=function(){return this._oLayout.getContent();};b.prototype.addContent=function(o){o.attachExpand(this._onContentExpand.bind(this));o.attachHeaderIconPress(this._onContentHeaderIconPress.bind(this));return this._oLayout.addContent(o);};b.prototype.removeContent=function(o){return this._oLayout.removeContent(o);};b.prototype.insertContent=function(o,i){return this._oLayout.insertContent(o,i);};b.prototype.removeAllContent=function(){return this._oLayout.removeAllContent();};b.prototype.getWidth=function(){return this._oLayout.getWidth();};b.prototype.setWidth=function(v){this.setProperty("width",v,true);return this._oLayout.setWidth(v);};b.prototype.setExpanded=function(v){if(v!=this.getExpanded()){if(v){this._expand();}else{this._collapse();}}return this;};b.prototype.setExpandAnimation=function(v){this._oLayout.removeStyleClass("sapUiVkLPSTrans");if(v){this._oLayout.addStyleClass("sapUiVkLPSTrans");}return this.setProperty("expandAnimation",v,true);};b.prototype.onBeforeRendering=function(){if(this._bFirstTime){var e=false;var c=this.getContent();for(var i=0;i<c.length;++i){if(c[i].getExpanded()){e=true;}}this.setExpanded(e);this._bFirstTime=false;}};b.prototype.onAfterRendering=function(){if(!this.getExpanded()){this._updateCollapsedLayoutWidth();}};b.prototype._onContentExpand=function(e){var c=false;var d=this._oLayout.getContent();for(var i=0;i<d.length;++i){if(d[i].getExpanded()){c=true;}}this.setExpanded(c);};b.prototype._onContentHeaderIconPress=function(e){var c=e.oSource.getExpanded()?false:true;e.oSource.setExpanded(c);var E=false;var d=this._oLayout.getContent();for(var i=0;i<d.length;++i){if(d[i].getExpanded()){E=true;break;}}this.setExpanded(E);};b.prototype._expand=function(){this._oLayout.removeStyleClass("sapUiVkLPSCollapse");this._oLayout.setWidth(this.getProperty("width"));this.setProperty("expanded",true,true);};b.prototype._collapse=function(){if(!this.getCollapsible()){return;}var c=this.getContent();for(var i=0;i<c.length;++i){c[i].setExpanded(false);}this._oLayout.addStyleClass("sapUiVkLPSCollapse");this._updateCollapsedLayoutWidth();this.setProperty("expanded",false,true);};b.prototype._updateCollapsedLayoutWidth=function(){if(this._oLayout.$().closest(".sapUiSizeCompact").length===0){this._oLayout.setWidth("3rem");}else{this._oLayout.setWidth("2.5rem");}};return b;});
