sap.ui.define(["jquery.sap.global","./TotaraUtils","./AnnotationHandler"],function(q,T,A){"use strict";var M=function(){};M.setMaterial=function(s,c){if(T.checkError(c)){return c;}var m=c.materials;var r={imageIdSet:new Set()};for(var i=0;i<m.length;i++){var a=m[i];var b=[];b=s.sceneBuilder.createMaterial(a);var t=s.sceneBuilder.getMaterial(a.id);if(!t.userData){t.userData={};}if(!t.userData.idsOfImagesToRead){t.userData.idsOfImagesToRead=new Set();}else{t.userData.idsOfImagesToRead.clear();}if(b.length){for(var d=0;d<b.length;d++){var p=b[d];var e=s.texturesToUpdate;var f=e.get(p.imageId);if(!f){f=[];e.set(p.imageId,f);}f.push({textureType:p.textureType,materialId:a.id});r.imageIdSet.add(p.imageId);t.userData.idsOfImagesToRead.add(p.imageId);}}var v=s.contextMap.values();var g=v.next();while(!g.done){var h=g.value;g=v.next();var n=h.materialIdNodeListMapForOpacityUpdate.get(a.id);if(n){for(var j=0;j<n.length;j++){s.sceneBuilder.applyNodeOpacityToSubmeshes(n[j],h.sceneId,a.id);}h.materialIdNodeListMapForOpacityUpdate.delete(a.id);}}s.materialIdsRequested.delete(a.id);}A.updateMaterials(s,c);return r;};M.updateTexture=function(s,a){var t=s.texturesToUpdate.get(a);if(t){for(var i=0,b=t.length;i<b;i++){var c=t[i];s.sceneBuilder.updateTextureMap(c.materialId,c.textureType);}s.texturesToUpdate.delete(a);}};return M;});
