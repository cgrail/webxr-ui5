sap.ui.define(["jquery.sap.global","./ViewBuilder","./CameraHandler","./TotaraUtils"],function(q,V,C,T){"use strict";var a=function(){};a.setViewGroup=function(s,c){if(T.checkError(c)||!c.views){return c;}var r={};s.sceneBuilder.insertViewGroup(c,c.sceneId);var v=new Set();var i=new Set();var b=s.getContext(c.sceneId);if(!b){c.error="setViewGroup error: try to extract view group information for unmatching scene/context "+c.sceneId;return c;}if(!b.currentViewGroupId){b.currentViewGroupId=c.id;}if(b.currentViewGroupId!==c.id){return c;}for(var d=0;d<c.views.length;d++){var e=c.views[d];var f=s.sceneBuilder.getView(e.id,c.sceneId);if(f){continue;}b.viewIds.add(e.id);v.add(e.id);if(e.thumbnailId!==undefined){e.thumbnailId=e.thumbnailId.toString();var p={};p.viewId=e.id;p.sceneId=c.sceneId;s.thumbnailImageIdAndViewIdSceneIdMap.set(e.thumbnailId,p);var g={};g.thumbnailImageId=e.thumbnailId;g.sceneId=c.sceneId;s.viewIdAndThumbnailImageIdScneIdMap.set(e.id,g);i.add(e.thumbnailId);}s.viewIdSceneIdMap.set(e.id,c.sceneId);}r.context=b;r.viewIdSet=v;r.imageIdSet=i;return r;};a.setView=function(s,v){if(T.checkError(v)){return v;}var r={};if(v.sceneId){var c=s.getContext(v.sceneId);if(!c){v.error="setView error: try to extract view information for unmatching scene/context"+v.sceneId;return v;}r.context=c;v.id=v.viewId;var p=s.viewIdAndThumbnailImageIdScneIdMap.get(v.id);if(p&&p.sceneId===v.sceneId){v.thumbnailId=p.thumbnailImageId;s.viewIdAndThumbnailImageIdScneIdMap.delete(v.id);}s.sceneBuilder.insertView(v,v.sceneId);var b=[];c.viewIdTreeNodesMap.set(v.viewId,b);if(v.camera){C.setCameraSingle(s,v.camera,v.sceneId);s.sceneBuilder.setViewCamera(v.camera.id,v.id,v.sceneId);}}else{r.error="setView: no sceneId";}return r;};a.setViewNode=function(s,c){if(T.checkError(c)){return c;}var r={};if(c.sceneId){var b=s.getContext(c.sceneId);if(!b){c.error="setViewNode error: try to extract view node information for unmatching scene/context"+c.sceneId;return c;}r.context=b;var v=s.sceneBuilder.getView(c.viewId,c.sceneId);if(!v){r.error="setViewNode error: setViewNode - no setView was in the chain";return r;}var t=b.viewIdTreeNodesMap.get(c.viewId);t=t.concat(c.nodes);b.viewIdTreeNodesMap.set(c.viewId,t);}else{r.error="setViewNode error: no sceneId";}return r;};a.notifyFinishedView=function(s,c){var r={};if(c.sceneId){var b=s.getContext(c.sceneId);if(!b){c.error="notifyFinishedView error: try to notify finished view for unmatching scene/context";return c;}r.context=b;var v=s.sceneBuilder.getView(c.viewId,c.sceneId);if(!v){r.error="notifyFinishedView error: setViewNode - no setView was in the chain";return r;}if(v.activeCameraId!==undefined){v.camera=s.sceneBuilder.getCamera(v.activeCameraId);}b.updatedNodes.clear();var d=V.buildView(c.viewId,s,b);s.sceneBuilder.setViewNodeInfos(d.nodeInfos,c.viewId,c.sceneId);r.view=v;r.viewId=c.viewId;r.sceneId=c.sceneId;}else{r.error="notifyFinishedView error: no sceneId";}return r;};return a;});
