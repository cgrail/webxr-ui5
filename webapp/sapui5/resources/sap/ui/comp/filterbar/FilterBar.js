/*
 * ! SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/core/library','sap/m/Bar','sap/m/Button','sap/m/CheckBox','sap/m/Label','sap/m/Link','sap/m/List','sap/m/Panel','sap/m/SearchField','sap/m/Text','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/Device','sap/ui/comp/state/UIState','./VariantConverterFrom','./VariantConverterTo','sap/ui/comp/library','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagementUi2','sap/ui/comp/variants/VariantManagement','sap/ui/core/InvisibleText','sap/ui/core/Icon','sap/ui/core/Title','sap/ui/layout/Grid','sap/ui/layout/GridRenderer','sap/ui/layout/GridData','sap/ui/layout/HorizontalLayout','sap/ui/layout/VerticalLayout','sap/ui/layout/AlignedFlowLayout','sap/ui/comp/util/IdentifierUtil','sap/m/library','sap/ui/core/ResizeHandler','sap/ui/model/json/JSONModel','sap/ui/comp/filterbar/FilterGroupItem','sap/base/Log'],function(q,c,B,a,C,L,b,d,P,S,T,e,f,D,U,V,g,l,h,k,m,I,o,p,G,r,s,H,t,A,u,v,R,J,F,w){"use strict";var x=c.ValueState;var y=c.TextAlign;var z=v.ListSeparators;var E=v.ButtonType;var K;var M;var O;var N;var Q;var W;var X;var Y;var Z;var $;var _=v.OverflowToolbarPriority;var a1=v.ListMode;var b1=G.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/filterbar/FilterBar.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogCancel:{},filtersDialogSearch:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:r.render});b1.INTERNAL_GROUP="__$INTERNAL$";b1.prototype.init=function(){this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oDialog=null;this._oFilterDialog=null;this._bIsInitialized=false;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._oLabelTextWidth=0;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar");if(this._isPhone()){this.addStyleClass("sapUiCompFilterBarPhone");}else{this.addStyleClass("sapUiCompFilterBarNonPhone");}this.addStyleClass("sapUiCompFilterBarMarginBottom");this.addStyleClass("sapUiCompFilterBarPaddingPanel");this.addStyleClass("sapContrastPlus");this._oToolbar=this._createToolbar();this._oToolbar.setLayoutData(new s({span:"L12 M12 S12"}));this.addContent(this._oToolbar);this._bDelayRendering=true;this._oBasicAreaLayout=this._createBasicAreaLayout();this._oBasicAreaLayout.setVisible(false);this._oBasicAreaLayout.setLayoutData(new s({span:"L12 M12 S12"}));this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new P();this._oAdvancedPanel.setLayoutData(new s({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this.addContent(this._oAdvancedPanel);this.oModel=new J({});this.setModel(this.oModel,"FilterBar");this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:y.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.setMinItemWidth(this.getFilterContainerWidth());this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false);}};b1.prototype.setFilterContainerWidth=function(i){this._oBasicAreaLayout.setMinItemWidth(i);if(this.getUseToolbar()){this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());}else{this._setMaxItemWidth2();}this.setProperty("filterContainerWidth",i);return this;};b1.prototype._setMaxItemWidth2=function(){var j,n,h1=this._oBasicAreaLayout.getMinItemWidth();["rem","%","px","em"].some(function(i1){var i=h1.indexOf(i1);if(i>0){h1=h1.substring(0,i);j=i1;return true;}return false;});if(j){n=parseInt(h1);if(!isNaN(n)){n*=2;this._oBasicAreaLayout.setMaxItemWidth(n+j);}}};b1.prototype._hasAnyVisibleFiltersOnFB=function(){var j=this._retrieveVisibleAdvancedItems();for(var i=0;i<j.length;i++){if(j[i].filterItem.getVisibleInFilterBar()){return true;}}return false;};b1.prototype._showHintText=function(){var i=0;if(!this._oHintText){return;}if(this._isNewFilterBarDesign()){return;}if(!this.getAdvancedMode()&&!this._isPhone()){var j=!this._hasAnyVisibleFiltersOnFB();if(j){i=this._oAdvancedPanel.indexOfContent(this._oHintText);if(i<0){this._oAdvancedPanel.insertContent(this._oHintText,0);}}this._oHintText.setVisible(j);this._oAdvancedPanel.setVisible(j);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!j&&this.getFilterBarExpanded());}}};b1.prototype._hasRelevantFilters=function(){var i,n=null,j;if(!this._mAdvancedAreaFilter||(Object.keys(this._mAdvancedAreaFilter)<1)){return false;}if(this.getAdvancedMode()){for(n in this._mAdvancedAreaFilter){var h1=this._mAdvancedAreaFilter[n];if(h1&&h1.items){for(i=0;i<h1.items.length;i++){j=h1.items[i];if(j){if(this._determineVisibility(j.filterItem)){return true;}}}}}return false;}return true;};b1.prototype._adaptButtonsEnablement=function(){var i=false||!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(i);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters());}}this._oClearButtonOnFB.setEnabled(i);this._oRestoreButtonOnFB.setEnabled(i);this._oFiltersButton.setEnabled(i);var j=true;if(this._isPhone()&&this.getUseToolbar()){j=false;}if(i&&this.getFilterBarExpanded()&&j&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true);}};b1.prototype.getVariantManagement=function(){return this._oVariantManagement;};b1.prototype.setShowClearOnFB=function(i){if(!this._isPhone()){this.setProperty("showClearOnFB",i);this._oClearButtonOnFB.setVisible(i);}return this;};b1.prototype.setShowRestoreOnFB=function(i){if(!this._isPhone()){this.setProperty("showRestoreOnFB",i);this._oRestoreButtonOnFB.setVisible(i);}return this;};b1.prototype.setShowGoOnFB=function(i){this.setProperty("showGoOnFB",i);this._calcVisibilityGoButton();return this;};b1.prototype._calcVisibilityGoButton=function(){var i=this.getShowGoOnFB();if(i&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){i=false;}this._oSearchButton.setVisible(i);};b1.prototype.setShowGoButton=function(i){this.setShowGoOnFB(i);return this;};b1.prototype.getShowGoButton=function(){return this.getShowGoOnFB();};b1.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false);};b1.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB());};b1.prototype.setShowFilterConfiguration=function(i){this.setProperty("showFilterConfiguration",i);if(this._oFiltersButton&&!this._isPhone()){this._oFiltersButton.setVisible(i);}return this;};b1.prototype.isCurrentVariantStandard=function(){var i;if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();if(i===""){return true;}return(i===this._oVariantManagement.getStandardVariantKey());}return undefined;};b1.prototype.setCurrentVariantId=function(i,j){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(i,j);}};b1.prototype.getCurrentVariantId=function(){var i="";if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();}return i;};b1.prototype.getDataSuiteFormat=function(i){return this._getDataSuiteFormat(i,null);};b1.prototype._getDataSuiteFormat=function(i,j){var n=null,h1,i1,j1,k1,l1;if(this._oVariantManagement){h1=this.getCurrentVariantId();if(this.getFilterDataAsString){j1=this._determineVariantFiltersInfo(i,true);if(this.getFilterContextUrl){l1=this.getFilterContextUrl();}if(this.getParameterContextUrl){k1=this.getParameterContextUrl();}i1=this.getFilterDataAsString(i);if(i1){var m1=new g();n=m1.convert(h1,j1,i1,this,j,k1,l1);}}}return n;};b1.prototype.getBasicSearchName=function(){var i=null;if(this._oBasicSearchField&&this.getEntitySet){i="$"+this.getEntitySet()+".basicSearch";}return i;};b1.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue();};b1.prototype.setUiStateAsVariant=function(i){var j={replace:true,strictMode:true};this.setUiState(i,j);this.fireAfterVariantLoad("SPV_VARIANT",false);this._applyVisibility(i.getSelectionVariant());};b1.prototype._applyVisibility=function(i){var j=function(h1){if(h1&&h1.visible&&!h1.isHiddenFilter()){if(!h1.getVisibleInFilterBar()){h1.setVisibleInFilterBar(true);}if(!h1.getPartOfCurrentVariant()){h1.setPartOfCurrentVariant(true);}}};if(this._bIsInitialized){for(var n in this._mAdvancedAreaFilter){if(n){this._mAdvancedAreaFilter[n].items.forEach(function(h1){if(h1&&h1.filterItem&&h1.filterItem.getMandatory()){j(h1.filterItem);}else if(h1&&h1.filterItem){if(h1.filterItem.getVisibleInFilterBar()){h1.filterItem.setVisibleInFilterBar(false);}if(h1.filterItem.getPartOfCurrentVariant()){if(n===b1.INTERNAL_GROUP){h1.filterItem.setPartOfCurrentVariant(true);}else{h1.filterItem.setPartOfCurrentVariant(false);}}}});}}if(i&&i.Parameters){i.Parameters.forEach(function(h1){var i1=this.determineFilterItemByName(h1.PropertyName);j(i1);}.bind(this));}if(i&&i.SelectOptions){i.SelectOptions.forEach(function(h1){var i1=this.determineFilterItemByName(h1.PropertyName);j(i1);}.bind(this));}}};b1.prototype.getUiState=function(i){var j,n,h1=false,i1=null;if(i){h1=(i.allFilters===true);}n=this._getDataSuiteFormat(h1,"13.0");j=new U();j.selectionVariant=JSON.parse(n);j.setSelectionVariant(j.selectionVariant);if(j.getSelectionVariant()){if(this.getModelData&&this.getModelData()){i1=this.getModelData();}j.setValueTexts(U.calculateValueTexts(j.getSelectionVariant(),i1));}return j;};b1.prototype.setUiState=function(i,j){var n,h1,i1=null,j1=false,k1=true;if(j){j1=(j.replace===true);k1=(j.strictMode===true);}if(i){i1=i.getSelectionVariant();if(i1){h1=JSON.stringify(i1);}n=i.getValueTexts();}this._setDataSuiteFormat(h1,j1,k1,n);};b1.prototype.setDataSuiteFormat=function(i,j){this._setDataSuiteFormat(i,j,true);};b1.prototype._setDataSuiteFormat=function(i,j,n,h1){var i1,j1,k1;if(i){i1=new V();j1=i1.convert(i,this,n);if(j1){if(j1.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(j1.variantId,"DATA_SUITE");}else{this._setFilterVisibility(j1.variantId);}}this._oVariantManagement.setInitialSelectionKey(j1.variantId);}if(j1.payload&&(j||(Object.keys(JSON.parse(j1.payload)).length>0))&&this.setFilterDataAsString){k1=j1.payload;if(h1){k1=U.enrichWithValueTexts(k1,h1);}this.setFilterDataAsString(k1,j);}if(j1.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||j1.basicSearch);this._updateToolbarText();}}}};b1.prototype._setFilterVisibility=function(i){if(this._oVariantManagement.getSelectionKey()!==i){this._oVariantManagement.setInitialSelectionKey(i);var j=this._getStandardVariant();if(j){var n=this._oVariantManagement.getVariantContent(this,i);if(n&&n.filterbar){if(n.hasOwnProperty("version")){n=this.mergeVariant(j,n);}this._reapplyVisibility(n.filterbar);}}}};b1.prototype.applySettings=function(j){if(this._possibleToChangeVariantManagement()){if(j&&j.customData){for(var i=0;i<j.customData.length;i++){var n=j.customData[i];if(n&&n.mProperties&&n.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(n.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true;}}}}if(j&&j.persistencyKey){this._bHostedVariantManagement=true;}this._applyLayoutDataToToolbarButtons();G.prototype.applySettings.apply(this,arguments);if(!this._oVariantManagement||(this._oVariantManagement&&(!this._oVariantManagement.getVisible()||!this._oVariantManagement.isA("sap.ui.comp.smartvariants.SmartVariantManagement")))){if(!this.getUseToolbar()&&!this.getFilterBarExpanded()){this.setFilterBarExpanded(true);}this._afterVariantsLoad();}};b1.prototype._applyLayoutDataToToolbarButtons=function(i){if(this._isPhone()||this._isTablet()||this.getAdvancedMode()||!this.getUseToolbar()){return;}if(!K&&!this._bToolbarLayoutDataRequested){K=sap.ui.require("sap/m/ToolbarLayoutData");if(!K){sap.ui.require(["sap/m/ToolbarLayoutData"],c1.bind(this));this._bToolbarLayoutDataRequested=true;}}if(!K){return;}this._oHideShowButton.setLayoutData(new K({shrinkable:true}));this._oClearButtonOnFB.setLayoutData(new K({shrinkable:true}));this._oRestoreButtonOnFB.setLayoutData(new K({shrinkable:true}));this._oFiltersButton.setLayoutData(new K({shrinkable:true}));this._oSearchButton.setLayoutData(new K({shrinkable:false}));};function c1(i){K=i;this._bToolbarLayoutDataRequested=false;if(!this._bIsBeingDestroyed){this._applyLayoutDataToToolbarButtons();}}b1.prototype.setPersistencyKey=function(i){this.setProperty("persistencyKey",i);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true);}return this;};b1.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true;}return false;};b1.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection();}};b1.prototype.setSearchEnabled=function(i){this.setProperty("searchEnabled",i);if(this._oSearchButton){this._oSearchButton.setEnabled(i);}return this;};b1.prototype.setSearchButtonEmphType=function(i){};b1.prototype.setSimplifiedMode=function(i){};b1.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false;}return true;};b1.prototype.setExpandAdvancedArea=function(i){this.setFilterBarExpanded(i);return this;};b1.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded();};b1.prototype.setAdvancedMode=function(i){this.setProperty("advancedMode",i);this.toggleStyleClass("sapContrastPlus",!i);if(i){if(!this._oAdvancedAreaForm){this._oAdvancedAreaForm=this._createAdvancedAreaForm();}if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}}this._oFiltersButton.setVisible(!i);if(this._oHideShowButton){this._oHideShowButton.setVisible((i&&this._isPhone())?false:true);if(this._oHideShowButton.getVisible()){if(this.getFilterBarExpanded()){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW"));}}}if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!i&&this.getFilterBarExpanded());}this._oAdvancedPanel.setVisible(i&&this.getFilterBarExpanded());this._adaptButtonsEnablement();return this;};b1.prototype.setUseToolbar=function(i){this.setProperty("useToolbar",i);if(!i){this._adaptNewFilterBarDesign();}else{this._recreateToolbar();}return this;};b1.prototype._recreateToolbar=function(){if(!this._oToolbar){this._bButtonaAdded=false;if(this._oButtonsVLayout){this._oBasicAreaLayout.removeContent(this._oButtonsVLayout);this._oButtonsVLayout.destroy();this._oButtonsVLayout=null;}this._oToolbar=this._createToolbar(true);this._oToolbar.setLayoutData(new s({span:"L12 M12 S12"}));this.insertContent(this._oToolbar,0);if(this._oVariantManagement){if(this._oVariantManagement instanceof k||((this._oVariantManagement.getId()===(this.getId()+"-variant")))){this._oToolbar.insertContent(this._oVariantManagement,0);}}this._adaptButtonsEnablement();if(this._oBasicSearchFieldContainer){this._oBasicAreaLayout.removeContent(this._oBasicSearchFieldContainer);this._cleanBasicSearchContainer();this.setBasicSearch(this._oBasicSearchField);}this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:y.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());this._updateToolbarText();}};b1.prototype._cleanBasicSearchContainer=function(){if(this._oBasicSearchFieldContainer){var j=this._oBasicSearchFieldContainer.removeAllContent();if(j){for(var i=0;i<j.length;i++){if(j[i]!==this._oBasicSearchField){j[i].destroy();}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null;}};b1.prototype.setHeader=function(i){this.setProperty("header",i);if(this.getUseToolbar()){this._addHeaderToToolbar(i);}return this;};b1.prototype._addHeaderToToolbar=function(i){if(this._oToolbar){if(i){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&(this._oToolbar.indexOfContent(this._oVariantManagement)>-1)){if(!this._oSeparator){if(!M&&!this._bToolbarSeparatorRequested){M=sap.ui.require("sap/m/ToolbarSeparator");if(!M){sap.ui.require(["sap/m/ToolbarSeparator"],d1.bind(this));this._bToolbarSeparatorRequested=true;}}if(M){this._oSeparator=new M(this.getId()+"-HeadSep");}}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);this._oToolbar.setHeight("3rem");}if(!this._oText){this._oText=new T(this.getId()+"-HeadText");this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader");}this._oText.setText(i);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0);}else{if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);this._oSeparator.destroy();delete this._oSeparator;this._oToolbar.setHeight();}if(this._oText){this._oToolbar.removeContent(this._oText);this._oText.destroy();delete this._oText;}}}};function d1(i){M=i;this._bToolbarSeparatorRequested=false;if(!this._bIsBeingDestroyed){this._addHeaderToToolbar(this.getHeader());}}b1.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false;}if(!this.getUseToolbar()){return true;}return false;};b1.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(true&&this.getFilterBarExpanded());}if(this._oToolbar){var j=this._oToolbar.getContent();for(var i=0;i<j.length;i++){this._oToolbar.removeContent(j[i]);if(j[i].isA("sap.m.ToolbarSpacer")){j[i].destroy();}}if(!this.getUseToolbar()){this.removeContent(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null;}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null;}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null;}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea();}if(this._oBasicSearchField){this.setBasicSearch(this._oBasicSearchField);}this._oBasicAreaLayout.setMinItemWidth(this.getFilterContainerWidth());this._setMaxItemWidth2();}};b1.prototype._addButtonsToBasicArea=function(){var i=new t();if(sap.ui.getCore().getConfiguration().getRTL()){i.addStyleClass("sapUiCompFilterBarFloatLeft");}else{i.addStyleClass("sapUiCompFilterBarFloatRight");}var j=new H();i.addContent(new T());i.addContent(j);j.addContent(this._oClearButtonOnFB);this._oClearButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oRestoreButtonOnFB);this._oRestoreButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oFiltersButton);this._oFiltersButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oSearchButton);this._updateToolbarText();if(this._isPhone()){i.addStyleClass("sapUiCompFilterBarRemoveMinWidth");this._oBasicAreaLayout.insertContent(i,0);}else{this._oBasicAreaLayout.addEndContent(i);}this._oButtonsVLayout=i;};b1.prototype._addBasicSearchToBasicArea=function(i){if(this._oBasicSearchFieldContainer){this._cleanBasicSearchContainer();}if(i){var j=new L({text:"\u2008"});j.addStyleClass("sapBasicSearchFilter");var n=this._addControlToBasicAreaContainer(null,i,j);if(n){n.setVisible(true);var h1=0;if(this._isPhone()){h1=1;}this._oBasicAreaLayout.insertContent(n,h1);this._oBasicSearchFieldContainer=n;this._oBasicSearchFieldContainer.setWidth("100%");}}};b1.prototype._setCollectiveSearch=function(i){if(this.getAdvancedMode()){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null;}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch);}this._oCollectiveSearch=i;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}};b1.prototype.setBasicSearch=function(i){var j=this;this.setAssociation("basicSearch",i,true);if(typeof i==="string"){i=sap.ui.getCore().byId(i);}if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField);}if(i&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(i);}else{if(i&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var n=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(i,n);if(this._isUi2Mode()){i.attachLiveChange(function(h1){j.fireFilterChange(h1);});}}}this._oBasicSearchField=i;return this;};b1.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue();}return null;};b1.prototype._indexOfSpacerOnToolbar=function(){var j=this._oToolbar.getContent(),i;if(j){for(i=0;i<j.length;i++){if(j[i]instanceof f){return i;}}}return 0;};b1.prototype.addFilterItem=function(i){var n,j,h1;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty");}j=i.getControl();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty");}this.addAggregation("filterItems",i,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[];}var i1={control:i.getControl(),filterItem:i};this._aBasicAreaSelection.push(i1);h1=new F({label:i.getLabel(),controlTooltip:i.getControlTooltip(),name:i.getName(),mandatory:i.getMandatory(),visible:i.getVisible(),visibleInFilterBar:i.getVisibleInFilterBar(),partOfCurrentVariant:true,control:i.getControl(),groupName:b1.INTERNAL_GROUP,groupTitle:"",hiddenFilter:i.getHiddenFilter(),entitySetName:i.getEntitySetName(),entityTypeName:i.getEntityTypeName()});if(i.data('isCustomField')){h1.data('isCustomField',true);}i.attachChange(this._filterItemChange.bind(this,null));this.addFilterGroupItem(h1);return this;};b1.prototype.addFilterGroupItem=function(i){var n,j,h1,i1;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty");}this.addAggregation("filterGroupItems",i,true);j=i.getGroupName();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty");}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j]){this._mAdvancedAreaFilter[j]={};this._mAdvancedAreaFilter[j].filterItem=null;this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].items){this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].filterItem){this._mAdvancedAreaFilter[j].filterItem=i;}h1={control:i.getControl(),filterItem:i};if(this.getAdvancedMode()||i.getVisibleInFilterBar()){i.setVisibleInFilterBar(true);}else{i.setVisibleInFilterBar(false);}this._mAdvancedAreaFilter[j].items.push(h1);if(!i.getHiddenFilter()){i1=this._addControlToBasicAreaFormContainer(i);if(i1){h1.container=i1;i1.setVisible(i.getVisible()&&i.getVisibleInFilterBar());if(i.getVisibleInFilterBar()){i.setPartOfCurrentVariant(i.getVisibleInFilterBar());}i.attachChange(this._filterGroupItemChange.bind(this));}if(this.getAdvancedMode()){this._rerenderAA();}else{this._showHintText();}}this._adaptButtonsEnablement();return this;};b1.prototype._addParameter=function(j){var i,n,h1,i1=false,j1=false,k1=b1.INTERNAL_GROUP;j._setParameter(true);j.setVisibleInFilterBar(true);j.setPartOfCurrentVariant(true);this.addAggregation("_parameters",j,true);n={control:j.getControl(),filterItem:j};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[k1]){this._mAdvancedAreaFilter[k1]={};this._mAdvancedAreaFilter[k1].filterItem=null;}if(!this._mAdvancedAreaFilter[k1].items){this._mAdvancedAreaFilter[k1].items=[];}for(i=0;i<this._mAdvancedAreaFilter[k1].items.length;i++){var l1=this._mAdvancedAreaFilter[k1].items[i];if(l1.filterItem._isParameter()){continue;}this._mAdvancedAreaFilter[k1].items.splice(i,0,n);i1=true;break;}if(!i1){this._mAdvancedAreaFilter[k1].items.push(n);if(Object.keys(this._mAdvancedAreaFilter).length>1){j1=true;}}h1=this._addControlToBasicAreaFormContainer(j);if(h1){n.container=h1;h1.setVisible(j.getVisible());j.attachChange(this._filterGroupItemChange.bind(this));}if(i1||j1){this._oBasicAreaLayout.removeContent(h1);if(j.getVisible()){this._addContainerInOrder(n.filterItem,n.container);}}if(!this.getAdvancedMode()){this._showHintText();}this._adaptButtonsEnablement();return this;};b1.prototype._filterItemChange=function(i,j){var n,h1,i1,j1;if(j&&j.oSource&&(j.oSource.isA("sap.ui.comp.filterbar.FilterItem"))){i1=j.getParameter("propertyName");if(i1==="visibleInFilterBar"||i1==="visible"||i1==="label"||i1==="labelTooltip"||i1==="controlTooltip"||i1==="mandatory"){n=this._determineItemByName(j.oSource.getName(),b1.INTERNAL_GROUP);if(n&&n.filterItem){if((i1==="visible")){h1=j.oSource.getVisible();n.filterItem.setVisible(h1);}else if(i1==="visibleInFilterBar"){h1=j.oSource.getVisibleInFilterBar();var k1=this._checkChangePossibleVisibleInFilterBar(n.filterItem,h1);if(k1){n.filterItem.setVisibleInFilterBar(h1);}else{j.oSource.setVisibleInFilterBar(true);}}else if(i1==="label"){n.filterItem.setLabel(j.oSource.getLabel());}else if(i1==="labelTooltip"){n.filterItem.setLabelTooltip(j.oSource.getLabelTooltip());}else if(i1==="controlTooltip"){j1=this.determineControlByFilterItem(n.filterItem,true);if(j1&&j1.setTooltip){j1.setTooltip(n.filterItem.getControlTooltip());}}else if(i1==="mandatory"){h1=j.oSource.getMandatory();n.filterItem.setMandatory(h1);}}}}};b1.prototype._filterGroupItemChange=function(i){var j;var n;if(i&&i.oSource){n=i.getParameter("propertyName");if(n==="visibleInFilterBar"||n==="visible"){j=this._determineItemByName(i.oSource.getName(),i.oSource.getGroupName());if(j){if(n==="visibleInFilterBar"){var h1=i.oSource.getVisibleInFilterBar();var i1=this._checkChangePossibleVisibleInFilterBar(i.oSource,h1);if(!i1){i.oSource.setVisibleInFilterBar(true);h1=true;}if(h1){i.oSource.setPartOfCurrentVariant(true);}if(!this.getAdvancedMode()&&!this._oDialog){this._rerenderItem(j);this._adaptLinkText(i.oSource.getGroupName());}}else if(n==="visible"){if(this.getAdvancedMode()&&j.container){j.container.setVisible(true);}else{this._updateToolbarText();this._rerenderGroup(j,i.oSource.getGroupName());}}this._showHintText();}}else if(n==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i.oSource.getGroupName()]){if(this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer.setTitle(i.oSource.getGroupTitle());}else{this._adaptGroupTitle(i.oSource.getGroupName());}}}else if(n==="label"){if(!this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._adaptGroupTitleForFilter(i.oSource);}}else if(n==="mandatory"){if(this._oFilterDialog){this._adaptMandatoryForFilter(i.oSource);}}else if((n==="partOfCurrentVariant")&&this.ensureLoadedValueHelpList){var j1=this.determineFilterItemByName(i.oSource.getName());if(j1&&j1.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(i.oSource.getName());}}if(this.getAdvancedMode()){this._rerenderAA();}}};b1.prototype._addContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)===-1)){this._addContainerInOrder(i.filterItem,i.container);}}}};b1.prototype._removeContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)>-1)){this._oBasicAreaLayout.removeContent(i.container);}}}};b1.prototype._addContainerInOrder=function(j,h1){var n,i,i1,j1=this._oBasicAreaLayout.getContent(),k1=-1;if(this._isNewFilterBarDesign()){if(this._isPhone()){k1++;}if(this._oBasicSearchField){k1++;}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){var l1=this._mAdvancedAreaFilter[n];if(l1&&l1.items){for(i=0;i<l1.items.length;i++){if(!l1.items[i].container){continue;}if(l1.items[i].container===h1){this._oBasicAreaLayout.insertContent(h1,k1+1);return;}i1=j1.indexOf(l1.items[i].container);if(i1>=0){k1=i1;}}}}}};b1.prototype._checkChangePossibleVisibleInFilterBar=function(i,j){if(i&&i.getMandatory()&&!j){var n=this._hasFilterValue(i);if(!n){i.setVisibleInFilterBar(true);return false;}}return true;};b1.prototype._adaptLinkText=function(i){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i]&&this._mAdvancedAreaFilter[i].link){this._setLinkText(i,this._mAdvancedAreaFilter[i].link);}};b1.prototype._hasFilterValue=function(i){var j;if(!this._getTriggerFilterChangeState()&&this.getAllFiltersWithValues){j=this.getAllFiltersWithValues();}else{j=this._getFiltersWithValues();}return this._checkFilterForValue(j,i);};b1.prototype._adaptMandatoryForFilter=function(i){var j;var n=i.getGroupName();if(i){j=this._determineItemByName(i.getName(),n);if(j&&j.checkbox&&j.checkbox.getVisible()){var h1=true;if(i.getMandatory()){var i1=this._hasFilterValue(i);if(!i1){h1=false;i.setVisibleInFilterBar(true);}}j.checkbox.setEnabled(h1);}}};b1.prototype._adaptGroupTitleForFilter=function(i){var j;var n;if(i&&!i.getHiddenFilter()){j=i.getLabel();n=i.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(n&&i.getGroupTitle()){n.setText(j+" ("+i.getGroupTitle()+')');}}else{n.setText(j);}}};b1.prototype._adaptGroupTitle=function(j){var i;var n;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if(n&&n){this._adaptGroupTitleForFilter(n.filterItem);}}}};b1.prototype._adaptGroupsTitle=function(){var n=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&n!==b1.INTERNAL_GROUP){this._adaptGroupTitle(n);}}}};b1.prototype.registerGetFiltersWithValues=function(i){this._fRegisterGetFiltersWithValues=i;return this;};b1.prototype.registerFetchData=function(i){this._fRegisteredFetchData=i;return this;};b1.prototype.registerApplyData=function(i){this._fRegisteredApplyData=i;return this;};b1.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true;}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true;}}return false;};b1.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null);}this._fireInitialiseEvent();}else{this._initializeVariantManagement();}};b1.prototype.variantsInitialized=function(){this._afterVariantsLoad();this.fireInitialized();};b1.prototype.fireInitialized=function(){this.fireEvent("initialized");};b1.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this);}else{this._fInitialiseVariants=this._initialiseVariants.bind(this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise();}}else{this._fireInitialiseEvent();}};b1.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");this._showHintText();}catch(i){w.error("error during initialise event handling - "+i.message);}this._bIsInitialized=true;this._updateToolbarText();};b1.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};b1.prototype.fireAfterVariantLoad=function(i,j){this._rerenderFilters();var n={context:i,executeOnSelect:j};try{this.fireEvent("afterVariantLoad",n);}catch(ex){w.error("error during 'afterVariantLoad' event handling - "+ex.message);}};b1.prototype.fireBeforeVariantSave=function(i){var j={context:i};var n=this._getConsiderFilterChanges();if(i){this._setConsiderFilterChanges(false);}this.fireEvent("beforeVariantSave",j);if(i){this._setConsiderFilterChanges(n);}};b1.prototype.removeAllFilterItems=function(){var i;var j=[];this._aBasicAreaSelection=null;var n=this._oBasicAreaLayout.getContent();if(n){for(i=0;i<n.length;i++){this._oBasicAreaLayout.removeContent(n[i]);}}if(this._mAdvancedAreaFilter){if((this._mAdvancedAreaFilter[b1.INTERNAL_GROUP])&&(this._mAdvancedAreaFilter[b1.INTERNAL_GROUP].items)){for(i=0;i<this._mAdvancedAreaFilter[b1.INTERNAL_GROUP].items.length;i++){if(this._mAdvancedAreaFilter[b1.INTERNAL_GROUP].items[i].filterItem){j.push(this._mAdvancedAreaFilter[b1.INTERNAL_GROUP].items[i].filterItem);}}delete this._mAdvancedAreaFilter[b1.INTERNAL_GROUP];}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this._destroyItems(j);this._adaptButtonsEnablement();return j;};b1.prototype.removeAllFilterGroupItems=function(){var n=null,i;var j=[];for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){if(this._mAdvancedAreaFilter[n].items[i].filterItem){j.push(this._mAdvancedAreaFilter[n].items[i].filterItem);}}delete this._mAdvancedAreaFilter[n];}}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this.__bDeleteMode=true;this._destroyItems(j);this.__bDeleteMode=false;this._adaptButtonsEnablement();return j;};b1.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch();};b1.prototype.removeBasicSearch=function(){this.setBasicSearch(null);};b1.prototype.getAllFilterItems=function(j){var i,n=null;var h1=[];var i1,j1;if(!j){this._ensureFilterLoaded(null);}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){i1=this._mAdvancedAreaFilter[n];if(i1.items){for(i=0;i<i1.items.length;i++){j1=i1.items[i];if(j1&&j1.filterItem&&j1.filterItem.getVisible()){if(j){if(j1.filterItem.getVisibleInFilterBar()||j1.filterItem.getPartOfCurrentVariant()){h1.push(j1.filterItem);}}else{h1.push(j1.filterItem);}}}}}}}return h1;};b1.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState();};b1.prototype.getAggregation=function(n){if(n=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null);}return G.prototype.getAggregation.apply(this,arguments);};b1.prototype._getFilterInformation=function(){return[];};b1.prototype._createVisibleFilters=function(){this._getFilters();};b1.prototype._getFilters=function(){this._aFields=this._getFilterInformation();var i,j;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[b1.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[b1.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[b1.INTERNAL_GROUP].items=null;}}for(i=0;i<this._aFields.length;i++){j=this._aFields[i];if(j.groupName!==b1.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[j.groupName]){this._mAdvancedAreaFilter[j.groupName]={};this._mAdvancedAreaFilter[j.groupName].groupTitle=j.groupTitle;this._mAdvancedAreaFilter[j.groupName].filterItem=null;this._mAdvancedAreaFilter[j.groupName].items=[];}}if(j.visibleInAdvancedArea||(j.groupName===b1.INTERNAL_GROUP)){this._instanciateFilterItem(j);}}}this._adaptButtonsEnablement();};b1.prototype.isVisibleInFilterBarByName=function(n){var i,j=this._getFilterMetadata(n);if(j&&j.factory){if((j.hasOwnProperty("visibleInAdvancedArea")&&j.visibleInAdvancedArea)||(j.groupName===b1.INTERNAL_GROUP)){return true;}}else{i=this.determineFilterItemByName(n);if(i){return i.getVisibleInFilterBar();}}return false;};b1.prototype._getFilterMetadata=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i];}}}return null;};b1.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames();}else{return this._getNonVisibleCustomFilterNames();}};b1.prototype._getLazyNonVisibleCustomFilterNames=function(){var i=this,j=[];this._aFields.forEach(function(n){if(n.factory){if(n.isCustomFilterField&&!n.visibleInAdvancedArea){j.push(n.fieldName);}}else if(i._isNonVisibleCustomFilterNamesByName(n.fieldName,n.groupName)){j.push(n.fieldName);}});return j;};b1.prototype._isNonVisibleCustomFilterNamesByName=function(n,j){var i,h1;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){h1=this._mAdvancedAreaFilter[j].items[i];if(h1.filterName&&(h1.filterItem.getName()===n)){return this._isNonVisibleCustomFilterNamesByFilter(h1.filterItem);}}}return false;};b1.prototype._isNonVisibleCustomFilterNamesByFilter=function(i){if(i.data("isCustomField")&&!i.getVisibleInFilterBar()){return true;}return false;};b1.prototype._getNonVisibleCustomFilterNames=function(){var i=this,j=[],n=this.getAllFilterItems();if(n){n.forEach(function(h1){if(i._isNonVisibleCustomFilterNamesByFilter(h1)){j.push(h1.getName());}});}return j;};b1.prototype._ensureFilterLoaded=function(n){var i,j,h1;if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){h1=this._aFields[j];if(!h1.factory){continue;}if(n){for(i=0;i<n.length;i++){if((h1.fieldName===n[i].name)&&(h1.groupName===n[i].group)){this._instanciateFilterItem(h1);break;}}}else{this._instanciateFilterItem(h1);}}if(!n){this._aFields=[];}}};b1.prototype._instanciateFilterItem=function(i){var j=i.factory;if(j){delete i.factory;j.call(i);}};b1.prototype._destroyItems=function(j){if(j&&j.length){for(var i=0;i<j.length;i++){j[i].destroy();}}};b1.prototype._reapplyVisibility=function(j){var i,n=null;var h1;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var i1=this._mAdvancedAreaFilter[n];if(i1&&i1.items){for(i=0;i<i1.items.length;i++){h1=i1.items[i];if(h1&&h1.filterItem){this._setPersVisibility(j,h1.filterItem);}}if(n!==b1.INTERNAL_GROUP){this._adaptLinkText(n);}}}}}};b1.prototype._setPersVisibility=function(i,j){var n,h1;if(j&&!j.getHiddenFilter()){n=j.getGroupName();h1=this._checkForFilterInfo(i,j);if(this._isTINAFScenario()){if(h1){j.setVisibleInFilterBar(h1.visibleInFilterBar);j.setPartOfCurrentVariant(h1.partOfCurrentVariant);if(h1.hasOwnProperty("visible")){j.setVisible(h1.visible);}}else{j.setVisibleInFilterBar(false);if((n===b1.INTERNAL_GROUP)||j._isParameter()){j.setPartOfCurrentVariant(true);}else{j.setPartOfCurrentVariant(false);}}}else{if(h1&&(h1.visibleInFilterBar!==undefined)){j.setVisibleInFilterBar((h1.visibleInFilterBar));j.setPartOfCurrentVariant((h1.partOfCurrentVariant));}else{if((n!==b1.INTERNAL_GROUP)&&h1&&(h1.group===n)){j.setVisibleInFilterBar((h1!==null));}}}if(n===b1.INTERNAL_GROUP){j.setPartOfCurrentVariant(true);}if(j){var i1=this.determineControlByFilterItem(j,true);if(i1&&i1.getValueState&&(i1.getValueState()!==x.None)){i1.setValueState(x.None);}}}};b1.prototype._checkForFilterInfo=function(j,n,h1,i1){var i,h1=n.getName(),j1=[n.getGroupName(),n.getEntitySetName(),n.getEntityTypeName()];if(j&&j.length){for(i=0;i<j.length;i++){if(j[i].name===h1){if(j1.indexOf(j[i].group)>-1){return j[i];}}}}return null;};b1.prototype._createVariantManagement=function(){var i=new k(this.getId()+"-variantUi2",{});var j=new h({type:"filterBar",keyName:"persistencyKey"});j.setControl(this);i.addPersonalizableControl(j);i.addStyleClass("sapUiCompFilterBarMarginLeft");return i;};b1.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged");};b1.prototype.retrieveFiltersWithValuesAsText=function(){var j,n,h1=this.retrieveFiltersWithValues(),i1,j1=this.getBasicSearchValue();if(j1&&h1){h1.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"));}if(!h1||(h1.length===0)){j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO");}else{if(!this._isPhone()){i1=Math.min(5,h1.length);n="";for(var i=0;i<i1;i++){n+=h1[i];if(i<(i1-1)){n+=', ';}}j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[h1.length,n]);if(i1<h1.length){j+=", ...";}}else{j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[h1.length]);}}return j;};b1.prototype.retrieveFiltersWithValues=function(){var i,j=[];var n=this._getFiltersWithValues();if(n){for(i=0;i<n.length;i++){if(n[i].getVisible()&&n[i].getPartOfCurrentVariant()){j.push(n[i].getLabel());}}}return j;};b1.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues();}catch(i){w.error("callback for obtaining the filter count throws an exception");}}return null;};b1.prototype._getFiltersWithValuesCount=function(){var n=0;var i=this.retrieveFiltersWithValues();n=i.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){n++;}return n;};b1.prototype._checkFilterForValue=function(j,n){var i;if(j){for(i=0;i<j.length;i++){if(j[i]===n){return true;}}}return false;};b1.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var j=false;var n=this._oToolbar.getContent();for(var i=0;i<n.length;i++){if(n[i]instanceof f){continue;}if(n[i].getVisible&&n[i].getVisible()){j=true;break;}}this._oToolbar.setVisible(j);}};b1.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());};b1.prototype._updateToolbarText=function(){var i=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var j=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var n=this._getFiltersWithValuesCount();var h1=n?(this._oRb.getText(i,[n])):(this._oRb.getText(j));if(h1!==this._oFiltersButton.getText()){this._oFiltersButton.setText(h1);if(this._oBasicAreaLayout){this._oBasicAreaLayout.reflow();}}this._oFiltersButton.setTooltip(h1);this.fireAssignedFiltersChanged();};b1.prototype.setFilterBarExpanded=function(i){var j;if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",i);if(this._oHideShowButton){if(i){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_VH_SHOW"));}}this._calcVisibilityGoButton();this._oAdvancedPanel.setVisible(i);}else{if(this._isPhone()&&this.getUseToolbar()){j=false;}else{j=i;}this.setProperty("filterBarExpanded",j);if(this._isNewFilterBarDesign()){return this;}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false);}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false);}else{if(this._oHideShowButton){if(j){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_SHOW"));}this._oHideShowButton.setVisible(true);}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(j);}else{this._oBasicAreaLayout.setVisible(false);}}}}this._updateToolbarText();return this;};b1.prototype._selectionChangedInFilterDialog=function(i,j){j.setVisibleInFilterBar(i.getSelected());if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;};b1.prototype._mandatoryFilterChange=function(i){if(!i){return;}var j=i.getParameters();if(!j||!j.oSource){return;}var n=this._determineByControl(j.oSource);if(n&&n.checkbox){var h1=n.filterItem;if(!h1.getMandatory()){return;}var i1=this._hasFilterValue(h1);if(h1.getVisibleInFilterBar()){if(i1){n.checkbox.setEnabled(true);}else{n.checkbox.setEnabled(false);}}else{if(!i1){h1.setVisibleInFilterBar(true);n.checkbox.setSelected(true);n.checkbox.setEnabled(false);}}}};b1.prototype._createFiltersAndAdaptBasicArea=function(){var i;this._setConsiderFilterChanges(false);this._recreateBasicAreaContainer(true);i=this._createFilters();this._retrieveVisibleAdvancedItems();this._setConsiderFilterChanges(true);return i;};b1.prototype._determineNotAssignedFiltersCount=function(j){var n=0,i,h1;if(this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){h1=this._mAdvancedAreaFilter[j].items[i].filterItem;if(!h1.getVisible()||h1.getHiddenFilter()){continue;}if(!h1.getPartOfCurrentVariant()&&!h1.getVisibleInFilterBar()){n++;}}}return n;};b1.prototype._rerenderGroup=function(j,n){var i;var h1;this._rerenderItem(j);this._adaptLinkText(n);if(j.formelement){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items&&this._mAdvancedAreaFilter[n].formcontainer){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){h1=this._mAdvancedAreaFilter[n].items[i].filterItem;if(h1&&h1.getVisible()){this._mAdvancedAreaFilter[n].formcontainer.setVisible(true);return;}}this._mAdvancedAreaFilter[n].formcontainer.setVisible(false);}}};b1.prototype._setLinkTextAndCount=function(i,j,n){var h1;if(n){h1=this._oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[n]);}else{h1=this._oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS");}j.setText(h1);};b1.prototype._setLinkText=function(i,j){var n=this._determineNotAssignedFiltersCount(i);this._setLinkTextAndCount(i,j,n);};b1.prototype._createLink=function(i,j){var n,h1=this;n=u.replace(i);var i1=new b(this.getId()+"-link-"+n);this._setLinkText(i,i1);i1.attachPress(function(){h1._createAddRemoveFiltersDialog(i,i1);});if(j){i1.addAriaLabelledBy(j);}return i1;};b1.prototype._isPhone=function(){return(D.system.phone)?true:false;};b1.prototype._isTablet=function(){return(D.system.tablet&&!D.system.desktop)?true:false;};b1.prototype._createForm=function(i){var j=this;var n=new W(this.getId()+"-form",{editable:true,layout:i});n.contentOnAfterRendering=function(h1,i1){W.prototype.contentOnAfterRendering.apply(this,arguments);if(i1.isA("sap.m.MultiInput")){j._adaptStyleSheet(i1);}};return n;};b1.prototype._adaptStyleSheet=function(i){var j;var n;if(i.isA("sap.m.MultiInput")){n=i.$();if(n){j=n.parent().css("overflow");if(j!=="visible"){n.parent().css({"overflow":"visible"});}}}};b1.prototype._addFieldToFiltersDialog=function(i,j,n){var h1,i1,j1,k1;if(!i&&!i.filterItem||i.filterItem.getHiddenFilter()){return;}var l1=this._determineVisibility(i.filterItem);if(i.control.getWidth){i.width=i.control.getWidth();if(i.control.setWidth){i.control.setWidth("100%");}}h1=i.filterItem.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){h1.setText(i.filterItem.getLabel());}i1=new C({tooltip:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});i1.setSelected(i.filterItem.getVisibleInFilterBar());if(i.filterItem.getMandatory()){k1=this._checkFilterForValue(n,i.filterItem);if(!k1&&i.filterItem.getVisibleInFilterBar()){i1.setEnabled(false);}}i1.attachSelect(this._selectionChangedInFilterDialog.bind(this,i1,i.filterItem));if(this._isNewFilterBarDesign()||!this._isPhone()){i.control.setLayoutData(new s({span:"L8 M8 S11"}));i1.setLayoutData(new s({span:"L1 M1 S1"}));}else{i.control.setLayoutData(new s({span:"L8 M8 S12"}));i1.setVisible(false);}j1=new Y({label:h1,fields:[i.control,i1]});j1.setVisible(l1);i.formelement=j1;i.checkbox=i1;j.addFormElement(j1);};b1.prototype._createHeaderAddToFilterBar=function(i){var j;if(this._isNewFilterBarDesign()||!this._isPhone()){j=new L(this.getId()+"-addToFilterBar",{text:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});var n=new $({text:i.getTitle().getText(),level:c.TitleLevel.H5,titleStyle:c.TitleLevel.H5});var h1=new e(this.getId()+"-addToFilterBarToolbar",{content:[n,new f(),j]});i.setToolbar(h1);i.addAriaLabelledBy(n);j.setLabelFor(null);}};b1.prototype._addBasicSearchAddToFilterBar=function(i){var j;if(!this._isPhone()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();if(this._oToolbar){this._replaceOnToolbar(this._oBasicSearchField,this._oBasicSearchFieldClone);}else{this._addBasicSearchToBasicArea(this._oBasicSearchFieldClone);}}else{if(this.getAdvancedMode()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();}}if(this._isNewFilterBarDesign()||!this._isPhone()){this._oBasicSearchField.setLayoutData(new s({span:"L8 M8 S11",indent:"L3 M3 S0"}));}else{this._oBasicSearchField.setLayoutData(new s({span:"L8 M8 S12"}));}if(this._isPhone()&&this.getAdvancedMode()){j=new Y({fields:[this._oBasicSearchFieldClone]});}else{j=new Y({fields:[this._oBasicSearchField]});}i.addFormElement(j);};b1.prototype._isGroupEmpty=function(i){var j=true;i.some(function(n){if(n.filterItem&&n.filterItem.getVisible()&&!n.filterItem.getHiddenFilter()){j=false;return true;}return false;});return j;};b1.prototype._createFilters=function(){var j=this,n=null,i,h1;var i1=null,j1,k1,l1;var m1,n1,o1=true,p1;this._oClonedVM=null;var q1=new Z();q1.setColumnsL(1);q1.setLabelSpanL(3);q1.setColumnsM(1);q1.setLabelSpanM(3);var r1=this._createForm(q1);r1.addStyleClass("sapUiCompFilterBarDialogForm");if(this._possibleToChangeVariantManagement()&&this._oToolbar){var s1=this._oToolbar.indexOfContent(this._oVariantManagement);if(s1>=0){this._oClonedVM=this._oVariantManagement.clone();this._oClonedVM._setSelectionByKey(this._oVariantManagement.getSelectionKey());this._replaceOnToolbar(this._oVariantManagement,this._oClonedVM);i1=new X();this._oVariantManagement.setLayoutData(new s({span:"L10 M10 S12"}));j1=new Y({fields:this._oVariantManagement});i1.addFormElement(j1);r1.addFormContainer(i1);}r1.addStyleClass("sapUiCompFilterBarGroupTitle");}if(this._oBasicSearchField&&!this._isNewFilterBarDesign()){if(!i1){i1=new X();r1.addFormContainer(i1);}this._addBasicSearchAddToFilterBar(i1);}this._ensureFilterLoaded(null);var t1=this._getFiltersWithValues();this._fRegisteredFilterChangeHandlers=function(u1){j._mandatoryFilterChange(u1);};this.attachFilterChange(this._fRegisteredFilterChangeHandlers);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();}this._oInitialVariant={};q.extend(true,this._oInitialVariant,this._oVariant);for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){if(n===b1.INTERNAL_GROUP){h1=this._oRb.getText("FILTER_BAR_BASIC_GROUP");}else{h1=this._mAdvancedAreaFilter[n].filterItem.getGroupTitle();}n1=new p({text:h1});i1=new X({title:n1});if(o1&&!this._isGroupEmpty(this._mAdvancedAreaFilter[n].items)){o1=false;this._createHeaderAddToFilterBar(i1);if(this._oBasicSearchField&&this._isNewFilterBarDesign()){this._addBasicSearchAddToFilterBar(i1);}}p1=0;this._mAdvancedAreaFilter[n].formcontainer=i1;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){l1=this._mAdvancedAreaFilter[n].items[i];this._addFieldToFiltersDialog(l1,i1,t1);if(!l1.filterItem.getVisible()){p1++;}}k1=i1.getFormElements();if(k1&&k1.length>0){if((n!==b1.INTERNAL_GROUP)&&!this.getAdvancedMode()){m1=this._createLink(n,n1);if(m1){if(this._isPhone()){m1.setLayoutData(new s({span:"L8 M8 S12"}));}else{m1.setLayoutData(new s({span:"L8 M8 S12",indent:"L3 M3 S0"}));}j1=new Y({fields:[m1]});this._mAdvancedAreaFilter[n].link=m1;i1.addFormElement(j1);}if(p1===k1.length){i1.setVisible(false);}}r1.addFormContainer(i1);}}}return r1;};b1.prototype._replaceOnToolbar=function(i,n){var j;if(this._oToolbar){j=this._oToolbar.indexOfContent(i);if(j>-1){this._oToolbar.insertContent(n,j);this._oToolbar.removeContent(i);}}};b1.prototype._recreateBasicAreaContainer=function(j){var n=null,i;var h1,i1;var j1,k1,l1;if(this._possibleToChangeVariantManagement()&&this._oToolbar&&this._oClonedVM&&this._oVariantManagement){this._replaceOnToolbar(this._oClonedVM,this._oVariantManagement);this._oClonedVM.destroy();this._oClonedVM=null;}if(!this._isPhone()&&this._oToolbar&&this._oBasicSearchFieldClone&&this._oBasicSearchField){this._replaceOnToolbar(this._oBasicSearchFieldClone,this._oBasicSearchField);this._oBasicSearchFieldClone.destroy();this._oBasicSearchFieldClone=null;}var m1=this._oBasicAreaLayout.removeAllContent();if(!j){if(m1){var n1=m1.length;var o1=0;if(this._isNewFilterBarDesign()){if(this._isPhone()){o1++;}else{n1--;}}for(i=o1;i<n1;i++){if(m1[i]!==this._oHintText){m1[i].destroy();}}}}if(this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(this._oBasicSearchField);this._addButtonsToBasicArea();}for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j1=this._mAdvancedAreaFilter[n].items[i].filterItem;if(j1.getHiddenFilter()){continue;}l1=null;if(j){if(!j1.getVisible()||!j1.getVisibleInFilterBar()){continue;}k1=this._mAdvancedAreaFilter[n].items[i].container;if(k1){if(k1.$()&&k1.$().width()){l1=k1.$().width();}k1.removeAllContent();k1.destroy();}h1=this._mAdvancedAreaFilter[n].items[i].control.clone();i1=j1.getLabelControl(this.getId()).clone();i1.setLabelFor(null);if(this.getConsiderGroupTitle()){j1.getLabelControl(this.getId()).setText(j1.getLabel());}}else{h1=this._mAdvancedAreaFilter[n].items[i].control;i1=j1.getLabelControl(this.getId());if(this._mAdvancedAreaFilter[n].items[i].width){h1.setWidth("100%");}}k1=this._addControlToBasicAreaContainer(j1,h1,i1);if(k1){k1.setVisible(j1.getVisible()&&j1.getVisibleInFilterBar());this._mAdvancedAreaFilter[n].items[i].container=k1;if(j&&l1){k1.setWidth("100%");}}}}}};b1.prototype._searchRequested=function(){var i,j=false;if(this.verifySearchAllowed){i=this.verifySearchAllowed();if(i.hasOwnProperty("pending")){return;}else if(i.hasOwnProperty("error")||i.hasOwnProperty("mandatory")){j=true;}}if(j){this._bOKFiltersDialogTriggered=false;if(this._oFiltersSearchField.getValue()){this._resetFilterBarSearch();}this._activateMainContent();}else{this._bOKFiltersDialogTriggered=true;if(!this.isLiveMode||!this.isLiveMode()){this.search();}else{this._oFilterDialog.close();}}};b1.prototype._activateMainContent=function(){var i=this.getFilterDialogContent();if(i&&(i.length>1)){this.addFilterDialogContent(i[0]);}};b1.prototype.fireSearch=function(i){if(this._oFilterDialog&&this._bOKFiltersDialogTriggered){this._oFilterDialog.close();}this.fireEvent("search",i);};b1.prototype._closeDialogAndRestoreFilterBar=function(i){this._sSearchCriteriaInFiltersDialog=null;this._oVariant={};i.removeAllFormContainers();this._recreateBasicAreaContainer();this._deleteProperties();this._adaptGroupsTitle();if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}if(this.isLiveMode&&this.isLiveMode()){this.search();}this._updateToolbarText();};b1.prototype._variantSave=function(i){var j;this._oVariant={};this.fireBeforeVariantSave();if(this._oVariantManagement&&this._oFilterDialog){j=this._oVariantManagement.getSelectionKey();this._oVariant.key=j;this._oVariant.modified=false;this._oVariant.content=this._oVariantManagement.getVariantContent(this,j);}};b1.prototype._afterVariantSave=function(i){this.fireAfterVariantSave();};b1.prototype._variantSavePressed=function(i){this._bVariantSavePressed=true;if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();var n=this._oVariantManagement.getItemByKey(this._oVariantManagement.getSelectionKey());if(!this._oVariantManagement._isIndustrySolutionModeAndVendorLayer()&&((j===this._oVariantManagement.getStandardVariantKey())||(n&&n.getReadOnly&&n.getReadOnly()))){this._oVariantManagement._openSaveAsDialog();}else{this._oVariantManagement._variantSavePressed();}this._bDirtyViaDialog=false;if(this._oInitialVariant&&this._oVariantManagement._getVariantContent){this._oInitialVariant.content=this._oVariantManagement._getVariantContent(this,j);}}};b1.prototype._filterSetInErrorState=function(i){if(this._oFilterDialog&&this._oFilterDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;}};b1.prototype._cancelFilterDialog=function(i){if(i&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled;}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===false)){this.fireCancel();return;}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){this._resetFiltersInErrorValueState();this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement._setSelectionByKey(this._oInitialVariant.key);}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified);}this.fireCancel();}};b1.prototype._resetFiltersInErrorValueState=function(){var n;n=this._retrieveCurrentSelectionSet(true,true);n.forEach(function(i){if(i.control&&i.control.setValueState&&i.control.getValueState){if(i.control.getValueState()===x.Error){if(i.control.setValue){i.control.setValue("");}i.control.setValueState(x.None);}}});};b1.prototype.showFilterDialog=function(){if(!this._oFilterDialog){this._showFilterDialog();}};b1.prototype.addFilterDialogContent=function(i){if(this._oFilterDialog&&i){var n=this._oFilterDialog.indexOfContent(i);if(n<0){this._oFilterDialog.addContent(i);}return this._setFilterDialogActiveContent(i);}return null;};b1.prototype.getFilterDialogContent=function(){if(this._oFilterDialog){return this._oFilterDialog.getContent();}return null;};b1.prototype._setFilterDialogActiveContent=function(n){var i=false;if(this._oFilterDialog){this.getFilterDialogContent().forEach(function(j){if(n===j){j.setVisible(true);i=true;}else{j.setVisible(false);}});if(i){return n;}}return null;};b1.prototype._getFilterDialogActiveContent=function(){var i=null;if(this._oFilterDialog){this.getFilterDialogContent().some(function(j){if(j.getVisible()){i=j;return true;}return false;});}return i;};b1.prototype.setContentWidth=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentWidth(n+"px");}};b1.prototype.setContentHeight=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentHeight(n+"px");}};b1.prototype._showFilterDialog=function(){if((!N||!O||!W||!X||!Y||!Z||!$)&&!this._bDialogRequested){N=sap.ui.require("sap/m/Dialog");O=sap.ui.require("sap/m/OverflowToolbarLayoutData");W=sap.ui.require("sap/ui/layout/form/Form");X=sap.ui.require("sap/ui/layout/form/FormContainer");Y=sap.ui.require("sap/ui/layout/form/FormElement");Z=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");$=sap.ui.require("sap/m/Title");if(!N||!O||!W||!X||!Y||!Z||!$){sap.ui.require(["sap/m/Dialog","sap/m/OverflowToolbarLayoutData","sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout","sap/m/Title"],e1.bind(this));this._bDialogRequested=true;}}if(!N||!O||!W||!X||!Y||!Z||!$){return;}var i=this;this._oFilterDialog=new N(this.getId()+"-adapt-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true,contentWidth:"60rem"});this._oFilterDialog.isPopupAdaptationAllowed=function(){return false;};this._oFilterDialog.setParent(this);this._oFilterDialog.addStyleClass("sapUiPopupWithPadding");if(this.$().closest(".sapUiSizeCompact").length>0){this._oFilterDialog.addStyleClass("sapUiSizeCompact");}this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialog");if(!this._isPhone()){this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialogNonPhone");}var j="FILTER_BAR_ADV_FILTERS_DIALOG";if(this._isNewFilterBarDesign()){j="FILTER_BAR_ADAPT_FILTERS_DIALOG";}this._oFilterDialog.setTitle(this._oRb.getText(j));this._oFilterDialog.addStyleClass("sapMH4FontSize");this._oFilterDialog.addStyleClass("sapMH4Style");this._oFilterDialog.setVerticalScrolling(true);var n=new B();this._oFiltersSearchField=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});n.addContentRight(this._oFiltersSearchField);this._oFilterDialog.setSubHeader(n);var h1=this._createFiltersAndAdaptBasicArea();if(!h1){w.error("Content for Advanced Filters Dialog could not be created");return;}this._oFilterDialog.addContent(h1);this._oFiltersSearchField.attachLiveChange(function(i1){if(this._oFilterDialog){this.fireFiltersDialogSearchForFilters(i1.getParameters());this._triggerSearchInFilterDialog(i1);}}.bind(this));this._bOKFiltersDialogTriggered=false;this._bVariantSaveFiltersDialogTriggered=false;this._oFilterDialog.bDoNotAddToBasicArea=true;this._oFilterDialog.attachBeforeOpen(function(){this.fireFiltersDialogBeforeOpen();}.bind(this));this._oFilterDialog.attachBeforeClose(function(){if(!i._bOKFiltersDialogTriggered){i._cancelFilterDialog(i._bVariantSaveFiltersDialogTriggered);}delete i._oFilterDialog.bDoNotAddToBasicArea;i._closeDialogAndRestoreFilterBar(h1);});this._oFilterDialog.attachAfterClose(function(){i._oBasicAreaLayout.rerender();i._oInitialVariant=null;i._oFilterDialog.destroy();i._oFilterDialog=null;i._showHintText();var i1={};i1.context=i._bOKFiltersDialogTriggered?"SEARCH":"CANCEL";i.fireFiltersDialogClosed(i1);});this._oFilterDialog.setInitialFocus(this._oFiltersSearchField);this._addFilterDialogButtons(h1);this._bDirtyViaDialog=false;this._oFilterDialog.open();};function e1(i,j,n,h1,i1,j1,k1){N=i;O=j;W=n;X=h1;Y=i1;Z=j1;$=k1;this._bDialogRequested=false;if(!this._bIsBeingDestroyed){this._showFilterDialog();}}b1.prototype.isDialogOpen=function(){return this._oFilterDialog?true:false;};b1.prototype._addFilterDialogButtons=function(i){var j=this;var n;var h1=null,i1,j1,k1,l1;k1=new a(this.getId()+"-btnGoFilterDialog",{text:this._oRb.getText("FILTER_BAR_GO"),press:function(){k1.focus();j._dialogSearch(i);},layoutData:new O({priority:_.NeverOverflow}),type:E.Emphasized});this._oFilterDialog.addButton(k1);if(!this.getAdvancedMode()){if(this._oVariantManagement&&this._oVariantManagement.getVisible()){this._oVariantManagement._delayedControlCreation();if(this._oVariantManagement.oVariantSave){h1=new a(this.getId()+"-btnSaveFilterDialog",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),enabled:this._oVariantManagement.oVariantSave.getEnabled(),press:function(){j._dialogVariantSave(i);},layoutData:new O({priority:_.Low})});n=this._oVariantManagement.getModel("save_enablement");h1.setModel(n);h1.bindProperty("enabled","/enabled");this._oFilterDialog.addButton(h1);}}i1=new a(this.getId()+"-btnClearFilterDialog",{text:this._oRb.getText("FILTER_BAR_CLEAR"),visible:this.getShowClearButton(),press:function(){j._dialogClear(i);},layoutData:new O({priority:_.Low})});this._oFilterDialog.addButton(i1);j1=new a(this.getId()+"-btnRestoreFilterDialog",{text:this._oRb.getText("FILTER_BAR_RESTORE"),visible:this.getShowRestoreButton(),press:function(){j._dialogRestore(i);},layoutData:new O({priority:_.Low})});if(n){j1.setEnabled(this._oVariantManagement.oVariantSave.getEnabled());j1.setModel(n);j1.bindProperty("enabled","/enabled");}this._oFilterDialog.addButton(j1);l1=new a(this.getId()+"-btnCancelFilterDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){j._dialogCancel(i);},layoutData:new O({priority:_.High})});this._oFilterDialog.addButton(l1);}};b1.prototype._dialogSearch=function(i){this.fireFiltersDialogSearch();this._searchRequested();};b1.prototype._dialogCancel=function(i){if(this._oFilterDialog){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel();this._oFilterDialog.close();}};b1.prototype._dialogVariantSave=function(i){this._bVariantSaveFiltersDialogTriggered=true;this._variantSavePressed();};b1.prototype._dialogRestore=function(i){this.reset();if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(false);}};b1.prototype._dialogClear=function(i){this.clear();};b1.prototype._createButtons=function(i){var j=this;this._oHideShowButton=new a(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),tooltip:this._oRb.getText("FILTER_BAR_HIDE"),type:E.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){j._toggleHideShow();});i.addContent(this._oHideShowButton);this._oClearButtonOnFB=new a(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),tooltip:this._oRb.getText("FILTER_BAR_CLEAR"),type:E.Transparent,enabled:false});this._oClearButtonOnFB.attachPress(function(){j.clear();});i.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new a(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),tooltip:this._oRb.getText("FILTER_BAR_RESTORE"),type:E.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}});i.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new a(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration()||this._isPhone(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),tooltip:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:E.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){j._oFiltersButton.focus();j._showFilterDialog();});i.addContent(this._oFiltersButton);this._oSearchButton=new a(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),tooltip:this._oRb.getText("FILTER_BAR_GO"),type:E.Emphasized});this._oSearchButton.attachPress(function(){j._oSearchButton.focus();j.search();});i.addContent(this._oSearchButton);};b1.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}this._registerVariantManagement();return this._oVariantManagement;};b1.prototype._createToolbar=function(i){var j=new e(this.getId()+"-toolbar");if(!i){var n=this._createVariantLayout();j.addContent(n);}j.addContent(new f());this._createButtons(j);j.addStyleClass("sapUiCompFilterBarToolbar");return j;};b1.prototype._replaceVariantManagement=function(i){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement);}this._oVariantManagement.destroy();}this._oVariantManagement=i;this._registerVariantManagement();this._adaptNewFilterBarDesign();};b1.prototype._createBasicAreaLayout=function(){return new A();};b1.prototype._createAdvancedAreaForm=function(){if((!W||!X||!Y||!Z)&&!this._bAdvancedRequested){W=sap.ui.require("sap/ui/layout/form/Form");X=sap.ui.require("sap/ui/layout/form/FormContainer");Y=sap.ui.require("sap/ui/layout/form/FormElement");Z=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");if(!W||!X||!Y||!Z){sap.ui.require(["sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout"],f1.bind(this));this._bAdvancedRequested=true;}}if(!W||!X||!Y||!Z){return;}var i=new Z(this.getId()+"-AdvancedFormLayout");i.addStyleClass("sapUiCompFilterBarPaddingForm");i.setColumnsL(3);i.setColumnsM(2);var j=new W(this.getId()+"-AdvancedForm",{editable:true});j.setLayout(i);if(!this.oInvisibleFormTitle){this.oInvisibleFormTitle=new I({text:this._oRb.getText("ADVANCED_SEARCH_TEXT")});this.addContent(this.oInvisibleFormTitle);}j.addAriaLabelledBy(this.oInvisibleFormTitle);this._oAdvancedPanel.addContent(j);return j;};function f1(i,j,n,h1){W=i;X=j;Y=n;Z=h1;this._bAdvancedRequested=false;if(!this._bIsBeingDestroyed){this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._rerenderAA();}}b1.prototype._addControlToBasicAreaFormContainer=function(i){var j=i.getControl();if(!j){w.error("no Control obtained");return null;}var n=i.getLabelControl(this.getId());if(!n){w.error("no Label obtained");return null;}this._adaptGroupTitleForFilter(i);return this._addControlToBasicAreaContainer(i,j,n);};b1.prototype._addControlToBasicAreaContainer=function(i,j,n){var h1=new t();if(j.setWidth){j.setWidth("100%");}h1.setWidth("100%");if(n){if(!n.hasStyleClass("sapUiCompFilterLabel")){n.addStyleClass("sapUiCompFilterLabel");}h1.addContent(n);if(n.setLabelFor){if(i&&j){n.setLabelFor(j);if(j.setTooltip&&i.getControlTooltip()){j.setTooltip(i.getControlTooltip());}}}}h1.addContent(j);if(!this.getAdvancedMode()&&(!this._oFilterDialog||(!this._oFilterDialog.hasOwnProperty("bDoNotAddToBasicArea")))){if(i&&i.getVisible()&&i.getVisibleInFilterBar()){if(this._isNewFilterBarDesign()){var i1=this._oBasicAreaLayout.getContent();if(this._isPhone()){this._oBasicAreaLayout.addContent(h1);}else{this._oBasicAreaLayout.insertContent(h1,i1.length);}}else{this._oBasicAreaLayout.addContent(h1);}}}return h1;};b1.prototype._rerenderAA=function(){if(this._oAdvancedAreaForm){this._oAdvancedAreaForm.removeAllFormContainers();var i=this._flattenMap();this._layOutAA(i);}};b1.prototype._layOutAA=function(i){if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){this._layOutAAMultipleGroup(i);}else{this._layOutAASingleGroup(i);}};b1.prototype._layOutAAMultipleGroup=function(n){var i,j,h1=0,i1=null,j1=false;for(i=0;i<n.length;i++){if(n[i].control===null){h1++;}}if(this._mAdvancedAreaFilter&&(Object.keys(this._mAdvancedAreaFilter).length===2)&&this._mAdvancedAreaFilter[b1.INTERNAL_GROUP]&&this._mAdvancedAreaFilter[b1.INTERNAL_GROUP].items&&(this._mAdvancedAreaFilter[b1.INTERNAL_GROUP].items.length>0)){j1=true;}var k1=this._oAdvancedAreaForm.getLayout();if(k1){if(h1>=3){k1.setLabelSpanL(5);k1.setLabelSpanM(5);k1.setColumnsL(3);k1.setColumnsM(2);}else if(h1===2){k1.setLabelSpanL(4);k1.setLabelSpanM(5);k1.setColumnsL(2);k1.setColumnsM(2);}else if(h1===1){k1.setLabelSpanL(4);k1.setLabelSpanM(5);k1.setColumnsL(2);k1.setColumnsM(2);}}for(i=0;i<n.length;i++){if(n[i].control===null){i1=new X();if((Object.keys(this._mAdvancedAreaFilter).length>1)&&!j1){if((h1>=3)&&(n[i].filterItem.getGroupName()===b1.INTERNAL_GROUP)){i1.setTitle(this._oRb.getText("FILTER_BAR_BASIC_GROUP"));}else{i1.setTitle(n[i].filterItem.getGroupTitle());}}this._oAdvancedAreaForm.addFormContainer(i1);j=i+1;while(j<n.length&&(n[j].control)){this._addControlToAdvancedArea(n[j].filterItem,n[j].control,i1);j++;}i=j-1;}}if(h1===1){this._oAdvancedAreaForm.addFormContainer(new X());}};b1.prototype._layOutAASingleGroup=function(j){var i,n,h1,i1;var j1=j.length-1;var k1=j1>2?2:1;if(k1>1){h1=Math.floor(j1/k1);i1=((h1*k1)<j1);for(i=1;i<k1;i++){n=i*h1;if(i1){++n;}if((n+i)<j.length){j.splice(n+i,0,j[0]);}}}this._layOutAAMultipleGroup(j);};b1.prototype._flattenMap=function(){var n=null,i,j=[],h1;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){h1=false;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var i1=this._mAdvancedAreaFilter[n].items[i];if(i1.filterItem&&i1.filterItem.getVisibleInFilterBar()&&i1.filterItem.getVisible()&&!i1.filterItem.getHiddenFilter()){if(!h1){h1=true;j.push({control:null,filterItem:this._mAdvancedAreaFilter[n].filterItem});}j.push({control:i1.control,filterItem:i1.filterItem});}}}}}return j;};b1.prototype._triggerSearchByValue=function(j){var i,n,h1,i1;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._aListItems){for(i=this._aListItems.length-1;i>=0;i--){i1=this._aListItems[i].getContent();if(i1&&(i1.length>0)){n=i1[0].getText();h1=this._aListItems[i].data("quickinfo");if((n.toLowerCase().indexOf(j)>=0||(h1&&h1.toLowerCase().indexOf(j)>=0))){this._aListItems[i].setVisible(true);}else{this._aListItems[i].setVisible(false);}}}}};b1.prototype._triggerSearch=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._triggerSearchByValue(n);};b1.prototype._triggerSearchByValueInFilterDialog=function(j){var n=null,i,h1,i1,j1,k1,l1,m1;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){j1=this._mAdvancedAreaFilter[n];if(j1&&j1.items){l1=0;m1=0;for(i=0;i<j1.items.length;i++){if(j1.items[i]&&j1.items[i].filterItem){k1=j1.items[i].filterItem;if(k1.getHiddenFilter()){++l1;continue;}if(k1.getVisible()){if(j&&j1.items[i].formelement){h1=k1.getLabel();i1=k1.getControlTooltip();if((h1.toLowerCase().indexOf(j)>=0)||(i1&&(i1.toLowerCase().indexOf(j)>=0))){if(k1.getPartOfCurrentVariant()){j1.items[i].formelement.setVisible(true);}else{++m1;}}else{++l1;j1.items[i].formelement.setVisible(false);}}else if(j1.items[i].formelement){j1.items[i].formelement.setVisible(k1.getVisibleInFilterBar()||k1.getPartOfCurrentVariant());if(j1.link&&!j1.link.getVisible()){j1.link.setVisible(true);}}}else{++l1;}}}if(j1&&j1.formcontainer){if(l1===j1.items.length){j1.formcontainer.setVisible(false);}else{j1.formcontainer.setVisible(true);if(j1.link){j1.link.setVisible((j&&(m1===0))?false:true);if(j&&(m1>0)){this._setLinkTextAndCount(n,j1.link,m1);}else{this._setLinkText(n,j1.link);}}}}}}}}};b1.prototype._triggerSearchInFilterDialog=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._sSearchCriteriaInFiltersDialog=n;this._triggerSearchByValueInFilterDialog(n);};b1.prototype._generateListItems=function(j,n){if(!Q){Q=sap.ui.require("sap/m/CustomListItem");if(!Q){throw new Error("_generateListItems must only be called via _createAddRemoveFiltersDialog "+this);}}var i;var h1,i1;var j1;var k1=false;if(this.$().closest(".sapUiSizeCompact").length>0){k1=true;}if(j&&this._mAdvancedAreaFilter){i1=this._mAdvancedAreaFilter[j];if(i1&&i1.items){for(i=0;i<i1.items.length;i++){var l1=i1.items[i];if(l1&&l1.filterItem){if(!l1.filterItem.getVisible()||l1.filterItem.getHiddenFilter()){continue;}h1=new Q();h1.setVisible(true);if(!k1){h1.addStyleClass("sapUiCompFilterBarListItem");}else{h1.addStyleClass("sapUiCompFilterBarListItemCompact");}h1.data("quickinfo",l1.filterItem.getControlTooltip()||l1.filterItem.getLabelTooltip());l1.initialPartOfCurrentVariant=l1.filterItem.getPartOfCurrentVariant();l1.initialVisibleInFilterBar=l1.filterItem.getVisibleInFilterBar();h1.data('item',l1);j1=new L({text:l1.filterItem.getLabel(),tooltip:l1.filterItem.getControlTooltip()||l1.filterItem.getLabelTooltip()});h1.addContent(j1);n.addItem(h1);if(l1.filterItem.getPartOfCurrentVariant()){n.setSelectedItem(h1);}if(l1.filterItem.getMandatory()&&l1.checkbox&&!l1.checkbox.getEnabled()){h1.getModeControl().setEnabled(false);}}}}}var m1=this;n.attachSelectionChange(function(n1){if(n1){var o1=n1.getParameters();if(o1){var h1=o1.listItem;if(h1){var p1=h1.getModeControl();var l1=h1.data('item');m1._selectionChangedInAddFiltersDialog(p1,l1);}}}});};b1.prototype._rerenderItem=function(i){var j;if(i){j=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar();if(i.container){i.container.setVisible(j);if(!j){this._removeContainer(i);}if(j){this._addContainer(i);}}if(i.formelement){i.formelement.setVisible(i.filterItem.getVisible()&&(i.filterItem.getVisibleInFilterBar()||i.filterItem.getPartOfCurrentVariant()));if(i.checkbox){i.checkbox.setSelected(i.filterItem.getVisibleInFilterBar());}}}};b1.prototype._rerenderFilters=function(){var i;var n=null;var j=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];this._rerenderItem(j);}}}}this._updateToolbarText();};b1.prototype.rerenderFilters=function(){this._rerenderFilters();};b1.prototype._closeAddRemoveFiltersDialog=function(i,j){if(i&&j){if(this._sSearchCriteriaInFiltersDialog&&this._oFilterDialog){this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}else{this._setLinkText(i,j);}}};b1.prototype._cancelAddRemoveFiltersDialog=function(j){var i;var n;if(j&&this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if((n.initialPartOfCurrentVariant!==undefined||n.initialVisibleInFilterBar!==undefined)&&n.filterItem){if(n.filterItem.getHiddenFilter()){continue;}if((n.initialPartOfCurrentVariant!==undefined)&&(n.filterItem.getPartOfCurrentVariant()!==n.initialPartOfCurrentVariant)){n.filterItem.setPartOfCurrentVariant(n.initialPartOfCurrentVariant);this._notifyAboutChangedFilters(n.initialPartOfCurrentVariant,n.control);}if((n.initialVisibleInFilterBar!==undefined)&&(n.filterItem.getVisibleInFilterBar()!==n.initialVisibleInFilterBar)){n.filterItem.setVisibleInFilterBar(n.initialVisibleInFilterBar);}}}}if(this._oVariantManagement&&(this._oVariant.modified2!==undefined)){this._oVariantManagement.currentVariantSetModified(this._oVariant.modified2);}};b1.prototype._createAddRemoveFiltersDialog=function(j,n){var i,h1=this;if(!j){return;}if((!N||!Q)&&!this._bCustomListItemRequested){Q=sap.ui.require("sap/m/CustomListItem");N=sap.ui.require("sap/m/Dialog");if(!N||!Q){sap.ui.require(["sap/m/Dialog","sap/m/CustomListItem"],g1.bind(this));this._bCustomListItemRequested=true;this._oFiltersDialogData={groupName:j,link:n};}}if(!N||!Q){return;}this._oDialog=new N(this.getId()+"-set-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true});this._oDialog.addStyleClass("sapUiPopupWithPadding");this._oDialog.addStyleClass("sapUiCompAddRemoveFilterDialog");if(this.$().closest(".sapUiSizeCompact").length>0){this._oDialog.addStyleClass("sapUiSizeCompact");}this._oDialog.setTitle(this._oRb.getText("SELECT_FILTER_FIELDS"));this._oDialog.addStyleClass("sapMH4FontSize");this._oDialog.addStyleClass("sapMH4Style");this._oDialog.setVerticalScrolling(true);var i1=new B();var j1=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=j1;j1.attachLiveChange(function(n1){h1._triggerSearch(n1);});i1.addContentRight(j1);this._oDialog.setSubHeader(i1);var k1=new d({mode:a1.MultiSelect});k1.setShowSeparators(z.None);this._oDialog.addContent(k1);this._generateListItems(j,k1);this._aListItems=k1.getItems();for(i=0;i<this._aListItems.length;i++){k1.addItem(this._aListItems[i]);}if(this._oVariant&&this._oVariantManagement){this._oVariant.modified2=this._oVariantManagement.currentVariantGetModified();}this._bOKButtonAddRemoveFilterDialogTriggered=false;var l1=new a(this.getId()+"-btnOKAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_OK"),type:sap.m.ButtonType.Emphasized});l1.attachPress(function(){h1._bOKButtonAddRemoveFilterDialogTriggered=true;h1._oDialog.close();});this._oDialog.addAggregation("buttons",l1);this._oDialog.setInitialFocus(this._oSearchField);if(this._sSearchCriteriaInFiltersDialog){this._oSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValue(this._sSearchCriteriaInFiltersDialog);}var m1=new a(this.getId()+"-btnCancelAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){h1._oDialog.close();}});this._oDialog.addAggregation("buttons",m1);this._oDialog.attachBeforeClose(function(){if(!h1._bOKButtonAddRemoveFilterDialogTriggered){h1._cancelAddRemoveFiltersDialog(j);}h1.rerenderFilters();h1._closeAddRemoveFiltersDialog(j,n);if(h1._oFilterDialog){h1._oFilterDialog.invalidate();}});this._oDialog.attachAfterClose(function(){this._aListItems=null;h1._oDialog.destroy();h1._oDialog=null;});this._oDialog.open();};function g1(i,j){N=i;Q=j;this._bCustomListItemRequested=false;if(!this._bIsBeingDestroyed){this._createAddRemoveFiltersDialog(this._oFiltersDialogData.groupName,this._oFiltersDialogData.link);delete this._oFiltersDialogData;}}b1.prototype._selectionChangedInAddFiltersDialog=function(i,j){var n=i.getSelected();if(!n&&j.filterItem.getMandatory()&&!j.checkbox.getEnabled()){i.setSelected(true);return;}j.filterItem.setPartOfCurrentVariant(n);j.filterItem.setVisibleInFilterBar(n);this._notifyAboutChangedFilters(n,j.control);};b1.prototype._setTriggerFilterChangeState=function(i){this._triggerFilterChangeState=i;};b1.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState;};b1.prototype._setConsiderFilterChanges=function(i){this._filterChangeSemaphore=i;};b1.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore;};b1.prototype.fireFilterChange=function(i){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return;}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true);}if(this._oFilterDialog&&!(this._oFilterDialog.isOpen())){return;}this._bDirtyViaDialog=true;this.fireEvent("filterChange",i);};b1.prototype._notifyAboutChangedFilters=function(i,j){var n,h1=this._determineByControl(j);if(i){n={"added":j,"filterItem":h1};}else{n={"deleted":j,"filterItem":h1};}this.fireFilterChange(n);};b1.prototype._determineVariantFiltersInfo=function(j,h1){var i;var n=null,i1,j1;var k1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){i1=this._mAdvancedAreaFilter[n].items[i];if(j||i1.filterItem.getVisible()){j1={group:i1.filterItem.getGroupName(),name:i1.filterItem.getName(),partOfCurrentVariant:i1.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:i1.filterItem.getVisibleInFilterBar(),visible:i1.filterItem.getVisible()};if(h1||this._considerFilter(j1)){k1.push(j1);}}}}}}}return k1;};b1.prototype.mergeVariant=function(i,j){var n={};q.extend(true,n,j);n.filterbar=[];n.filterBarVariant={};q.extend(true,n.filterbar,i.filterbar);q.extend(true,n.filterBarVariant,i.filterBarVariant);if(j&&(j.hasOwnProperty("version"))){n.filterbar=this._mergeVariantFields(n.filterbar,j.filterbar);n.filterBarVariant=j.filterBarVariant;}return n;};b1.prototype._mergeVariantFields=function(j,n){var i;n.forEach(function(h1){for(i=0;i<j.length;i++){if((j[i].group===h1.group)&&(j[i].name===h1.name)){j.splice(i,1);break;}}});return j.concat(n);};b1.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof k){return true;}return false;};b1.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false;}return this.getDeltaVariantMode();};b1.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this);};b1.prototype._considerFilter=function(j){if(!this._isDeltaHandling()){return true;}var n=null;var h1=this._getStandardVariant();if(h1&&h1.filterbar){for(var i=0;i<h1.filterbar.length;i++){if((h1.filterbar[i].group===j.group)&&(h1.filterbar[i].name===j.name)){n=h1.filterbar[i];break;}}}if(!n){if(!j.partOfCurrentVariant){return false;}return true;}if((n.partOfCurrentVariant!==j.partOfCurrentVariant)||(n.visibleInFilterBar!==j.visibleInFilterBar)||(n.visible!==j.visible)){return true;}return false;};b1.prototype._addControlToAdvancedArea=function(i,j,n){var h1=new Y({label:i.getLabelControl(this.getId()),fields:[(j!==null)?j:new T()]});n.addFormElement(h1);};b1.prototype._determineVisibility=function(i){var j=false;if(i){j=i.getVisible()&&(i.getVisibleInFilterBar()||i.getPartOfCurrentVariant());j=j&&!i.getHiddenFilter();}return j;};b1.prototype._retrieveVisibleAdvancedItems=function(){var i,n=null,j;var h1=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j){if(this._determineVisibility(j.filterItem)){h1.push(j);}}}}}}}return h1;};b1.prototype._retrieveCurrentSelectionSet=function(j,n){var i,h1,i1,j1=[];var k1=this._retrieveVisibleAdvancedItems();for(i=0;i<k1.length;i++){h1=k1[i];if(h1.control&&h1.filterItem&&(n||!h1.filterItem._isParameter())){if(j){i1={name:k1[i].filterItem.getName(),control:k1[i].control};}else{i1=k1[i].control;}j1.push(i1);}}return j1;};b1.prototype.search=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireSearch(i);return true;};b1.prototype.clear=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this._clearErrorState();this.fireClear(i);this._updateToolbarText();};b1.prototype.reset=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(i);this._resetVariant();};b1.prototype._resetVariant=function(){var i=null,j=null;this._resetFiltersInErrorValueState();if(this._oVariantManagement){var n=this._oVariantManagement.getSelectionKey();if(n){i=this._oVariantManagement.getVariantContent(this,n);if(this._oVariant){this._oVariant.content=i;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=i;this._oInitialVariant.modified=false;this._oInitialVariant.key=n;}}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===undefined)&&this._oInitialVariant&&this._oInitialVariant.content){j=this._oInitialVariant.content;}if(i||j){this.applyVariant(i||j,"RESET");}}}this._resetFilterBarSearch();};b1.prototype._resetFilterBarSearch=function(){this._sSearchCriteriaInFiltersDialog="";if(this._oFiltersSearchField){this._oFiltersSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}};b1.prototype._applyVariant=function(i,j,n,h1){var i1,j1=null,k1,l1=false;if(i){if(n){k1=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false);}this._setConsiderFilterChanges(false);i1=i.filterBarVariant;j1=i.filterbar;this._ensureFilterLoaded(j1);this._applyVariantFields(i1,h1);this._reapplyVisibility(j1);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i.basicSearch);}if(i.executeOnSelection){l1=i.executeOnSelection;}this.fireAfterVariantLoad(j,l1);this._setConsiderFilterChanges(true);this._updateToolbarText();if(l1||(this.getLiveMode&&this.getLiveMode())){this.search();}else{this._clearErrorState();}if(n){this._setTriggerFilterChangeState(k1);}}};b1.prototype._fetchVariantFiltersData=function(i){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData(i);}catch(j){w.error("callback for fetching data throws an exception");}}else{w.warning("no callback for fetch data supplied");}return null;};b1.prototype._applyVariantFields=function(j,i){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(j,i);}catch(n){w.error("callback for applying data throws an exception");}}else{w.warning("no callback for appy data supplied");}};b1.prototype._isStandardVariant=function(){var i=this.getCurrentVariantId();if(!i){return true;}if(this._oVariantManagement){if((i===this._oVariantManagement.getStandardVariantKey())){return true;}if(this._oVariantManagement._oStandardVariant===null){return true;}}return false;};b1.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){var i=this.getCurrentVariantId();if(!i){return this._oVariantManagement.getExecuteOnSelectForStandardVariant();}var j=this._oVariantManagement.getItemByKey(i);if(j){return j.getExecuteOnSelection();}}return false;};b1.prototype.fetchVariant=function(){var i,j={},n;if(this._isDeltaHandling()){if(!this._isStandardVariant()){j.version="V3";}}this.fireBeforeVariantFetch();i=this._determineVariantFiltersInfo(true,!j.version);j.filterbar=(!i)?[]:i;j.filterBarVariant=this._fetchVariantFiltersData(j.version);n=this._getBasicSearchValue();if(n){j.basicSearch=n;}if(this._oVariant&&this._oVariant.content){this._oVariant.content=j;}return j;};b1.prototype.applyVariant=function(i,j,n){if(i.hasOwnProperty("version")){i=this.mergeVariant(this._getStandardVariant(),i,j);}this._applyVariant(i,j,n,i.version);};b1.prototype._afterVariantsLoad=function(){if(this._bDelayRendering){this._oBasicAreaLayout.setVisible(this.getFilterBarExpanded());}this._bDelayRendering=false;};b1.prototype.determineMandatoryFilterItems=function(){var i;var j=[];var n=this._retrieveVisibleAdvancedItems();for(i=0;i<n.length;i++){if(n[i].filterItem.getMandatory()===true){if(n[i].control){j.push(n[i].filterItem);}}}return j;};b1.prototype.determineControlByFilterItem=function(j,h1){var i,n=null;var i1,j1;if(!j||(!h1&&j._isParameter())){return null;}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){i1=this._aBasicAreaSelection[i];if(j===i1.filterItem){return i1.control;}}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){j1=this._mAdvancedAreaFilter[n];if(j1&&j1.items){for(i=0;i<j1.items.length;i++){i1=j1.items[i];if((h1||!i1.filterItem._isParameter())&&(j===i1.filterItem)){return i1.control;}}}}}}return null;};b1.prototype.determineControlByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem&&!j.filterItem._isParameter()){return j.control;}return null;};b1.prototype.determineLabelByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem){return j.filterItem._oLabel;}return null;};b1.prototype._determineEnsuredItemByName=function(n,i){if(!i){i=this._determineGroupNameByName(n);}this._ensureFilterLoaded([{name:n,group:i}]);return this._determineItemByName(n,i);};b1.prototype._determineGroupNameByName=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i].groupName;}}}var j=this._determineFilterItemByName(n);if(j){var h1=j.getGroupName();if(h1!==b1.INTERNAL_GROUP){return h1;}}return null;};b1.prototype._determineItemByName=function(n,j){var i;var h1,i1;var j1=j;if(!n){return null;}if(!j1){j1=b1.INTERNAL_GROUP;}if(this._mAdvancedAreaFilter){i1=this._mAdvancedAreaFilter[j1];if(i1&&i1.items){for(i=0;i<i1.items.length;i++){h1=i1.items[i];if(h1&&h1.filterItem&&(h1.filterItem.getName()===n)){return h1;}}}}return null;};b1.prototype.determineFilterItemByName=function(n){var i=this._determineEnsuredItemByName(n);if(i&&i.filterItem){return i.filterItem;}return null;};b1.prototype._determineFilterItemByName=function(i){var n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){j=this._determineItemByName(i,n);if(j){return j.filterItem;}}}return null;};b1.prototype._determineByControl=function(j){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var h1=this._mAdvancedAreaFilter[n];if(h1&&h1.items){for(i=0;i<h1.items.length;i++){if(h1.items[i]&&h1.items[i].control===j){return h1.items[i];}}}}}}return null;};b1.prototype._deleteProperties=function(){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var j=this._mAdvancedAreaFilter[n];if(j&&j.items){if(j.formcontainer){j.formcontainer.destroy();delete j.formcontainer;}if(j.link){delete j.link;}for(i=0;i<j.items.length;i++){if(j.items[i]&&j.items[i].checkbox){delete j.items[i].checkbox;}if(j.items[i]&&j.items[i].formelement){delete j.items[i].formelement;}}}}}}};b1.prototype.onAfterRendering=function(i){if(!(this._isPhone()||this._isTablet())){if(this._oHintText&&this._oHintText.getVisible()){this.setFilterBarExpanded(false);}}};b1.prototype._destroyLazyFilterControl=function(){var j,i;if(this._aFields&&(this._aFields.length>0)){if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){i=this._aFields[j];if(i.factory){if(i.control){i.control.destroy();}}}}}};b1.prototype._destroyNonVisibleFilterControl=function(){var i,n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.container){if(this._oBasicAreaLayout&&(this._oBasicAreaLayout.indexOfContent(j.container)<0)){if(j.control&&!j.bDestroyed){j.control.destroy();j.bDestroyed=true;}}}}}}}};b1.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl();}};b1.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this);}};b1.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null;}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy();}}};b1.prototype.destroy=function(){this._unregisterVariantManagement();this._destroyFilterControls();if(this._oHintText&&(this._oAdvancedPanel.indexOfContent(this._oHintText)<0)){this._oHintText.destroy();}G.prototype.destroy.apply(this,arguments);if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}if(this._oFilterDialog){this._oFilterDialog.destroy();this._oFilterDialog=null;}if(this.oModel){this.oModel.destroy();this.oModel=null;}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;this._oButtonsVLayout=null;};return b1;},true);
