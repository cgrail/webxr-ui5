/*!
 * SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/fl/Utils","sap/ui/fl/changeHandler/Base","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/comp/smartform/flexibility/changes/AddFields"],function(U,B,J,A){"use strict";var a={};a.applyChange=function(c,g,p){var C=c.getDefinition();var f=function(C){var M=C.texts&&C.texts.fieldLabel&&C.texts.fieldLabel.value;var h=C.content;var k=false;if(h){k=C.content.field&&(C.content.field.selector||C.content.field.id)&&C.content.field.jsType&&C.content.field.value&&C.content.field.valueProperty;}return M&&h&&k;};var m=p.modifier;var o=p.appComponent;var v=p.view;if(f(C)){var b=C.content;var F=b.field.selector;var s=b.field.id;var l=C.texts.fieldLabel.value;var j=b.field.jsType;var P=b.field.valueProperty;var d=b.field.value;var e=b.field.entitySet;var i=b.field.index;var G;if(m.bySelector(F||s,o,v)){return B.markAsNotApplicable("Control to be created already exists:"+F||s);}G=m.createControl("sap.ui.comp.smartform.GroupElement",o,v,F||s);if(!F){F=m.getSelector(s,o);}c.setRevertData({newFieldSelector:F});m.setProperty(G,"label",undefined);m.setProperty(G,"label",l);m.insertAggregation(g,"groupElements",G,i,v);A.addElementIntoGroupElement(m,v,G,j,P,d,e,i,o);return true;}else{U.log.error("Change does not contain sufficient information to be applied: ["+C.layer+"]"+C.namespace+"/"+C.fileName+"."+C.fileType);}};a.completeChangeContent=function(c,s,p){var o=p.appComponent;var C=c.getDefinition();if(s.fieldLabel){B.setTextInChange(C,"fieldLabel",s.fieldLabel,"XFLD");}else{throw new Error("oSpecificChangeInfo.fieldLabel attribute required");}if(!C.content){C.content={};}if(!C.content.field){C.content.field={};}if(s.fieldValue){C.content.field.value=s.fieldValue;}else{throw new Error("oSpecificChangeInfo.fieldValue attribute required");}if(s.valueProperty){C.content.field.valueProperty=s.valueProperty;}else{throw new Error("oSpecificChangeInfo.valueProperty attribute required");}if(s.newControlId){C.content.field.selector=J.getSelector(s.newControlId,o,{index:s.index});}else{throw new Error("oSpecificChangeInfo.newControlId attribute required");}if(s.jsType){C.content.field.jsType=s.jsType;}else{throw new Error("oSpecificChangeInfo.jsType attribute required");}if(s.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required");}else{C.content.field.index=s.index;}if(s.entitySet){C.content.field.entitySet=s.entitySet;}};a.revertChange=function(c,g,p){return A.revertChange(c,g,p);};return a;},true);
