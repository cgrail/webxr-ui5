/*
 * ! SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery",'sap/ui/comp/config/condition/Type','sap/ui/Device','sap/ui/core/library','sap/m/library','sap/m/Input','sap/m/DatePicker','sap/m/Text','sap/m/Select','sap/ui/core/ListItem','sap/m/Label','sap/ui/core/date/UniversalDate','sap/ui/core/format/DateFormat','sap/ui/core/Locale','sap/ui/core/LocaleData','sap/ui/model/type/Integer','sap/ui/model/Sorter','sap/ui/model/Filter',"sap/base/Log","sap/ui/dom/jquery/cursorPos"],function(q,T,D,c,l,I,a,b,S,L,d,U,e,f,g,h,m,j,k){"use strict";var V=c.ValueState;var P=l.PlacementType;var R;var o;var B;var N=h.extend("sap.ui.model.type.NullableInteger",{parseValue:function(v,i){switch(this.getPrimitiveType(i)){case"string":if(v===""){return null;}}return h.prototype.parseValue.apply(this,arguments);}});var p=T.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(F,i,n){T.apply(this,[F,i,n]);this.oDateFormat=i&&i._oDateFormatSettings?i._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;if(n&&n.precision){this._Precision=(typeof n.precision==="string"?parseInt(n.precision):n.precision)||0;}this._maxIntValue=10000;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;}});p.prototype.applySettings=function(s){T.prototype.applySettings.apply(this,arguments);if(s&&s.ignoreTime){this._bIgnoreTime=s.ignoreTime;}};p.setStartTime=function(i){i=p.toUniversalDate(i);i.setHours(0);i.setMinutes(0);i.setSeconds(0);i.setMilliseconds(0);return i;};p.setEndTime=function(r,s,t){r=p.toUniversalDate(r);if(!s){if(t===undefined){t=3;}r.setHours(23);r.setMinutes(59);r.setSeconds(59);var u=0;var n=Math.min(Math.max(t,0),3);for(var i=1;i<=n;i++){u+=9*(Math.pow(10,3-i));}r.setMilliseconds(u);return r;}else{return p.setStartTime(r);}};p.toUniversalDate=function(i){if(i instanceof Date){i=new U(i);}if(!i){i=new U();}return i;};p.getWeekStartDate=function(u){var i=new f(sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale().toString()),n=g.getInstance(i),F=n.getFirstDayOfWeek();if(!u){u=new U();}u.setDate(u.getDate()-u.getDay()+F);return p.setStartTime(u);};p.getMonthStartDate=function(u){if(!u){u=new U();}u.setDate(1);return p.setStartTime(u);};p.getQuarterStartDate=function(u){if(!u){u=new U();}u.setMonth(3*Math.floor(u.getMonth()/3));u.setDate(1);return p.setStartTime(u);};p.getYearStartDate=function(u){if(!u){u=new U();}u.setMonth(0);u.setDate(1);return p.setStartTime(u);};p.getDateRange=function(v,t,u,C,i){if(u===true){C=true;u=null;}if(!u){u=new U();}else if(!(u instanceof U)){throw new Error("Date must be a UniversalDate object "+this);}var s=new U(),E;if(u){s.getJSDate().setTime(u.getTime());s=p.setStartTime(s);}if(v!==0&&!isNaN(v)){if(t==="DAY"){if(i&&v>0){s.setDate(s.getDate()+1);}E=new U(s);E.setDate(s.getDate()+v);}else if(t==="WEEK"){if(C){s=p.getWeekStartDate(s);}if(i&&v>0){s.setDate(s.getDate()+7);}E=new U(s);E.setDate(s.getDate()+(v*7));}else if(t==="MONTH"){if(C){s=p.getMonthStartDate(s);}if(i&&v>0){s.setMonth(s.getMonth()+1);}E=new U(s);E.setMonth(s.getMonth()+v);}else if(t==="QUARTER"){if(C){s=p.getQuarterStartDate(s);}if(i&&v>0){s.setMonth(s.getMonth()+3);}E=new U(s);E.setMonth(s.getMonth()+(v*3));}else if(t==="YEAR"){if(C){s=p.getYearStartDate(s);}if(i&&v>0){s.setFullYear(s.getFullYear()+1);}E=new U(s);E.setFullYear(s.getFullYear()+v);}}if(!E){return[];}if(E.getTime()<s.getTime()){E=[s,s=E][0];}E.setDate(E.getDate()-1);return[p.setStartTime(s),p.setEndTime(E)];};p.getTextField=function(n,E){var s=T._createStableId(n,"text");if(n._oOperationSelect){var r=n._oOperationSelect.getAriaLabelledBy();var F=false;for(var i=0;i<r.length;i++){if(s===r[i]){F=true;break;}}if(!F){n._oOperationSelect.addAriaLabelledBy(s);}}if(E){return new b(s,{text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:n.oDateFormat.style,pattern:n.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:n.oDateFormat.style,pattern:n.oDateFormat.pattern})+"}"});}else{return new b(s,{text:{path:'$smartEntityFilter>value1',type:'sap.ui.model.type.Date',formatOptions:{style:n.oDateFormat.style,pattern:n.oDateFormat.pattern}}});}};p.getIntField=function(i){return new I(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:new N({},{minimum:0,maximum:i._maxIntValue})},textAlign:"End",width:"100%"});};p.ControlFactory=function(i,r,O){if(O.type==="range"){var C=p.getTextField(i,O.display!=="start");C.addStyleClass("sapUiCompFilterBarCTPaddingTop");r.push(C);return;}if(O.type==="int"){var C=p.getIntField(i);r.push(C);if(O.descriptionTextKeys){C.setFieldWidth("auto");C.bindProperty("description",{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){var t=O.descriptionTextKeys[0];var s=O.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return T.getTranslatedText(t);}else{return T.getTranslatedText(s||t);}}});}}};p._defaultOnChangeHandler=function(v,i){if(v.toLowerCase()===this.languageText.toLowerCase()){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("inputstate","NONE",i.getContext());if(this.category.indexOf("FIXED")!==0){i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}return false;};p._IntOnChangeHandler=function(v,i){if(this.basicLanguageText.indexOf("{0}")>=0){var r=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$",'i');if(v.match(r)){var v=v.match(r)[1];if(v){var n=parseInt(v);if(!isNaN(n)&&n<=i._maxIntValue){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",n);i.oModel.setProperty("inputstate","NONE",i.getContext());}else{i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}}}return false;};p._DateOnChangeHandler=function(v,i){if(v.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var s=v.slice(this.languageText.length);if(s.length>0&&s[0]===" "){s=s.trim();if(s[0]==="("&&s[s.length-1]===")"){s=s.slice(1,s.length-1);}var n=i._getDateFormatter(true);var r=n.parse(s);if(r){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",r);i.oModel.setProperty("inputstate","NONE",i.getContext());}else{i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}}return false;};p._DateRangeOnChangeHandler=function(v,i){if(v.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var s=v.slice(this.languageText.length).trim();if(s[0]==="("&&s[s.length-1]===")"){s=s.slice(1,s.length-1);}var n=s.split("-")[0];var r=s.split("-")[1];var t=i._getDateFormatter(true);var u=t.parse(n);var w=t.parse(r);if(u&&w){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",u);i.oModel.setProperty("/condition/value2",w);i.oModel.setProperty("inputstate","NONE",i.getContext());}else{i.oModel.setProperty("inputstate","ERROR",i.getContext());}return true;}return false;};p._MonthOnChangeHandler=function(v,i){var M;var r=false;if(v.toLowerCase().indexOf(this.languageText.toLowerCase())===0){M=v.slice(this.languageText.length).trim();if(M.indexOf("(")==0){M=M.slice(1);M=M.slice(0,M.length-1);}r=true;}else{M=v;}var n=this.getValueList();var s=-1;n.some(function(t,u){var r=t.text.toLowerCase()===M.toLowerCase();if(r){s=u;}return r;});if(s>-1){i.oModel.setProperty("/condition/operation",this.key);i.oModel.setProperty("/condition/value1",s);i.oModel.setProperty("inputstate","NONE",i.getContext());return true;}else{if(r){i.oModel.setProperty("inputstate","ERROR",i.getContext());}return r;}};p._DefaultFilterSuggestItem=function(v,n,r){var M=false;if(this.languageText.toLowerCase().startsWith(v.toLowerCase())){M=true;}else{var w=this.languageText.split(" ");for(var i=0;i<w.length;i++){var W=w[i];if(W.toLowerCase().startsWith(v.toLowerCase())){M=true;}}}n.setAdditionalText(this.textValue);n.setText(this.languageText);return M;};p._HideFilterSuggestItem=function(v,i,n){return false;};p._IntFilterSuggestItem=function(v,i,n){var x=this.basicLanguageText.indexOf("{0}");var s;var r;if(x>=0){s=this.basicLanguageText.slice(0,x).trim();r=this.basicLanguageText.slice(x+3).trim();}var t=v.split(" ");if(t.length<1||t.length>3){return false;}var M=false;var u;var w=function(v){return!!v.match(/(?!(0))(^[0-9]+$)/)&&parseInt(v)>0;};if(s.toLowerCase().startsWith(t[0].toLowerCase())){if(t[1]){if(w(t[1])){u=t[1];if(t[2]){if(r.toLowerCase().startsWith(t[2].toLowerCase())){M=true;}}else{M=true;}}}else{M=true;}}else if(w(t[0])&&t.length<3){u=t[0];if(t[1]){if(r.toLowerCase().startsWith(t[1].toLowerCase())){M=true;}}else{M=true;}}else if(r.toLowerCase().startsWith(t[0].toLowerCase())&&t.length==1){M=true;}if(M&&u){var y;switch(this.category){case"DYNAMIC.DATE.INT":y="DAY";break;case"DYNAMIC.WEEK.INT":y="WEEK";break;case"DYNAMIC.MONTH.INT":y="MONTH";break;case"DYNAMIC.QUARTER.INT":y="QUARTER";break;case"DYNAMIC.YEAR.INT":y="YEAR";break;default:y="DAY";break;}var z=parseInt(u),F=true;if(z>n._maxIntValue){M=false;}if(this.key.startsWith("LAST")){z=z*-1;F=false;}var A;if(this.getDateRange){var C=this.getDateRange({operation:this.key,value1:z});A=[C.value1,C.value2];}else{A=p.getDateRange(z,y,true,F,F);}var E=n._getDateFormatter(true);if(Math.abs(z)===1&&this.singulareBasicLanguageText){i.setText(this.singulareBasicLanguageText);if(y!=="DAY"){i.setAdditionalText(E.format(A[0])+" - "+E.format(A[1]));}else{i.setAdditionalText(E.format(A[0]));}}else{i.setText(n._fillNumberToText(this.basicLanguageText,u));i.setAdditionalText(E.format(A[0])+" - "+E.format(A[1]));}i._value1=parseInt(u);}else{i.setAdditionalText(null);i.setText(this.languageText);i._value1=null;}return M;};p._DateFilterSuggestItem=function(v,i,n){var r=n._getDateFormatter(true);var s=r.parse(v);if(s){i.setText(this.languageText+" ("+r.format(s)+")");i._value1=s;return true;}else{i.setText(this.languageText);i._value1=null;return false;}};p._DateRangeFilterSuggestItem=function(v,i,n){var r=n._getDateFormatter(true);var s,t;var u="-";var w=false;var x=v.split(u);if(x.length===2){if(x[0].slice(x[0].length-1,x[0].length)==" "){x[0]=x[0].slice(0,x[0].length-1);}if(x[1].slice(0,1)==" "){x[1]=x[1].slice(1);}}else{x=v.split(" "+u+" ");}if(x.length<2){var y=v.split(" ");if(y.length===2){x=y;}}if(x.length>=1&&x.length<=2){s=r.parse(x[0]);if(s){i._value1=s;if(x.length==2&&x[1]===""){x.splice(1,1);}if(x.length==2){t=r.parse(x[1]);if(t){i._value2=t;w=true;i.setText(this.languageText+" ("+r.format(s)+" "+u+" "+r.format(t)+")");}}else{w=true;i.setText(this.languageText+" ("+r.format(s)+" "+u+")");}}}if(!w){i.setText(this.languageText);i._value1=null;i._value2=null;}return w;};p._MonthFilterSuggestItem=function(v,n,r){var M=false;n._value1=null;var s=this.getValueList();for(var i=0;i<s.length;i++){var t=s[i];M=t.text.toLowerCase().startsWith(v.toLowerCase());if(M){n.setText(this.languageText+" ("+t.text+")");n._value1=i;break;}}return M;};p._DefaultOnItemSelected=function(v,i,n){n.oModel.setProperty("/condition/operation",this.key);if("value1"in this){n.oModel.setProperty("/condition/value1",i._value1);}if("value2"in this){n.oModel.setProperty("/condition/value2",i._value2);}n.oModel.setProperty("inputstate","NONE",n.getContext());n._bSuggestItemSelected=true;};p._IntOnItemSelected=function(v,i,n){var r=i._value1;n.oModel.setProperty("/condition/operation",this.key);n.oModel.setProperty("/condition/value1",r);n.oModel.setProperty("inputstate","NONE",n.getContext());n._bSuggestItemSelected=true;};p.getFixedRangeOperation=function(K,t,C,i,F,O){return{key:K,textKey:t,category:C,order:O||100,defaultValues:i||null,type:"range",display:"range",filterSuggestItem:F||p._DefaultFilterSuggestItem,onItemSelected:p._DefaultOnItemSelected,getControls:p.ControlFactory};};p.createSingleIntRangeOperation=function(K,t,s,C,i,n,O){return{key:K,textKey:t,singularTextKey:s,category:C,order:O,defaultValues:[i],value1:null,type:"int",descriptionTextKeys:n,onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory,_getInitialValues:function(r){return[r.value1,r.value2];}};};p.Operations={DATERANGE:{key:"DATERANGE",textKey:"CONDITION_DATERANGETYPE_DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null,onChange:p._DateRangeOnChangeHandler,filterSuggestItem:p._DateRangeFilterSuggestItem,onItemSelected:p._DefaultOnItemSelected,getControls:function(i,r){var n=new d({text:T.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});n.addStyleClass("sapUiCompFilterBarCTPaddingTop");r.push(n);var C=new a(T._createStableId(i,"field1"),{dateValue:{path:"$smartEntityFilter>value1"},maxDate:{path:"$smartEntityFilter>value2"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");if(v){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"));}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"));}}});n.setLabelFor(C);r.push(C);n=new d({text:T.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});n.addStyleClass("sapUiCompFilterBarCTPaddingTop");r.push(n);C=new a(T._createStableId(i,"field2"),{dateValue:{path:"$smartEntityFilter>value2"},minDate:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");if(v){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"));}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"));}}});n.setLabelFor(C);r.push(C);}},DATE:{key:"DATE",textKey:"CONDITION_DATERANGETYPE_DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:p._DateOnChangeHandler,filterSuggestItem:p._DateFilterSuggestItem,onItemSelected:p._DefaultOnItemSelected,getControls:function(i,r){var C=new a(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");if(v){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"));}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"));}}});r.push(C);}},FROM:{key:"FROM",textKey:"CONDITION_DATERANGETYPE_FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:p._DateOnChangeHandler,filterSuggestItem:p._DateFilterSuggestItem,onItemSelected:p._DefaultOnItemSelected,getControls:function(i,r){var C=new a(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");if(v){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"));}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"));}}});r.push(C);}},TO:{key:"TO",textKey:"CONDITION_DATERANGETYPE_TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null,onChange:p._DateOnChangeHandler,filterSuggestItem:p._DateFilterSuggestItem,onItemSelected:p._DefaultOnItemSelected,getControls:function(i,r,O){var C=new a(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",change:function(E){var v=E.getParameter("valid");if(v){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"));}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"));}}});r.push(C);}},LASTDAYS:p.createSingleIntRangeOperation("LASTDAYS","CONDITION_DATERANGETYPE_LASTDAYS","CONDITION_DATERANGETYPE_YESTERDAY","DYNAMIC.DATE.INT",1,["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],4),LASTWEEKS:p.createSingleIntRangeOperation("LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEK","DYNAMIC.WEEK.INT",1,["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],8),LASTMONTHS:{key:"LASTMONTHS",textKey:"CONDITION_DATERANGETYPE_LASTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_LASTMONTH",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory},LASTQUARTERS:{key:"LASTQUARTERS",textKey:"CONDITION_DATERANGETYPE_LASTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_LASTQUARTER",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory},LASTYEARS:{key:"LASTYEARS",textKey:"CONDITION_DATERANGETYPE_LASTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_LASTYEAR",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory},NEXTDAYS:{key:"NEXTDAYS",textKey:"CONDITION_DATERANGETYPE_NEXTDAYS",singularTextKey:"CONDITION_DATERANGETYPE_TOMORROW",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory},NEXTWEEKS:{key:"NEXTWEEKS",textKey:"CONDITION_DATERANGETYPE_NEXTWEEKS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTWEEK",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory},NEXTMONTHS:{key:"NEXTMONTHS",textKey:"CONDITION_DATERANGETYPE_NEXTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTMONTH",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory},NEXTQUARTERS:{key:"NEXTQUARTERS",textKey:"CONDITION_DATERANGETYPE_NEXTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTQUARTER",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory},NEXTYEARS:{key:"NEXTYEARS",textKey:"CONDITION_DATERANGETYPE_NEXTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTYEAR",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:p._IntOnChangeHandler,filterSuggestItem:p._IntFilterSuggestItem,onItemSelected:p._IntOnItemSelected,getControls:p.ControlFactory},SPECIFICMONTH:{key:"SPECIFICMONTH",textKey:"CONDITION_DATERANGETYPE_SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var i=new U();return[i.getMonth()];},value1:null,onChange:p._MonthOnChangeHandler,onItemSelected:p._DefaultOnItemSelected,filterSuggestItem:p._MonthFilterSuggestItem,getControls:function(i,r,O){var s=new S(T._createStableId(i,"field"),{ariaLabelledBy:i._oOperationSelect||null,width:"100%",selectedKey:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer"}});s.bindAggregation("items",{path:"$smartEntityFilter>/currentoperation/valueList",template:new L({text:{path:"$smartEntityFilter>text"},key:{path:"$smartEntityFilter>key"}}),templateShareable:false});r.push(s);},getValueList:function(){var n=new U(),M=[],F=e.getDateInstance({pattern:"MMMM"});n.setDate(15);n.setMonth(0);for(var i=0;i<12;i++){M.push({text:F.format(n),key:i});n.setMonth(n.getMonth()+1);}return M;}},YESTERDAY:{key:"YESTERDAY",textKey:"CONDITION_DATERANGETYPE_YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return p.getDateRange(-1,"DAY",true);},type:"range",display:"start",onChange:p._defaultOnChangeHandler,onItemSelected:p._DefaultOnItemSelected,getControls:p.ControlFactory},TODAY:{key:"TODAY",textKey:"CONDITION_DATERANGETYPE_TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return p.getDateRange(1,"DAY",true);},type:"range",display:"start",onChange:p._defaultOnChangeHandler,onItemSelected:p._DefaultOnItemSelected,getControls:p.ControlFactory},TOMORROW:{key:"TOMORROW",textKey:"CONDITION_DATERANGETYPE_TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var i=p.getDateRange(2,"DAY",true);i[0].setDate(i[0].getDate()+1);return i;},type:"range",display:"start",onChange:p._defaultOnChangeHandler,onItemSelected:p._DefaultOnItemSelected,getControls:p.ControlFactory},THISWEEK:p.getFixedRangeOperation("THISWEEK","CONDITION_DATERANGETYPE_THISWEEK","FIXED.WEEK",function(){return p.getDateRange(1,"WEEK",true);},p._DefaultFilterSuggestItem,6),LASTWEEK:p.getFixedRangeOperation("LASTWEEK","CONDITION_DATERANGETYPE_LASTWEEK","FIXED.WEEK",function(){return p.getDateRange(-1,"WEEK",true);},p._DefaultFilterSuggestItem,7),LAST2WEEKS:p.getFixedRangeOperation("LAST2WEEKS","CONDITION_DATERANGETYPE_LAST2WEEKS","FIXED.WEEK",function(){return p.getDateRange(-2,"WEEK",true);},p._HideFilterSuggestItem,-1),LAST3WEEKS:p.getFixedRangeOperation("LAST3WEEKS","CONDITION_DATERANGETYPE_LAST3WEEKS","FIXED.WEEK",function(){return p.getDateRange(-3,"WEEK",true);},p._HideFilterSuggestItem,-1),LAST4WEEKS:p.getFixedRangeOperation("LAST4WEEKS","CONDITION_DATERANGETYPE_LAST4WEEKS","FIXED.WEEK",function(){return p.getDateRange(-4,"WEEK",true);},p._HideFilterSuggestItem,-1),LAST5WEEKS:p.getFixedRangeOperation("LAST5WEEKS","CONDITION_DATERANGETYPE_LAST5WEEKS","FIXED.WEEK",function(){return p.getDateRange(-5,"WEEK",true);},p._HideFilterSuggestItem,-1),NEXTWEEK:p.getFixedRangeOperation("NEXTWEEK","CONDITION_DATERANGETYPE_NEXTWEEK","FIXED.WEEK",function(){return p.getDateRange(1,"WEEK",true,true,true);},p._DefaultFilterSuggestItem,9),NEXT2WEEKS:p.getFixedRangeOperation("NEXT2WEEKS","CONDITION_DATERANGETYPE_NEXT2WEEKS","FIXED.WEEK",function(){return p.getDateRange(2,"WEEK",true,true,true);},p._HideFilterSuggestItem,-1),NEXT3WEEKS:p.getFixedRangeOperation("NEXT3WEEKS","CONDITION_DATERANGETYPE_NEXT3WEEKS","FIXED.WEEK",function(){return p.getDateRange(3,"WEEK",true,true,true);},p._HideFilterSuggestItem,-1),NEXT4WEEKS:p.getFixedRangeOperation("NEXT4WEEKS","CONDITION_DATERANGETYPE_NEXT4WEEKS","FIXED.WEEK",function(){return p.getDateRange(4,"WEEK",true,true,true);},p._HideFilterSuggestItem,-1),NEXT5WEEKS:p.getFixedRangeOperation("NEXT5WEEKS","CONDITION_DATERANGETYPE_NEXT5WEEKS","FIXED.WEEK",function(){return p.getDateRange(5,"WEEK",true,true,true);},p._HideFilterSuggestItem,-1),THISMONTH:p.getFixedRangeOperation("THISMONTH","CONDITION_DATERANGETYPE_THISMONTH","FIXED.MONTH",function(){return p.getDateRange(1,"MONTH",true);},p._DefaultFilterSuggestItem,12),LASTMONTH:p.getFixedRangeOperation("LASTMONTH","CONDITION_DATERANGETYPE_LASTMONTH","FIXED.MONTH",function(){return p.getDateRange(-1,"MONTH",true);},p._DefaultFilterSuggestItem,13),NEXTMONTH:p.getFixedRangeOperation("NEXTMONTH","CONDITION_DATERANGETYPE_NEXTMONTH","FIXED.MONTH",function(){return p.getDateRange(1,"MONTH",true,true,true);},p._DefaultFilterSuggestItem,15),THISQUARTER:p.getFixedRangeOperation("THISQUARTER","CONDITION_DATERANGETYPE_THISQUARTER","FIXED.QUARTER",function(){return p.getDateRange(1,"QUARTER",true);},p._DefaultFilterSuggestItem,17),LASTQUARTER:p.getFixedRangeOperation("LASTQUARTER","CONDITION_DATERANGETYPE_LASTQUARTER","FIXED.QUARTER",function(){return p.getDateRange(-1,"QUARTER",true);},p._DefaultFilterSuggestItem,18),NEXTQUARTER:p.getFixedRangeOperation("NEXTQUARTER","CONDITION_DATERANGETYPE_NEXTQUARTER","FIXED.QUARTER",function(){return p.getDateRange(1,"QUARTER",true,true,true);},p._DefaultFilterSuggestItem,20),YEARTODATE:p.getFixedRangeOperation("YEARTODATE","CONDITION_DATERANGETYPE_YEARTODATE","FIXED.YEAR",function(){return[p.getYearStartDate(new U()),p.setEndTime()];},p._DefaultFilterSuggestItem,31),THISYEAR:p.getFixedRangeOperation("THISYEAR","CONDITION_DATERANGETYPE_THISYEAR","FIXED.YEAR",function(){return p.getDateRange(1,"YEAR",true);},p._DefaultFilterSuggestItem,26),LASTYEAR:p.getFixedRangeOperation("LASTYEAR","CONDITION_DATERANGETYPE_LASTYEAR","FIXED.YEAR",function(){return p.getDateRange(-1,"YEAR",true);},p._DefaultFilterSuggestItem,27),NEXTYEAR:p.getFixedRangeOperation("NEXTYEAR","CONDITION_DATERANGETYPE_NEXTYEAR","FIXED.YEAR",function(){return p.getDateRange(1,"YEAR",true,true,true);},p._DefaultFilterSuggestItem,29),QUARTER1:p.getFixedRangeOperation("QUARTER1","CONDITION_DATERANGETYPE_QUARTER1","FIXED.QUARTER",function(){var s=p.getYearStartDate();return p.getDateRange(1,"QUARTER",s);},p._DefaultFilterSuggestItem,22),QUARTER2:p.getFixedRangeOperation("QUARTER2","CONDITION_DATERANGETYPE_QUARTER2","FIXED.QUARTER",function(){var s=p.getDateRange(1,"QUARTER",p.getYearStartDate())[1];s.setMilliseconds(1000);return p.getDateRange(1,"QUARTER",s);},p._DefaultFilterSuggestItem,23),QUARTER3:p.getFixedRangeOperation("QUARTER3","CONDITION_DATERANGETYPE_QUARTER3","FIXED.QUARTER",function(){var s=p.getDateRange(2,"QUARTER",p.getYearStartDate())[1];s.setMilliseconds(1000);return p.getDateRange(1,"QUARTER",s);},p._DefaultFilterSuggestItem,24),QUARTER4:p.getFixedRangeOperation("QUARTER4","CONDITION_DATERANGETYPE_QUARTER4","FIXED.QUARTER",function(){var s=p.getDateRange(3,"QUARTER",p.getYearStartDate())[1];s.setMilliseconds(1000);return p.getDateRange(1,"QUARTER",s);},p._DefaultFilterSuggestItem,25)};p.prototype.getControls=function(O){var C=[];if(!O){return;}O.getControls(this,C,O);return C;};p.prototype.setIgnoreTime=function(i){this._bIgnoreTime=i;};T.prototype.getIgnoreTime=function(i){return this._bIgnoreTime;};p.prototype.getDefaultValues=function(O){if(!O){return[];}var i=O.defaultValues||[];if(typeof i==="function"){i=O.defaultValues();}var C=this.getCondition(),v=i[0]||null,n=i[1]||null;if(O.key==="DATERANGE"&&C&&C.value1&&C.value2){v=C.value1.oDate||C.value1;n=C.value2.oDate||C.value2;}else{if(v instanceof Date){v=new U(v);}if(n instanceof Date){n=new U(n);}}return[v,n];};p.prototype.getOperations=function(){var O=[];for(var n in p.Operations){var i=p.Operations[n];if(this._filterOperation(i)){O.push(i);}}return O;};p.prototype._updateOperation=function(O){T.prototype._updateOperation.apply(this,[O]);if(O.languageText&&!O.basicLanguageText){O.basicLanguageText=O.languageText;if(!O.singulareBasicLanguageText&&O.singularTextKey){O.singulareBasicLanguageText=this.getTranslatedText(O.singularTextKey);}O.languageText=this._fillNumberToText(O.languageText);}if(O.display){var i=this.getDefaultValues(O);var n=this._getDateFormatter(false);if(O.display==="start"){O.textValue=n.format(i[0].oDate);}else if(O.display==="range"&&i&&i[0]&&i[1]){O.textValue=n.format(i[0].oDate)+" - "+n.format(i[1].oDate);}}O.suggestText=O.languageText;};p.prototype.updateOperations=function(){var O=this.getOperations();for(var i=0;i<O.length;i++){this._updateOperation(O[i]);}return this.oModel.setProperty("operations",O,this.getContext(),true);};p.prototype.isValidCondition=function(){var C=this.getCondition(),O=this.getOperation(C.operation);if(O&&C&&C.key&&C.operation){if("value1"in O&&"value2"in O){return"value1"in C&&C.value1!==null&&"value2"in C&&C.value2!==null;}else if("value1"in O){return"value1"in C&&C.value1!==null;}else if("value2"in O){return"value2"in C&&C.value2!==null;}else if(!("value1"in O)&&!("value2"in O)){return true;}}return false;};p.prototype.providerDataUpdated=function(u,i){};p.prototype.initialize=function(J){T.prototype.initialize.apply(this,[J]);this.oModel.suspend();var O=q.extend({},J,true);var C=(new U()).getCalendarType();if(!J.conditionTypeInfo){if(J.ranges&&J.ranges.length==1){var s="DATERANGE";if(J.ranges[0].operation==="GE"){s="FROM";}if(J.ranges[0].operation==="LE"){s="TO";}J.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:s,value1:J.ranges[0].value1,value2:J.ranges[0].value2,calendarType:C}};}else{var i=this.getDefaultOperation(),K=i?i.key:"";J.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:K,calendarType:C}};}}if(J.conditionTypeInfo){J=J.conditionTypeInfo;}if(J.name&&J.data){if(J.name!==this.getName()){k.debug("ConditionType "+this.getName()+" tries to deserialize data from "+J.name);}J=J.data;}if(!J.operation){return;}if(this.getOperation(J.operation)&&this.getOperation(J.operation).order<0){var n=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(J.operation);if(n>=0){J.operation="LASTWEEKS";J.value1=n+2;}n=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(J.operation);if(n>=0){J.operation="NEXTWEEKS";J.value1=n+2;}}var r=this.getOperation(J.operation);if(!r){if(this.getAsync()){this.setPending(true);var t=this,H=function(E){if(E.getParameter("pending")===false){t.oFilterProvider.detachPendingChange(H);t.initialize(O);}};this.oFilterProvider.attachPendingChange(H);this.oModel.resume();return;}}var v;if(C!==J.calendarType&&(J.calendarType==="Islamic"||C==="Islamic")&&J.operation==="SPECIFICMONTH"){J.operation="DATERANGE";var u=parseInt(J.value1),w=U.getInstance(new Date(),J.calendarType);w.setMonth(u);w=p.getMonthStartDate(w);v=p.getDateRange(1,"MONTH",w,true);J.value1=v[0].oDate.toISOString();J.value2=v[1].oDate.toISOString();}var x=this.getConditionContext().getObject();x.operation=J.operation;x.key=J.key;x.value1=null;x.value2=null;if(J.operation==="DATERANGE"){if(typeof J.value1==="string"){J.value1=J.value1===""?null:(new U(J.value1)).oDate;}if(typeof J.value2==="string"){J.value2=J.value2===""?null:(new U(J.value2)).oDate;}x.value1=J.value1;x.value2=J.value2;}else if(["DATE","FROM","TO"].indexOf(J.operation)!==-1){if(typeof J.value1==="string"){J.value1=J.value1===""?null:(new U(J.value1)).oDate;}x.value1=J.value1;}else if(["LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(J.operation)>-1){x.value1=J.value1;}else if(J.operation==="SPECIFICMONTH"){x.value1=J.value1+"";}else{var r=this.getOperation(J.operation);v=r&&r._getInitialValues?r._getInitialValues(J):null;if(!v){v=this.getDefaultValues(r);}x.value1=v[0];x.value2=v[1];}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);};p.prototype.serialize=function(u,F){var J={},C=this.getCondition();if(!C.operation){return null;}var O=this.getOperation(C.operation);if(!O||!("value1"in O)){C.value1=null;}if(!O||!("value2"in O)){C.value2=null;}C.calendarType=(new U()).getCalendarType();J.conditionTypeInfo={name:this.getName(),data:C};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer;}if(u){this._updateProvider(J,true,F);}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,J,false,F),1);}return J;};p.prototype._updateProvider=function(J,s,F){J.ranges=this.getFilterRanges();J.items=[];var i=false;var C=0;var n=0;var r=0;if(this.oModel.getData().currentoperation.languageText){var t=this.oModel.getData();var u=t.currentoperation.languageText;if(t.currentoperation.basicLanguageText.indexOf("{0}")>=0){if(J.conditionTypeInfo.data.value1!=null&&J.conditionTypeInfo.data.value1!=""){if(J.conditionTypeInfo.data.value1===1&&t.currentoperation.singulareBasicLanguageText){u=t.currentoperation.singulareBasicLanguageText;}else{u=this._fillNumberToText(t.currentoperation.basicLanguageText,J.conditionTypeInfo.data.value1);}this.oModel.setProperty("inputstate","NONE",this.getContext());}else if(this._bSuggestItemSelected){u=this._fillNumberToText(t.currentoperation.basicLanguageText);var x=t.currentoperation.basicLanguageText.indexOf("{0}");C=x+1;n=x;r=x+1;i=true;}else{u="";this.oModel.setProperty("inputstate","NONE",this.getContext());}}else if(t.currentoperation.textValue){u=t.currentoperation.languageText+" ("+t.currentoperation.textValue+")";this.oModel.setProperty("inputstate","NONE",this.getContext());}else{if(J.conditionTypeInfo.data.value1!==null&&J.conditionTypeInfo.data.value1!==""){var v=J.conditionTypeInfo.data.value1;var w=J.conditionTypeInfo.data.value2;var y;if(typeof v==="number"&&t.currentoperation.valueList){y=t.currentoperation.valueList[v].text;}else if(v instanceof Date){var z=this._getDateFormatter(false);if(J.conditionTypeInfo.data.operation!=="DATERANGE"&&(v&&!w)){y=z.format(v);}else if(J.conditionTypeInfo.data.operation==="DATERANGE"&&v&&w){y=z.format(v)+" - "+z.format(w);}else if(J.conditionTypeInfo.data.operation==="DATERANGE"&&v&&!w&&!(this._oPopup&&this._oPopup.isOpen())){y=z.format(v)+" - ";i=true;}else{y="";}}else{y=J.conditionTypeInfo.data.value1;}if(y){u=t.currentoperation.languageText+" ("+y+")";C=u.length-1;this.oModel.setProperty("inputstate","NONE",this.getContext());}else{u="";}}else{u="";}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",u);if(i&&!(this._oPopup&&this._oPopup.isOpen())){this._oInput.$("inner").cursorPos(C);if(n<r){this._oInput.selectText(n,r);}this._oInput._lastValue="";}}if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,J);this.oFilterProvider.setFilterData({},false,this.sFieldName);if(F&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange();if(this.oFilterProvider._oSmartFilter.getLiveMode()){var A=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar");this.oFilterProvider._oSmartFilter.triggerSearch(A.LIVE_MODE_INTERVAL);}}}};p.prototype.getFilterRanges=function(){var C=this.getCondition(),v=[],r;if(C.operation==="LASTDAYS"){v=p.getDateRange(-C.value1,"DAY",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTWEEKS"){v=p.getDateRange(-C.value1,"WEEK",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTMONTHS"){v=p.getDateRange(-C.value1,"MONTH",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTQUARTERS"){v=p.getDateRange(-C.value1,"QUARTER",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTYEARS"){v=p.getDateRange(-C.value1,"YEAR",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTDAYS"){v=p.getDateRange(C.value1,"DAY",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTWEEKS"){v=p.getDateRange(C.value1,"WEEK",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTMONTHS"){v=p.getDateRange(C.value1,"MONTH",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTQUARTERS"){v=p.getDateRange(C.value1,"QUARTER",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTYEARS"){v=p.getDateRange(C.value1,"YEAR",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="SPECIFICMONTH"){var i=parseInt(C.value1),n=new U();n.setMonth(i);n=p.getMonthStartDate(n);v=p.getDateRange(1,"MONTH",n,true);C.value1=v[0];C.value2=v[1];}else{var O=this.getOperation(C.operation);if(O&&O.getDateRange){r=O.getDateRange(C);if(!r){return[];}C.value1=r&&r.value1?r.value1:null;C.value2=r&&r.value2?r.value2:null;}}if(C.value1 instanceof U){C.value1=C.value1.oDate;}if(C.value2 instanceof U){C.value2=C.value2.oDate;}if(C.operation==="DATE"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="EQ";delete C.value2;}else if(C.operation==="FROM"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="GE";delete C.value2;}else if(C.operation==="TO"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="LE";delete C.value2;C.value1=p.setEndTime(C.value1,this._bIgnoreTime,this._Precision).oDate;}else{if(r){C.operation=r.operation;C.value1=C.value1?p.setStartTime(C.value1).oDate:null;C.value2=C.value2?p.setEndTime(C.value2,this._bIgnoreTime,this._Precision).oDate:null;}else{if(!(this.isValidCondition()&&C.value1&&C.value2)){return[];}C.operation="BT";C.value1=p.setStartTime(C.value1).oDate;C.value2=p.setEndTime(C.value2,this._bIgnoreTime,this._Precision).oDate;}}C.exclude=false;C.keyField=C.key;delete C.key;return[C];};p.prototype.getTokenText=function(){return"";};p.prototype.getName=function(){return this.getMetadata().getName();};p.prototype.getType=function(){return"Edm.Date";};p.prototype._bindValueState=function(C){C.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return V.Error;}else{return V.None;}}});};p.prototype.initializeFilterItem=function(){this._oInput=new I(T._createStableId(this),{value:"{$smartEntityFilter>formattedText}",showValueHelp:true,showSuggestion:true,maxSuggestionWidth:"auto",valueHelpRequest:this._toggleOpen.bind(this)});this._oInput._highlightListText=function(){var i,n,r=this._oList.$().find('.sapMDLILabel, .sapMSLITitleOnly');for(i=0;i<r.length;i++){n=r[i];n.innerHTML=this._createHighlightedText(n);}};this._bindValueState(this._oInput);this._oInput.bindAggregation("suggestionItems",{path:"$smartEntityFilter>operations",sorter:new m("order",false,false),filters:new j("order",function(v){return v!==undefined&&v>-1;}),template:new L({key:{path:"$smartEntityFilter>key"}}),templateShareable:false});this._oInput.setFilterFunction(function(v,i){if(this._oPopup&&this._oPopup.isOpen()){return false;}var O=this.getOperation(i.getKey());v=v.trim();if(v==="?"){p._DefaultFilterSuggestItem.call(O,v,i,this);return O.category!=="DYNAMIC.DATERANGE"&&O.category!=="DYNAMIC.DATE";}if(O.filterSuggestItem){return O.filterSuggestItem(v,i,this);}else{return p._DefaultFilterSuggestItem.call(O,v,i,this);}}.bind(this));this._oInput.attachSuggestionItemSelected(function(E){var i=E.getParameter("selectedItem");if(!i){return;}var O=i.getKey();var n=this.getOperation(O);var v=E.oSource.getValue().trim();if(n.onItemSelected){n.onItemSelected(v,i,this);return;}else{p._DefaultOnItemSelected.call(n,v,i,this);}}.bind(this));this._oInput.attachChange(function(E){var v=E.getParameter("value");if(v){var O=this.getOperations();var H=O.some(function(i){if(i.onChange){return i.onChange(v,this);}else{return p._defaultOnChangeHandler.call(i,v,this);}},this);if(!H){this.oModel.setProperty("inputstate","ERROR",this.getContext());}}else{this.setCondition({key:this.sFieldName,operation:"FROM",value1:null,value2:null});this.oModel.setProperty("inputstate","NONE",this.getContext());}}.bind(this));this._oInput.attachBrowserEvent("focusin",function(E){if(q(E.target).hasClass("sapMInputBaseInner")&&this._oPopup&&this._oPopup.isOpen()){this._oPopup.close();}}.bind(this));this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput;};p.prototype._toggleOpen=function(E){if(!this._oPopup){if((!R||!o||(D.system.phone&&!B))&&!this._bPopoverRequested){R=sap.ui.require("sap/m/ResponsivePopover");o=sap.ui.require("sap/m/VBox");if(D.system.phone){B=sap.ui.require("sap/m/Button");if(!R||!o||!B){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox","sap/m/Button"],_.bind(this));this._bPopoverRequested=true;}}else if(!R||!o){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox"],_.bind(this));this._bPopoverRequested=true;}}if(!R||!o||(D.system.phone&&!B)){return;}this._oPopupLayout=new o();this._oPopupLayout.addStyleClass("sapUiCompDateRangeType");this._initializeFilterItemPopoverContent(this._oPopupLayout);this._oPopup=new R({showCloseButton:false,showArrow:true,showHeader:false,horizontalScrolling:false,placement:P.VerticalPreferedBottom,content:this._oPopupLayout,contentWidth:"18rem"});this._oPopup.addAriaLabelledBy(this._oOperationLabel);if(D.system.phone){this._oPopup.setBeginButton(new B({text:T.getTranslatedText("CONDITION_DATERANGETYPE_POPOVER_CLOSEBUTTON"),type:"Emphasized",press:function(E){this._oPopup.close();}.bind(this)}));}sap.ui.getCore().getMessageManager().registerObject(this._oPopup,true);this._oPopup.setModel(this.getModel(),"$smartEntityFilter");this._oPopup._oControl.oPopup.setAutoCloseAreas([this._oInput.getDomRef()]);}if(!this._oPopup.isOpen()){this._oPopup.openBy(this._oInput._getValueHelpIcon());}else{this._oPopup.close();}};function _(r,v,i){R=r;o=v;B=i;this._bPopoverRequested=false;if(!this._bIsBeingDestroyed){this._toggleOpen();}}p.prototype._getDateFormatter=function(s){var F={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:s};if(JSON.stringify(F)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(F);this._oDateFormatter=e.getInstance(F);}return this._oDateFormatter;};p.prototype._fillNumberToText=function(t,n){var s="X";if(n){s=String(n);}return t.replace("{0}",s);};p.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer;}if(this._oPopup){sap.ui.getCore().getMessageManager().unregisterObject(this._oPopup);this._oPopup.destroy();}T.prototype.destroy.apply(this,arguments);};return p;},true);
