/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/ObjectPath"],function(O){"use strict";var P={};P.getPastedDataAs2DArray=function(e){var c=e.clipboardData;if(!c){c=window.clipboardData;}var r=/sapui5Placeholder4MultiLine/g;var p=r.source;var a=/""/g;var d,D,R,b=[];if(c){d=c.getData('Text');var C=[];var m=false;var f=d.indexOf("\""),g=-1;var h,k;while(f>-1){k=d.charAt(f-1);if((f===0)||(k==='\n')||(k==='\t')||(k==='\r')){g=d.indexOf("\"",f+1);if(g>-1){h=d.charAt(g+1);while((g>-1)&&(h==='\"')){g=d.indexOf("\"",g+2);h=d.charAt(g+1);}if((h==='\n')||(h==='\t')||(h==='')||(h==='\r')){var M=d.substring(f+1,g);d=d.replace("\""+M+"\"",p);M=M.replace(a,"\"");C.push(M);f=d.indexOf("\"",f+p.length+1);m=true;}}}if(!m){f=d.indexOf("\"",f+1);}m=false;}D=d.split(/\r\n|\r|\n/);var j=0;var G=function(){return C[j++];};for(var i=0;i<D.length;i++){R=D[i];if(C.length>0){R=R.replace(r,G);}if(R.length||i<D.length-1){b.push(R.split("\t"));}}}return b;};P.parse=function(d,c){var r={parsedData:null,errors:null};if(!d){throw new Error("Parameter aData is not specified");}if(c){for(var i=0;i<c.length;i++){var C=c[i];if(C.ignore){continue;}if(C.property){if(C.type){var t=C.type;if(t.isA&&t.isA("sap.ui.model.SimpleType")){C.typeInstance=t;}else{t=O.get(C.type);if(t){C.typeInstance=new t();}else{throw new Error("Data type "+C.type+" is not available");}}}else if(C.customParseFunction==undefined){throw new Error("Missing ColumnInfo.type or custom type parse function for column "+(i+1)+". Check the application calling PasteHelper.parse(aData, aColumnInfo) and specify the missing type in the parameter aColumnInfo.");}}else{throw new Error("Missing ColumnInfo.property for column "+(i+1)+". Check the application calling PasteHelper.parse(aData, aColumnInfo) and specify the missing property in the parameter aColumnInfo.");}}}else{throw new Error("Missing parameter aColumnInfo");}var e=[],p=[];for(var i=0;i<d.length;i++){var R=d[i];var o=P._parseRow(R,c,i,e);p.push(o);}if(e.length>0){r.parsedData=null;r.errors=e;}else{r.parsedData=p;r.errors=null;}return Promise.resolve(r);};P._parseRow=function(r,c,R,E){var b=sap.ui.getCore().getLibraryResourceBundle(),o={};for(var i=0;(i<c.length)&&(i<r.length);i++){var C=c[i];if(C.ignore){continue;}var s=r[i];try{if(C.typeInstance){s=(C.typeInstance).parseValue(s,"string");C.typeInstance.validateValue(s);}else if(C.customParseFunction){s=C.customParseFunction(s);}}catch(e){var a={row:R+1,column:i+1,property:C.property,value:s,type:C.type,message:b.getText("PasteHelper.ErrorMessage",[s,R+1,i+1,C.type])+" "+e.message+"\n"};E.push(a);s=null;}o[C.property]=s;}return o;};return P;});
