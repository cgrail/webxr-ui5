/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/base/Log','../../Component','../../Element','../../routing/Router'],function(L,C,E,R){"use strict";var e={},a={"modelContextChange":e,"beforeRendering":e,"afterRendering":e,"propertyChanged":e,"aggregationChanged":e,"componentCreated":e,"afterInit":e,"updateStarted":e,"updateFinished":e,"load":e,"scroll":e,"beforeGeometryChanged":e,"geometryChanged":e};var b={};b.enable=function(){E._interceptEvent=function(s,o,p){b.broadcastEvent(s,o,p);};R._interceptRouteMatched=function(c,r){b.broadcastRouteMatched(R.M_EVENTS.ROUTE_MATCHED,c,r);};};b.disable=function(){if(E._interceptEvent){delete E._interceptEvent;}if(R._interceptRouteMatched){delete R._interceptRouteMatched;}};b.broadcastEvent=function(s,o,p){var t=new Date();setTimeout(function(){var d={},c;if(b._shouldExpose(s,o)){c=b._createOwnerComponentInfo(o);d={componentId:c.id,componentVersion:c.version,eventName:s,targetId:o.getId(),targetType:o.getMetadata().getName(),timestamp:t.getTime()};if(L.isLoggable()){L.debug("EventBroadcaster: Broadcast Event: ",JSON.stringify(d));}d.additionalAttributes=p;b._dispatchCustomEvent(d);}});};b.broadcastRouteMatched=function(s,c,r){var t=new Date();setTimeout(function(){var o=b._createOwnerComponentInfo(sap.ui.getCore().byId(c)),d={componentId:o.id,componentVersion:o.version,eventName:s,targetId:c,targetType:"sap.ui.core.routing.Router",timestamp:t.getTime(),additionalAttributes:{fullURL:document&&document.baseURI,hash:r.getHashChanger().getHash(),previousHash:b._previousHash}};b._previousHash=d.additionalAttributes.hash;if(L.isLoggable()){L.debug("EventBroadcaster: Broadcast Route Matched: ",JSON.stringify(d));}b._dispatchCustomEvent(d);});};b._dispatchCustomEvent=function(d){var c=new window.CustomEvent("UI5Event",{detail:d});window.dispatchEvent(c);};b._shouldExpose=function(s,o){return!a[s]&&b._isPublicElementEvent(s,o);};b._isPublicElementEvent=function(s,o){return o.getMetadata().hasEvent(s);};b._createOwnerComponentInfo=function(s){var I,v,c,A;if(s){while(s&&s.getParent){c=C.getOwnerComponentFor(s);if(c||s.getMetadata().isA("sap.ui.core.Component")){c=c||s;A=c.getManifestEntry("sap.app");I=A&&A.id||c.getMetadata().getName();v=A&&A.applicationVersion&&A.applicationVersion.version;}s=s.getParent();}}return{id:I||"undetermined",version:v||""};};function i(){if(typeof window.CustomEvent==="function"){return false;}function c(d,p){p=p||{bubbles:false,cancelable:false,detail:undefined};var f=document.createEvent('CustomEvent');f.initCustomEvent(d,p.bubbles,p.cancelable,p.detail);return f;}c.prototype=window.Event.prototype;window.CustomEvent=c;}i();return b;});
