/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/Element","sap/ui/vk/NodeProxy","./ArrayUtilities","./MatrixUtilities"],function(q,S,a,b,c){"use strict";var d=S.extend("sap.ui.vtm.SceneNode",{metadata:{properties:{sceneNodeId:{type:"string"},scene:{type:"object"}}},_destroy:function(){if(this._vkNodeProxy){this.getScene()._getNodeHierarchy().destroyNodeProxy(this.getSceneNodeId());this._vkNodeProxy=null;}},exit:function(){this._destroy();},_checkValidity:function(){if(!this._vkNodeProxy){throw"Node has been destroyed";}},setSceneNodeId:function(s){this._destroy();this.setProperty("sceneNodeId",s);var o=this.getScene();if(o){this._vkNodeProxy=o._getNodeHierarchy().createNodeProxy(s);}return this;},setScene:function(s){this._destroy();this.setProperty("scene",s);var e=this.getSceneNodeId();if(e){this._vkNodeProxy=s._getNodeHierarchy().createNodeProxy(e);}return this;},getName:function(){this._checkValidity();return this._vkNodeProxy.getName();},getClosed:function(){this._checkValidity();return this._vkNodeProxy.getClosed();},getRelativeMatrix:function(){this._checkValidity();var v=this._vkNodeProxy.getLocalMatrix();return v?sap.ui.vtm.MatrixUtilities.fromVkMatrix(v):null;},setRelativeMatrix:function(m){this._checkValidity();var v=sap.ui.vtm.MatrixUtilities.toVkMatrix(m);this._vkNodeProxy.setLocalMatrix(v);return this;},getAbsoluteMatrix:function(){this._checkValidity();var v=this._vkNodeProxy.getWorldMatrix();return v?sap.ui.vtm.MatrixUtilities.fromVkMatrix(v):null;},setAbsoluteMatrix:function(m){this._checkValidity();var v=sap.ui.vtm.MatrixUtilities.toVkMatrix(m);this._vkNodeProxy.setWorldMatrix(v);return this;},_fromVkMetadata:function(v){var r={};var e=Object.getOwnPropertyNames(v);e.forEach(function(f){var m=v[f];var g=Object.getOwnPropertyNames(m);g.forEach(function(h){var i=m[h];var j={category:f,field:h};r[JSON.stringify(j)]=i;});});return r;},getNodeMetadata:function(){this._checkValidity();var v=this._vkNodeProxy.getNodeMetadata();return v?this._fromVkMetadata(v):{};},_fromVkVeIds:function(v){var r={};v.forEach(function(i){var k=JSON.stringify({source:i.source,type:i.type});var e=JSON.stringify(i.fields);var f=r[k];if(f){var g=sap.ui.vtm.ArrayUtilities.wrap(f);g.push(e);r[k]=g;}else{r[k]=e;}});return r;},getIdentifiers:function(){this._checkValidity();var v=this._vkNodeProxy.getVeIds();return v?this._fromVkVeIds(v):{};}});return d;},true);
