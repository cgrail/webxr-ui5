/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/Element","./Panel","./Scene","./ArrayUtilities","./Viewable","sap/m/Toolbar"],function(q,S,a,b,c,d,e){"use strict";var V=S.extend("sap.ui.vtm.Vtm",{metadata:{properties:{addDefaultExtensions:{type:"boolean"}},events:{panelAdded:{parameters:{panel:{type:"sap.ui.vtm.Panel"}}},activePanelChanged:{},initialized:{}},aggregations:{extensions:{type:"sap.ui.vtm.Extension",multiple:true}},defaultAggregation:"extensions"},constructor:function(i,s){S.apply(this,arguments);this._panels=[];this._scene=new sap.ui.vtm.Scene(this.getId()+"_scene");this.addDependent(this._scene);this._dragStartParameters={};var f=this.getExtensions().map(function(g){return g.getInitializedPromise();});Promise.all(f).then(function(){sap.ui.vtm.measure(this,"fireInitialized",function(){this.fireInitialized();}.bind(this));}.bind(this));},setAddDefaultExtensions:function(A){if(A){[new sap.ui.vtm.extensions.LoadProgressExtension(),new sap.ui.vtm.extensions.MessageStatusCalculationExtension(),new sap.ui.vtm.extensions.MessageStatusIconClickExtension(),new sap.ui.vtm.extensions.ViewportSelectionLinkingExtension(),new sap.ui.vtm.extensions.VisibilityIconClickExtension(),new sap.ui.vtm.extensions.DisplayStateCalculationExtension(),new sap.ui.vtm.extensions.SelectionLinkingExtension({enabled:false}),new sap.ui.vtm.extensions.ViewLinkingExtension({enabled:false}),new sap.ui.vtm.extensions.InitialViewExtension(),new sap.ui.vtm.extensions.SceneNodeHoverHighlightExtension(),new sap.ui.vtm.extensions.SceneNodeHoverTooltipExtension()].forEach(function(f){this.addExtension(f);}.bind(this));}},getPanels:function(){return this._panels;},getPanel:function(p){return sap.ui.vtm.ArrayUtilities.find(this._panels,function(f){return f.getId()===p;});},getScene:function(){return this._scene;},createPanel:function(i,s){s=q.extend(s,{vtmId:this});return new sap.ui.vtm.Panel(i,s);},_setActivePanel:function(A,s){if(this._activePanel===A){return;}this._activePanel=A;var p=this.getPanels();p.forEach(function(f){var i=f===A;f._setIsActive(i);if(s){A.focus();}});sap.ui.vtm.measure(this,"fireActivePanelChanged",function(){this.fireActivePanelChanged();}.bind(this));},getActivePanel:function(){return this._activePanel||null;},setActivePanel:function(A){this._setActivePanel(A,true);return this;},_addPanel:function(p){var f=this.getPanels();f.push(p);sap.ui.vtm.measure(this,"firePanelAdded",function(){this.firePanelAdded({panel:p});}.bind(this));return this;},getExtensionsByName:function(E){return this.getExtensions().filter(function(f){return f.getMetadata().getName()===E;});},getExtensionByName:function(E){var f=this.getExtensionsByName(E);return f.length===1?f[0]:undefined;},getExtensionsByInterface:function(i){return this.getExtensions().filter(function(f){return f.getMetadata().isInstanceOf(i);});},getExtensionByInterface:function(i){var f=this.getExtensionsByInterface(i);return f.length===1?f[0]:undefined;}});return V;});
