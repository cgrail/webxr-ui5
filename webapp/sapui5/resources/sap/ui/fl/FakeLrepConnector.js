/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/thirdparty/URI","sap/ui/fl/Utils","sap/ui/fl/LrepConnector","sap/ui/fl/Cache","sap/ui/fl/ChangePersistenceFactory"],function(q,u,F,L,C,a){"use strict";var l=Object.create(L.prototype);b._oBackendInstances={};function b(i){this.sInitialComponentJsonPath=i;this.mSettings={};}for(var p in l){if(typeof l[p]==='function'){b.prototype[p]=(function(p){return function(){throw new Error('Method '+p+'() is not implemented in FakeLrepConnector.');};}(p));}}b.prototype.loadSettings=function(){this.setFlexServiceAvailability(true);return Promise.resolve(this.mSettings);};b.prototype.setSettings=function(s){this.mSettings=s;};b.prototype.setFlexServiceAvailability=function(A){L._bServiceAvailability=A;};b.prototype.loadChanges=function(s){var i=this.sInitialComponentJsonPath;return new Promise(function(r,g){q.getJSON(i).done(function(R){var j={changes:R,componentClassName:s};r(j);}).fail(function(j){g(j);});});};b.prototype.create=function(g,i,j){if(!j){return Promise.resolve();}if(!g.creation){g.creation=new Date().toISOString();}return Promise.resolve({response:g,status:'success'});};b.prototype.update=function(g,i,j,k){if(!k){return Promise.resolve();}return Promise.resolve({response:g,status:'success'});};b.prototype.deleteChange=function(g,i){if(!i){return Promise.resolve();}return Promise.resolve({response:undefined,status:'nocontent'});};b.prototype.send=function(U,m,D,o){return new Promise(function(r,g){f(U,m,D,o,r,g);e(U,m,D,o,r,g);d(U,m,D,o,r,g);c(U,m,D,o,r,g);h(U,m,D,o,r,g);});};function h(U,m,D,o,r){var g=/\/sap\/bc\/lrep\/appdescr_variants\/([\w.]+)/;var i=g.exec(U);if(i&&m==='GET'){var R={"content":[],"fileName":"manifest","fileType":"appdescr_variant","id":i[1],"layer":"CUSTOMER","namespace":"apps/sap.ui.test.application/appVariants/"+i[1],"packageName":"$TMP","reference":"sap.ui.test.application"};r({response:JSON.stringify(R)});}else if(i&&m==='DELETE'){r();}}function c(U,m,D,o,r){if(U.match(/^\/sap\/bc\/lrep\/changes\//)&&m==='DELETE'){var g=[];var i=/\?reference=([\w.]+)\&.+\&layer=(\w+)\&generator=([\w.]+)/;g=U.match(i);r({response:{"parameters":g},status:"success"});}}function d(U,m,D,o,r){if(U.match(/^\/sap\/bc\/ui2\/app_index\/ui5_app_mani_first_supported\//)&&m==='GET'){r({response:false,status:"success"});}}function e(U,m,D,o,r){if(U.match(/^\/sap\/bc\/lrep\/actions\/make_changes_transportable\//)&&m==='POST'){r();}}function f(U,m,D,o,r,g){if(U.match(/^\/sap\/bc\/lrep\/actions\/gettransports\//)){r({response:{"transports":[{"transportId":"U31K008488","description":"The Ultimate Transport","owner":"Fantasy Owner","locked":true}],"localonly":false,"errorCode":""}});}}b.enableFakeConnector=function(i,A,s){function r(){b.enableFakeConnector.original=L.createConnector;L.createConnector=function(){if(!b._oFakeInstance){b._oFakeInstance=new b(i);}return b._oFakeInstance;};}if(A&&s){var o=a.getChangePersistenceForComponent(A,s);if(!(o._oConnector instanceof b)){C.clearEntry(A,s);if(!b._oBackendInstances[A]){b._oBackendInstances[A]={};}b._oBackendInstances[A][s]=o._oConnector;o._oConnector=new b(i);}r();return;}C.clearEntries();if(b.enableFakeConnector.original){return;}r();};b.disableFakeConnector=function(A,s){function r(){if(b.enableFakeConnector.original){L.createConnector=b.enableFakeConnector.original;b.enableFakeConnector.original=undefined;b._oFakeInstance=undefined;}}if(A&&s){var o=a.getChangePersistenceForComponent(A,s);if(!(o._oConnector instanceof L)){C.clearEntry(A,s);if(b._oBackendInstances[A]&&b._oBackendInstances[A][s]){o._oConnector=b._oBackendInstances[A][s];b._oBackendInstances[A][s]=undefined;}}r();return;}C.clearEntries();r();};return b;},true);
