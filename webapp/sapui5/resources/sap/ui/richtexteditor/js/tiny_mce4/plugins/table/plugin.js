(function(){var g=(function(){'use strict';var q=tinymce.util.Tools.resolve('tinymce.PluginManager');var z=function(){var x=[];for(var _=0;_<arguments.length;_++){x[_]=arguments[_];}};var A=function(f){return function(){var x=[];for(var _=0;_<arguments.length;_++){x[_]=arguments[_];}return f();};};var B=function(f,a){return function(){var x=[];for(var _=0;_<arguments.length;_++){x[_]=arguments[_];}return f(a.apply(null,arguments));};};var C=function(O4){return function(){return O4;};};var D=function(x){return x;};var E=function(a,b){return a===b;};var F=function(f){var x=[];for(var _=1;_<arguments.length;_++){x[_-1]=arguments[_];}var a=new Array(arguments.length-1);for(var i=1;i<arguments.length;i++)a[i-1]=arguments[i];return function(){var x=[];for(var _=0;_<arguments.length;_++){x[_]=arguments[_];}var n=new Array(arguments.length);for(var j=0;j<n.length;j++)n[j]=arguments[j];var B2=a.concat(n);return f.apply(null,B2);};};var G=function(f){return function(){var x=[];for(var _=0;_<arguments.length;_++){x[_]=arguments[_];}return!f.apply(null,arguments);};};var H=function(m){return function(){throw new Error(m);};};var I=function(f){return f();};var J=function(f){f();};var K=C(false);var L=C(true);var $={noop:z,noarg:A,compose:B,constant:C,identity:D,tripleEquals:E,curry:F,not:G,die:H,apply:I,call:J,never:K,always:L};var M=$.never;var N=$.always;var O=function(){return P;};var P=function(){var e=function(o){return o.isNone();};var J=function(t){return t();};var i=function(n){return n;};var z=function(){};var m={fold:function(n,s){return n();},is:M,isSome:M,isNone:N,getOr:i,getOrThunk:J,getOrDie:function(a){throw new Error(a||'error: getOrDie called on none.');},or:i,orThunk:J,map:O,ap:O,each:z,bind:O,flatten:O,exists:M,forall:N,filter:O,equals:e,equals_:e,toArray:function(){return[];},toString:$.constant('none()')};if(Object.freeze)Object.freeze(m);return m;}();var Q=function(a){var c=function(){return a;};var d=function(){return m;};var g1=function(f){return Q(f(a));};var t1=function(f){return f(a);};var m={fold:function(n,s){return s(a);},is:function(v){return a===v;},isSome:N,isNone:M,getOr:c,getOrThunk:c,getOrDie:c,or:d,orThunk:d,map:g1,ap:function(o){return o.fold(O,function(f){return Q(f(a));});},each:function(f){f(a);},bind:t1,flatten:c,exists:t1,forall:t1,filter:function(f){return f(a)?m:P;},equals:function(o){return o.is(a);},equals_:function(o,e){return o.fold(M,function(b){return e(a,b);});},toArray:function(){return[a];},toString:function(){return'some('+a+')';}};return m;};var R=function(O4){return O4===null||O4===undefined?P:Q(O4);};var S={some:Q,none:O,from:R};var T=function(x){if(x===null)return'null';var t=typeof x;if(t==='object'&&Array.prototype.isPrototypeOf(x))return'array';if(t==='object'&&String.prototype.isPrototypeOf(x))return'string';return t;};var U=function(N4){return function(O4){return T(O4)===N4;};};var V={isString:U('string'),isObject:U('object'),isArray:U('array'),isNull:U('null'),isBoolean:U('boolean'),isUndefined:U('undefined'),isFunction:U('function'),isNumber:U('number')};var W=function(){var p=Array.prototype.indexOf;var f=function(a,x){return p.call(a,x);};var s=function(a,x){return q1(a,x);};return p===undefined?s:f;}();var X=function(a,x){var r=W(a,x);return r===-1?S.none():S.some(r);};var Y=function(a,x){return W(a,x)>-1;};var Z=function(x,p){return p1(x,p).isSome();};var b1=function(n,f){var r=[];for(var i=0;i<n;i++){r.push(f(i));}return r;};var f1=function(a,O1){var r=[];for(var i=0;i<a.length;i+=O1){var s=a.slice(i,i+O1);r.push(s);}return r;};var g1=function(a,f){var l=a.length;var r=new Array(l);for(var i=0;i<l;i++){var x=a[i];r[i]=f(x,i,a);}return r;};var h1=function(a,f){for(var i=0,l=a.length;i<l;i++){var x=a[i];f(x,i,a);}};var i1=function(a,f){for(var i=a.length-1;i>=0;i--){var x=a[i];f(x,i,a);}};var j1=function(a,p){var b=[];var f=[];for(var i=0,l=a.length;i<l;i++){var x=a[i];var c=p(x,i,a)?b:f;c.push(x);}return{pass:b,fail:f};};var k1=function(a,p){var r=[];for(var i=0,l=a.length;i<l;i++){var x=a[i];if(p(x,i,a)){r.push(x);}}return r;};var l1=function(a,f){if(a.length===0){return[];}else{var w=f(a[0]);var r=[];var b=[];for(var i=0,l=a.length;i<l;i++){var x=a[i];var N4=f(x);if(N4!==w){r.push(b);b=[];}w=N4;b.push(x);}if(b.length!==0){r.push(b);}return r;}};var m1=function(a,f,b){i1(a,function(x){b=f(b,x);});return b;};var n1=function(a,f,b){h1(a,function(x){b=f(b,x);});return b;};var o1=function(a,p){for(var i=0,l=a.length;i<l;i++){var x=a[i];if(p(x,i,a)){return S.some(x);}}return S.none();};var p1=function(a,p){for(var i=0,l=a.length;i<l;i++){var x=a[i];if(p(x,i,a)){return S.some(i);}}return S.none();};var q1=function(a,x){for(var i=0,l=a.length;i<l;++i){if(a[i]===x){return i;}}return-1;};var r1=Array.prototype.push;var s1=function(x){var r=[];for(var i=0,l=x.length;i<l;++i){if(!Array.prototype.isPrototypeOf(x[i]))throw new Error('Arr.flatten item '+i+' was not an array, input: '+x);r1.apply(r,x[i]);}return r;};var t1=function(x,f){var o=g1(x,f);return s1(o);};var u1=function(a,p){for(var i=0,l=a.length;i<l;++i){var x=a[i];if(p(x,i,a)!==true){return false;}}return true;};var v1=function(a,b){return a.length===b.length&&u1(a,function(x,i){return x===b[i];});};var w1=Array.prototype.slice;var x1=function(x){var r=w1.call(x,0);r.reverse();return r;};var y1=function(a,b){return k1(a,function(x){return!Y(b,x);});};var z1=function(a,f){var r={};for(var i=0,l=a.length;i<l;i++){var x=a[i];r[String(x)]=f(x,i);}return r;};var A1=function(x){return[x];};var B1=function(x,c){var s6=w1.call(x,0);s6.sort(c);return s6;};var C1=function(x){return x.length===0?S.none():S.some(x[0]);};var D1=function(x){return x.length===0?S.none():S.some(x[x.length-1]);};var E1=V.isFunction(Array.from)?Array.from:function(x){return w1.call(x);};var F1={map:g1,each:h1,eachr:i1,partition:j1,filter:k1,groupBy:l1,indexOf:X,foldr:m1,foldl:n1,find:o1,findIndex:p1,flatten:s1,bind:t1,forall:u1,exists:Z,contains:Y,equal:v1,reverse:x1,chunk:f1,difference:y1,mapToObject:z1,pure:A1,sort:B1,range:b1,head:C1,last:D1,from:E1};var G1=function(){var f=Object.keys;var s=function(o){var r=[];for(var i in o){if(o.hasOwnProperty(i)){r.push(i);}}return r;};return f===undefined?s:f;}();var H1=function(o,f){var p=G1(o);for(var k=0,l=p.length;k<l;k++){var i=p[k];var x=o[i];f(x,i,o);}};var I1=function(o,f){return J1(o,function(x,i,o){return{k:i,v:f(x,i,o)};});};var J1=function(o,f){var r={};H1(o,function(x,i){var t=f(x,i,o);r[t.k]=t.v;});return r;};var K1=function(o,p){var t={};var f={};H1(o,function(x,i){var b=p(x,i)?t:f;b[i]=x;});return{t:t,f:f};};var L1=function(o,f){var r=[];H1(o,function(O4,M4){r.push(f(O4,M4));});return r;};var M1=function(o,p){var a=G1(o);for(var k=0,l=a.length;k<l;k++){var i=a[k];var x=o[i];if(p(x,i,o)){return S.some(x);}}return S.none();};var N1=function(o){return L1(o,function(v){return v;});};var O1=function(o){return N1(o).length;};var P1={bifilter:K1,each:H1,map:I1,mapToArray:L1,tupleMap:J1,find:M1,keys:G1,values:N1,size:O1};function Q1(){var f=[];for(var _=0;_<arguments.length;_++){f[_]=arguments[_];}return function(){var N1=[];for(var _=0;_<arguments.length;_++){N1[_]=arguments[_];}if(f.length!==N1.length){throw new Error('Wrong number of arguments to struct. Expected "['+f.length+']", got '+N1.length+' arguments');}var s={};F1.each(f,function(M4,i){s[M4]=$.constant(N1[i]);});return s;};}var R1=function(a){return a.slice(0).sort();};var S1=function(a,G1){throw new Error('All required keys ('+R1(a).join(', ')+') were not specified. Specified keys were: '+R1(G1).join(', ')+'.');};var T1=function(u){throw new Error('Unsupported keys for object: '+R1(u).join(', '));};var U1=function(l,b){if(!V.isArray(b))throw new Error('The '+l+' fields must be an array. Was: '+b+'.');F1.each(b,function(a){if(!V.isString(a))throw new Error('The value '+a+' in the '+l+' fields was not a string.');});};var V1=function(i,N4){throw new Error('All values need to be of type: '+N4+'. Keys ('+R1(i).join(', ')+') were not.');};var W1=function(e){var a=R1(e);var b=F1.find(a,function(s,i){return i<a.length-1&&s===a[i+1];});b.each(function(d){throw new Error('The field: '+d+' occurs more than once in the combined fields: ['+a.join(', ')+'].');});};var X1={sort:R1,reqMessage:S1,unsuppMessage:T1,validateStrArr:U1,invalidTypeMessage:V1,checkDupes:W1};function Y1(a,o){var e=a.concat(o);if(e.length===0)throw new Error('You must specify at least one required or optional field.');X1.validateStrArr('required',a);X1.validateStrArr('optional',o);X1.checkDupes(e);return function(b){var G1=P1.keys(b);var c=F1.forall(a,function(d){return F1.contains(G1,d);});if(!c)X1.reqMessage(a,G1);var u=F1.filter(G1,function(Z5){return!F1.contains(e,Z5);});if(u.length>0)X1.unsuppMessage(u);var r={};F1.each(a,function(d){r[d]=$.constant(b[d]);});F1.each(o,function(d){r[d]=$.constant(Object.prototype.hasOwnProperty.call(b,d)?S.some(b[d]):S.none());});return r;};}var Z1={immutable:Q1,immutableBag:Y1};var $1=Z1.immutable('width','height');var _1=Z1.immutable('rows','columns');var b2=Z1.immutable('row','column');var f2=Z1.immutable('x','y');var g2=Z1.immutable('element','rowspan','colspan');var h2=Z1.immutable('element','rowspan','colspan','isNew');var i2=Z1.immutable('element','rowspan','colspan','row','column');var j2=Z1.immutable('element','cells','section');var k2=Z1.immutable('element','isNew');var l2=Z1.immutable('element','cells','section','isNew');var m2=Z1.immutable('cells','section');var n2=Z1.immutable('details','section');var o2=Z1.immutable('startRow','startCol','finishRow','finishCol');var p2={dimensions:$1,grid:_1,address:b2,coords:f2,extended:i2,detail:g2,detailnew:h2,rowdata:j2,elementnew:k2,rowdatanew:l2,rowcells:m2,rowdetails:n2,bounds:o2};var q2=function(h,s){var d=s||document;var a=d.createElement('div');a.innerHTML=h;if(!a.hasChildNodes()||a.childNodes.length>1){console.error('HTML does not have a single root node',h);throw'HTML must have a single root node';}return t2(a.childNodes[0]);};var r2=function(t,s){var d=s||document;var Q2=d.createElement(t);return t2(Q2);};var s2=function(bm,s){var d=s||document;var Q2=d.createTextNode(bm);return t2(Q2);};var t2=function(Q2){if(Q2===null||Q2===undefined)throw new Error('Node cannot be null or undefined');return{dom:$.constant(Q2)};};var u2=function(d,x,y){return S.from(d.dom().elementFromPoint(x,y)).map(t2);};var v2={fromHtml:q2,fromTag:r2,fromText:s2,fromDom:t2,fromPoint:u2};var w2={ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12};var x2=w2.ELEMENT;var y2=w2.DOCUMENT;var is=function(e,s){var a=e.dom();if(a.nodeType!==x2)return false;else if(a.matches!==undefined)return a.matches(s);else if(a.msMatchesSelector!==undefined)return a.msMatchesSelector(s);else if(a.webkitMatchesSelector!==undefined)return a.webkitMatchesSelector(s);else if(a.mozMatchesSelector!==undefined)return a.mozMatchesSelector(s);else throw new Error('Browser lacks native selectors');};var A2=function(d){return d.nodeType!==x2&&d.nodeType!==y2||d.childElementCount===0;};var B2=function(s,a){var Ja=a===undefined?document:a.dom();return A2(Ja)?[]:F1.map(Ja.querySelectorAll(s),v2.fromDom);};var C2=function(s,a){var Ja=a===undefined?document:a.dom();return A2(Ja)?S.none():S.from(Ja.querySelector(s)).map(v2.fromDom);};var D2={all:B2,is:is,one:C2};var E2=function(t,f){var r=[];var a=function(e){r.push(e);return f(e);};var c=f(t);do{c=c.bind(a);}while(c.isSome());return r;};var F2={toArray:E2};var G2=typeof window!=='undefined'?window:Function('return this;')();var H2=function(p,s){var o=s!==undefined&&s!==null?s:G2;for(var i=0;i<p.length&&o!==undefined&&o!==null;++i)o=o[p[i]];return o;};var I2=function(p,s){var a=p.split('.');return H2(a,s);};var J2=function(o,p){if(o[p]===undefined||o[p]===null)o[p]={};return o[p];};var K2=function(p,t){var o=t!==undefined?t:G2;for(var i=0;i<p.length;++i)o=J2(o,p[i]);return o;};var L2=function(M4,t){var p=M4.split('.');return K2(p,t);};var M2={path:H2,resolve:I2,forge:K2,namespace:L2};var N2=function(M4,s){return M2.resolve(M4,s);};var O2=function(M4,s){var a=N2(M4,s);if(a===undefined||a===null)throw M4+' not available on this browser';return a;};var P2={getOrDie:O2};var Q2=function(){var f=P2.getOrDie('Node');return f;};var R2=function(a,b,m){return(a.compareDocumentPosition(b)&m)!==0;};var S2=function(a,b){return R2(a,b,Q2().DOCUMENT_POSITION_PRECEDING);};var T2=function(a,b){return R2(a,b,Q2().DOCUMENT_POSITION_CONTAINED_BY);};var U2={documentPositionPreceding:S2,documentPositionContainedBy:T2};var V2=function(f){var c=false;var r;return function(){if(!c){c=true;r=f.apply(null,arguments);}return r;};};var W2={cached:V2};var X2=function(a,s){for(var i=0;i<a.length;i++){var x=a[i];if(x.test(s))return x;}return undefined;};var Y2=function(a,b){var r=X2(a,b);if(!r)return{major:0,minor:0};var c=function(i){return Number(b.replace(r,'$'+i));};return nu(c(1),c(2));};var Z2=function(v,a){var c=String(a).toLowerCase();if(v.length===0)return $2();return Y2(v,c);};var $2=function(){return nu(0,0);};var nu=function(m,a){return{major:m,minor:a};};var a3={nu:nu,detect:Z2,unknown:$2};var b3='Edge';var c3='Chrome';var ie='IE';var e3='Opera';var f3='Firefox';var g3='Safari';var h3=function(M4,c){return function(){return c===M4;};};var i3=function(){return j3({current:undefined,version:a3.unknown()});};var j3=function(i){var c=i.current;var v=i.version;return{current:c,version:v,isEdge:h3(b3,c),isChrome:h3(c3,c),isIE:h3(ie,c),isOpera:h3(e3,c),isFirefox:h3(f3,c),isSafari:h3(g3,c)};};var k3={unknown:i3,nu:j3,edge:$.constant(b3),chrome:$.constant(c3),ie:$.constant(ie),opera:$.constant(e3),firefox:$.constant(f3),safari:$.constant(g3)};var l3='Windows';var m3='iOS';var n3='Android';var o3='Linux';var p3='OSX';var q3='Solaris';var r3='FreeBSD';var s3=function(M4,c){return function(){return c===M4;};};var t3=function(){return u3({current:undefined,version:a3.unknown()});};var u3=function(i){var c=i.current;var v=i.version;return{current:c,version:v,isWindows:s3(l3,c),isiOS:s3(m3,c),isAndroid:s3(n3,c),isOSX:s3(p3,c),isLinux:s3(o3,c),isSolaris:s3(q3,c),isFreeBSD:s3(r3,c)};};var v3={unknown:t3,nu:u3,windows:$.constant(l3),ios:$.constant(m3),android:$.constant(n3),linux:$.constant(o3),osx:$.constant(p3),solaris:$.constant(q3),freebsd:$.constant(r3)};function w3(o,l4,u){var i=o.isiOS()&&/ipad/i.test(u)===true;var a=o.isiOS()&&!i;var b=o.isAndroid()&&o.version.major===3;var c=o.isAndroid()&&o.version.major===4;var d=i||b||c&&/mobile/i.test(u)===true;var e=o.isiOS()||o.isAndroid();var f=e&&!d;var h=l4.isSafari()&&o.isiOS()&&/safari/i.test(u)===false;return{isiPad:$.constant(i),isiPhone:$.constant(a),isTablet:$.constant(d),isPhone:$.constant(f),isTouch:$.constant(e),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:$.constant(h)};}var x3=function(c,u){var a=String(u).toLowerCase();return F1.find(c,function(b){return b.search(a);});};var y3=function(_3,u){return x3(_3,u).map(function(l4){var v=a3.detect(l4.versionRegexes,u);return{current:l4.name,version:v};});};var z3=function(a4,u){return x3(a4,u).map(function(o){var v=a3.detect(o.versionRegexes,u);return{current:o.name,version:v};});};var A3={detectBrowser:y3,detectOs:z3};var B3=function(s,p){return p+s;};var C3=function(s,a){return s+a;};var D3=function(s,n){return s.substring(n);};var E3=function(s,n){return s.substring(0,s.length-n);};var F3={addToStart:B3,addToEnd:C3,removeFromStart:D3,removeFromEnd:E3};var G3=function(s,c){return s.substr(0,c);};var H3=function(s,c){return s.substr(s.length-c,s.length);};var I3=function(s){return s===''?S.none():S.some(s.substr(0,1));};var J3=function(s){return s===''?S.none():S.some(s.substring(1));};var K3={first:G3,last:H3,head:I3,tail:J3};var L3=function(s,a,b){if(a==='')return true;if(s.length<a.length)return false;var x=s.substr(b,b+a.length);return x===a;};var M3=function(s,o){var i=function(a){var t=typeof a;return t==='string'||t==='number';};return s.replace(/\${([^{}]*)}/g,function(a,b){var O4=o[b];return i(O4)?O4:a;});};var N3=function(s,p){return T3(s,p)?F3.removeFromStart(s,p.length):s;};var O3=function(s,p){return U3(s,p)?F3.removeFromEnd(s,p.length):s;};var P3=function(s,p){return T3(s,p)?s:F3.addToStart(s,p);};var Q3=function(s,p){return U3(s,p)?s:F3.addToEnd(s,p);};var R3=function(s,a){return s.indexOf(a)!==-1;};var S3=function(s){return K3.head(s).bind(function(C1){return K3.tail(s).map(function(J3){return C1.toUpperCase()+J3;});}).getOr(s);};var T3=function(s,p){return L3(s,p,0);};var U3=function(s,a){return L3(s,a,s.length-a.length);};var V3=function(s){return s.replace(/^\s+|\s+$/g,'');};var W3=function(s){return s.replace(/^\s+/g,'');};var X3=function(s){return s.replace(/\s+$/g,'');};var Y3={supplant:M3,startsWith:T3,removeLeading:N3,removeTrailing:O3,ensureLeading:P3,ensureTrailing:Q3,endsWith:U3,contains:R3,trim:V3,lTrim:W3,rTrim:X3,capitalize:S3};var Z3=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;var $3=function(t){return function(u){return Y3.contains(u,t);};};var _3=[{name:'Edge',versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(u){var m=Y3.contains(u,'edge/')&&Y3.contains(u,'chrome')&&Y3.contains(u,'safari')&&Y3.contains(u,'applewebkit');return m;}},{name:'Chrome',versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Z3],search:function(u){return Y3.contains(u,'chrome')&&!Y3.contains(u,'chromeframe');}},{name:'IE',versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(u){return Y3.contains(u,'msie')||Y3.contains(u,'trident');}},{name:'Opera',versionRegexes:[Z3,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:$3('opera')},{name:'Firefox',versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:$3('firefox')},{name:'Safari',versionRegexes:[Z3,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(u){return(Y3.contains(u,'safari')||Y3.contains(u,'mobile/'))&&Y3.contains(u,'applewebkit');}}];var a4=[{name:'Windows',search:$3('win'),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:'iOS',search:function(u){return Y3.contains(u,'iphone')||Y3.contains(u,'ipad');},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:'Android',search:$3('android'),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:'OSX',search:$3('os x'),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:'Linux',search:$3('linux'),versionRegexes:[]},{name:'Solaris',search:$3('sunos'),versionRegexes:[]},{name:'FreeBSD',search:$3('freebsd'),versionRegexes:[]}];var b4={browsers:$.constant(_3),oses:$.constant(a4)};var c4=function(u){var _3=b4.browsers();var a4=b4.oses();var l4=A3.detectBrowser(_3,u).fold(k3.unknown,k3.nu);var o=A3.detectOs(a4,u).fold(v3.unknown,v3.nu);var d=w3(o,l4,u);return{browser:l4,os:o,deviceType:d};};var d4={detect:c4};var e4=W2.cached(function(){var u=navigator.userAgent;return d4.detect(u);});var f4={detect:e4};var eq=function(e,a){return e.dom()===a.dom();};var h4=function(e,a){return e.dom().isEqualNode(a.dom());};var i4=function(e,a){return F1.exists(a,$.curry(eq,e));};var j4=function(e,a){var d=e.dom(),b=a.dom();return d===b?false:d.contains(b);};var k4=function(e,a){return U2.documentPositionContainedBy(e.dom(),a.dom());};var l4=f4.detect().browser;var m4=l4.isIE()?k4:j4;var n4={eq:eq,isEqualNode:h4,member:i4,contains:m4,is:D2.is};var o4=function(e){return v2.fromDom(e.dom().ownerDocument);};var p4=function(e){var d=o4(e);return v2.fromDom(d.dom().documentElement);};var q4=function(e){var a=e.dom();var q4=a.ownerDocument.defaultView;return v2.fromDom(q4);};var r4=function(e){var d=e.dom();return S.from(d.parentNode).map(v2.fromDom);};var s4=function(e){return r4(e).bind(function(p){var k=A4(p);return F1.findIndex(k,function(a){return n4.eq(e,a);});});};var t4=function(e,i){var s=V.isFunction(i)?i:$.constant(false);var d=e.dom();var a=[];while(d.parentNode!==null&&d.parentNode!==undefined){var b=d.parentNode;var r4=v2.fromDom(b);a.push(r4);if(s(r4)===true)break;else d=b;}return a;};var u4=function(e){var f=function(a){return F1.filter(a,function(x){return!n4.eq(e,x);});};return r4(e).map(A4).map(f).getOr([]);};var v4=function(e){var d=e.dom();return S.from(d.offsetParent).map(v2.fromDom);};var w4=function(e){var d=e.dom();return S.from(d.previousSibling).map(v2.fromDom);};var x4=function(e){var d=e.dom();return S.from(d.nextSibling).map(v2.fromDom);};var y4=function(e){return F1.reverse(F2.toArray(e,w4));};var z4=function(e){return F2.toArray(e,x4);};var A4=function(e){var d=e.dom();return F1.map(d.childNodes,v2.fromDom);};var B4=function(e,i){var A4=e.dom().childNodes;return S.from(A4[i]).map(v2.fromDom);};var C4=function(e){return B4(e,0);};var D4=function(e){return B4(e,e.dom().childNodes.length-1);};var E4=function(e){return e.dom().childNodes.length;};var F4=function(e){return e.dom().hasChildNodes();};var G4=Z1.immutable('element','offset');var H4=function(e,o){var c=A4(e);return c.length>0&&o<c.length?G4(c[o],0):G4(e,o);};var I4={owner:o4,defaultView:q4,documentElement:p4,parent:r4,findIndex:s4,parents:t4,siblings:u4,prevSibling:w4,offsetParent:v4,prevSiblings:y4,nextSibling:x4,nextSiblings:z4,children:A4,child:B4,firstChild:C4,lastChild:D4,childNodesCount:E4,hasChildNodes:F4,leaf:H4};var J4=function(s,a){return K4(s,a,$.constant(true));};var K4=function(s,a,p){return F1.bind(I4.children(s),function(x){return D2.is(x,a)?p(x)?[x]:[]:K4(x,a,p);});};var L4={firstLayer:J4,filterFirstLayer:K4};var M4=function(e){var r=e.dom().nodeName;return r.toLowerCase();};var N4=function(e){return e.dom().nodeType;};var O4=function(e){return e.dom().nodeValue;};var P4=function(t){return function(e){return N4(e)===t;};};var Q4=function(e){return N4(e)===w2.COMMENT||M4(e)==='#comment';};var R4=P4(w2.ELEMENT);var S4=P4(w2.TEXT);var T4=P4(w2.DOCUMENT);var U4={name:M4,type:N4,value:O4,isElement:R4,isText:S4,isDocument:T4,isComment:Q4};var V4=function(d,Z5,O4){if(V.isString(O4)||V.isBoolean(O4)||V.isNumber(O4)){d.setAttribute(Z5,O4+'');}else{console.error('Invalid call to Attr.set. Key ',Z5,':: Value ',O4,':: Element ',d);throw new Error('Attribute value was not simple');}};var W4=function(e,Z5,O4){V4(e.dom(),Z5,O4);};var X4=function(e,a){var d=e.dom();P1.each(a,function(v,k){V4(d,k,v);});};var Y4=function(e,Z5){var v=e.dom().getAttribute(Z5);return v===null?undefined:v;};var Z4=function(e,Z5){var d=e.dom();return d&&d.hasAttribute?d.hasAttribute(Z5):false;};var $4=function(e,Z5){e.dom().removeAttribute(Z5);};var _4=function(e){var a=e.dom().attributes;return a===undefined||a===null||a.length===0;};var a5=function(e){return F1.foldl(e.dom().attributes,function(a,T5){a[T5.name]=T5.value;return a;},{});};var b5=function(s,d,T5){if(Z4(s,T5)&&!Z4(d,T5))W4(d,T5,Y4(s,T5));};var c5=function(s,d,a){if(!U4.isElement(s)||!U4.isElement(d))return;F1.each(a,function(T5){b5(s,d,T5);});};var d5={clone:a5,set:W4,setAll:X4,get:Y4,has:Z4,remove:$4,hasNone:_4,transfer:c5};var e5=function(e){var d=U4.isText(e)?e.dom().parentNode:e.dom();return d!==undefined&&d!==null&&d.ownerDocument.body.contains(d);};var f5=W2.cached(function(){return g5(v2.fromDom(document));});var g5=function(d){var f5=d.dom().body;if(f5===null||f5===undefined)throw'Body is not available yet';return v2.fromDom(f5);};var h5={body:f5,getBody:g5,inBody:e5};var i5=function(p){return m5(h5.body(),p);};var j5=function(s,p,i){return F1.filter(I4.parents(s,i),p);};var k5=function(s,p){return F1.filter(I4.siblings(s),p);};var l5=function(s,p){return F1.filter(I4.children(s),p);};var m5=function(s,p){var a=[];F1.each(I4.children(s),function(x){if(p(x)){a=a.concat([x]);}a=a.concat(m5(x,p));});return a;};var n5={all:i5,ancestors:j5,siblings:k5,children:l5,descendants:m5};var o5=function(s){return D2.all(s);};var p5=function(s,a,i){return n5.ancestors(s,function(e){return D2.is(e,a);},i);};var q5=function(s,a){return n5.siblings(s,function(e){return D2.is(e,a);});};var r5=function(s,a){return n5.children(s,function(e){return D2.is(e,a);});};var s5=function(s,a){return D2.all(a,s);};var t5={all:o5,ancestors:p5,siblings:q5,children:r5,descendants:s5};function u5(i,w5,s,a,b){return i(s,a)?S.some(s):V.isFunction(b)&&b(s)?S.none():w5(s,a,b);}var v5=function(p){return A5(h5.body(),p);};var w5=function(s,p,i){var e=s.dom();var a=V.isFunction(i)?i:$.constant(false);while(e.parentNode){e=e.parentNode;var b=v2.fromDom(e);if(p(b))return S.some(b);else if(a(b))break;}return S.none();};var x5=function(s,p,i){var a=function(s){return p(s);};return u5(a,w5,s,p,i);};var y5=function(s,p){var e=s.dom();if(!e.parentNode)return S.none();return z5(v2.fromDom(e.parentNode),function(x){return!n4.eq(s,x)&&p(x);});};var z5=function(s,p){var a=F1.find(s.dom().childNodes,$.compose(p,v2.fromDom));return a.map(v2.fromDom);};var A5=function(s,p){var d=function(e){for(var i=0;i<e.childNodes.length;i++){if(p(v2.fromDom(e.childNodes[i])))return S.some(v2.fromDom(e.childNodes[i]));var a=d(e.childNodes[i]);if(a.isSome())return a;}return S.none();};return d(s.dom());};var B5={first:v5,ancestor:w5,closest:x5,sibling:y5,child:z5,descendant:A5};var C5=function(s){return D2.one(s);};var D5=function(s,a,i){return B5.ancestor(s,function(e){return D2.is(e,a);},i);};var E5=function(s,a){return B5.sibling(s,function(e){return D2.is(e,a);});};var F5=function(s,a){return B5.child(s,function(e){return D2.is(e,a);});};var G5=function(s,a){return D2.one(a,s);};var H5=function(s,a,i){return u5(D2.is,D5,s,a,i);};var I5={first:C5,ancestor:D5,sibling:E5,child:F5,descendant:G5,closest:H5};var J5=function(t,e,_){var i=_!==undefined?_:$.constant(false);if(i(e))return S.none();if(F1.contains(t,U4.name(e)))return S.some(e);var a=function(e){return D2.is(e,'table')||i(e);};return I5.ancestor(e,t.join(','),a);};var K5=function(e,i){return J5(['td','th'],e,i);};var L5=function(w5){return L4.firstLayer(w5,'th,td');};var M5=function(e,i){return J5(['caption','tr','tbody','tfoot','thead'],e,i);};var N5=function(s,e){return I4.parent(e).map(function(r4){return t5.children(r4,s);});};var O5=$.curry(N5,'th,td');var P5=$.curry(N5,'tr');var Q5=function(w5){return I5.descendant(w5,'th,td');};var g=function(e,i){return I5.closest(e,'table',i);};var R5=function(e,i){return J5(['tr'],e,i);};var S5=function(w5){return L4.firstLayer(w5,'tr');};var T5=function(e,p){return parseInt(d5.get(e,p),10);};var U5=function(e,a,c){var S5=T5(e,a);var b=T5(e,c);return p2.grid(S5,b);};var V5={cell:K5,firstCell:Q5,cells:L5,neighbourCells:O5,table:g,row:R5,rows:S5,notCell:M5,neighbourRows:P5,attr:T5,grid:U5};var W5=function(g){var S5=V5.rows(g);return F1.map(S5,function(R5){var e=R5;var r4=I4.parent(e);var p=r4.bind(function(r4){var a=U4.name(r4);return a==='tfoot'||a==='thead'||a==='tbody'?a:'tbody';});var L5=F1.map(V5.cells(R5),function(K5){var a=d5.has(K5,'rowspan')?parseInt(d5.get(K5,'rowspan'),10):1;var c=d5.has(K5,'colspan')?parseInt(d5.get(K5,'colspan'),10):1;return p2.detail(K5,a,c);});return p2.rowdata(e,L5,p);});};var X5=function(S5,e){return F1.map(S5,function(R5){var L5=F1.map(V5.cells(R5),function(K5){var a=d5.has(K5,'rowspan')?parseInt(d5.get(K5,'rowspan'),10):1;var c=d5.has(K5,'colspan')?parseInt(d5.get(K5,'colspan'),10):1;return p2.detail(K5,a,c);});return p2.rowdata(R5,L5,e.section());});};var Y5={fromTable:W5,fromPastedRows:X5};var Z5=function(R5,c){return R5+','+c;};var $5=function(w,R5,c){var a=w.access()[Z5(R5,c)];return a!==undefined?S.some(a):S.none();};var _5=function(w,i,c){var f=a6(w,function(g2){return c(i,g2.element());});return f.length>0?S.some(f[0]):S.none();};var a6=function(w,p){var B2=F1.bind(w.all(),function(r){return r.cells();});return F1.filter(B2,p);};var b6=function(l){var a={};var L5=[];var m=l.length;var b=0;F1.each(l,function(d,r){var e=[];F1.each(d.cells(),function(g2,c){var s=0;while(a[Z5(r,s)]!==undefined){s++;}var f=p2.extended(g2.element(),g2.rowspan(),g2.colspan(),r,s);for(var i=0;i<g2.colspan();i++){for(var j=0;j<g2.rowspan();j++){var h=r+j;var k=s+i;var n=Z5(h,k);a[n]=f;b=Math.max(b,k+1);}}e.push(f);});L5.push(p2.rowdata(d.element(),e,d.section()));});var _1=p2.grid(m,b);return{grid:$.constant(_1),access:$.constant(a),all:$.constant(L5)};};var c6=function(a){var S5=F1.map(a.all(),function(w){return w.cells();});return F1.flatten(S5);};var d6={generate:b6,getAt:$5,findItem:_5,filterItems:a6,justCells:c6};var e6=function(d){return d.style!==undefined;};var f6={isSupported:e6};var g6=function(d,p,O4){if(!V.isString(O4)){console.error('Invalid call to CSS.set. Property ',p,':: Value ',O4,':: Element ',d);throw new Error('CSS value must be a string: '+O4);}if(f6.isSupported(d))d.style.setProperty(p,O4);};var h6=function(d,p){if(f6.isSupported(d))d.style.removeProperty(p);};var i6=function(e,p,O4){var d=e.dom();g6(d,p,O4);};var j6=function(e,gc){var d=e.dom();P1.each(gc,function(v,k){g6(d,k,v);});};var k6=function(e,gc){var d=e.dom();P1.each(gc,function(v,k){v.fold(function(){h6(d,k);},function(O4){g6(d,k,O4);});});};var l6=function(e,p){var d=e.dom();var ic=window.getComputedStyle(d);var r=ic.getPropertyValue(p);var v=r===''&&!h5.inBody(e)?m6(d,p):r;return v===null?undefined:v;};var m6=function(d,p){return f6.isSupported(d)?d.style.getPropertyValue(p):'';};var n6=function(e,p){var d=e.dom();var a=m6(d,p);return S.from(a).filter(function(r){return r.length>0;});};var o6=function(e){var gc={};var d=e.dom();if(f6.isSupported(d)){for(var i=0;i<d.style.length;i++){var a=d.style.item(i);gc[a]=d.style[a];}}return gc;};var p6=function(t,p,O4){var e=v2.fromTag(t);i6(e,p,O4);var s=n6(e,p);return s.isSome();};var q6=function(e,p){var d=e.dom();h6(d,p);if(d5.has(e,'style')&&Y3.trim(d5.get(e,'style'))===''){d5.remove(e,'style');}};var r6=function(e,f){var o=d5.get(e,'style');var a=f(e);var b=o===undefined?d5.remove:d5.set;b(e,'style',o);return a;};var s6=function(s,t){var a=s.dom();var b=t.dom();if(f6.isSupported(a)&&f6.isSupported(b)){b.style.cssText=a.style.cssText;}};var t6=function(e){return e.dom().offsetWidth;};var u6=function(s,d,a){n6(s,a).each(function(O4){if(n6(d,a).isNone())i6(d,a,O4);});};var v6=function(s,d,ic){if(!U4.isElement(s)||!U4.isElement(d))return;F1.each(ic,function(a){u6(s,d,a);});};var w6={copy:s6,set:i6,preserve:r6,setAll:j6,setOptions:k6,remove:q6,get:l6,getRaw:n6,getAllRaw:o6,isValidValue:p6,reflow:t6,transfer:v6};var x6=function(m,e){var r4=I4.parent(m);r4.each(function(v){v.dom().insertBefore(e.dom(),m.dom());});};var y6=function(m,e){var y5=I4.nextSibling(m);y5.fold(function(){var r4=I4.parent(m);r4.each(function(v){A6(v,e);});},function(v){x6(v,e);});};var z6=function(r4,e){var C4=I4.firstChild(r4);C4.fold(function(){A6(r4,e);},function(v){r4.dom().insertBefore(e.dom(),v.dom());});};var A6=function(r4,e){r4.dom().appendChild(e.dom());};var B6=function(r4,e,i){I4.child(r4,i).fold(function(){A6(r4,e);},function(v){x6(v,e);});};var C6=function(e,w){x6(e,w);A6(w,e);};var D6={before:x6,after:y6,prepend:z6,append:A6,appendAt:B6,wrap:C6};var E6=function(m,e){F1.each(e,function(x){D6.before(m,x);});};var F6=function(m,a){F1.each(a,function(x,i){var e=i===0?m:a[i-1];D6.after(e,x);});};var G6=function(r4,e){F1.each(e.slice().reverse(),function(x){D6.prepend(r4,x);});};var H6=function(r4,e){F1.each(e,function(x){D6.append(r4,x);});};var I6={before:E6,after:F6,prepend:G6,append:H6};var J6=function(e){e.dom().textContent='';F1.each(I4.children(e),function(a){K6(a);});};var K6=function(e){var d=e.dom();if(d.parentNode!==null)d.parentNode.removeChild(d);};var L6=function(w){var A4=I4.children(w);if(A4.length>0)I6.before(w,A4);K6(w);};var M6={empty:J6,remove:K6,unwrap:L6};var N6=Z1.immutable('minRow','minCol','maxRow','maxCol');var O6=function(h,i){var t=h.grid().columns();var a=h.grid().rows();var m=a;var b=t;var c=0;var d=0;P1.each(h.access(),function(g2){if(i(g2)){var s=g2.row();var e=s+g2.rowspan()-1;var f=g2.column();var j=f+g2.colspan()-1;if(s<m)m=s;else if(e>c)c=e;if(f<b)b=f;else if(j>d)d=j;}});return N6(m,b,c,d);};var P6=function(l,s,a){var R5=l[a].element();var t=v2.fromTag('td');D6.append(t,v2.fromTag('br'));var f=s?D6.append:D6.prepend;f(R5,t);};var Q6=function(l,h,N6,a){var t=h.grid().columns();var b=h.grid().rows();for(var i=0;i<b;i++){var s=false;for(var j=0;j<t;j++){if(!(i<N6.minRow()||i>N6.maxRow()||j<N6.minCol()||j>N6.maxCol())){var n=d6.getAt(h,i,j).filter(a).isNone();if(n)P6(l,s,i);else s=true;}}}};var R6=function(g,N6){var e=F1.filter(L4.firstLayer(g,'tr'),function(R5){return R5.dom().childElementCount===0;});F1.each(e,M6.remove);if(N6.minCol()===N6.maxCol()||N6.minRow()===N6.maxRow()){F1.each(L4.firstLayer(g,'th,td'),function(K5){d5.remove(K5,'rowspan');d5.remove(K5,'colspan');});}d5.remove(g,'width');d5.remove(g,'height');w6.remove(g,'width');w6.remove(g,'height');};var S6=function(g,O8){var i=function(g2){return D2.is(g2.element(),O8);};var l=Y5.fromTable(g);var h=d6.generate(l);var N6=O6(h,i);var s='th:not('+O8+')'+',td:not('+O8+')';var u=L4.filterFirstLayer(g,'th,td',function(K5){return D2.is(K5,s);});F1.each(u,M6.remove);Q6(l,h,N6,i);R6(g,N6);return g;};var T6={extract:S6};var U6=function(o,W6){return v2.fromDom(o.dom().cloneNode(W6));};var V6=function(o){return U6(o,false);};var W6=function(o){return U6(o,true);};var X6=function(o,t){var n=v2.fromTag(t);var a=d5.clone(o);d5.setAll(n,a);return n;};var Y6=function(o,t){var n=X6(o,t);var c=I4.children(W6(o));I6.append(n,c);return n;};var Z6=function(o,t){var n=X6(o,t);D6.before(o,n);var A4=I4.children(o);I6.append(n,A4);M6.remove(o);return n;};var $6={shallow:V6,shallowAs:X6,deep:W6,copy:Y6,mutate:Z6};function _6(i,M4){var Y4=function(e){if(!i(e))throw new Error('Can only get '+M4+' value of a '+M4+' node');return c7(e).getOr('');};var a=function(c){try{return b(c);}catch(e){return S.none();}};var b=function(e){return i(e)?S.from(e.dom().nodeValue):S.none();};var l4=f4.detect().browser;var c7=l4.isIE()&&l4.version.major===10?a:b;var W4=function(e,O4){if(!i(e))throw new Error('Can only set raw '+M4+' value of a '+M4+' node');e.dom().nodeValue=O4;};return{get:Y4,getOption:c7,set:W4};}var a7=_6(U4.isText,'text');var b7=function(e){return a7.get(e);};var c7=function(e){return a7.getOption(e);};var d7=function(e,O4){a7.set(e,O4);};var e7={get:b7,getOption:c7,set:d7};var f7=function(e){return U4.name(e)==='img'?1:e7.getOption(e).fold(function(){return I4.children(e).length;},function(v){return v.length;});};var g7=function(e,o){return f7(e)===o;};var h7=function(e,o){return o===0;};var i7='\xA0';var j7=function(e){return e7.getOption(e).filter(function(bm){return bm.trim().length!==0||bm.indexOf(i7)>-1;}).isSome();};var k7=['img','br'];var l7=function(e){var h=j7(e);return h||F1.contains(k7,U4.name(e));};var m7={getEnd:f7,isEnd:g7,isStart:h7,isCursorPosition:l7};var n7=function(e){return B5.descendant(e,m7.isCursorPosition);};var o7=function(e){return p7(e,m7.isCursorPosition);};var p7=function(s,p){var d=function(e){var A4=I4.children(e);for(var i=A4.length-1;i>=0;i--){var B4=A4[i];if(p(B4))return S.some(B4);var a=d(B4);if(a.isSome())return a;}return S.none();};return d(s);};var q7={first:n7,last:o7};var r7=function(){var t=v2.fromTag('td');D6.append(t,v2.fromTag('br'));return t;};var s7=function(K5,t,a){var b=$6.copy(K5,t);P1.each(a,function(v,k){if(v===null)d5.remove(b,k);else d5.set(b,k,v);});return b;};var t7=function(c){return c;};var u7=function(d){return function(){return v2.fromTag('tr',d.dom());};};var v7=function(o,n,f){var G3=q7.first(o);return G3.map(function(a){var b=f.join(',');var t4=t5.ancestors(a,b,function(e){return n4.eq(e,o);});return F1.foldr(t4,function(D1,r4){var c=$6.shallow(r4);D6.append(D1,c);return c;},n);}).getOr(n);};var w7=function(Z6,d,f){var n=function(hi){var d=I4.owner(hi.element());var t=v2.fromTag(U4.name(hi.element()),d.dom());var a=f.getOr(['strong','em','b','i','span','font','h1','h2','h3','h4','h5','h6','p','div']);var l=a.length>0?v7(hi.element(),t,a):t;D6.append(l,v2.fromTag('br'));w6.copy(hi.element(),t);w6.remove(t,'height');if(hi.colspan()!==1)w6.remove(hi.element(),'width');Z6(hi.element(),t);return t;};return{row:u7(d),cell:n,replace:s7,gap:r7};};var x7=function(d){return{row:u7(d),cell:r7,replace:t7,gap:r7};};var y7={cellOperations:w7,paste:x7};var z7=function(h,s){var d=s||document;var a=d.createElement('div');a.innerHTML=h;return I4.children(v2.fromDom(a));};var A7=function(t,s){return F1.map(t,function(x){return v2.fromTag(x,s);});};var B7=function(t,s){return F1.map(t,function(x){return v2.fromText(x,s);});};var C7=function(n){return F1.map(n,v2.fromDom);};var D7={fromHtml:z7,fromTags:A7,fromText:B7,fromDom:C7};var E7=['body','p','div','article','aside','figcaption','figure','footer','header','nav','section','ol','ul','li','table','thead','tbody','tfoot','caption','tr','td','th','h1','h2','h3','h4','h5','h6','blockquote','pre','address'];function F7(){var a5=function(e){return v2.fromDom(e.dom().cloneNode(false));};var i=function(e){if(!U4.isElement(e))return false;if(U4.name(e)==='body')return true;return F1.contains(E7,U4.name(e));};var $a=function(e){if(!U4.isElement(e))return false;return F1.contains(['br','img','hr','input'],U4.name(e));};var c=function(e,o){return e.dom().compareDocumentPosition(o.dom());};var a=function(s,d){var b=d5.clone(s);d5.setAll(d,b);};return{up:$.constant({selector:I5.ancestor,closest:I5.closest,predicate:B5.ancestor,all:I4.parents}),down:$.constant({selector:t5.descendants,predicate:n5.descendants}),styles:$.constant({get:w6.get,getRaw:w6.getRaw,set:w6.set,remove:w6.remove}),attrs:$.constant({get:d5.get,set:d5.set,remove:d5.remove,copyTo:a}),insert:$.constant({before:D6.before,after:D6.after,afterAll:I6.after,append:D6.append,appendAll:I6.append,prepend:D6.prepend,wrap:D6.wrap}),remove:$.constant({unwrap:M6.unwrap,remove:M6.remove}),create:$.constant({nu:v2.fromTag,clone:a5,text:v2.fromText}),query:$.constant({comparePosition:c,prevSibling:I4.prevSibling,nextSibling:I4.nextSibling}),property:$.constant({children:I4.children,name:U4.name,parent:I4.parent,isText:U4.isText,isComment:U4.isComment,isElement:U4.isElement,getText:e7.get,setText:e7.set,isBoundary:i,isEmptyTag:$a}),eq:n4.eq,is:n4.is};}var G7=Z1.immutable('left','right');var H7=function(b8,r4,B4){var A4=b8.property().children(r4);var i=F1.findIndex(A4,$.curry(b8.eq,B4));return i.map(function(a){return{before:$.constant(A4.slice(0,a)),after:$.constant(A4.slice(a+1))};});};var I7=function(b8,r4,B4){return H7(b8,r4,B4).map(function(p){var s=b8.create().clone(r4);b8.insert().appendAll(s,p.after());b8.insert().after(r4,s);return G7(r4,s);});};var J7=function(b8,r4,B4){return H7(b8,r4,B4).map(function(p){var a=b8.create().clone(r4);b8.insert().appendAll(a,p.before().concat([B4]));b8.insert().appendAll(r4,p.after());b8.insert().before(r4,a);return G7(a,r4);});};var K7=function(b8,i,a,b){var c=Z1.immutable('first','second','splits');var gi=function(B4,d,s){var f=c(B4,S.none(),s);if(a(B4))return c(B4,d,s);else{return b8.property().parent(B4).bind(function(r4){return b(b8,r4,B4).map(function(e){var h=[{first:e.left,second:e.right}];var n=a(r4)?r4:e.left();return gi(n,S.some(e.right()),s.concat(h));}).getOr(f);});}};return gi(i,S.none(),[]);};var L7={breakToLeft:J7,breakToRight:I7,breakPath:K7};var M7=function(b8,l,e,f){var C1=e[0];var J3=e.slice(1);return f(b8,l,C1,J3);};var N7=function(b8,l,e){return e.length>0?M7(b8,l,e,O7):S.none();};var O7=function(b8,l,C1,J3){var s=l(b8,C1);return F1.foldr(J3,function(b,a){var c=l(b8,a);return P7(b8,b,c);},s);};var P7=function(b8,a,e){return a.bind(function(s){return e.filter($.curry(b8.eq,s));});};var Q7={oneAll:N7};var R7=function(b8,i){return $.curry(b8.eq,i);};var S7=function(b8,c,p,a){var A4=b8.property().children(c);if(b8.eq(c,p[0]))return S.some([p[0]]);if(b8.eq(c,a[0]))return S.some([a[0]]);var f=function(b){var t=F1.reverse(b);var i=F1.findIndex(t,R7(b8,c)).getOr(-1);var d=i<t.length-1?t[i+1]:t[i];return F1.findIndex(A4,R7(b8,d));};var s=f(p);var e=f(a);return s.bind(function(i){return e.map(function(b){var G3=Math.min(i,b);var D1=Math.max(i,b);return A4.slice(G3,D1+1);});});};var T7=function(b8,s,e,_){var i=_!==undefined?_:$.constant(false);var p=[s].concat(b8.up().all(s));var a=[e].concat(b8.up().all(e));var Ge=function(H2){var f=F1.findIndex(H2,i);return f.fold(function(){return H2;},function(h){return H2.slice(0,h+1);});};var b=Ge(p);var c=Ge(a);var d=F1.find(b,function(x){return F1.exists(c,R7(b8,x));});return{firstpath:$.constant(b),secondpath:$.constant(c),shared:$.constant(d)};};var U7=function(b8,s,e){var a=T7(b8,s,e);return a.shared().bind(function(b){return S7(b8,b,a.firstpath(),a.secondpath());});};var V7={subset:U7,ancestors:T7};var W7=function(b8,l,e){return Q7.oneAll(b8,l,e);};var X7=function(b8,s,f){return V7.subset(b8,s,f);};var Y7=function(b8,s,f,_){return V7.ancestors(b8,s,f,_);};var Z7=function(b8,r4,B4){return L7.breakToLeft(b8,r4,B4);};var $7=function(b8,r4,B4){return L7.breakToRight(b8,r4,B4);};var _7=function(b8,B4,i,b){return L7.breakPath(b8,B4,i,b);};var a8={sharedOne:W7,subset:X7,ancestors:Y7,breakToLeft:Z7,breakToRight:$7,breakPath:_7};var b8=F7();var c8=function(l,e){return a8.sharedOne(b8,function(b8,a){return l(a);},e);};var d8=function(s,f){return a8.subset(b8,s,f);};var e8=function(s,f,_){return a8.ancestors(b8,s,f,_);};var f8=function(r4,B4){return a8.breakToLeft(b8,r4,B4);};var g8=function(r4,B4){return a8.breakToRight(b8,r4,B4);};var h8=function(B4,i,b){return a8.breakPath(b8,B4,i,function(u,p,c){return b(p,c);});};var i8={sharedOne:c8,subset:d8,ancestors:e8,breakToLeft:f8,breakToRight:g8,breakPath:h8};var j8=function(o2,g2){var l=g2.column();var a=g2.column()+g2.colspan()-1;var t=g2.row();var b=g2.row()+g2.rowspan()-1;return l<=o2.finishCol()&&a>=o2.startCol()&&(t<=o2.finishRow()&&b>=o2.startRow());};var k8=function(o2,g2){return g2.column()>=o2.startCol()&&g2.column()+g2.colspan()-1<=o2.finishCol()&&g2.row()>=o2.startRow()&&g2.row()+g2.rowspan()-1<=o2.finishRow();};var l8=function(w,o2){var a=true;var d=$.curry(k8,o2);for(var i=o2.startRow();i<=o2.finishRow();i++){for(var j=o2.startCol();j<=o2.finishCol();j++){a=a&&d6.getAt(w,i,j).exists(d);}}return a?S.some(o2):S.none();};var m8={inSelection:j8,isWithin:k8,isRectangular:l8};var n8=function(d,a){return p2.bounds(Math.min(d.row(),a.row()),Math.min(d.column(),a.column()),Math.max(d.row()+d.rowspan()-1,a.row()+a.rowspan()-1),Math.max(d.column()+d.colspan()-1,a.column()+a.colspan()-1));};var o8=function(w,s,f){var a=d6.findItem(w,s,n4.eq);var b=d6.findItem(w,f,n4.eq);return a.bind(function(c){return b.map(function(d){return n8(c,d);});});};var p8=function(w,s,f){return o8(w,s,f).bind(function(o2){return m8.isRectangular(w,o2);});};var q8={getAnyBox:o8,getBox:p8};var r8=function(w,K5,R5,c){return d6.findItem(w,K5,n4.eq).bind(function(g2){var s=R5>0?g2.row()+g2.rowspan()-1:g2.row();var a=c>0?g2.column()+g2.colspan()-1:g2.column();var b=d6.getAt(w,s+R5,a+c);return b.map(function(d){return d.element();});});};var s8=function(w,s,f){return q8.getAnyBox(w,s,f).map(function(o2){var i=d6.filterItems(w,$.curry(m8.inSelection,o2));return F1.map(i,function(g2){return g2.element();});});};var t8=function(w,i){var a=function(c,b){return n4.contains(b,c);};return d6.findItem(w,i,a).bind(function(g2){return g2.element();});};var u8={moveBy:r8,intercepts:s8,parentCell:t8};var v8=function(K5,d,a){return V5.table(K5).bind(function(g){var w=z8(g);return u8.moveBy(w,K5,d,a);});};var w8=function(g,G3,D1){var w=z8(g);return u8.intercepts(w,G3,D1);};var x8=function(g,G3,f,D1,l){var w=z8(g);var s=n4.eq(g,f)?G3:u8.parentCell(w,G3);var a=n4.eq(g,l)?D1:u8.parentCell(w,D1);return u8.intercepts(w,s,a);};var y8=function(g,G3,D1){var w=z8(g);return q8.getBox(w,G3,D1);};var z8=function(g){var l=Y5.fromTable(g);return d6.generate(l);};var A8={moveBy:v8,intercepts:w8,nestedIntercepts:x8,getBox:y8};var B8=function(c,i){return I5.ancestor(c,'table');};var C8=Z1.immutableBag(['boxes','start','finish'],[]);var D8=function(s,f,i){var nf=function(a){return function(e){return i(e)||n4.eq(e,a);};};if(n4.eq(s,f)){return S.some(C8({boxes:S.some([s]),start:s,finish:f}));}else{return B8(s,i).bind(function(a){return B8(f,i).bind(function(b){if(n4.eq(a,b)){return S.some(C8({boxes:A8.intercepts(a,s,f),start:s,finish:f}));}else if(n4.contains(a,b)){var c=t5.ancestors(f,'td,th',nf(a));var d=c.length>0?c[c.length-1]:f;return S.some(C8({boxes:A8.nestedIntercepts(a,s,a,f,b),start:s,finish:d}));}else if(n4.contains(b,a)){var c=t5.ancestors(s,'td,th',nf(b));var e=c.length>0?c[c.length-1]:s;return S.some(C8({boxes:A8.nestedIntercepts(b,s,a,f,b),start:s,finish:e}));}else{return i8.ancestors(s,f).shared().bind(function(l){return I5.closest(l,'table',i).bind(function(h){var j=t5.ancestors(f,'td,th',nf(h));var d=j.length>0?j[j.length-1]:f;var k=t5.ancestors(s,'td,th',nf(h));var e=k.length>0?k[k.length-1]:s;return S.some(C8({boxes:A8.nestedIntercepts(h,s,a,f,b),start:e,finish:d}));});});}});});}};var E8=function(c,s){var a=t5.descendants(c,s);return a.length>0?S.some(a):S.none();};var F8=function(b,T8){return F1.find(b,function(a){return D2.is(a,T8);});};var G8=function(c,R8,T8){return I5.descendant(c,R8).bind(function(G3){return I5.descendant(c,T8).bind(function(D1){return i8.sharedOne(B8,[G3,D1]).map(function(t){return{first:$.constant(G3),last:$.constant(D1),table:$.constant(t)};});});});};var H8=function(f,R8){return I5.ancestor(f,'table').bind(function(g){return I5.descendant(g,R8).bind(function(s){return D8(s,f).bind(function(C8){return C8.boxes().map(function(b){return{boxes:$.constant(b),start:$.constant(C8.start()),finish:$.constant(C8.finish())};});});});});};var I8=function(b,d,a,R8,T8){return F8(b,T8).bind(function(D1){return A8.moveBy(D1,d,a).bind(function(f){return H8(f,R8);});});};var J8={identify:D8,retrieve:E8,shiftSelection:I8,getEdges:G8};var K8=function(c,s){return J8.retrieve(c,s);};var L8=function(c,R8,T8){return J8.getEdges(c,R8,T8).bind(function(e){var i=function(w5){return n4.eq(c,w5);};var f=I5.ancestor(e.first(),'thead,tfoot,tbody,table',i);var l=I5.ancestor(e.last(),'thead,tfoot,tbody,table',i);return f.bind(function(a){return l.bind(function(b){return n4.eq(a,b)?A8.getBox(e.table(),e.first(),e.last()):S.none();});});});};var M8={retrieve:K8,retrieveBox:L8};var N8='data-mce-selected';var O8='td['+N8+'],th['+N8+']';var P8='['+N8+']';var Q8='data-mce-first-selected';var R8='td['+Q8+'],th['+Q8+']';var S8='data-mce-last-selected';var T8='td['+S8+'],th['+S8+']';var U8={selected:$.constant(N8),selectedSelector:$.constant(O8),attributeSelector:$.constant(P8),firstSelected:$.constant(Q8),firstSelectedSelector:$.constant(R8),lastSelected:$.constant(S8),lastSelectedSelector:$.constant(T8)};var V8=function(c){if(!V.isArray(c)){throw new Error('cases must be an array');}if(c.length===0){throw new Error('there must be at least one case');}var a=[];var ji={};F1.each(c,function(b,d){var G1=P1.keys(b);if(G1.length!==1){throw new Error('one and only one name per case');}var Z5=G1[0];var O4=b[Z5];if(ji[Z5]!==undefined){throw new Error('duplicate key detected:'+Z5);}else if(Z5==='cata'){throw new Error('cannot have a case named cata (sorry)');}else if(!V.isArray(O4)){throw new Error('case arguments must be an array');}a.push(Z5);ji[Z5]=function(){var e=arguments.length;if(e!==O4.length){throw new Error('Wrong number of arguments to case '+Z5+'. Expected '+O4.length+' ('+O4+'), got '+e);}var f=new Array(e);for(var i=0;i<f.length;i++)f[i]=arguments[i];var m=function(h){var j=P1.keys(h);if(a.length!==j.length){throw new Error('Wrong number of arguments to match. Expected: '+a.join(',')+'\nActual: '+j.join(','));}var k=F1.forall(a,function(l){return F1.contains(j,l);});if(!k)throw new Error('Not all branches were specified when using match. Specified: '+j.join(', ')+'\nRequired: '+a.join(', '));return h[Z5].apply(null,f);};return{fold:function(){if(arguments.length!==c.length){throw new Error('Wrong number of arguments to fold. Expected '+c.length+', got '+arguments.length);}var t=arguments[d];return t.apply(null,f);},match:m,log:function(l){console.log(l,{constructors:a,constructor:Z5,params:f});}};};});return ji;};var W8={generate:V8};var X8=W8.generate([{none:[]},{multiple:['elements']},{single:['selection']}]);var Y8=function(s,o,a,b){return s.fold(o,a,b);};var Z8={cata:Y8,none:X8.none,multiple:X8.multiple,single:X8.single};var $8=function(K5,s){return Z8.cata(s.get(),$.constant([]),$.identity,$.constant([K5]));};var _8=function(K5,s){var h=function(e){return d5.has(e,'rowspan')&&parseInt(d5.get(e,'rowspan'),10)>1||d5.has(e,'colspan')&&parseInt(d5.get(e,'colspan'),10)>1;};var c=$8(K5,s);return c.length>0&&F1.forall(c,h)?S.some(c):S.none();};var a9=function(g,s){return Z8.cata(s.get(),S.none,function(L5,_){if(L5.length===0){return S.none();}return M8.retrieveBox(g,U8.firstSelectedSelector(),U8.lastSelectedSelector()).bind(function(o2){return L5.length>1?S.some({bounds:$.constant(o2),cells:$.constant(L5)}):S.none();});},S.none);};var b9={mergable:a9,unmergable:_8,selection:$8};var c9=function(K5){return{element:$.constant(K5),mergable:S.none,unmergable:S.none,selection:$.constant([K5])};};var d9=function(s,g,K5){return{element:$.constant(K5),mergable:$.constant(b9.mergable(g,s)),unmergable:$.constant(b9.unmergable(K5,s)),selection:$.constant(b9.selection(K5,s))};};var e9=function(e){return c9(e);};var f9=Z1.immutable('element','clipboard','generators');var g9=function(s,g,K5,c,a){return{element:$.constant(K5),mergable:S.none,unmergable:S.none,selection:$.constant(b9.selection(K5,s)),clipboard:$.constant(c),generators:$.constant(a)};};var h9={noMenu:c9,forMenu:d9,notCell:e9,paste:f9,pasteRows:g9};var i9=function(L5){return V5.table(L5[0]).map($6.deep).map(function(a){return[T6.extract(a,U8.attributeSelector())];});};var j9=function(e,a){return e.selection.serializer.serialize(a.dom(),{});};var k9=function(a,s,b,c){a.on('BeforeGetContent',function(e){var m=function(L5){e.preventDefault();i9(L5).each(function(d){e.content=F1.map(d,function(f){return j9(a,f);}).join('');});};if(e.selection===true){Z8.cata(s.get(),$.noop,m,$.noop);}});a.on('BeforeSetContent',function(e){if(e.selection===true&&e.paste===true){var d=S.from(a.dom.getParent(a.selection.getStart(),'th,td'));d.each(function(f){var K5=v2.fromDom(f);var g=V5.table(K5);g.bind(function(g){var h=F1.filter(D7.fromHtml(e.content),function(k){return U4.name(k)!=='meta';});if(h.length===1&&U4.name(h[0])==='table'){e.preventDefault();var i=v2.fromDom(a.getDoc());var j=y7.paste(i);var t=h9.paste(K5,h[0],j);b.pasteCells(g,t).each(function(k){a.selection.setRng(k);a.focus();c.clear(g);});}});});}});};var l9={registerEvents:k9};function m9(M4,a){var W4=function(e,h){if(!V.isNumber(h)&&!h.match(/^[0-9]+$/))throw M4+'.set accepts only positive integer values. Value was '+h;var d=e.dom();if(f6.isSupported(d))d.style[M4]=h+'px';};var Y4=function(e){var r=a(e);if(r<=0||r===null){var gc=w6.get(e,M4);return parseFloat(gc)||0;}return r;};var q9=Y4;var b=function(e,p){return F1.foldl(p,function(c,d){var v=w6.get(e,d);var O4=v===undefined?0:parseInt(v,10);return isNaN(O4)?c:c+O4;},0);};var m=function(e,O4,p){var c=b(e,p);var d=O4>c?O4-c:0;return d;};return{set:W4,get:Y4,getOuter:q9,aggregate:b,max:m};}var n9=m9('height',function(e){return h5.inBody(e)?e.dom().getBoundingClientRect().height:e.dom().offsetHeight;});var o9=function(e,h){n9.set(e,h);};var p9=function(e){return n9.get(e);};var q9=function(e){return n9.getOuter(e);};var r9=function(e,O4){var i=['margin-top','border-top-width','padding-top','padding-bottom','border-bottom-width','margin-bottom'];var a=n9.max(e,O4,i);w6.set(e,'max-height',a+'px');};var s9={set:o9,get:p9,getOuter:q9,setMax:r9};var t9=m9('width',function(e){return e.dom().offsetWidth;});var u9=function(e,h){t9.set(e,h);};var v9=function(e){return t9.get(e);};var w9=function(e){return t9.getOuter(e);};var x9=function(e,O4){var i=['margin-left','border-left-width','padding-left','padding-right','border-right-width','margin-right'];var a=t9.max(e,O4,i);w6.set(e,'max-width',a+'px');};var y9={set:u9,get:v9,getOuter:w9,setMax:x9};var z9=f4.detect();var A9=function(){return z9.browser.isIE()||z9.browser.isEdge();};var B9=function(p,f){var n=parseFloat(p);return isNaN(n)?f:n;};var C9=function(e,M4,f){return B9(w6.get(e,M4),f);};var D9=function(K5){var p=C9(K5,'padding-top',0);var a=C9(K5,'padding-bottom',0);var b=C9(K5,'border-top-width',0);var c=C9(K5,'border-bottom-width',0);var Aa=K5.dom().getBoundingClientRect().height;var d=w6.get(K5,'box-sizing');var e=b+c;return d==='border-box'?Aa:Aa-p-a-e;};var E9=function(K5){return C9(K5,'width',y9.get(K5));};var F9=function(K5){return A9()?D9(K5):C9(K5,'height',s9.get(K5));};var G9={getWidth:E9,getHeight:F9};var H9=/(\d+(\.\d+)?)(\w|%)*/;var I9=/(\d+(\.\d+)?)%/;var J9=/(\d+(\.\d+)?)px|em/;var K9=function(K5,a){w6.set(K5,'width',a+'px');};var L9=function(K5,a){w6.set(K5,'width',a+'%');};var M9=function(K5,a){w6.set(K5,'height',a+'px');};var N9=function(K5){return w6.getRaw(K5,'height').getOrThunk(function(){return G9.getHeight(K5)+'px';});};var O9=function(K5,n,a,s){var b=V5.table(K5).map(function(g){var pe=a(g);return Math.floor(n/100*pe);}).getOr(n);s(K5,b);return b;};var P9=function(O4,K5,a,s){var n=parseInt(O4,10);return Y3.endsWith(O4,'%')&&U4.name(K5)!=='table'?O9(K5,n,a,s):n;};var Q9=function(K5){var O4=N9(K5);if(!O4)return s9.get(K5);return P9(O4,K5,s9.get,M9);};var R9=function(K5,N4,f){var v=f(K5);var s=S9(K5,N4);return v/s;};var S9=function(K5,N4){return d5.has(K5,N4)?parseInt(d5.get(K5,N4),10):1;};var T9=function(e){var c=w6.getRaw(e,'width');return c.fold(function(){return S.from(d5.get(e,'width'));},function(w){return S.some(w);});};var U9=function(c,t){return c/t.pixelWidth()*100;};var V9=function(e,w,t){if(I9.test(w)){var p=I9.exec(w);return parseFloat(p[1]);}else{var f=y9.get(e);var i=parseInt(f,10);return U9(i,t);}};var W9=function(K5,t){var w=T9(K5);return w.fold(function(){var w=y9.get(K5);var i=parseInt(w,10);return U9(i,t);},function(w){return V9(K5,w,t);});};var X9=function(c,t){return c/100*t.pixelWidth();};var Y9=function(e,w,t){if(J9.test(w)){var p=J9.exec(w);return parseInt(p[1],10);}else if(I9.test(w)){var a=I9.exec(w);var f=parseFloat(a[1]);return X9(f,t);}else{var b=y9.get(e);return parseInt(b,10);}};var Z9=function(K5,t){var w=T9(K5);return w.fold(function(){var w=y9.get(K5);var i=parseInt(w,10);return i;},function(w){return Y9(K5,w,t);});};var $9=function(K5){return R9(K5,'rowspan',Q9);};var _9=function(K5){var w=T9(K5);return w.bind(function(w){if(H9.test(w)){var m=H9.exec(w);return S.some({width:$.constant(m[1]),unit:$.constant(m[3])});}else{return S.none();}});};var ba=function(K5,a,u){w6.set(K5,'width',a+u);};var ca={percentageBasedSizeRegex:$.constant(I9),pixelBasedSizeRegex:$.constant(J9),setPixelWidth:K9,setPercentageWidth:L9,setHeight:M9,getPixelWidth:Z9,getPercentageWidth:W9,getGenericWidth:_9,setGenericWidth:ba,getHeight:$9,getRawWidth:T9};var da=function(m,o){var w=ca.getGenericWidth(m);w.each(function(w){var n=w.width()/2;ca.setGenericWidth(m,n,w.unit());ca.setGenericWidth(o,n,w.unit());});};var ea={halve:da};var ga=function(e,s){var d=s||v2.fromDom(document.documentElement);return B5.ancestor(e,$.curry(n4.eq,d)).isSome();};var ha=function(e){var d=e.dom();if(d===d.window)return e;return U4.isDocument(e)?d.defaultView||d.parentWindow:null;};var ia={attached:ga,windowOf:ha};var r=function(Qd,t){var Nk=function(x,y){return r(Qd+x,t+y);};return{left:$.constant(Qd),top:$.constant(t),translate:Nk};};var ja=function(d){var b=d.getBoundingClientRect();return r(b.left,b.top);};var ka=function(a,b){return a!==undefined?a:b!==undefined?b:0;};var la=function(e){var d=e.dom().ownerDocument;var f5=d.body;var w=ia.windowOf(v2.fromDom(d));var h=d.documentElement;var s=ka(w.pageYOffset,h.scrollTop);var a=ka(w.pageXOffset,h.scrollLeft);var c=ka(h.clientTop,f5.clientTop);var b=ka(h.clientLeft,f5.clientLeft);return na(e).translate(a-b,s-c);};var ma=function(e){var d=e.dom();return r(d.offsetLeft,d.offsetTop);};var na=function(e){var d=e.dom();var a=d.ownerDocument;var f5=a.body;var h=v2.fromDom(a.documentElement);if(f5===d)return r(f5.offsetLeft,f5.offsetTop);if(!ia.attached(e,h))return r(0,0);return ja(d);};var oa={absolute:la,relative:ma,viewport:na};var pa=Z1.immutable('row','y');var qa=Z1.immutable('col','x');var ra=function(K5){var p=oa.absolute(K5);return p.left()+y9.getOuter(K5);};var sa=function(K5){return oa.absolute(K5).left();};var ta=function(i,K5){return qa(i,sa(K5));};var ua=function(i,K5){return qa(i,ra(K5));};var va=function(K5){return oa.absolute(K5).top();};var wa=function(i,K5){return pa(i,va(K5));};var xa=function(i,K5){return pa(i,va(K5)+s9.getOuter(K5));};var ya=function(a,b,c){if(c.length===0)return[];var l=F1.map(c.slice(1),function(e,i){return e.map(function(K5){return a(i,K5);});});var d=c[c.length-1].map(function(K5){return b(c.length-1,K5);});return l.concat([d]);};var za=function(J2,_){return-J2;};var Aa={delta:$.identity,positions:$.curry(ya,wa,xa),edge:va};var Ba={delta:$.identity,edge:sa,positions:$.curry(ya,ta,ua)};var Ca={delta:za,edge:ra,positions:$.curry(ya,ua,ta)};var Da={height:Aa,rtl:Ca,ltr:Ba};var Ea={ltr:Da.ltr,rtl:Da.rtl};function Fa(wf){var a=function(g){return wf(g).isRtl()?Ea.rtl:Ea.ltr;};var $l=function(b,g){return a(g).delta(b,g);};var p=function(c,g){return a(g).positions(c,g);};var b3=function(K5){return a(K5).edge(K5);};return{delta:$l,edge:b3,positions:p};}var Ga=function(g){var i=Y5.fromTable(g);var w=d6.generate(i);return w.grid();};var Ha={getGridSize:Ga};var Ia=function(i){var O4=i;var Y4=function(){return O4;};var W4=function(v){O4=v;};var a5=function(){return Ia(Y4());};return{get:Y4,set:W4,clone:a5};};var Ja=function(h,a){return Ka(h,a,{validate:V.isFunction,label:'function'});};var Ka=function(h,a,p){if(a.length===0)throw new Error('You must specify at least one required field.');X1.validateStrArr('required',a);X1.checkDupes(a);return function(o){var G1=P1.keys(o);var b=F1.forall(a,function(c){return F1.contains(G1,c);});if(!b)X1.reqMessage(a,G1);h(a,G1);var i=F1.filter(a,function(Z5){return!p.validate(o[Z5],Z5);});if(i.length>0)X1.invalidTypeMessage(i,p.label);return o;};};var La=function(a,G1){var u=F1.filter(G1,function(Z5){return!F1.contains(a,Z5);});if(u.length>0)X1.unsuppMessage(u);};var Ma=$.noop;var Na={exactly:$.curry(Ja,La),ensure:$.curry(Ja,Ma),ensureWith:$.curry(Ka,Ma)};var Oa=function(e){var c=d5.has(e,'colspan')?parseInt(d5.get(e,'colspan'),10):1;var a=d5.has(e,'rowspan')?parseInt(d5.get(e,'rowspan'),10):1;return{element:$.constant(e),colspan:$.constant(c),rowspan:$.constant(a)};};var Pa=function(a,_){Sa(a);var b=Ia(S.none());var t=_!==undefined?_:Oa;var n=function(f){return a.cell(f);};var c=function(f){var h=t(f);return n(h);};var nc=function(f){var h=c(f);if(b.get().isNone())b.set(S.some(h));d=S.some({item:f,replacement:h});return h;};var d=S.none();var e=function(f,h){return d.fold(function(){return nc(f);},function(p){return h(f,p.item)?p.replacement:nc(f);});};return{getOrInit:e,cursor:b.get};};var Qa=function(s,t){return function(a){var b=Ia(S.none());Sa(a);var l=[];var o1=function(e,d){return F1.find(l,function(x){return d(x.item,e);});};var m=function(e){var K5=a.replace(e,t,{scope:s});l.push({item:e,sub:K5});if(b.get().isNone())b.set(S.some(K5));return K5;};var c=function(e,d){return o1(e,d).fold(function(){return m(e);},function(p){return d(e,p.item)?p.sub:m(e);});};return{replaceOrInit:c,cursor:b.get};};};var Ra=function(a){Sa(a);var p=Ia(S.none());var c=function(K5){if(p.get().isNone())p.set(S.some(K5));return function(){var b=a.cell({element:$.constant(K5),colspan:$.constant(1),rowspan:$.constant(1)});w6.remove(b,'width');w6.remove(K5,'width');return b;};};return{combine:c,cursor:p.get};};var Sa=Na.exactly(['cell','row','replace','gap']);var Ta={modification:Pa,transform:Qa,merging:Ra};var Ua=['body','p','div','article','aside','figcaption','figure','footer','header','nav','section','ol','ul','table','thead','tfoot','tbody','caption','tr','td','th','h1','h2','h3','h4','h5','h6','blockquote','pre','address'];var Va=function(b8,i){var t=b8.property().name(i);return F1.contains(['ol','ul'],t);};var Wa=function(b8,i){var t=b8.property().name(i);return F1.contains(Ua,t);};var Xa=function(b8,i){var t=b8.property().name(i);return F1.contains(['address','pre','p','h1','h2','h3','h4','h5','h6'],t);};var Ya=function(b8,i){var t=b8.property().name(i);return F1.contains(['h1','h2','h3','h4','h5','h6'],t);};var Za=function(b8,i){return F1.contains(['div','li','td','th','blockquote','body','caption'],b8.property().name(i));};var $a=function(b8,i){return F1.contains(['br','img','hr','input'],b8.property().name(i));};var _a=function(b8,i){return b8.property().name(i)==='iframe';};var ab=function(b8,i){return!(Wa(b8,i)||$a(b8,i))&&b8.property().name(i)!=='li';};var bb={isBlock:Wa,isList:Va,isFormatting:Xa,isHeading:Ya,isContainer:Za,isEmptyTag:$a,isFrame:_a,isInline:ab};var cb=F7();var db=function(e){return bb.isBlock(cb,e);};var eb=function(e){return bb.isList(cb,e);};var gb=function(e){return bb.isFormatting(cb,e);};var hb=function(e){return bb.isHeading(cb,e);};var ib=function(e){return bb.isContainer(cb,e);};var jb=function(e){return bb.isEmptyTag(cb,e);};var kb=function(e){return bb.isFrame(cb,e);};var lb=function(e){return bb.isInline(cb,e);};var mb={isBlock:db,isList:eb,isFormatting:gb,isHeading:hb,isContainer:ib,isEmptyTag:jb,isFrame:kb,isInline:lb};var nb=function(L5){var lm=function(e){return U4.name(e)==='br';};var a=function(A4){return F1.forall(A4,function(c){return lm(c)||U4.isText(c)&&e7.get(c).trim().length===0;});};var i=function(e){return U4.name(e)==='li'||B5.ancestor(e,mb.isList).isSome();};var s=function(e){return I4.nextSibling(e).map(function(c){if(mb.isBlock(c))return true;if(mb.isEmptyTag(c)){return U4.name(c)==='img'?false:true;}}).getOr(false);};var m=function(K5){return q7.last(K5).bind(function(c){var e=s(c);return I4.parent(c).map(function(r4){return e===true||i(r4)||lm(c)||mb.isBlock(r4)&&!n4.eq(K5,r4)?[]:[v2.fromTag('br')];});}).getOr([]);};var b=function(){var c=F1.bind(L5,function(K5){var A4=I4.children(K5);return a(A4)?[]:A4.concat(m(K5));});return c.length===0?[v2.fromTag('br')]:c;};var d=b();M6.empty(L5[0]);I6.append(L5[0],d);};var ob={merge:nb};var pb=function(o,n){return n;};var qb=function(o,n){var b=V.isObject(o)&&V.isObject(n);return b?sb(o,n):n;};var rb=function(m){return function(){var o=new Array(arguments.length);for(var i=0;i<o.length;i++)o[i]=arguments[i];if(o.length===0)throw new Error('Can\'t merge zero objects');var a={};for(var j=0;j<o.length;j++){var c=o[j];for(var Z5 in c)if(c.hasOwnProperty(Z5)){a[Z5]=m(a[Z5],c[Z5]);}}return a;};};var sb=rb(qb);var ub=rb(pb);var vb={deepMerge:sb,merge:ub};var wb=function(a){var r=[];var r1=function(x){r.push(x);};for(var i=0;i<a.length;i++){a[i].each(r1);}return r;};var xb=function(a,f){for(var i=0;i<a.length;i++){var r=f(a[i],i);if(r.isSome()){return r;}}return S.none();};var yb=function(a,f){var r=[];for(var i=0;i<a.length;i++){var x=a[i];if(x.isSome()){r.push(x.getOrDie());}else{return S.none();}}return S.some(f.apply(null,r));};var zb={cat:wb,findMap:xb,liftN:yb};var Ab=function(a,i,K5){var L5=a.cells();var x6=L5.slice(0,i);var y6=L5.slice(i);var n=x6.concat([K5]).concat(y6);return Cb(a,n);};var Bb=function(a,i,K5){var L5=a.cells();L5[i]=K5;};var Cb=function(a,L5){return p2.rowcells(L5,a.section());};var Db=function(a,f){var L5=a.cells();var r=F1.map(L5,f);return p2.rowcells(r,a.section());};var Eb=function(a,i){return a.cells()[i];};var Fb=function(a,i){return Eb(a,i).element();};var Gb=function(a){return a.cells().length;};var Hb={addCell:Ab,setCells:Cb,mutateCell:Bb,getCell:Eb,getCellElement:Fb,mapCells:Db,cellLength:Gb};var Ib=function(_1,i){return F1.map(_1,function(R5){return Hb.getCell(R5,i);});};var Jb=function(_1,i){return _1[i];};var Kb=function(a,c){if(a.length===0)return 0;var G3=a[0];var i=F1.findIndex(a,function(x){return!c(G3.element(),x.element());});return i.fold(function(){return a.length;},function(b){return b;});};var Lb=function(_1,R5,c,a){var b=Jb(_1,R5).cells().slice(c);var e=Kb(b,a);var d=Ib(_1,c).slice(R5);var f=Kb(d,a);return{colspan:$.constant(e),rowspan:$.constant(f)};};var Mb={subgrid:Lb};var Nb=function(_1,a){var s=F1.map(_1,function(R5,b){return F1.map(R5.cells(),function(bc,c){return false;});});var u=function(b,d,e,f){for(var r=b;r<b+e;r++){for(var c=d;c<d+f;c++){s[r][c]=true;}}};return F1.map(_1,function(R5,b){var d=F1.bind(R5.cells(),function(K5,c){if(s[b][c]===false){var e=Mb.subgrid(_1,b,c,a);u(b,c,e.rowspan(),e.colspan());return[p2.detailnew(K5.element(),e.rowspan(),e.colspan(),K5.isNew())];}else{return[];}});return p2.rowdetails(d,R5.section());});};var Ob=function(w,a,b){var _1=[];for(var i=0;i<w.grid().rows();i++){var c=[];for(var j=0;j<w.grid().columns();j++){var e=d6.getAt(w,i,j).map(function(d){return p2.elementnew(d.element(),b);}).getOrThunk(function(){return p2.elementnew(a.gap(),true);});c.push(e);}var R5=p2.rowcells(c,w.all()[i].section());_1.push(R5);}return _1;};var Pb={toDetails:Nb,toGrid:Ob};var Qb=function(e,p,O4,i){if(O4===i)d5.remove(e,p);else d5.set(e,p,O4);};var Rb=function(g,_1){var n=[];var a=[];var b=function(i,s){var j=I5.child(g,s).getOrThunk(function(){var t=v2.fromTag(s,I4.owner(g).dom());D6.append(g,t);return t;});M6.empty(j);var S5=F1.map(i,function(R5){if(R5.isNew()){n.push(R5.element());}var t=R5.element();M6.empty(t);F1.each(R5.cells(),function(K5){if(K5.isNew()){a.push(K5.element());}Qb(K5.element(),'colspan',K5.colspan(),1);Qb(K5.element(),'rowspan',K5.rowspan(),1);D6.append(t,K5.element());});return t;});I6.append(j,S5);};var c=function(s){I5.child(g,s).bind(M6.remove);};var d=function(i,s){if(i.length>0){b(i,s);}else{c(s);}};var h=[];var e=[];var f=[];F1.each(_1,function(R5){switch(R5.section()){case'thead':h.push(R5);break;case'tbody':e.push(R5);break;case'tfoot':f.push(R5);break;}});d(h,'thead');d(e,'tbody');d(f,'tfoot');return{newRows:$.constant(n),newCells:$.constant(a)};};var Sb=function(_1){var S5=F1.map(_1,function(R5){var t=$6.shallow(R5.element());F1.each(R5.cells(),function(K5){var c=$6.deep(K5.element());Qb(c,'colspan',K5.colspan(),1);Qb(c,'rowspan',K5.rowspan(),1);D6.append(t,c);});return t;});return S5;};var Tb={render:Rb,copy:Sb};var Ub=function(a,f){var r=[];for(var i=0;i<a;i++){r.push(f(i));}return r;};var Vb=function(s,e){var r=[];for(var i=s;i<e;i++){r.push(i);}return r;};var Wb=function(a,c){var b=[];F1.each(a,function(x,i){if(i<a.length-1&&!c(x,a[i+1])){b.push(x);}else if(i===a.length-1){b.push(x);}});return b;};var Xb=function(x,b){if(b<0||b>=x.length-1)return S.none();var d=x[b].fold(function(){var c=F1.reverse(x.slice(0,b));return zb.findMap(c,function(a,i){return a.map(function(e){return{value:e,delta:i+1};});});},function(c){return S.some({value:c,delta:0});});var gi=x[b+1].fold(function(){var c=x.slice(b+1);return zb.findMap(c,function(a,i){return a.map(function(e){return{value:e,delta:i+1};});});},function(n){return S.some({value:n,delta:1});});return d.bind(function(c){return gi.map(function(n){var e=n.delta+c.delta;return Math.abs(n.value-c.value)/e;});});};var Yb={repeat:Ub,range:Vb,unique:Wb,deduce:Xb};var Zb=function(w){var _1=w.grid();var c=Yb.range(0,_1.columns());var S5=Yb.range(0,_1.rows());return F1.map(c,function(bc){var a=function(){return F1.bind(S5,function(r){return d6.getAt(w,r,bc).filter(function(g2){return g2.column()===bc;}).fold($.constant([]),function(g2){return[g2];});});};var i=function(g2){return g2.colspan()===1;};var b=function(){return d6.getAt(w,0,bc);};return $b(a,i,b);});};var $b=function(a,i,b){var c=a();var s=F1.find(c,i);var d=s.orThunk(function(){return S.from(c[0]).orThunk(b);});return d.map(function(g2){return g2.element();});};var _b=function(w){var _1=w.grid();var S5=Yb.range(0,_1.rows());var a=Yb.range(0,_1.columns());return F1.map(S5,function(R5){var b=function(){return F1.bind(a,function(c){return d6.getAt(w,R5,c).filter(function(g2){return g2.row()===R5;}).fold($.constant([]),function(g2){return[g2];});});};var i=function(g2){return g2.rowspan()===1;};var d=function(){return d6.getAt(w,R5,0);};return $b(b,i,d);});};var ac={columns:Zb,rows:_b};var bc=function(c,x,y,w,h){var b=v2.fromTag('div');w6.setAll(b,{position:'absolute',left:x-w/2+'px',top:y+'px',height:h+'px',width:w+'px'});d5.setAll(b,{'data-column':c,'role':'presentation'});return b;};var dc=function(R5,x,y,w,h){var b=v2.fromTag('div');w6.setAll(b,{position:'absolute',left:x+'px',top:y-h/2+'px',height:h+'px',width:w+'px'});d5.setAll(b,{'data-row':R5,'role':'presentation'});return b;};var ec={col:bc,row:dc};var gc=function(L2){var d=L2.replace(/\./g,'-');var I2=function(s){return d+'-'+s;};return{resolve:I2};};var hc={css:gc};var ic=hc.css('ephox-snooker');var jc={resolve:ic.resolve};function kc(t,a,i){var b=i||false;var o=function(){a();b=true;};var c=function(){t();b=false;};var wc=function(){var f=b?c:o;f();};var d=function(){return b;};return{on:o,off:c,toggle:wc,isOn:d};}var mc=function(e,T5){var O4=d5.get(e,T5);return O4===undefined||O4===''?[]:O4.split(' ');};var nc=function(e,T5,i){var o=mc(e,T5);var n=o.concat([i]);d5.set(e,T5,n.join(' '));};var oc=function(e,T5,i){var n=F1.filter(mc(e,T5),function(v){return v!==i;});if(n.length>0)d5.set(e,T5,n.join(' '));else d5.remove(e,T5);};var pc={read:mc,add:nc,remove:oc};var qc=function(e){return e.dom().classList!==undefined;};var tc=function(e){return pc.read(e,'class');};var uc=function(e,c){return pc.add(e,'class',c);};var vc=function(e,c){return pc.remove(e,'class',c);};var wc=function(e,c){if(F1.contains(tc(e),c)){vc(e,c);}else{uc(e,c);}};var xc={get:tc,add:uc,remove:vc,toggle:wc,supports:qc};var yc=function(e,c){if(xc.supports(e))e.dom().classList.add(c);else xc.add(e,c);};var zc=function(e){var c=xc.supports(e)?e.dom().classList:xc.get(e);if(c.length===0){d5.remove(e,'class');}};var Ac=function(e,c){if(xc.supports(e)){var a=e.dom().classList;a.remove(c);}else xc.remove(e,c);zc(e);};var Bc=function(e,c){return xc.supports(e)?e.dom().classList.toggle(c):xc.toggle(e,c);};var Cc=function(e,c){var h=xc.supports(e);var a=e.dom().classList;var o=function(){if(h)a.remove(c);else xc.remove(e,c);};var b=function(){if(h)a.add(c);else xc.add(e,c);};return kc(o,b,Dc(e,c));};var Dc=function(e,c){return xc.supports(e)&&e.dom().classList.contains(c);};var Ec={add:yc,remove:Ac,toggle:Bc,toggler:Cc,has:Dc};var Fc=jc.resolve('resizer-bar');var Gc=jc.resolve('resizer-rows');var Hc=jc.resolve('resizer-cols');var Ic=7;var Jc=function(w){var p=t5.descendants(w.parent(),'.'+Fc);F1.each(p,M6.remove);};var Kc=function(w,p,$g){var o=w.origin();F1.each(p,function(c,i){c.each(function(a){var b=$g(o,a);Ec.add(b,Fc);D6.append(w.parent(),b);});});};var Lc=function(w,c,p,t){Kc(w,c,function(o,a){var b=ec.col(a.col(),a.x()-o.left(),p.top()-o.top(),Ic,t);Ec.add(b,Hc);return b;});};var Mc=function(w,a,p,t){Kc(w,a,function(o,c){var b=ec.row(c.row(),p.left()-o.left(),c.y()-o.top(),t,Ic);Ec.add(b,Gc);return b;});};var Nc=function(w,g,S5,c,h,v){var p=oa.absolute(g);var a=S5.length>0?h.positions(S5,g):[];Mc(w,a,p,y9.getOuter(g));var b=c.length>0?v.positions(c,g):[];Lc(w,b,p,s9.getOuter(g));};var Oc=function(w,g,h,v){Jc(w);var l=Y5.fromTable(g);var a=d6.generate(l);var S5=ac.rows(a);var c=ac.columns(a);Nc(w,g,S5,c,h,v);};var Pc=function(w,f){var b=t5.descendants(w.parent(),'.'+Fc);F1.each(b,f);};var Qc=function(w){Pc(w,function(b){w6.set(b,'display','none');});};var Rc=function(w){Pc(w,function(b){w6.set(b,'display','block');});};var Sc=function(e){return Ec.has(e,Gc);};var Tc=function(e){return Ec.has(e,Hc);};var Uc={refresh:Oc,hide:Qc,show:Rc,destroy:Jc,isRowBar:Sc,isColBar:Tc};var Vc=function(w,a){return Pb.toGrid(w,a,false);};var Wc=function(a,b){var f=function(d){var c=zb.findMap(d,function(g2){return I4.parent(g2.element()).map(function(R5){var i=I4.parent(R5).isNone();return p2.elementnew(R5,i);});});return c.getOrThunk(function(){return p2.elementnew(b.row(),true);});};return F1.map(a,function(d){var R5=f(d.details());return p2.rowdatanew(R5.element(),d.details(),d.section(),R5.isNew());});};var Xc=function(_1,a){var b=Pb.toDetails(_1,n4.eq);return Wc(b,a);};var Yc=function(w,a){var B2=F1.flatten(F1.map(w.all(),function(r){return r.cells();}));return F1.find(B2,function(e){return n4.eq(a,e.element());});};var Zc=function(o,S6,a,p,b){return function(w,g,t,c,d){var i=Y5.fromTable(g);var e=d6.generate(i);var f=S6(e,t).map(function(h){var m=Vc(e,c);var j=o(m,h,n4.eq,b(c));var _1=Xc(j.grid(),c);return{grid:$.constant(_1),cursor:j.cursor};});return f.fold(function(){return S.none();},function(h){var n=Tb.render(g,h.grid());a(g,h.grid(),d);p(g);Uc.refresh(w,g,Da.height,d);return S.some({cursor:h.cursor,newRows:n.newRows,newCells:n.newCells});});};};var $c=function(w,t){return V5.cell(t.element()).bind(function(K5){return Yc(w,K5);});};var _c=function(w,t){return V5.cell(t.element()).bind(function(K5){return Yc(w,K5).map(function(d){return vb.merge(d,{generators:t.generators,clipboard:t.clipboard});});});};var ad=function(w,t){var d=F1.map(t.selection(),function(K5){return V5.cell(K5).bind(function(l){return Yc(w,l);});});var L5=zb.cat(d);return L5.length>0?S.some(vb.merge({cells:L5},{generators:t.generators,clipboard:t.clipboard})):S.none();};var bd=function(w,t){return t.mergable();};var cd=function(w,t){return t.unmergable();};var dd=function(w,t){var d=F1.map(t.selection(),function(K5){return V5.cell(K5).bind(function(l){return Yc(w,l);});});var L5=zb.cat(d);return L5.length>0?S.some(L5):S.none();};var ed={run:Zc,toDetailList:Xc,onCell:$c,onCells:dd,onPaste:_c,onPasteRows:ad,onMergable:bd,onUnmergable:cd};var fd=function(o){var i=function(v){return o===v;};var a=function(d){return fd(o);};var b=function(f){return fd(o);};var g1=function(f){return fd(f(o));};var h1=function(f){f(o);};var t1=function(f){return f(o);};var c=function(_,d){return d(o);};var Z=function(f){return f(o);};var u1=function(f){return f(o);};var t=function(){return S.some(o);};return{is:i,isValue:$.always,isError:$.never,getOr:$.constant(o),getOrThunk:$.constant(o),getOrDie:$.constant(o),or:a,orThunk:b,fold:c,map:g1,each:h1,bind:t1,exists:Z,forall:u1,toOption:t};};var gd=function(m){var a=function(f){return f();};var O2=function(){return $.die(String(m))();};var o=function(d){return d;};var b=function(f){return f();};var g1=function(f){return gd(m);};var t1=function(f){return gd(m);};var c=function(d,_){return d(m);};return{is:$.never,isValue:$.never,isError:$.always,getOr:$.identity,getOrThunk:a,getOrDie:O2,or:o,orThunk:b,fold:c,map:g1,each:$.noop,bind:t1,exists:$.never,forall:$.always,toOption:S.none};};var hd={value:fd,error:gd};var jd=function(s,a,b){if(s.row()>=a.length||s.column()>Hb.cellLength(a[0]))return hd.error('invalid start address out of table bounds, row: '+s.row()+', column: '+s.column());var c=a.slice(s.row());var d=c[0].cells().slice(s.column());var e=Hb.cellLength(b[0]);var f=b.length;return hd.value({rowDelta:$.constant(c.length-f),colDelta:$.constant(d.length-e)});};var kd=function(a,b){var c=Hb.cellLength(a[0]);var d=Hb.cellLength(b[0]);return{rowDelta:$.constant(0),colDelta:$.constant(c-d)};};var ld=function(L5,a){return F1.map(L5,function(){return p2.elementnew(a.cell(),true);});};var md=function(_1,a,b){return _1.concat(Yb.repeat(a,function(_){return Hb.setCells(_1[_1.length-1],ld(_1[_1.length-1].cells(),b));}));};var nd=function(_1,a,b){return F1.map(_1,function(R5){return Hb.setCells(R5,R5.cells().concat(ld(Yb.range(0,a),b)));});};var od=function(a,$l,b){var f=$l.colDelta()<0?nd:$.identity;var c=$l.rowDelta()<0?md:$.identity;var m=f(a,Math.abs($l.colDelta()),b);var t=c(m,Math.abs($l.rowDelta()),b);return t;};var pd={measure:jd,measureWidth:kd,tailor:od};var qd=function(_1,o2,c,s){if(_1.length===0)return _1;for(var i=o2.startRow();i<=o2.finishRow();i++){for(var j=o2.startCol();j<=o2.finishCol();j++){Hb.mutateCell(_1[i],j,p2.elementnew(s(),false));}}return _1;};var rd=function(_1,t,c,s){var G3=true;for(var i=0;i<_1.length;i++){for(var j=0;j<Hb.cellLength(_1[0]);j++){var a=Hb.getCellElement(_1[i],j);var b=c(a,t);if(b===true&&G3===false){Hb.mutateCell(_1[i],j,p2.elementnew(s(),true));}else if(b===true){G3=false;}}}return _1;};var sd=function(R5,c){return F1.foldl(R5,function(a,K5){return F1.exists(a,function(b){return c(b.element(),K5.element());})?a:a.concat([K5]);},[]);};var ud=function(_1,a,c,s){if(a>0&&a<_1.length){var b=_1[a-1].cells();var L5=sd(b,c);F1.each(L5,function(K5){var d=S.none();for(var i=a;i<_1.length;i++){for(var j=0;j<Hb.cellLength(_1[0]);j++){var e=_1[i].cells()[j];var f=c(e.element(),K5.element());if(f){if(d.isNone()){d=S.some(s());}d.each(function(h){Hb.mutateCell(_1[i],j,p2.elementnew(h,true));});}}}});}return _1;};var vd={merge:qd,unmerge:rd,splitRows:ud};var wd=function(_1,R5,bc,c){var a=Hb.getCell(_1[R5],bc);var m=$.curry(c,a.element());var b=_1[R5];return _1.length>1&&Hb.cellLength(b)>1&&(bc>0&&m(Hb.getCellElement(b,bc-1))||bc<b.length-1&&m(Hb.getCellElement(b,bc+1))||R5>0&&m(Hb.getCellElement(_1[R5-1],bc))||R5<_1.length-1&&m(Hb.getCellElement(_1[R5+1],bc)));};var xd=function(s,a,b,d,e){var f=s.row();var h=s.column();var m=b.length;var i=Hb.cellLength(b[0]);var j=f+m;var k=h+i;for(var r=f;r<j;r++){for(var c=h;c<k;c++){if(wd(a,r,c,e)){vd.unmerge(a,Hb.getCellElement(a[r],c),e,d.cell);}var n=Hb.getCellElement(b[r-f],c-h);var l=d.replace(n);Hb.mutateCell(a[r],c,p2.elementnew(l,true));}}return a;};var yd=function(s,a,b,c,d){var e=pd.measure(s,a,b);return e.map(function($l){var f=pd.tailor(a,$l,c);return xd(s,f,b,c,d);});};var zd=function(i,a,b,c,d){vd.splitRows(a,i,d,c.cell);var $l=pd.measureWidth(b,a);var f=pd.tailor(b,$l,c);var s=pd.measureWidth(a,f);var e=pd.tailor(a,s,c);return e.slice(0,i).concat(f).concat(e.slice(i,e.length));};var Ad={merge:yd,insert:zd};var Bd=function(_1,i,e,a,s){var x6=_1.slice(0,i);var y6=_1.slice(i);var b=Hb.mapCells(_1[e],function(d,c){var w=i>0&&i<_1.length&&a(Hb.getCellElement(_1[i-1],c),Hb.getCellElement(_1[i],c));var f=w?Hb.getCell(_1[i],c):p2.elementnew(s(d.element(),a),true);return f;});return x6.concat([b]).concat(y6);};var Cd=function(_1,i,e,c,s){return F1.map(_1,function(R5){var w=i>0&&i<Hb.cellLength(R5)&&c(Hb.getCellElement(R5,i-1),Hb.getCellElement(R5,i));var a=w?Hb.getCell(R5,i):p2.elementnew(s(Hb.getCellElement(R5,e),c),true);return Hb.addCell(R5,i,a);});};var Dd=function(_1,e,a,c,s){var b=a+1;return F1.map(_1,function(R5,i){var d=i===e;var f=d?p2.elementnew(s(Hb.getCellElement(R5,a),c),true):Hb.getCell(R5,a);return Hb.addCell(R5,b,f);});};var Ed=function(_1,e,a,c,s){var b=e+1;var x6=_1.slice(0,b);var y6=_1.slice(b);var d=Hb.mapCells(_1[e],function(f,i){var h=i===a;return h?p2.elementnew(s(f.element(),c),true):f;});return x6.concat([d]).concat(y6);};var Fd=function(_1,s,f){var S5=F1.map(_1,function(R5){var L5=R5.cells().slice(0,s).concat(R5.cells().slice(f+1));return p2.rowcells(L5,R5.section());});return F1.filter(S5,function(R5){return R5.cells().length>0;});};var Gd=function(_1,s,f){return _1.slice(0,s).concat(_1.slice(f+1));};var Hd={insertRowAt:Bd,insertColumnAt:Cd,splitCellIntoColumns:Dd,splitCellIntoRows:Ed,deleteRowsAt:Gd,deleteColumnsAt:Fd};var Id=function(_1,t,c,s){var i=function(K5){return F1.exists(t,function(a){return c(K5.element(),a.element());});};return F1.map(_1,function(R5){return Hb.mapCells(R5,function(K5){return i(K5)?p2.elementnew(s(K5.element(),c),true):K5;});});};var Jd=function(_1,a,c,b){return Hb.getCellElement(_1[a],c)!==undefined&&(a>0&&b(Hb.getCellElement(_1[a-1],c),Hb.getCellElement(_1[a],c)));};var Kd=function(R5,i,c){return i>0&&c(Hb.getCellElement(R5,i-1),Hb.getCellElement(R5,i));};var Ld=function(_1,a,c,s){var t=F1.bind(_1,function(R5,i){var b=Jd(_1,i,a,c)||Kd(R5,a,c);return b?[]:[Hb.getCell(R5,a)];});return Id(_1,t,c,s);};var Md=function(_1,a,c,s){var t=_1[a];var b=F1.bind(t.cells(),function(d,i){var e=Jd(_1,a,i,c)||Kd(t,i,c);return e?[]:[d];});return Id(_1,b,c,s);};var Nd={replaceColumn:Ld,replaceRow:Md};var Od=function(){return Td(function(n,o,l,m,r){return n();});};var Pd=function(i){return Td(function(n,o,l,m,r){return o(i);});};var Qd=function(i,gi){return Td(function(n,o,l,m,r){return l(i,gi);});};var Rd=function(hi,i,gi){return Td(function(n,o,l,m,r){return m(hi,i,gi);});};var Sd=function(hi,i){return Td(function(n,o,l,m,r){return r(hi,i);});};var Td=function(f){return{fold:f};};var Ud={none:Od,only:Pd,left:Qd,middle:Rd,right:Sd};var Vd=function(i,a){if(i.length===0)return Ud.none();if(i.length===1)return Ud.only(0);if(a===0)return Ud.left(0,1);if(a===i.length-1)return Ud.right(a-1,a);if(a>0&&a<i.length-1)return Ud.middle(a-1,a,a+1);return Ud.none();};var Wd=function(i,c,J2,t){var a=i.slice(0);var b=Vd(i,c);var d=function(l){return F1.map(l,$.constant(0));};var o=$.constant(d(a));var e=function(l){return t.singleColumnWidth(a[l],J2);};var f=function(l,gi){if(J2>=0){var n=Math.max(t.minCellWidth(),a[gi]-J2);return d(a.slice(0,l)).concat([J2,n-a[gi]]).concat(d(a.slice(gi+1)));}else{var m=Math.max(t.minCellWidth(),a[l]+J2);var p=a[l]-m;return d(a.slice(0,l)).concat([m-a[l],p]).concat(d(a.slice(gi+1)));}};var h=f;var j=function(hi,l,gi){return f(l,gi);};var k=function(hi,l){if(J2>=0){return d(a.slice(0,l)).concat([J2]);}else{var O1=Math.max(t.minCellWidth(),a[l]+J2);return d(a.slice(0,l)).concat([O1-a[l]]);}};return b.fold(o,e,h,j,k);};var Xd={determine:Wd};var Yd=function(K5,N4){return d5.has(K5,N4)&&parseInt(d5.get(K5,N4),10)>1;};var Zd=function(K5){return Yd(K5,'colspan');};var $d=function(K5){return Yd(K5,'rowspan');};var _d=function(e,p){return parseInt(w6.get(e,p),10);};var ae={hasColspan:Zd,hasRowspan:$d,minWidth:$.constant(10),minHeight:$.constant(10),getInt:_d};var be=function(K5,p,a){return w6.getRaw(K5,p).fold(function(){return a(K5)+'px';},function(b){return b;});};var ce=function(K5){return be(K5,'width',ca.getPixelWidth);};var de=function(K5){return be(K5,'height',ca.getHeight);};var ee=function(w,d,E9,f,t){var Zb=ac.columns(w);var b=F1.map(Zb,function(c){return c.map(d.edge);});return F1.map(Zb,function(a,c){var e=a.filter($.not(ae.hasColspan));return e.fold(function(){var h=Yb.deduce(b,c);return f(h);},function(K5){return E9(K5,t);});});};var fe=function(a){return a.map(function(d){return d+'px';}).getOr('');};var ge=function(w,d){return ee(w,d,ce,fe);};var he=function(w,d,t){return ee(w,d,ca.getPercentageWidth,function(a){return a.fold(function(){return t.minCellWidth();},function(c){return c/t.pixelWidth()*100;});},t);};var je=function(w,d,t){return ee(w,d,ca.getPixelWidth,function(a){return a.getOrThunk(t.minCellWidth);},t);};var ke=function(w,d,F9,f){var S5=ac.rows(w);var b=F1.map(S5,function(c){return c.map(d.edge);});return F1.map(S5,function(a,c){var e=a.filter($.not(ae.hasRowspan));return e.fold(function(){var h=Yb.deduce(b,c);return f(h);},function(K5){return F9(K5);});});};var le=function(w,d){return ke(w,d,ca.getHeight,function(a){return a.getOrThunk(ae.minHeight);});};var ne=function(w,d){return ke(w,d,de,fe);};var oe={getRawWidths:ge,getPixelWidths:je,getPercentageWidths:he,getPixelHeights:le,getRawHeights:ne};var pe=function(s,e,m){var r=0;for(var i=s;i<e;i++){r+=m[i]!==undefined?m[i]:0;}return r;};var qe=function(w,a){var B2=d6.justCells(w);return F1.map(B2,function(K5){var b=pe(K5.column(),K5.column()+K5.colspan(),a);return{element:K5.element,width:$.constant(b),colspan:K5.colspan};});};var re=function(w,h){var B2=d6.justCells(w);return F1.map(B2,function(K5){var Aa=pe(K5.row(),K5.row()+K5.rowspan(),h);return{element:K5.element,height:$.constant(Aa),rowspan:K5.rowspan};});};var se=function(w,h){return F1.map(w.all(),function(R5,i){return{element:R5.element,height:$.constant(h[i])};});};var te={recalculateWidth:qe,recalculateHeight:re,matchRowHeight:se};var ue=function(w,e){var f=parseFloat(w);var p=y9.get(e);var a=function($l){return $l/p*100;};var s=function(w,_){return[100-w];};var m=function(){return ae.minWidth()/p*100;};var b=function(g,_,$l){var pe=f+$l;ca.setPercentageWidth(g,pe);};return{width:$.constant(f),pixelWidth:$.constant(p),getWidths:oe.getPercentageWidths,getCellDelta:a,singleColumnWidth:s,minCellWidth:m,setElementWidth:ca.setPercentageWidth,setTableWidth:b};};var ve=function(w){var i=parseInt(w,10);var c=$.identity;var s=function(w,$l){var n=Math.max(ae.minWidth(),w+$l);return[n-w];};var d=function(g,n,_){var pe=F1.foldr(n,function(b,a){return b+a;},0);ca.setPixelWidth(g,pe);};return{width:$.constant(i),pixelWidth:$.constant(i),getWidths:oe.getPixelWidths,getCellDelta:c,singleColumnWidth:s,minCellWidth:ae.minWidth,setElementWidth:ca.setPixelWidth,setTableWidth:d};};var we=function(e,w){if(ca.percentageBasedSizeRegex().test(w)){var p=ca.percentageBasedSizeRegex().exec(w);return ue(p[1],e);}else if(ca.pixelBasedSizeRegex().test(w)){var a=ca.pixelBasedSizeRegex().exec(w);return ve(a[1]);}else{var f=y9.get(e);return ve(f);}};var xe=function(e){var w=ca.getRawWidth(e);return w.fold(function(){var f=y9.get(e);return ve(f);},function(w){return we(e,w);});};var ye={getTableSize:xe};var ze=function(l){return d6.generate(l);};var Ae=function(n){return F1.foldr(n,function(b,a){return b+a;},0);};var Be=function(g){var l=Y5.fromTable(g);return ze(l);};var Ce=function(g,$l,a,d){var t=ye.getTableSize(g);var J2=t.getCellDelta($l);var w=Be(g);var b=t.getWidths(w,d,t);var c=Xd.determine(b,a,J2,t);var n=F1.map(c,function(f,i){return f+b[i];});var e=te.recalculateWidth(w,n);F1.each(e,function(K5){t.setElementWidth(K5.element(),K5.width());});if(a===w.grid().columns()-1){t.setTableWidth(g,n,J2);}};var De=function(g,$l,a,d){var w=Be(g);var h=oe.getPixelHeights(w,d);var n=F1.map(h,function(e,i){return a===i?Math.max($l+e,ae.minHeight()):e;});var b=te.recalculateHeight(w,n);var c=te.matchRowHeight(w,n);F1.each(c,function(R5){ca.setHeight(R5.element(),R5.height());});F1.each(b,function(K5){ca.setHeight(K5.element(),K5.height());});var pe=Ae(n);ca.setHeight(g,pe);};var Ee=function(g,l,d){var t=ye.getTableSize(g);var w=ze(l);var c=t.getWidths(w,d,t);var n=te.recalculateWidth(w,c);F1.each(n,function(K5){t.setElementWidth(K5.element(),K5.width());});var pe=F1.foldr(c,function(b,a){return a+b;},0);if(n.length>0){t.setElementWidth(g,pe);}};var Fe={adjustWidth:Ce,adjustHeight:De,adjustWidthTo:Ee};var Ge=function(g){var L5=V5.cells(g);if(L5.length===0)M6.remove(g);};var He=Z1.immutable('grid','cursor');var Ie=function(_1,R5,c){return Je(_1,R5,c).orThunk(function(){return Je(_1,0,0);});};var Je=function(_1,R5,a){return S.from(_1[R5]).bind(function(r){return S.from(r.cells()[a]).bind(function(c){return S.from(c.element());});});};var Ke=function(_1,R5,c){return He(_1,Je(_1,R5,c));};var Le=function(d){return F1.foldl(d,function(a,g2){return F1.exists(a,function(c){return c.row()===g2.row();})?a:a.concat([g2]);},[]).sort(function(a,b){return a.row()-b.row();});};var Me=function(d){return F1.foldl(d,function(a,g2){return F1.exists(a,function(c){return c.column()===g2.column();})?a:a.concat([g2]);},[]).sort(function(a,b){return a.column()-b.column();});};var Ne=function(_1,g2,c,a){var e=g2.row();var t=g2.row();var n=Hd.insertRowAt(_1,t,e,c,a.getOrInit);return Ke(n,t,g2.column());};var Oe=function(_1,d,c,a){var e=d[0].row();var t=d[0].row();var S5=Le(d);var n=F1.foldl(S5,function(n,_){return Hd.insertRowAt(n,t,e,c,a.getOrInit);},_1);return Ke(n,t,d[0].column());};var Pe=function(_1,g2,c,a){var e=g2.row();var t=g2.row()+g2.rowspan();var n=Hd.insertRowAt(_1,t,e,c,a.getOrInit);return Ke(n,t,g2.column());};var Qe=function(_1,d,c,a){var S5=Le(d);var e=S5[S5.length-1].row();var t=S5[S5.length-1].row()+S5[S5.length-1].rowspan();var n=F1.foldl(S5,function(n,_){return Hd.insertRowAt(n,t,e,c,a.getOrInit);},_1);return Ke(n,t,d[0].column());};var Re=function(_1,g2,c,a){var e=g2.column();var t=g2.column();var n=Hd.insertColumnAt(_1,t,e,c,a.getOrInit);return Ke(n,g2.row(),t);};var Se=function(_1,d,c,a){var Zb=Me(d);var e=Zb[0].column();var t=Zb[0].column();var n=F1.foldl(Zb,function(n,_){return Hd.insertColumnAt(n,t,e,c,a.getOrInit);},_1);return Ke(n,d[0].row(),t);};var Te=function(_1,g2,c,a){var e=g2.column();var t=g2.column()+g2.colspan();var n=Hd.insertColumnAt(_1,t,e,c,a.getOrInit);return Ke(n,g2.row(),t);};var Ue=function(_1,d,c,a){var e=d[d.length-1].column();var t=d[d.length-1].column()+d[d.length-1].colspan();var Zb=Me(d);var n=F1.foldl(Zb,function(n,_){return Hd.insertColumnAt(n,t,e,c,a.getOrInit);},_1);return Ke(n,d[0].row(),t);};var Ve=function(_1,g2,c,a){var n=Nd.replaceRow(_1,g2.row(),c,a.replaceOrInit);return Ke(n,g2.row(),g2.column());};var We=function(_1,g2,c,a){var n=Nd.replaceColumn(_1,g2.column(),c,a.replaceOrInit);return Ke(n,g2.row(),g2.column());};var Xe=function(_1,g2,c,a){var n=Nd.replaceRow(_1,g2.row(),c,a.replaceOrInit);return Ke(n,g2.row(),g2.column());};var Ye=function(_1,g2,c,a){var n=Nd.replaceColumn(_1,g2.column(),c,a.replaceOrInit);return Ke(n,g2.row(),g2.column());};var Ze=function(_1,g2,c,a){var n=Hd.splitCellIntoColumns(_1,g2.row(),g2.column(),c,a.getOrInit);return Ke(n,g2.row(),g2.column());};var $e=function(_1,g2,c,a){var n=Hd.splitCellIntoRows(_1,g2.row(),g2.column(),c,a.getOrInit);return Ke(n,g2.row(),g2.column());};var _e=function(_1,d,c,_){var Zb=Me(d);var n=Hd.deleteColumnsAt(_1,Zb[0].column(),Zb[Zb.length-1].column());var a=Ie(n,d[0].row(),d[0].column());return He(n,a);};var af=function(_1,d,c,_){var S5=Le(d);var n=Hd.deleteRowsAt(_1,S5[0].row(),S5[S5.length-1].row());var a=Ie(n,d[0].row(),d[0].column());return He(n,a);};var bf=function(_1,a9,c,_){var L5=a9.cells();ob.merge(L5);var n=vd.merge(_1,a9.bounds(),c,$.constant(L5[0]));return He(n,S.from(L5[0]));};var cf=function(_1,_8,c,a){var n=F1.foldr(_8,function(b,K5){return vd.unmerge(b,K5,c,a.combine(K5));},_1);return He(n,S.from(_8[0]));};var df=function(_1,p,c,a){var b=function(g,e){var l=Y5.fromTable(g);var w=d6.generate(l);return Pb.toGrid(w,e,true);};var d=b(p.clipboard(),p.generators());var s=p2.address(p.row(),p.column());var m=Ad.merge(s,_1,d,p.generators(),c);return m.fold(function(){return He(_1,S.some(p.element()));},function(n){var e=Ie(n,p.row(),p.column());return He(n,e);});};var ef=function(S5,a,e){var p=Y5.fromPastedRows(S5,e);var w=d6.generate(p);return Pb.toGrid(w,a,true);};var ff=function(_1,p,c,a){var e=_1[p.cells[0].row()];var i=p.cells[0].row();var b=ef(p.clipboard(),p.generators(),e);var m=Ad.insert(i,_1,b,p.generators(),c);var d=Ie(m,p.cells[0].row(),p.cells[0].column());return He(m,d);};var gf=function(_1,p,c,a){var e=_1[p.cells[0].row()];var i=p.cells[p.cells.length-1].row()+p.cells[p.cells.length-1].rowspan();var b=ef(p.clipboard(),p.generators(),e);var m=Ad.insert(i,_1,b,p.generators(),c);var d=Ie(m,p.cells[0].row(),p.cells[0].column());return He(m,d);};var hf=Fe.adjustWidthTo;var jf={insertRowBefore:ed.run(Ne,ed.onCell,$.noop,$.noop,Ta.modification),insertRowsBefore:ed.run(Oe,ed.onCells,$.noop,$.noop,Ta.modification),insertRowAfter:ed.run(Pe,ed.onCell,$.noop,$.noop,Ta.modification),insertRowsAfter:ed.run(Qe,ed.onCells,$.noop,$.noop,Ta.modification),insertColumnBefore:ed.run(Re,ed.onCell,hf,$.noop,Ta.modification),insertColumnsBefore:ed.run(Se,ed.onCells,hf,$.noop,Ta.modification),insertColumnAfter:ed.run(Te,ed.onCell,hf,$.noop,Ta.modification),insertColumnsAfter:ed.run(Ue,ed.onCells,hf,$.noop,Ta.modification),splitCellIntoColumns:ed.run(Ze,ed.onCell,hf,$.noop,Ta.modification),splitCellIntoRows:ed.run($e,ed.onCell,$.noop,$.noop,Ta.modification),eraseColumns:ed.run(_e,ed.onCells,hf,Ge,Ta.modification),eraseRows:ed.run(af,ed.onCells,$.noop,Ge,Ta.modification),makeColumnHeader:ed.run(We,ed.onCell,$.noop,$.noop,Ta.transform('row','th')),unmakeColumnHeader:ed.run(Ye,ed.onCell,$.noop,$.noop,Ta.transform(null,'td')),makeRowHeader:ed.run(Ve,ed.onCell,$.noop,$.noop,Ta.transform('col','th')),unmakeRowHeader:ed.run(Xe,ed.onCell,$.noop,$.noop,Ta.transform(null,'td')),mergeCells:ed.run(bf,ed.onMergable,$.noop,$.noop,Ta.merging),unmergeCells:ed.run(cf,ed.onUnmergable,hf,$.noop,Ta.merging),pasteCells:ed.run(df,ed.onPaste,hf,$.noop,Ta.modification),pasteRowsBefore:ed.run(ff,ed.onPasteRows,$.noop,$.noop,Ta.modification),pasteRowsAfter:ed.run(gf,ed.onPasteRows,$.noop,$.noop,Ta.modification)};var kf=function(e){return v2.fromDom(e.getBody());};var lf=function(e){return e.getBoundingClientRect().width;};var mf=function(e){return e.getBoundingClientRect().height;};var nf=function(e){return function(a){return n4.eq(a,kf(e));};};var of=function(O1){return O1?O1.replace(/px$/,''):'';};var pf=function(O1){if(/^[0-9]+$/.test(O1)){O1+='px';}return O1;};var qf=function(g){var d=t5.descendants(g,'td[data-mce-style],th[data-mce-style]');d5.remove(g,'data-mce-style');F1.each(d,function(K5){d5.remove(K5,'data-mce-style');});};var rf=function(i,a){return function(e){return sf(e)==='rtl'?a:i;};};var sf=function(e){return w6.get(e,'direction')==='rtl'?'rtl':'ltr';};var tf={onDirection:rf,getDirection:sf};var uf={isRtl:$.constant(false)};var vf={isRtl:$.constant(true)};var wf=function(e){var d=tf.getDirection(e);return d==='rtl'?vf:uf;};var xf={directionAt:wf};var yf=['tableprops','tabledelete','|','tableinsertrowbefore','tableinsertrowafter','tabledeleterow','|','tableinsertcolbefore','tableinsertcolafter','tabledeletecol'];var zf={'border-collapse':'collapse','width':'100%'};var Af={border:'1'};var Bf=function(e){return e.getParam('table_default_attributes',Af,'object');};var Cf=function(e){return e.getParam('table_default_styles',zf,'object');};var Df=function(e){return e.getParam('table_resize_bars',true,'boolean');};var Ef=function(e){return e.getParam('table_tab_navigation',true,'boolean');};var Ff=function(e){return e.getParam('table_cell_advtab',true,'boolean');};var Gf=function(e){return e.getParam('table_row_advtab',true,'boolean');};var Hf=function(e){return e.getParam('table_advtab',true,'boolean');};var If=function(e){return e.getParam('table_appearance_options',true,'boolean');};var Jf=function(e){return e.getParam('table_grid',true,'boolean');};var Kf=function(e){return e.getParam('table_style_by_css',false,'boolean');};var Lf=function(e){return e.getParam('table_cell_class_list',[],'array');};var Mf=function(e){return e.getParam('table_row_class_list',[],'array');};var Nf=function(e){return e.getParam('table_class_list',[],'array');};var Of=function(e){return e.getParam('color_picker_callback');};var Pf=function(e){return e.getParam('table_responsive_width')===false;};var Qf=function(e){var c=e.getParam('table_clone_elements');if(V.isString(c)){return S.some(c.split(/[ ,]/));}else if(Array.isArray(c)){return S.some(c);}else{return S.none();}};var Rf=function(e){var o=e.getParam('object_resizing',true);return o==='table'||o;};var Sf=function(e){var t=e.getParam('table_toolbar',yf);if(t===''||t===false){return[];}else if(V.isString(t)){return t.split(/[ ,]/);}else if(V.isArray(t)){return t;}else{return[];}};var Tf=function(e,R5){return e.fire('newrow',{node:R5});};var Uf=function(e,K5){return e.fire('newcell',{node:K5});};var Vf=function(e,t,w,Aa){e.fire('ObjectResizeStart',{target:t,width:w,height:Aa});};var Wf=function(e,t,w,Aa){e.fire('ObjectResized',{target:t,width:w,height:Aa});};var Xf=function(e,l){var i=function(e){return U4.name(kf(e))==='table';};var a=function(g){var O1=Ha.getGridSize(g);return i(e)===false||O1.rows()>1;};var b=function(g){var O1=Ha.getGridSize(g);return i(e)===false||O1.columns()>1;};var v7=Qf(e);var c=function(o,h,Z6,l){return function(g,t){qf(g);var w=l();var j=v2.fromDom(e.getDoc());var k=Fa(xf.directionAt);var m=y7.cellOperations(Z6,j,v7);return h(g)?o(w,g,t,m,k).bind(function(n){F1.each(n.newRows(),function(R5){Tf(e,R5.dom());});F1.each(n.newCells(),function(K5){Uf(e,K5.dom());});return n.cursor().map(function(K5){var p=e.dom.createRng();p.setStart(K5.dom(),0);p.setEnd(K5.dom(),0);return p;});}):S.none();};};var d=c(jf.eraseRows,a,$.noop,l);var f=c(jf.eraseColumns,b,$.noop,l);var Oe=c(jf.insertRowsBefore,$.always,$.noop,l);var Qe=c(jf.insertRowsAfter,$.always,$.noop,l);var Se=c(jf.insertColumnsBefore,$.always,ea.halve,l);var Ue=c(jf.insertColumnsAfter,$.always,ea.halve,l);var bf=c(jf.mergeCells,$.always,$.noop,l);var cf=c(jf.unmergeCells,$.always,$.noop,l);var ff=c(jf.pasteRowsBefore,$.always,$.noop,l);var gf=c(jf.pasteRowsAfter,$.always,$.noop,l);var df=c(jf.pasteCells,$.always,$.noop,l);return{deleteRow:d,deleteColumn:f,insertRowsBefore:Oe,insertRowsAfter:Qe,insertColumnsBefore:Se,insertColumnsAfter:Ue,mergeCells:bf,unmergeCells:cf,pasteRowsBefore:ff,pasteRowsAfter:gf,pasteCells:df};};var Yf=function(g,t,a){var l=Y5.fromTable(g);var h=d6.generate(l);var d=ed.onCells(h,t);return d.map(function(s){var _1=Pb.toGrid(h,a,false);var b=_1.slice(s[0].row(),s[s.length-1].row()+s[s.length-1].rowspan());var c=ed.toDetailList(b,a);return Tb.copy(c);});};var Zf={copyRows:Yf};var $f=tinymce.util.Tools.resolve('tinymce.util.Tools');var _f=function(d,e,M4){var L5=d.select('td,th',e);var f;var c=function(f,a){for(var i=0;i<a.length;i++){var b=d.getStyle(a[i],M4);if(typeof f==='undefined'){f=b;}if(f!==b){return'';}}return f;};f=c(f,L5);return f;};var ag=function(e,a,M4){if(M4){e.formatter.apply('align'+M4,{},a);}};var bg=function(e,a,M4){if(M4){e.formatter.apply('valign'+M4,{},a);}};var cg=function(e,a){$f.each('left center right'.split(' '),function(M4){e.formatter.remove('align'+M4,{},a);});};var dg=function(e,a){$f.each('top middle bottom'.split(' '),function(M4){e.formatter.remove('valign'+M4,{},a);});};var eg={applyAlign:ag,applyVAlign:bg,unApplyAlign:cg,unApplyVAlign:dg,getTDTHOverallStyle:_f};var fg=function(i,a,s){var b=function(N1,o){o=o||[];$f.each(N1,function(c){var m={text:c.text||c.title};if(c.menu){m.menu=b(c.menu);}else{m.value=c.value;if(a){a(m);}}o.push(m);});return o;};return b(i,s||[]);};var gg=function(e,a){var d=e.dom;var b=a.control.rootControl;var c=b.toJSON();var gc=d.parseStyle(c.style);if(a.control.name()==='style'){b.find('#borderStyle').value(gc['border-style']||'')[0].fire('select');b.find('#borderColor').value(gc['border-color']||'')[0].fire('change');b.find('#backgroundColor').value(gc['background-color']||'')[0].fire('change');b.find('#width').value(gc.width||'').fire('change');b.find('#height').value(gc.height||'').fire('change');}else{gc['border-style']=c.borderStyle;gc['border-color']=c.borderColor;gc['background-color']=c.backgroundColor;gc.width=c.width?pf(c.width):'';gc.height=c.height?pf(c.height):'';}b.find('#style').value(d.serializeStyle(d.parseStyle(d.serializeStyle(gc))));};var hg=function(d,e){var gc=d.parseStyle(d.getAttrib(e,'style'));var a={};if(gc['border-style']){a.borderStyle=gc['border-style'];}if(gc['border-color']){a.borderColor=gc['border-color'];}if(gc['background-color']){a.backgroundColor=gc['background-color'];}a.style=d.serializeStyle(gc);return a;};var ig=function(e){var c=function(){var a=Of(e);if(a){return function(b){return a.call(e,function(O4){b.control.value(O4).fire('change');},b.control.value());};}};return{title:'Advanced',type:'form',defaults:{onchange:$.curry(gg,e)},items:[{label:'Style',name:'style',type:'textbox'},{type:'form',padding:0,formItemDefaults:{layout:'grid',alignH:['start','right']},defaults:{size:7},items:[{label:'Border style',type:'listbox',name:'borderStyle',width:90,onselect:$.curry(gg,e),values:[{text:'Select...',value:''},{text:'Solid',value:'solid'},{text:'Dotted',value:'dotted'},{text:'Dashed',value:'dashed'},{text:'Double',value:'double'},{text:'Groove',value:'groove'},{text:'Ridge',value:'ridge'},{text:'Inset',value:'inset'},{text:'Outset',value:'outset'},{text:'None',value:'none'},{text:'Hidden',value:'hidden'}]},{label:'Border color',type:'colorbox',name:'borderColor',onaction:c()},{label:'Background color',type:'colorbox',name:'backgroundColor',onaction:c()}]}]};};var jg={createStyleForm:ig,buildListItems:fg,updateStyleField:gg,extractAdvancedStyles:hg};var kg=function(e,c){delete e.dataset.mceStyle;e.style.cssText+=';'+c;};var lg=function(e,a){var d=e.dom;var b={width:d.getStyle(a,'width')||d.getAttrib(a,'width'),height:d.getStyle(a,'height')||d.getAttrib(a,'height'),scope:d.getAttrib(a,'scope'),class:d.getAttrib(a,'class'),type:a.nodeName.toLowerCase(),style:'',align:'',valign:''};$f.each('left center right'.split(' '),function(M4){if(e.formatter.matchNode(a,'align'+M4)){b.align=M4;}});$f.each('top middle bottom'.split(' '),function(M4){if(e.formatter.matchNode(a,'valign'+M4)){b.valign=M4;}});if(Ff(e)){$f.extend(b,jg.extractAdvancedStyles(d,a));}return b;};var mg=function(e,L5,a){var d=e.dom;var b;function s(f,M4,O4){if(O4){d.setAttrib(f,M4,O4);}}function c(f,M4,O4){if(O4){d.setStyle(f,M4,O4);}}jg.updateStyleField(e,a);b=a.control.rootControl.toJSON();e.undoManager.transact(function(){$f.each(L5,function(f){s(f,'scope',b.scope);if(L5.length===1){s(f,'style',b.style);}else{kg(f,b.style);}s(f,'class',b.class);c(f,'width',pf(b.width));c(f,'height',pf(b.height));if(b.type&&f.nodeName.toLowerCase()!==b.type){f=d.rename(f,b.type);}if(L5.length===1){eg.unApplyAlign(e,f);eg.unApplyVAlign(e,f);}if(b.align){eg.applyAlign(e,f,b.align);}if(b.valign){eg.applyVAlign(e,f,b.valign);}});e.focus();});};var ng=function(e){var c,d,a,L5=[];L5=e.dom.select('td[data-mce-selected],th[data-mce-selected]');c=e.dom.getParent(e.selection.getStart(),'td,th');if(!L5.length&&c){L5.push(c);}c=c||L5[0];if(!c){return;}if(L5.length>1){d={width:'',height:'',scope:'',class:'',align:'',valign:'',style:'',type:c.nodeName.toLowerCase()};}else{d=lg(e,c);}if(Lf(e).length>0){a={name:'class',type:'listbox',label:'Class',values:jg.buildListItems(Lf(e),function(i){if(i.value){i.textStyle=function(){return e.formatter.getCssText({block:'td',classes:[i.value]});};}})};}var b={type:'form',layout:'flex',direction:'column',labelGapCalc:'children',padding:0,items:[{type:'form',layout:'grid',columns:2,labelGapCalc:false,padding:0,defaults:{type:'textbox',maxWidth:50},items:[{label:'Width',name:'width',onchange:$.curry(jg.updateStyleField,e)},{label:'Height',name:'height',onchange:$.curry(jg.updateStyleField,e)},{label:'Cell type',name:'type',type:'listbox',text:'None',minWidth:90,maxWidth:null,values:[{text:'Cell',value:'td'},{text:'Header cell',value:'th'}]},{label:'Scope',name:'scope',type:'listbox',text:'None',minWidth:90,maxWidth:null,values:[{text:'None',value:''},{text:'Row',value:'row'},{text:'Column',value:'col'},{text:'Row group',value:'rowgroup'},{text:'Column group',value:'colgroup'}]},{label:'H Align',name:'align',type:'listbox',text:'None',minWidth:90,maxWidth:null,values:[{text:'None',value:''},{text:'Left',value:'left'},{text:'Center',value:'center'},{text:'Right',value:'right'}]},{label:'V Align',name:'valign',type:'listbox',text:'None',minWidth:90,maxWidth:null,values:[{text:'None',value:''},{text:'Top',value:'top'},{text:'Middle',value:'middle'},{text:'Bottom',value:'bottom'}]}]},a]};if(Ff(e)){e.windowManager.open({title:'Cell properties',bodyType:'tabpanel',data:d,body:[{title:'General',type:'form',items:b},jg.createStyleForm(e)],onsubmit:$.curry(mg,e,L5)});}else{e.windowManager.open({title:'Cell properties',data:d,body:b,onsubmit:$.curry(mg,e,L5)});}};var og={open:ng};var pg=function(e,a){var d=e.dom;var b={height:d.getStyle(a,'height')||d.getAttrib(a,'height'),scope:d.getAttrib(a,'scope'),class:d.getAttrib(a,'class'),align:'',style:'',type:a.parentNode.nodeName.toLowerCase()};$f.each('left center right'.split(' '),function(M4){if(e.formatter.matchNode(a,'align'+M4)){b.align=M4;}});if(Gf(e)){$f.extend(b,jg.extractAdvancedStyles(d,a));}return b;};var qg=function(d,a,t){var b=d.getParent(a,'table');var o=a.parentNode;var p=d.select(t,b)[0];if(!p){p=d.create(t);if(b.firstChild){if(b.firstChild.nodeName==='CAPTION'){d.insertAfter(p,b.firstChild);}else{b.insertBefore(p,b.firstChild);}}else{b.appendChild(p);}}p.appendChild(a);if(!o.hasChildNodes()){d.remove(o);}};function rg(e,S5,o,a){var d=e.dom;function s(f,M4,O4){if(O4){d.setAttrib(f,M4,O4);}}function b(f,M4,O4){if(O4){d.setStyle(f,M4,O4);}}jg.updateStyleField(e,a);var c=a.control.rootControl.toJSON();e.undoManager.transact(function(){$f.each(S5,function(f){s(f,'scope',c.scope);s(f,'style',c.style);s(f,'class',c.class);b(f,'height',pf(c.height));if(c.type!==f.parentNode.nodeName.toLowerCase()){qg(e.dom,f,c.type);}if(c.align!==o.align){eg.unApplyAlign(e,f);eg.applyAlign(e,f,c.align);}});e.focus();});}var sg=function(e){var d=e.dom;var t,c,a,b,f;var S5=[];var h;t=d.getParent(e.selection.getStart(),'table');c=d.getParent(e.selection.getStart(),'td,th');$f.each(t.rows,function(R5){$f.each(R5.cells,function(K5){if(d.getAttrib(K5,'data-mce-selected')||K5===c){S5.push(R5);return false;}});});a=S5[0];if(!a){return;}if(S5.length>1){f={height:'',scope:'',style:'',class:'',align:'',type:a.parentNode.nodeName.toLowerCase()};}else{f=pg(e,a);}if(Mf(e).length>0){b={name:'class',type:'listbox',label:'Class',values:jg.buildListItems(Mf(e),function(i){if(i.value){i.textStyle=function(){return e.formatter.getCssText({block:'tr',classes:[i.value]});};}})};}h={type:'form',columns:2,padding:0,defaults:{type:'textbox'},items:[{type:'listbox',name:'type',label:'Row type',text:'Header',maxWidth:null,values:[{text:'Header',value:'thead'},{text:'Body',value:'tbody'},{text:'Footer',value:'tfoot'}]},{type:'listbox',name:'align',label:'Alignment',text:'None',maxWidth:null,values:[{text:'None',value:''},{text:'Left',value:'left'},{text:'Center',value:'center'},{text:'Right',value:'right'}]},{label:'Height',name:'height'},b]};if(Gf(e)){e.windowManager.open({title:'Row properties',data:f,bodyType:'tabpanel',body:[{title:'General',type:'form',items:h},jg.createStyleForm(e)],onsubmit:$.curry(rg,e,S5,f)});}else{e.windowManager.open({title:'Row properties',data:f,body:h,onsubmit:$.curry(rg,e,S5,f)});}};var tg={open:sg};var ug=tinymce.util.Tools.resolve('tinymce.Env');var vg={styles:{'border-collapse':'collapse',width:'100%'},attributes:{border:'1'},percentages:true};var wg=function(){return v2.fromTag('table');};var xg=function(){return v2.fromTag('tbody');};var yg=function(){return v2.fromTag('tr');};var zg=function(){return v2.fromTag('th');};var Ag=function(){return v2.fromTag('td');};var Bg=function(S5,Zb,a,c,b){if(b===void 0){b=vg;}var g=wg();w6.setAll(g,b.styles);d5.setAll(g,b.attributes);var t=xg();D6.append(g,t);var d=[];for(var i=0;i<S5;i++){var e=yg();for(var j=0;j<Zb;j++){var f=i<a||j<c?zg():Ag();if(j<c){d5.set(f,'scope','row');}if(i<a){d5.set(f,'scope','col');}D6.append(f,v2.fromTag('br'));if(b.percentages){w6.set(f,'width',100/Zb+'%');}D6.append(e,f);}d.push(e);}I6.append(t,d);return g;};var Cg=function(e){return e.dom().innerHTML;};var Dg=function(e,c){var o4=I4.owner(e);var d=o4.dom();var f=v2.fromDom(d.createDocumentFragment());var a=D7.fromHtml(c,d);I6.append(f,a);M6.empty(e);D6.append(e,f);};var Eg=function(e){var c=v2.fromTag('div');var a5=v2.fromDom(e.dom().cloneNode(true));D6.append(c,a5);return Cg(c);};var Fg={get:Cg,set:Dg,getOuter:Eg};var Gg=function(e,K5){e.selection.select(K5.dom(),true);e.selection.collapse(true);};var Hg=function(e,t){I5.descendant(t,'td,th').each($.curry(Gg,e));};var Ig=function(e,g){F1.each(t5.descendants(g,'tr'),function(R5){Tf(e,R5.dom());F1.each(t5.descendants(R5,'th,td'),function(K5){Uf(e,K5.dom());});});};var Jg=function(w){return V.isString(w)&&w.indexOf('%')!==-1;};var Kg=function(e,Zb,S5){var zf=Cf(e);var o={styles:zf,attributes:Bf(e),percentages:Jg(zf.width)&&!Pf(e)};var g=Bg(S5,Zb,0,0,o);d5.set(g,'data-mce-id','__mce');var h=Fg.getOuter(g);e.insertContent(h);return I5.descendant(kf(e),'table[data-mce-id="__mce"]').map(function(g){if(Pf(e)){w6.set(g,'width',w6.get(g,'width'));}d5.remove(g,'data-mce-id');Ig(e,g);Hg(e,g);return g.dom();}).getOr(null);};var Lg={insert:Kg};function Mg(d,e,M4,O4){if(e.tagName==='TD'||e.tagName==='TH'){d.setStyle(e,M4,O4);}else{if(e.children){for(var i=0;i<e.children.length;i++){Mg(d,e.children[i],M4,O4);}}}}var Ng=function(e,t){var d=e.dom;var a={width:d.getStyle(t,'width')||d.getAttrib(t,'width'),height:d.getStyle(t,'height')||d.getAttrib(t,'height'),cellspacing:d.getStyle(t,'border-spacing')||d.getAttrib(t,'cellspacing'),cellpadding:d.getAttrib(t,'data-mce-cell-padding')||d.getAttrib(t,'cellpadding')||eg.getTDTHOverallStyle(e.dom,t,'padding'),border:d.getAttrib(t,'data-mce-border')||d.getAttrib(t,'border')||eg.getTDTHOverallStyle(e.dom,t,'border'),borderColor:d.getAttrib(t,'data-mce-border-color'),caption:!!d.select('caption',t)[0],class:d.getAttrib(t,'class')};$f.each('left center right'.split(' '),function(M4){if(e.formatter.matchNode(t,'align'+M4)){a.align=M4;}});if(Hf(e)){$f.extend(a,jg.extractAdvancedStyles(d,t));}return a;};var Og=function(e,t,d){var a=e.dom;var b={};var ic={};b.class=d.class;ic.height=pf(d.height);if(a.getAttrib(t,'width')&&!Kf(e)){b.width=of(d.width);}else{ic.width=pf(d.width);}if(Kf(e)){ic['border-width']=pf(d.border);ic['border-spacing']=pf(d.cellspacing);$f.extend(b,{'data-mce-border-color':d.borderColor,'data-mce-cell-padding':d.cellpadding,'data-mce-border':d.border});}else{$f.extend(b,{border:d.border,cellpadding:d.cellpadding,cellspacing:d.cellspacing});}if(Kf(e)){if(t.children){for(var i=0;i<t.children.length;i++){Mg(a,t.children[i],{'border-width':pf(d.border),'border-color':d.borderColor,'padding':pf(d.cellpadding)});}}}if(d.style){$f.extend(ic,a.parseStyle(d.style));}else{ic=$f.extend({},a.parseStyle(a.getAttrib(t,'style')),ic);}b.style=a.serializeStyle(ic);a.setAttribs(t,b);};var Pg=function(e,t,a){var d=e.dom;var c;var b;jg.updateStyleField(e,a);b=a.control.rootControl.toJSON();if(b.class===false){delete b.class;}e.undoManager.transact(function(){if(!t){t=Lg.insert(e,b.cols||1,b.rows||1);}Og(e,t,b);c=d.select('caption',t)[0];if(c&&!b.caption){d.remove(c);}if(!c&&b.caption){c=d.create('caption');c.innerHTML=!ug.ie?'<br data-mce-bogus="1"/>':'\xA0';t.insertBefore(c,t.firstChild);}eg.unApplyAlign(e,t);if(b.align){eg.applyAlign(e,t,b.align);}e.focus();e.addVisual();});};var Qg=function(e,i){var d=e.dom;var t,c,a,b,f={},h;if(i===true){t=d.getParent(e.selection.getStart(),'table');if(t){f=Ng(e,t);}}else{c={label:'Cols',name:'cols'};a={label:'Rows',name:'rows'};}if(Nf(e).length>0){if(f.class){f.class=f.class.replace(/\s*mce\-item\-table\s*/g,'');}b={name:'class',type:'listbox',label:'Class',values:jg.buildListItems(Nf(e),function(j){if(j.value){j.textStyle=function(){return e.formatter.getCssText({block:'table',classes:[j.value]});};}})};}h={type:'form',layout:'flex',direction:'column',labelGapCalc:'children',padding:0,items:[{type:'form',labelGapCalc:false,padding:0,layout:'grid',columns:2,defaults:{type:'textbox',maxWidth:50},items:If(e)?[c,a,{label:'Width',name:'width',onchange:$.curry(jg.updateStyleField,e)},{label:'Height',name:'height',onchange:$.curry(jg.updateStyleField,e)},{label:'Cell spacing',name:'cellspacing'},{label:'Cell padding',name:'cellpadding'},{label:'Border',name:'border'},{label:'Caption',name:'caption',type:'checkbox'}]:[c,a,{label:'Width',name:'width',onchange:$.curry(jg.updateStyleField,e)},{label:'Height',name:'height',onchange:$.curry(jg.updateStyleField,e)}]},{label:'Alignment',name:'align',type:'listbox',text:'None',values:[{text:'None',value:''},{text:'Left',value:'left'},{text:'Center',value:'center'},{text:'Right',value:'right'}]},b]};if(Hf(e)){e.windowManager.open({title:'Table properties',data:f,bodyType:'tabpanel',body:[{title:'General',type:'form',items:h},jg.createStyleForm(e)],onsubmit:$.curry(Pg,e,t)});}else{e.windowManager.open({title:'Table properties',data:f,body:h,onsubmit:$.curry(Pg,e,t)});}};var Rg={open:Qg};var Sg=$f.each;var Tg=function(e,a,c,s,b){var i=nf(e);var d=function(){var K5=v2.fromDom(e.dom.getParent(e.selection.getStart(),'th,td'));var g=V5.table(K5,i);g.filter($.not(i)).each(function(g){var n=v2.fromText('');D6.after(g,n);M6.remove(g);var o=e.dom.createRng();o.setStart(n.dom(),0);o.setEnd(n.dom(),0);e.selection.setRng(o);});};var f=function(){return v2.fromDom(e.dom.getParent(e.selection.getStart(),'th,td'));};var h=function(K5){return V5.table(K5,i);};var j=function(g){return{width:lf(g.dom()),height:lf(g.dom())};};var k=function(e,o,g){var n=j(g);if(o.width!==n.width||o.height!==n.height){Vf(e,g.dom(),o.width,o.height);Wf(e,g.dom(),n.width,n.height);}};var l=function(n){var K5=f();var g=h(K5);g.each(function(g){var t=h9.forMenu(s,g,K5);var o=j(g);n(g,t).each(function(u){k(e,o,g);e.selection.setRng(u);e.focus();c.clear(g);qf(g);});});};var m=function(n){var K5=f();var g=h(K5);return g.bind(function(g){var o=v2.fromDom(e.getDoc());var t=h9.forMenu(s,g,K5);var u=y7.cellOperations($.noop,o,S.none());return Zf.copyRows(g,t,u);});};var p=function(n){b.get().each(function(S5){var o=F1.map(S5,function(R5){return $6.deep(R5);});var K5=f();var g=h(K5);g.bind(function(g){var t=v2.fromDom(e.getDoc());var u=y7.paste(t);var v=h9.pasteRows(s,g,K5,o,u);n(g,v).each(function(w){e.selection.setRng(w);e.focus();c.clear(g);});});});};Sg({mceTableSplitCells:function(){l(a.unmergeCells);},mceTableMergeCells:function(){l(a.mergeCells);},mceTableInsertRowBefore:function(){l(a.insertRowsBefore);},mceTableInsertRowAfter:function(){l(a.insertRowsAfter);},mceTableInsertColBefore:function(){l(a.insertColumnsBefore);},mceTableInsertColAfter:function(){l(a.insertColumnsAfter);},mceTableDeleteCol:function(){l(a.deleteColumn);},mceTableDeleteRow:function(){l(a.deleteRow);},mceTableCutRow:function(_1){b.set(m());l(a.deleteRow);},mceTableCopyRow:function(_1){b.set(m());},mceTablePasteRowBefore:function(_1){p(a.pasteRowsBefore);},mceTablePasteRowAfter:function(_1){p(a.pasteRowsAfter);},mceTableDelete:d},function(n,M4){e.addCommand(M4,n);});Sg({mceInsertTable:$.curry(Rg.open,e),mceTableProps:$.curry(Rg.open,e,true),mceTableRowProps:$.curry(tg.open,e),mceTableCellProps:$.curry(og.open,e)},function(n,M4){e.addCommand(M4,function(u,v){n(v);});});};var Ug={registerCommands:Tg};var Vg=function(e){var r4=S.from(e.dom().documentElement).map(v2.fromDom).getOr(e);return{parent:$.constant(r4),view:$.constant(e),origin:$.constant(r(0,0))};};var Wg=function(e,c3){var o=$.curry(oa.absolute,c3);return{parent:$.constant(c3),view:$.constant(e),origin:o};};var Xg=function(e,c3){return{parent:$.constant(c3),view:$.constant(e),origin:$.constant(r(0,0))};};var Yg={only:Vg,detached:Wg,body:Xg};function Zg(f){var s=Z1.immutable.apply(null,f);var a=[];var t1=function(h){if(h===undefined){throw'Event bind error: undefined handler';}a.push(h);};var mh=function(b){a=F1.filter(a,function(h){return h!==b;});};var t=function(){var e=s.apply(null,arguments);F1.each(a,function(h){h(e);});};return{bind:t1,unbind:mh,trigger:t};}var $g=function(t){var a=P1.map(t,function(e){return{bind:e.bind,unbind:e.unbind};});var b=P1.map(t,function(e){return e.trigger;});return{registry:a,trigger:b};};var _g={create:$g};var ah=Na.exactly(['compare','extract','mutate','sink']);var bh=Na.exactly(['element','start','stop','destroy']);var ch=Na.exactly(['forceDrop','drop','move','delayDrop']);var dh={mode:ah,sink:bh,api:ch};var eh=hc.css('ephox-dragster');var fh={resolve:eh.resolve};function gh(o){var s=vb.merge({'layerClass':fh.resolve('blocker')},o);var d=v2.fromTag('div');d5.set(d,'role','presentation');w6.setAll(d,{position:'fixed',left:'0px',top:'0px',width:'100%',height:'100%'});Ec.add(d,fh.resolve('blocker'));Ec.add(d,s.layerClass);var e=function(){return d;};var a=function(){M6.remove(d);};return{element:e,destroy:a};}var hh=function(t,x,y,s,p,k,a){return{'target':$.constant(t),'x':$.constant(x),'y':$.constant(y),'stop':s,'prevent':p,'kill':k,'raw':$.constant(a)};};var ih=function(k1,h){return function(a){if(!k1(a))return;var t=v2.fromDom(a.target);var s=function(){a.stopPropagation();};var p=function(){a.preventDefault();};var k=$.compose(p,s);var e=hh(t,a.clientX,a.clientY,s,p,k,a);h(e);};};var jh=function(e,a,k1,h,u){var w=ih(k1,h);e.dom().addEventListener(a,w,u);return{unbind:$.curry(mh,e,a,w,u)};};var kh=function(e,a,k1,h){return jh(e,a,k1,h,false);};var lh=function(e,a,k1,h){return jh(e,a,k1,h,true);};var mh=function(e,a,h,u){e.dom().removeEventListener(a,h,u);};var nh={bind:kh,capture:lh};var oh=$.constant(true);var ph=function(e,a,h){return nh.bind(e,a,oh,h);};var qh=function(e,a,h){return nh.capture(e,a,oh,h);};var rh={bind:ph,capture:qh};var sh=function(o,n){return r(n.left()-o.left(),n.top()-o.top());};var th=function(e){return S.some(r(e.x(),e.y()));};var uh=function(m,i){m.mutate(i.left(),i.top());};var vh=function(d,s){var b=gh(s);var m=rh.bind(b.element(),'mousedown',d.forceDrop);var a=rh.bind(b.element(),'mouseup',d.drop);var c=rh.bind(b.element(),'mousemove',d.move);var e=rh.bind(b.element(),'mouseout',d.delayDrop);var f=function(){b.destroy();a.unbind();c.unbind();e.unbind();m.unbind();};var h=function(r4){D6.append(r4,b.element());};var i=function(){M6.remove(b.element());};return dh.sink({element:b.element,start:h,stop:i,destroy:f});};var xh=dh.mode({compare:sh,extract:th,sink:vh,mutate:uh});function yh(){var p=S.none();var a=function(){p=S.none();};var Gk=function(ah,n){var b=p.map(function(c){return ah.compare(c,n);});p=S.some(n);return b;};var o=function(b,ah){var c=ah.extract(b);c.each(function(f){var h=Gk(ah,f);h.each(function(d){e.trigger.move(d);});});};var e=_g.create({move:Zg(['info'])});return{onEvent:o,reset:a,events:e.registry};}function zh(a){var o=function(e,ah){};return{onEvent:o,reset:$.noop};}function Ah(){var n=zh();var i=yh();var d=n;var o=function(){d.reset();d=i;};var a=function(){d.reset();d=n;};var b=function(e,ah){d.onEvent(e,ah);};var c=function(){return d===i;};return{on:o,off:a,isOn:c,onEvent:b,events:i.events};}var Bh=function(f,a){var t=null;var b=null;var c=function(){if(t!==null){clearTimeout(t);t=null;b=null;}};var d=function(){b=arguments;if(t===null){t=setTimeout(function(){f.apply(null,b);t=null;b=null;},a);}};return{cancel:c,throttle:d};};var Ch=function(f,a){var t=null;var c=function(){if(t!==null){clearTimeout(t);t=null;}};var b=function(){var d=arguments;if(t===null){t=setTimeout(function(){f.apply(null,d);t=null;d=null;},a);}};return{cancel:c,throttle:b};};var Dh=function(f,a){var t=null;var c=function(){if(t!==null){clearTimeout(t);t=null;}};var b=function(){var d=arguments;if(t!==null)clearTimeout(t);t=setTimeout(function(){f.apply(null,d);t=null;d=null;},a);};return{cancel:c,throttle:b};};var Eh={adaptable:Bh,first:Ch,last:Dh};var Fh=function(m,ah,s){var a=false;var e=_g.create({start:Zg([]),stop:Zg([])});var b=Ah();var d=function(){bh.stop();if(b.isOn()){b.off();e.trigger.stop();}};var t=Eh.last(d,200);var c=function(r4){bh.start(r4);b.on();e.trigger.start();};var h=function(f,u){t.cancel();b.onEvent(f,ah);};b.events.move.bind(function(f){ah.mutate(m,f.info());});var o=function(){a=true;};var i=function(){a=false;};var j=function(f){return function(){var l=Array.prototype.slice.call(arguments,0);if(a){return f.apply(null,l);}};};var bh=ah.sink(dh.api({forceDrop:d,drop:j(d),move:j(h),delayDrop:j(t.throttle)}),s);var k=function(){bh.destroy();};return{element:bh.element,go:c,on:o,off:i,destroy:k,events:e.registry};};var Gh={setup:Fh};var Hh=function(m,o){var s=o!==undefined?o:{};var ah=s.mode!==undefined?s.mode:xh;return Gh.setup(m,ah,o);};var Ih={transform:Hh};function Jh(){var e=_g.create({'drag':Zg(['xDelta','yDelta'])});var Z6=function(x,y){e.trigger.drag(x,y);};return{mutate:Z6,events:e.registry};}function Kh(){var e=_g.create({drag:Zg(['xDelta','yDelta','target'])});var a=S.none();var d=Jh();d.events.drag.bind(function(c){a.each(function(t){e.trigger.drag(c.xDelta(),c.yDelta(),t);});});var b=function(t){a=S.some(t);};var Y4=function(){return a;};return{assign:b,get:Y4,mutate:d.mutate,events:e.registry};}var Lh=function(s){return I5.first(s).isSome();};var Mh=function(s,a,i){return I5.ancestor(s,a,i).isSome();};var Nh=function(s,a){return I5.sibling(s,a).isSome();};var Oh=function(s,a){return I5.child(s,a).isSome();};var Ph=function(s,a){return I5.descendant(s,a).isSome();};var Qh=function(s,a,i){return I5.closest(s,a,i).isSome();};var Rh={any:Lh,ancestor:Mh,sibling:Nh,child:Oh,descendant:Ph,closest:Qh};var Sh=jc.resolve('resizer-bar-dragging');function Th(w,d,h){var m=Kh();var a=Ih.transform(m,{});var b=S.none();var c=function(e,N4){return S.from(d5.get(e,N4));};m.events.drag.bind(function(e){c(e.target(),'data-row').each(function(_){var p=ae.getInt(e.target(),'top');w6.set(e.target(),'top',p+e.yDelta()+'px');});c(e.target(),'data-column').each(function(_){var p=ae.getInt(e.target(),'left');w6.set(e.target(),'left',p+e.xDelta()+'px');});});var f=function(t,d){var e=ae.getInt(t,d);var p=parseInt(d5.get(t,'data-initial-'+d),10);return e-p;};a.events.stop.bind(function(){m.get().each(function(t){b.each(function(g){c(t,'data-row').each(function(R5){var $l=f(t,'top');d5.remove(t,'data-initial-top');o.trigger.adjustHeight(g,$l,parseInt(R5,10));});c(t,'data-column').each(function(e){var $l=f(t,'left');d5.remove(t,'data-initial-left');o.trigger.adjustWidth(g,$l,parseInt(e,10));});Uc.refresh(w,g,h,d);});});});var i=function(t,d){o.trigger.startAdjust();m.assign(t);d5.set(t,'data-initial-'+d,parseInt(w6.get(t,d),10));Ec.add(t,Sh);w6.set(t,'opacity','0.2');a.go(w.parent());};var j=rh.bind(w.parent(),'mousedown',function(e){if(Uc.isRowBar(e.target()))i(e.target(),'top');if(Uc.isColBar(e.target()))i(e.target(),'left');});var k=function(e){return n4.eq(e,w.view());};var l=rh.bind(w.view(),'mouseover',function(e){if(U4.name(e.target())==='table'||Rh.closest(e.target(),'table',k)){b=U4.name(e.target())==='table'?S.some(e.target()):I5.ancestor(e.target(),'table',k);b.each(function(p){Uc.refresh(w,p,h,d);});}else if(h5.inBody(e.target())){Uc.destroy(w);}});var n=function(){j.unbind();l.unbind();a.destroy();Uc.destroy(w);};var Oc=function(t){Uc.refresh(w,t,h,d);};var o=_g.create({adjustHeight:Zg(['table','delta','row']),adjustWidth:Zg(['table','delta','column']),startAdjust:Zg([])});return{destroy:n,refresh:Oc,on:a.on,off:a.off,hideBars:$.curry(Uc.hide,w),showBars:$.curry(Uc.show,w),events:o.registry};}function Uh(w,v){var h=Da.height;var m=Th(w,v,h);var e=_g.create({beforeResize:Zg(['table']),afterResize:Zg(['table']),startDrag:Zg([])});m.events.adjustHeight.bind(function(a){e.trigger.beforeResize(a.table());var $l=h.delta(a.delta(),a.table());Fe.adjustHeight(a.table(),$l,a.row(),h);e.trigger.afterResize(a.table());});m.events.startAdjust.bind(function(a){e.trigger.startDrag();});m.events.adjustWidth.bind(function(a){e.trigger.beforeResize(a.table());var $l=v.delta(a.delta(),a.table());Fe.adjustWidth(a.table(),$l,a.column(),v);e.trigger.afterResize(a.table());});return{on:m.on,off:m.off,hideBars:m.hideBars,showBars:m.showBars,destroy:m.destroy,events:e.registry};}var Vh=function(){var c=v2.fromTag('div');w6.setAll(c,{position:'static',height:'0',width:'0',padding:'0',margin:'0',border:'0'});D6.append(h5.body(),c);return c;};var Wh=function(e,c){return e.inline?Yg.body(kf(e),Vh()):Yg.only(v2.fromDom(e.getDoc()));};var Xh=function(e,w){if(e.inline){M6.remove(w.parent());}};var Yh={get:Wh,remove:Xh};var Zh=function(a){var s=S.none();var hf=S.none();var b=S.none();var I9=/(\d+(\.\d+)?)%/;var c,d;var i=function(e){return e.nodeName==='TABLE';};var T9=function(e){return a.dom.getStyle(e,'width')||a.dom.getAttrib(e,'width');};var l=function(){return hf;};var f=function(){return b.getOr(Yg.only(v2.fromDom(a.getBody())));};var h=function(){hf.each(function(e){e.destroy();});b.each(function(w){Yh.remove(a,w);});};a.on('init',function(){var e=Fa(xf.directionAt);var j=Yh.get(a);b=S.some(j);if(Rf(a)&&Df(a)){var k=Uh(j,e);k.on();k.events.startDrag.bind(function(m){s=S.some(a.selection.getRng());});k.events.beforeResize.bind(function(m){var n=m.table().dom();Vf(a,n,lf(n),mf(n));});k.events.afterResize.bind(function(m){var g=m.table();var n=g.dom();qf(g);s.each(function(o){a.selection.setRng(o);a.focus();});Wf(a,n,lf(n),mf(n));a.undoManager.add();});hf=S.some(k);}});a.on('ObjectResizeStart',function(e){var t=e.target;if(i(t)){c=e.width;d=T9(t);}});a.on('ObjectResized',function(e){var t=e.target;if(i(t)){var g=t;if(I9.test(d)){var p=parseFloat(I9.exec(d)[1]);var j=e.width*p/c;a.dom.setStyle(g,'width',j+'%');}else{var n=[];$f.each(g.rows,function(R5){$f.each(R5.cells,function(K5){var w=a.dom.getStyle(K5,'width',true);n.push({cell:K5,width:w});});});$f.each(n,function(k){a.dom.setStyle(k.cell,'width',k.width);a.dom.setAttrib(k.cell,'width',null);});}}});return{lazyResize:l,lazyWire:f,destroy:h};};var $h=function(c){return di(function(n,f,m,l){return n(c);});};var _h=function(c){return di(function(n,f,m,l){return f(c);});};var ai=function(c,t){return di(function(n,f,m,l){return m(c,t);});};var bi=function(c){return di(function(n,f,m,l){return l(c);});};var di=function(f){return{fold:f};};var ei={none:$h,first:_h,middle:ai,last:bi};var fi=function(c,i){return V5.table(c,i).bind(function(g){var B2=V5.cells(g);var a=F1.findIndex(B2,function(x){return n4.eq(c,x);});return a.map(function(b){return{index:$.constant(b),all:$.constant(B2)};});});};var gi=function(c,i){var Jm=fi(c,i);return Jm.fold(function(){return ei.none(c);},function(a){return a.index()+1<a.all().length?ei.middle(c,a.all()[a.index()+1]):ei.last(c);});};var hi=function(c,i){var Jm=fi(c,i);return Jm.fold(function(){return ei.none();},function(a){return a.index()-1>=0?ei.middle(c,a.all()[a.index()-1]):ei.first(c);});};var ii={next:gi,prev:hi};var ji=W8.generate([{'before':['element']},{'on':['element','offset']},{after:['element']}]);var ki=function(s,o,a,b){return s.fold(o,a,b);};var li=function(s){return s.fold($.identity,$.identity,$.identity);};var mi={before:ji.before,on:ji.on,after:ji.after,cata:ki,getStart:li};var ni=W8.generate([{domRange:['rng']},{relative:['startSitu','finishSitu']},{exact:['start','soffset','finish','foffset']}]);var oi=Z1.immutable('start','soffset','finish','foffset');var pi=function(s){return ni.exact(s.start(),s.soffset(),s.finish(),s.foffset());};var qi=function($8){return $8.match({domRange:function(a){return v2.fromDom(a.startContainer);},relative:function(s,f){return mi.getStart(s);},exact:function(s,a,f,b){return s;}});};var si=function($8){var s=qi($8);return I4.defaultView(s);};var ti={domRange:ni.domRange,relative:ni.relative,exact:ni.exact,exactFromRange:pi,range:oi,getWin:si};var vi=function(s,a,f,b){var d=I4.owner(s);var c=d.dom().createRange();c.setStart(s.dom(),a);c.setEnd(f.dom(),b);return c;};var wi=function(s,a,f,b){var r=vi(s,a,f,b);return v2.fromDom(r.commonAncestorContainer);};var xi=function(s,a,f,b){var r=vi(s,a,f,b);var c=n4.eq(s,f)&&a===b;return r.collapsed&&!c;};var yi={after:xi,commonAncestorContainer:wi};var zi=function(e,s){var d=s||document;var f=d.createDocumentFragment();F1.each(e,function(a){f.appendChild(a.dom());});return v2.fromDom(f);};var Ai={fromElements:zi};var Bi=function(w,e){var a=w.document.createRange();Ci(a,e);return a;};var Ci=function(a,e){a.selectNodeContents(e.dom());};var Di=function(o,i){return i.compareBoundaryPoints(o.END_TO_START,o)<1&&i.compareBoundaryPoints(o.START_TO_END,o)>-1;};var Ei=function(w){return w.document.createRange();};var Fi=function(a,s){s.fold(function(e){a.setStartBefore(e.dom());},function(e,o){a.setStart(e.dom(),o);},function(e){a.setStartAfter(e.dom());});};var Gi=function(a,s){s.fold(function(e){a.setEndBefore(e.dom());},function(e,o){a.setEnd(e.dom(),o);},function(e){a.setEndAfter(e.dom());});};var Hi=function(a,f){Ki(a);a.insertNode(f.dom());};var Ii=function(w,s,f){var b1=w.document.createRange();Fi(b1,s);Gi(b1,f);return b1;};var Ji=function(w,s,a,f,b){var c=w.document.createRange();c.setStart(s.dom(),a);c.setEnd(f.dom(),b);return c;};var Ki=function(a){a.deleteContents();};var Li=function(a){var f=a.cloneContents();return v2.fromDom(f);};var Mi=function(a){return{left:$.constant(a.left),top:$.constant(a.top),right:$.constant(a.right),bottom:$.constant(a.bottom),width:$.constant(a.width),height:$.constant(a.height)};};var Ni=function(a){var b=a.getClientRects();var c=b.length>0?b[0]:a.getBoundingClientRect();return c.width>0||c.height>0?S.some(c).map(Mi):S.none();};var Oi=function(a){var b=a.getBoundingClientRect();return b.width>0||b.height>0?S.some(b).map(Mi):S.none();};var Pi=function(a){return a.toString();};var Qi={create:Ei,replaceWith:Hi,selectNodeContents:Bi,selectNodeContentsUsing:Ci,relativeToNative:Ii,exactToNative:Ji,deleteContents:Ki,cloneFragment:Li,getFirstRect:Ni,getBounds:Oi,isWithin:Di,toString:Pi};var Ri=W8.generate([{ltr:['start','soffset','finish','foffset']},{rtl:['start','soffset','finish','foffset']}]);var Si=function(w,N4,b1){return N4(v2.fromDom(b1.startContainer),b1.startOffset,v2.fromDom(b1.endContainer),b1.endOffset);};var Ti=function(w,$8){return $8.match({domRange:function(a){return{ltr:$.constant(a),rtl:S.none};},relative:function(s,f){return{ltr:W2.cached(function(){return Qi.relativeToNative(w,s,f);}),rtl:W2.cached(function(){return S.some(Qi.relativeToNative(w,f,s));})};},exact:function(s,a,f,b){return{ltr:W2.cached(function(){return Qi.exactToNative(w,s,a,f,b);}),rtl:W2.cached(function(){return S.some(Qi.exactToNative(w,f,b,s,a));})};}});};var Ui=function(w,a){var b=a.ltr();if(b.collapsed){var c=a.rtl().filter(function(d){return d.collapsed===false;});return c.map(function(d){return Ri.rtl(v2.fromDom(d.endContainer),d.endOffset,v2.fromDom(d.startContainer),d.startOffset);}).getOrThunk(function(){return Si(w,Ri.ltr,b);});}else{return Si(w,Ri.ltr,b);}};var Vi=function(w,$8){var a=Ti(w,$8);return Ui(w,a);};var Wi=function(w,$8){var d=Vi(w,$8);return d.match({ltr:function(s,a,f,b){var c=w.document.createRange();c.setStart(s.dom(),a);c.setEnd(f.dom(),b);return c;},rtl:function(s,a,f,b){var c=w.document.createRange();c.setStart(f.dom(),b);c.setEnd(s.dom(),a);return c;}});};var Xi={ltr:Ri.ltr,rtl:Ri.rtl,diagnose:Vi,asLtrRange:Wi};var Yi=function(a,x,y,m,l){if(l===0)return 0;else if(x===m)return l-1;var b=m;for(var i=1;i<l;i++){var c=a(i);var d=Math.abs(x-c.left);if(y>c.bottom){}else if(y<c.top||d>b){return i-1;}else{b=d;}}return 0;};var Zi=function(a,x,y){return x>=a.left&&x<=a.right&&y>=a.top&&y<=a.bottom;};var $i={inRect:Zi,searchForPoint:Yi};var aj=function(d,t,x,y,a){var b=function(o){var r=d.dom().createRange();r.setStart(t.dom(),o);r.collapse(true);return r;};var c=function(o){var r=b(o);return r.getBoundingClientRect();};var l=e7.get(t).length;var o=$i.searchForPoint(c,x,y,a.right,l);return b(o);};var bj=function(d,Q2,x,y){var r=d.dom().createRange();r.selectNode(Q2.dom());var a=r.getClientRects();var f=zb.findMap(a,function(b){return $i.inRect(b,x,y)?S.some(b):S.none();});return f.map(function(b){return aj(d,Q2,x,y,b);});};var cj={locate:bj};var dj=function(d,Q2,x,y){var r=d.dom().createRange();var a=I4.children(Q2);return zb.findMap(a,function(n){r.selectNode(n.dom());return $i.inRect(r.getBoundingClientRect(),x,y)?ej(d,n,x,y):S.none();});};var ej=function(d,Q2,x,y){var l=U4.isText(Q2)?cj.locate:dj;return l(d,Q2,x,y);};var fj=function(d,Q2,x,y){var r=d.dom().createRange();r.selectNode(Q2.dom());var a=r.getBoundingClientRect();var b=Math.max(a.left,Math.min(a.right,x));var c=Math.max(a.top,Math.min(a.bottom,y));return ej(d,Q2,b,c);};var gj={locate:fj};var hj=true;var ij=false;var jj=function(a,x){return x-a.left<a.right-x?hj:ij;};var kj=function(d,t,c){var r=d.dom().createRange();r.selectNode(t.dom());r.collapse(c);return r;};var lj=function(d,Q2,x){var c=d.dom().createRange();c.selectNode(Q2.dom());var a=c.getBoundingClientRect();var b=jj(a,x);var f=b===hj?q7.first:q7.last;return f(Q2).map(function(t){return kj(d,t,b);});};var mj=function(d,Q2,x){var a=Q2.dom().getBoundingClientRect();var c=jj(a,x);return S.some(kj(d,Q2,c));};var nj=function(d,Q2,x){var f=I4.children(Q2).length===0?mj:lj;return f(d,Q2,x);};var oj={search:nj};var pj=function(d,x,y){return S.from(d.dom().caretPositionFromPoint(x,y)).bind(function(p){if(p.offsetNode===null)return S.none();var r=d.dom().createRange();r.setStart(p.offsetNode,p.offset);r.collapse();return S.some(r);});};var qj=function(d,x,y){return S.from(d.dom().caretRangeFromPoint(x,y));};var rj=function(d,Q2,x,y){var r=d.dom().createRange();r.selectNode(Q2.dom());var a=r.getBoundingClientRect();var b=Math.max(a.left,Math.min(a.right,x));var c=Math.max(a.top,Math.min(a.bottom,y));return gj.locate(d,Q2,b,c);};var sj=function(d,x,y){return v2.fromPoint(d,x,y).bind(function(e){var f=function(){return oj.search(d,e,x);};return I4.children(e).length===0?f():rj(d,e,x,y).orThunk(f);});};var tj=document.caretPositionFromPoint?pj:document.caretRangeFromPoint?qj:sj;var uj=function(w,x,y){var d=v2.fromDom(w.document);return tj(d,x,y).map(function(a){return ti.range(v2.fromDom(a.startContainer),a.startOffset,v2.fromDom(a.endContainer),a.endOffset);});};var vj={fromPoint:uj};var wj=function(w,w5,o,s){var i=Qi.create(w);var a=D2.is(w5,s)?[w5]:[];var e=a.concat(t5.descendants(w5,s));return F1.filter(e,function(b){Qi.selectNodeContentsUsing(i,b);return Qi.isWithin(o,i);});};var xj=function(w,$8,s){var o=Xi.asLtrRange(w,$8);var w5=v2.fromDom(o.commonAncestorContainer);return U4.isElement(w5)?wj(w,w5,o,s):[];};var yj={find:xj};var zj=function(e,o){var M4=U4.name(e);if('input'===M4)return mi.after(e);else if(!F1.contains(['br','img'],M4))return mi.on(e,o);else return o===0?mi.before(e):mi.after(e);};var Aj=function(s,f){var a=s.fold(mi.before,zj,mi.after);var b=f.fold(mi.before,zj,mi.after);return ti.relative(a,b);};var Bj=function(s,a,f,b){var c=zj(s,a);var d=zj(f,b);return ti.relative(c,d);};var Cj=function($8){return $8.match({domRange:function(a){var s=v2.fromDom(a.startContainer);var f=v2.fromDom(a.endContainer);return Bj(s,a.startOffset,f,a.endOffset);},relative:Aj,exact:Bj});};var Dj={beforeSpecial:zj,preprocess:Cj,preprocessRelative:Aj,preprocessExact:Bj};var Ej=function(w,a){S.from(w.getSelection()).each(function($8){$8.removeAllRanges();$8.addRange(a);});};var Fj=function(w,s,a,f,b){var c=Qi.exactToNative(w,s,a,f,b);Ej(w,c);};var Gj=function(w,$8,s){return yj.find(w,$8,s);};var Hj=function(w,ma){return Xi.diagnose(w,ma).match({ltr:function(s,a,f,b){Fj(w,s,a,f,b);},rtl:function(s,a,f,b){var $8=w.getSelection();if($8.setBaseAndExtent){$8.setBaseAndExtent(s.dom(),a,f.dom(),b);}else if($8.extend){$8.collapse(s.dom(),a);$8.extend(f.dom(),b);}else{Fj(w,f,b,s,a);}}});};var Ij=function(w,s,a,f,b){var ma=Dj.preprocessExact(s,a,f,b);Hj(w,ma);};var Jj=function(w,s,f){var ma=Dj.preprocessRelative(s,f);Hj(w,ma);};var Kj=function($8){var w=ti.getWin($8).dom();var a=function(s,b,c,d){return Qi.exactToNative(w,s,b,c,d);};var f=Dj.preprocess($8);return Xi.diagnose(w,f).match({ltr:a,rtl:a});};var Lj=function($8){if($8.rangeCount>0){var f=$8.getRangeAt(0);var l=$8.getRangeAt($8.rangeCount-1);return S.some(ti.range(v2.fromDom(f.startContainer),f.startOffset,v2.fromDom(l.endContainer),l.endOffset));}else{return S.none();}};var Mj=function($8){var a=v2.fromDom($8.anchorNode);var f=v2.fromDom($8.focusNode);return yi.after(a,$8.anchorOffset,f,$8.focusOffset)?S.some(ti.range(v2.fromDom($8.anchorNode),$8.anchorOffset,v2.fromDom($8.focusNode),$8.focusOffset)):Lj($8);};var Nj=function(w,e){var a=Qi.selectNodeContents(w,e);Ej(w,a);};var Oj=function(w,e){var a=Qi.selectNodeContents(w,e);return ti.range(v2.fromDom(a.startContainer),a.startOffset,v2.fromDom(a.endContainer),a.endOffset);};var Pj=function(w){return S.from(w.getSelection()).filter(function(s){return s.rangeCount>0;}).bind(Mj);};var Qj=function(w){return Pj(w).map(function(b1){return ti.exact(b1.start(),b1.soffset(),b1.finish(),b1.foffset());});};var Rj=function(w,$8){var a=Xi.asLtrRange(w,$8);return Qi.getFirstRect(a);};var Sj=function(w,$8){var a=Xi.asLtrRange(w,$8);return Qi.getBounds(a);};var Tj=function(w,x,y){return vj.fromPoint(w,x,y);};var Uj=function(w,$8){var a=Xi.asLtrRange(w,$8);return Qi.toString(a);};var Vj=function(w){var $8=w.getSelection();$8.removeAllRanges();};var Wj=function(w,$8){var a=Xi.asLtrRange(w,$8);return Qi.cloneFragment(a);};var Xj=function(w,$8,e){var a=Xi.asLtrRange(w,$8);var f=Ai.fromElements(e,w.document);Qi.replaceWith(a,f);};var Yj=function(w,$8){var a=Xi.asLtrRange(w,$8);Qi.deleteContents(a);};var Zj=function(s,a,f,b){return n4.eq(s,f)&&a===b;};var $j={setExact:Ij,getExact:Pj,get:Qj,setRelative:Jj,toNative:Kj,setToElement:Nj,clear:Vj,clone:Wj,replace:Xj,deleteAt:Yj,forElement:Oj,getFirstRect:Rj,getBounds:Sj,getAtPoint:Tj,findWithin:Gj,getAsString:Uj,isCollapsed:Zj};var _j=tinymce.util.Tools.resolve('tinymce.util.VK');var ak=function(e,i,K5,l){return go(e,i,ii.next(K5),l);};var bk=function(e,i,K5,l){return go(e,i,ii.prev(K5),l);};var ck=function(e,K5){var $8=ti.exact(K5,0,K5,0);return $j.toNative($8);};var dk=function(e,g){var S5=t5.descendants(g,'tr');return F1.last(S5).bind(function(D1){return I5.descendant(D1,'td,th').map(function(G3){return ck(e,G3);});});};var go=function(e,i,K5,a,l){return K5.fold(S.none,S.none,function(c,gi){return q7.first(gi).map(function(K5){return ck(e,K5);});},function(c){return V5.table(c,i).bind(function(g){var t=h9.noMenu(c);e.undoManager.transact(function(){a.insertRowsAfter(g,t);});return dk(e,g);});});};var fk=['table','li','dl'];var gk=function(e,a,b,l){if(e.keyCode===_j.TAB){var c=kf(a);var i=function(f){var M4=U4.name(f);return n4.eq(f,c)||F1.contains(fk,M4);};var d=a.selection.getRng();if(d.collapsed){var s=v2.fromDom(d.startContainer);V5.cell(s,i).each(function(K5){e.preventDefault();var n=e.shiftKey?bk:ak;var d=n(a,i,K5,b,l);d.each(function(b1){a.selection.setRng(b1);});});}}};var hk={handle:gk};var ik=Z1.immutable('selection','kill');var jk={response:ik};var kk=function(Z5){return function(k){return k===Z5;};};var lk=kk(38);var mk=kk(40);var nk=function(k){return k>=37&&k<=40;};var ok={ltr:{isBackward:kk(37),isForward:kk(39)},rtl:{isBackward:kk(39),isForward:kk(37)},isUp:lk,isDown:mk,isNavigation:nk};var pk=function(w,$8){var a=Xi.asLtrRange(w,$8);return{start:$.constant(v2.fromDom(a.startContainer)),soffset:$.constant(a.startOffset),finish:$.constant(v2.fromDom(a.endContainer)),foffset:$.constant(a.endOffset)};};var qk=function(s,a,f,b){return{start:$.constant(mi.on(s,a)),finish:$.constant(mi.on(f,b))};};var rk={convertToRange:pk,makeSitus:qk};var sk=f4.detect().browser.isSafari();var tk=function(_){var d=_!==undefined?_.dom():document;var x=d.body.scrollLeft||d.documentElement.scrollLeft;var y=d.body.scrollTop||d.documentElement.scrollTop;return r(x,y);};var to=function(x,y,_){var d=_!==undefined?_.dom():document;var w=d.defaultView;w.scrollTo(x,y);};var by=function(x,y,_){var d=_!==undefined?_.dom():document;var w=d.defaultView;w.scrollBy(x,y);};var wk=function(w,e){var p=oa.absolute(e);var d=v2.fromDom(w.document);to(p.left(),p.top(),d);};var xk=function(d,f){var x6=tk(d);f();var y6=tk(d);if(x6.top()!==y6.top()||x6.left()!==y6.left()){to(x6.left(),x6.top(),d);}};var yk=function(d){var a=S.none();var s=function(){a=S.some(tk(d));};var b=function(){a.each(function(p){to(p.left(),p.top(),d);});};s();return{save:s,restore:b};};var zk=function(e,a){if(sk&&V.isFunction(e.dom().scrollIntoViewIfNeeded)){e.dom().scrollIntoViewIfNeeded(false);}else{e.dom().scrollIntoView(a);}};var Ak=function(e,c){var a=c.dom().getBoundingClientRect();var b=e.dom().getBoundingClientRect();if(b.top<a.top){zk(e,true);}else if(b.bottom>a.bottom){zk(e,false);}};var Bk=function(){var s=v2.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');D6.after(h5.body(),s);var w=s.dom().offsetWidth-s.dom().clientWidth;M6.remove(s);return w;};var Ck={get:tk,to:to,by:by,preserve:xk,capture:yk,intoView:zk,intoViewIfNeeded:Ak,setToElement:wk,scrollBarWidth:Bk};function Dk(w){var e=function(x,y){return v2.fromPoint(v2.fromDom(w.document),x,y);};var a=function(n){return n.dom().getBoundingClientRect();};var b=function(n,o,p,t){var u=ti.exact(n,o,p,t);return $j.getFirstRect(w,u).map(function(v){return P1.map(v,$.apply);});};var c=function(){return $j.get(w).map(function(n){return rk.convertToRange(w,n);});};var f=function(n){var ma=ti.relative(n.start(),n.finish());return rk.convertToRange(w,ma);};var s=function(x,y){return $j.getAtPoint(w,x,y).map(function(n){return{start:$.constant(mi.on(n.start(),n.soffset())),finish:$.constant(mi.on(n.finish(),n.foffset()))};});};var d=function(){$j.clear(w);};var h=function(n){$j.setToElement(w,n);};var i=function(n){$j.setExact(w,n.start(),n.soffset(),n.finish(),n.foffset());};var j=function(n,o){$j.setRelative(w,n,o);};var k=function(){return w.innerHeight;};var l=function(){var p=Ck.get(v2.fromDom(w.document));return p.top();};var m=function(x,y){Ck.by(x,y,v2.fromDom(w.document));};return{elementFromPoint:e,getRect:a,getRangedRect:b,getSelection:c,fromSitus:f,situsFromPoint:s,clearSelection:d,setSelection:i,setRelativeSelection:j,selectContents:h,getInnerHeight:k,getScrollY:l,scrollBy:m};}var Ek=function(c,i,a,b,d,e,h){if(!(n4.eq(a,d)&&b===e)){return I5.closest(a,'td,th',i).bind(function(s){return I5.closest(d,'td,th',i).bind(function(f){return Fk(c,i,s,f,h);});});}else{return S.none();}};var Fk=function(c,i,s,f,a){if(!n4.eq(s,f)){return J8.identify(s,f,i).bind(function(b){var d=b.boxes().getOr([]);if(d.length>0){a(c,d,b.start(),b.finish());return S.some(jk.response(S.some(rk.makeSitus(s,0,s,m7.getEnd(s))),true));}else{return S.none();}});}else{return S.none();}};var Gk=function(S5,Zb,c,N8,a){var u=function(n){a.clear(c);a.selectRange(c,n.boxes(),n.start(),n.finish());return n.boxes();};return J8.shiftSelection(N8,S5,Zb,a.firstSelectedSelector(),a.lastSelectedSelector()).map(u);};var Hk={sync:Ek,detect:Fk,update:Gk};var Ik=Z1.immutableBag(['left','top','right','bottom'],[]);var Jk=function(c,a){return Ik({left:c.left(),top:c.top()+a,right:c.right(),bottom:c.bottom()+a});};var Kk=function(c,a){return Ik({left:c.left(),top:c.top()-a,right:c.right(),bottom:c.bottom()-a});};var Lk=function(c,b){var Aa=c.bottom()-c.top();return Ik({left:c.left(),top:b-Aa,right:c.right(),bottom:b});};var Mk=function(c,t){var Aa=c.bottom()-c.top();return Ik({left:c.left(),top:t,right:c.right(),bottom:t+Aa});};var Nk=function(c,x,y){return Ik({left:c.left()+x,top:c.top()+y,right:c.right()+x,bottom:c.bottom()+y});};var Ok=function(c){return c.top();};var Pk=function(c){return c.bottom();};var Qk=function(c){return'('+c.left()+', '+c.top()+') -> ('+c.right()+', '+c.bottom()+')';};var Rk={nu:Ik,moveUp:Kk,moveDown:Jk,moveBottomTo:Lk,moveTopTo:Mk,getTop:Ok,getBottom:Pk,translate:Nk,toString:Qk};var Sk=function(b,e,o){if(o>=0&&o<m7.getEnd(e))return b.getRangedRect(e,o,e,o+1);else if(o>0)return b.getRangedRect(e,o-1,e,o);return S.none();};var Tk=function(a){return Rk.nu({left:a.left,top:a.top,right:a.right,bottom:a.bottom});};var Uk=function(b,e){return S.some(b.getRect(e));};var Vk=function(b,e,o){if(U4.isElement(e))return Uk(b,e).map(Tk);else if(U4.isText(e))return Sk(b,e,o).map(Tk);else return S.none();};var Wk=function(b,e){if(U4.isElement(e))return Uk(b,e).map(Tk);else if(U4.isText(e))return b.getRangedRect(e,0,e,m7.getEnd(e)).map(Tk);else return S.none();};var Xk={getBoxAt:Vk,getEntireBox:Wk};var Yk=Z1.immutable('item','mode');var Zk=function(b8,i,d,_){var t=_!==undefined?_:$k;return b8.property().parent(i).map(function(p){return Yk(p,t);});};var $k=function(b8,i,d,_){var t=_!==undefined?_:_k;return d.sibling(b8,i).map(function(p){return Yk(p,t);});};var _k=function(b8,i,d,_){var t=_!==undefined?_:_k;var A4=b8.property().children(i);var a=d.first(A4);return a.map(function(r){return Yk(r,t);});};var al=[{current:Zk,next:$k,fallback:S.none()},{current:$k,next:_k,fallback:S.some(Zk)},{current:_k,next:_k,fallback:S.some($k)}];var bl=function(b8,i,ah,d,a){var a=a!==undefined?a:al;var b=F1.find(a,function(s){return s.current===ah;});return b.bind(function(c){return c.current(b8,i,d,c.next).orThunk(function(){return c.fallback.bind(function(f){return bl(b8,i,f,d);});});});};var cl={backtrack:Zk,sidestep:$k,advance:_k,go:bl};var dl=function(){var y5=function(b8,i){return b8.query().prevSibling(i);};var G3=function(A4){return A4.length>0?S.some(A4[A4.length-1]):S.none();};return{sibling:y5,first:G3};};var fl=function(){var y5=function(b8,i){return b8.query().nextSibling(i);};var G3=function(A4){return A4.length>0?S.some(A4[0]):S.none();};return{sibling:y5,first:G3};};var gl={left:dl,right:fl};var hl=function(b8,i,p,ah,d,a){var gi=cl.go(b8,i,ah,d);return gi.bind(function(n){if(a(n.item()))return S.none();else return p(n.item())?S.some(n.item()):hl(b8,n.item(),p,n.mode(),d,a);});};var il=function(b8,i,p,a){return hl(b8,i,p,cl.sidestep,gl.left(),a);};var jl=function(b8,i,p,a){return hl(b8,i,p,cl.sidestep,gl.right(),a);};var kl={left:il,right:jl};var ll=function(b8,e){return b8.property().children(e).length===0;};var ml=function(b8,i,a){return ol(b8,i,$.curry(ll,b8),a);};var nl=function(b8,i,a){return pl(b8,i,$.curry(ll,b8),a);};var ol=function(b8,i,p,a){return kl.left(b8,i,p,a);};var pl=function(b8,i,p,a){return kl.right(b8,i,p,a);};var ql=function(){return{left:gl.left,right:gl.right};};var rl=function(b8,i,ah,d,_){return cl.go(b8,i,ah,d,_);};var sl={before:ml,after:nl,seekLeft:ol,seekRight:pl,walkers:ql,walk:rl,backtrack:cl.backtrack,sidestep:cl.sidestep,advance:cl.advance};var tl=F7();var ul=function(e,Ge,Qa){return sl.gather(tl,e,Ge,Qa);};var vl=function(e,i){return sl.before(tl,e,i);};var wl=function(e,i){return sl.after(tl,e,i);};var xl=function(e,p,i){return sl.seekLeft(tl,e,p,i);};var yl=function(e,p,i){return sl.seekRight(tl,e,p,i);};var zl=function(){return sl.walkers();};var Al=function(i,ah,d,_){return sl.walk(tl,i,ah,d,_);};var Bl={gather:ul,before:vl,after:wl,seekLeft:xl,seekRight:yl,walkers:zl,walk:Al};var Cl=5;var Dl=100;var El=W8.generate([{'none':[]},{'retry':['caret']}]);var Fl=function(c,b){return c.left()<b.left()||Math.abs(b.right()-c.left())<1||c.left()>b.right();};var Gl=function(b,e,c){return B5.closest(e,mb.isBlock).fold($.constant(false),function(K5){return Xk.getEntireBox(b,K5).exists(function(a){return Fl(c,a);});});};var Hl=function(b,e,a,o,c){var l=Rk.moveDown(c,Cl);if(Math.abs(a.bottom()-o.bottom())<1)return El.retry(l);else if(a.top()>c.bottom())return El.retry(l);else if(a.top()===c.bottom())return El.retry(Rk.moveDown(c,1));else return Gl(b,e,c)?El.retry(Rk.translate(l,Cl,0)):El.none();};var Il=function(b,e,a,o,c){var h=Rk.moveUp(c,Cl);if(Math.abs(a.top()-o.top())<1)return El.retry(h);else if(a.bottom()<c.top())return El.retry(h);else if(a.bottom()===c.top())return El.retry(Rk.moveUp(c,1));else return Gl(b,e,c)?El.retry(Rk.translate(h,Cl,0)):El.none();};var Jl={point:Rk.getTop,adjuster:Il,move:Rk.moveUp,gather:Bl.before};var Kl={point:Rk.getBottom,adjuster:Hl,move:Rk.moveDown,gather:Bl.after};var Ll=function(b,x,y){return b.elementFromPoint(x,y).filter(function(e){return U4.name(e)==='table';}).isSome();};var Ml=function(b,m,o,c,n){return Nl(b,m,o,m.move(c,Cl),n);};var Nl=function(b,m,o,c,n){if(n===0)return S.some(c);if(Ll(b,c.left(),m.point(c)))return Ml(b,m,o,c,n-1);return b.situsFromPoint(c.left(),m.point(c)).bind(function(a){return a.start().fold(S.none,function(e,d){return Xk.getEntireBox(b,e,d).bind(function(f){return m.adjuster(b,e,f,o,c).fold(S.none,function(h){return Nl(b,m,o,h,n-1);});}).orThunk(function(){return S.some(c);});},S.none);});};var Ol=function(b,c){return b.situsFromPoint(c.left(),c.bottom()+Cl);};var Pl=function(b,c){return b.situsFromPoint(c.left(),c.top()-Cl);};var Ql=function(m,a,b){if(m.point(a)>b.getInnerHeight())return S.some(m.point(a)-b.getInnerHeight());else if(m.point(a)<0)return S.some(-m.point(a));else return S.none();};var Rl=function(m,b,c){var a=m.move(c,Cl);var d=Nl(b,m,c,a,Dl).getOr(a);return Ql(m,d,b).fold(function(){return b.situsFromPoint(d.left(),m.point(d));},function($l){b.scrollBy(0,$l);return b.situsFromPoint(d.left(),m.point(d)-$l);});};var Sl={tryUp:$.curry(Rl,Jl),tryDown:$.curry(Rl,Kl),ieTryUp:Pl,ieTryDown:Ol,getJumpSize:$.constant(Cl)};var Tl=W8.generate([{'none':['message']},{'success':[]},{'failedUp':['cell']},{'failedDown':['cell']}]);var Ul=function(b,x6,y6){var a=b.getRect(x6);var c=b.getRect(y6);return c.right>a.left&&c.left<a.right;};var Vl=function(b,x6,a,y6,c,f,i){return I5.closest(y6,'td,th',i).bind(function(d){return I5.closest(x6,'td,th',i).map(function(e){if(!n4.eq(d,e)){return i8.sharedOne(Wl,[d,e]).fold(function(){return Ul(b,e,d)?Tl.success():f(e);},function(s){return f(e);});}else{return n4.eq(y6,d)&&m7.getEnd(d)===c?f(e):Tl.none('in same cell');}});}).getOr(Tl.none('default'));};var Wl=function(e){return I5.closest(e,'tr');};var Xl=function(s,o,a,b,c){return s.fold(o,a,b,c);};var Yl={verify:Vl,cata:Xl,adt:Tl};var Zl=Z1.immutable('element','offset');var $l=Z1.immutable('element','deltaOffset');var _l=Z1.immutable('element','start','finish');var am=Z1.immutable('begin','end');var bm=Z1.immutable('element','text');var cm={point:Zl,delta:$l,range:_l,points:am,text:bm};var dm=Z1.immutable('ancestor','descendants','element','index');var em=Z1.immutable('parent','children','element','index');var fm=function(e,w5){return B5.closest(e,function(a){return I4.parent(a).exists(function(r4){return n4.eq(r4,w5);});});};var gm=function(e){return I4.parent(e).bind(function(r4){var A4=I4.children(r4);return hm(A4,e).map(function(i){return em(r4,A4,e,i);});});};var hm=function(e,a){return F1.findIndex(e,$.curry(n4.eq,a));};var im=function(e,s){return I4.parent(e).bind(function(r4){var A4=t5.children(r4,s);return hm(A4,e).map(function(i){return em(r4,A4,e,i);});});};var jm=function(e,a,d){return I5.closest(e,a).bind(function(w5){var m5=t5.descendants(w5,d);return hm(m5,e).map(function(i){return dm(w5,m5,e,i);});});};var km={childOf:fm,indexOf:hm,indexInParent:gm,selectorsInParent:im,descendantsInAncestor:jm};var lm=function(e){return U4.name(e)==='br';};var mm=function(c,ul,i){return ul(c,i).bind(function(t){return U4.isText(t)&&e7.get(t).trim().length===0?mm(t,ul,i):S.some(t);});};var nm=function(i,e,d){return d.traverse(e).orThunk(function(){return mm(e,d.gather,i);}).map(d.relative);};var om=function(e,o){return I4.child(e,o).filter(lm).orThunk(function(){return I4.child(e,o-1).filter(lm);});};var pm=function(i,e,o,d){return om(e,o).bind(function(b){return d.traverse(b).fold(function(){return mm(b,d.gather,i).map(d.relative);},function(a){return km.indexInParent(a).map(function(c){return mi.on(c.parent(),c.index());});});});};var qm=function(i,e,o,d){var t=lm(e)?nm(i,e,d):pm(i,e,o,d);return t.map(function(a){return{start:$.constant(a),finish:$.constant(a)};});};var rm=function(a){return Yl.cata(a,function(m){return S.none();},function(){return S.none();},function(K5){return S.some(cm.point(K5,0));},function(K5){return S.some(cm.point(K5,m7.getEnd(K5)));});};var sm={tryBr:qm,process:rm};var tm=20;var um=f4.detect();var vm=function(b,i,d){return b.getSelection().bind(function(s){return sm.tryBr(i,s.finish(),s.foffset(),d).fold(function(){return S.some(cm.point(s.finish(),s.foffset()));},function(a){var b1=b.fromSitus(a);var c=Yl.verify(b,s.finish(),s.foffset(),b1.finish(),b1.foffset(),d.failure,i);return sm.process(c);});});};var wm=function(b,i,e,o,d,n){if(n===0)return S.none();return zm(b,i,e,o,d).bind(function(s){var b1=b.fromSitus(s);var a=Yl.verify(b,e,o,b1.finish(),b1.foffset(),d.failure,i);return Yl.cata(a,function(){return S.none();},function(){return S.some(s);},function(K5){if(n4.eq(e,K5)&&o===0)return xm(b,e,o,Rk.moveUp,d);else return wm(b,i,K5,0,d,n-1);},function(K5){if(n4.eq(e,K5)&&o===m7.getEnd(K5))return xm(b,e,o,Rk.moveDown,d);else return wm(b,i,K5,m7.getEnd(K5),d,n-1);});});};var xm=function(b,e,o,m,d){return Xk.getBoxAt(b,e,o).bind(function(a){return ym(b,d,m(a,Sl.getJumpSize()));});};var ym=function(b,d,a){if(um.browser.isChrome()||um.browser.isSafari()||um.browser.isFirefox()||um.browser.isEdge())return d.otherRetry(b,a);else if(um.browser.isIE())return d.ieRetry(b,a);else return S.none();};var zm=function(b,i,e,o,d){return Xk.getBoxAt(b,e,o).bind(function(a){return ym(b,d,a);});};var Am=function(b,i,d){return vm(b,i,d).bind(function(G4){return wm(b,i,G4.element(),G4.offset(),d,tm).map(b.fromSitus);});};var Bm={handle:Am};var Cm=function(p){return B5.first(p).isSome();};var Dm=function(s,p,i){return B5.ancestor(s,p,i).isSome();};var Em=function(s,p,i){return B5.closest(s,p,i).isSome();};var Fm=function(s,p){return B5.sibling(s,p).isSome();};var Gm=function(s,p){return B5.child(s,p).isSome();};var Hm=function(s,p){return B5.descendant(s,p).isSome();};var Im={any:Cm,ancestor:Dm,closest:Em,sibling:Fm,child:Gm,descendant:Hm};var Jm=f4.detect();var Km=function(a,g){return Im.ancestor(a,function(e){return I4.parent(e).exists(function(p){return n4.eq(p,g);});});};var Lm=function(b,i,d,a,c){return I5.closest(a,'td,th',i).bind(function(s){return I5.closest(s,'table',i).bind(function(g){if(!Km(c,g))return S.none();return Bm.handle(b,i,d).bind(function(b1){return I5.closest(b1.finish(),'td,th',i).map(function(f){return{start:$.constant(s),finish:$.constant(f),range:$.constant(b1)};});});});});};var Mm=function(b,i,d,a,c,p){if(Jm.browser.isIE()){return S.none();}else{return p(a,i).orThunk(function(){return Lm(b,i,d,a,c).map(function(e){var b1=e.range();return jk.response(S.some(rk.makeSitus(b1.start(),b1.soffset(),b1.finish(),b1.foffset())),true);});});}};var Nm=function(i,a){return I5.closest(i,'tr',a).bind(function(s){return I5.closest(s,'table',a).bind(function(g){var S5=t5.descendants(g,'tr');if(n4.eq(s,S5[0])){return Bl.seekLeft(g,function(e){return q7.last(e).isSome();},a).map(function(D1){var l=m7.getEnd(D1);return jk.response(S.some(rk.makeSitus(D1,l,D1,l)),true);});}else{return S.none();}});});};var Om=function(i,a){return I5.closest(i,'tr',a).bind(function(s){return I5.closest(s,'table',a).bind(function(g){var S5=t5.descendants(g,'tr');if(n4.eq(s,S5[S5.length-1])){return Bl.seekRight(g,function(e){return q7.first(e).isSome();},a).map(function(G3){return jk.response(S.some(rk.makeSitus(G3,0,G3,0)),true);});}else{return S.none();}});});};var Pm=function(b,c,i,d,a,e,s){return Lm(b,i,d,a,e).bind(function(f){return Hk.detect(c,i,f.start(),f.finish(),s);});};var Qm={navigate:Mm,select:Pm,firstUpCheck:Nm,lastDownCheck:Om};var Rm=function(t,i){return I5.closest(t,'td,th',i);};function Sm(b,c,i,a){var d=S.none();var e=function(){d=S.none();};var m=function(j){a.clear(c);d=Rm(j.target(),i);};var f=function(j){d.each(function(s){a.clear(c);Rm(j.target(),i).each(function(k){J8.identify(s,k,i).each(function(l){var n=l.boxes().getOr([]);if(n.length>1||n.length===1&&!n4.eq(s,k)){a.selectRange(c,n,l.start(),l.finish());b.selectContents(k);}});});});};var h=function(){d.each(e);};return{mousedown:m,mouseover:f,mouseup:h};}var Tm={down:{traverse:I4.nextSibling,gather:Bl.after,relative:mi.before,otherRetry:Sl.tryDown,ieRetry:Sl.ieTryDown,failure:Yl.adt.failedDown},up:{traverse:I4.prevSibling,gather:Bl.before,relative:mi.before,otherRetry:Sl.tryUp,ieRetry:Sl.ieTryUp,failure:Yl.adt.failedUp}};var rc=Z1.immutable('rows','cols');var Vm=function(w,c,i,a){var b=Dk(w);var h=Sm(b,c,i,a);return{mousedown:h.mousedown,mouseover:h.mouseover,mouseup:h.mouseup};};var Wm=function(w,c,i,a){var b=Dk(w);var d=function(){a.clear(c);return S.none();};var k=function(f,s,h,j,l,m){var n=f.raw().which;var o=f.raw().shiftKey===true;var p=J8.retrieve(c,a.selectedSelector()).fold(function(){if(ok.isDown(n)&&o){return $.curry(Qm.select,b,c,i,Tm.down,j,s,a.selectRange);}else if(ok.isUp(n)&&o){return $.curry(Qm.select,b,c,i,Tm.up,j,s,a.selectRange);}else if(ok.isDown(n)){return $.curry(Qm.navigate,b,i,Tm.down,j,s,Qm.lastDownCheck);}else if(ok.isUp(n)){return $.curry(Qm.navigate,b,i,Tm.up,j,s,Qm.firstUpCheck);}else{return S.none;}},function(N8){var Gk=function(t){return function(){var u=zb.findMap(t,function($l){return Hk.update($l.rows(),$l.cols(),c,N8,a);});return u.fold(function(){return J8.getEdges(c,a.firstSelectedSelector(),a.lastSelectedSelector()).map(function(v){var ma=ok.isDown(n)||m.isForward(n)?mi.after:mi.before;b.setRelativeSelection(mi.on(v.first(),0),ma(v.table()));a.clear(c);return jk.response(S.none(),true);});},function(_){return S.some(jk.response(S.none(),true));});};};if(ok.isDown(n)&&o)return Gk([rc(+1,0)]);else if(ok.isUp(n)&&o)return Gk([rc(-1,0)]);else if(m.isBackward(n)&&o)return Gk([rc(0,-1),rc(-1,0)]);else if(m.isForward(n)&&o)return Gk([rc(0,+1),rc(+1,0)]);else if(ok.isNavigation(n)&&o===false)return d;else return S.none;});return p();};var e=function(f,s,h,j,l){return J8.retrieve(c,a.selectedSelector()).fold(function(){var m=f.raw().which;var n=f.raw().shiftKey===true;if(n===false)return S.none();if(ok.isNavigation(m))return Hk.sync(c,i,s,h,j,l,a.selectRange);else return S.none();},S.none);};return{keydown:k,keyup:e};};var Xm={mouse:Vm,keyboard:Wm};var Ym=function(e,c){F1.each(c,function(x){Ec.add(e,x);});};var Zm=function(e,c){F1.each(c,function(x){Ec.remove(e,x);});};var $m=function(e,c){F1.each(c,function(x){Ec.toggle(e,x);});};var _m=function(e,c){return F1.forall(c,function(a){return Ec.has(e,a);});};var an=function(e,c){return F1.exists(c,function(a){return Ec.has(e,a);});};var bn=function(e){var c=e.dom().classList;var r=new Array(c.length);for(var i=0;i<c.length;i++){r[i]=c.item(i);}return r;};var cn=function(e){return xc.supports(e)?bn(e):xc.get(e);};var dn={add:Ym,remove:Zm,toggle:$m,hasAll:_m,hasAny:an,get:cn};var en=function(c){return function(e){Ec.add(e,c);};};var gn=function(c){return function(e){Ec.remove(e,c);};};var hn=function(c){return function(e){dn.remove(e,c);};};var jn=function(c){return function(e){return Ec.has(e,c);};};var kn={addClass:en,removeClass:gn,removeClasses:hn,hasClass:jn};var ln=function(e){var a=kn.addClass(e.selected());var b=kn.removeClasses([e.selected(),e.lastSelected(),e.firstSelected()]);var Jc=function(c){var d=t5.descendants(c,e.selectedSelector());F1.each(d,b);};var s=function(c,L5,d,f){Jc(c);F1.each(L5,a);Ec.add(d,e.firstSelected());Ec.add(f,e.lastSelected());};return{clear:Jc,selectRange:s,selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector};};var mn=function(e){var a=function(c){d5.remove(c,e.selected());d5.remove(c,e.firstSelected());d5.remove(c,e.lastSelected());};var b=function(c){d5.set(c,e.selected(),'1');};var Jc=function(c){var d=t5.descendants(c,e.selectedSelector());F1.each(d,a);};var s=function(c,L5,d,f){Jc(c);F1.each(L5,b);d5.set(d,e.firstSelected(),'1');d5.set(f,e.lastSelected(),'1');};return{clear:Jc,selectRange:s,selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector};};var nn={byClass:ln,byAttr:mn};var pn=function(e){return Ec.has(v2.fromDom(e.target),'ephox-snooker-resizer-bar')===false;};function qn(a,l){var h=Z1.immutableBag(['mousedown','mouseover','mouseup','keyup','keydown'],[]);var b=S.none();var c=nn.byAttr(U8);a.on('init',function(e){var w=a.getWin();var f5=kf(a);var i=nf(a);var s=function(){var a1=a.selection;var c1=v2.fromDom(a1.getStart());var d1=v2.fromDom(a1.getEnd());var e1=i8.sharedOne(V5.table,[c1,d1]);e1.fold(function(){c.clear(f5);},$.noop);};var m=Xm.mouse(w,f5,i,c);var k=Xm.keyboard(w,f5,i,c);var f=function(a1){return a1.raw().shiftKey===true;};var j=function(a1,ik){if(!f(a1)){return;}if(ik.kill()){a1.kill();}ik.selection().each(function(ns){var ma=ti.relative(ns.start(),ns.finish());var c1=Xi.asLtrRange(w,ma);a.selection.setRng(c1);});};var n=function(a1){var c1=t(a1);if(c1.raw().shiftKey&&ok.isNavigation(c1.raw().which)){var d1=a.selection.getRng();var e1=v2.fromDom(d1.startContainer);var a2=v2.fromDom(d1.endContainer);k.keyup(c1,e1,d1.startOffset,a2,d1.endOffset).each(function(ik){j(c1,ik);});}};var o=function(a1){var c1=t(a1);l().each(function(hf){hf.hideBars();});var d1=a.selection.getRng();var e1=v2.fromDom(a.selection.getStart());var a2=v2.fromDom(d1.startContainer);var c2=v2.fromDom(d1.endContainer);var d2=xf.directionAt(e1).isRtl()?ok.rtl:ok.ltr;k.keydown(c1,a2,d1.startOffset,c2,d1.endOffset,d2).each(function(ik){j(c1,ik);});l().each(function(hf){hf.showBars();});};var p=function(a1){return a1.hasOwnProperty('x')&&a1.hasOwnProperty('y');};var t=function(a1){var c1=v2.fromDom(a1.target);var d1=function(){a1.stopPropagation();};var e1=function(){a1.preventDefault();};var a2=$.compose(e1,d1);return{target:$.constant(c1),x:$.constant(p(a1)?a1.x:null),y:$.constant(p(a1)?a1.y:null),stop:d1,prevent:e1,kill:a2,raw:$.constant(a1)};};var u=function(a1){return a1.button===0;};var v=function(a1){if(a1.buttons===undefined){return true;}return(a1.buttons&1)!==0;};var x=function(e){if(u(e)&&pn(e)){m.mousedown(t(e));}};var y=function(e){if(v(e)&&pn(e)){m.mouseover(t(e));}};var _=function(e){if(u(e)&&pn(e)){m.mouseup(t(e));}};a.on('mousedown',x);a.on('mouseover',y);a.on('mouseup',_);a.on('keyup',n);a.on('keydown',o);a.on('nodechange',s);b=S.some(h({mousedown:x,mouseover:y,mouseup:_,keyup:n,keydown:o}));});var d=function(){b.each(function(b){});};return{clear:c.clear,destroy:d};}var rn=function(e){var Y4=function(){var f5=kf(e);return M8.retrieve(f5,U8.selectedSelector()).fold(function(){if(e.selection.getStart()===undefined){return Z8.none();}else{return Z8.single(e.selection);}},function(L5){return Z8.multiple(L5);});};return{get:Y4};};var sn=$f.each;var tn=function(e){var m=[];sn('inserttable tableprops deletetable | cell row column'.split(' '),function(M4){if(M4==='|'){m.push({text:'-'});}else{m.push(e.menuItems[M4]);}});e.addButton('table',{type:'menubutton',title:'Table',menu:m});function c(a){return function(){e.execCommand(a);};}e.addButton('tableprops',{title:'Table properties',onclick:c('mceTableProps'),icon:'table'});e.addButton('tabledelete',{title:'Delete table',onclick:c('mceTableDelete')});e.addButton('tablecellprops',{title:'Cell properties',onclick:c('mceTableCellProps')});e.addButton('tablemergecells',{title:'Merge cells',onclick:c('mceTableMergeCells')});e.addButton('tablesplitcells',{title:'Split cell',onclick:c('mceTableSplitCells')});e.addButton('tableinsertrowbefore',{title:'Insert row before',onclick:c('mceTableInsertRowBefore')});e.addButton('tableinsertrowafter',{title:'Insert row after',onclick:c('mceTableInsertRowAfter')});e.addButton('tabledeleterow',{title:'Delete row',onclick:c('mceTableDeleteRow')});e.addButton('tablerowprops',{title:'Row properties',onclick:c('mceTableRowProps')});e.addButton('tablecutrow',{title:'Cut row',onclick:c('mceTableCutRow')});e.addButton('tablecopyrow',{title:'Copy row',onclick:c('mceTableCopyRow')});e.addButton('tablepasterowbefore',{title:'Paste row before',onclick:c('mceTablePasteRowBefore')});e.addButton('tablepasterowafter',{title:'Paste row after',onclick:c('mceTablePasteRowAfter')});e.addButton('tableinsertcolbefore',{title:'Insert column before',onclick:c('mceTableInsertColBefore')});e.addButton('tableinsertcolafter',{title:'Insert column after',onclick:c('mceTableInsertColAfter')});e.addButton('tabledeletecol',{title:'Delete column',onclick:c('mceTableDeleteCol')});};var un=function(e){var i=function(g){var s=e.dom.is(g,'table')&&e.getBody().contains(g);return s;};var t=Sf(e);if(t.length>0){e.addContextToolbar(i,t.join(' '));}};var vn={addButtons:tn,addToolbars:un};var wn=function(a,s){var t=S.none();var b=[];var c=[];var m=[];var u=[];var n=function(e){e.disabled(true);};var d=function(e){e.disabled(false);};var p=function(){var e=this;b.push(e);t.fold(function(){n(e);},function(t){d(e);});};var f=function(){var e=this;c.push(e);t.fold(function(){n(e);},function(t){d(e);});};var h=function(){var e=this;m.push(e);t.fold(function(){n(e);},function(t){e.disabled(t.mergable().isNone());});};var i=function(){var e=this;u.push(e);t.fold(function(){n(e);},function(t){e.disabled(t.unmergable().isNone());});};var j=function(){t.fold(function(){F1.each(b,n);F1.each(c,n);F1.each(m,n);F1.each(u,n);},function(t){F1.each(b,d);F1.each(c,d);F1.each(m,function(e){e.disabled(t.mergable().isNone());});F1.each(u,function(e){e.disabled(t.unmergable().isNone());});});};a.on('init',function(){a.on('nodechange',function(e){var x=S.from(a.dom.getParent(a.selection.getStart(),'th,td'));t=x.bind(function(y){var K5=v2.fromDom(y);var g=V5.table(K5);return g.map(function(g){return h9.forMenu(s,g,K5);});});j();});});var k=function(){var e='';e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var y=0;y<10;y++){e+='<tr>';for(var x=0;x<10;x++){e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(y*10+x)+'" href="#" '+'data-mce-x="'+x+'" data-mce-y="'+y+'"></a></td>';}e+='</tr>';}e+='</table>';e+='<div class="mce-text-center" role="presentation">1 x 1</div>';return e;};var l=function(a,e,ty,c1){var g=c1.getEl().getElementsByTagName('table')[0];var x,y,d1,K5,e1;var Ca=c1.isRtl()||c1.parent().rel==='tl-tr';g.nextSibling.innerHTML=e+1+' x '+(ty+1);if(Ca){e=9-e;}for(y=0;y<10;y++){for(x=0;x<10;x++){K5=g.rows[y].childNodes[x].firstChild;e1=(Ca?x>=e:x<=e)&&y<=ty;a.dom.toggleClass(K5,'mce-active',e1);if(e1){d1=K5;}}}return d1.parentNode;};var o=Jf(a)===false?{text:'Table',icon:'table',context:'table',onclick:v('mceInsertTable')}:{text:'Table',icon:'table',context:'table',ariaHideMenu:true,onclick:function(e){if(e.aria){this.parent().hideAll();e.stopImmediatePropagation();a.execCommand('mceInsertTable');}},onshow:function(){l(a,0,0,this.menu.items()[0]);},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName('a');a.dom.removeClass(e,'mce-active');a.dom.addClass(e[0],'mce-active');},menu:[{type:'container',html:k(),onPostRender:function(){this.lastX=this.lastY=0;},onmousemove:function(e){var c1=e.target;var x,y;if(c1.tagName.toUpperCase()==='A'){x=parseInt(c1.getAttribute('data-mce-x'),10);y=parseInt(c1.getAttribute('data-mce-y'),10);if(this.isRtl()||this.parent().rel==='tl-tr'){x=9-x;}if(x!==this.lastX||y!==this.lastY){l(a,x,y,e.control);this.lastX=x;this.lastY=y;}}},onclick:function(e){var x=this;if(e.target.tagName.toUpperCase()==='A'){e.preventDefault();e.stopPropagation();x.parent().cancel();a.undoManager.transact(function(){Lg.insert(a,x.lastX+1,x.lastY+1);});a.addVisual();}}}]};function v(e){return function(){a.execCommand(e);};}var w={text:'Table properties',context:'table',onPostRender:p,onclick:v('mceTableProps')};var _={text:'Delete table',context:'table',onPostRender:p,cmd:'mceTableDelete'};var R5={text:'Row',context:'table',menu:[{text:'Insert row before',onclick:v('mceTableInsertRowBefore'),onPostRender:f},{text:'Insert row after',onclick:v('mceTableInsertRowAfter'),onPostRender:f},{text:'Delete row',onclick:v('mceTableDeleteRow'),onPostRender:f},{text:'Row properties',onclick:v('mceTableRowProps'),onPostRender:f},{text:'-'},{text:'Cut row',onclick:v('mceTableCutRow'),onPostRender:f},{text:'Copy row',onclick:v('mceTableCopyRow'),onPostRender:f},{text:'Paste row before',onclick:v('mceTablePasteRowBefore'),onPostRender:f},{text:'Paste row after',onclick:v('mceTablePasteRowAfter'),onPostRender:f}]};var a1={text:'Column',context:'table',menu:[{text:'Insert column before',onclick:v('mceTableInsertColBefore'),onPostRender:f},{text:'Insert column after',onclick:v('mceTableInsertColAfter'),onPostRender:f},{text:'Delete column',onclick:v('mceTableDeleteCol'),onPostRender:f}]};var K5={separator:'before',text:'Cell',context:'table',menu:[{text:'Cell properties',onclick:v('mceTableCellProps'),onPostRender:f},{text:'Merge cells',onclick:v('mceTableMergeCells'),onPostRender:h},{text:'Split cell',onclick:v('mceTableSplitCells'),onPostRender:i}]};a.addMenuItem('inserttable',o);a.addMenuItem('tableprops',w);a.addMenuItem('deletetable',_);a.addMenuItem('row',R5);a.addMenuItem('column',a1);a.addMenuItem('cell',K5);};var xn={addMenuItems:wn};var yn=function(c){return c.get().fold(function(){return;},function(S5){return F1.map(S5,function(R5){return R5.dom();});});};var zn=function(S5,c){var s=F1.map(S5,v2.fromDom);c.set(S.from(s));};var An=function(e,c){return{insertTable:function(Zb,S5){return Lg.insert(e,Zb,S5);},setClipboardRows:function(S5){return zn(S5,c);},getClipboardRows:function(){return yn(c);}};};function Bn(a){var b=Zh(a);var c=qn(a,b.lazyResize);var d=Xf(a,b.lazyWire);var s=rn(a);var f=Ia(S.none());Ug.registerCommands(a,d,c,s,f);l9.registerEvents(a,s,d,c);xn.addMenuItems(a,s);vn.addButtons(a);vn.addToolbars(a);a.on('PreInit',function(){a.serializer.addTempAttr(U8.firstSelected());a.serializer.addTempAttr(U8.lastSelected());});if(Ef(a)){a.on('keydown',function(e){hk.handle(e,a,d,b.lazyWire);});}a.on('remove',function(){b.destroy();c.destroy();});return An(a,f);}q.add('table',Bn);function Cn(){}return Cn;}());})();
