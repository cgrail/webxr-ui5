(function(){var t=(function(){'use strict';var g=tinymce.util.Tools.resolve('tinymce.PluginManager');var a=tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');var b=tinymce.util.Tools.resolve('tinymce.EditorManager');var c=tinymce.util.Tools.resolve('tinymce.Env');var d=tinymce.util.Tools.resolve('tinymce.util.Delay');var f=tinymce.util.Tools.resolve('tinymce.util.Tools');var h=tinymce.util.Tools.resolve('tinymce.util.VK');var j=function(e){return e.getParam('tabfocus_elements',':prev,:next');};var k=function(e){return e.getParam('tab_focus',j(e));};var $={getTabFocus:k};var D=a.DOM;var l=function(e){if(e.keyCode===h.TAB&&!e.ctrlKey&&!e.altKey&&!e.metaKey){e.preventDefault();}};var s=function(n){function o(e){var x,p,v,i;if(e.keyCode!==h.TAB||e.ctrlKey||e.altKey||e.metaKey||e.isDefaultPrevented()){return;}function q(u){p=D.select(':input:enabled,*[tabindex]:not(iframe)');function w(e){return e.nodeName==='BODY'||e.type!=='hidden'&&e.style.display!=='none'&&e.style.visibility!=='hidden'&&w(e.parentNode);}function y(p){return/INPUT|TEXTAREA|BUTTON/.test(p.tagName)&&b.get(e.id)&&p.tabIndex!==-1&&w(p);}f.each(p,function(e,i){if(e.id===n.id){x=i;return false;}});if(u>0){for(i=x+1;i<p.length;i++){if(y(p[i])){return p[i];}}}else{for(i=x-1;i>=0;i--){if(y(p[i])){return p[i];}}}return null;}v=f.explode($.getTabFocus(n));if(v.length===1){v[1]=v[0];v[0]=':prev';}if(e.shiftKey){if(v[0]===':prev'){p=q(-1);}else{p=D.get(v[0]);}}else{if(v[1]===':next'){p=q(1);}else{p=D.get(v[1]);}}if(p){var r=b.get(p.id||p.name);if(p.id&&r){r.focus();}else{d.setTimeout(function(){if(!c.webkit){window.focus();}p.focus();},10);}e.preventDefault();}}n.on('init',function(){if(n.inline){D.setAttrib(n.getBody(),'tabIndex',null);}n.on('keyup',l);if(c.gecko){n.on('keypress keydown',o);}else{n.on('keydown',o);}});};var m={setup:s};g.add('tabfocus',function(e){m.setup(e);});function P(){}return P;}());})();
