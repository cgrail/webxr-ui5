(function(){var t=(function(){'use strict';var g=tinymce.util.Tools.resolve('tinymce.PluginManager');var d=function(){var x=[];for(var a=0;a<arguments.length;a++){x[a]=arguments[a];}};var h=function(f){return function(){var x=[];for(var a=0;a<arguments.length;a++){x[a]=arguments[a];}return f();};};var l=function(f,a){return function(){var x=[];for(var b=0;b<arguments.length;b++){x[b]=arguments[b];}return f(a.apply(null,arguments));};};var m=function(v){return function(){return v;};};var p=function(x){return x;};var q=function(a,b){return a===b;};var r=function(f){var x=[];for(var a=1;a<arguments.length;a++){x[a-1]=arguments[a];}var b=new Array(arguments.length-1);for(var i=1;i<arguments.length;i++)b[i-1]=arguments[i];return function(){var x=[];for(var a=0;a<arguments.length;a++){x[a]=arguments[a];}var n=new Array(arguments.length);for(var j=0;j<n.length;j++)n[j]=arguments[j];var c=b.concat(n);return f.apply(null,c);};};var s=function(f){return function(){var x=[];for(var a=0;a<arguments.length;a++){x[a]=arguments[a];}return!f.apply(null,arguments);};};var u=function(a){return function(){throw new Error(a);};};var w=function(f){return f();};var y=function(f){f();};var z=m(false);var A=m(true);var $={noop:d,noarg:h,compose:l,constant:m,identity:p,tripleEquals:q,curry:r,not:s,die:u,apply:w,call:y,never:z,always:A};var B=tinymce.util.Tools.resolve('tinymce.util.Tools');var C=tinymce.util.Tools.resolve('tinymce.util.XHR');var D=tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');var E=function(e){return e.getParam('template_cdate_classes','cdate');};var F=function(e){return e.getParam('template_mdate_classes','mdate');};var G=function(e){return e.getParam('template_selected_content_classes','selcontent');};var H=function(e){return e.getParam('template_preview_replace_values');};var I=function(e){return e.getParam('template_replace_values');};var J=function(e){return e.templates;};var K=function(e){return e.getParam('template_cdate_format',e.getLang('template.cdate_format'));};var L=function(e){return e.getParam('template_mdate_format',e.getLang('template.mdate_format'));};var M=function(e){return e.getParam('template_popup_width',600);};var N=function(e){return Math.min(D.DOM.getViewPort().h,e.getParam('template_popup_height',500));};var O={getCreationDateClasses:E,getModificationDateClasses:F,getSelectedContentClasses:G,getPreviewReplaceValues:H,getTemplateReplaceValues:I,getTemplates:J,getCdateFormat:K,getMdateFormat:L,getDialogWidth:M,getDialogHeight:N};var P=function(v,a){v=''+v;if(v.length<a){for(var i=0;i<a-v.length;i++){v='0'+v;}}return v;};var Q=function(e,f,a){var b='Sun Mon Tue Wed Thu Fri Sat Sun'.split(' ');var c='Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday'.split(' ');var i='Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'.split(' ');var j='January February March April May June July August September October November December'.split(' ');a=a||new Date();f=f.replace('%D','%m/%d/%Y');f=f.replace('%r','%I:%M:%S %p');f=f.replace('%Y',''+a.getFullYear());f=f.replace('%y',''+a.getYear());f=f.replace('%m',P(a.getMonth()+1,2));f=f.replace('%d',P(a.getDate(),2));f=f.replace('%H',''+P(a.getHours(),2));f=f.replace('%M',''+P(a.getMinutes(),2));f=f.replace('%S',''+P(a.getSeconds(),2));f=f.replace('%I',''+((a.getHours()+11)%12+1));f=f.replace('%p',''+(a.getHours()<12?'AM':'PM'));f=f.replace('%B',''+e.translate(j[a.getMonth()]));f=f.replace('%b',''+e.translate(i[a.getMonth()]));f=f.replace('%A',''+e.translate(c[a.getDay()]));f=f.replace('%a',''+e.translate(b[a.getDay()]));f=f.replace('%%','%');return f;};var R={getDateTime:Q};var S=function(e,c){return function(){var a=O.getTemplates(e);if(typeof a==='function'){a(c);return;}if(typeof a==='string'){C.send({url:a,success:function(b){c(JSON.parse(b));}});}else{c(a);}};};var T=function(e,a,b){B.each(b,function(v,k){if(typeof v==='function'){v=v(k);}a=a.replace(new RegExp('\\{\\$'+k+'\\}','g'),v);});return a;};var U=function(a,e){var b=a.dom,c=O.getTemplateReplaceValues(a);B.each(b.select('*',e),function(e){B.each(c,function(v,k){if(b.hasClass(e,k)){if(typeof c[k]==='function'){c[k](e);}}});});};var V=function(n,c){return new RegExp('\\b'+c+'\\b','g').test(n.className);};var W=function(e,a,b){var c;var n;var f=e.dom;var i=e.selection.getContent();b=T(e,b,O.getTemplateReplaceValues(e));c=f.create('div',null,b);n=f.select('.mceTmpl',c);if(n&&n.length>0){c=f.create('div',null);c.appendChild(n[0].cloneNode(true));}B.each(f.select('*',c),function(n){if(V(n,O.getCreationDateClasses(e).replace(/\s+/g,'|'))){n.innerHTML=R.getDateTime(e,O.getCdateFormat(e));}if(V(n,O.getModificationDateClasses(e).replace(/\s+/g,'|'))){n.innerHTML=R.getDateTime(e,O.getMdateFormat(e));}if(V(n,O.getSelectedContentClasses(e).replace(/\s+/g,'|'))){n.innerHTML=i;}});U(e,c);e.execCommand('mceInsertContent',false,c.innerHTML);e.addVisual();};var X={createTemplateList:S,replaceTemplateValues:T,replaceVals:U,insertTemplate:W};var Y=function(e){e.addCommand('mceInsertTemplate',$.curry(X.insertTemplate,e));};var Z={register:Y};var _=function(a){a.on('PreProcess',function(o){var b=a.dom,c=O.getMdateFormat(a);B.each(b.select('div',o.node),function(e){if(b.hasClass(e,'mceTmpl')){B.each(b.select('*',e),function(e){if(b.hasClass(e,a.getParam('template_mdate_classes','mdate').replace(/\s+/g,'|'))){e.innerHTML=R.getDateTime(a,c);}});X.replaceVals(a,e);}});});};var a1={setup:_};var b1=function(e,a,b){if(b.indexOf('<html>')===-1){var c='';B.each(e.contentCSS,function(j){c+='<link type="text/css" rel="stylesheet" href="'+e.documentBaseURI.toAbsolute(j)+'">';});var f=e.settings.body_class||'';if(f.indexOf('=')!==-1){f=e.getParam('body_class','','hash');f=f[e.id]||'';}b='<!DOCTYPE html>'+'<html>'+'<head>'+c+'</head>'+'<body class="'+f+'">'+b+'</body>'+'</html>';}b=X.replaceTemplateValues(e,b,O.getPreviewReplaceValues(e));var i=a.find('iframe')[0].getEl().contentWindow.document;i.open();i.write(b);i.close();};var c1=function(a,b){var c;var v=[];var f;if(!b||b.length===0){var i=a.translate('No templates defined.');a.notificationManager.open({text:i,type:'info'});return;}B.each(b,function(t){v.push({selected:!v.length,text:t.title,value:{url:t.url,content:t.content,description:t.description}});});var o=function(e){var j=e.control.value();if(j.url){C.send({url:j.url,success:function(k){f=k;b1(a,c,f);}});}else{f=j.content;b1(a,c,f);}c.find('#description')[0].text(e.control.value().description);};c=a.windowManager.open({title:'Insert template',layout:'flex',direction:'column',align:'stretch',padding:15,spacing:10,items:[{type:'form',flex:0,padding:0,items:[{type:'container',label:'Templates',items:{type:'listbox',label:'Templates',name:'template',values:v,onselect:o}}]},{type:'label',name:'description',label:'Description',text:'\xA0'},{type:'iframe',flex:1,border:1}],onsubmit:function(){X.insertTemplate(a,false,f);},minWidth:O.getDialogWidth(a),minHeight:O.getDialogHeight(a)});c.find('listbox')[0].fire('select');};var d1={open:c1};var e1=function(e){return function(a){d1.open(e,a);};};var f1=function(e){e.addButton('template',{title:'Insert template',onclick:X.createTemplateList(e.settings,e1(e))});e.addMenuItem('template',{text:'Template',onclick:X.createTemplateList(e.settings,e1(e)),icon:'template',context:'insert'});};var g1={register:f1};g.add('template',function(e){g1.register(e);Z.register(e);a1.setup(e);});function h1(){}return h1;}());})();
