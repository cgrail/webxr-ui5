(function(){var l=(function(){'use strict';var g=tinymce.util.Tools.resolve('tinymce.PluginManager');var b=tinymce.util.Tools.resolve('tinymce.util.VK');var c=function(e){return typeof e.link_assume_external_targets==='boolean'?e.link_assume_external_targets:false;};var h=function(e){return typeof e.link_context_toolbar==='boolean'?e.link_context_toolbar:false;};var d=function(e){return e.link_list;};var f=function(e){return typeof e.default_link_target==='string';};var i=function(e){return e.default_link_target;};var j=function(e){return e.target_list;};var s=function(e,a){e.settings.target_list=a;};var k=function(e){return j(e)!==false;};var m=function(e){return e.rel_list;};var n=function(e){return m(e)!==undefined;};var o=function(e){return e.link_class_list;};var p=function(e){return o(e)!==undefined;};var q=function(e){return e.link_title!==false;};var r=function(e){return typeof e.allow_unsafe_link_target==='boolean'?e.allow_unsafe_link_target:false;};var $={assumeExternalTargets:c,hasContextToolbar:h,getLinkList:d,hasDefaultLinkTarget:f,getDefaultLinkTarget:i,getTargetList:j,setTargetList:s,shouldShowTargetList:k,getRelList:m,hasRelList:n,getLinkClassList:o,hasLinkClassList:p,shouldShowLinkTitle:q,allowUnsafeLinkTarget:r};var t=tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');var u=tinymce.util.Tools.resolve('tinymce.Env');var v=function(l,e){document.body.appendChild(l);l.dispatchEvent(e);document.body.removeChild(l);};var w=function(a){if(!u.ie||u.ie>10){var l=document.createElement('a');l.target='_blank';l.href=a;l.rel='noreferrer noopener';var e=document.createEvent('MouseEvents');e.initMouseEvent('click',true,true,window,0,0,0,0,0,false,false,false,false,0,null);v(l,e);}else{var p1=window.open('','_blank');if(p1){p1.opener=null;var q1=p1.document;q1.open();q1.write('<meta http-equiv="refresh" content="0; url='+t.DOM.encode(a)+'">');q1.close();}}};var x={open:w};var y=tinymce.util.Tools.resolve('tinymce.util.Tools');var z=function(a,e){var p1=['noopener'];var q1=a?a.split(/\s+/):[];var r1=function(a){return y.trim(a.sort().join(' '));};var s1=function(a){a=t1(a);return a.length?a.concat(p1):p1;};var t1=function(a){return a.filter(function(u1){return y.inArray(p1,u1)===-1;});};q1=e?s1(q1):t1(q1);return q1.length?r1(q1):null;};var A=function(a){return a.replace(/\uFEFF/g,'');};var B=function(e,a){a=a||e.selection.getNode();if(G(a)){return e.dom.select('a[href]',a)[0];}else{return e.dom.getParent(a,'a[href]');}};var C=function(a,e){var p1=e?e.innerText||e.textContent:a.getContent({format:'text'});return A(p1);};var D=function(e){return e&&e.nodeName==='A'&&e.href;};var E=function(e){return y.grep(e,D).length>0;};var F=function(a){if(/</.test(a)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(a)||a.indexOf('href=')===-1)){return false;}return true;};var G=function(a){return a&&a.nodeName==='FIGURE'&&/\bimage\b/i.test(a.className);};var l=function(e,N){return function(a){e.undoManager.transact(function(){var p1=e.selection.getNode();var q1=B(e,p1);var r1={href:a.href,target:a.target?a.target:null,rel:a.rel?a.rel:null,class:a.class?a.class:null,title:a.title?a.title:null};if(!$.hasRelList(e.settings)&&$.allowUnsafeLinkTarget(e.settings)===false){r1.rel=z(r1.rel,r1.target==='_blank');}if(a.href===N.href){N.attach();N={};}if(q1){e.focus();if(a.hasOwnProperty('text')){if('innerText'in q1){q1.innerText=a.text;}else{q1.textContent=a.text;}}e.dom.setAttribs(q1,r1);e.selection.select(q1);e.undoManager.add();}else{if(G(p1)){J(e,p1,r1);}else if(a.hasOwnProperty('text')){e.insertContent(e.dom.createHTML('a',r1,e.dom.encode(a.text)));}else{e.execCommand('mceInsertLink',false,r1);}}});};};var H=function(e){return function(){e.undoManager.transact(function(){var a=e.selection.getNode();if(G(a)){I(e,a);}else{e.execCommand('unlink');}});};};var I=function(e,p1){var a,q1;q1=e.dom.select('img',p1)[0];if(q1){a=e.dom.getParents(q1,'a[href]',p1)[0];if(a){a.parentNode.insertBefore(q1,a);e.dom.remove(a);}}};var J=function(e,p1,q1){var a,r1;r1=e.dom.select('img',p1)[0];if(r1){a=e.dom.create('a',q1);r1.parentNode.insertBefore(a,r1);a.appendChild(r1);}};var K={link:l,unlink:H,isLink:D,hasLinks:E,isOnlyTextSelected:F,getAnchorElement:B,getAnchorText:C,toggleTargetRules:z};var L=tinymce.util.Tools.resolve('tinymce.util.Delay');var M=tinymce.util.Tools.resolve('tinymce.util.XHR');var N={};var O=function(e,a){var p1=$.getLinkList(e.settings);if(typeof p1==='string'){M.send({url:p1,success:function(q1){a(e,JSON.parse(q1));}});}else if(typeof p1==='function'){p1(function(q1){a(e,q1);});}else{a(e,p1);}};var P=function(a,e,p1){var q1=function(r1,s1){s1=s1||[];y.each(r1,function(t1){var u1={text:t1.text||t1.title};if(t1.menu){u1.menu=q1(t1.menu);}else{u1.value=t1.value;if(e){e(u1);}}s1.push(u1);});return s1;};return q1(a,p1||[]);};var Q=function(e,a,p1){var q1=e.selection.getRng();L.setEditorTimeout(e,function(){e.windowManager.confirm(a,function(r1){e.selection.setRng(q1);p1(r1);});});};var R=function(a,p1){var q1={};var r1=a.selection;var s1=a.dom;var t1,u1;var v1,w1,x1,y1,z1,A1,B1,C1,D1;var E1=function(e){var J1=v1.find('#text');if(!J1.value()||e.lastControl&&J1.value()===e.lastControl.text()){J1.value(e.control.text());}v1.find('#href').value(e.control.value());};var F1=function(e){var J1=[];y.each(a.dom.select('a:not([href])'),function(K1){var id=K1.name||K1.id;if(id){J1.push({text:id,value:'#'+id,selected:e.indexOf('#'+id)!==-1});}});if(J1.length){J1.unshift({text:'None',value:''});return{name:'anchor',type:'listbox',label:'Anchors',values:J1,onselect:E1};}};var G1=function(){if(!u1&&w1&&!q1.text){this.parent().parent().find('#text')[0].value(this.value());}};var H1=function(e){var J1=e.meta||{};if(y1){y1.value(a.convertURL(this.value(),'href'));}y.each(e.meta,function(D1,K1){var L1=v1.find('#'+K1);if(K1==='text'){if(u1.length===0){L1.value(D1);q1.text=D1;}}else{L1.value(D1);}});if(J1.attach){N={href:this.value(),attach:J1.attach};}if(!J1.text){G1.call(this);}};var I1=function(e){e.meta=v1.toJSON();};w1=K.isOnlyTextSelected(r1.getContent());t1=K.getAnchorElement(a);q1.text=u1=K.getAnchorText(a.selection,t1);q1.href=t1?s1.getAttrib(t1,'href'):'';if(t1){q1.target=s1.getAttrib(t1,'target');}else if($.hasDefaultLinkTarget(a.settings)){q1.target=$.getDefaultLinkTarget(a.settings);}if(D1=s1.getAttrib(t1,'rel')){q1.rel=D1;}if(D1=s1.getAttrib(t1,'class')){q1.class=D1;}if(D1=s1.getAttrib(t1,'title')){q1.title=D1;}if(w1){x1={name:'text',type:'textbox',size:40,label:'Text to display',onchange:function(){q1.text=this.value();}};}if(p1){y1={type:'listbox',label:'Link list',values:P(p1,function(e){e.value=a.convertURL(e.value||e.url,'href');},[{text:'None',value:''}]),onselect:E1,value:a.convertURL(q1.href,'href'),onPostRender:function(){y1=this;}};}if($.shouldShowTargetList(a.settings)){if($.getTargetList(a.settings)===undefined){$.setTargetList(a,[{text:'None',value:''},{text:'New window',value:'_blank'}]);}A1={name:'target',type:'listbox',label:'Target',values:P($.getTargetList(a.settings))};}if($.hasRelList(a.settings)){z1={name:'rel',type:'listbox',label:'Rel',values:P($.getRelList(a.settings),function(e){if($.allowUnsafeLinkTarget(a.settings)===false){e.value=K.toggleTargetRules(e.value,q1.target==='_blank');}})};}if($.hasLinkClassList(a.settings)){B1={name:'class',type:'listbox',label:'Class',values:P($.getLinkClassList(a.settings),function(e){if(e.value){e.textStyle=function(){return a.formatter.getCssText({inline:'a',classes:[e.value]});};}})};}if($.shouldShowLinkTitle(a.settings)){C1={name:'title',type:'textbox',label:'Title',value:q1.title};}v1=a.windowManager.open({title:'Insert link',data:q1,body:[{name:'href',type:'filepicker',filetype:'file',size:40,autofocus:true,label:'Url',onchange:H1,onkeyup:G1,onpaste:G1,onbeforecall:I1},x1,C1,F1(q1.href),y1,z1,A1,B1],onSubmit:function(e){var c=$.assumeExternalTargets(a.settings);var J1=K.link(a,N);var K1=K.unlink(a);var L1=y.extend({},q1,e.data);var M1=L1.href;if(!M1){K1();return;}if(!w1||L1.text===u1){delete L1.text;}if(M1.indexOf('@')>0&&M1.indexOf('//')===-1&&M1.indexOf('mailto:')===-1){Q(a,'The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?',function(N1){if(N1){L1.href='mailto:'+M1;}J1(L1);});return;}if(c===true&&!/^\w+:/i.test(M1)||c===false&&/^\s*www[\.|\d\.]/i.test(M1)){Q(a,'The URL you entered seems to be an external link. Do you want to add the required http:// prefix?',function(N1){if(N1){L1.href='http://'+M1;}J1(L1);});return;}J1(L1);}});};var S=function(e){O(e,R);};var T={open:S};var U=function(e,a){return e.dom.getParent(a,'a[href]');};var V=function(e){return U(e,e.selection.getStart());};var W=function(e){var a=e.getAttribute('data-mce-href');return a?a:e.getAttribute('href');};var X=function(e){var a=e.plugins.contextmenu;return a?a.isContextMenuVisible():false;};var Y=function(e){return e.altKey===true&&e.shiftKey===false&&e.ctrlKey===false&&e.metaKey===false;};var Z=function(e,a){if(a){var p1=W(a);if(/^#/.test(p1)){var q1=e.$(p1);if(q1.length){e.selection.scrollIntoView(q1[0],true);}}else{x.open(a.href);}}};var _=function(e){return function(){T.open(e);};};var a1=function(e){return function(){Z(e,V(e));};};var b1=function(e){return function(a){var p1,q1,r1;if($.hasContextToolbar(e.settings)&&!X(e)&&K.isLink(a)){p1=e.selection;q1=p1.getRng();r1=q1.startContainer;if(r1.nodeType===3&&p1.isCollapsed()&&q1.startOffset>0&&q1.startOffset<r1.data.length){return true;}}return false;};};var c1=function(a){a.on('click',function(e){var l=U(a,e.target);if(l&&b.metaKeyPressed(e)){e.preventDefault();Z(a,l);}});a.on('keydown',function(e){var l=V(a);if(l&&e.keyCode===13&&Y(e)){e.preventDefault();Z(a,l);}});};var d1=function(a){return function(){var p1=this;a.on('nodechange',function(e){p1.active(!a.readonly&&!!K.getAnchorElement(a,e.element));});};};var e1=function(a){return function(){var p1=this;var q1=function(e){if(K.hasLinks(e.parents)){p1.show();}else{p1.hide();}};if(!K.hasLinks(a.dom.getParents(a.selection.getStart()))){p1.hide();}a.on('nodechange',q1);p1.on('remove',function(){a.off('nodechange',q1);});};};var f1={openDialog:_,gotoSelectedLink:a1,leftClickedOnAHref:b1,setupGotoLinks:c1,toggleActiveState:d1,toggleViewLinkState:e1};var g1=function(e){e.addCommand('mceLink',f1.openDialog(e));};var h1={register:g1};var i1=function(e){e.addShortcut('Meta+K','',f1.openDialog(e));};var j1={setup:i1};var k1=function(e){e.addButton('link',{active:false,icon:'link',tooltip:'Insert/edit link',onclick:f1.openDialog(e),onpostrender:f1.toggleActiveState(e)});e.addButton('unlink',{active:false,icon:'unlink',tooltip:'Remove link',onclick:K.unlink(e),onpostrender:f1.toggleActiveState(e)});if(e.addContextToolbar){e.addButton('openlink',{icon:'newtab',tooltip:'Open link',onclick:f1.gotoSelectedLink(e)});}};var l1=function(e){e.addMenuItem('openlink',{text:'Open link',icon:'newtab',onclick:f1.gotoSelectedLink(e),onPostRender:f1.toggleViewLinkState(e),prependToContext:true});e.addMenuItem('link',{icon:'link',text:'Link',shortcut:'Meta+K',onclick:f1.openDialog(e),stateSelector:'a[href]',context:'insert',prependToContext:true});e.addMenuItem('unlink',{icon:'unlink',text:'Remove link',onclick:K.unlink(e),stateSelector:'a[href]'});};var m1=function(e){if(e.addContextToolbar){e.addContextToolbar(f1.leftClickedOnAHref(e),'openlink | link unlink');}};var n1={setupButtons:k1,setupMenuItems:l1,setupContextToolbars:m1};g.add('link',function(e){n1.setupButtons(e);n1.setupMenuItems(e);n1.setupContextToolbars(e);f1.setupGotoLinks(e);h1.register(e);j1.setup(e);});function o1(){}return o1;}());})();
