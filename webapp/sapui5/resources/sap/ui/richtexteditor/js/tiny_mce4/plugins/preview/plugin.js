(function(){var p=(function(){'use strict';var g=tinymce.util.Tools.resolve('tinymce.PluginManager');var a=tinymce.util.Tools.resolve('tinymce.Env');var b=function(e){return parseInt(e.getParam('plugin_preview_width','650'),10);};var c=function(e){return parseInt(e.getParam('plugin_preview_height','500'),10);};var d=function(e){return e.getParam('content_style','');};var $={getPreviewDialogWidth:b,getPreviewDialogHeight:c,getContentStyle:d};var f=tinymce.util.Tools.resolve('tinymce.util.Tools');var h=function(e){var q;var s='';var t=e.dom.encode;var u=$.getContentStyle(e);s+='<base href="'+t(e.documentBaseURI.getURI())+'">';if(u){s+='<style type="text/css">'+u+'</style>';}f.each(e.contentCSS,function(z){s+='<link type="text/css" rel="stylesheet" href="'+t(e.documentBaseURI.toAbsolute(z))+'">';});var v=e.settings.body_id||'tinymce';if(v.indexOf('=')!==-1){v=e.getParam('body_id','','hash');v=v[e.id]||v;}var w=e.settings.body_class||'';if(w.indexOf('=')!==-1){w=e.getParam('body_class','','hash');w=w[e.id]||'';}var x='<script>'+'document.addEventListener && document.addEventListener("click", function(e) {'+'for (var elm = e.target; elm; elm = elm.parentNode) {'+'if (elm.nodeName === "A") {'+'e.preventDefault();'+'}'+'}'+'}, false);'+'</script> ';var y=e.settings.directionality?' dir="'+e.settings.directionality+'"':'';q='<!DOCTYPE html>'+'<html>'+'<head>'+s+'</head>'+'<body id="'+t(v)+'" class="mce-content-body '+t(w)+'"'+t(y)+'>'+e.getContent()+x+'</body>'+'</html>';return q;};var i=function(e,q,s){var t=h(e);if(!s){var u=q.contentWindow.document;u.open();u.write(t);u.close();}else{q.src='data:text/html;charset=utf-8,'+encodeURIComponent(t);}};var j={getPreviewHtml:h,injectIframeContent:i};var o=function(q){var s=!a.ie;var t='<iframe src="" frameborder="0"'+(s?' sandbox="allow-scripts"':'')+'></iframe>';var u=$.getPreviewDialogWidth(q);var v=$.getPreviewDialogHeight(q);q.windowManager.open({title:'Preview',width:u,height:v,html:t,buttons:{text:'Close',onclick:function(e){e.control.parent().parent().close();}},onPostRender:function(e){var w=e.control.getEl('body').firstChild;j.injectIframeContent(q,w,s);}});};var k={open:o};var r=function(e){e.addCommand('mcePreview',function(){k.open(e);});};var l={register:r};var m=function(e){e.addButton('preview',{title:'Preview',cmd:'mcePreview'});e.addMenuItem('preview',{text:'Preview',cmd:'mcePreview',context:'view'});};var n={register:m};g.add('preview',function(e){l.register(e);n.register(e);});function P(){}return P;}());})();
