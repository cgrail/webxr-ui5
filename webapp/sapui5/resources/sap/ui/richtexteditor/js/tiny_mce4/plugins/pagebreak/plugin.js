(function(){var p=(function(){'use strict';var g=tinymce.util.Tools.resolve('tinymce.PluginManager');var b=tinymce.util.Tools.resolve('tinymce.Env');var c=function(e){return e.getParam('pagebreak_separator','<!-- pagebreak -->');};var s=function(e){return e.getParam('pagebreak_split_block',false);};var $={getSeparatorHtml:c,shouldSplitBlock:s};var d=function(){return'mce-pagebreak';};var f=function(){return'<img src="'+b.transparentSrc+'" class="'+d()+'" data-mce-resize="false" data-mce-placeholder />';};var h=function(q){var t=$.getSeparatorHtml(q);var u=new RegExp(t.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return'\\'+a;}),'gi');q.on('BeforeSetContent',function(e){e.content=e.content.replace(u,f());});q.on('PreInit',function(){q.serializer.addNodeFilter('img',function(a){var i=a.length,e,v;while(i--){e=a[i];v=e.attr('class');if(v&&v.indexOf('mce-pagebreak')!==-1){var w=e.parent;if(q.schema.getBlockElements()[w.name]&&$.shouldSplitBlock(q)){w.type=3;w.value=t;w.raw=true;e.remove();continue;}e.type=3;e.value=t;e.raw=true;}}});});};var j={setup:h,getPlaceholderHtml:f,getPageBreakClass:d};var r=function(e){e.addCommand('mcePageBreak',function(){if(e.settings.pagebreak_split_block){e.insertContent('<p>'+j.getPlaceholderHtml()+'</p>');}else{e.insertContent(j.getPlaceholderHtml());}});};var k={register:r};var l=function(a){a.on('ResolveName',function(e){if(e.target.nodeName==='IMG'&&a.dom.hasClass(e.target,j.getPageBreakClass())){e.name='pagebreak';}});};var m={setup:l};var n=function(e){e.addButton('pagebreak',{title:'Page break',cmd:'mcePageBreak'});e.addMenuItem('pagebreak',{text:'Page break',icon:'pagebreak',cmd:'mcePageBreak',context:'insert'});};var o={register:n};g.add('pagebreak',function(e){k.register(e);o.register(e);j.setup(e);m.setup(e);});function P(){}return P;}());})();
