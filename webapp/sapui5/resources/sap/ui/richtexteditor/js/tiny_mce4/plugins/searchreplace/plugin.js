(function(){var s=(function(){'use strict';var C=function(i){var e=i;var z=function(){return e;};var l=function(v){e=v;};var m=function(){return C(z());};return{get:z,set:l,clone:m};};var g=tinymce.util.Tools.resolve('tinymce.PluginManager');var a=tinymce.util.Tools.resolve('tinymce.util.Tools');function b(e){return e&&e.nodeType===1&&e.contentEditable==='false';}function f(e,v,J,K,L){var m;var M=[];var N,O=0,Q;var R,S,T;Q=v.ownerDocument;R=L.getBlockElements();S=L.getWhiteSpaceElements();T=L.getShortEndedElements();function U(m,K){K=K||0;if(!m[0]){throw new Error('findAndReplaceDOMText cannot handle zero-length matches');}var i=m.index;if(K>0){var l=m[K];if(!l){throw new Error('Invalid capture group');}i+=m[0].indexOf(l);m[0]=l;}return[i,i+m[0].length,[m[0]]];}function V(v){var i;if(v.nodeType===3){return v.data;}if(S[v.nodeName]&&!R[v.nodeName]){return'';}i='';if(b(v)){return'\n';}if(R[v.nodeName]||T[v.nodeName]){i+='\n';}if(v=v.firstChild){do{i+=V(v);}while(v=v.nextSibling);}return i;}function W(v,M,i){var l,Y,Z,_,a1=[],b1=0,c1=v,d1=M.shift(),e1=0;out:while(true){if(R[c1.nodeName]||T[c1.nodeName]||b(c1)){b1++;}if(c1.nodeType===3){if(!Y&&c1.length+b1>=d1[1]){Y=c1;_=d1[1]-b1;}else if(l){a1.push(c1);}if(!l&&c1.length+b1>d1[0]){l=c1;Z=d1[0]-b1;}b1+=c1.length;}if(l&&Y){c1=i({startNode:l,startNodeIndex:Z,endNode:Y,endNodeIndex:_,innerNodes:a1,match:d1[2],matchIndex:e1});b1-=Y.length-_;l=null;Y=null;a1=[];d1=M.shift();e1++;if(!d1){break;}}else if((!S[c1.nodeName]||R[c1.nodeName])&&c1.firstChild){if(!b(c1)){c1=c1.firstChild;continue;}}else if(c1.nextSibling){c1=c1.nextSibling;continue;}while(true){if(c1.nextSibling){c1=c1.nextSibling;break;}else if(c1.parentNode!==v){c1=c1.parentNode;}else{break out;}}}}function X(Y){var Z;if(typeof Y!=='function'){var _=Y.nodeType?Y:Q.createElement(Y);Z=function(i,l){var a1=_.cloneNode(false);a1.setAttribute('data-mce-index',l);if(i){a1.appendChild(Q.createTextNode(i));}return a1;};}else{Z=Y;}return function(a1){var b1;var c1;var d1;var e1=a1.startNode;var f1=a1.endNode;var g1=a1.matchIndex;if(e1===f1){var h1=e1;d1=h1.parentNode;if(a1.startNodeIndex>0){b1=Q.createTextNode(h1.data.substring(0,a1.startNodeIndex));d1.insertBefore(b1,h1);}var el=Z(a1.match[0],g1);d1.insertBefore(el,h1);if(a1.endNodeIndex<h1.length){c1=Q.createTextNode(h1.data.substring(a1.endNodeIndex));d1.insertBefore(c1,h1);}h1.parentNode.removeChild(h1);return el;}b1=Q.createTextNode(e1.data.substring(0,a1.startNodeIndex));c1=Q.createTextNode(f1.data.substring(a1.endNodeIndex));var j1=Z(e1.data.substring(a1.startNodeIndex),g1);var k1=[];for(var i=0,l=a1.innerNodes.length;i<l;++i){var l1=a1.innerNodes[i];var m1=Z(l1.data,g1);l1.parentNode.replaceChild(m1,l1);k1.push(m1);}var n1=Z(f1.data.substring(0,a1.endNodeIndex),g1);d1=e1.parentNode;d1.insertBefore(b1,e1);d1.insertBefore(j1,e1);d1.removeChild(e1);d1=f1.parentNode;d1.insertBefore(n1,f1);d1.insertBefore(c1,f1);d1.removeChild(f1);return n1;};}N=V(v);if(!N){return;}if(e.global){while(m=e.exec(N)){M.push(U(m,K));}}else{m=N.match(e);M.push(U(m,K));}if(M.length){O=M.length;W(v,M,X(J));}return O;}var $={findAndReplaceDOMText:f};var c=function(e){var v=e.getAttribute('data-mce-index');if(typeof v==='number'){return''+v;}return v;};var d=function(e,i,l){var m,v;v=e.dom.create('span',{'data-mce-bogus':1});v.className='mce-match-marker';m=e.getBody();t(e,i,false);return $.findAndReplaceDOMText(l,m,v,false,e.schema);};var u=function(e){var i=e.parentNode;if(e.firstChild){i.insertBefore(e.firstChild,e);}e.parentNode.removeChild(e);};var h=function(e,l){var m;var v=[];m=a.toArray(e.getBody().getElementsByTagName('span'));if(m.length){for(var i=0;i<m.length;i++){var J=c(m[i]);if(J===null||!J.length){continue;}if(J===l.toString()){v.push(m[i]);}}}return v;};var j=function(e,i,l){var m=i.get();var v=e.dom;l=l!==false;if(l){m++;}else{m--;}v.removeClass(h(e,i.get()),'mce-match-marker-selected');var J=h(e,m);if(J.length){v.addClass(h(e,m),'mce-match-marker-selected');e.selection.scrollIntoView(J[0]);return m;}return-1;};var r=function(e,i){var l=i.parentNode;e.remove(i);if(e.isEmpty(l)){e.remove(l);}};var k=function(e,i,l,m,v){l=l.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,'\\$&');l=l.replace(/\s/g,'\\s');l=v?'\\b'+l+'\\b':l;var J=d(e,i,new RegExp(l,m?'g':'gi'));if(J){i.set(-1);i.set(j(e,i,true));}return J;};var n=function(e,i){var l=j(e,i,true);if(l!==-1){i.set(l);}};var p=function(e,i){var l=j(e,i,false);if(l!==-1){i.set(l);}};var o=function(e){var m=c(e);return m!==null&&m.length>0;};var q=function(e,l,m,v,J){var i,K,L,M,N,O=l.get(),Q;v=v!==false;L=e.getBody();K=a.grep(a.toArray(L.getElementsByTagName('span')),o);for(i=0;i<K.length;i++){var R=c(K[i]);M=N=parseInt(R,10);if(J||M===l.get()){if(m.length){K[i].firstChild.nodeValue=m;u(K[i]);}else{r(e.dom,K[i]);}while(K[++i]){M=parseInt(c(K[i]),10);if(M===N){r(e.dom,K[i]);}else{i--;break;}}if(v){O--;}}else if(N>l.get()){K[i].setAttribute('data-mce-index',N-1);}}l.set(O);if(v){Q=w(e,l);n(e,l);}else{Q=x(e,l);p(e,l);}return!J&&Q;};var t=function(e,l,m){var i,v,J,K;v=a.toArray(e.getBody().getElementsByTagName('span'));for(i=0;i<v.length;i++){var L=c(v[i]);if(L!==null&&L.length){if(L===l.get().toString()){if(!J){J=v[i].firstChild;}K=v[i].firstChild;}u(v[i]);}}if(J&&K){var M=e.dom.createRng();M.setStart(J,0);M.setEnd(K,K.data.length);if(m!==false){e.selection.setRng(M);}return M;}};var w=function(e,i){return h(e,i.get()+1).length>0;};var x=function(e,i){return h(e,i.get()-1).length>0;};var y={done:t,find:k,next:n,prev:p,replace:q,hasNext:w,hasPrev:x};var z=function(e,i){var t=function(l){return y.done(e,i,l);};var k=function(l,m,v){return y.find(e,i,l,m,v);};var n=function(){return y.next(e,i);};var p=function(){return y.prev(e,i);};var q=function(l,m,v){return y.replace(e,i,l,m,v);};return{done:t,find:k,next:n,prev:p,replace:q};};var A={get:z};var B=function(i,l){var m={},v;i.undoManager.add();v=a.trim(i.selection.getContent({format:'text'}));function J(){L.statusbar.find('#next').disabled(y.hasNext(i,l)===false);L.statusbar.find('#prev').disabled(y.hasPrev(i,l)===false);}function K(){i.windowManager.alert('Could not find the specified string.',function(){L.find('#find')[0].focus();});}var L=i.windowManager.open({layout:'flex',pack:'center',align:'center',onClose:function(){i.focus();y.done(i,l);i.undoManager.add();},onSubmit:function(e){var M,N,O,Q;e.preventDefault();N=L.find('#case').checked();Q=L.find('#words').checked();O=L.find('#find').value();if(!O.length){y.done(i,l,false);L.statusbar.items().slice(1).disabled(true);return;}if(m.text===O&&m.caseState===N&&m.wholeWord===Q){if(!y.hasNext(i,l)){K();return;}y.next(i,l);J();return;}M=y.find(i,l,O,N,Q);if(!M){K();}L.statusbar.items().slice(1).disabled(M===0);J();m={text:O,caseState:N,wholeWord:Q};},buttons:[{text:'Find',subtype:'primary',onclick:function(){L.submit();}},{text:'Replace',disabled:true,onclick:function(){if(!y.replace(i,l,L.find('#replace').value())){L.statusbar.items().slice(1).disabled(true);l.set(-1);m={};}}},{text:'Replace all',disabled:true,onclick:function(){y.replace(i,l,L.find('#replace').value(),true,true);L.statusbar.items().slice(1).disabled(true);m={};}},{type:'spacer',flex:1},{text:'Prev',name:'prev',disabled:true,onclick:function(){y.prev(i,l);J();}},{text:'Next',name:'next',disabled:true,onclick:function(){y.next(i,l);J();}}],title:'Find and replace',items:{type:'form',padding:20,labelGap:30,spacing:10,items:[{type:'textbox',name:'find',size:40,label:'Find',value:v},{type:'textbox',name:'replace',size:40,label:'Replace with'},{type:'checkbox',name:'case',text:'Match case',label:' '},{type:'checkbox',name:'words',text:'Whole words',label:' '}]}});};var D={open:B};var E=function(e,i){e.addCommand('SearchReplace',function(){D.open(e,i);});};var F={register:E};var G=function(e,i){return function(){D.open(e,i);};};var H=function(e,i){e.addMenuItem('searchreplace',{text:'Find and replace',shortcut:'Meta+F',onclick:G(e,i),separator:'before',context:'edit'});e.addButton('searchreplace',{tooltip:'Find and replace',onclick:G(e,i)});e.shortcuts.add('Meta+F','',G(e,i));};var I={register:H};g.add('searchreplace',function(e){var i=C(-1);F.register(e,i);I.register(e,i);return A.get(e,i);});function P(){}return P;}());})();
