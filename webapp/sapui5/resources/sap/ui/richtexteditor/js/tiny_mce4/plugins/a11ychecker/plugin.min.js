/* Ephox Accessibility Checker Plugin
 *
 * Copyright 2010-2017 Ephox Corporation.  All rights reserved.
 *
 * Version: 1.2.1-53
 */
!function(){"use strict";var e,n,t,r,o,i,a=function(e){return function(){return e}},u={noop:function(){},noarg:function(e){return function(){return e()}},compose:function(e,n){return function(){return e(n.apply(null,arguments))}},constant:a,identity:function(e){return e},tripleEquals:function(e,n){return e===n},curry:function(e){for(var n=new Array(arguments.length-1),t=1;t<arguments.length;t++)n[t-1]=arguments[t];return function(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var o=n.concat(t);return e.apply(null,o)}},not:function(e){return function(){return!e.apply(null,arguments)}},die:function(e){return function(){throw new Error(e)}},apply:function(e){return e()},call:function(e){e()},never:a(!1),always:a(!0)},c=u.never,s=u.always,l=function(){return f},f=(r={fold:function(e,n){return e()},is:c,isSome:c,isNone:s,getOr:t=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},or:t,orThunk:n,map:l,ap:l,each:function(){},bind:l,flatten:l,exists:c,forall:s,filter:l,equals:e=function(e){return e.isNone()},equals_:e,toArray:function(){return[]},toString:u.constant("none()")},Object.freeze&&Object.freeze(r),r),d=function(e){var n=function(){return e},t=function(){return o},r=function(n){return n(e)},o={fold:function(n,t){return t(e)},is:function(n){return e===n},isSome:s,isNone:c,getOr:n,getOrThunk:n,getOrDie:n,or:t,orThunk:t,map:function(n){return d(n(e))},ap:function(n){return n.fold(l,function(n){return d(n(e))})},each:function(n){n(e)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(e)?o:f},equals:function(n){return n.is(e)},equals_:function(n,t){return n.fold(c,function(n){return t(e,n)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},m={some:d,none:l,from:function(e){return null==e?f:d(e)}},p=void 0===(o=Array.prototype.indexOf)?function(e,n){return x(e,n)}:function(e,n){return o.call(e,n)},h=function(e,n){return p(e,n)>-1},v=function(e,n){for(var t=e.length,r=new Array(t),o=0;o<t;o++){var i=e[o];r[o]=n(i,o,e)}return r},g=function(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t,e)},y=function(e,n){for(var t=e.length-1;t>=0;t--)n(e[t],t,e)},w=function(e,n){for(var t=[],r=0,o=e.length;r<o;r++){var i=e[r];n(i,r,e)&&t.push(i)}return t},b=function(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t,e))return m.some(t);return m.none()},x=function(e,n){for(var t=0,r=e.length;t<r;++t)if(e[t]===n)return t;return-1},k=Array.prototype.push,T=function(e){for(var n=[],t=0,r=e.length;t<r;++t){if(!Array.prototype.isPrototypeOf(e[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+e);k.apply(n,e[t])}return n},S=function(e,n){for(var t=0,r=e.length;t<r;++t)if(!0!==n(e[t],t,e))return!1;return!0},N=Array.prototype.slice,A={map:v,each:g,eachr:y,partition:function(e,n){for(var t=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(n(a,o,e)?t:r).push(a)}return{pass:t,fail:r}},filter:w,groupBy:function(e,n){if(0===e.length)return[];for(var t=n(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var u=e[i],c=n(u);c!==t&&(r.push(o),o=[]),t=c,o.push(u)}return 0!==o.length&&r.push(o),r},indexOf:function(e,n){var t=p(e,n);return-1===t?m.none():m.some(t)},foldr:function(e,n,t){return y(e,function(e){t=n(t,e)}),t},foldl:function(e,n,t){return g(e,function(e){t=n(t,e)}),t},find:function(e,n){for(var t=0,r=e.length;t<r;t++){var o=e[t];if(n(o,t,e))return m.some(o)}return m.none()},findIndex:b,flatten:T,bind:function(e,n){var t=v(e,n);return T(t)},forall:S,exists:function(e,n){return b(e,n).isSome()},contains:h,equal:function(e,n){return e.length===n.length&&S(e,function(e,t){return e===n[t]})},reverse:function(e){var n=N.call(e,0);return n.reverse(),n},chunk:function(e,n){for(var t=[],r=0;r<e.length;r+=n){var o=e.slice(r,r+n);t.push(o)}return t},difference:function(e,n){return w(e,function(e){return!h(n,e)})},mapToObject:function(e,n){for(var t={},r=0,o=e.length;r<o;r++){var i=e[r];t[String(i)]=n(i,r)}return t},pure:function(e){return[e]},sort:function(e,n){var t=N.call(e,0);return t.sort(n),t},range:function(e,n){for(var t=[],r=0;r<e;r++)t.push(n(r));return t},head:function(e){return 0===e.length?m.none():m.some(e[0])},last:function(e){return 0===e.length?m.none():m.some(e[e.length-1])}},D=void 0===(i=Object.keys)?function(e){var n=[];for(var t in e)e.hasOwnProperty(t)&&n.push(t);return n}:i,R=function(e,n){for(var t=D(e),r=0,o=t.length;r<o;r++){var i=t[r];n(e[i],i,e)}},C=function(e,n){var t={};return R(e,function(r,o){var i=n(r,o,e);t[i.k]=i.v}),t},E=function(e,n){var t=[];return R(e,function(e,r){t.push(n(e,r))}),t},I=function(e){return E(e,function(e){return e})},O={bifilter:function(e,n){var t={},r={};return R(e,function(e,o){(n(e,o)?t:r)[o]=e}),{t:t,f:r}},each:R,map:function(e,n){return C(e,function(e,t,r){return{k:t,v:n(e,t,r)}})},mapToArray:E,tupleMap:C,find:function(e,n){for(var t=D(e),r=0,o=t.length;r<o;r++){var i=t[r],a=e[i];if(n(a,i,e))return m.some(a)}return m.none()},keys:D,values:I,size:function(e){return I(e).length}},M=function(e){return function(n){return function(e){if(null===e)return"null";var n=typeof e;return"object"===n&&Array.prototype.isPrototypeOf(e)?"array":"object"===n&&String.prototype.isPrototypeOf(e)?"string":n}(n)===e}},B={isString:M("string"),isObject:M("object"),isArray:M("array"),isNull:M("null"),isBoolean:M("boolean"),isUndefined:M("undefined"),isFunction:M("function"),isNumber:M("number")},H=function(e){return e.slice(0).sort()},G={sort:H,reqMessage:function(e,n){throw new Error("All required keys ("+H(e).join(", ")+") were not specified. Specified keys were: "+H(n).join(", ")+".")},unsuppMessage:function(e){throw new Error("Unsupported keys for object: "+H(e).join(", "))},validateStrArr:function(e,n){if(!B.isArray(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");A.each(n,function(n){if(!B.isString(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})},invalidTypeMessage:function(e,n){throw new Error("All values need to be of type: "+n+". Keys ("+H(e).join(", ")+") were not.")},checkDupes:function(e){var n=H(e);A.find(n,function(e,t){return t<n.length-1&&e===n[t+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+n.join(", ")+"].")})}},q={immutable:function(){var e=arguments;return function(){for(var n=new Array(arguments.length),t=0;t<n.length;t++)n[t]=arguments[t];if(e.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+n.length+" arguments");var r={};return A.each(e,function(e,t){r[e]=u.constant(n[t])}),r}},immutableBag:function(e,n){var t=e.concat(n);if(0===t.length)throw new Error("You must specify at least one required or optional field.");return G.validateStrArr("required",e),G.validateStrArr("optional",n),G.checkDupes(t),function(r){var o=O.keys(r);A.forall(e,function(e){return A.contains(o,e)})||G.reqMessage(e,o);var i=A.filter(o,function(e){return!A.contains(t,e)});i.length>0&&G.unsuppMessage(i);var a={};return A.each(e,function(e){a[e]=u.constant(r[e])}),A.each(n,function(e){a[e]=u.constant(Object.prototype.hasOwnProperty.call(r,e)?m.some(r[e]):m.none())}),a}}},j=q.immutableBag(["rules"],[]),L=q.immutableBag(["rule","element"],[]),W="undefined"!=typeof window?window:Function("return this;")(),P=function(e,n){for(var t=null!=n?n:W,r=0;r<e.length&&null!=t;++r)t=t[e[r]];return t},F=function(e,n){var t=e.split(".");return P(t,n)},U={getOrDie:function(e,n){var t=F(e,n);if(null==t)throw e+" not available on this browser";return t}},V=function(){return U.getOrDie("Node")},_=function(e,n,t){return 0!=(e.compareDocumentPosition(n)&t)},z=function(e,n){return _(e,n,V().DOCUMENT_POSITION_PRECEDING)},X=function(e,n){return A.bind(n,function(n){return n.check()(e)?[L({rule:n,element:e})]:[]})},$={audit:function(e,n){for(var t=[],r=A.partition(n,function(e){return e.walkable()}),o=r.pass,i=r.fail,a=document.createTreeWalker(e,U.getOrDie("NodeFilter").SHOW_ELEMENT,null,!1);a.nextNode();)t=t.concat(X(a.currentNode,o));var u,c,s=(u=e,c=i,A.bind(c,function(e){return A.map(e.check()(u),function(n){return L({rule:e,element:n})})}));return(t=t.concat(s)).sort(function(e,n){return t=e.element(),r=n.element(),t===r?0:z(t,r)?1:-1;var t,r}),t}},K=q.immutableBag(["id","wcag","severity","desckey","url","walkable","check"],[]),Y={error:u.constant("error"),warning:u.constant("warning"),info:u.constant("info")},J=function(e,n){return e.matches?e.matches(n):e.webkitMatchesSelector?e.webkitMatchesSelector(n):e.mozMatchesSelector?e.mozMatchesSelector(n):!!e.msMatchesSelector&&e.msMatchesSelector(n)},Q=K({id:"D1",wcag:"1.3.1",severity:Y.warning(),desckey:"a11y.d1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(e){return!!J(e,"p")&&(n=e,A.forall(n.childNodes,function(e){return/^(b|strong)$/i.test(e.nodeName)}));var n}}),Z=K({id:"D2",wcag:"1.3.1",severity:Y.error(),desckey:"a11y.d2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!1,check:function(e){var n,t=e.querySelectorAll("h1, h2, h3, h4, h5, h6"),r=[];return A.each(t,function(e){var t=parseInt(e.tagName.slice(1),10);n&&t-n>1&&r.push(e),n=t}),r}}),ee=K({id:"D3",wcag:"2.4.4",severity:Y.error(),desckey:"a11y.d3.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/navigation-mechanisms-refs.html",walkable:!1,check:function(e){return A.filter(e.querySelectorAll("a + a"),function(e){return e.href===e.previousSibling.href})}}),ne=function(e){var n=e.nodeName,t=function(e){for(var n=e.nextSibling;null!==n&&("#text"===n.nodeName||"BR"===n.nodeName);)n=n.nextSibling;return n}(e);return null!==t&&t.nodeName===n&&t},te=function(e,n){for(var t=ne(e),r=n(e)?[e]:[];!1!==t&&n(t);)r.push(t),t=ne(t);return r},re=function(e,n){for(var t=-1,r=0;r<e.length;r++)if(e[r]===n){t=r;break}return t},oe=function(e,n){for(var t=e.querySelectorAll("p,h1,h2,h3,h4,h5,h6"),r=[],o=0;o<t.length;){var i=t[o],a=te(i,n);if(a.length>1){r.push(a[0]);var u=a[a.length-1],c=re(t,u);o=-1===c?o+1:c}else o++}return r},ie=function(e){return e.textContent.match(/^\s{0,}([a-z1-9]|i+)\s{0,}[.)-]/gim)},ae=K({id:"D4o",wcag:"1.3.1",severity:Y.error(),desckey:"a11y.d4.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!1,check:function(e){return oe(e,ie)}}),ue=function(e){return e.textContent.match(/^\s{0,}(\*|-)\s{0,}/gim)},ce=K({id:"D4u",wcag:"1.3.1",severity:Y.error(),desckey:"a11y.d4.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!1,check:function(e){return oe(e,ue)}}),se=q.immutable("red","green","blue","alpha"),le={rgbaColour:se,white:function(){return se(255,255,255,1)}},fe=function(e,n){return(Math.max(e,n)+.05)/(Math.min(e,n)+.05)},de=function(e){var n=function(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)},t=e.red()/255,r=e.green()/255,o=e.blue()/255;return.2126*n(t)+.7152*n(r)+.0722*n(o)},me=function(e,n){var t=e.alpha()+n.alpha()*(1-e.alpha()),r=(e.red()*e.alpha()+n.red()*n.alpha()*(1-e.alpha()))/t,o=(e.green()*e.alpha()+n.green()*n.alpha()*(1-e.alpha()))/t,i=(e.blue()*e.alpha()+n.blue()*n.alpha()*(1-e.alpha()))/t;return le.rgbaColour(Math.ceil(r),Math.ceil(o),Math.ceil(i),t)},pe=function(e){var n=function(e,n,t,r){var o=parseInt(e,10),i=parseInt(n,10),a=parseInt(t,10),u=parseFloat(r);return m.some(le.rgbaColour(o,i,a,u))};if("transparent"===e)return n(0,0,0,0);var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(null!==t)return n(t[1],t[2],t[3],1);var r=e.match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/);return null!==r?n(r[1],r[2],r[3],r[4]):m.none()},he=function(e){var n,t=!1;return function(){return t||(t=!0,n=e.apply(null,arguments)),n}},ve=function(){return ge(0,0)},ge=function(e,n){return{major:e,minor:n}},ye={nu:ge,detect:function(e,n){var t=String(n).toLowerCase();return 0===e.length?ve():function(e,n){var t=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.test(n))return r}}(e,n);if(!t)return{major:0,minor:0};var r=function(e){return Number(n.replace(t,"$"+e))};return ge(r(1),r(2))}(e,t)},unknown:ve},we="Firefox",be=function(e,n){return function(){return n===e}},xe=function(e){var n=e.current;return{current:n,version:e.version,isEdge:be("Edge",n),isChrome:be("Chrome",n),isIE:be("IE",n),isOpera:be("Opera",n),isFirefox:be(we,n),isSafari:be("Safari",n)}},ke={unknown:function(){return xe({current:void 0,version:ye.unknown()})},nu:xe,edge:u.constant("Edge"),chrome:u.constant("Chrome"),ie:u.constant("IE"),opera:u.constant("Opera"),firefox:u.constant(we),safari:u.constant("Safari")},Te="Windows",Se="Android",Ne="Solaris",Ae="FreeBSD",De=function(e,n){return function(){return n===e}},Re=function(e){var n=e.current;return{current:n,version:e.version,isWindows:De(Te,n),isiOS:De("iOS",n),isAndroid:De(Se,n),isOSX:De("OSX",n),isLinux:De("Linux",n),isSolaris:De(Ne,n),isFreeBSD:De(Ae,n)}},Ce={unknown:function(){return Re({current:void 0,version:ye.unknown()})},nu:Re,windows:u.constant(Te),ios:u.constant("iOS"),android:u.constant(Se),linux:u.constant("Linux"),osx:u.constant("OSX"),solaris:u.constant(Ne),freebsd:u.constant(Ae)},Ee=function(e,n){var t=String(n).toLowerCase();return A.find(e,function(e){return e.search(t)})},Ie=function(e,n){return Ee(e,n).map(function(e){var t=ye.detect(e.versionRegexes,n);return{current:e.name,version:t}})},Oe=function(e,n){return Ee(e,n).map(function(e){var t=ye.detect(e.versionRegexes,n);return{current:e.name,version:t}})},Me=function(e,n){return-1!==e.indexOf(n)},Be=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,He=function(e){return function(n){return Me(n,e)}},Ge=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Me(e,"edge/")&&Me(e,"chrome")&&Me(e,"safari")&&Me(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Be],search:function(e){return Me(e,"chrome")&&!Me(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Me(e,"msie")||Me(e,"trident")}},{name:"Opera",versionRegexes:[Be,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:He("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:He("firefox")},{name:"Safari",versionRegexes:[Be,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Me(e,"safari")||Me(e,"mobile/"))&&Me(e,"applewebkit")}}],qe=[{name:"Windows",search:He("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Me(e,"iphone")||Me(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:He("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:He("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:He("linux"),versionRegexes:[]},{name:"Solaris",search:He("sunos"),versionRegexes:[]},{name:"FreeBSD",search:He("freebsd"),versionRegexes:[]}],je={browsers:u.constant(Ge),oses:u.constant(qe)},Le=function(e){var n,t,r,o,i,a,c,s,l,f,d,m=je.browsers(),p=je.oses(),h=Ie(m,e).fold(ke.unknown,ke.nu),v=Oe(p,e).fold(Ce.unknown,Ce.nu);return{browser:h,os:v,deviceType:(t=h,r=e,o=(n=v).isiOS()&&!0===/ipad/i.test(r),i=n.isiOS()&&!o,a=n.isAndroid()&&3===n.version.major,c=n.isAndroid()&&4===n.version.major,s=o||a||c&&!0===/mobile/i.test(r),l=n.isiOS()||n.isAndroid(),f=l&&!s,d=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),{isiPad:u.constant(o),isiPhone:u.constant(i),isTablet:u.constant(s),isPhone:u.constant(f),isTouch:u.constant(l),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:u.constant(d)})}},We=he(function(){var e=navigator.userAgent;return Le(e)}),Pe=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:u.constant(e)}},Fe={fromHtml:function(e,n){var t=(n||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||t.childNodes.length>1)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return Pe(t.childNodes[0])},fromTag:function(e,n){var t=(n||document).createElement(e);return Pe(t)},fromText:function(e,n){var t=(n||document).createTextNode(e);return Pe(t)},fromDom:Pe,fromPoint:function(e,n,t){return m.from(e.dom().elementFromPoint(n,t)).map(Pe)}},Ue=8,Ve=9,_e=1,ze=3,Xe=_e,$e=Ve,Ke=function(e){return e.nodeType!==Xe&&e.nodeType!==$e||0===e.childElementCount},Ye={all:function(e,n){var t=void 0===n?document:n.dom();return Ke(t)?[]:A.map(t.querySelectorAll(e),Fe.fromDom)},is:function(e,n){var t=e.dom();if(t.nodeType!==Xe)return!1;if(void 0!==t.matches)return t.matches(n);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(n);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(n);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},one:function(e,n){var t=void 0===n?document:n.dom();return Ke(t)?m.none():m.from(t.querySelector(e)).map(Fe.fromDom)}},Je=function(e,n){return e.dom()===n.dom()},Qe=(We().browser.isIE(),Je),Ze=function(e){return e.dom().nodeName.toLowerCase()},en=function(e){return e.dom().nodeType},nn=function(e){return function(n){return en(n)===e}},tn=nn(_e),rn=nn(ze),on=nn(Ve),an={name:Ze,type:en,value:function(e){return e.dom().nodeValue},isElement:tn,isText:rn,isDocument:on,isComment:function(e){return en(e)===Ue||"#comment"===Ze(e)}},un=he(function(){return cn(Fe.fromDom(document))}),cn=function(e){var n=e.dom().body;if(null==n)throw"Body is not available yet";return Fe.fromDom(n)},sn={body:un,getBody:cn,inBody:function(e){var n=an.isText(e)?e.dom().parentNode:e.dom();return null!=n&&n.ownerDocument.body.contains(n)}},ln=function(e,n,t){if(!(B.isString(t)||B.isBoolean(t)||B.isNumber(t)))throw console.error("Invalid call to Attr.set. Key ",n,":: Value ",t,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,t+"")},fn=function(e,n,t){ln(e.dom(),n,t)},dn=function(e,n){var t=e.dom().getAttribute(n);return null===t?void 0:t},mn=function(e,n){var t=e.dom();return!(!t||!t.hasAttribute)&&t.hasAttribute(n)},pn={clone:function(e){return A.foldl(e.dom().attributes,function(e,n){return e[n.name]=n.value,e},{})},set:fn,setAll:function(e,n){var t=e.dom();O.each(n,function(e,n){ln(t,n,e)})},get:dn,has:mn,remove:function(e,n){e.dom().removeAttribute(n)},hasNone:function(e){var n=e.dom().attributes;return null==n||0===n.length},transfer:function(e,n,t){an.isElement(e)&&an.isElement(n)&&A.each(t,function(t){var r,o,i;o=n,mn(r=e,i=t)&&!mn(o,i)&&fn(o,i,dn(r,i))})}},hn=function(e){return void 0!==e.style},vn=function(e,n){return hn(e)?e.style.getPropertyValue(n):""},gn=function(e,n){var t=e.dom(),r=window.getComputedStyle(t).getPropertyValue(n),o=""!==r||sn.inBody(e)?r:vn(t,n);return null===o?void 0:o},yn=function(e,n){for(var t=[],r=function(e){return t.push(e),n(e)},o=n(e);(o=o.bind(r)).isSome(););return t},wn=function(e){return Fe.fromDom(e.dom().ownerDocument)},bn=function(e){var n=e.dom();return m.from(n.parentNode).map(Fe.fromDom)},xn=function(e){var n=e.dom();return m.from(n.previousSibling).map(Fe.fromDom)},kn=function(e){var n=e.dom();return m.from(n.nextSibling).map(Fe.fromDom)},Tn=function(e){var n=e.dom();return A.map(n.childNodes,Fe.fromDom)},Sn=function(e,n){var t=e.dom().childNodes;return m.from(t[n]).map(Fe.fromDom)},Nn=q.immutable("element","offset"),An={owner:wn,defaultView:function(e){var n=e.dom().ownerDocument.defaultView;return Fe.fromDom(n)},documentElement:function(e){var n=wn(e);return Fe.fromDom(n.dom().documentElement)},parent:bn,findIndex:function(e){return bn(e).bind(function(n){var t=Tn(n);return A.findIndex(t,function(n){return Qe(e,n)})})},parents:function(e,n){for(var t=B.isFunction(n)?n:u.constant(!1),r=e.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,a=Fe.fromDom(i);if(o.push(a),!0===t(a))break;r=i}return o},siblings:function(e){return bn(e).map(Tn).map(function(n){return A.filter(n,function(n){return!Qe(e,n)})}).getOr([])},prevSibling:xn,offsetParent:function(e){var n=e.dom();return m.from(n.offsetParent).map(Fe.fromDom)},prevSiblings:function(e){return A.reverse(yn(e,xn))},nextSibling:kn,nextSiblings:function(e){return yn(e,kn)},children:Tn,child:Sn,firstChild:function(e){return Sn(e,0)},lastChild:function(e){return Sn(e,e.dom().childNodes.length-1)},childNodesCount:function(e){return e.dom().childNodes.length},hasChildNodes:function(e){return e.dom().hasChildNodes()},leaf:function(e,n){var t=Tn(e);return t.length>0&&n<t.length?Nn(t[n],0):Nn(e,n)}},Dn=function(e,n){var t=gn(e,"opacity");return t<1?le.rgbaColour(n.red(),n.green(),n.blue(),n.alpha()*t):n},Rn=function(e){var n=An.owner(e),t=sn.getBody(n),r=[e].concat(An.parents(e,function(e){return Qe(e,t)})),o=A.foldl(r,function(e,n){if(1===e.alpha())return e;var t=gn(n,"background-color");return pe(t).bind(function(t){var r=Dn(n,t);return r.alpha()>0?m.some(me(e,r)):m.none()}).getOr(e)},le.rgbaColour(0,0,0,0));return o.alpha()<1?me(o,le.white()):o},Cn=function(e,n){var t=gn(e,"color");return pe(t).bind(function(t){var r=Dn(e,t),o=r.alpha()<1?me(r,n):r;return m.some(o)})},En=function(e){var n=Rn(e);return Cn(e,n).map(function(e){var t=de(n),r=de(e);return fe(r,t)})},In=function(e,n){return En(e).filter(function(e){return e<n}).isSome()},On=function(e){var n=gn(e,"font-size"),t=new RegExp(".*px").test(n),r=n.match(/(\d*\.?\d*)(.*)/);return t&&null!==r?m.some(Number(r[1])):m.none()},Mn=function(e){var n,t,r=!("bold"!==(t=gn(e,"font-weight"))&&"bolder"!==t)||!!/^[0-9]*$/.test(n=t)&&parseInt(n,10)>=700,o=An.owner(e),i=sn.getBody(o),a=On(i);return On(e).fold(u.never,function(e){return a.fold(function(){return e>=24||r&&e>=19},function(n){return e>=1.5*n||r&&e>=1.2*n})})},Bn=function(e){var n=An.children(e);return A.filter(n,function(e){return an.isText(e)&&an.value(e).trim().length>0}).length>0},Hn=K({id:"D5a",wcag:"1.4.3",severity:Y.error(),desckey:"a11y.d5a.description",url:"https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html",walkable:!0,check:function(e){var n=Fe.fromDom(e);return Bn(n)&&Mn(n)&&In(n,3)}}),Gn=K({id:"D5b",wcag:"1.4.3",severity:Y.error(),desckey:"a11y.d5b.description",url:"https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html",walkable:!0,check:function(e){var n=Fe.fromDom(e);return Bn(n)&&!Mn(n)&&In(n,4.5)}}),qn=K({id:"I1",wcag:"1.1.1",severity:Y.error(),desckey:"a11y.i1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/text-equiv-all.html",walkable:!0,check:function(e){return J(e,"img")&&(!1===e.hasAttribute("alt")||""===e.getAttribute("alt").trim())}}),jn=K({id:"I2",wcag:"1.1.1",severity:Y.error(),desckey:"a11y.i2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/text-equiv-all.html",walkable:!0,check:function(e){return J(e,"img[alt][src]")&&e.src.split("/").pop()===e.alt.split("/").pop()}}),Ln=K({id:"T1",wcag:"1.3.1",severity:Y.error(),desckey:"a11y.t1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(e){if(J(e,"table")){var n=e.querySelector("caption");return!n||J(n,":empty")}return!1}}),Wn=K({id:"T2",wcag:"1.3.1",severity:Y.warning(),desckey:"a11y.t2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(e){return J(e,"table")&&(e.querySelector("[rowspan]")||e.querySelector("[colspan]"))&&!e.hasAttribute("summary")}}),Pn=K({id:"T3",wcag:"1.3.1",severity:Y.error(),desckey:"a11y.t3.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(e){return J(e,"table")&&e.hasAttribute("summary")&&e.querySelectorAll("caption").length>0&&e.getAttribute("summary")===e.querySelector("caption").innerHTML}}),Fn=K({id:"T4b",wcag:"1.3.1",severity:Y.error(),desckey:"a11y.t4b.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(e){return"table"===e.nodeName.toLowerCase()&&0===e.querySelectorAll("th").length}}),Un=K({id:"T4c",wcag:"1.3.1",severity:Y.error(),desckey:"a11y.t4c.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(e){return"th"===e.nodeName.toLowerCase()&&(t=!1===(n=e).hasAttribute("scope"),r=!1===/row|col|rowgroup|colgroup/i.test(n.getAttribute("scope")),t||r);var n,t,r}}),Vn=function(e,n){return 0===e.querySelectorAll(n).length},_n=[Q,Z,ee,ae,ce,Hn,Gn,qn,jn,Ln,Wn,Pn,Un,K({id:"T4a",wcag:"1.3.1",severity:Y.error(),desckey:"a11y.t4a.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(e){return"table"===e.nodeName.toLowerCase()&&(Vn(n=e,"tr")||Vn(n,"td"));var n}}),Fn],zn={get:function(e){return A.find(_n,function(n){return n.name()===e})},all:u.constant(_n)},Xn={get:function(e){return zn.get(e)},all:function(){return zn.all().slice()}};function $n(e,n,t,r,o){return e(t,r)?m.some(t):B.isFunction(o)&&o(t)?m.none():n(t,r,o)}var Kn,Yn=function(e,n,t){for(var r=e.dom(),o=B.isFunction(t)?t:u.constant(!1);r.parentNode;){r=r.parentNode;var i=Fe.fromDom(r);if(n(i))return m.some(i);if(o(i))break}return m.none()},Jn=function(e,n){return A.find(e.dom().childNodes,u.compose(n,Fe.fromDom)).map(Fe.fromDom)},Qn=function(e,n){var t=function(e){for(var r=0;r<e.childNodes.length;r++){if(n(Fe.fromDom(e.childNodes[r])))return m.some(Fe.fromDom(e.childNodes[r]));var o=t(e.childNodes[r]);if(o.isSome())return o}return m.none()};return t(e.dom())},Zn={first:function(e){return Qn(sn.body(),e)},ancestor:Yn,closest:function(e,n,t){return $n(function(e){return n(e)},Yn,e,n,t)},sibling:function(e,n){var t=e.dom();return t.parentNode?Jn(Fe.fromDom(t.parentNode),function(t){return!Qe(e,t)&&n(t)}):m.none()},child:Jn,descendant:Qn},et=function(e){return Ye.one(e)},nt=function(e,n){return Zn.child(e,function(e){return Ye.is(e,n)})},tt=function(e,n){return Ye.one(n,e)},rt=function(e){return{is:function(n){return e===n},isValue:u.always,isError:u.never,getOr:u.constant(e),getOrThunk:u.constant(e),getOrDie:u.constant(e),or:function(n){return rt(e)},orThunk:function(n){return rt(e)},fold:function(n,t){return t(e)},map:function(n){return rt(n(e))},each:function(n){n(e)},bind:function(n){return n(e)},exists:function(n){return n(e)},forall:function(n){return n(e)},toOption:function(){return m.some(e)}}},ot=function(e){return{is:u.never,isValue:u.never,isError:u.always,getOr:u.identity,getOrThunk:function(e){return e()},getOrDie:function(){return u.die(e)()},or:function(e){return e},orThunk:function(e){return e()},fold:function(n,t){return n(e)},map:function(n){return ot(e)},each:u.noop,bind:function(n){return ot(e)},exists:u.never,forall:u.always,toOption:m.none}},it={value:rt,error:ot},at=function(e,n){An.parent(e).each(function(t){t.dom().insertBefore(n.dom(),e.dom())})},ut=function(e,n){e.dom().appendChild(n.dom())},ct={before:at,after:function(e,n){An.nextSibling(e).fold(function(){An.parent(e).each(function(e){ut(e,n)})},function(e){at(e,n)})},prepend:function(e,n){An.firstChild(e).fold(function(){ut(e,n)},function(t){e.dom().insertBefore(n.dom(),t.dom())})},append:ut,appendAt:function(e,n,t){An.child(e,t).fold(function(){ut(e,n)},function(e){at(e,n)})},wrap:function(e,n){at(e,n),ut(n,e)}},st=function(e,n){A.each(n,function(n){ct.before(e,n)})},lt=function(e,n){A.each(n,function(n){ct.append(e,n)})},ft=function(e){var n=e.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},dt={empty:function(e){e.dom().textContent="",A.each(An.children(e),function(e){ft(e)})},remove:ft,unwrap:function(e){var n=An.children(e);n.length>0&&st(e,n),ft(e)}},mt=function(e,n){return Fe.fromDom(e.dom().cloneNode(n))},pt=function(e){return mt(e,!0)},ht=pt,vt=function(e,n){return A.filter(An.children(e),n)},gt=function(e,n){return vt(e,function(e){return Ye.is(e,n)})},yt=function(e,n){return Ye.all(n,e)},wt=function(e,n){var t=An.owner(e),r=Fe.fromTag(n,t.dom()),o=An.children(e),i=A.map(o,ht);lt(r,i);var a=yt(r,"b,strong");return A.each(a,dt.unwrap),ct.before(e,r),dt.remove(e),it.value(r)},bt=function(e){var n=Fe.fromDom(e.dom().previousSibling);if(n){var t=An.children(e);lt(n,t),dt.remove(e)}return it.value(n)},xt=function(e,n){return it.error(n(e))},kt=function(e,n,t,r,o,i){return 0===n.length?xt(r,i):n===t?xt(o,i):it.value(e)},Tt=function(e,n,t,r,o){var i=pn.get(e,"src").split("/").pop();return kt(e,n,i,t,r,o).map(function(e){return pn.set(e,"alt",n),e})},St=function(e,n){var t=(n||document).createElement("div");return t.innerHTML=e,An.children(Fe.fromDom(t))},Nt=function(e){return A.map(e,Fe.fromDom)},At=function(e){return e.dom().innerHTML},Dt=At,Rt=function(e,n){var t=An.owner(e).dom(),r=Fe.fromDom(t.createDocumentFragment()),o=St(n,t);lt(r,o),dt.empty(e),ct.append(e,r)},Ct=function(e,n,t,r,o){var i=pn.get(e,"summary");return kt(e,n,i,t,r,o).map(function(t){var r=nt(e,"caption").fold(function(){return Fe.fromTag("caption")},function(e){return dt.empty(e),e});return Rt(r,n),ct.prepend(t,r),t})},Et=function(e,n,t,r,o){var i=tt(e,"caption").map(Dt).getOr("");return kt(e,n,i,t,r,o).map(function(t){return pn.set(e,"summary",n),t})},It=function(e,n){var t=[];if("row"===n){var r=Fe.fromDom(e.dom().rows[0]);t=gt(r,"td")}else if("col"===n){var o=Nt(e.dom().rows);A.each(o,function(e){nt(e,"td").bind(function(e){t.push(e)})})}return A.each(t,function(e){var n=Fe.fromTag("th");A.each(e.dom().attributes,function(t){pn.set(n,t.name,pn.get(e,t.name))}),n.dom().innerHTML=e.dom().innerHTML,ct.after(e,n),dt.remove(e)}),it.value(e)},Ot=function(e,n){return pn.set(e,"scope",n),it.value(e)},Mt=function(e,n){return{type:"label",forName:e,text:n}},Bt=function(e,n,t){return{type:"listbox",name:e,values:A.map(n,function(e){return{text:t(e.text),value:e.value}})}},Ht=function(e,n){return{type:"textbox",name:e,value:n}},Gt=q.immutableBag(["id","description","repair","element","severity","url"],[]),qt=q.immutableBag(["ui","repair"],[]),jt={I1:m.some(qt({ui:m.some(function(e,n){return[Mt("image-alt",e("a11y.i1.repair.info")),Ht("image-alt","")]}),repair:function(e,n,t){var r=n.retrieveTextInput("image-alt");return Tt(e,r,"a11y.i1.repair.errors.empty","a11y.i1.repair.errors.duplicate",t)}})),I2:m.some(qt({ui:m.some(function(e,n){var t=n.dom().alt;return[Mt("image-alt",e("a11y.i1.repair.info")),Ht("image-alt",t)]}),repair:function(e,n,t){var r=n.retrieveTextInput("image-alt");return Tt(e,r,"a11y.i1.repair.errors.empty","a11y.i1.repair.errors.duplicate",t)}})),T1:m.some(qt({ui:m.some(function(e,n){return[Mt("table-caption",e("a11y.t1.repair.info")),Ht("table-caption","")]}),repair:function(e,n,t){var r=n.retrieveTextInput("table-caption");return Ct(e,r,"a11y.t1.repair.errors.empty","a11y.t1.repair.errors.duplicate",t)}})),T2:m.some(qt({ui:m.some(function(e,n){return[Mt("table-summary",e("a11y.t2.repair.info")),Ht("table-summary","")]}),repair:function(e,n,t){var r=n.retrieveTextInput("table-summary");return Et(e,r,"a11y.t2.repair.errors.empty","a11y.t2.repair.errors.duplicate",t)}})),T3:m.some(qt({ui:m.some(function(e,n){var t=nt(n,"caption").fold(function(){return""},function(e){return e.dom().innerHTML});return[Mt("table-caption",e("a11y.t1.repair.info")),Ht("table-caption",t)]}),repair:function(e,n,t){var r=n.retrieveTextInput("table-caption");return Ct(e,r,"a11y.t1.repair.errors.empty","a11y.t1.repair.errors.duplicate",t)}})),T4A:m.none(),T4B:m.some(qt({ui:m.some(function(e,n){return[Mt("table-headers",e("a11y.t4b.repair.info")),Bt("table-headers",[{text:"a11y.t4c.repair.header.row",value:"row"},{text:"a11y.t4c.repair.header.col",value:"col"}],e)]}),repair:function(e,n,t){var r=n.retrieveSelectInput("table-headers");return It(e,r)}})),T4C:m.some(qt({ui:m.some(function(e,n){return[Mt("scope-type",e("a11y.t4c.repair.info")),Bt("scope-type",[{text:"a11y.t4c.repair.scope.row",value:"row"},{text:"a11y.t4c.repair.scope.col",value:"col"},{text:"a11y.t4c.repair.scope.rowgroup",value:"rowgroup"},{text:"a11y.t4c.repair.scope.colgroup",value:"colgroup"}],e)]}),repair:function(e,n,t){var r=n.retrieveSelectInput("scope-type");return Ot(e,r)}})),D1:m.some(qt({ui:m.some(function(e,n){return[Mt("heading-type",e("a11y.d1.repair.info")),Bt("heading-type",[{text:"a11y.d1.repair.block.h1",value:"h1"},{text:"a11y.d1.repair.block.h2",value:"h2"},{text:"a11y.d1.repair.block.h3",value:"h3"},{text:"a11y.d1.repair.block.h4",value:"h4"},{text:"a11y.d1.repair.block.h5",value:"h5"},{text:"a11y.d1.repair.block.h6",value:"h6"}],e)]}),repair:function(e,n,t){var r=n.retrieveSelectInput("heading-type");return wt(e,r)}})),D2:m.none(),D3:m.some(qt({ui:m.none(),repair:function(e,n,t){return bt(e)}}))},Lt={convert:function(e,n){return A.map(n,function(e){var n=e.rule(),t=n.id().toUpperCase(),r=void 0!==jt[t]?jt[t]:m.none(),o=n.desckey();return Gt({id:t,description:o,repair:r,element:Fe.fromDom(e.element()),url:n.url(),severity:n.severity()})})}},Wt=function(e,n,t){var r=pn.get(e,n).concat(" ",t);Pt(e,n,r)},Pt=function(e,n,t){pn.set(e,n,t)},Ft={read:function(e,n){return pn.has(e,n)?pn.get(e,n).split(" "):[]},createOrMerge:function(e,n,t){(pn.has(e,n)?Wt:Pt)(e,n,t)}},Ut=function(e){return et(e).isSome()},Vt=(Kn="ephox-foam".replace(/\./g,"-"),{resolve:function(e){return Kn+"-"+e}}),_t=Vt.resolve("styles"),zt="#"+_t,Xt={resolve:Vt.resolve,injectStyles:function(e){if(!Ut(zt)){var n=Fe.fromTag("link");pn.set(n,"id",_t),pn.set(n,"rel","stylesheet"),pn.set(n,"href",e);var t=et("head").getOrDie("Head element could not be found.");ct.append(t,n)}},removeStyles:function(){if(Ut(zt)){var e=et("head").getOrDie("Head element could not be found."),n=tt(e,zt).getOrDie("The style element could not be removed");dt.remove(n)}}},$t=function(e,n,t){pn.set(e,n,t)},Kt=function(e,n,t,r,o,i){A.each(e,function(e){var t=Yt(e.severity(),r,o,i).toArray().concat([n]);A.each(t,function(n){pn.set(e.element(),n,1)})}),m.from(e[0]).each(function(e){$t(e.element(),t,e.severity())})},Yt=function(e,n,t,r){switch(e){case"info":return m.some(n);case"warning":return m.some(t);case"error":return m.some(r);default:return m.none()}},Jt=function(e,n,t,r){var o=yt(e,"["+n+"]");A.each(o,function(e){pn.remove(e,n)}),$t(t,n,r)},Qt=function(e,n,t,r,o,i){var a=yt(e,"["+n+"]");A.each(a,function(e){A.each([n,t,r,o,i],function(n){pn.remove(e,n)}),Zt(e,n,t)})},Zt=function(e,n,t){pn.remove(e,n),pn.remove(e,t)},er=function(e){var n=e.editor();return{start:function(n){Kt(n,e.violation(),e.current(),e.info(),e.warn(),e.error())},moveTo:function(t,r){var o=Fe.fromDom(n.getBody());Jt(o,e.current(),t,r)},stop:function(){var t=Fe.fromDom(n.getBody());Qt(t,e.violation(),e.current(),e.info(),e.warn(),e.error())},exclude:function(n){Zt(n,e.violation(),e.current())}}},nr="data-"+Xt.resolve("a11y-current-violation"),tr="data-"+Xt.resolve("a11y-violation"),rr="data-"+Xt.resolve("a11y-severity-info"),or="data-"+Xt.resolve("a11y-severity-warn"),ir="data-"+Xt.resolve("a11y-severity-error"),ar="data-"+Xt.resolve("accessibility-ignore"),ur=q.immutableBag(["editor","violation","current","info","warn","error"],[]),cr={configure:function(e){e.on("init",function(n){A.each([ar,tr,rr,or,ir,nr],function(n){e.serializer.addTempAttr(n)})})},ignoreAttr:u.constant(ar),manager:function(e){return er(ur({editor:e,violation:tr,current:nr,info:rr,warn:or,error:ir}))}},sr={"a11y.d1.description":"This paragraph looks like a heading. If it is a heading, please select a heading level.","a11y.d1.repair.block.h1":"Heading 1","a11y.d1.repair.block.h2":"Heading 2","a11y.d1.repair.block.h3":"Heading 3","a11y.d1.repair.block.h4":"Heading 4","a11y.d1.repair.block.h5":"Heading 5","a11y.d1.repair.block.h6":"Heading 6","a11y.d1.repair.info":"Select a heading level:","a11y.d2.description":"Headings must be applied in sequential order. For example: Heading 1 should be followed by Heading 2, not Heading 3.","a11y.d3.description":"Adjacent links with the same URL should be merged into one link","a11y.d4.description":"The selected text appears to be a list. Lists should be formatted using a list tag.","a11y.d5a.description":"Large text must have a contrast ratio of at least 3:1","a11y.d5b.description":"Text must have a contrast ratio of at least 4.5:1","a11y.i1.description":"Images must have an alternative text description","a11y.i1.repair.errors.duplicate":"Alternative text cannot be the same as the filename","a11y.i1.repair.errors.empty":"Alternative text cannot be empty","a11y.i1.repair.info":"Provide alternative text:","a11y.i2.description":"Alternative text must not be the same as the image filename","a11y.t1.description":"Tables must have captions","a11y.t1.repair.errors.duplicate":"Table caption cannot be the same as the table summary","a11y.t1.repair.errors.empty":"Caption cannot be empty","a11y.t1.repair.info":"Provide caption:","a11y.t2.description":"Complex tables should have summaries","a11y.t2.repair.errors.duplicate":"Table summary cannot be the same as the table caption","a11y.t2.repair.errors.empty":"Summary cannot be empty","a11y.t2.repair.info":"Provide table summary:","a11y.t3.description":"Table caption and summary cannot have the same value","a11y.t4a.description":"Table elements must contain TR and TD tags","a11y.t4b.description":"Tables must have at least one header cell","a11y.t4b.repair.info":"Choose table header:","a11y.t4c.description":"Table headers must be applied to a row or a column","a11y.t4c.repair.header.col":"Header Column","a11y.t4c.repair.header.row":"Header Row","a11y.t4c.repair.info":"Select header scope:","a11y.t4c.repair.scope.col":"Column","a11y.t4c.repair.scope.colgroup":"Column Group","a11y.t4c.repair.scope.row":"Row","a11y.t4c.repair.scope.rowgroup":"Row Group","a11y.widget.counter":"Issue {0} of {1}","a11y.widget.ignore":"Ignore","a11y.widget.issue.none":"No accessibility issues detected.","a11y.widget.next":"Next Issue","a11y.widget.previous":"Previous Issue","a11y.widget.repair":"Repair Issue","a11y.widget.title":"Accessibility Checker"},lr=function(e){return sr[e]},fr={translate:function(e){return Array.isArray(e)?tinymce.translate([lr(e[0])].concat(e.slice(1))):tinymce.translate(lr(e))}},dr=function(e){var n=e,t=function(){return n};return{get:t,set:function(e){n=e},clone:function(){return dr(t())}}},mr={requestAnimationFrame:function(e,n){var t,r=window.requestAnimationFrame,o=["ms","moz","webkit"];for(t=0;t<o.length&&!r;t++)r=window[o[t]+"RequestAnimationFrame"];r||(r=function(e){window.setTimeout(e,0)}),r(e,n)},setEditorTimeout:function(e,n,t){window.setTimeout(function(){e.removed||n()},t||0)}},pr={getInitialHtml:function(){return'<div role="presentation"></div><div style="clip: rect(1px, 1px, 1px, 1px);height: 1px;overflow: hidden;position: absolute;width: 1px;" aria-live="assertive" aria-relevant="additions" aria-atomic="true"></div>'},buildHtml:function(e,n){return'<div style="white-space:normal;">'+e+(n?'<button aria-label="Show specification details" role="button" style="display:inline;" tabindex="-1"><i class="mce-ico mce-i-help"></i><button>':"")+"</div>"},setSeverity:function(e,n){e.classes.remove("error"),e.classes.remove("warning"),e.classes.remove("success"),e.classes.add(n)}};function hr(e){var n,t={},r=dr(null),o=function(e,n,t){return Math.min(Math.max(e,n),t)},i=function(){if(n&&!0===n.state.get("visible")){var t=e.inline?e.getElement():e.getContentAreaContainer(),r=("BODY"===(c=e.getBody()).nodeName&&(c=c.parentNode),c.scrollHeight>c.clientHeight?-25:-10);n.moveRel(t,"tr-tr"),n.moveBy(r,10),a=10,u=(i=n).layoutRect(),i.moveTo(o(u.x,0,window.innerWidth-u.w),o(u.y,a,window.innerHeight-u.h-a))}var i,a,u,c};return{actions:t,open:function(){(n=tinymce.ui.Factory.create("window",{title:"Accessibility Checker",spacing:5,padding:10,minWidth:300,layout:"flex",direction:"column",align:"stretch",items:[{type:"label",name:"index",text:"Index",padding:"0 0 5 0"},{type:"widget",classes:"widget infobox has-help",name:"description",onpostrender:function(e){e.control.getEl().innerHTML=pr.getInitialHtml()},onclick:function(e){r.get()&&(e.stopPropagation(),e.preventDefault(),window.open(r.get()))}},{type:"container",layout:"flex",direction:"column",align:"stretch",name:"repairer",padding:"5 0 5 0",items:[]},{type:"label",name:"validation",hidden:!0,classes:"error"},{type:"container",name:"footer",layout:"flex",direction:"row",spacing:3,items:[{type:"button",name:"repair",text:fr.translate("a11y.widget.repair"),onclick:"repair"},{type:"button",text:fr.translate("a11y.widget.ignore"),onclick:"ignore"},{type:"spacer",flex:1},{type:"button",text:fr.translate("a11y.widget.previous"),onclick:"prev"},{type:"button",text:fr.translate("a11y.widget.next"),autofocus:!0,subtype:"primary",onclick:"next"}]},{type:"container",name:"closer",layout:"flex",direction:"row",hidden:!0,items:[{type:"spacer",flex:1},{type:"button",subtype:"primary",name:"close",text:"Close",onclick:function(){n.close()}}]}]})).on("submit",function(e){e.preventDefault(),t.repair()}),n.modal=!1,n.on("open",function(){i()}),n.on("close",function(){t.close()}),n.on("execute",function(e){t[e.action]()}),e.on("remove",function(){n&&n.close()}),n.renderTo().reflow(),n.moveTo(0,0)},close:function(){n&&(n.close(),n=null)},reposition:i,setIndexText:function(e){n.find("#index").show().text(e)},hideIndex:function(){n.find("#index").hide()},setDescriptionText:function(t,o,i){var a=n.find("#description")[0].show();pr.setSeverity(a,o),r.set(i),a.getEl().firstChild.innerHTML=pr.buildHtml(t,i),a.updateLayoutRect(),a.reflow(),mr.setEditorTimeout(e,function(){a.getEl().lastChild.textContent=t})},setRepairerChildren:function(e){var t;(t=n.find("#repairer")[0]).items().remove(),t.append(e),t.renderNew()},hideFooter:function(){n.find("#footer").hide()},showCloser:function(){var e=n.find("#closer")[0];e.show(),e.focus()},hideRepairer:function(){n.find("#repairer").hide()},showRepairer:function(){n.find("#repairer").show()},hideRepairButton:function(){n.find("#repair").hide()},showRepairButton:function(){n.find("#repair").show()},setValidationInformation:function(e){n.find("#validation").show().text(e)},hideValidation:function(){n.find("#validation").hide()},retrieveTextInput:function(e){return n.find("#"+e).value()},retrieveSelectInput:function(e){return n.find("#"+e).value()}}}var vr=function(e){return!0===e.a11ychecker_allow_decorative_images},gr=function(e){return e.filter(function(e){return!1===function(e){if("I1"===e.rule().id()){var n=e.element();return!0===(r=n).hasAttribute("role")&&"presentation"===r.getAttribute("role")||!0===(t=n).hasAttribute("alt")&&""===t.getAttribute("alt").trim()}return!1;var t,r}(e)})};function yr(e,n){var t,r,o,i,a=Xn.all(),c=j({rules:a});cr.configure(e);var s,l=(s=c,{audit:function(e){return $.audit(e,s.rules())}}),f=cr.manager(e),d=cr.ignoreAttr(),m=function(){var n=l.audit(e.getBody());n=vr(e.settings)?gr(n):n,r=Lt.convert(e,n),r=A.filter(r,function(e){var n=e.element(),t=Ft.read(n,d);return A.forall(t,function(n){return e.id()!==n})})},p=function(){(i=hr(e)).actions.close=function(){f.stop(),o=!1,r=[]},i.actions.ignore=function(){Ft.createOrMerge(r[t].element(),d,r[t].id()),y()},i.actions.prev=T,i.actions.next=S,i.open()},h=function(){i&&i.close()},v=function(){i&&i.reposition()},g=function(n,t){i.hideValidation(),i.setIndexText(fr.translate(["a11y.widget.counter",t,r.length])),i.setDescriptionText(fr.translate(n.description()),n.severity(),n.url()),n.repair().fold(x,function(e){k(e,n)}),v(),e.selection.scrollIntoView(n.element().dom())},y=function(){(r=r.slice(0,t).concat(r.slice(t+1))).length>0?(t=t<r.length-1?t:0,b(r[t])):(m(),r.length>0?b(r[0]):w()),v()},w=function(){i.hideIndex(),i.hideRepairer(),i.hideValidation(),i.hideFooter(),i.showCloser(),i.setDescriptionText(fr.translate("a11y.widget.issue.none"),"success")},b=function(e){g(e,t+1),f.moveTo(e.element(),e.severity())},x=function(){i.hideRepairer(),i.hideRepairButton()},k=function(n,t){n.ui().fold(x,function(e){i.setRepairerChildren(e(fr.translate,t.element())),i.showRepairer()}),i.showRepairButton(),i.actions.repair=function(){e.undoManager.transact(function(){n.repair()(t.element(),i,fr.translate).fold(function(e){i.setValidationInformation(e),v()},function(){y()})})}},T=function(){r.length>0&&(t=t>0?t-1:r.length-1,b(r[t]))},S=function(){r.length>0&&(t=t<r.length-1?t+1:0,b(r[t]))};return{getReport:function(){return o||m(),A.map(r,function(e){return{severity:e.severity,url:e.url,description:u.constant(fr.translate(e.description())),element:u.constant(e.element().dom())}})},audit:function(){o?h():(t=0,o=!0,m(),p(),r.length>0?(f.start(r),g(r[0],1)):w())},stopAuditing:h,rampaging:o,positionDialog:v}}var wr=function(e,n){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.console;o&&n in o&&o[n].apply(o,arguments)}},br={log:wr(window,"log"),error:wr(window,"error"),warn:wr(window,"warm")},xr=function(e){return parseInt(e,10)},kr=function(e){return function(){return e}},Tr=function(e,n,t){return{major:kr(e),minor:kr(n),patch:kr(t)}},Sr=function(e,n){var t=e-n;return 0===t?0:t>0?1:-1},Nr=function(e){var n=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(e);return n?Tr(xr(n[1]),xr(n[2]),xr(n[3])):Tr(0,0,0)},Ar=function(e,n){var t=Sr(e.major(),n.major());if(0!==t)return t;var r=Sr(e.minor(),n.minor());if(0!==r)return r;var o=Sr(e.patch(),n.patch());return 0!==o?o:0},Dr=function(e){return e?Nr([(n=e).majorVersion,n.minorVersion].join(".").split(".").slice(0,3).join(".")):null;var n},Rr=function(e,n){return Ar(Dr(e),Nr(n))<0};tinymce.PluginManager.requireLangPack("a11ychecker","ar,ca,cs,da,de,el,es,fa,fi,fr,he,hu,it,ja,kk,ko,nb,nl,pl,pt_pt,pt,ro,ru,sk,sl,sv,th,tr,uk,zh_tw,zh"),tinymce.PluginManager.add("a11ychecker",function(e,n){if(Rr(tinymce,"4.3.13"))return br.error('The "a11ychecker" plugin requires at least 4.3.13 version of TinyMCE.'),function(){};var t=yr(e),r=function(){t.audit()};e.addButton("a11ycheck",{tooltip:fr.translate("a11y.widget.title"),icon:"a11y",onclick:r}),e.addMenuItem("a11ycheck",{text:fr.translate("a11y.widget.title"),context:"tools",onclick:r});var o=e.settings.a11ychecker_css_url,i=o||n+"/css/annotations.css";return e.on("init",function(n){e.dom.loadCSS(i)}),e.on("remove",function(e){1===tinymce.editors.length&&Xt.removeStyles()}),e.on("ResizeWindow",function(){mr.requestAnimationFrame(function(){t.positionDialog()})}),e.on("ScrollWindow",function(){t.positionDialog()}),e.on("ResizeEditor",function(){t.positionDialog()}),e.on("click",function(){t.stopAuditing()}),e.on("keydown",function(){t.stopAuditing()}),{getReport:t.getReport,toggleaudit:r}})}();
