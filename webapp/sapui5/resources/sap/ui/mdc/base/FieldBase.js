/*!
 * SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/Device','sap/ui/mdc/library','./FieldBaseRenderer','./FilterOperatorConfig','./Condition','./type/ConditionType','./type/ConditionsType','sap/ui/core/library','sap/ui/core/Control','sap/base/util/ObjectPath','sap/base/util/deepEqual','sap/base/util/merge','sap/ui/dom/containsOrEquals','sap/ui/model/base/ManagedObjectModel','sap/ui/base/ManagedObjectObserver'],function(q,D,l,F,a,C,b,c,d,e,O,f,m,g,M,h){"use strict";var E=l.EditMode;var j=l.FieldDisplay;var V=d.ValueState;var k=d.CalendarType;var n=e.extend("sap.ui.mdc.base.FieldBase",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.mdc",properties:{dataType:{type:"string",group:"Data",defaultValue:'sap.ui.model.type.String'},dataTypeConstraints:{type:"object",group:"Data",defaultValue:null},dataTypeFormatOptions:{type:"object",group:"Data",defaultValue:null},editMode:{type:"sap.ui.mdc.EditMode",group:"Data",defaultValue:E.Editable},required:{type:"boolean",group:"Data",defaultValue:false},display:{type:"sap.ui.mdc.FieldDisplay",defaultValue:j.Value},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:sap.ui.core.TextAlign.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:sap.ui.core.TextDirection.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},multipleLines:{type:"boolean",group:"Appearance",defaultValue:false},maxConditions:{type:"int",group:"Behavior",defaultValue:-1},conditions:{type:"object[]",group:"Data",defaultValue:[]},label:{type:"string",group:"Misc",defaultValue:""},_fieldHelpEnabled:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"},_onlyEEQ:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},contentEdit:{type:"sap.ui.core.Control",multiple:false},contentDisplay:{type:"sap.ui.core.Control",multiple:false},_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},fieldInfo:{type:"sap.ui.mdc.base.FieldInfoBase",multiple:false}},associations:{fieldHelp:{type:"sap.ui.mdc.base.FieldHelpBase",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{liveChange:{parameters:{value:{type:"string"},escPressed:{type:"boolean"},previousValue:{type:"string"}}},press:{}},publicMethods:[],defaultAggregation:"content"},_oManagedObjectModel:null});var o={"default":{edit:"sap/m/Input",editMulti:"sap/m/MultiInput",editMultiLine:"sap/m/TextArea",display:"sap/m/Text",createEdit:T,createEditMulti:W,createEditMultiLine:X,createDisplay:Y},search:{edit:"sap/m/SearchField",display:"sap/m/Text",createEdit:U,createDisplay:Y},date:{edit:"sap/m/DatePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:Z,createEditMulti:W,createDisplay:Y},time:{edit:"sap/m/TimePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:Z,createEditMulti:W,createDisplay:Y},dateTime:{edit:"sap/m/DateTimePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:Z,createEditMulti:W,createDisplay:Y},link:{edit:undefined,display:"sap/m/Link",createEdit:undefined,createDisplay:$},bool:{edit:"sap/m/Input",display:"sap/m/Text",createEdit:a1,createDisplay:Y}};var p={};var r={bool:{name:"sap/ui/mdc/base/BoolFieldHelp",id:"BoolDefaultHelp",control:undefined}};n.prototype.init=function(){this._oManagedObjectModel=new M(this);this._oObserver=new h(this._observeChanges.bind(this));this._oObserver.observe(this,{properties:["display","editMode","dataType","multipleLines","maxConditions","conditions","_onlyEEQ"],aggregations:["fieldInfo","content","contentEdit","contentDisplay"],associations:["fieldHelp"]});this._oDatePickerRequested={};this.attachEvent("modelContextChange",this._handleModelContextChange,this);};n.prototype.exit=function(){var i=this.getFieldInfo();if(i){i.detachEvent("dataUpdate",s1,this);}var w1=this.getContent();if(w1){P.call(this,w1);}var x1=this.getContentEdit();if(x1){P.call(this,x1);}var y1=this.getContentDisplay();if(y1){P.call(this,y1);}this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;this._oObserver.disconnect();this._oObserver=undefined;if(this._oFilterOperatorConfig){this._oFilterOperatorConfig.destroy();delete this._oFilterOperatorConfig;}if(this._oConditionType){this._oConditionType.destroy();this._oConditionType=undefined;}if(this._oConditionsType){this._oConditionsType.destroy();this._oConditionsType=undefined;}var z1=H.call(this);if(z1){z1.removeFilterField(this);}};n.prototype.onBeforeRendering=function(){Q.call(this);};n.prototype.onAfterRendering=function(){if(j1.call(this)&&this.getEditMode()!=E.Display){var i=this.getAggregation("_content");if(i){var w1=i.getFocusDomRef();q(w1).attr("autocomplete","off");}}};n.prototype.onfocusin=function(i){p1.call(this);};n.prototype.onsapup=function(i){var w1=j1.call(this);if(w1){i.preventDefault();i.stopPropagation();w1.navigate(-1);}};n.prototype.onsapdown=function(i){var w1=j1.call(this);if(w1){i.preventDefault();i.stopPropagation();w1.navigate(1);}};n.prototype.clone=function(i,w1){this.detachEvent("modelContextChange",this._handleModelContextChange,this);var x1=this.getContent();if(x1){P.call(this,x1);}var y1=this.getContentEdit();if(y1){P.call(this,y1);}var z1=this.getContentDisplay();if(z1){P.call(this,z1);}var A1=this.getFieldInfo();if(A1){A1.detachEvent("dataUpdate",s1,this);}var B1=e.prototype.clone.apply(this,arguments);this.attachEvent("modelContextChange",this._handleModelContextChange,this);if(x1){N.call(this,x1);}if(y1){N.call(this,y1);}if(z1){N.call(this,z1);}if(A1){A1.attachEvent("dataUpdate",s1,this);}return B1;};n.prototype.getFieldPath=function(){var i=this.getBindingPath("conditions");if(i&&i.startsWith("/conditions/")){return i.slice(12);}else{return"";}};n.prototype._fireChange=function(i,w1,x1){};n.mapEdmTypes={"Edm.Boolean":"sap.ui.model.odata.type.Boolean","Edm.Byte":"sap.ui.model.odata.type.Byte","Edm.Date":"sap.ui.model.odata.type.Date","Edm.DateTime":"sap.ui.model.odata.type.DateTime","Edm.DateTimeOffset":"sap.ui.model.odata.type.DateTimeOffset","Edm.Decimal":"sap.ui.model.odata.type.Decimal","Edm.Double":"sap.ui.model.odata.type.Double","Edm.Float":"sap.ui.model.odata.type.Single","Edm.Guid":"sap.ui.model.odata.type.Guid","Edm.Int16":"sap.ui.model.odata.type.Int16","Edm.Int32":"sap.ui.model.odata.type.Int32","Edm.Int64":"sap.ui.model.odata.type.Int64","Edm.SByte":"sap.ui.model.odata.type.SByte","Edm.Single":"sap.ui.model.odata.type.Single","Edm.String":"sap.ui.model.odata.type.String","Edm.Time":"sap.ui.model.odata.type.Time","Edm.TimeOfDay":"sap.ui.model.odata.type.TimeOfDay"};function _(i){var w1=s.call(this,i);if(w1){return new w1(w.call(this,i,this.getDataTypeFormatOptions(),this.getDataTypeConstraints()),this.getDataTypeConstraints());}else{return null;}}function s(i){var w1;while(!w1){w1=O.get(i||"");if(!w1){i=n.mapEdmTypes[i];if(!i){break;}}}return w1;}function t(){if(!this._oDataType){this._oDataType=this.getDataType();if(typeof this._oDataType==="string"){this._oDataType=_.call(this,this._oDataType);}}return this._oDataType;}n.prototype._getDataType=function(){return t.call(this);};function u(){if(this._oDataType&&typeof this._oDataType==="object"){return this._oDataType.getMetadata().getName();}else{return this.getDataType();}}function v(){if(this._oDataType&&typeof this._oDataType==="object"&&this._oDataType.oConstraints){return this._oDataType.oConstraints;}else{return this.getDataTypeConstraints();}}function w(i,w1,x1){if(this.getMaxConditions()!==1||this.getEditMode()===E.Display){return w1;}switch(i){case"Edm.Date":case"sap.ui.model.type.Date":case"sap.ui.model.odata.type.Date":this._sValueFormat="yyyy-MM-dd";break;case"Edm.DateTime":case"sap.ui.model.odata.type.DateTime":if(x1&&(x1.displayFormat==="Date"||x1.isDateOnly)){this._sValueFormat="yyyy-MM-dd";}else{this._sValueFormat="yyyy-MM-dd'T'HH:mm:ss";}break;case"Edm.DateTimeOffset":case"sap.ui.model.type.DateTime":case"sap.ui.model.odata.type.DateTimeOffset":this._sValueFormat="yyyy-MM-dd'T'HH:mm:ss";break;case"Edm.TimeOfDay":case"sap.ui.model.type.Time":case"sap.ui.model.odata.type.TimeOfDay":this._sValueFormat="HH:mm:ss";break;default:return w1;}this._sDisplayFormat="medium";if(w1){w1=m({},w1);if(w1.style){this._sDisplayFormat=w1.style;delete w1.style;}else if(w1.pattern){this._sDisplayFormat=w1.pattern;}if(w1.calendarType){this._sCalendarType=w1.calendarType;}w1.pattern=this._sValueFormat;w1.calendarType=k.Gregorian;}else{w1={pattern:this._sValueFormat,calendarType:k.Gregorian};}return w1;}function x(){var i=t.call(this);var w1=i.getMetadata().getName();var x1=i.oFormatOptions;var y1=i.oConstraints;if(!x1||x1.style||!x1.pattern||x1.pattern!==this._sValueFormat||!x1.calendarType||x1.calendarType!==k.Gregorian){if(y1&&y1.isDateOnly){y1=m({},y1);delete y1.isDateOnly;y1.displayFormat="Date";}var z1=O.get(w1);this._oDataType=new z1(w.call(this,w1,x1,y1),y1);t1.call(this);}}function y(i,w1){var x1=j1.call(this);if(x1&&this._bConnected){var i=m([],i);x1.setConditions(i);}}n.prototype._getContent=function(){var i=this.getContent();if(!i){if(this.getEditMode()===E.Display){i=this.getContentDisplay();}else{i=this.getContentEdit();}}return i||this.getAggregation("_content");};function z(i){if(i&&i===E.Editable){return true;}else{return false;}}function A(i){if(i&&i!==E.Disabled){return true;}else{return false;}}function B(i){if(i&&i!==E.Editable){return true;}else{return false;}}function G(){var i=u.call(this);if(i==="Edm.Boolean"||i==="sap.ui.model.type.Boolean"||i==="sap.ui.model.odata.type.Boolean"||i==="sap.ui.mdc.base.type.Boolean"){return true;}else{return this.getProperty("_onlyEEQ");}}n.prototype._getOnlyEEQ=function(){return G.call(this);};n.prototype._handleModelContextChange=function(i){if(!this._bFFAdded){var w1=H.call(this);if(w1){w1.addFilterField(this);this._bFFAdded=true;}}};function H(){var i=this.getBinding("conditions");if(i){var w1=i.getModel();if(w1.isA("sap.ui.mdc.base.ConditionModel")){return w1;}}return undefined;}n.prototype._getFilterOperatorConfig=function(){var i=H.call(this);if(i){return i.getFilterOperatorConfig();}else if(this._oFilterOperatorConfig){return this._oFilterOperatorConfig;}else{this._oFilterOperatorConfig=a.getFor();return this._oFilterOperatorConfig;}};function I(w1){var x1=-1;var y1=this.getConditions();var z1=JSON.stringify(w1,['fieldPath','operator','values']);y1.some(function(w1,i){if(JSON.stringify(w1,['fieldPath','operator','values'])===z1){x1=i;return true;}return false;});return x1;}function J(i){var w1=H.call(this);if(w1){w1.setUIMessage(this.getFieldPath(),i);}else{this.setValueState(V.Error);this.setValueStateText(i);}}function K(){var i=H.call(this);if(i){i.removeUIMessage(this.getFieldPath());}else{this.setValueState(V.None);this.setValueStateText();}}n.prototype._observeChanges=function(i){if(i.name==="editMode"){if(this.getAggregation("_content")){Q.call(this);}}if(i.name==="multipleLines"){if(this.getAggregation("_content")){Q.call(this);}}if(i.name==="dataType"){if(this._oDataType){var w1=s.call(this,i.current);if(!(this._oDataType instanceof w1)){this._oDataType.destroy();this._oDataType=undefined;delete this._sDisplayFormat;delete this._sValueFormat;delete this._sCalendarType;this.destroyAggregation("_content");t1.call(this);}}}if(i.name==="maxConditions"){if(this.getAggregation("_content")){Q.call(this);}t1.call(this);}if(i.name==="conditions"){y.call(this,i.current,i.old);}if(i.name==="display"){this.destroyAggregation("_content");t1.call(this);}if(i.name==="fieldHelp"&&i.ids){i1.call(this,i.ids,i.mutation);t1.call(this);}if(i.name==="fieldInfo"&&i.child){r1.call(this,i.child,i.mutation);}if(i.name==="content"&&i.child){L.call(this,i.child,i.mutation);}if(i.name==="contentEdit"&&i.child){L.call(this,i.child,i.mutation);}if(i.name==="contentDisplay"&&i.child){L.call(this,i.child,i.mutation);}if(i.name==="_onlyEEQ"){t1.call(this);}};n.prototype.getFocusDomRef=function(){var i=this._getContent();if(i){return i.getFocusDomRef();}else{return this.getDomRef();}};n.prototype.getIdForLabel=function(){var i;var w1=this._getContent();if(w1){i=w1.getIdForLabel();}else{i=this.getId();}return i;};n.prototype.enhanceAccessibilityState=function(i,w1){var x1=this.getParent();if(x1&&x1.enhanceAccessibilityState){x1.enhanceAccessibilityState(this,w1);}return w1;};n.prototype.connectLabel=function(i){S.call(this,i);i.bindProperty("text",{path:"$field>/label"});i.setLabelFor(this);return this;};function L(i,w1){if(w1==="remove"){P.call(this,i);}else if(w1==="insert"){S.call(this,i);N.call(this,i);if(this.getAggregation("_content")){this.destroyAggregation("_content");}var x1;var y1;for(y1 in i.getMetadata().getAllProperties()){if(i.getBindingPath(y1)==="/conditions"){x1=i.getBindingInfo(y1);if(x1&&x1.type&&x1.type instanceof c){this._oConditionsType=x1.type;t1.call(this);}this._sBoundProperty=y1;}if(y1==="editable"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/editMode",formatter:z});}if(y1==="enabled"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/editMode",formatter:A});}if(y1==="displayOnly"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/editMode",formatter:B});}if(y1==="required"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/required"});}if(y1==="textAlign"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/textAlign"});}if(y1==="textDirection"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/textDirection"});}if(y1==="valueState"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/valueState"});}if(y1==="valueStateText"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/valueStateText"});}if(y1==="placeholder"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/placeholder"});}if(y1==="tooltip"&&!i.getBindingPath(y1)&&i.isPropertyInitial(y1)){i.bindProperty(y1,{path:"$field>/tooltip"});}}for(var z1 in i.getMetadata().getAllAggregations()){if(i.getBindingPath(z1)==="/conditions"){x1=i.getBindingInfo(z1);if(x1&&x1.template){for(y1 in x1.template.getMetadata().getAllProperties()){var A1=x1.template.getBindingInfo(y1);if(A1&&A1.type&&A1.type instanceof b){this._oConditionType=A1.type;t1.call(this);break;}}}break;}}}}function N(i){if(i.getMetadata().getEvents().change){i.attachEvent("change",e1,this);}if(i.getMetadata().getEvents().liveChange){i.attachEvent("liveChange",f1,this);}if(i.getMetadata().getEvents().press){i.attachEvent("press",g1,this);}}function P(i){if(i.getMetadata().getEvents().change){i.detachEvent("change",e1,this);}if(i.getMetadata().getEvents().liveChange){i.detachEvent("liveChange",f1,this);}if(i.getMetadata().getEvents().press){i.detachEvent("press",g1,this);}}function Q(){var i=this.getEditMode();if(this.getContent()||this._bIsBeingDestroyed||(i===E.Display&&this.getContentDisplay())||(i!==E.Display&&this.getContentEdit())){this.destroyAggregation("_content");return;}var w1=u.call(this);var x1=v.call(this);var y1=this.getMaxConditions();var z1;var A1;var B1;var C1=this.getAggregation("_content");var D1;if(C1){D1=C1.getMetadata().getName().replace(/\./g,"/");}switch(w1){case"Edm.Date":case"sap.ui.model.type.Date":case"sap.ui.model.odata.type.Date":z1=o.date;break;case"Edm.DateTime":case"sap.ui.model.odata.type.DateTime":if(x1&&(x1.displayFormat==="Date"||x1.isDateOnly)){z1=o.date;}else{z1=o.dateTime;}break;case"Edm.DateTimeOffset":case"sap.ui.model.type.DateTime":case"sap.ui.model.odata.type.DateTimeOffset":z1=o.dateTime;break;case"Edm.TimeOfDay":case"sap.ui.model.type.Time":case"sap.ui.model.odata.type.TimeOfDay":z1=o.time;break;case"Edm.Boolean":case"sap.ui.model.type.Boolean":case"sap.ui.model.odata.type.Boolean":case"sap.ui.mdc.base.type.Boolean":z1=o.bool;break;default:if(this.getFieldInfo()&&this._bTriggerable){z1=o.link;}else{var E1=new RegExp("^\\*(.*)\\*|\\$search$");if(E1.test(this.getFieldPath())&&this.getMaxConditions()===1){z1=o.search;}else{z1=o.default;}}break;}if(i===E.Display){A1=z1.display;B1=z1.createDisplay;}else if(y1!==1){A1=z1.editMulti;B1=z1.createEditMulti;}else if(this.getMultipleLines()){A1=z1.editMultiLine;B1=z1.createEditMultiLine;}else{A1=z1.edit;B1=z1.createEdit;}if(!A1){throw new Error("No control defined for type "+w1+" in "+this);}if(A1!==D1){this._bHideOperator=false;if(C1){this.destroyAggregation("_content");t1.call(this);}if(!p[A1]){p[A1]={};}var F1=p[A1].control;if(!F1){if(p[A1].promise){p[A1].promise.then(Q.bind(this));return;}else{F1=sap.ui.require(A1);if(F1){p[A1].control=F1;}else{p[A1].promise=new Promise(function(I1){p[A1].resolve=I1;sap.ui.require([A1],R.bind(this));}.bind(this)).then(Q.bind(this));return;}}}var G1=this.getId()+"-inner";var H1=B1.call(this,F1,G1);H1.attachEvent("parseError",d1,this);S.call(this,H1);this.setAggregation("_content",H1);}}function R(i){var w1=i.getMetadata().getName();w1=w1.replace(/\./g,"/");p[w1].control=i;p[w1].resolve();delete p[w1].resolve;}function S(i){i.setModel(this._oManagedObjectModel,"$field");}function T(i,w1){var x1=v1.call(this);var y1=new i(w1,{value:{path:"$field>/conditions",type:x1},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:z},enabled:{path:"$field>/editMode",formatter:A},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"100%",tooltip:"{$field>/tooltip}",change:e1.bind(this),liveChange:f1.bind(this),valueHelpRequest:k1.bind(this),showSuggestion:true});q1.call(this,y1);this._sBoundProperty="value";return y1;}function U(i,w1){this._bHideOperator=true;var x1=u1.call(this);var y1=new i(w1,{value:{path:"$field>/conditions/0",type:x1,mode:"OneWay"},placeholder:"{$field>/placeholder}",width:"100%",tooltip:"{$field>/tooltip}",search:e1.bind(this)});return y1;}function W(i,w1){var x1=sap.ui.require("sap/m/Token");if(!x1){throw new Error("sap.m.Token not loaded "+this);}var y1=u1.call(this);var z1=new x1(w1+"-token",{text:{path:'$field>',type:y1}});var A1=new i(w1,{placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:z},enabled:{path:"$field>/editMode",formatter:A},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"100%",tooltip:"{$field>/tooltip}",tokens:{path:"$field>/conditions",template:z1},dependents:[z1],change:e1.bind(this),liveChange:f1.bind(this),tokenUpdate:h1.bind(this),valueHelpRequest:k1.bind(this)});q1.call(this,A1);return A1;}function X(i,w1){var x1=v1.call(this);var y1=new i(w1,{value:{path:"$field>/conditions",type:x1},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:z},enabled:{path:"$field>/editMode",formatter:A},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:e1.bind(this),liveChange:f1.bind(this)});this._sBoundProperty="value";return y1;}function Y(i,w1){var x1=v1.call(this);var y1=new i(w1,{text:{path:"$field>/conditions",type:x1},textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",wrapping:"{$field>/multipleLines}",width:"100%",tooltip:"{$field>/tooltip}"});this._sBoundProperty="text";return y1;}function Z(i,w1){this._bHideOperator=true;var x1=v1.call(this);x.call(this);var y1=new i(w1,{value:{path:"$field>/conditions",type:x1},displayFormat:this._sDisplayFormat,valueFormat:this._sValueFormat,placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:z},enabled:{path:"$field>/editMode",formatter:A},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:e1.bind(this)});if(y1.setDisplayFormatType){y1.setDisplayFormatType(this._sCalendarType);}this._sBoundProperty="value";return y1;}function $(i,w1){var x1=v1.call(this);var y1=new i(w1,{text:{path:"$field>/conditions",type:x1},textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",tooltip:"{$field>/tooltip}",press:g1.bind(this)});this._sBoundProperty="text";return y1;}function a1(i,w1){if(!this.getFieldHelp()){b1.call(this,"bool");}return T.call(this,i,w1);}function b1(i){this.setProperty("_fieldHelpEnabled",true,true);this._sDefaultFieldHelp=r[i].id;var w1=r[i].control;if(!w1){if(r[i].promise){r[i].promise.then(c1.bind(this));}var x1=sap.ui.require(r[i].name);if(!x1&&!r[i].promise){r[i].promise=new Promise(function(y1){r[i].resolve=y1;sap.ui.require([r[i].name],function(z1){b1.call(this,i);}.bind(this));}.bind(this)).then(c1.bind(this));}if(x1){w1=new x1(r[i].id);r[i].control=w1;w1.connect(this);if(r[i].resolve){r[i].resolve();delete r[i].resolve;}if(!r[i].promise){c1.call(this);}}}}function c1(){i1.call(this,"BoolDefaultHelp","insert");q1.call(this,this.getAggregation("_content"));}function d1(i){this._bParseError=true;}function e1(i){var w1=this.getMaxConditions();var x1=m([],this.getConditions());var y1;var z1=true;var A1;var B1;if("valid"in i.getParameters()){z1=i.getParameter("valid");if(!z1&&"value"in i.getParameters()){A1=i.getParameter("value");}}var C1=false;var D1=this._sBoundProperty&&i.oSource.getBindingInfo(this._sBoundProperty);if(D1&&D1.binding&&D1.binding.sPath==="/conditions"&&z1){B1=x1[0];y1=x1[0]&&x1[0].values[0];}else if("value"in i.getParameters()){y1=i.getParameter("value");if(z1){C1=true;}}else if("query"in i.getParameters()){y1=i.getParameter("query");C1=true;}else{B1=x1[0];y1=x1[0]&&x1[0].values[0];}if(C1){var E1=u1.call(this);try{K.call(this);B1=E1.parseValue(y1);E1.validateValue(B1);}catch(F1){z1=false;A1=y1;J.call(this,F1.message);}if(z1){if(B1){if(I.call(this,B1)>=0){return;}if(w1>0&&w1<=x1.length){x1.splice(0,x1.length-w1+1);}x1.push(B1);}else if(w1===1){x1=[];}if(!f(x1,this.getConditions())){this.setProperty("conditions",x1,true);}}}else if(!("valid"in i.getParameters())&&this._bParseError){A1=i.getParameter("value");z1=false;}if(w1!==1&&z1){i.getSource().setValue("");}var G1=j1.call(this);if(G1&&this._bConnected){G1.close();G1.setFilterValue("");G1.setConditions(x1);}this._bParseError=false;this._fireChange(x1,z1,A1);}function f1(i){var w1;var x1;var y1=false;if("value"in i.getParameters()){w1=i.getParameter("value");}if("escPressed"in i.getParameters()){y1=i.getParameter("escPressed");}if("previousValue"in i.getParameters()){x1=i.getParameter("previousValue");}else{var z1=this.getConditions();x1=z1[0]&&z1[0].values[0];}var A1=j1.call(this);if(A1&&A1.openByTyping()){var B1;B1=w1;var C1=t.call(this);if(C1&&(C1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||C1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"||C1.getMetadata().getName()==="sap.ui.model.type.Unit"||C1.getMetadata().getName()==="sap.ui.model.type.Currency")){var rx=new RegExp(/^([,.\d]+)\s(.+)$/i);var E1=B1.match(rx);if(E1){B1=E1[2];}else{rx=new RegExp(/^(.+)\s([,.\d]+)$/i);E1=B1.match(rx);if(E1){B1=E1[1];}else if(/\d/.test(B1)){B1=undefined;}}}A1.setFilterValue(B1);if(A1.getConditions().length>0){A1.setConditions([]);}A1.open(true);}this.fireLiveChange({value:w1,escPressed:y1,previousValue:x1});}function g1(i){var w1=this.getFieldInfo();if(w1){w1.getTriggerHref().then(function(x1){if(x1){window.location.href=x1;}else{w1.open(this._getContent());}}.bind(this));}this.firePress();}function h1(w1){if(w1.getParameter("type")==="removed"){var x1=w1.getParameter("removedTokens");var y1=this.getConditions();var i;for(i=0;i<x1.length;i++){var z1=x1[i];var A1=z1.getBindingContext("$field").sPath;var B1=parseInt(A1.slice(A1.lastIndexOf("/")+1));y1[B1].delete=true;}for(i=y1.length-1;i>=0;i--){if(y1[i].delete){y1.splice(i,1);}}this.setProperty("conditions",y1,true);this._fireChange(y1,true);}}function i1(i,w1){var x1=sap.ui.getCore().byId(i);if(w1==="remove"){x1.detachEvent("select",l1,this);x1.detachEvent("navigate",m1,this);x1.detachEvent("dataUpdate",n1,this);x1.detachEvent("disconnect",o1,this);this.setProperty("_fieldHelpEnabled",false,true);}else if(w1==="insert"){if(x1){x1.attachEvent("dataUpdate",n1,this);this.setProperty("_fieldHelpEnabled",true,true);}}y.call(this,this.getConditions());}function j1(){var i=this.getFieldHelp();var w1;if(!i&&this._sDefaultFieldHelp){i=this._sDefaultFieldHelp;}if(i){w1=sap.ui.getCore().byId(i);}return w1;}function k1(i){var w1=j1.call(this);if(w1){w1.setFilterValue("");var x1=m([],this.getConditions());w1.setConditions(x1);w1.toggleOpen(false);}}function l1(w1){var x1=this.getConditions();var y1=w1.getParameter("conditions");var z1=w1.getParameter("add");var A1=this.getMaxConditions();var B1=G.call(this);var C1;var D1=t.call(this);var E1=this._getContent();var F1;var rx=new RegExp(/^([,.\d]+)\s(.+)$/i);var H1=new RegExp(/^(.+)\s([,.\d]+)$/i);var I1;var J1="";if(!z1){x1=[];}if(D1&&(D1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||D1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"||D1.getMetadata().getName()==="sap.ui.model.type.Unit"||D1.getMetadata().getName()==="sap.ui.model.type.Currency")&&A1===1){if(y1.length>0){var K1;if(D1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||D1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"){K1=y1[0].values[0];}else{K1=y1[0].values[1];}F1=E1.getDOMValue&&E1.getDOMValue();I1=F1.match(rx);if(I1){J1=I1[1]+" "+K1;}else{I1=F1.match(H1);if(I1){J1=K1+" "+I1[2];}else if(F1&&/\d/.test(F1)){J1=F1.trim()+" "+K1;}else{J1="0 "+K1;}}I1=D1.parseValue(J1,"string");C1=C.createItemCondition(I1);x1.push(C1);}}else{for(var i=0;i<y1.length;i++){C1=y1[i];if(B1&&C1.operator!=="EQ"&&C1.operator!=="EEQ"){continue;}if(!z1||I.call(this,C1)===-1){x1.push(C1);}}}if(A1>0&&A1<x1.length){x1.splice(0,x1.length-A1);}if(E1&&E1.setDOMValue&&A1!==1){E1.setDOMValue("");}this.setProperty("conditions",x1,true);this._oManagedObjectModel.checkUpdate();this._fireChange(x1,true);}function m1(i){var w1=i.getParameter("value");var x1=i.getParameter("key");var y1;var z1=this._getContent();var A1=t.call(this);if(A1&&(A1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||A1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"||A1.getMetadata().getName()==="sap.ui.model.type.Unit"||A1.getMetadata().getName()==="sap.ui.model.type.Currency")){if(A1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||A1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"){w1=x1;}var B1=z1.getDOMValue&&z1.getDOMValue();var rx=new RegExp(/^([,.\d]+)\s(.+)$/i);var D1=B1.match(rx);if(D1){y1=D1[1]+" "+w1;}else{rx=new RegExp(/^(.+)\s([,.\d]+)$/i);D1=B1.match(rx);if(D1){y1=w1+" "+D1[2];}else if(B1&&/\d/.test(B1)){y1=B1.trim()+" "+w1;}else{y1=w1;}}w1=y1;}else if(this.getDisplay()===j.Description){y1=x1;}else if(w1){y1=w1;}else{y1=x1;}if(z1&&z1.setDOMValue){z1.setDOMValue(w1||x1);z1._doSelect();}this.fireLiveChange({value:y1});}function n1(i){var w1=this.getEditMode()===E.Editable&&this._getContent()&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent().getId();y.call(this,this.getConditions());if(!w1&&(this.getMaxConditions()!==1||this.getDisplay()!==j.Value)){this._oManagedObjectModel.checkUpdate(true);}}function o1(i){var w1=j1.call(this);w1.detachEvent("select",l1,this);w1.detachEvent("navigate",m1,this);w1.detachEvent("disconnect",o1,this);this._bConnected=false;}function p1(){var i=j1.call(this);if(i&&!this._bConnected){i.connect(this);this._bConnected=true;i.attachEvent("select",l1,this);i.attachEvent("navigate",m1,this);i.attachEvent("disconnect",o1,this);var w1=m([],this.getConditions());i.setConditions(w1);var x1=this._getContent();if(x1&&!x1.orgOnsapfocusleave&&x1.onsapfocusleave){x1.orgOnsapfocusleave=x1.onsapfocusleave;x1.onsapfocusleave=function(y1){var i=j1.call(this.getParent());if(i){var z1=sap.ui.getCore().byId(y1.relatedControlId);if(z1&&g(i.getDomRef(),z1.getFocusDomRef())){y1.stopPropagation();return;}}this.orgOnsapfocusleave(y1);};}}}function q1(i){var w1=j1.call(this);if(w1&&i&&i.addEndIcon){var x1=w1.getIcon();var y1=i.getAggregation("_endIcon",[])[0];if(y1){y1.setSrc(x1);}else{i.addEndIcon({id:i.getId()+"-vhi",src:x1,useIconTooltip:false,noTabStop:true,press:function(z1){if(!this.getValueHelpOnly()){var A1;if(D.support.touch){A1=this.$('inner');A1.attr('readonly','readonly');this.focus();A1.removeAttr('readonly');}else{this.focus();}this.bValueHelpRequested=true;this.fireValueHelpRequest({fromSuggestions:false});}}.bind(i)});}}}function r1(i,w1){if(w1==="remove"){i.detachEvent("dataUpdate",s1,this);}else if(w1==="insert"){i.attachEvent("dataUpdate",s1,this);s1.call(this);}}function s1(){if(this.getEditMode()===E.Display){var i=this.getFieldInfo();var w1=this;i.isTriggerable().then(function(x1){w1._bTriggerable=x1;if(w1.getAggregation("_content")){Q.call(w1);}});}}n.prototype._getFormatOptions=function(){return{onlyEEQ:G.call(this),valueType:t.call(this),display:this.getDisplay(),fieldHelpID:this.getFieldHelp()||this._sDefaultFieldHelp,filterOperatorConfig:this._getFilterOperatorConfig(),hideOperator:this._bHideOperator,maxConditions:this.getMaxConditions()};};function t1(){if(this._oConditionType||this._oConditionsType){var i=this._getFormatOptions();if(this._oConditionType){this._oConditionType.setFormatOptions(i);}if(this._oConditionsType){this._oConditionsType.setFormatOptions(i);}}}function u1(){if(!this._oConditionType){this._oConditionType=new b();t1.call(this);}return this._oConditionType;}function v1(){if(!this._oConditionsType){this._oConditionsType=new c();t1.call(this);}return this._oConditionsType;}return n;},true);
