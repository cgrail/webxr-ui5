/*!
 * SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/model/SimpleType','sap/ui/model/FormatException','sap/ui/model/ParseException','sap/ui/model/ValidateException','sap/ui/model/type/String','sap/ui/mdc/library','sap/ui/mdc/base/FilterOperatorConfig','sap/ui/mdc/base/Condition','sap/base/util/merge'],function(S,F,P,V,a,l,b,C,m){"use strict";var c=l.FieldDisplay;var d=S.extend("sap.ui.mdc.base.type.ConditionType",{constructor:function(){S.apply(this,arguments);this.sName="Condition";}});d.prototype.destroy=function(){S.prototype.destroy.apply(this,arguments);if(this._oDefaultType){this._oDefaultType.destroy();delete this._oDefaultType;}if(this._oFilterOperatorConfig){this._oFilterOperatorConfig.destroy();delete this._oFilterOperatorConfig;}};d.prototype.formatValue=function(o,I){if(o==undefined||o==null){return null;}if(typeof o!=="object"||!o.operator||!o.values||!Array.isArray(o.values)){throw new F("No valid condition provided");}if(!I){I="string";}var D=_.call(this);var t=e.call(this);var j=g.call(this);var k=f.call(this);i.call(this,o,t);switch(this.getPrimitiveType(I)){case"string":case"any":if(D!==c.Value&&o.values.length===1&&j){var s=j.getTextForKey(o.values[0]);if(s){o=m({},o);o.values.push(s);}}if(this.oFormatOptions.onlyEEQ&&o.operator==="EQ"){o=m({},o);o.operator="EEQ";}try{if(this.oFormatOptions.hideOperator&&o.values.length>=1){return t.formatValue(o.values[0],"string");}var O=k.getOperator(o.operator);return O.format(o.values,o,t,D);}catch(E){throw new F(E.message);}break;default:if(t&&o.values.length>=1){return t.formatValue(o.values[0],I);}throw new F("Don't know how to format Condition to "+I);}};d.prototype.parseValue=function(v,I){if(!I){I="string";}else if(I==="any"&&typeof v==="string"){I="string";}var D=_.call(this);var o=g.call(this);var t=e.call(this);var T=t.getMetadata().getName();var j=f.call(this);var s;if(!v){if(!h.call(this,t)){return null;}}switch(this.getPrimitiveType(I)){case"string":var k=v;var O;if(k&&D!==c.Value&&o){var K=o.getKeyForText(k);if(K===undefined||K===null){var n=o.getTextForKey(k);if(n){K=k;k=n;}}if(K!==undefined&&K!==null){return C.createItemCondition(K,k);}}if(this.oFormatOptions.onlyEEQ){O=j.getOperator("EEQ");if(!O.test(k,t)){k="=="+k;}}else{var p=j.getMatchingOperators(T,k);if(p.length===0){s=j.getDefaultOperator(T);O=j.getOperator(s);k=O?O.format([k]):k;}else{O=p[0];}}try{if(O){var q=O.getCondition(k,t);if(q){i.call(this,q,t);return q;}}}catch(E){throw E;}throw new P("Cannot parse value "+v);default:if(t){if(this.oFormatOptions.onlyEEQ){s="EEQ";}else{s=j.getDefaultOperator(T);}return C.createCondition(s,[t.parseValue(v,I)]);}throw new P("Don't know how to parse Condition from "+I);}};d.prototype.validateValue=function(o){if(o==undefined||o==null){return null;}if(typeof o!=="object"||!o.operator||!o.values||!Array.isArray(o.values)){throw new V("No valid condition provided");}var t=e.call(this);if(o.operator==="EQ"||o.operator==="EEQ"){try{t.validateValue(o.values[0]);}catch(E){throw new V(E.message);}}};function _(){var D=this.oFormatOptions.display;if(!D){D=c.Value;}return D;}function e(){var t=this.oFormatOptions.valueType;if(!t){if(!this._oDefaultType){this._oDefaultType=new a();}t=this._oDefaultType;}return t;}function f(){var o=this.oFormatOptions.filterOperatorConfig;if(!o){if(!this._oFilterOperatorConfig){this._oFilterOperatorConfig=new b();}o=this._oFilterOperatorConfig;}return o;}function g(){var I=this.oFormatOptions.fieldHelpID;if(I){return sap.ui.getCore().byId(I);}return null;}function h(t){return t&&t instanceof sap.ui.model.CompositeType;}function i(o,t){if(h.call(this,t)&&o&&o.values[0]){t._aCurrentValue=o.values[0];}}return d;});
