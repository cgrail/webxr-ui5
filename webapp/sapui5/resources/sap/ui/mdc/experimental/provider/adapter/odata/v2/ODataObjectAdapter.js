/*
 * ! SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/mdc/experimental/provider/adapter/base/ObjectAdapter","sap/ui/mdc/experimental/provider/adapter/odata/v2/ODataBaseAdapter","sap/ui/mdc/experimental/provider/adapter/odata/v2/ODataFieldAdapter","sap/ui/mdc/experimental/provider/adapter/base/ColumnWrapper"],function(O,a,b,c){"use strict";var d=O.extend("sap.ui.mdc.experimental.provider.adapter.odata.v2.ODataObjectAdapter",{_schemaCache:{},constructor:function(m,M,C){O.prototype.constructor.apply(this,[m,M,C,a]);}});d.prototype.collection=function(){return this.asPath("/"+this.oEntitySet.name);};d.prototype.keys=function(){var i,k=this["//"]["key"]["propertyRef"],K={};for(i=0;i<k.length;i++){K[k[i].name]=this.fields[k[i].name];}return K;};d.prototype.fields=function(){var i,f,F=this["//"]["property"],o={};for(i=0;i<F.length;i++){f=F[i];o[f.name]=new b(this.oModel,this.sModelName,this.sContextName);o[f.name].switchMetaContext(this.sMetaPath+"/property/"+i,this.sPath+"/"+f.name);o[f.name].oEntitySet=this.oEntitySet;if(this.navigationPath){o[f.name].navigationPath=this.navigationPath+"/"+f.name;}}return o;};d.prototype.relations=function(){var n,N=this.navigationProperties(),r={};for(n in N){r[n]=this.resolveNavi(n,d);}return r;};d.prototype.chartInfo=function(q){var C=a.utils.getVisualAnno(a.annotations.CHART,this,q),o;function g(s,e){var A=e?C.DimensionAttributes:C.MeasureAttributes;var r=e?a.annotations.DIMENSION_ROLES:a.annotations.MEASURE_ROLES;var k=e?"Dimension":"Measure";var h={Role:r[""]};if(A){for(var l=0;l<A.length;l++){if(A[l][k].$PropertyPath==s){h={Role:r[A[l].Role.$EnumMember]};break;}}}return h;}if(C){var f,D,m;o={Title:C.Title?C.Title:"",Dimensions:[],Measures:[]};var j;for(j=0;j<C.Dimensions.length;j++){D=C.Dimensions[j];f=this.fields[D.PropertyPath]||this.resolveNavi(D.PropertyPath,b);o.Dimensions.push({name:D.PropertyPath,field:f,attributes:g(D.PropertyPath,true)});}for(j=0;j<C.Measures.length;j++){m=C.Measures[j];f=this.fields[m.PropertyPath]||this.resolveNavi(m.PropertyPath,b);o.Measures.push({name:m.PropertyPath,field:f,attributes:g(m.PropertyPath,false)});}}return o;};d.prototype.tableInfo=function(q){var t=a.utils.getVisualAnno(a.annotations.TABLE,this,q);var T={ModelName:this.sModelName,Set:this.sPath,Columns:[],Actions:[]};if(t){var i,l,A,f;var o=new c(null,t);var p=function(){sap.m.MessageToast.show("Function Import: "+this.oFunctionImport.name);};for(i=0;i<t.length;i++){l=t[i];switch(l.RecordType){case a.annotations.DATA_FIELD.FIELD:f=this.fields[l.Value.Path]||this.resolveNavi(l.Value.Path,b);o.switchField(f);T.Columns.push({label:o.label,field:f,model:this.sModelName});break;case a.annotations.DATA_FIELD.ACTION:A={};A.label=this.getAnnotation("Label/String",l);A.selection=!l.Inline;var F=this.getAnnotation("Action/String",l);A.id=F.replace("/","--");A.oFunctionImport=this.oMetaModel.getODataFunctionImport(F);A.press=p;A.enabled=true;T.Actions.push(A);}}}return T;};d.prototype.contactInfo=function(q){var C=a.utils.getAnnotation(a.annotations.CONTACT,this,q);return C;};d.prototype.relation=function(p){return this.resolveNavi(p,d);};return d;});
