/*
 * ! SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/mdc/experimental/provider/adapter/base/FieldAdapter","sap/ui/mdc/experimental/provider/adapter/odata/v4/ODataBaseAdapter","sap/ui/mdc/experimental/provider/adapter/AdapterFactory"],function(F,O,a){"use strict";var b=F.extend("sap.ui.mdc.experimental.provider.adapter.odata.v4.ODataFieldAdapter",{_parentCache:{},_promiseCache:{},constructor:function(m,M,c){F.prototype.constructor.apply(this,[m,M,c,O]);}});b.prototype.allowEmptyValue=function(){return true;};b.prototype.parent=function(){var p,P=this.sMetaPath.split("/");if(P[0]!==""){return null;}P[1]=O.utils.stripKeyPredicate(P[1]);P.splice(-1,1);p=P.join("/");if(!this._parentCache[p]){this._parentCache[p]=a.newAdapter("object",this.oModel,this.sModelName,this.sContextName,p,true);}return this._parentCache[p];};b.prototype.defaultValue=function(){switch(this.ui5Type){case"sap.ui.model.odata.type.Boolean":return false;case"sap.ui.model.odata.type.Byte":case"sap.ui.model.odata.type.Decimal":case"sap.ui.model.odata.type.Double":case"sap.ui.model.odata.type.Guid":case"sap.ui.model.odata.type.Int16":case"sap.ui.model.odata.type.Int32":case"sap.ui.model.odata.type.Int64":case"sap.ui.model.odata.type.SByte":case"sap.ui.model.odata.type.Single":return 0;case"sap.ui.model.odata.type.Date":case"sap.ui.model.odata.type.DateTimeOffset":case"sap.ui.model.odata.type.TimeOfDay":return new Date();case"Edm.String":return"";default:return"";}};b.prototype.precision=function(){return this["//"]["$Precision"];};b.prototype.scale=function(){return this["//"]["$Scale"];};b.prototype.maximum=function(){return 0;};b.prototype.exclusiveMaximum=function(){return false;};b.prototype.minimum=function(){return 0;};b.prototype.exclusiveMinimum=function(){return false;};b.prototype.maxLength=function(){var m=this["//"]["maxLength"];return isNaN(m)?undefined:parseInt(m);};b.prototype.minLength=function(){var m=this["//"]["minLength"];return isNaN(m)?undefined:parseInt(m);};b.prototype.multipleOf=function(){return 1;};b.prototype.pattern=function(){return"/.*?/";};b.prototype.unit=function(){};b.prototype.textAlign=function(){};b.prototype.visible=function(){return O.utils.visible("@"+O.annotations.HIDDEN,this);};b.prototype.ui5Type=function(){return this.oMetaModel.fetchUI5Type(this.sMetaPath);};b.prototype.formatOptions=function(){var f="";switch(this.ui5Type){case"sap.ui.model.odata.type.Boolean":break;case"sap.ui.model.odata.type.Byte":break;case"sap.ui.model.odata.type.Date":break;case"sap.ui.model.odata.type.DateTimeOffset":break;case"sap.ui.model.odata.type.Decimal":break;case"sap.ui.model.odata.type.Double":break;case"sap.ui.model.odata.type.Guid":break;case"sap.ui.model.odata.type.Int16":break;case"sap.ui.model.odata.type.Int32":break;case"sap.ui.model.odata.type.Int64":break;case"sap.ui.model.odata.type.SByte":break;case"sap.ui.model.odata.type.Single":break;case"sap.ui.model.odata.type.String":break;case"sap.ui.model.odata.type.TimeOfDay":break;default:break;}return f;};b.prototype.semantics=function(){return O.utils.asSemantics(this,F);};b.prototype.required=function(){return O.utils.required("./$Nullable",this);};b.prototype.filterable=function(){var t=this;return new Promise(function(r,c){t.parent.then(function(p){var R=p.filterRestrictions.filterable&&p.filterRestrictions.noFilter.indexOf(t.name)===-1;r(R);},function(d){c(d);});});};b.prototype.requiredInFilter=function(){var t=this;return new Promise(function(r,c){t.parent.then(function(p){var R=p.filterRestrictions.filterable&&p.requiredFilter.noFilter.indexOf(t.name)===-1;r(R);},function(d){c(d);});});};b.prototype.sortDirection=function(){var i=(this.parent.sortRestrictions.sortable&&this.parent.sortRestrictions.noSort.indexOf(this.schema.name)===-1);if(!i){F.SortDirection.none;}if(this.parent.sortRestrictions.ascOnly.indexOf(this.schema.name)!==-1){return F.SortDirection.asc;}if(this.parent.sortRestrictions.descOnly.indexOf(this.schema.name)!==-1){return F.SortDirection.desc;}return F.SortDirection.both;};b.prototype.valueHelp=function(){var t=this;function c(p){p.fromPromise.then(function(A){p.from=A;});}function d(m){return new Promise(function(r,e){var i,V={model:m.$model||t.oModel,modelName:(m.$model!=null)?"vl":t.sModelName,items:"/"+m.CollectionPath,parameters:[]};var A=[];for(i=0;i<m.Parameters.length;i++){var p=V.items+"/"+m.Parameters[i].ValueListProperty;V.parameters.push({to:m.Parameters[i].LocalDataProperty?m.Parameters[i].LocalDataProperty.$PropertyPath:null,type:O.utils.getValueHelpParamterType(m.Parameters[i].$Type),fromPromise:a.newAdapter("field",V.model,V.modelName,V.modelName,p)});A.push(V.parameters[i].fromPromise);}Promise.all(A).then(function(){for(i=0;i<V.parameters.length;i++){c(V.parameters[i]);}r(V);},function(R){e(R);});});}var v=O.utils.getAnnotation("@"+O.annotations.VALUE_LIST,t);if(v){return d(v);}else{return new Promise(function(r,e){t.oMetaModel.requestValueListInfo(t.sMetaPath).then(function(v){d(v[""]).then(function(V){r(V);},function(R){e(R);});},function(R){e(R);});});}};b.prototype.value=function(){return this.asPath(this.name,null,this.formatter);};b.prototype.describedBy=function(){var t=O.utils.getAnnotation("@"+O.annotations.TEXT,this);if(!t){return this.value;}return t;};b.prototype.semanticObject=function(){var s={defaultSemanticObject:undefined,additionalSemanticObjects:[]};return(s.defaultSemanticObject||s.additionalSemanticObjects.length>0)?s:undefined;};b.prototype.semanticObjectMapping=function(){return{};};return b;});
