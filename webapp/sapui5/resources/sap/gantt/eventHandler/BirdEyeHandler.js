sap.ui.define(["sap/ui/base/Object","sap/gantt/misc/Format","sap/gantt/config/TimeHorizon"],function(B,F,T){"use strict";var a=B.extend("sap.gantt.eventHandler.BirdEyeHandler",{constructor:function(c){B.call(this);this._oSourceChart=c;this._sStartTimeStamp=0;this._sEndTimeStamp=0;}});a.prototype.calculateLargestVisibleHorizon=function(A,I){if(!A||A.length===0){return null;}var t=this;for(var i=0;i<A.length;i++){var s=A[i];var d=s.dataSet;if(d&&d.length>0){for(var j=0;j<d.length;j++){t._collectShapeTimeRange(s,d[j]);}}}if(!this._sStartTimeStamp&&!this._sEndTimeStamp){return null;}var S=F.abapTimestampToDate(this._sStartTimeStamp).getTime();var e=F.abapTimestampToDate(this._sEndTimeStamp).getTime();var o=F.abapTimestampToDate(this._sStartTimeStamp);var E=F.abapTimestampToDate(this._sEndTimeStamp);if(!I){var n=this._oSourceChart.getVisibleWidth();var b=(e-S)/n;o=new Date(S-b*5);E=new Date(e+b*5);}var v=new T({startTime:o,endTime:E});this._sStartTimeStamp=0;this._sEndTimeStamp=0;return v;};a.prototype._collectShapeTimeRange=function(s,d,A,r){var t=this;if(d){var S=[];if(d.shapeData){r=d.objectInfoRef;S=S.concat(d.shapeData);}else if(A&&d[A]){S=S.concat(d[A]);}else if(d){S=S.concat(d);}if(s.filterValidData&&S.length>0){S=s.filterValidData(S,r);}if(s.getTag()=="g"&&S.length>0){var b=s.getShapes();if(b&&b.length>0){for(var i=0;i<b.length;i++){for(var j=0;j<S.length;j++){t._collectShapeTimeRange(b[i],S[j],b[i].mShapeConfig.getShapeDataName(),r);}}}}else if(s.mShapeConfig.getCountInBirdEye()){var c=(s.getTime||s.getEndTime)?true:false;if(S.length>0&&c){S.forEach(function(d){var e=s.getTime(d,r);var f=s.getEndTime(d,r);t._sStartTimeStamp=(e&&(!t._sStartTimeStamp||e<t._sStartTimeStamp))?e:t._sStartTimeStamp;if(f){t._sEndTimeStamp=(f&&(!t._sEndTimeStamp||f>t._sEndTimeStamp))?f:t._sEndTimeStamp;}else{t._sEndTimeStamp=(e&&(!t._sEndTimeStamp||e>t._sEndTimeStamp))?e:t._sEndTimeStamp;}});}}}};a.prototype.doBirdEye=function(b,r){if(this._oSourceChart){var g=this._oSourceChart;var t=g.getLargestHorizonByDataRange(b,r);if(t){g.getAxisTimeStrategy().setVisibleHorizon(t);}}};return a;},true);
