/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/library","sap/ui/core/Core","sap/gantt/misc/Utility","./Drawer","sap/gantt/misc/Format","sap/ui/thirdparty/d3"],function(l,C,U,D,F){"use strict";var A=D.extend("sap.gantt.drawer.AdhocLine",{constructor:function(a){this.oAxisTime=a;}});A.prototype.drawSvg=function(g,a,s,L){if(!a||a.length==0){return;}var v=C.getConfiguration().getRTL()?s.aTimeBoundary[1]:s.aTimeBoundary[0],V=C.getConfiguration().getRTL()?s.aTimeBoundary[0]:s.aTimeBoundary[1];var b=a.filter(function(d,I){var h=F.abapTimestampToDate(d.getTimeStamp());if(v<=h&&h<=V){return true;}return false;});g.selectAll(".sapGanttChartAdhocLine").remove();if(b.length==0){return;}var c=jQuery(g.node()),i=Math.max.apply(null,c.map(function(){return jQuery(this).height();}).get());if(L===l.AdhocLineLayer.Top){g.append("g").classed("sapGanttChartAdhocLine",true);}else if(L===l.AdhocLineLayer.Bottom){var o=document.createElementNS(d3.ns.prefix.svg,"g");o.setAttribute("class","sapGanttChartAdhocLine");var w=U.attributeEqualSelector("id",g.attr("id"));var e=jQuery(w).find(".sapGanttChartCalendar");var B=jQuery(w).find(".sapGanttChartRowBackground");if(e.length>0){e.after(o);}else if(B.length>0){B.after(o);}else{g.insert("g",":first-child").classed("sapGanttChartAdhocLine",true);}}var o=g.select(".sapGanttChartAdhocLine");var f=o.selectAll(".sapGanttChartAdhocTimestamp").data(b);var t=this;f.enter().append("line").classed("sapGanttChartAdhocTimestamp",true).attr("x1",function(d){return t.oAxisTime.timeToView(F.abapTimestampToDate(d.getTimeStamp()));}).attr("y1",function(d){return 0;}).attr("x2",function(d){return t.oAxisTime.timeToView(F.abapTimestampToDate(d.getTimeStamp()));}).attr("y2",function(d){return i;}).attr("stroke",function(d){return d.getStroke();}).attr("stroke-width",function(d){return d.getStrokeWidth();}).attr("stroke-dasharray",function(d){return d.getStrokeDasharray();}).attr("stroke-opacity",function(d){return d.getStrokeOpacity();});f.selectAll("title").remove();f.insert("title",":first-child").text(function(d){return d.getDescription();});};A.prototype.destroySvg=function(g){if(g){g.selectAll(".sapGanttChartAdhocLine").remove();}};return A;},true);
