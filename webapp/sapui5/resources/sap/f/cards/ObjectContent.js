/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/f/cards/BaseContent","sap/m/HBox","sap/m/VBox","sap/m/Text","sap/m/Title","sap/f/Avatar","sap/m/Link","sap/m/Label","sap/ui/core/ResizeHandler","sap/ui/layout/AlignedFlowLayout","sap/ui/dom/units/Rem"],function(B,H,V,T,a,A,L,b,R,c,d){"use strict";var O=B.extend("sap.f.cards.ObjectContent",{renderer:{}});O.prototype._getRootContainer=function(){if(this._bIsBeingDestroyed){return null;}var o=this.getAggregation("_content");if(!o){o=new c();this.setAggregation("_content",o);}this._sResizeListenerId=R.register(o,this.onAlignedFlowLayoutResize.bind(this));return o;};O.prototype.onAlignedFlowLayoutResize=function(e){if(e&&(e.size.width===e.oldSize.width)&&!e.control){return;}var C=e.control,m=C.getMinItemWidth(),n=C.getContent().length,M;if(m.lastIndexOf("rem")!==-1){M=d.toPx(m);}else if(m.lastIndexOf("px")!==-1){M=parseFloat(m);}var i=Math.floor(e.size.width/M);if(i>n){i=n;}if(this._iColsOld===i){return;}this._iColsOld=i;var l=i-1,r=Math.ceil(n/i);C.getContent().forEach(function(I,f){I.addStyleClass("sapFCardObjectSpaceBetweenGroup");if(l===f&&l<n){I.removeStyleClass("sapFCardObjectSpaceBetweenGroup");l+=i;}if(f+1>(r-1)*i){I.addStyleClass("sapFCardObjectGroupLastInColumn");}else{I.removeStyleClass("sapFCardObjectGroupLastInColumn");}});};O.prototype.exit=function(){if(this._sResizeListenerId){R.deregister(this._sResizeListenerId);this._sResizeListenerId="";}};O.prototype.setConfiguration=function(C){B.prototype.setConfiguration.apply(this,arguments);if(!C){return this;}if(C.groups){this._addGroups();}return this;};O.prototype._addGroups=function(){var C=this._getRootContainer();var g=this.getConfiguration().groups||[];g.forEach(function(G){var o=new V().addStyleClass("sapFCardObjectGroup");var t=new a({text:G.title}).addStyleClass("sapFCardObjectItemTitle");o.addItem(t);G.items.forEach(function(i){var I,l=i.label,v=i.value,e,h;if(l){l=l[l.length-1]===":"?l:l+=":";e=new b({text:l}).addStyleClass("sapFCardObjectItemLabel");}if(v){switch(i.type){case'link':I=new L({href:i.url||v,text:v,target:i.target||'_blank'});break;case'email':h="mailto:"+v;if(i.emailSubject){h+='?subject='+i.emailSubject;}I=new L({href:h,text:v});break;case'phone':I=new L({href:"tel:"+v,text:v});break;default:I=new T({text:v});break;}}if(I){I.addStyleClass("sapFCardObjectItemText");}if(i.icon){var f=new H({items:[new A({customDisplaySize:"2.5rem",displaySize:"Custom",src:i.icon.src}).addStyleClass("sapFCardObjectItemAvatar sapFCardObjectItemLabel"),new V({items:[e,I]})]});o.addItem(f);}else{o.addItem(e);o.addItem(I);}});C.addContent(o);});};return O;});
