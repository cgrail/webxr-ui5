/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/core/Control',"sap/f/cards/ActionEnablement",'sap/m/NumericContent','sap/m/Text','sap/f/cards/Data','sap/ui/model/json/JSONModel',"sap/f/cards/NumericSideIndicator","sap/f/cards/NumericHeaderRenderer"],function(C,A,N,T,D,J,a){"use strict";var b=C.extend("sap.f.cards.NumericHeader",{metadata:{interfaces:["sap.f.cards.IHeader"],properties:{title:{"type":"string",group:"Appearance"},subtitle:{"type":"string",group:"Appearance"},unitOfMeasurement:{"type":"string",group:"Data"},number:{"type":"string",group:"Data"},scale:{"type":"string",group:"Data"},trend:{"type":"sap.m.DeviationIndicator",group:"Appearance",defaultValue:"None"},state:{"type":"sap.m.ValueColor",group:"Appearance",defaultValue:"Neutral"},details:{"type":"string",group:"Appearance"}},aggregations:{sideIndicators:{type:"sap.f.cards.NumericSideIndicator",multiple:true},_title:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_subtitle:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_unitOfMeasurement:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_details:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_mainIndicator:{type:"sap.m.NumericContent",multiple:false,visibility:"hidden"}},events:{press:{}}},constructor:function(i,s){if(typeof i!=="string"){s=i;}if(s&&s.serviceManager){this._oServiceManager=s.serviceManager;delete s.serviceManager;}C.apply(this,arguments);}});b.prototype.setTitle=function(v){this.setProperty("title",v,true);this._getTitle().setText(v);return this;};b.prototype.setSubtitle=function(v){this.setProperty("subtitle",v,true);this._getSubtitle().setText(v);return this;};b.prototype.setUnitOfMeasurement=function(v){this.setProperty("unitOfMeasurement",v,true);this._getUnitOfMeasurement().setText(v);return this;};b.prototype.setDetails=function(v){this.setProperty("details",v,true);this._getDetails().setText(v);return this;};b.prototype.setNumber=function(v){this.setProperty("number",v,true);this._getMainIndicator().setValue(v);return this;};b.prototype.setScale=function(v){this.setProperty("scale",v,true);this._getMainIndicator().setScale(v);return this;};b.prototype.setTrend=function(v){this.setProperty("trend",v,true);this._getMainIndicator().setIndicator(v);return this;};b.prototype.setState=function(v){this.setProperty("state",v,true);this._getMainIndicator().setValueColor(v);return this;};b.prototype._getTitle=function(){var c=this.getAggregation("_title");if(!c){c=new T({id:this.getId()+"-title",wrapping:true,maxLines:3});this.setAggregation("_title",c);}return c;};b.prototype._getSubtitle=function(){var c=this.getAggregation("_subtitle");if(!c){c=new T({id:this.getId()+"-subtitle",wrapping:true,maxLines:2});this.setAggregation("_subtitle",c);}return c;};b.prototype._getUnitOfMeasurement=function(){var c=this.getAggregation("_unitOfMeasurement");if(!c){c=new T({id:this.getId()+"-unitOfMeasurement",wrapping:false});this.setAggregation("_unitOfMeasurement",c);}return c;};b.prototype._getDetails=function(){var c=this.getAggregation("_details");if(!c){c=new T({id:this.getId()+"-details",wrapping:false});this.setAggregation("_details",c);}return c;};b.prototype._getMainIndicator=function(){var c=this.getAggregation("_mainIndicator");if(!c){c=new N({id:this.getId()+"-mainIndicator",withMargin:false,nullifyValue:false,animateTextChange:false,truncateValueTo:5});this.setAggregation("_mainIndicator",c);}return c;};b.prototype.ontap=function(){this.firePress();};b.create=function(c,s){var S={title:c.title,subtitle:c.subTitle,unitOfMeasurement:c.unitOfMeasurement,details:c.details};if(c.mainIndicator){S.number=c.mainIndicator.number;S.scale=c.mainIndicator.unit;S.trend=c.mainIndicator.trend;S.state=c.mainIndicator.state;}if(c.sideIndicators){S.sideIndicators=c.sideIndicators.map(function(i){return new a(i);});}if(s){S.serviceManager=s;}var h=new b(S);if(c.data){this._handleData(h,c.data);}return h;};b._handleData=function(h,d){var m=new J();var r=d.request;if(d.json&&!r){m.setData(d.json);}if(r){D.fetch(r).then(function(c){m.setData(c);m.refresh();h.fireEvent("_updated");}).catch(function(e){});}h.setModel(m).bindElement({path:d.path||"/"});};b.prototype._getHeaderAccessibility=function(){var t=this._getTitle()?this._getTitle().getId():"",s=this._getSubtitle()?this._getSubtitle().getId():"",u=this._getUnitOfMeasurement()?this._getUnitOfMeasurement().getId():"",S=this.getSideIndicators()?this._getSideIndicatorIds():"",d=this._getDetails()?this._getDetails().getId():"",m=this._getMainIndicator()?this._getMainIndicator().getId():"";return t+" "+s+" "+u+" "+m+S+" "+d;};b.prototype._getSideIndicatorIds=function(){var s="";this.getSideIndicators().forEach(function(S){s+=" "+S.getId();});return s;};A.enrich(b);return b;});
