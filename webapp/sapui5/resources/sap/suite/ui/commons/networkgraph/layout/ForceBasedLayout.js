/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/suite/ui/commons/library","./LayoutAlgorithm","./Geometry","./D3ForceWrapper","./LayoutTask","sap/ui/performance/Measurement"],function(l,L,G,D,a,M){"use strict";var b=l.networkgraph.LayoutRenderType,S=12;var F=L.extend("sap.suite.ui.commons.networkgraph.layout.ForceBasedLayout",{metadata:{properties:{alpha:{type:"float",group:"Behavior",defaultValue:0.3},charge:{type:"float",group:"Behavior",defaultValue:-30},friction:{type:"float",group:"Behavior",defaultValue:0.9},maximumDuration:{type:"int",group:"Behaviour",defaultValue:1000}}}});F.prototype.getLayoutRenderType=function(){return b.Forces;};F.prototype.isLayered=function(){return false;};F.prototype.layout=function(){return new a(function(r,R,o){var g={nodes:[],links:[]},c=this.getParent();if(!c){R("The algorithm must be associated with a graph.");return;}M.start("NetworkGraph - ForcedBaseLayout","Layouting of a graph "+c.getId());c.getNodes().forEach(function(n,i){g.nodes.push({id:n.getKey()});n.iIndex=i;});c.getNodes().forEach(function(n){n.aChildren.forEach(function(C){g.links.push({source:n.iIndex,target:C.iIndex,value:1});});});D.layout({graph:g,alpha:this.getAlpha(),friction:this.getFriction(),charge:this.getCharge(),maximumDuration:this.getMaximumDuration()}).then(function(d){if(o.isTerminated()){r();return;}var g=d.graph||d;var B=G.getBoundingBox(g.nodes),x=(B.p1.x)*-S+100,y=(B.p1.y)*-S+100;g.nodes.forEach(function(e){var n=c.getNodeByKey(e.id);n.setX(e.x*S+x);n.setY(e.y*S+y);});this._normalizeLines();this._alignCoordinatesWithView();r();}.bind(this),R);}.bind(this));};return F;});
