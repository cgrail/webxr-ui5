/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/core/ComponentContainer","sap/ui/core/routing/HashChanger","sap/ui/core/routing/History","sap/ui/core/library","sap/suite/ui/generic/template/lib/ProcessObserver","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/lib/testableHelper","sap/ui/fl/ControlPersonalizationAPI","sap/base/Log"],function(q,B,C,H,a,c,P,r,T,t,b,L){"use strict";var d=c.routing.HistoryDirection;var h=a.getInstance();function f(R){var e=R.substring(R.length-5,R.length);if(e==="query"){return R.substring(0,R.length-5);}return R;}function n(s){if(s.indexOf("/")===0){return s;}return"/"+s;}function A(e){var D="";var R="";var p=Object.keys(e).sort();p.forEach(function(s){var v=e[s].sort();for(var i=0;i<v.length;i++){var V=v[i];R=R+D+s+"="+V;D="&";}});return R;}function g(p,s){return p+(s?"?"+s:"");}function k(p,e){var s=A(e);return g(p,s);}function l(i,R,j){var p=i.mRoutingTree[R.name];var s=R.template;var E=R.entitySet;var v=p.level;var O=-1;if(i.oFlexibleColumnLayoutHandler){O=v<3?v:0;}var u=O<0?i.oNavigationObserver:i.aNavigationObservers[O];var w=new P();var x=O<0?i.oHeaderLoadingObserver:i.aHeaderLoadingObservers[O];x.addObserver(w);var y={};var S={appComponent:i.oAppComponent,isLeaf:!R.pages||!R.pages.length,entitySet:E,navigationProperty:R.navigationProperty,componentData:{registryEntry:{oAppComponent:i.oAppComponent,componentCreateResolve:j,route:R.name,routeConfig:R,viewLevel:p.level,routingSpec:R.routingSpec,oNavigationObserver:u,oHeaderLoadingObserver:w,preprocessorsData:y}}};if(R.component.settings){q.extend(S,R.component.settings);}var z;i.oAppComponent.runAsOwner(function(){try{var D=sap.ui.core.Component.create({name:s,settings:S,handleValidation:true,manifest:true});var F;z=new C({propagateModel:true,width:"100%",height:"100%",settings:S});F=D.then(function(G){z.setComponent(G);var p=i.mRoutingTree[R.name];p.componentId=G.getId();return z;});z.loaded=function(){return F;};}catch(e){throw new Error("Component "+s+" could not be loaded");}});return z;}function m(e,p){t.testable(l,"fnCreateComponentInstance");var M={};var s={iHashChangeCount:0,backTarget:0,aCurrentKeys:[],componentsDisplayed:Object.create(null)};var u=[];var v=Promise.resolve();var w=[];var x=[];function G(){var i=p.oRouter,j=i.getTargets()._mTargets,M1=[];Object.keys(j).forEach(function(N1){var O1=j[N1],P1=O1._oOptions,Q1=i.getRoute(P1.viewName),R1=Q1&&Q1._oConfig;if(R1&&(!R1.navigation||!R1.navigation.display)){M1.push({oConfig:R1});}});return M1;}t.testable(G,"fnGetAllPages");function y(i){var j=i||G();if(!Array.isArray(j)){j=[j];}j.forEach(function(M1){M1.oComponentContainer=l(e,M1.oConfig,function(){});});return j;}t.testable(y,"fnCreatePages");function z(){var i=p.oRouter.getViews();i.getView({viewName:"root"});return e.mRouteToTemplateComponentPromise.root;}function D(){return p.oAppComponent.getManifestEntry("sap.app").title;}function E(i,j,M1){var N1=i&&e.componentRegistry[i];var O1=N1&&N1.methods.getUrlParameterInfo;return O1?N1.viewRegistered.then(function(){var P1=j&&n(j);return O1(P1,s.componentsDisplayed[N1.route]===1).then(function(Q1){q.extend(M1,Q1);});}):Promise.resolve();}function F(i,j,M1){var N1=e.mRoutingTree[i];return E(N1.componentId,M1,j);}function I(i,j){var M1=j?F("root",i):Promise.resolve();return M1.then(A.bind(null,i));}function J(j){for(var i=0;i<j.length;i++){if(j[i].title!==w[j.length-i-1]||""){j[i].subtitle=w[j.length-i-1]||"";}}x=j;e.oShellServicePromise.then(function(M1){M1.setHierarchy(j);});}function S(i,j){w[i]=j;var M1=x[x.length-i-1];if(M1){if(M1.title!==j){M1.subtitle=j;}e.oShellServicePromise.then(function(N1){N1.setHierarchy(x);});}}var K;function O(){if(!(K instanceof T)){J([]);return;}var j=K.getEntitySet();var M1=p.oTemplateContract.mEntityTree[j];if(!M1||M1.componentId!==K.getId()){J([]);return;}var N1=e.oFlexibleColumnLayoutHandler&&M1.level<3&&!e.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/isVisuallyFullScreen");var O1=e.oApplicationProxy.getLinkToUpperLayersInfo(true,N1,j);Promise.all(O1.aInfoObjectPromises).then(function(P1){var Q1=[];var R1=location.hash;var S1=R1.indexOf("?");var T1=(S1!==-1&&S1<R1.indexOf("&"))?"?":"&";var U1=R1.split(T1)[0]+"&/";for(var i=P1.length-1;i>=0;i--){var V1=P1[i];var W1={intent:U1+V1.fullLink};Q1.push(W1);if(i===0){W1.title=D();}else{var M1=p.oTemplateContract.mEntityTree[V1.entitySet];W1.title=M1.headerTitle;W1.icon=M1.titleIconUrl;}}J(Q1);});}function Q(i,j){var M1;if(!i&&j instanceof T){var N1=j&&e.componentRegistry[j.getId()];var O1=N1&&N1.methods.getTitle;M1=O1&&O1();}else if(!i&&j&&j.title){M1=j.title;}M1=M1||D();K=j;e.oShellServicePromise.then(function(P1){P1.setTitle(M1);O();});}function R(i){var j=[e.oPagesDataLoadedObserver.getProcessFinished(true)];var M1=null;var N1=s.iHashChangeCount;var O1=-1;for(var P1 in e.componentRegistry){var Q1=e.componentRegistry[P1];var R1=Q1.oControllerUtils&&Q1.oControllerUtils.oServices.oTemplateCapabilities.oMessageButtonHelper;var S1=s.componentsDisplayed[Q1.route]===1;var T1=Q1.utils.getTemplatePrivateModel();T1.setProperty("/generic/isActive",S1);if(S1){j.push(Q1.oViewRenderedPromise);if(Q1.viewLevel>O1){O1=Q1.viewLevel;M1=Q1.oComponent;}}else{Q1.utils.suspendBinding();}if(R1){R1.setEnabled(S1);}}var U1=e.oFlexibleColumnLayoutHandler&&e.oFlexibleColumnLayoutHandler.isAppTitlePrefered();Q(U1,i||M1);Promise.all(j).then(function(){if(N1===s.iHashChangeCount&&q.isEmptyObject(M)){e.oAppComponent.firePageDataLoaded();}});}var U=R.bind(null,null);function V(i,j){var M1=[];for(var N1=i;N1.level>=j;N1=e.mRoutingTree[N1.parentRoute]){M1.push(N1);}return M1.reverse();}function W(j,M1,N1){if(j.level===0){return null;}var O1=N1?j.pattern:j.contextPath;if(!O1){return null;}if(O1.indexOf("/")!==0){O1="/"+O1;}for(var i=1;i<M1.length;i++){O1=O1.replace("{keys"+i+"}",M1[i]);}return O1;}var X;var Y;function Z(){return Y;}function $(i){if(!Y||Y.treeNode!==i.treeNode){return false;}for(var j=i.treeNode;j.level>0;j=e.mRoutingTree[j.parentRoute]){if(!j.noKey&&i.keys[j.level]!==Y.keys[j.level]){return false;}}if(q.isEmptyObject(i.appStates)!==q.isEmptyObject(Y.appStates)){return false;}if(q.isEmptyObject(i.appStates)){return true;}var M1=q.extend(Object.create(null),i.appStates,Y.appStates);for(var N1 in M1){if(i.appStates[N1]!==Y.appStates[N1]){return false;}}return true;}function _(i){var j=Object.create(null);for(var M1=X.identity.treeNode;M1.level>0;M1=e.mRoutingTree[M1.parentRoute]){if(!M1.noKey){j["keys"+M1.level]=X.identity.keys[M1.level];}}var N1=!q.isEmptyObject(X.identity.appStates);var O1=X.identity.treeNode.sRouteName+(N1?"query":"");if(N1){j["query"]=X.identity.appStates;}p.oRouter.navTo(O1,j,i);}function a1(i){var j;if(i){if(X){if(X.mode===1){X.identity=i.identity;X.followUpNeeded=true;}return;}if(i.identity&&$(i.identity)){return;}j=i.mode;X=i;}else{j=1;}X.followUpNeeded=j<0;e.oBusyHelper.setBusyReason("HashChange",true);if(j<0){window.history.go(j);}else{_(j===1);}}function b1(i){if(X&&X.identity&&!X.followUpNeeded){Y=X.identity;return;}Y=Object.create(null);var j=i.getParameter("config");var M1=f(j.name);Y.treeNode=e.mRoutingTree[M1];var N1=i.getParameter("arguments");Y.appStates=N1["?query"]||Object.create(null);Y.keys=[""];for(var O1=Y.treeNode;O1.level>0;O1=e.mRoutingTree[O1.parentRoute]){Y.keys[O1.level]=O1.noKey?"":N1["keys"+O1.level];}}function c1(i,j){var M1={identity:{treeNode:Y.treeNode,keys:Y.keys,appStates:q.extend(Object.create(null),Y.appStates)},mode:1};if(j){M1.identity.appStates[i]=j;}else{delete M1.identity.appStates[i];}a1(M1);}function d1(i){var M1=r.determineNavigationPath(i);var N1={identity:{keys:["",M1.key],appStates:Object.create(null)},mode:1};var O1=a1.bind(null,N1);if(Y.treeNode.level===1){N1.identity.treeNode=Y.treeNode;q.extend(N1.identity.appStates,Y.appStates);return Promise.resolve(O1);}var P1=V(Y.treeNode,2);var Q1=P1.map(function(j){var S1=W(j,Y.keys);var T1=e.oApplicationProxy.getSiblingPromise(S1);return T1.then(function(i){return i;},q.noop);});var R1=Promise.all(Q1);return R1.then(function(S1){var T1=e.mEntityTree[M1.entitySet];for(var j=0;S1[j];j++){T1=P1[j];M1=r.determineNavigationPath(S1[j],T1.navigationProperty);N1.identity.keys.push(M1.key);}N1.identity.treeNode=T1;if(T1===Y.treeNode){q.extend(N1.identity.appStates,Y.appStates);return O1;}var U1=e.oFlexibleColumnLayoutHandler.getAppStatesPromiseForColumnClose(T1,N1.identity.appStates);return U1.then(function(){return O1;});});}function e1(i){L.info("Navigate back");if(s.backTarget&&n(h.getPreviousHash()||"")!==n(s.hash)){e.oBusyHelper.setBusyReason("HashChange",true);}s.LeaveByBack=!s.forwardingInfo;window.history.go(-i);}function f1(j,M1,N1,O1){var P1=e.oAppComponent.getConfig();var Q1=P1&&P1.settings&&P1.settings.objectPageDynamicHeaderTitleWithVM;var R1;var S1=q.sap.getUriParameters();if(S1.mParams["sap-ui-layer"]){var T1=S1.mParams["sap-ui-layer"];for(var i=0;i<T1.length;i++){if(T1[i].toUpperCase()==="VENDOR"){R1=true;break;}}}j=n(j||"");L.info("Navigate to hash: "+j);if(j===s.hash){L.info("Navigation suppressed since hash is the current hash");return;}s.targetHash=j;if(s.backTarget&&n(h.getPreviousHash()||"")===j){e1(1);return;}if(s.oEvent){var U1=s.oEvent.getParameter("config").viewLevel;}if(Q1&&R1){if(!O1){if(!e.oFlexibleColumnLayoutHandler){b.clearVariantParameterInURL();}else{if(U1>=N1){if(N1===1){b.clearVariantParameterInURL();}else if(N1===2){var V1;for(var W1 in e.componentRegistry){if(e.componentRegistry[W1].viewLevel===2){V1=e.componentRegistry[W1];break;}}var X1=V1.oController.byId("template::ObjectPage::ObjectPageVariant");b.clearVariantParameterInURL(X1);}}}}}e.oBusyHelper.setBusyReason("HashChange",true);s.LeaveByReplace=M1;if(M1){p.oHashChanger.replaceHash(j);}else{p.oHashChanger.setHash(j);}}function g1(i,j,M1,N1,O1,P1){var Q1=j.then(function(R1){i=g(i,R1);if(O1){s.backwardingInfo={count:O1.count,index:O1.index,targetHash:n(i)};e1(O1.count);}else{f1(i,N1,M1,P1);}return i;});e.oBusyHelper.setBusy(Q1);return Q1;}function h1(i){var j=p.oHashChanger.getHash()||"";j=j.split("?")[0];var M1=I(i,false);return g1(j,M1,null,false,null,true);}function i1(i,j){var M1,N1,O1,P1,Q1,R1;M1=0;N1=s.iHashChangeCount;O1=null;for(P1=s;P1.oEvent;M1++){Q1=P1.oEvent.getParameter("config");R1=Q1?Q1.viewLevel:-1;if(R1===0||(i&&n(P1.hash).indexOf(j)!==0)){O1={count:M1,index:N1,routeName:Q1?Q1.name:undefined};break;}if(P1.backTarget===0){if(i){O1={count:M1+1,index:N1,routeName:undefined};}break;}N1=P1.backTarget;P1=u[N1];}return O1;}function j1(i,j,M1){if(M1===0){return i1();}var N1=u[s.backTarget];return N1&&N1.hash&&n(N1.hash.split("?")[0])===n(j)&&{count:1,index:s.backTarget};}function k1(i){if(e.oFlexibleColumnLayoutHandler){e.oFlexibleColumnLayoutHandler.setStoredTargetLayoutToOneColumn();}q1("root","",0,i);}function l1(){var i,j;if(e.oFlexibleColumnLayoutHandler){var M1=s.oEvent;var N1=M1.getParameter("config");var O1=N1.name;var P1=e.mRoutingTree[f(O1)];while(P1.level>1){P1=e.mRoutingTree[f(P1.parentRoute)];}j=r.determinePath(P1,M1);}else{j=s.hash;}j=j.split("?")[0];i=i1(true,j);if(i.routeName==="root"&&e.oFlexibleColumnLayoutHandler){k1(true);}else{e1(i.count);}}function m1(i){var j=e.mEntityTree[i.entitySet].sRouteName;var M1=e.mRouteToTemplateComponentPromise[j];return[M1];}function n1(j,M1){var N1=s.componentsDisplayed;var O1=function(Q1){var R1=e.componentRegistry[Q1.getId()];(R1.methods.presetDisplayMode||q.noop)(M1,N1[R1.route]===1);};for(var i=0;i<j.length;i++){var P1=j[i];P1.then(O1);}}function o1(i){var j=i&&e.mEntityTree[i.entitySet];var M1=j?j.level:1;return M1;}function p1(j,M1){var N1=e.oApplicationProxy.getHierarchySectionsFromCurrentHash();var O1=j;for(var i=M1-2;i>=0;i--){O1=N1[i]+"/"+O1;}return"/"+O1;}function q1(i,j,M1,N1,O1){var P1={};var Q1=e.oFlexibleColumnLayoutHandler&&e.oFlexibleColumnLayoutHandler.getFCLAppStatesPromise(i,P1);var R1=F(i,P1,j);var S1=(Q1?Promise.all([Q1,R1]):R1).then(A.bind(null,P1));var T1=j1(N1,j,M1);var U1=g1(j,S1,M1,N1,T1,O1);e.oBusyHelper.setBusy(U1);return U1;}function r1(i,j,M1,N1){var O1=p1(i,j);q1(M1,O1,j,N1);}function s1(j,M1,N1,O1,P1,Q1){var R1;var S1,T1,U1;var V1=[];if(typeof j==="string"){R1=j;var W1=n(R1);if(W1==="/"){S1=0;}else{U1=W1.split("/");S1=U1.length-1;}switch(S1){case 0:T1="root";break;case 1:T1=U1[1].split("(")[0];break;default:T1="";var X1="";for(var i=0;i<S1;i++){var Y1=U1[i+1];var Z1=Y1.indexOf("(");if(Z1>0){Y1=Y1.substring(0,Z1);}T1=T1+X1+Y1;X1="/";}T1=T1.replace("---","/");}}else{var $1=r.determineNavigationPath(j,M1);S1=o1($1);R1=$1.path;V1=m1($1);T1=e.mEntityTree[$1.entitySet].sRouteName;}if(M1){R1=p1(R1,S1);}n1(V1,O1||0);if(P1){R1=k(R1,P1);f1(R1,N1,S1,Q1);return Promise.resolve(R1);}else{return q1(T1,R1,S1,N1,Q1);}}function t1(i,j,M1,N1,O1){return s1(i,j,M1,N1,undefined,O1);}function u1(i,j){s.componentsDisplayed[i]=j;var M1=e.mRoutingTree[i];var N1=M1.componentId;if(N1){var O1=e.componentRegistry[N1];var P1=O1.utils.getTemplatePrivateModel();P1.setProperty("/generic/isActive",j===1);}}function v1(i){var j,M1,N1,O1,P1,Q1=null,R1,S1;if(i){j=i.entitySet;M1=i.text;Q1=i.icon;S1=i.description;}if(j){R1=e.oAppComponent.getModel().getMetaModel();if(R1){N1=R1.getODataEntitySet(j);O1=R1.getODataEntityType(N1.entityType);P1=O1["com.sap.vocabularies.UI.v1.HeaderInfo"];}if(P1&&P1.TypeImageUrl&&P1.TypeImageUrl.String){Q1=P1.TypeImageUrl.String;}}e.oShellServicePromise.then(function(V1){if(V1.setBackNavigation){V1.setBackNavigation(undefined);}});e.oTemplatePrivateGlobalModel.setProperty("/generic/messagePage",{text:M1,icon:Q1,description:S1});if(e.oFlexibleColumnLayoutHandler){e.oFlexibleColumnLayoutHandler.displayMessagePage(i,s.componentsDisplayed);}else{var T1=p.oRouter.getTargets();T1.display("messagePage");for(var U1 in s.componentsDisplayed){u1(U1,5);}}R(i);}function w1(){if(!q.isEmptyObject(M)){var j=null;for(var i=0;!j;i++){j=M[i];}M={};v1(j);}}function x1(i){if(p.oTemplateContract.oFlexibleColumnLayoutHandler){i.viewLevel=i.viewLevel||0;M[i.viewLevel]=i;var j=Promise.all([v,p.oTemplateContract.oPagesDataLoadedObserver.getProcessFinished(true)]);j.then(w1);j.then(e.oBusyHelper.setBusyReason.bind(null,"HashChange",false));return;}v1(i);e.oBusyHelper.setBusyReason("HashChange",false);}function y1(){var i=[];for(var j in e.componentRegistry){var M1=e.componentRegistry[j];if(s.componentsDisplayed[M1.route]===1){i.push(j);}}return i;}function z1(){var i=[];for(var j in e.componentRegistry){i.push(j);}return i;}function A1(i){return Y.keys.slice(0,i+1);}function B1(j){var M1="";var N1=s.hash;var O1=N1.split("/");var P1="";for(var i=0;i<=j;i++){M1=M1+P1+O1[i];P1="/";}return M1;}function C1(){return s;}function D1(i,M1){if(M1===0){return{name:"root",pattern:""};}var N1=i.getParameter("config");var O1=N1.viewLevel;if(O1<M1){return null;}var P1=e.mEntityTree;var Q1=N1.entitySet;var R1;for(var j=O1;j>=M1;j--){R1=P1[Q1];Q1=R1.parent;}return{name:R1.sRouteName,pattern:R1.pattern};}function E1(i,j,M1){var N1=M1.getId();var O1=e.componentRegistry[N1];var P1=O1.route;var Q1=j.componentsDisplayed[P1];var R1=Q1===1;s.componentsDisplayed[P1]=1;var S1=M1.onActivate(i,R1)||Promise.resolve();return Promise.all([S1,O1.viewRegistered]).then(function(){O1.aKeys=A1(O1.viewLevel);});}function F1(i,j,M1){return E1(i,j,M1).then(U);}function G1(i,j,M1){var N1={};if(j||M1){var O1=i.getParameter("config").viewLevel;for(var P1=0;P1<O1;P1++){N1[P1]=e.oPaginatorInfo[P1];}}e.oPaginatorInfo=N1;}function H1(i){return e.oApplicationProxy.getAlternativeContextPromise(i);}function I1(i){b1(i);Y.preset=true;if(e.oFlexibleColumnLayoutHandler){e.oFlexibleColumnLayoutHandler.handleBeforeRouteMatched(i);}}function J1(j){if(Y&&Y.preset){Y.preset=false;}else{b1(j);}if(X&&X.followUpNeeded&&X.identity&&!$(X.identity)){a1();return;}e.oBusyHelper.setBusyReason("HashChange",false);var M1=j.getParameter("config").viewLevel;var N1=n(p.oHashChanger.getHash()||"");L.info("Route matched with hash "+N1);var O1;if(s.backwardingInfo){O1=s;u.push(O1);var P1=O1.iHashChangeCount+1;s={iHashChangeCount:P1,forwardingInfo:{bIsProgrammatic:true,bIsBack:true,iHashChangeCount:P1,targetHash:O1.backwardingInfo.targetHash,componentsDisplayed:O1.componentsDisplayed},backTarget:u[O1.backwardingInfo.index].backTarget,componentsDisplayed:Object.create(null)};}if(s.forwardingInfo&&s.forwardingInfo.targetHash&&s.forwardingInfo.targetHash!==N1){s.hash=N1;var Q1=s.forwardingInfo.targetHash;delete s.forwardingInfo.targetHash;f1(Q1,true);return;}var R1=j.getParameter("config");var S1=r.determinePath(Y.treeNode,j);var T1=false;for(var i=0;i<e.aStateChangers.length;i++){var U1=e.aStateChangers[i];if(U1.isStateChange(j)){T1=true;}}if(T1){X=null;s.hash=N1;O();if(e.oFlexibleColumnLayoutHandler){e.oFlexibleColumnLayoutHandler.handleRouteMatched(j,R1,S1);}return;}e.oTemplatePrivateGlobalModel.setProperty("/generic/routeLevel",M1);var V1=s.forwardingInfo;delete s.forwardingInfo;if(!V1){V1={componentsDisplayed:s.componentsDisplayed};var W1=s.iHashChangeCount;V1.iHashChangeCount=W1+1;var X1=h.getDirection();if(X){V1.bIsProgrammatic=!!X.identity;V1.bIsBack=X.mode<0;if(V1.bIsBack){s.backSteps=0-X.mode;}V1.bIsForward=!V1.bIsBack&&(X1===d.Forwards);s.LeaveByReplace=X.mode===1;}else{V1.bIsProgrammatic=(N1===s.targetHash);V1.bIsBack=!!(s.LeaveByBack||(!V1.bIsProgrammatic&&(X1===d.Backwards)));V1.bIsForward=!V1.bIsBack&&(X1===d.Forwards);s.LeaveByReplace=V1.bIsProgrammatic&&s.LeaveByReplace;}s.LeaveByBack=V1.bIsBack;O1=s;u.push(O1);s={iHashChangeCount:V1.iHashChangeCount,componentsDisplayed:Object.create(null)};if(O1.LeaveByReplace){s.backTarget=O1.backTarget;}else if(V1.bIsBack){var Y1=O1.backTarget;for(var Z1=s.backSteps||1;Z1>0;Z1--){Y1=u[Y1].backTarget;}s.backTarget=Y1;}else{s.backTarget=W1;}}X=null;s.oEvent=j;s.hash=N1;var $1=function(a2){var b2=j.getParameter("arguments");if(a2){var c2=b2["?query"];s.forwardingInfo=V1;s1(a2.context,null,true,a2.iDisplayMode,c2||{});return;}J([]);G1(j,V1.bIsProgrammatic,V1.bIsBack);if(e.oFlexibleColumnLayoutHandler){v=e.oFlexibleColumnLayoutHandler.handleRouteMatched(j,R1,S1,V1);}else{if(R1.viewLevel===0||!(V1.bIsProgrammatic||V1.bIsBack)){e.oApplicationProxy.setEditableNDC(false);}var d2=R1.target;var e2=e.mRouteToTemplateComponentPromise[d2];v=new Promise(function(f2,g2){e2.then(function(h2){F1(S1,V1,h2).then(f2,g2);});});}e.oBusyHelper.setBusy(v);};if(V1.bIsBack){var _1=M1<2?S1:r.determinePath(e.mRoutingTree[D1(j,1).name],j);e.oBusyHelper.setBusy(H1(_1).then($1));}else{$1();}}function K1(i){i=q.extend({},i);e.oStatePreserversAvailablePromise.then(J1.bind(null,i),e.oBusyHelper.setBusyReason.bind(null,"HashChange",false));}function L1(){x1({title:e.getText("ST_ERROR"),text:e.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),description:""});}if(e.sRoutingType==="f"){p.oRouter.attachBeforeRouteMatched(I1);}p.oRouter.attachRouteMatched(K1);p.oRouter.attachBypassed(L1);p.removeQueryInRouteName=f;p.concatPathAndAppStates=k;p.navigate=f1;p.getAncestralRoute=D1;p.activateOneComponent=E1;p.afterActivation=U;p.addUrlParameterInfoForRoute=F;p.navigateByReplacingAppState=h1;p.getApplicableStateForComponentAddedPromise=E;p.setVisibilityOfRoute=u1;p.getActiveComponents=y1;p.getAllComponents=z1;p.getRootComponentPromise=z;p.getActivationInfo=C1;p.getCurrentKeys=A1;p.getCurrentHash=B1;p.getAppTitle=D;p.subTitleForViewLevelChanged=S;p.navigateToSuffix=r1;p.navigateByExchangingQueryParam=c1;p.navigateBackToAncestorComponent=l1;p.getSwitchToSiblingPromise=d1;p.getCurrentIdentity=Z;p.createComponentInstance=l;return{navigateToRoot:k1,navigateToContext:t1,navigateToMessagePage:x1,navigateBack:e1.bind(null,1)};}function o(e,i){var j={oAppComponent:i.oAppComponent,oRouter:i.oAppComponent.getRouter(),oTemplateContract:i,oHashChanger:H.getInstance(),mRouteToComponentResolve:{}};i.oNavigationControllerProxy=j;var F=new Promise(function(R){j.fnInitializationResolve=R;});i.oBusyHelper.setBusy(F);q.extend(e,m(i,j));q.extend(j,e);j.oRouter._oViews._getViewWithGlobalId=function(v){v.viewName=v.name||v.viewName;for(var p in i.componentRegistry){if(i.componentRegistry[p].route===v.viewName){return i.componentRegistry[p].oComponent.getComponentContainer();}}var R=j.oRouter.getRoute(v.viewName);var s;if(R&&R._oConfig){s=l(i,R._oConfig,j.mRouteToComponentResolve[v.viewName]);}else{s=sap.ui.view({viewName:v.viewName,type:v.type,height:"100%"});}if(v.viewName==="root"){i.rootContainer=s;}return s.loaded();};r.startupRouter(j);}var N=B.extend("sap.suite.ui.generic.template.lib.NavigationController",{metadata:{library:"sap.suite.ui.generic.template"},constructor:function(e){B.apply(this,arguments);t.testableStatic(o,"NavigationController")(this,e);}});N._sChanges="Changes";return N;});
