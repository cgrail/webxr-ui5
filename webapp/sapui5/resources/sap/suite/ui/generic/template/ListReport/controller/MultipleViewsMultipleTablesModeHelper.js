sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device"],function(q,B,D){"use strict";var P="/listReport/multipleViews";var a=P+"/selectedKey";var b=P+"/msgVisibility";var c=P+"/finalMessage";function g(Q,s,C,t,S,I,d){var e;var f,u=[];var T=t.oComponentUtils.getTemplatePrivateModel();function o(i){var j=i.getParameter("itemContexts")&&i.getParameter("itemContexts")[0];t.oCommonEventHandlers.onListNavigate(i,s,undefined,j);}function h(i){var j,O;j=i.getSource();O=j.getParent();s.updateControlOnSelectionChange(O);}function r(i){var j,O;O=i.getSource();j=O.getChart();j.attachSelectData(h);j.attachDeselectData(h);}function k(i){var j,O,V={};for(j in I){O=I[j].implementingControl;V[O.getId()]=O.getCurrentVariantId()||"";}return{selectedTab:i,tableVariantIds:V};}function l(i){var j,O,V;if(i){if(i.tableVariantIds){for(j in I){O=I[j].implementingControl;V=i.tableVariantIds[O.getId()];if(V){O.setCurrentVariantId(V);}}}return i.selectedTab;}}function m(){return e;}function n(i){var j=t.oCommonUtils.getMetaModelEntityType(i);return j.property;}function p(i){s.oSmartTable=I[i].implementingControl;}function v(){var i=s.oSmartTable;var T=t.oComponentUtils.getTemplatePrivateModel();var j=G();var O=JSON.parse(j.getValue());if(j){i.removeCustomData(j);}i.addCustomData(new sap.ui.core.CustomData({"key":"activeButtonTableState","value":!O}));T.setProperty("/listReport/activeObjectEnabled",!O);}function G(){var i=s.oSmartTable;var j;var O=i.getCustomData();for(var V=0;V<O.length;V++){if(O[V].getKey()&&O[V].getKey()==="activeButtonTableState"){j=O[V];break;}}return j;}function R(){var i=s.oSmartTable;var T=t.oComponentUtils.getTemplatePrivateModel();var j=T.getProperty("/listReport/activeObjectEnabled");var O=G();if(O){i.removeCustomData(O);}i.addCustomData(new sap.ui.core.CustomData({"key":"activeButtonTableState","value":j}));}function F(i,j){var O,V,W=[];var X=I[T.getProperty(a)];if(X&&X.entitySet===j.getEntitySet()&&(X.implementingControl.getMetadata().getElementName()===j.getMetadata().getElementName())){for(var Y in i){O=H(i[Y],j);V=O["sap:label"]?O["sap:label"]:O.name;if(!W.includes(V)){W.push(V);}}f=y(j);K(W,f);}M(W);}function w(i,j){var O;O=L(i);if(O){i.removeCustomData(O);}i.addCustomData(new sap.ui.core.CustomData({"key":"multiTabMessageInfo","value":j}));}function x(i){var j,O=[];for(j in I){if(I[j].implementingControl!==i){O.push(I[j].properties);}}return O;}function y(i){var j;var O=T.getProperty(a);var V=C.getOwnerComponent().getAppComponent().getConfig();var W=V&&V.pages[0]&&V.pages[0].component&&V.pages[0].component.settings;for(var X in W.quickVariantSelectionX.variants){if(W.quickVariantSelectionX.variants[X].key===O){j=W.quickVariantSelectionX.variants[X];break;}}var Y=t.oCommonUtils.getMetaModelEntityType(i);var Z=j?Y[j.annotationPath]:null;if(Z&&Z.Text){if(Z.Text.String.indexOf("i18n")!==-1){var $=Z.Text.String;$=$.substring(1,$.length-1).split(">").pop();return t.oCommonUtils.getText($);}else{return(Z.Text.String);}}}function z(i){if(i&&i.length>0){T.setProperty(b,true);}else{T.setProperty(b,false);}}function A(){var i=s.oSmartTable;var j=L(i);if(j){var O={"filters":j.getValue().filters,"selectedKey":j.getValue().selectedKey,"isClosed":true};w(i,O);z();}}function E(u){var i=false;var j=s.oSmartTable;var O=L(j);if(O&&O.getValue().isClosed){if(O.getValue().filters.length===u.length){if(JSON.stringify(O.getValue().filters)===JSON.stringify(u)){i=true;}}}O={"filters":u,"selectedKey":f};if(i){z();O.isClosed=true;}else{z(u);O.isClosed=false;}w(j,O);}function H(i,j){var O;var V=x(j);for(var W in V){var O=J(V[W],i);if(O){break;}}return O;}function J(i,j){return i.filter(function(O){return O.name===j;})[0];}function K(i,f){var j="";if(i&&i.length>0){if((D.system.tablet||D.system.phone)&&!D.system.desktop){if(i.length>1){j=t.oCommonUtils.getText("MESSAGE_MULTIPLE_VALUES_S_FORM",[i.join(", "),f]);}else{j=t.oCommonUtils.getText("MESSAGE_SINGLE_VALUE_S_FORM",[i[0],f]);}}else{if(i.length>1){j=t.oCommonUtils.getText("MESSAGE_MULTIPLE_VALUES_L_FORM",[i.join(", "),f]);}else{j=t.oCommonUtils.getText("MESSAGE_SINGLE_VALUE_L_FORM",[i[0],f]);}}}T.setProperty(c,j);}function U(i){var j;j=L(i);if(j){var O=j.getValue();K(O.filters,O.selectedKey);z(O.filters);}else{z(u);}}function L(i){var j;var O=I[T.getProperty(a)];if(O.entitySet===i.getEntitySet()&&(O.implementingControl.getMetadata().getElementName()===i.getMetadata().getElementName())){var V=i.getCustomData();for(var W=0;W<V.length;W++){if(V[W].getKey()&&V[W].getKey()==="multiTabMessageInfo"){j=V[W];break;}}}return j;}function M(i){u=i;}function N(){return u;}(function(){var j=C.byId("template::IconTabBar");if(!j){return;}var O=C.getOwnerComponent().getEntitySet();var V=j.getItems();e=false;for(var i=0;i<V.length;i++){var W=V[i].getKey();if(i===0){S(W);}var X=C.byId("listReport-"+W);if(!s.oSmartTable){s.oSmartTable=X;}I[W]={id:X.getId(),entitySet:X.getEntitySet(),properties:n(X)};e=e||I[W].entitySet!==O;d(W,X,X.getEntitySet());}s.oSmartFilterbar.attachSearch(function(Y){s.oMultipleViewsHandler.refreshOperation(3);});})();return{fnRegisterToChartEvents:r,onDetailsActionPress:o,getContentForIappState:k,getSelectedKeyAndRestoreFromIappState:l,onSelectedKeyChanged:p,getIsDifferentEntitySets:m,setActiveButtonState:v,restoreActiveButtonState:R,getActiveButtonStateCustomData:G,formatNotAppliedFilters:F,onMessageCloseActionPress:A,fnCheckForMessageDisplay:E,fnSetMessageVisibility:z,fnSetNotAppliedFilter:M,fnGetNotAppliedFilter:N,fnUpdateMessageForFilter:U};}return B.extend("sap.suite.ui.generic.template.ListReport.controller.MultipleViewsMultipleTablesModeHelper",{constructor:function(Q,s,C,t,S,i,d){q.extend(this,g(Q,s,C,t,S,i,d));}});});
