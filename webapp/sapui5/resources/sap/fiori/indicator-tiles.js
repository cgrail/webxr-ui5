//@ui5-bundle sap/fiori/indicator-tiles.js
sap.ui.predefine('sap/ushell/components/tiles/generic',['sap/ui/core/mvc/Controller','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil','sap/ushell/components/tiles/sbtilecontent'],function(C,o,s,a){"use strict";var g=C.extend("sap.ushell.components.tiles.generic",{getTile:function(){return this.oKpiTileView.oGenericTile;},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},logError:function(e){this._updateTileModel({value:"",scale:"",unit:""});jQuery.sap.log.error(e);if(this.getView().getViewData().deferredObj){this.getView().getViewData().deferredObj.reject();}else{this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Failed);}},getKeyForCallCheck:function(){if(this.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){return this.oConfig.TILE_PROPERTIES.id+"left";}else{return this.oConfig.TILE_PROPERTIES.id+"right";}},getRelativeTime:function(){var c=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();if(jQuery.type(this.cacheTime)=="date"){var t=this.cacheTime;}else{var t=new Date(parseInt(this.cacheTime.substr(6),10));}var r=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(c-t);var b;switch(r.unit){case"minutes":var d=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"minutes");c=c-d;b=new Date(c);break;case"hours":var d=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"hours");c=c-d;b=new Date(c);break;case"days":var d=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"days");c=c-d;b=new Date(c);break;}return b;},setTimeStamp:function(d){this.updateTimeStampjobScheduled=false;var f=sap.ui.core.format.DateFormat.getDateTimeInstance({relative:true,relativeSource:"auto",style:"short"});var t=f.format(this.getRelativeTime());this.oKpiTileView.oNVConfS.setRefreshOption(true);this.oKpiTileView.oNVConfS.setTimestamp(t);this.updateTimeStampjobScheduled=false;var k=this.oConfig.TILE_PROPERTIES.id+"time";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}sap.ushell.components.tiles.indicatorTileUtils.util.scheduleTimeStampJob.call(this,this.oTileApi.visible.isVisible());},isACurrencyMeasure:function(m){var e=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;return sap.ushell.components.tiles.indicatorTileUtils.util.getFormattingMetadata(this.oRunTimeODataModel,e,m)._hasCurrency;},isCurrencyMeasure:function(m){var t=this;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(c&&c.Data){var k=c.Data&&JSON.parse(c.Data);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){k=k.leftData;}else{k=k.rightData;}}if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatorcomparison.ComparisonTile"||t.oConfig.TILE_PROPERTIES.tileType==="CM"){if(k&&k.data&&k.data.length){for(var i=0;i<k.data.length;i++){if(k.data[i]&&k.data[i].measure==m){if(jQuery.type(k.data[i].isCurM)=="boolean"){return k.data[i].isCurM;}else{return t.isACurrencyMeasure(m);}break;}else{return t.isACurrencyMeasure(m);}}}else{return t.isACurrencyMeasure(m);}}if(k&&jQuery.type(k.isCurM)=="boolean"){return k.isCurM;}else{return t.isACurrencyMeasure(m);}}else{return t.isACurrencyMeasure(m);}},formSelectStatement:function(b){var t=Object.keys(b);var f="";for(var i=0;i<t.length;i++){if((b[t[i]]!==undefined)&&(b.fullyFormedMeasure)){f=f+","+b[t[i]];}}return f;},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(c&&c.Data&&c.Data.length){c.Data=JSON.parse(c.Data);T.trendValue=Number(c.Data.trend);T.targetValue=Number(c.Data.target);T.criticalHighValue=Number(c.Data.ch);T.warningHighValue=Number(c.Data.wh);c.Data=JSON.stringify(c.Data);}break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(c&&c.Data&&c.Data.length){c.Data=JSON.parse(c.Data);T.criticalLowValue=Number(c.Data.cl);T.warningLowValue=Number(c.Data.wl);T.trendValue=Number(c.Data.trend);T.targetValue=Number(c.Data.target);c.Data=JSON.stringify(c.Data);}break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);if(c&&c.Data&&c.Data.length){c.Data=JSON.parse(c.Data);T.criticalLowValue=Number(c.Data.cl);T.warningLowValue=Number(c.Data.wl);T.trendValue=Number(c.Data.trend);T.targetValue=Number(c.Data.target);T.criticalHighValue=Number(c.Data.ch);T.warningHighValue=Number(c.Data.wh);c.Data=JSON.stringify(c.Data);}break;}}else if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},setNoData:function(){var v=this.getView().getViewData();if(v.parentController){v.parentController.setNoData();if(v.deferredObj){v.deferredObj.resolve();}}else{try{this._updateTileModel({value:"",scale:"",unit:"",footerNum:this.oResourceBundle.getText("sb.noDataAvailable"),footerComp:this.oResourceBundle.getText("sb.noDataAvailable")});this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}catch(e){}}},getLocalCache:function(c){var l={};l.ChipId=c.ChipId;l.Data=c.Data;l.CacheMaxAge=c.CacheMaxAgeUnit;l.CacheMaxAgeUnit=c.CacheMaxAgeUnit;l.CacheType=c.CacheType;l.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();return l;},fetchKpiValue:function(c,E,r,A){var t=this;var k=0;try{var b=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var T=this.setThresholdValues();var m=T.fullyFormedMeasure;var d=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);var f=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var i=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,f,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);var h=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var j=this.getKeyForCallCheck();var l=true;if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){var l=sap.ushell.components.tiles.indicatorTileUtils.util.isCallInProgress(j);if(l==undefined){l=true;}}if(l){if((!d||(!i&&t.oTileApi.visible.isVisible())||h||(A&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh)){sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(j,false);if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,b,m,null,v);if(q){this.QUERY_SERVICE_MODEL=q.model;this.queryUriForKpiValue=q.uri;this.queryServiceUriODataReadRef=this.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(p){t.backEndCallMade=true;t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(j,true);if(p&&p.results&&p.results.length&&p.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]!=null){k=p.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var w={};if(q.unit[0]){t._updateTileModel({unit:p.results[0][q.unit[0].name]});w.uom=p.results[0][q.unit[0].name];}if(t.oConfig.TILE_PROPERTIES.frameType=="TwoByOne"){w.numericValue=k;}else{w.value=k;}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=p.results[0][T.sCriticalHigh];T.criticalLowValue=p.results[0][T.sCriticalLow];T.warningHighValue=p.results[0][T.sWarningHigh];T.warningLowValue=p.results[0][T.sWarningLow];T.targetValue=p.results[0][T.sTarget];T.trendValue=p.results[0][T.sTrend];}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(p.results[0][T.sTarget]);T.criticalHighValue=T.targetValue*T.criticalHighValue/100;T.criticalLowValue=T.targetValue*T.criticalLowValue/100;T.warningHighValue=T.targetValue*T.warningHighValue/100;T.warningLowValue=T.targetValue*T.warningLowValue/100;T.trendValue=Number(p.results[0][T.sTrend]);}w.cl=T.criticalLowValue;w.ch=T.criticalHighValue;w.wl=T.warningLowValue;w.wh=T.warningHighValue;w.trend=T.trendValue;w.target=T.targetValue;w.isCurM=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var u={};u.ChipId=t.oConfig.TILE_PROPERTIES.id;u.Data=JSON.stringify(w);u.CacheMaxAge=Number(t.chipCacheTime);u.CacheMaxAgeUnit=t.chipCacheTimeUnit;u.CacheType=1;var x=t.getLocalCache(u);if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);var U=false;if(d){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,u,U,function(p){if(p){t.cacheTime=p&&p.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,p);t.setTimeStamp(t.cacheTime);}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var y=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(y){if(!y.CachedTime){y.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}var z=y.Data;if(z){z=JSON.parse(z);if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){z.leftData=w;}else{z.rightData=w;}}y.Data=JSON.stringify(z);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,y);}else{var z={};if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){z.leftData=w;}else{z.rightData=w;}x.Data=JSON.stringify(z);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);}t.cacheWriteData=w;}t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();t.updateDatajobScheduled=false;var B=t.oConfig.TILE_PROPERTIES.id+"data";var D=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(B);if(D){clearTimeout(D);D=undefined;}c.call(t,k,T);}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(p){t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(j,true);if(p&&p.response){jQuery.sap.log.error(p.message+" : "+p.request.requestUri);E.call(t,p);}});}else{t.kpiValueFetchDeferred=true;sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(j,true);t.logError("Error Preparing Query Service URI");}}}else{if(t.DEFINITION_DATA.TILE_PROPERTIES.frameType==sap.m.FrameType.OneByOne){if(d&&d.Data){var n=d.Data&&JSON.parse(d.Data);k=n.value;if(n.uom){t._updateTileModel({unit:n.uom});}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=n.ch;T.criticalLowValue=n.cl;T.warningHighValue=n.wh;T.warningLowValue=n.wl;T.targetValue=n.target;T.trendValue=n.trend;}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(n.target);T.criticalHighValue=T.targetValue*T.ch/100;T.criticalLowValue=T.targetValue*T.cl/100;T.warningHighValue=T.targetValue*T.wh/100;T.warningLowValue=T.targetValue*T.wl/100;T.trendValue=Number(n.trend);}t.cacheTime=d.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(d.CachedTime),t);}c.call(t,k,T);}else{t.setNoData();}}else{if(d&&d.Data){var n=d.Data&&JSON.parse(d.Data);if(t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"){n=n.leftData;}else{n=n.rightData;}k=n.numericValue;if(n.unit){t._updateTileModel({unit:n.unit});}if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=n.ch;T.criticalLowValue=n.cl;T.warningHighValue=n.wh;T.warningLowValue=n.wl;T.targetValue=n.target;T.trendValue=n.trend;}else if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="RELATIVE"){T.targetValue=Number(n.target);T.criticalHighValue=T.targetValue*T.criticalHighValue/100;T.criticalLowValue=T.targetValue*T.criticalLowValue/100;T.warningHighValue=T.targetValue*T.warningHighValue/100;T.warningLowValue=T.targetValue*T.warningLowValue/100;T.trendValue=Number(n.trend);}t.cacheTime=d.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(d.CachedTime),t);}c.call(t,k,T);}else{t.setNoData();}}}}}catch(e){t.logError(e);}},getRunTimeODataModel:function(u,S){if(window["sap-ushell-config"].cacheBusting){u=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(u);}if(!this.oRunTimeODataModel){this.oRunTimeODataModel=sap.ushell.components.tiles.indicatorTileUtils.util.getODataModelByServiceUri(u);}if(this.oRunTimeODataModel.getServiceMetadata()){S();}else{this.oRunTimeODataModel.attachMetadataLoaded(S);}},parse_sapclient:function(){var i,S,r,f,b;S="P_SAPClient";r="$$$";f=this.oConfig.EVALUATION_FILTERS;if(f.constructor!==Array){return;}if(f.length<1){return;}for(i in f){b=f[i];if(b["NAME"]===S&&b["VALUE_1"]===r){break;}b=null;}if(b){jQuery.when(sap.ushell.components.tiles.indicatorTileUtils.util.getHanaClient()).done(function(c){b["VALUE_1"]=c;});}},fetchEvaluation:function(c,b,r,i){var t=this;var p=this.oConfig.TILE_PROPERTIES.sb_metadata||"HANA";t.DEFINITION_DATA=c;t._updateTileModel(this.DEFINITION_DATA);var d=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);if((t.oTileApi.visible.isVisible()&&!t.firstTimeVisible)||d||i){jQuery.when(sap.ushell.components.tiles.indicatorTileUtils.util.getFrontendCache(c,t.oTileApi)).done(function(f){t.firstTimeVisible=true;f=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(f||Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){b.call();}else{try{if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)||!t.dataCallInProgress){t.dataCallInProgress=true;var h=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(t.oConfig.TILE_PROPERTIES.id);if(h){t.oConfig.EVALUATION_FILTERS=h.EVALUATION_FILTERS;b.call();}else if(t.evaluationFetchDeferred){t.evaluationFetchDeferred=false;sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(t.oConfig,t.oTileApi,function(j){t.evaluationFetchDeferred=true;t.oConfig.EVALUATION_FILTERS=j;if(p.toUpperCase()==="HANA"){t.parse_sapclient();}sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);b.call();});}}}catch(e){t.evaluationFetchDeferred=true;t.logError("no evaluation data");}}}).fail(function(){t.firstTimeVisible=true;if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){b.call();}else{try{var f=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(t.oConfig.TILE_PROPERTIES.id);if(f){t.oConfig.EVALUATION_FILTERS=f.EVALUATION_FILTERS;b.call();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(t.oConfig,t.oTileApi,function(h){t.oConfig.EVALUATION_FILTERS=h;if(p.toUpperCase()==="HANA"){t.parse_sapclient();}sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);b.call();});}}catch(e){t.logError("no evaluation data");}}});}},refreshHandler:function(r,A){var t=this;var i=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var b=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(A);if(!t.firstTimeVisible||i||b){t.fetchEvaluation(t.oConfig,function(){if(t.oConfig.TILE_PROPERTIES.tileType=="NT"||t.oConfig.TILE_PROPERTIES.tileType=="AT"||t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatornumeric.NumericTile"||t.oKpiTileView.getViewName()=="sap.ushell.components.tiles.indicatordeviation.DeviationTile"){var u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.fetchKpiValue(function(k,T){this.KPIVALUE=k;t.doProcess(k,T);},t.logError,r,b);}else{t.doProcess();}});}else{var u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.doProcess(t.KPIVALUE,t.setThresholdValues());}else{t.doProcess(i,b);}});}},r,b);}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},getChipConfiguration:function(c){var t=this;try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),t.oTileApi.preview.isEnabled(),function(b){t.oConfig=b;var d=sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig);var f=sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig);if(t.oTileApi.search){t.oTileApi.search.setKeywords([d,f]);}if(t.oTileApi.preview){t.oTileApi.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}c.call();});}catch(e){t.logError(e.message);}},onAfterTileRendering:function(){var t=this;this.firstTimeVisible=false;this.oKpiTileView=this.getView();this.updateDatajobScheduled=false;this.updateTimeStampjobScheduled=false;this.oViewData=this.oKpiTileView.getViewData();this.tilePressed=false;this.kpiValueFetchDeferred=true;this.evaluationFetchDeferred=true;this.backEndCallMade=false;if(!sap.ushell.components.tiles.utils){jQuery.sap.require("sap.ushell.components.tiles.utils");}this.oResourceBundle=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();this.oTileApi=this.oViewData.chip;this.system=this.oTileApi.url.getApplicationSystem();this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loading);this.getChipConfiguration(function(){t.chipCacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(t.oConfig);t.chipCacheTimeUnit=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(t.oConfig);if(t.oTileApi.preview.isEnabled()){t.doDummyProcess();t.oKpiTileView.oGenericTile.attachPress(function(){sap.m.MessageToast.show(t.oResourceBundle.getText("sb.NavigationHelp"));});}else if(t.oConfig.BLANKTILE||t.oConfig.TILE_PROPERTIES.blankTile){t.doDummyProcess();var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'/>");t.oKpiTileView.oGenericTile.attachPress(function(){t.tilePressed=true;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=n;});}else{if(t.oTileApi.visible&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){t.oTileApi.visible.attachVisible(t.visibleHandler.bind(t));}var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"' style='display: block;'/>");t.oKpiTileView.oGenericTile.attachPress(function(){t.tilePressed=true;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=n;});if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){t.oKpiTileView.oNVConfS.attachRefresh(function(){t.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loading);jQuery.proxy(t.refreshHandler(true),t);});}t.fetchEvaluation(t.oConfig,function(){t.DEFINITION_DATA=t.oConfig;var u=t.oTileApi.url.addSystemToServiceUrl(t.oConfig.EVALUATION.ODATA_URL);var c=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var i=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,c,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);if(!i||t.getView().getViewData().refresh){t.getRunTimeODataModel(u,function(){if(t.KPI_VALUE_REQUIRED){t.fetchKpiValue(function(k,T){this.KPIVALUE=k;t.doProcess(k,T);},t.logError);}else{t.doProcess();}});}else{if(t.KPI_VALUE_REQUIRED){t.fetchKpiValue(function(k,T){this.KPIVALUE=k;t.doProcess(k,T);},t.logError);}else{t.doProcess();}}});}});},onAfterRendering:function(){this.onAfterTileRendering();},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new sap.ui.model.json.JSONModel({}));}},autoFormatter:function(n,i){i=i||false;if(!n){return"";}return sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(n),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,i);},setToolTip:function(b,c,t){var d=this;var e;var T=this.setThresholdValues();var m=this.oConfig.EVALUATION.COLUMN_NAME;var i=this.isCurrencyMeasure(m);if(t=="CONT"||t=="COMP"){if(this.oKpiTileView.getContent()[0].getTileContent().length){e=d.oKpiTileView.getContent()[0].getTileContent()[0].getContent();var f,h,j,v,k,l,n,p,q;if(c&&c[0]){f=c[0].title;v=this.autoFormatter(c[0].value,i);n=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(c[0].color);}if(c&&c[1]){h=c[1].title;k=this.autoFormatter(c[1].value,i);p=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(c[1].color);}if(c&&c[2]){j=c[2].title;l=this.autoFormatter(c[2].value,i);q=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(c[2].color);}var r={};r["0"]=this.oConfig.EVALUATION.COLUMN_NAME+",asc";r["1"]=this.oConfig.EVALUATION.COLUMN_NAME+",desc";r["2"]=this.oConfig.TILE_PROPERTIES.dimension+",asc";r["3"]=this.oConfig.TILE_PROPERTIES.dimension+",desc";var u=r[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var w={measure:this.oConfig.EVALUATION.COLUMN_NAME,contributionTile:u,m1:f,v1:v,c1:n,m2:h,v2:k,c2:p,m3:j,v3:l,c3:q};sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(e,t,w);}}else{var x="";if(b=="Error"){x="sb.error";}if(b=="Neutral"){x="sb.neutral";}if(b=="Critical"){x="sb.critical";}if(b=="Good"){x="sb.good";}var w={status:x,actual:this.autoFormatter(c,i),target:this.autoFormatter(T.targetValue,i),cH:this.autoFormatter(T.criticalHighValue,i),wH:this.autoFormatter(T.warningHighValue,i),wL:this.autoFormatter(T.warningLowValue,i),cL:this.autoFormatter(T.criticalLowValue,i)};var e=d.oKpiTileView.getContent()[0].getTileContent()[0]&&d.oKpiTileView.getContent()[0].getTileContent()[0].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(e,t,w);}},getTrendColor:function(t){var b=this,w,c,d,f;try{var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;this.DEFINITION_DATA.EVALUATION_VALUES;var r=sap.m.ValueColor.Neutral;if(i==="MI"){if(t.criticalHighValue&&t.warningHighValue){f=Number(t.criticalHighValue);d=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<d){r=sap.m.ValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=f){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Error;}}}else if(i==="MA"){if(t.criticalLowValue&&t.warningLowValue){c=Number(t.criticalLowValue);w=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<c){r=sap.m.ValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=w){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Good;}}}else{if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){f=Number(t.criticalHighValue);d=Number(t.warningHighValue);w=Number(t.warningLowValue);c=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<c||this.CALCULATED_KPI_VALUE>f){r=sap.m.ValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=c&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=d&&this.CALCULATED_KPI_VALUE<=f)){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Good;}}}return r;}catch(e){b.logError(e);}},getTrendIndicator:function(t){var b=this;t=Number(t);try{var c=sap.m.DeviationIndicator.None;if(t>this.CALCULATED_KPI_VALUE){c=sap.m.DeviationIndicator.Down;}else if(t<this.CALCULATED_KPI_VALUE){c=sap.m.DeviationIndicator.Up;}return c;}catch(e){b.logError(e);}},setTextInTile:function(){var t=this;var b=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:b.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:b.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},_getEvaluationThresholdMeasures:function(){var t=[];t.push(this.oConfig.EVALUATION.COLUMN_NAME);if(this.oConfig.EVALUATION.VALUES_SOURCE==="MEASURE"){var b=this.oConfig.EVALUATION_VALUES;if(b&&b.length){for(var i=0;i<b.length;i++){if((b[i]).COLUMN_NAME&&!((b[i]).FIXED)){t.push((b[i]).COLUMN_NAME);}}}}return t;},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});return g;});
sap.ui.predefine('sap/ushell/components/tiles/indicatorArea/AreaChartTile.controller',['sap/ushell/components/tiles/generic'],function(g){"use strict";var A=g.extend("sap.ushell.components.tiles.indicatorArea.AreaChartTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},doProcess:function(r,i){this.onAfterFinalEvaluation(r,i);},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({footer:"",description:"",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);},scheduleJob:function(d){if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},onAfterFinalEvaluation:function(r,d){var t=this;var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var E=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var m=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var f=this.DEFINITION_DATA.TILE_PROPERTIES.dimension;if(f==undefined){this.logError();return;}var h=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var j=this.DEFINITION_DATA.EVALUATION_VALUES;var k=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(k){var l=k.Data&&JSON.parse(k.Data);}}var n=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var o=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,n,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);var p=m;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(h){case"MI":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningHigh&&t.sCriticalHigh&&t.sTarget){p+=","+t.sWarningHigh+","+t.sCriticalHigh+","+t.sTarget;}break;case"MA":t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget){p+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget;}break;case"RA":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget&&t.sWarningHigh&&t.sCriticalHigh){p+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget+","+t.sWarningHigh+","+t.sCriticalHigh;}break;}}var q=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);if((l&&!l.rightData)||!k||(!o&&t.oTileApi.visible.isVisible())||q||(d&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var Q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,E,p,f,v);if(Q){this.queryUriForTrendChart=Q.uri;var w={};try{this.trendChartODataReadRef=Q.model.read(Q.uri,null,null,true,function(a){t.kpiValueFetchDeferred=true;if(a&&a.results&&a.results.length){if(Q.unit[0]){t.unit=a.results[0][Q.unit[0].name];t.CURRENCY_CODE=t.unit;w.unit=Q.unit[0];w.unit.name=Q.unit[0].name;}t.queryUriResponseForTrendChart=a;f=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oRunTimeODataModel,E,f);a.results.splice(10);a.firstXlabel=a.results[0][f];a.lastXlabel=a.results[a.results.length-1][f];w.data=a;if(w&&w.data&&w.data.results&&w.data.results.length){for(var i=0;i<w.data.results.length;i++){delete w.data.results[i].__metadata;}}w.isCurM=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);w.dimensionName=f;_(a,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);var c={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();c.ChipId=t.oConfig.TILE_PROPERTIES.id;c.Data=JSON.stringify(w);c.CacheMaxAge=Number(t.chipCacheTime);c.CacheMaxAgeUnit=t.chipCacheTimeUnit;c.CacheType=1;var b=t.getLocalCache(c);if(t.DEFINITION_DATA.TILE_PROPERTIES.frameType==sap.m.FrameType.TwoByOne){var y=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(y){if(!y.CachedTime){y.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}var z=y.Data;if(z){z=JSON.parse(z);z.rightData=w;}y.Data=JSON.stringify(z);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,y);}else{var z={};z.rightData=w;b.Data=JSON.stringify(z);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,b);}t.cacheWriteData=w;t.getView().getViewData().deferredObj.resolve();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,b);var U=false;if(k){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,c,U,function(a){if(a){t.cacheTime=a&&a.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,a);t.setTimeStamp();}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}});}t.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);t.updateDatajobScheduled=false;var B=t.oConfig.TILE_PROPERTIES.id+"data";var C=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(B);if(C){clearTimeout(C);C=undefined;}jQuery.proxy(t.scheduleJob(t.cacheTime),t);}}else{t.setNoData();}},function(a){t.kpiValueFetchDeferred=true;if(a&&a.response){t.logError("Data call failed");}});}catch(e){t.kpiValueFetchDeferred=true;t.logError(e);}}else{t.kpiValueFetchDeferred=true;t.logError();}}}else{if(k&&k.Data){try{var s;var x=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(x.indexOf("DT-")==-1){s=k.Data&&JSON.parse(k.Data);}else{s=k.Data&&JSON.parse(k.Data);s=s.rightData;}if(s.unit){t.unit=s.data.results[0][s.unit.name];t.CURRENCY_CODE=t.unit;}t.cacheTime=k.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}t.queryUriResponseForTrendChart=s.data;f=s.dimensionName;_(s.data,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);if(t.oConfig.TILE_PROPERTIES.frameType==sap.m.FrameType.OneByOne){t.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}else{t.getView().getViewData().deferredObj.resolve();}jQuery.proxy(t.scheduleJob(t.cacheTime),t);}catch(e){t.logError(e);}}else{t.setNoData();}}function _(y,z){var B=[];var C=[];var D=[];var F=[];var G=[];var H=[];var I=y.firstXlabel;var J,K,L,M,N;var O=y.lastXlabel;var P=Number(y.results[0][m]);var R=Number(y.results[y.results.length-1][m]);var i;for(i in y.results){y.results[i][f]=Number(i);y.results[i][m]=Number(y.results[i][m]);t.sWarningHigh?y.results[i][t.sWarningHigh]=Number(y.results[i][t.sWarningHigh]):"";t.sCriticalHigh?y.results[i][t.sCriticalHigh]=Number(y.results[i][t.sCriticalHigh]):"";t.sCriticalLow?y.results[i][t.sCriticalLow]=Number(y.results[i][t.sCriticalLow]):"";t.sWarningLow?y.results[i][t.sWarningLow]=Number(y.results[i][t.sWarningLow]):"";t.sTarget?y.results[i][t.sTarget]=Number(y.results[i][t.sTarget]):"";t.sWarningHigh?D.push(y.results[i][t.sWarningHigh]):"";t.sCriticalHigh?F.push(y.results[i][t.sCriticalHigh]):"";t.sCriticalLow?G.push(y.results[i][t.sCriticalLow]):"";t.sWarningLow?H.push(y.results[i][t.sWarningLow]):"";B.push(y.results[i][f]);C.push(y.results[i][m]);}try{I=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(I);O=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(O);}catch(e){t.logError(e);}var S=Number(P);if(t.oConfig.EVALUATION.SCALING==-2){S*=100;}var T=Math.min.apply(Math,C);var c=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var U=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(S,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION,c,t.CURRENCY_CODE);if(t.oConfig.EVALUATION.SCALING==-2){U+=" %";}var V=U.toString();var W=Number(R);if(t.oConfig.EVALUATION.SCALING==-2){W*=100;}var X=Math.max.apply(Math,C);c=t.isCurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var Y=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(W,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION,c,t.CURRENCY_CODE);if(t.oConfig.EVALUATION.SCALING==-2){Y+=" %";}var Z=Y.toString();try{var $=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.min.apply(Math,B));var a1=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.max.apply(Math,B));}catch(e){t.logError(e);}if(z=="MEASURE"){(D.length!=0)?(t.firstwH=D[$])&&(t.lastwH=D[a1]):"";(F.length!=0)?(t.firstcH=F[$])&&(t.lastcH=F[a1]):"";(G.length!=0)?(t.firstcL=G[$])&&(t.lastcL=G[a1]):"";(H.length!=0)?(t.firstwL=H[$])&&(t.lastwL=H[a1]):"";}var b1={width:"100%",height:"100%",unit:t.unit||"",chart:{color:"Neutral",data:y.results},size:"Auto",minXValue:$,maxXValue:a1,minYValue:T,maxYValue:X,firstXLabel:{label:I+"",color:"Neutral"},lastXLabel:{label:O+"",color:"Neutral"},firstYLabel:{label:V+"",color:"Neutral"},lastYLabel:{label:Z+"",color:"Neutral"},minLabel:{},maxLabel:{}};switch(h){case"MA":for(i in j){if(j[i].TYPE=="CL"){b1.minThreshold={color:"Error"};var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);t.cl=Number(j[i].FIXED);b1.minThreshold.data=(z=="MEASURE")?y.results:[c1];J=(z=="MEASURE")?t.sCriticalLow:m;}else if(j[i].TYPE=="WL"){b1.maxThreshold={color:"Good"};var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);b1.maxThreshold.data=(z=="MEASURE")?y.results:[c1];K=(z=="MEASURE")?t.sWarningLow:m;t.wl=Number(j[i].FIXED);}else if(j[i].TYPE=="TA"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);b1.target={color:"Neutral"};b1.target.data=(z=="MEASURE")?y.results:[c1];N=(z=="MEASURE")?t.sTarget:m;}}b1.innerMinThreshold={data:[]};b1.innerMaxThreshold={data:[]};if(z=="FIXED"){b1.firstYLabel.color=P<t.cl?"Error":((t.cl<=P)&&(P<=t.wl))?"Critical":(P>t.wl)?"Good":"Neutral";b1.lastYLabel.color=R<t.cl?"Error":((t.cl<=R)&&(R<=t.wl))?"Critical":(R>t.wl)?"Good":"Neutral";}else if(z=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL){b1.firstYLabel.color=P<t.firstcL?"Error":((t.firstcL<=P)&&(P<=t.firstwL))?"Critical":(P>t.firstwL)?"Good":"Neutral";b1.lastYLabel.color=R<t.lastcL?"Error":((t.lastcL<=R)&&(R<=t.lastwL))?"Critical":(R>t.lastwL)?"Good":"Neutral";}break;case"MI":for(i in j){if(j[i].TYPE=="CH"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);t.ch=Number(j[i].FIXED);b1.maxThreshold={color:"Error"};b1.maxThreshold.data=(z=="MEASURE")?y.results:[c1];K=(z=="MEASURE")?t.sCriticalHigh:m;}else if(j[i].TYPE=="WH"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);t.wh=Number(j[i].FIXED);b1.minThreshold={color:"Good"};b1.minThreshold.data=(z=="MEASURE")?y.results:[c1];J=(z=="MEASURE")?t.sWarningHigh:m;}else if(j[i].TYPE=="TA"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);b1.target={color:"Neutral"};b1.target.data=(z=="MEASURE")?y.results:[c1];N=(z=="MEASURE")?t.sTarget:m;}}if(z=="FIXED"){b1.firstYLabel.color=P>t.ch?"Error":((t.wh<=P)&&(P<=t.ch))?"Critical":(P<t.wh)?"Good":"Neutral";b1.lastYLabel.color=R>t.ch?"Error":((t.wh<=R)&&(R<=t.ch))?"Critical":(R<t.wh)?"Good":"Neutral";}else if(z=="MEASURE"&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){b1.firstYLabel.color=P>t.firstcH?"Error":((t.firstwH<=P)&&(P<=t.firstcH))?"Critical":(P<t.firstwH)?"Good":"Neutral";b1.lastYLabel.color=R>t.lastcH?"Error":((t.lastwH<=R)&&(R<=t.lastcH))?"Critical":(R<t.lastwH)?"Good":"Neutral";}b1.innerMaxThreshold={data:[]};b1.innerMinThreshold={data:[]};break;case"RA":for(i in j){if(j[i].TYPE=="CH"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);t.ch=Number(j[i].FIXED);b1.maxThreshold={color:"Error"};b1.maxThreshold.data=(z=="MEASURE")?y.results:[c1];K=(z=="MEASURE")?t.sCriticalHigh:m;}else if(j[i].TYPE=="WH"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);t.wh=Number(j[i].FIXED);b1.innerMaxThreshold={color:"Good"};b1.innerMaxThreshold.data=(z=="MEASURE")?y.results:[c1];M=(z=="MEASURE")?t.sWarningHigh:m;}else if(j[i].TYPE=="WL"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);t.wl=Number(j[i].FIXED);b1.innerMinThreshold={color:"Good"};b1.innerMinThreshold.data=(z=="MEASURE")?y.results:[c1];L=(z=="MEASURE")?t.sWarningLow:m;}else if(j[i].TYPE=="CL"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);t.cl=Number(j[i].FIXED);b1.minThreshold={color:"Error"};b1.minThreshold.data=(z=="MEASURE")?y.results:[c1];J=(z=="MEASURE")?t.sCriticalLow:m;}else if(j[i].TYPE=="TA"){var c1={};c1[f]="";c1[m]=Number(j[i].FIXED);b1.target={color:"Neutral"};b1.target.data=(z=="MEASURE")?y.results:[c1];N=(z=="MEASURE")?t.sTarget:m;}}if(z=="FIXED"){b1.firstYLabel.color=(P>t.ch||P<t.cl)?"Error":((t.wh<=P)&&(P<=t.ch))||((t.cl<=P)&&(P<=t.wl))?"Critical":((P>=t.wl)&&(P<=t.wh))?"Good":"Neutral";b1.lastYLabel.color=(R>t.ch||R<t.cl)?"Error":((t.wh<=R)&&(R<=t.ch))||((t.cl<=R)&&(R<=t.wl))?"Critical":((R>=t.wl)&&(R<=t.wh))?"Good":"Neutral";}else if(z=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){b1.firstYLabel.color=(P>t.firstcH||P<t.firstcL)?"Error":((t.firstwH<=P)&&(P<=t.firstcH))||((t.firstcL<=P)&&(P<=t.firstwL))?"Critical":((P>=t.firstwL)&&(P<=t.firstwH))?"Good":"Neutral";b1.lastYLabel.color=(R>t.lastcH||R<t.lastcL)?"Error":((t.lastwH<=R)&&(R<=t.lastcH))||((t.lastcL<=R)&&(R<=t.lastwL))?"Critical":((R>=t.lastwL)&&(R<=t.lastwH))?"Good":"Neutral";}break;}var d1=function(f1,a,b,z){return new sap.suite.ui.microchart.AreaMicroChartItem({color:"{/"+f1+"/color}",points:{path:"/"+f1+"/data",template:new sap.suite.ui.microchart.AreaMicroChartPoint({x:"{"+a+"}",y:"{"+b+"}"})}});};var e1=t.getView().oNVConfContS;e1.setTarget(d1("target",f,N));e1.setInnerMinThreshold(d1("innerMinThreshold",f,L));e1.setInnerMaxThreshold(d1("innerMaxThreshold",f,M));e1.setMinThreshold(d1("minThreshold",f,J));e1.setMaxThreshold(d1("maxThreshold",f,K));e1.setChart(d1("chart",f,m));t.setTextInTile();if(t.getView().getViewData().parentController){t.getView().getViewData().parentController._updateTileModel(b1);}else{t._updateTileModel(b1);}}}});return A;});
sap.ui.predefine('sap/ushell/components/tiles/indicatorDual/DualTile.controller',function(){"use strict";sap.ui.controller("sap.ushell.components.tiles.indicatorDual.DualTile",{getRelativeTime:function(){var c=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();this.cacheTime=(jQuery.type(this.cacheTime)=="date")?this.cacheTime:new Date(parseInt(this.cacheTime.substr(6),10));var r=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(c-this.cacheTime);var a;switch(r.unit){case"minutes":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"minutes");c=c-o;a=new Date(c);break;case"hours":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"hours");c=c-o;a=new Date(c);break;case"days":var o=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(r.time,"days");c=c-o;a=new Date(c);break;}return a;},getTile:function(){return this.oKpiTileView.oGenericTile;},setTimeStamp:function(){this.updateTimeStampjobScheduled=false;var f=sap.ui.core.format.DateFormat.getDateTimeInstance({relative:true,relativeSource:"auto"});var t=f.format(this.getRelativeTime());var l=this.getView().oGenericTile.getTileContent()[0];l&&l.setRefreshOption&&l.setRefreshOption(true);l&&l.setTimestamp&&l.setTimestamp(t);this.updateTimeStampjobScheduled=false;var k=this.oConfig.TILE_PROPERTIES.id+"time";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}sap.ushell.components.tiles.indicatorTileUtils.util.scheduleTimeStampJob.call(this,this.oTileApi.visible.isVisible());},getLocalCache:function(c){var l={};l.ChipId=c.ChipId;l.Data=c.Data;l.CacheMaxAge=c.CacheMaxAgeUnit;l.CacheMaxAgeUnit=c.CacheMaxAgeUnit;l.CacheType=c.CacheType;l.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();return l;},refreshPress:function(){this.initProcess(true);},_getView:function(v,d,r){var a=this.oKpiTileView.getViewData();var b=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:v,viewData:jQuery.extend(true,{},a,{parentController:this},{deferredObj:d},{refresh:r})});return b;},logError:function(e){this._updateTileModel({value:"",scale:"",unit:""});if(this.getView().getViewData().deferredObj){this.getView().getViewData().deferredObj.reject();}},doProcess:function(r){sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(this.oKpiTileView.oConfig.TILE_PROPERTIES.id+"defferedLeft",this.deferred_left);sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(this.oKpiTileView.oConfig.TILE_PROPERTIES.id+"defferedRight",this.deferred_right);var t=this;this.getView().oGenericTile.removeAllTileContent();var s=this.getView().oGenericTile;this.leftView;this.rightView;this.system=this.oTileApi.url.getApplicationSystem();this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loading);var a=t.tileType.split("-")[1];try{var v;v="sap.ushell.components.tiles.indicatornumeric.NumericTile";this.leftView=t._getView(v,this.deferred_left,r);this.leftView.getController().dataCallInProgress=false;s.addTileContent(this.leftView.oGenericTile.getTileContent()[0]);switch(a){case"CM":v="sap.ushell.components.tiles.indicatorcomparison.ComparisonTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"CT":v="sap.ushell.components.tiles.indicatorcontribution.ContributionTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"AT":v="sap.ushell.components.tiles.indicatordeviation.DeviationTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;case"TT":v="sap.ushell.components.tiles.indicatorArea.AreaChartTile";this.rightView=t._getView(v,this.deferred_right,r);this.rightView.getController().dataCallInProgress=false;s.addTileContent(this.rightView.oGenericTile.getTileContent()[0]);break;}this.leftView.getController().onAfterTileRendering();this.rightView.getController().onAfterTileRendering();var l=this.getView().oGenericTile.getTileContent()[0];l&&l.attachRefresh&&l.attachRefresh(jQuery.proxy(this.refreshPress,t));}catch(e){this.logError(e);}},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},setTextInTile:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},doDummyProcess:function(){var t=this;try{t.setTextInTile();switch(t.tileType){case"DT-CM":t._updateTileModel({value:1,size:sap.m.Size.Auto,frameType:sap.m.FrameType.TwoByOne,state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Good,indicator:sap.m.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1,color:"Good"},{title:"Measure 2",value:2,color:"Good"},{title:"Measure 3",value:3,color:"Good"}]});break;case"DT-AT":t._updateTileModel({valueColor:"Good",value:100,frameType:sap.m.FrameType.TwoByOne,unit:"USD",actual:{value:120,color:sap.m.ValueColor.Good},targetValue:100,thresholds:[{value:0,color:sap.m.ValueColor.Error},{value:50,color:sap.m.ValueColor.Critical},{value:150,color:sap.m.ValueColor.Critical},{value:200,color:sap.m.ValueColor.Error}],showActualValue:true,showTargetValue:true});break;case"DT-CT":t._updateTileModel({value:8888,size:sap.m.Size.Auto,frameType:sap.m.FrameType.TwoByOne,state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Error,indicator:sap.m.DeviationIndicator.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral",displayValue:""},{title:"EMEA",value:50,color:"Neutral",displayValue:""},{title:"APAC",value:-20,color:"Neutral",displayValue:""}]});break;case"DT-TT":this._updateTileModel({value:8888,size:sap.m.Size.Auto,frameType:sap.m.FrameType.TwoByOne,state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Error,indicator:sap.m.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});break;}}catch(e){}},visibleHandler:function(i){if(!i){if(this.leftView){this.leftView.getController().firstTimeVisible=false;}if(this.rightView){this.rightView.getController().firstTimeVisible=false;}sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){if(this.leftView){this.leftView.getController().refreshHandler();}if(this.rightView){this.rightView.getController().refreshHandler();}}},initProcess:function(r){var t=this;this.oKpiTileView=this.getView();this.oResourceBundle=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();this.viewData={};t.viewData=this.oKpiTileView.getViewData();this.oTileApi=this.viewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.deferred_left=new jQuery.Deferred();this.deferred_right=new jQuery.Deferred();$.when(this.deferred_left,this.deferred_right).done(function(){t.setTextInTile();t.oConfig=t.oKpiTileView.oConfig;t.chipCacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(t.oConfig);t.chipCacheTimeUnit=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(t.oConfig);var l=t.leftView.getController().cacheWriteData;var a=t.rightView.getController().cacheWriteData;t.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oKpiTileView.oConfig,t.system);t.oKpiTileView.oGenericTile.$().wrap("<a href ='"+n+"'/>");t.oKpiTileView.oGenericTile.attachPress(function(){t.tilePressed=true;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oKpiTileView.oConfig.TILE_PROPERTIES.id,null);window.location.hash=n;});var c={};var w={};w.leftData=l;w.rightData=a;c.ChipId=t.oConfig.TILE_PROPERTIES.id;c.Data=JSON.stringify(w);c.CacheMaxAge=Number(t.chipCacheTime);c.CacheMaxAgeUnit=t.chipCacheTimeUnit;c.CacheType=1;var b=t.getLocalCache(c);if(w.leftData&&w.rightData){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,b);}var d=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(t.chipCacheTime&&w.leftData&&w.rightData){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,c,false,function(e){if(e){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,e);t.cacheTime=e.CachedTime;t.setTimeStamp.call(t);}});}if(t.chipCacheTime){if(!t.cacheTime){t.cacheTime=d.CachedTime;}t.setTimeStamp.call(t);sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(t,t.oTileApi.visible.isVisible());}}).fail(function(){t.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Failed);});t.tileType=t.oKpiTileView.oConfig.TILE_PROPERTIES.tileType;this.oTileApi=t.viewData.chip;if(this.oTileApi.preview.isEnabled()){this.doDummyProcess();t.oKpiTileView.oGenericTile.attachPress(function(){sap.m.MessageToast.show(t.oResourceBundle.getText("sb.NavigationHelp"));});}else{this.doProcess(r);}},onAfterRendering:function(){this.initProcess();},setNoData:function(){try{this._updateTileModel({value:"",scale:"",unit:"",footerNum:this.oResourceBundle.getText("sb.noDataAvailable"),footerComp:this.oResourceBundle.getText("sb.noDataAvailable")});this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}catch(e){}},getChipConfiguration:function(c){var t=this;try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),t.oTileApi.preview.isEnabled(),function(a){t.oConfig=a;c.call();});}catch(e){t.logError(e.message);}}});return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualComparison/DualComparison.controller',["sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil"],function(u){"use strict";sap.ui.controller("tiles.indicatorDualComparison.DualComparison",{getTile:function(){return this.oDualComparisonView.oGenericTile;},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},setTitle:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oChip);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},logError:function(e){this.oDualComparisonView.oGenericTile.setState(sap.m.LoadState.Failed);this.oDualComparisonView.oGenericTile.setState(sap.m.LoadState.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},getTrendColor:function(t){var a=this;var c,w,b,d;try{var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var r=sap.m.ValueColor.Neutral;if(i==="MI"){if(t.criticalHighValue&&t.warningHighValue){c=Number(t.criticalHighValue);w=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<w){r=sap.m.ValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=c){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Error;}}}else if(i==="MA"){if(t.criticalLowValue&&t.warningLowValue){b=Number(t.criticalLowValue);d=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<b){r=sap.m.ValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=d){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Good;}}}else{if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){c=Number(t.criticalHighValue);w=Number(t.warningHighValue);d=Number(t.warningLowValue);b=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<b||this.CALCULATED_KPI_VALUE>c){r=sap.m.ValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=d)||(this.CALCULATED_KPI_VALUE>=w&&this.CALCULATED_KPI_VALUE<=c)){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Good;}}}return r;}catch(e){a.logError(e);}},_processDataForComparisonChart:function(d,m,a){var f=[],L={},i,t,l;var b;var T=[];var c=this;for(i=0;i<d.results.length;i++){var e=d.results[i];}T=sap.ushell.components.tiles.indicatorTileUtils.util.getAllMeasuresWithLabelText(this.oConfig.EVALUATION.ODATA_URL,this.oConfig.EVALUATION.ODATA_ENTITYSET);for(i=0,l=T.length;i<l;i++){t=T[i];L[t.key]=t.value;}var g=c.oConfig.TILE_PROPERTIES.COLUMN_NAMES||c.oConfig.EVALUATION.COLUMN_NAMES;for(i=0;i<g.length;i++){var h={};var j=g[i];h.value=Number(e[j.COLUMN_NAME]);var k=Number(e[j.COLUMN_NAME]);if(c.oConfig.EVALUATION.SCALING==-2){k*=100;}b=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(k,c.oConfig.EVALUATION.SCALING,c.oConfig.EVALUATION.DECIMAL_PRECISION);if(c.oConfig.EVALUATION.SCALING==-2){b+=" %";}h.displayValue=b.toString();if(a[i]&&e[a[i].name]){h.displayValue+=" "+e[a[i].name];}h.color=j.semanticColor;h.title=L[j.COLUMN_NAME]||j.COLUMN_NAME;f.push(h);}return f;},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=sap.m.DeviationIndicator.None;if(t>v){b=sap.m.DeviationIndicator.Down;}else if(t<v){b=sap.m.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},fetchKpiValue:function(s,E){var t=this;try{var U=this.oConfig.EVALUATION.ODATA_URL;var a=this.oConfig.EVALUATION.ODATA_ENTITYSET;if(this.oConfig.TILE_PROPERTIES.semanticMeasure){var m=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{var m=this.oConfig.EVALUATION.COLUMN_NAME;var b=m;if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES){for(var j=0;j<this.oConfig.TILE_PROPERTIES.COLUMN_NAMES.length;j++){if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){b=b+","+this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME;}}}}var d=this.oConfig.EVALUATION_VALUES;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!c){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=m+",asc";o["1"]=m+",desc";var f=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var g=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(U),a,b,null,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){g.uri+="&$orderby="+f[0]+" "+f[2];}else{g.uri+="&$orderby="+f[0]+" "+f[1];}this.writeData={};this.comparisionChartODataRef=g.model.read(g.uri,null,null,true,function(d){if(d&&d.results&&d.results.length){if(g.unit){t.writeData.unit=g.unit;}t.oConfig.TILE_PROPERTIES.FINALVALUE=d;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,b.split(",")[0],g.unit);t.writeData.data=d;var k;for(var i=0;i<t.oConfig.TILE_PROPERTIES.FINALVALUE.length;i++){if(t.oConfig.TILE_PROPERTIES.FINALVALUE[i].title==t.DEFINITION_DATA.EVALUATION.COLUMN_NAME){t.writeData.numericData=t.oConfig.TILE_PROPERTIES.FINALVALUE[i];calculatedValueforScaling=t.oConfig.TILE_PROPERTIES.FINALVALUE[i].value;t.getTrendIndicator(t.setThresholdValues().trendValue,calculatedValueforScaling);t._updateTileModel({valueColor:t.oConfig.TILE_PROPERTIES.FINALVALUE[i].color,value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(k),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString()});break;}}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(d.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=d;t.writeData.data=d;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{E.call(t,"no Response from QueryServiceUri");}},function(i){if(i&&i.response){jQuery.sap.log.error(i.message+" : "+i.request.requestUri);E.call(t,i);}});if(!t.writeData.numericData){var h=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(U),a,m,null,h);if(q){t.QUERY_SERVICE_MODEL=q.model;t.queryUriForKpiValue=q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(d){if(d&&d.results&&d.results.length){if(q.unit){t._updateTileModel({unitNumeric:d.results[0][q.unit.name]});t.writeData.unitNumeric=q.unit;t.writeData.unitNumeric.name=q.unit.name;}t.writeData.numericData=d.results[0];t.DEFINITION_DATA.value=t.writeData.numericData[t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];t.writeData.numericData.color=t.getTrendColor(t.setThresholdValues());t.DEFINITION_DATA.valueColor=t.writeData.numericData.color;var S="";var i=d.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var k=t.getTrendIndicator(t.setThresholdValues().trendValue,i);if(t.oConfig.EVALUATION.SCALING==-2){i*=100;t.getView().oNumericContent.setFormatterValue(false);}S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(i),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:S.toString(),valueColor:t.writeData.numericData.color,indicator:k});}else{E.call(t,"no Response from QueryServiceUri");}});}}}else{if(c.unit){t._updateTileModel({unit:c.data.results[0][c.unit.name]});}if(c.data&&c.data.results&&c.data.results.length){t.oConfig.TILE_PROPERTIES.FINALVALUE=c.data;t._updateTileModel({value:c.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]});t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,b,t.writeData.unit);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(d.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=c.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{E.call(t,"no Response from QueryServiceUri");}}}catch(e){E.call(t,e);}},flowWithoutDesignTimeCall:function(){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oChip.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k){this.CALCULATED_KPI_VALUE=k;t.oDualComparisonView.oGenericTile.setFrameType("TwoByOne");t.oDualComparisonView.oGenericTile.removeAllTileContent();t.oDualComparisonView.oGenericTile.addTileContent(t.oDualComparisonView.oNumericTile);t.oDualComparisonView.oGenericTile.addTileContent(t.oDualComparisonView.oComparisonTile);var c=this.CALCULATED_KPI_VALUE;var a,b;for(var i=0;i<c.length;i++){if(c[i].title==t.DEFINITION_DATA.EVALUATION.COLUMN_NAME){b=c[i].value;a=c[i].color||"Neutral";t._updateTileModel({value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString(),valueColor:a});break;}}if(!a&&!b){a=t.DEFINITION_DATA.valueColor;b=t.DEFINITION_DATA.value;}this._updateTileModel({value:sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION).toString(),data:this.CALCULATED_KPI_VALUE});var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualComparisonView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oDualComparisonView.oGenericTile.setState(sap.m.LoadState.Loaded);var s="";if(a=="Error"){s="sb.error";}if(a=="Neutral"){s="sb.neutral";}if(a=="Critical"){s="sb.critical";}if(a=="Good"){s="sb.good";}var T=t.setThresholdValues();var m,d,e,v,f,g,h,j,l;if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[0]){m=this.CALCULATED_KPI_VALUE[0].title;v=this.CALCULATED_KPI_VALUE[0].value;h=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[0].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[1]){d=this.CALCULATED_KPI_VALUE[1].title;f=this.CALCULATED_KPI_VALUE[1].value;j=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[1].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[2]){e=this.CALCULATED_KPI_VALUE[2].title;g=this.CALCULATED_KPI_VALUE[2].value;l=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[2].color);}var o={status:s,actual:b,target:T.targetValue,cH:T.criticalHighValue,wH:T.warningHighValue,wL:T.warningLowValue,cL:T.criticalLowValue};var p={m1:m,v1:v,c1:h,m2:d,v2:f,c2:j,m3:e,v3:g,c3:l};var C=t.oDualComparisonView.oGenericTile.getTileContent()[0].getContent();var q=t.oDualComparisonView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",o);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(q,"COMP",p);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oChip.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualComparisonView=this.getView();this.oChip=this.oDualComparisonView.getViewData().chip;if(this.oChip.visible){this.oChip.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oChip.url.getApplicationSystem();this.oDualComparisonView.oGenericTile.setState(sap.m.LoadState.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oChip.configuration.getParameterValueAsString("tileConfiguration"),this.oChip.preview.isEnabled(),function(c){t.oConfig=c;if(t.oChip.preview){t.oChip.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oChip.preview.isEnabled()){t.setTitle();t._updateTileModel({value:1,size:sap.m.Size.Auto,frameType:"TwoByOne",state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Good,indicator:sap.m.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1,color:"Good"},{title:"Measure 2",value:2,color:"Good"},{title:"Measure 3",value:3,color:"Good"}]});t.oDualComparisonView.oGenericTile.setState(sap.m.LoadState.Loaded);}else{t.oConfig.TILE_PROPERTIES.FINALVALUE;t.setTitle();t.oDualComparisonView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.comparisionChartODataRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oChip.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualContribution/DualContribution.controller',function(){"use strict";sap.ui.controller("tiles.indicatorDualContribution.DualContribution",{getTile:function(){return this.oDualContributionView.oGenericTile;},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);this.getTile().getModel().updateBindings();},setTitle:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oChip);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},logError:function(e){this.oDualContributionView.oGenericTile.setState(sap.m.LoadState.Failed);this.oDualContributionView.oGenericTile.setState(sap.m.LoadState.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=sap.m.DeviationIndicator.None;if(t>v){b=sap.m.DeviationIndicator.Down;}else if(t<v){b=sap.m.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},_processDataForComparisonChart:function(d,m,a){var s=this.oConfig.TILE_PROPERTIES.semanticMeasure;var f=[];var t;for(var i=0;i<d.results.length;i++){var b=d.results[i];var c={};try{c.title=b[a].toString();}catch(e){c.title="";}c.value=Number(b[m]);var g=Number(b[m]);if(this.oConfig.EVALUATION.SCALING==-2){g*=100;}t=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(g,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION);c.displayValue=t.toString();if(typeof s==='undefined'){c.color="Neutral";}else{if(this.oConfig.EVALUATION.GOAL_TYPE==="MA"){if(c.value>b[s]){c.color="Good";}else{c.color="Error";}}else if(this.oConfig.EVALUATION.GOAL_TYPE==="MI"){if(c.value<b[s]){c.color="Good";}else{c.color="Error";}}else{c.color="Neutral";}}f.push(c);}return f;},fetchKpiValue:function(s,E){var t=this;try{var u=this.oConfig.EVALUATION.ODATA_URL;var a=this.oConfig.EVALUATION.ODATA_ENTITYSET;if(this.oConfig.TILE_PROPERTIES.semanticMeasure){var m=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{var m=this.oConfig.EVALUATION.COLUMN_NAME;}var d=this.oConfig.TILE_PROPERTIES.dimension;var b=this.oConfig.EVALUATION_VALUES;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!c){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=m+",asc";o["1"]=m+",desc";o["2"]=d+",asc";o["3"]=d+",desc";var f=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var g=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(u),a,m,d,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){g.uri+="&$top=3&$orderby="+f[0]+" "+f[2];}else{g.uri+="&$top=3&$orderby="+f[0]+" "+f[1];}this.comparisionChartODataRef=g.model.read(g.uri,null,null,true,function(b){if(g.unit[0]){t._updateTileModel({unitContribution:b.results[0][g.unit[0].name]});t.writeData.unitContribution=g.unit[0];t.writeData.unitContribution.name=g.unit[0].name;}if(b&&b.results&&b.results.length){d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oChip.url.addSystemToServiceUrl(u),a,d);t.writeData.dimension=d;t.oConfig.TILE_PROPERTIES.FINALVALUE=b;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,m.split(",")[0],d);t.writeData.data=b;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(b.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=b;t.writeData.data=b;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);}else{E.call(t,"no Response from QueryServiceUri");}},function(k){if(k&&k.response){jQuery.sap.log.error(k.message+" : "+k.request.requestUri);E.call(t,k);}});var h=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oChip.url.addSystemToServiceUrl(u),a,m,null,h);if(q){t.QUERY_SERVICE_MODEL=q.model;t.queryUriForKpiValue=q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(b){if(b&&b.results&&b.results.length){if(q.unit){t._updateTileModel({unitNumeric:b.results[0][q.unit.name]});t.writeData.unitNumeric=q.unit;t.writeData.unitNumeric.name=q.unit.name;}t.writeData.numericData=b;var S="";var i=b.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var j=t.getTrendIndicator(t.setThresholdValues().trendValue,i);if(t.oConfig.EVALUATION.SCALING==-2){i*=100;t.getView().oNumericContent.setFormatterValue(false);}t.DEFINITION_DATA.value=i;S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(i),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:S.toString(),valueColor:t.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution,indicator:j});s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE,i);}else{E.call(t,"no Response from QueryServiceUri");}});}}else{var T=t.setThresholdValues();var i;if(c.unitContribution){t._updateTileModel({unitContribution:c.data.results[0][c.unitContribution.name]});}if(c.unitNumeric){t._updateTileModel({unitNumeric:c.numericData.results[0][c.unitNumeric.name]});}if(c.data&&c.data.results&&c.data.results.length){d=c.dimension;t.oConfig.TILE_PROPERTIES.FINALVALUE=c.data;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,m.split(",")[0],d);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(b.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=c.data;}else{E.call(t,"no Response from QueryServiceUri");}if(c.numericData&&c.numericData.results&&c.numericData.results.length){i=c.numericData.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(t.oConfig.EVALUATION.SCALING==-2){i*=100;t.getView().oNumericContent.setFormatterValue(false);}var S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(i),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}var j=t.getTrendIndicator(T.trendValue,i);t._updateTileModel({value:S.toString(),indicator:j,valueColor:t.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution});s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE,i);}else{E.call(t,"no Response from QueryServiceUri");}}}catch(e){E.call(t,e);}},flowWithoutDesignTimeCall:function(){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oChip.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k,c){this.CALCULATED_KPI_VALUE=k;if(t.oConfig.TILE_PROPERTIES.frameType=="TwoByOne"){t.oDualContributionView.oGenericTile.setFrameType("TwoByOne");t.oDualContributionView.oGenericTile.removeAllTileContent();t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oNumericTile);t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oComparisonTile);}else{t.oDualContributionView.oGenericTile.setFrameType("OneByOne");t.oDualContributionView.oGenericTile.removeAllTileContent();t.oDualContributionView.oGenericTile.addTileContent(t.oDualContributionView.oComparisonTile);}var d=this.CALCULATED_KPI_VALUE;var a=this.DEFINITION_DATA.TILE_PROPERTIES.semanticColorContribution;for(var i=0;i<this.CALCULATED_KPI_VALUE.length;i++){d[i].color=a;}this._updateTileModel({data:d});var T=t.setThresholdValues();var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualContributionView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oDualContributionView.oGenericTile.setState(sap.m.LoadState.Loaded);var s="";if(a=="Error"){s="sb.error";}if(a=="Neutral"){s="sb.neutral";}if(a=="Critical"){s="sb.critical";}if(a=="Good"){s="sb.good";}var T=t.setThresholdValues();var m,b,e,v,f,g,h,j,l;if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[0]){m=this.CALCULATED_KPI_VALUE[0].title;v=this.CALCULATED_KPI_VALUE[0].value;h=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[0].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[1]){b=this.CALCULATED_KPI_VALUE[1].title;f=this.CALCULATED_KPI_VALUE[1].value;j=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[1].color);}if(this.CALCULATED_KPI_VALUE&&this.CALCULATED_KPI_VALUE[2]){e=this.CALCULATED_KPI_VALUE[2].title;g=this.CALCULATED_KPI_VALUE[2].value;l=sap.ushell.components.tiles.indicatorTileUtils.util.getSemanticColorName(this.CALCULATED_KPI_VALUE[2].color);}var o={status:s,actual:c,target:T.targetValue,cH:T.criticalHighValue,wH:T.warningHighValue,wL:T.warningLowValue,cL:T.criticalLowValue};var p={m1:m,v1:v,c1:h,m2:b,v2:f,c2:j,m3:e,v3:g,c3:l};var C=t.oDualContributionView.oGenericTile.getTileContent()[0].getContent();var q=t.oDualContributionView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",o);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(q,"CONT",p);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oChip.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}if(i){this.refreshHandler(this);}},onInit:function(){var t=this;t.writeData={};this.firstTimeVisible=false;this.oDualContributionView=this.getView();this.oChip=this.oDualContributionView.getViewData().chip;if(this.oChip.visible){this.oChip.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oChip.url.getApplicationSystem();this.oDualContributionView.oGenericTile.setState(sap.m.LoadState.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oChip.configuration.getParameterValueAsString("tileConfiguration"),this.oChip.preview.isEnabled(),function(c){t.oConfig=c;if(t.oChip.preview){t.oChip.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oChip.preview.isEnabled()){t.setTitle();t._updateTileModel({value:8888,size:sap.m.Size.Auto,frameType:"TwoByOne",state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Error,indicator:sap.m.DeviationIndicator.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral",displayValue:""},{title:"EMEA",value:50,color:"Neutral",displayValue:""},{title:"APAC",value:-20,color:"Neutral",displayValue:""}]});t.oDualContributionView.oGenericTile.setState(sap.m.LoadState.Loaded);}else{t.setTitle();t.oDualContributionView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.comparisionChartODataRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oChip.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.comparisionChartODataRef);}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualDeviation/DualDeviation.controller',function(){"use strict";sap.ui.controller("tiles.indicatorDualDeviation.DualDeviation",{logError:function(e){this.oDualDeviationView.oGenericTile.setState(sap.m.LoadState.Failed);this.oDualDeviationView.oGenericTile.setState(sap.m.LoadState.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},getThresholdsObjAndColor:function(t){try{var T={};T.arrObj=[];T.returnColor=sap.m.ValueColor.Neutral;var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var w,c,a,b;if(i==="MI"){a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;if(a&&b){a=window.parseFloat(a);b=window.parseFloat(b);T.arrObj.push({value:a,color:sap.m.ValueColor.Error});T.arrObj.push({value:b,color:sap.m.ValueColor.Critical});if(this.CALCULATED_KPI_VALUE<b){T.returnColor=sap.m.ValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=a){T.returnColor=sap.m.ValueColor.Critical;}else{T.returnColor=sap.m.ValueColor.Error;}}}else if(i==="MA"){c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(c&&w){c=window.parseFloat(c);w=window.parseFloat(w);T.arrObj.push({value:c,color:sap.m.ValueColor.Error});T.arrObj.push({value:w,color:sap.m.ValueColor.Critical});if(this.CALCULATED_KPI_VALUE<c){T.returnColor=sap.m.ValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=w){T.returnColor=sap.m.ValueColor.Critical;}else{T.returnColor=sap.m.ValueColor.Good;}}}else{a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(w&&b&&c&&c){a=window.parseFloat(a);b=window.parseFloat(b);w=window.parseFloat(w);c=window.parseFloat(c);T.arrObj.push({value:a,color:sap.m.ValueColor.Error});T.arrObj.push({value:b,color:sap.m.ValueColor.Critical});T.arrObj.push({value:w,color:sap.m.ValueColor.Critical});T.arrObj.push({value:c,color:sap.m.ValueColor.Error});if(this.CALCULATED_KPI_VALUE<c||this.CALCULATED_KPI_VALUE>a){T.returnColor=sap.m.ValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=c&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=a)){T.returnColor=sap.m.ValueColor.Critical;}else{T.returnColor=sap.m.ValueColor.Good;}}}return T;}catch(e){this.logError(e);}},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=sap.m.DeviationIndicator.None;if(t>v){b=sap.m.DeviationIndicator.Down;}else if(t<v){b=sap.m.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},getTile:function(){return this.oDualDeviationView.oGenericTile;},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},setThresholdValues:function(){var t=this;var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;},fetchKpiValue:function(s,E){var t=this;var k=0;try{var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var a=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var T=this.setThresholdValues();var m=T.fullyFormedMeasure;var c=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!c){var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),a,m,null,v);if(q){this.QUERY_SERVICE_MODEL=q.model;this.queryUriForKpiValue=q.uri;try{this.queryServiceUriODataReadRef=this.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(f){t.writeData={};if(f&&f.results&&f.results.length){k=f.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(q.unit[0]){t._updateTileModel({unit:f.results[0][q.unit[0].name]});t.writeData.unit=q.unit[0];t.writeData.unit.name=q.unit[0].name;}t.writeData.numericData=f;var S="",d;var b=k;if(t.oConfig.EVALUATION.SCALING==-2){b*=100;t.getView().oNumericContent.setFormatterValue(false);}S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);d=t.getTrendIndicator(T.trendValue,b);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}t._updateTileModel({value:S.toString(),indicator:d,valueColor:t.getThresholdsObjAndColor(T).returnColor});t.writeData.data=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=f.results[0][T.sCriticalHigh];T.criticalLowValue=f.results[0][T.sCriticalLow];T.warningHighValue=f.results[0][T.sWarningHigh];T.warningLowValue=f.results[0][T.sWarningLow];T.targetValue=f.results[0][T.sTarget];T.trendValue=f.results[0][T.sTrend];}s.call(t,k,T);}else{E.call(t,"no Response from QueryServiceUri");}},function(f){if(f&&f.response){E.call(t,f.message);}});}catch(e){t.logError("Error in Query Service URI");}}}else{if(c.data&&c.data.results&&c.data.results.length){var b,S,d,T;T=t.setThresholdValues();b=c.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];if(t.oConfig.EVALUATION.SCALING==-2){b*=100;t.getView().oNumericContent.setFormatterValue(true);}if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}S=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(b),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);d=t.getTrendIndicator(T.trendValue,b);if(c.unit){t._updateTileModel({unit:c.data.results[0][c.unit.name]});}t._updateTileModel({indicator:d,value:S.toString()});if(t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){T.criticalHighValue=c.data.results[0][T.sCriticalHigh];T.criticalLowValue=c.data.results[0][T.sCriticalLow];T.warningHighValue=c.data.results[0][T.sWarningHigh];T.warningLowValue=c.data.results[0][T.sWarningLow];T.targetValue=c.data.results[0][T.sTarget];T.trendValue=c.data.results[0][T.sTrend];}s.call(t,c.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME],T);}else{E.call(t,"no Response from QueryServiceUri");}}}catch(e){E.call(t,e);}},flowWithoutDesignTimeCall:function(){var t=this;var f,a;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oTileApi.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;this.fetchKpiValue(function(k,b){var c=Number(k);if(this.oConfig.EVALUATION.SCALING==-2){c*=100;}f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(c),this.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);this.CALCULATED_KPI_VALUE=Number(k);var d={};var e=this.getThresholdsObjAndColor(b);var g={value:Number(k),color:e.returnColor};d.valueColor=g.color;d.actualValueLabel=f.toString();d.actual=g;var h=this.DEFINITION_DATA.EVALUATION_VALUES;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var i=Number(b.targetValue);if(this.oConfig.EVALUATION.SCALING==-2){i*=100;}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(i,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION);d.targetValue=Number(b.targetValue);d.targetValueLabel=a.toString();}else{for(var j=0;j<h.length;j++){if(h[j].TYPE==="TA"){var i=Number(h[j].FIXED);if(this.oConfig.EVALUATION.SCALING==-2){i*=100;}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(i);d.targetValue=Number(h[j].FIXED);d.targetValueLabel=a.toString();}}}this._updateTileModel(d);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualDeviationView.oGenericTile.$().wrap("<a href ='"+n+"'/>");this.oDualDeviationView.oGenericTile.setState(sap.m.LoadState.Loaded);var s="";if(d.valueColor=="Error"){s="sb.error";}if(d.valueColor=="Neutral"){s="sb.neutral";}if(d.valueColor=="Critical"){s="sb.critical";}if(d.valueColor=="Good"){s="sb.good";}var v={status:s,actual:c,target:b.targetValue,cH:b.criticalHighValue,wH:b.warningHighValue,wL:b.warningLowValue,cL:b.criticalLowValue};var l=v;var C=t.oDualDeviationView.oGenericTile.getTileContent()[0].getContent();var o=t.oDualDeviationView.oGenericTile.getTileContent()[1].getContent();sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(C,"NT",v);sap.ushell.components.tiles.indicatorTileUtils.util.setTooltipInTile(o,"DT",l);},this.logError);}},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oTileApi.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);}if(i){this.refreshHandler(this);}},setTextInTile:function(){var t=this;var a=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.oTileApi);this._updateTileModel({header:a.title||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:a.subTitle||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualDeviationView=this.getView();this.oViewData=this.oDualDeviationView.getViewData();this.oTileApi=this.oViewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oTileApi.url.getApplicationSystem();this.oDualDeviationView.oGenericTile.setState(sap.m.LoadState.Loading);try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),t.oTileApi.preview.isEnabled(),function(c){t.oConfig=c;t.setTextInTile();if(t.oTileApi.preview){t.oTileApi.preview.setTargetUrl(sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system));}if(t.oTileApi.preview.isEnabled()){t._updateTileModel({valueColor:"Good",value:100,frameType:"TwoByOne",unit:"USD",actual:{value:120,color:sap.m.ValueColor.Good},targetValue:100,thresholds:[{value:0,color:sap.m.ValueColor.Error},{value:50,color:sap.m.ValueColor.Critical},{value:150,color:sap.m.ValueColor.Critical},{value:200,color:sap.m.ValueColor.Error}],showActualValue:true,showTargetValue:true});t.oDualDeviationView.oGenericTile.setState(sap.m.LoadState.Loaded);}else{t.oDualDeviationView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.queryServiceUriODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}}});}catch(e){this.logError(e);}},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new sap.ui.model.json.JSONModel({}));}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.queryServiceUriODataReadRef);}});return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualTrend/DualTrend.controller',function(){"use strict";sap.ui.controller("tiles.indicatorDualTrend.DualTrend",{logError:function(e){this.oDualTrendView.oGenericTile.setState(sap.m.LoadState.Failed);this.oDualTrendView.oGenericTile.setState(sap.m.LoadState.Failed);sap.ushell.components.tiles.indicatorTileUtils.util.logError(e);},formSelectStatement:function(o){var t=Object.keys(o);var f="";for(var i=0;i<t.length;i++){if((o[t[i]]!==undefined)&&(o.fullyFormedMeasure)){f+=","+o[t[i]];}}return f;},setThresholdValues:function(){var t=this;try{var T={};T.fullyFormedMeasure=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){switch(this.DEFINITION_DATA.EVALUATION.GOAL_TYPE){case"MI":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"MA":T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;case"RA":T.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");T.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");T.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");T.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");T.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");T.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");T.fullyFormedMeasure+=t.formSelectStatement(T);break;}}else{T.criticalHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","FIXED");T.criticalLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","FIXED");T.warningHighValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","FIXED");T.warningLowValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","FIXED");T.targetValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","FIXED");T.trendValue=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","FIXED");}return T;}catch(e){t.logError(e);}},getTrendIndicator:function(t,v){var a=this;t=Number(t);try{var b=sap.m.DeviationIndicator.None;if(t>v){b=sap.m.DeviationIndicator.Down;}else if(t<v){b=sap.m.DeviationIndicator.Up;}return b;}catch(e){a.logError(e);}},getTile:function(){return this.oDualTrendView.oGenericTile;},getTrendColor:function(t){var a=this;try{var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var r=sap.m.ValueColor.Neutral;if(i==="MI"){if(t.criticalHighValue&&t.warningHighValue){t.criticalHighValue=Number(t.criticalHighValue);t.warningHighValue=Number(t.warningHighValue);if(this.CALCULATED_KPI_VALUE<t.warningHighValue){r=sap.m.ValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=t.criticalHighValue){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Error;}}}else if(i==="MA"){if(t.criticalLowValue&&t.warningLowValue){t.criticalLowValue=Number(t.criticalLowValue);t.warningLowValue=Number(t.warningLowValue);if(this.CALCULATED_KPI_VALUE<t.criticalLowValue){r=sap.m.ValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=t.warningLowValue){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Good;}}}else{if(t.warningLowValue&&t.warningHighValue&&t.criticalLowValue&&t.criticalHighValue){t.criticalHighValue=Number(t.criticalHighValue);t.warningHighValue=Number(t.warningHighValue);t.warningLowValue=Number(t.warningLowValue);t.criticalLowValue=Number(t.criticalLowValue);if(this.CALCULATED_KPI_VALUE<t.criticalLowValue||this.CALCULATED_KPI_VALUE>t.criticalHighValue){r=sap.m.ValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=t.criticalLowValue&&this.CALCULATED_KPI_VALUE<=t.warningLowValue)||(this.CALCULATED_KPI_VALUE>=t.warningHighValue&&this.CALCULATED_KPI_VALUE<=t.criticalHighValue)){r=sap.m.ValueColor.Critical;}else{r=sap.m.ValueColor.Good;}}}return r;}catch(e){a.logError(e);}},_updateTileModel:function(n){var m=this.getTile().getModel().getData();jQuery.extend(m,n);this.getTile().getModel().setData(m);},onAfterFinalEvaluation:function(){var t=this;var u=this.DEFINITION_DATA.EVALUATION.ODATA_URL;var E=this.DEFINITION_DATA.EVALUATION.ODATA_ENTITYSET;var m=this.DEFINITION_DATA.EVALUATION.COLUMN_NAME;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.DEFINITION_DATA.EVALUATION_FILTERS,this.DEFINITION_DATA.ADDITIONAL_FILTERS);var d=this.DEFINITION_DATA.TILE_PROPERTIES.dimension;if(d==undefined){this.logError();return;}var g=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var c=this.DEFINITION_DATA.EVALUATION_VALUES;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var f=m;switch(g){case"MI":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningHigh&&t.sCriticalHigh&&t.sTarget){f+=","+t.sWarningHigh+","+t.sCriticalHigh+","+t.sTarget;}break;case"MA":t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget){f+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget;}break;case"RA":t.sWarningHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WH","MEASURE");t.sCriticalHigh=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CH","MEASURE");t.sTarget=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TA","MEASURE");t.sTrend=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"TC","MEASURE");t.sWarningLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"WL","MEASURE");t.sCriticalLow=sap.ushell.components.tiles.indicatorTileUtils.util.getEvalValueMeasureName(t.oConfig,"CL","MEASURE");if(t.sWarningLow&&t.sCriticalLow&&t.sTarget&&t.sWarningHigh&&t.sCriticalHigh){f+=","+t.sWarningLow+","+t.sCriticalLow+","+t.sTarget+","+t.sWarningHigh+","+t.sCriticalHigh;}break;}var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,f,d,v);}else{var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,m,d,v);}var h=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(!h){if(q){this.queryUriForTrendChart=q.uri;t.writeData={};try{this.trendChartODataReadRef=q.model.read(q.uri,null,null,true,function(a){if(a&&a.results&&a.results.length){if(q.unit[0]){t.unit=a.results[0][q.unit[0].name];t.writeData.unit=q.unit[0];t.writeData.unit.name=q.unit[0].name;}t.queryUriResponseForTrendChart=a;d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oTileApi.url.addSystemToServiceUrl(u),E,d);a.firstXlabel=a.results[0][d];a.lastXlabel=a.results[a.results.length-1][d];t.writeData.data=a;t.writeData.dimensionName=d;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,t.writeData);var n=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);t.oDualTrendView.oGenericTile.$().wrap("<a href ='"+n+"'/>");t.oDualTrendView.oGenericTile.setState(sap.m.LoadState.Loaded);_(a,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);}else{t.logError("no Response from QueryServiceUri");}},function(a){if(a&&a.response){t.logError("Data call failed");}});}catch(e){t.logError(e);}}else{t.logError();}var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(t.DEFINITION_DATA.EVALUATION_FILTERS,t.DEFINITION_DATA.ADDITIONAL_FILTERS);var q=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oTileApi.url.addSystemToServiceUrl(u),E,m,null,v);if(q){t.QUERY_SERVICE_MODEL=q.model;t.queryUriForKpiValue=q.uri;t.numericODataReadRef=t.QUERY_SERVICE_MODEL.read(q.uri,null,null,true,function(a){if(a&&a.results&&a.results.length){var s="";var j=a.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];t.writeData.numericData=a;if(t.oConfig.EVALUATION.SCALING==-2){j*=100;}s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(j),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){t._updateTileModel({scale:"%"});}var k=t.getTrendIndicator(t.setThresholdValues().trendValue,j);t._updateTileModel({value:s.toString(),valueColor:t.getTrendColor(t.setThresholdValues()),indicator:k});}else{fnError.call(t,"no Response from QueryServiceUri");}});}}else{try{if(h.unit!==undefined){t.unit=h.data.results[0][h.unit.name];}t.queryUriResponseForTrendChart=h.data;d=h.dimensionName;var j=h.numericData.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME];var k=t.getTrendIndicator(t.setThresholdValues().trendValue,h.data.results[0][t.DEFINITION_DATA.EVALUATION.COLUMN_NAME]);var s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(j),t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);t.oDualTrendView.oGenericTile.setState(sap.m.LoadState.Loaded);_(h.data,t.DEFINITION_DATA.EVALUATION.VALUES_SOURCE);t._updateTileModel({value:s.toString(),valueColor:t.getTrendColor(t.setThresholdValues()),indicator:k});}catch(e){t.logError(e);}}function _(l,n){var o=[];var p=[];var w=[];var r=[];var x=[];var y=[];var z=l.firstXlabel;var A,B,C,D,F;var G=l.lastXlabel;var H=Number(l.results[0][m]);var I=Number(l.results[l.results.length-1][m]);var i;for(i in l.results){l.results[i][d]=Number(i);l.results[i][m]=Number(l.results[i][m]);t.sWarningHigh?l.results[i][t.sWarningHigh]=Number(l.results[i][t.sWarningHigh]):"";t.sCriticalHigh?l.results[i][t.sCriticalHigh]=Number(l.results[i][t.sCriticalHigh]):"";t.sCriticalLow?l.results[i][t.sCriticalLow]=Number(l.results[i][t.sCriticalLow]):"";t.sWarningLow?l.results[i][t.sWarningLow]=Number(l.results[i][t.sWarningLow]):"";t.sTarget?l.results[i][t.sTarget]=Number(l.results[i][t.sTarget]):"";t.sWarningHigh?w.push(l.results[i][t.sWarningHigh]):"";t.sCriticalHigh?r.push(l.results[i][t.sCriticalHigh]):"";t.sCriticalLow?x.push(l.results[i][t.sCriticalLow]):"";t.sWarningLow?y.push(l.results[i][t.sWarningLow]):"";o.push(l.results[i][d]);p.push(l.results[i][m]);}try{z=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(z);G=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(G);}catch(e){t.logError(e);}var J=Number(H);if(t.oConfig.EVALUATION.SCALING==-2){J*=100;}var K=Math.min.apply(Math,p);var L=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(J,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){L+=" %";}var M=L.toString();var N=Number(I);if(t.oConfig.EVALUATION.SCALING==-2){N*=100;}var O=Math.max.apply(Math,p);var P=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(N,t.oConfig.EVALUATION.SCALING,t.oConfig.EVALUATION.DECIMAL_PRECISION);if(t.oConfig.EVALUATION.SCALING==-2){P+=" %";}var Q=P.toString();try{var R=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.min.apply(Math,o));var S=sap.ushell.components.tiles.indicatorTileUtils.util.formatOdataObjectToString(Math.max.apply(Math,o));}catch(e){t.logError(e);}if(n=="MEASURE"){(w.length!=0)?(t.firstwH=w[R])&&(t.lastwH=w[S]):"";(r.length!=0)?(t.firstcH=r[R])&&(t.lastcH=r[S]):"";(x.length!=0)?(t.firstcL=x[R])&&(t.lastcL=x[S]):"";(y.length!=0)?(t.firstwL=y[R])&&(t.lastwL=y[S]):"";}var T={width:"100%",height:"100%",unit:t.unit||"",chart:{color:"Neutral",data:l.results},size:"Auto",minXValue:R,maxXValue:S,minYValue:K,maxYValue:O,firstXLabel:{label:z+"",color:"Neutral"},lastXLabel:{label:G+"",color:"Neutral"},firstYLabel:{label:M+"",color:"Neutral"},lastYLabel:{label:Q+"",color:"Neutral"},minLabel:{},maxLabel:{}};switch(g){case"MA":for(i in c){if(c[i].TYPE=="CL"){T.minThreshold={color:"Error"};var U={};U[d]="";U[m]=Number(c[i].FIXED);t.cl=Number(c[i].FIXED);T.minThreshold.data=(n=="MEASURE")?l.results:[U];A=(n=="MEASURE")?t.sCriticalLow:m;}else if(c[i].TYPE=="WL"){T.maxThreshold={color:"Good"};var U={};U[d]="";U[m]=Number(c[i].FIXED);T.maxThreshold.data=(n=="MEASURE")?l.results:[U];B=(n=="MEASURE")?t.sWarningLow:m;t.wl=Number(c[i].FIXED);}else if(c[i].TYPE=="TA"){var U={};U[d]="";U[m]=Number(c[i].FIXED);T.target={color:"Neutral"};T.target.data=(n=="MEASURE")?l.results:[U];F=(n=="MEASURE")?t.sTarget:m;}}T.innerMinThreshold={data:[]};T.innerMaxThreshold={data:[]};if(n=="FIXED"){T.firstYLabel.color=H<t.cl?"Error":((t.cl<=H)&&(H<=t.wl))?"Critical":(H>t.wl)?"Good":"Neutral";T.lastYLabel.color=I<t.cl?"Error":((t.cl<=I)&&(I<=t.wl))?"Critical":(I>t.wl)?"Good":"Neutral";}else if(n=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL){T.firstYLabel.color=H<t.firstcL?"Error":((t.firstcL<=H)&&(H<=t.firstwL))?"Critical":(H>t.firstwL)?"Good":"Neutral";T.lastYLabel.color=I<t.lastcL?"Error":((t.lastcL<=I)&&(I<=t.lastwL))?"Critical":(I>t.lastwL)?"Good":"Neutral";}break;case"MI":for(i in c){if(c[i].TYPE=="CH"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.ch=Number(c[i].FIXED);T.maxThreshold={color:"Error"};T.maxThreshold.data=(n=="MEASURE")?l.results:[U];B=(n=="MEASURE")?t.sCriticalHigh:m;}else if(c[i].TYPE=="WH"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.wh=Number(c[i].FIXED);T.minThreshold={color:"Good"};T.minThreshold.data=(n=="MEASURE")?l.results:[U];A=(n=="MEASURE")?t.sWarningHigh:m;}else if(c[i].TYPE=="TA"){var U={};U[d]="";U[m]=Number(c[i].FIXED);T.target={color:"Neutral"};T.target.data=(n=="MEASURE")?l.results:[U];F=(n=="MEASURE")?t.sTarget:m;}}if(n=="FIXED"){T.firstYLabel.color=H>t.ch?"Error":((t.wh<=H)&&(H<=t.ch))?"Critical":(H<t.wh)?"Good":"Neutral";T.lastYLabel.color=I>t.ch?"Error":((t.wh<=I)&&(I<=t.ch))?"Critical":(I<t.wh)?"Good":"Neutral";}else if(n=="MEASURE"&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){T.firstYLabel.color=H>t.firstcH?"Error":((t.firstwH<=H)&&(H<=t.firstcH))?"Critical":(H<t.firstwH)?"Good":"Neutral";T.lastYLabel.color=I>t.lastcH?"Error":((t.lastwH<=I)&&(I<=t.lastcH))?"Critical":(I<t.lastwH)?"Good":"Neutral";}T.innerMaxThreshold={data:[]};T.innerMinThreshold={data:[]};break;case"RA":for(i in c){if(c[i].TYPE=="CH"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.ch=Number(c[i].FIXED);T.maxThreshold={color:"Error"};T.maxThreshold.data=(n=="MEASURE")?l.results:[U];B=(n=="MEASURE")?t.sCriticalHigh:m;}else if(c[i].TYPE=="WH"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.wh=Number(c[i].FIXED);T.innerMaxThreshold={color:"Good"};T.innerMaxThreshold.data=(n=="MEASURE")?l.results:[U];D=(n=="MEASURE")?t.sWarningHigh:m;}else if(c[i].TYPE=="WL"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.wl=Number(c[i].FIXED);T.innerMinThreshold={color:"Good"};T.innerMinThreshold.data=(n=="MEASURE")?l.results:[U];C=(n=="MEASURE")?t.sWarningLow:m;}else if(c[i].TYPE=="CL"){var U={};U[d]="";U[m]=Number(c[i].FIXED);t.cl=Number(c[i].FIXED);T.minThreshold={color:"Error"};T.minThreshold.data=(n=="MEASURE")?l.results:[U];A=(n=="MEASURE")?t.sCriticalLow:m;}else if(c[i].TYPE=="TA"){var U={};U[d]="";U[m]=Number(c[i].FIXED);T.target={color:"Neutral"};T.target.data=(n=="MEASURE")?l.results:[U];F=(n=="MEASURE")?t.sTarget:m;}}if(n=="FIXED"){T.firstYLabel.color=(H>t.ch||H<t.cl)?"Error":((t.wh<=H)&&(H<=t.ch))||((t.cl<=H)&&(H<=t.wl))?"Critical":((H>=t.wl)&&(H<=t.wh))?"Good":"Neutral";T.lastYLabel.color=(I>t.ch||I<t.cl)?"Error":((t.wh<=I)&&(I<=t.ch))||((t.cl<=I)&&(I<=t.wl))?"Critical":((I>=t.wl)&&(I<=t.wh))?"Good":"Neutral";}else if(n=="MEASURE"&&t.firstwL&&t.lastwL&&t.firstcL&&t.lastcL&&t.firstwH&&t.lastwH&&t.firstcH&&t.lastcH){T.firstYLabel.color=(H>t.firstcH||H<t.firstcL)?"Error":((t.firstwH<=H)&&(H<=t.firstcH))||((t.firstcL<=H)&&(H<=t.firstwL))?"Critical":((H>=t.firstwL)&&(H<=t.firstwH))?"Good":"Neutral";T.lastYLabel.color=(I>t.lastcH||I<t.lastcL)?"Error":((t.lastwH<=I)&&(I<=t.lastcH))||((t.lastcL<=I)&&(I<=t.lastwL))?"Critical":((I>=t.lastwL)&&(I<=t.lastwH))?"Good":"Neutral";}break;}var V=function(W,a,b,n){return new sap.suite.ui.microchart.AreaMicroChartItem({color:"{/"+W+"/color}",points:{path:"/"+W+"/data",template:new sap.suite.ui.microchart.AreaMicroChartPoint({x:"{"+a+"}",y:"{"+b+"}"})}});};t.getTile().getTileContent()[1].getContent().setTarget(V("target",d,F));t.getTile().getTileContent()[1].getContent().setInnerMinThreshold(V("innerMinThreshold",d,C));t.getTile().getTileContent()[1].getContent().setInnerMaxThreshold(V("innerMaxThreshold",d,D));t.getTile().getTileContent()[1].getContent().setMinThreshold(V("minThreshold",d,A));t.getTile().getTileContent()[1].getContent().setMaxThreshold(V("maxThreshold",d,B));t.getTile().getTileContent()[1].getContent().setChart(V("chart",d,m));t._updateTileModel(T);}},flowWithoutDesignTimeCall:function(){this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);if(this.oTileApi.visible.isVisible()&&!this.firstTimeVisible){this.firstTimeVisible=true;}this.onAfterFinalEvaluation();},flowWithDesignTimeCall:function(){var t=this;try{var a=sap.ushell.components.tiles.indicatorTileUtils.cache.getEvaluationById(this.oConfig.EVALUATION.ID);if(a){t.oConfig.EVALUATION_FILTERS=a.EVALUATION_FILTERS;t.flowWithoutDesignTimeCall();}else{sap.ushell.components.tiles.indicatorTileUtils.util.getFilterFromRunTimeService(this.oConfig,function(f){t.oConfig.EVALUATION_FILTERS=f;sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();});}}catch(e){this.logError(e);}},refreshHandler:function(c){if(!c.firstTimeVisible){if(Number(this.oTileApi.configuration.getParameterValueAsString("isSufficient"))){c.flowWithoutDesignTimeCall();}else{c.flowWithDesignTimeCall();}}},visibleHandler:function(i){if(!i){this.firstTimeVisible=false;sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);}if(i){this.refreshHandler(this);}},setTextInTile:function(){var t=this;this._updateTileModel({header:t.oTileApi.preview.getTitle()||sap.ushell.components.tiles.indicatorTileUtils.util.getChipTitle(t.oConfig),subheader:t.oTileApi.preview.getDescription()||sap.ushell.components.tiles.indicatorTileUtils.util.getChipSubTitle(t.oConfig)});},onInit:function(){var t=this;this.firstTimeVisible=false;this.oDualTrendView=this.getView();this.oViewData=this.oDualTrendView.getViewData();this.oTileApi=this.oViewData.chip;if(this.oTileApi.visible){this.oTileApi.visible.attachVisible(this.visibleHandler.bind(this));}this.system=this.oTileApi.url.getApplicationSystem();this.oDualTrendView.oGenericTile.setState(sap.m.LoadState.Loading);if(this.oTileApi.preview.isEnabled()){this.setTextInTile();this._updateTileModel({value:8888,size:sap.m.Size.Auto,frameType:"TwoByOne",state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Error,indicator:sap.m.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",width:"100%",height:"100%",chart:{color:"Good",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:20},{day:100,balance:80}]},target:{color:"Error",data:[{day:0,balance:0},{day:30,balance:30},{day:60,balance:40},{day:100,balance:90}]},maxThreshold:{color:"Good",data:[{day:0,balance:0},{day:30,balance:40},{day:60,balance:50},{day:100,balance:100}]},innerMaxThreshold:{color:"Error",data:[]},innerMinThreshold:{color:"Neutral",data:[]},minThreshold:{color:"Error",data:[{day:0,balance:0},{day:30,balance:20},{day:60,balance:30},{day:100,balance:70}]},minXValue:0,maxXValue:100,minYValue:0,maxYValue:100,firstXLabel:{label:"June 123",color:"Error"},lastXLabel:{label:"June 30",color:"Error"},firstYLabel:{label:"0M",color:"Good"},lastYLabel:{label:"80M",color:"Critical"},minLabel:{},maxLabel:{}});this.oDualTrendView.oGenericTile.setState(sap.m.LoadState.Loaded);}else{try{sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(this.oTileApi.configuration.getParameterValueAsString("tileConfiguration"),function(c){t.oConfig=c;t.setTextInTile();t.oDualTrendView.oGenericTile.attachPress(function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(t.trendChartODataReadRef);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,null);window.location.hash=sap.ushell.components.tiles.indicatorTileUtils.util.getNavigationTarget(t.oConfig,t.system);});if(Number(t.oTileApi.configuration.getParameterValueAsString("isSufficient"))){sap.ushell.components.tiles.indicatorTileUtils.cache.setEvaluationById(t.oConfig.TILE_PROPERTIES.id,t.oConfig);t.flowWithoutDesignTimeCall();}else{t.flowWithDesignTimeCall();}});}catch(e){this.logError(e);}}},_setLocalModelToTile:function(){if(!this.getTile().getModel()){this.getTile().setModel(new sap.ui.model.json.JSONModel({}));}},onExit:function(){sap.ushell.components.tiles.indicatorTileUtils.util.abortPendingODataCalls(this.trendChartODataReadRef);}});return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorTileUtils/cache',[],function(){"use strict";var B={};var K={};var s="HANA_CLIENT";return{getCacheHanaClient:function(){return B[s];},setCacheHanaClient:function(d){B[s]=d;},getEvaluationByChipId:function(k){if(B[k]){return B[k];}return null;},getEvaluationById:function(k){return this.getEvaluationByChipId(k);},setEvaluationById:function(k,d){B[k]=d;},getFrontEndCacheDeferredObject:function(k){if(B[k]){return B[k];}return null;},setFrontEndCacheDefferedObject:function(k,d){B[k]=d;},getKpivalueById:function(k){if(K[k]){return K[k];}return null;},setKpivalueById:function(k,d){K[k]=d;}};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorTileUtils/oData4Analytics',['sap/ui/core/Core'],function(C){"use strict";sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles.indicatorTileUtils=sap.ushell.components.tiles.indicatorTileUtils||{};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics||{};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants={};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants["SAP_NAMESPACE"]="http://www.sap.com/Protocols/SAPData";sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants["VERSION"]="0.7";sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper={renderPropertyKeyValue:function(f,p){if(f.charAt(0)=="'"){throw"Illegal property value starting with a quote";}switch(p){case'Edm.String':return"'"+f+"'";case'Edm.DateTime':return"datetime'"+f+"'";case'Edm.Guid':return"guid'"+f+"'";case'Edm.Time':return"time'"+f+"'";case'Edm.DateTimeOffset':return"datetimeoffset'"+f+"'";default:return f;}},renderPropertyFilterValue:function(f,p){if(f.charAt(0)=="'"){throw"Illegal property value starting with a quote";}switch(p){case'Edm.String':return"'"+f+"'";case'Edm.DateTime':return"datetime'"+f+"'";case'Edm.Guid':return"guid'"+f+"'";case'Edm.Time':return"time'"+f+"'";case'Edm.DateTimeOffset':return"datetimeoffset'"+f+"'";default:return f;}},tokenizeNametoLabelText:function(n){var l="";l=n.replace(/([^A-Z0-9_]+)([A-Z0-9_])/g,"$1 $2");l=l.replace(/([A-Z0-9_]{2,})([A-Z0-9_])([^A-Z0-9_]+)/g,"$1 $2$3");l=l.replace(/(.*) _E$/,"$1");l=l.replace(/(.*) _(.*)/g,"$1 $2");return l;}};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model=function(m,a){this._init(m,a);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceByURI=function(u){return{sServiceURI:u};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceByModel=function(m){return{oModel:m};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.ReferenceWithWorkaround=function(m,w){return{oModelReference:m,aWorkaroundID:w};};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Model.prototype={_init:function(m,a){this._oActivatedWorkarounds={};if(m&&m.aWorkaroundID){var w=m.aWorkaroundID;for(var i=0;i<w.length;i++){this._oActivatedWorkarounds[w[i]]=true;}m=m.oModelReference;}if(!m||(!m.sServiceURI&&!m.oModel)){throw"Usage with oModelReference being an instance of Model.ReferenceByURI or Model.ReferenceByModel";}if(m.oModel){this._oModel=m.oModel;}else{this._oModel=new sap.ui.model.odata.ODataModel(m.sServiceURI);}if(this._oModel.getServiceMetadata().dataServices==undefined){throw"Model could not be loaded";}this.mergeV2Annotations(a);this._oQueryResultSet={};this._oParameterizationSet={};this._oEntityTypeSet={};this._oEntitySetSet={};this._oEntityTypeNameToEntitySetMap={};var s=this._oModel.getServiceMetadata().dataServices.schema[0];for(var i=-1,c;c=s.entityContainer[++i];){if(c.isDefaultEntityContainer=="true"){this._oDefaultEntityContainer=c;break;}}var e=s.entityType;var q=[],p=[],u=[];for(var i=-1,t;t=e[++i];){var P=false;if(t.extensions!=undefined){for(var j=-1,E;E=t.extensions[++j];){if(E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE&&E.name=="semantics"){P=true;switch(E.value){case"aggregate":q.push(t);break;case"parameters":p.push(t);break;default:u.push(t);}}if(P){continue;}}if(!P){u.push(t);}}else{u.push(t);}}for(var i=-1,t;t=u[++i];){var o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;var b=this._getEntitySetsOfType(s,o.getQName());if(b.length==0){throw"Invalid consumption model: No entity set for entity type annotated with parameters semantics";}if(b.length>1){throw"Unsupported consumption model: More than one entity set for entity type annotated with parameters semantics";}var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;}var f={};for(var i=-1,t;t=p[++i];){var o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;var b=this._getEntitySetsOfType(s,o.getQName());if(b.length==0){throw"Invalid consumption model: No entity set for entity type annotated with parameters semantics";}if(b.length>1){throw"Unsupported consumption model: More than one entity set for entity type annotated with parameters semantics";}var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;var g=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization(o,d);this._oParameterizationSet[g.getName()]=g;f[o.getQName()]=g;var h=o.getQName();if(s.association!=undefined){for(var j=-1,A;A=s.association[++j];){if(A.referentialConstraint==undefined){continue;}var k=null;if(A.end[0].type==h&&A.end[0].multiplicity=="*"&&A.end[1].multiplicity=="1"){k=A.end[1].type;}else if(A.end[1].type==h&&A.end[1].multiplicity=="*"&&A.end[0].multiplicity=="1"){k=A.end[0].type;}if(!k){continue;}if(A.referentialConstraint.dependent.propertyRef.length!=1){continue;}var l=g.findParameterByName(A.referentialConstraint.dependent.propertyRef[0].name);if(l==null){continue;}var v=this._oEntityTypeSet[k];var V=this._oEntityTypeNameToEntitySetMap[k];l.setValueSetEntity(v,V);}}}for(var i=-1,t;t=q[++i];){var o=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType(this._oModel.getServiceMetadata(),s,t);this._oEntityTypeSet[o.getQName()]=o;var Q=o.getQName();var g=null;var n=null;if(s.association!=undefined){for(var j=-1,A;A=s.association[++j];){var r=null;if(A.end[0].type==Q){r=A.end[1].type;}else if(A.end[1].type==Q){r=A.end[0].type;}else{continue;}var M=null;M=f[r];if(M!=null){if(g!=null){throw"LIMITATION: Unable to handle multiple parameter entity types of query entity "+o.name;}else{g=M;n=A;}}}}var b=this._getEntitySetsOfType(s,o.getQName());if(b.length!=1){throw"Invalid consumption model: There must be exactly one entity set for an entity type annotated with aggregating semantics";}var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet(this._oModel.getServiceMetadata(),s,b[0][0],b[0][1]);this._oEntitySetSet[d.getQName()]=d;this._oEntityTypeNameToEntitySetMap[o.getQName()]=d;var x=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult(this,o,d,g);this._oQueryResultSet[x.getName()]=x;if(g){g.setTargetQueryResult(x,n);}}},oUI5ODataModelAnnotatableObject:{objectName:"schema",keyPropName:"namespace",extensions:true,aSubObject:[{objectName:"entityType",keyPropName:"name",extensions:true,aSubObject:[{objectName:"property",keyPropName:"name",aSubObject:[],extensions:true}]},{objectName:"entityContainer",keyPropName:"name",extensions:false,aSubObject:[{objectName:"entitySet",keyPropName:"name",extensions:true,aSubObject:[]}]}]},mergeV2Annotations:function(a){try{var A=JSON.parse(a);}catch(e){return;}var m;try{m=this._oModel.getServiceMetadata().dataServices;}catch(e){return;}for(var p in A){if(!(this.oUI5ODataModelAnnotatableObject.objectName==p)){continue;}if(!(A[p]instanceof Array)){continue;}this.mergeV2AnnotationLevel(m[this.oUI5ODataModelAnnotatableObject.objectName],A[this.oUI5ODataModelAnnotatableObject.objectName],this.oUI5ODataModelAnnotatableObject);break;}return;},mergeV2AnnotationLevel:function(M,a,u){for(var i=-1,A;A=a[++i];){for(var j=-1,o;o=M[++j];){if(!(A[u.keyPropName]==o[u.keyPropName])){continue;}if(A["extensions"]!=undefined){if(o["extensions"]==undefined){o["extensions"]=[];}for(var l=-1,b;b=A["extensions"][++l];){var f=false;for(var m=-1,c;c=o["extensions"][++m];){if(b.name==c.name&&b.namespace==c.namespace){c.value=b.value;f=true;break;}}if(!f){o["extensions"].push(b);}}}for(var k=-1,U;U=u.aSubObject[++k];){for(var p in A){if(!(U.objectName==p)){continue;}if(!(A[U.objectName]instanceof Array)){continue;}if((o[U.objectName]==undefined)||(!(o[U.objectName]instanceof Array))){continue;}this.mergeV2AnnotationLevel(o[U.objectName],A[U.objectName],U);break;}}}}return;},findQueryResultByName:function(n){var q=this._oQueryResultSet[n];if(!q&&this._oDefaultEntityContainer){var Q=this._oDefaultEntityContainer.name+"."+n;q=this._oQueryResultSet[Q];}return q;},getAllQueryResultNames:function(){if(this._aQueryResultNames){return this._aQueryResultNames;}this._aQueryResultNames=new Array(0);for(var n in this._oQueryResultSet)this._aQueryResultNames.push(this._oQueryResultSet[n].getName());return this._aQueryResultNames;},getAllQueryResults:function(){return this._oQueryResultSet;},getODataModel:function(){return this._oModel;},_getEntitySetsOfType:function(s,q){var e=[];for(var i=-1,E;E=s.entityContainer[++i];){for(var j=-1,o;o=E.entitySet[++j];){if(o.entityType==q){e.push([E,o]);}}}return e;},_oModel:null,_oDefaultEntityContainer:null,_aQueryResultNames:null,_oQueryResultSet:null,_oParameterizationSet:null,_oEntityTypeSet:null,_oEntitySetSet:null,_oEntityTypeNameToEntitySetMap:null,_oActivatedWorkarounds:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult=function(m,e,E,p){this._init(m,e,E,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResult.prototype={_init:function(m,e,E,p,a){this._oModel=m;this._oEntityType=e;this._oEntitySet=E;this._oParameterization=p;this._oDimensionSet={};this._oMeasureSet={};var P=e.getTypeDescription().property;var A={};for(var i=-1,o;o=P[++i];){if(o.extensions==undefined){continue;}for(var j=-1,b;b=o.extensions[++j];){if(!b.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(b.name){case"aggregation-role":switch(b.value){case"dimension":var d=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension(this,o);this._oDimensionSet[d.getName()]=d;break;case"measure":var M=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure(this,o);this._oMeasureSet[M.getName()]=M;break;case"totaled-properties-list":this._oTotaledPropertyListProperty=o;break;}break;case"attribute-for":var D=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute(this,o);A[D.getKeyProperty()]=D;break;}}}for(var s in A){var D=A[s];D.getDimension().addAttribute(D);}if(m._oActivatedWorkarounds.IdentifyTextPropertiesByName){var c=[];for(var f in this._oDimensionSet){var d=this._oDimensionSet[f];if(!d.getTextProperty()){var t=null;t=e.findPropertyByName(f+"Name");if(!t){t=e.findPropertyByName(f+"Text");}if(!t){t=e.findPropertyByName(f+"Desc");}if(!t){t=e.findPropertyByName(f+"Description");}if(t){d.setTextProperty(t);c.push(t.name);}}}for(var i=-1,g;g=c[++i];){delete this._oDimensionSet[g];}}},getName:function(){return this.getEntitySet().getQName();},getParameterization:function(){return this._oParameterization;},getAllDimensionNames:function(){if(this._aDimensionNames){return this._aDimensionNames;}this._aDimensionNames=[];for(var n in this._oDimensionSet)this._aDimensionNames.push(this._oDimensionSet[n].getName());return this._aDimensionNames;},getAllDimensions:function(){return this._oDimensionSet;},getAllMeasureNames:function(){if(this._aMeasureNames){return this._aMeasureNames;}this._aMeasureNames=[];for(var n in this._oMeasureSet)this._aMeasureNames.push(this._oMeasureSet[n].getName());return this._aMeasureNames;},getAllMeasures:function(){return this._oMeasureSet;},findDimensionByName:function(n){return this._oDimensionSet[n];},getTotaledPropertiesListProperty:function(){return this._oTotaledPropertyListProperty;},findMeasureByName:function(n){return this._oMeasureSet[n];},getModel:function(){return this._oModel;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oModel:null,_oEntityType:null,_oEntitySet:null,_oParameterization:null,_aDimensionNames:null,_oDimensionSet:null,_aMeasureNames:null,_oMeasureSet:null,_oTotaledPropertyListProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization=function(e,E){this._init(e,E);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameterization.prototype={_init:function(e,E){this._oEntityType=e;this._oEntitySet=E;this._oParameterSet={};var p=e.getTypeDescription().property;for(var i=-1,P;P=p[++i];){if(P.extensions==undefined){continue;}for(var j=-1,o;o=P.extensions[++j];){if(!o.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(o.name){case"parameter":var a=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter(this,P);this._oParameterSet[a.getName()]=a;break;}}}},setTargetQueryResult:function(q,a){this._oQueryResult=q;var Q=this._oEntityType.getSchema().namespace+"."+a.name;var n=this._oEntityType.getTypeDescription().navigationProperty;if(!n){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}for(var i=-1,N;N=n[++i];){if(N.relationship==Q){this._oNavPropToQueryResult=N.name;}}if(!this._oNavPropToQueryResult){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}},getName:function(){return this.getEntitySet().getQName();},getAllParameterNames:function(){if(this._aParameterNames){return this._aParameterNames;}this._aParameterNames=[];for(var n in this._oParameterSet)this._aParameterNames.push(this._oParameterSet[n].getName());return this._aParameterNames;},getAllParameters:function(){return this._oParameterSet;},findParameterByName:function(n){return this._oParameterSet[n];},getNavigationPropertyToQueryResult:function(){return this._oNavPropToQueryResult;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oEntityType:null,_oEntitySet:null,_oQueryResult:null,_oNavPropToQueryResult:null,_aParameterNames:null,_oParameterSet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter=function(p,P){this._init(p,P);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Parameter.prototype={_init:function(p,P){this._oParameterization=p;this._oProperty=P;var e=p.getEntityType();if(P.extensions!=undefined){for(var i=-1,E;E=P.extensions[++i];){if(!E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(E.name){case"parameter":switch(E.value){case"mandatory":this._bRequired=true;break;case"optional":this._bRequired=false;break;default:throw"Invalid annotation value for parameter property";}break;case"label":this._sLabelText=E.value;break;case"text":this._oTextProperty=e.findPropertyByName(E.value);break;case"upper-boundary":this._bIntervalBoundaryParameter=true;this._oUpperIntervalBoundaryParameterProperty=e.findPropertyByName(E.value);break;case"lower-boundary":this._bIntervalBoundaryParameter=true;this._oLowerIntervalBoundaryParameterProperty=e.findPropertyByName(E.value);break;}}}if(!this._sLabelText){this._sLabelText="";}},setValueSetEntity:function(e,E){this._oValueSetEntityType=e;this._oValueSetEntitySet=E;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},isOptional:function(){return(!this._bRequired);},isIntervalBoundary:function(){return this._bIntervalBoundaryParameter;},isLowerIntervalBoundary:function(){return(this._oUpperIntervalBoundaryParameterProperty?true:false);},getPeerIntervalBoundaryParameter:function(){var p=null;if(this._oLowerIntervalBoundaryParameterProperty){p=this._oLowerIntervalBoundaryParameterProperty.name;}else{p=this._oUpperIntervalBoundaryParameterProperty.name;}if(!p){throw"Parameter is not an interval boundary";}return this._oParameterization.findParameterByName(p);},isValueSetAvailable:function(){return(this._oValueSetEntityType?true:false);},getName:function(){return this._oProperty.name;},getProperty:function(){return this._oProperty;},getContainingParameterization:function(){return this._oParameterization;},getURIToValueEntitySet:function(s){var u=null;u=(s?s:"")+"/"+this._oValueSetEntitySet.getQName();return u;},_oParameterization:null,_oProperty:null,_sLabelText:null,_oTextProperty:null,_bRequired:false,_bIntervalBoundaryParameter:false,_oLowerIntervalBoundaryParameterProperty:null,_oUpperIntervalBoundaryParameterProperty:null,_oValueSetEntityType:null,_oValueSetEntitySet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Dimension.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;this._oAttributeSet={};if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;case"super-ordinate":this._sSuperOrdinatePropertyName=e.value;break;}}}if(!this._sLabelText){this._sLabelText="";}},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){return this._oTextProperty;},setTextProperty:function(t){this._oTextProperty=t;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},getSuperOrdinateDimension:function(){if(!this._sSuperOrdinatePropertyName){return null;}return this._oQueryResult.findDimensionByName(this._sSuperOrdinatePropertyName);},getHierarchy:function(){if(!this._oHierarchy){this._oHierarchy=this._oQueryResult.getEntityType().getHierarchy(this._oProperty.name);}return this._oHierarchy;},getAllAttributeNames:function(){if(this._aAttributeNames){return this._aAttributeNames;}this._aAttributeNames=[];for(var n in this._oAttributeSet)this._aAttributeNames.push(this._oAttributeSet[n].getName());return this._aAttributeNames;},getAllAttributes:function(){return this._oAttributeSet;},findAttributeByName:function(n){return this._oAttributeSet[n];},addAttribute:function(d){this._oAttributeSet[d.getName()]=d;},getContainingQueryResult:function(){return this._oQueryResult;},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sSuperOrdinatePropertyName:null,_aAttributeNames:null,_oAttributeSet:null,_oHierarchy:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionAttribute.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"attribute-for":this._sDimensionName=e.value;break;case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;}}}},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){return this._sLabelText;},getDimension:function(){return this._oQueryResult.findDimensionByName(this._sDimensionName);},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sDimensionName:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure=function(q,p){this._init(q,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.Measure.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,e;e=p.extensions[++i];){if(!e.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(e.name){case"label":this._sLabelText=e.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(e.value);break;case"unit":this._oUnitProperty=q.getEntityType().findPropertyByName(e.value);break;}}}if(!this._sLabelText){this._sLabelText="";}},getName:function(){return this._oProperty.name;},getRawValueProperty:function(){return this._oProperty;},getFormattedValueProperty:function(){return this._oTextProperty;},getUnitProperty:function(){return this._oUnitProperty;},getLabelText:function(){return this._sLabelText;},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_oUnitProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet=function(m,s,c,e){this._init(m,s,c,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntitySet.prototype={_init:function(m,s,c,e){this._oEntitySet=e;this._oContainer=c;this._oSchema=s;this._oModel=m;if(s.entityContainer.length>1){this._sQName=c.name+"."+e.name;}else{this._sQName=e.name;}},getQName:function(){return this._sQName;},getSetDescription:function(){return this._oEntitySet;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntitySet:null,_oContainer:null,_oSchema:null,_oModel:null,_sQName:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.EntityType.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._oPropertySet={};this._aFilterablePropertyNames=[];this._aSortablePropertyNames=[];this._aRequiredFilterPropertyNames=[];this._sQName=s.namespace+"."+e.name;var r={};var R=null;for(var i=-1,p;p=e.property[++i];){this._aFilterablePropertyNames.push(p.name);this._aSortablePropertyNames.push(p.name);if(p.extensions==undefined){continue;}for(var j=-1,E;E=p.extensions[++j];){if(!E.namespace==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.constants.SAP_NAMESPACE){continue;}switch(E.name){case"filterable":if(E.value=="false"){this._aFilterablePropertyNames.pop(p.name);}break;case"sortable":if(E.value=="false"){this._aSortablePropertyNames.pop(p.name);}break;case"required-filter":if(E.value=="true"){this._aRequiredFilterPropertyNames.push(p.name);}break;case"hierarchy-node-for":if(!(R=r[p.name])){R=r[p.name]={};}R.dimensionName=E.value;break;case"hierarchy-parent-node-for":case"hierarchy-parent-nod":if(!(R=r[E.value])){R=r[E.value]={};}R.parentNodeIDProperty=p;break;case"hierarchy-level-for":if(!(R=r[E.value])){R=r[E.value]={};}R.levelProperty=p;break;case"hierarchy-drill-state-for":case"hierarchy-drill-stat":if(!(R=r[E.value])){R=r[E.value]={};}R.drillStateProperty=p;break;}}this._oPropertySet[p.name]=p;}this._oRecursiveHierarchySet={};for(var h in r){var H=r[h];var o=this._oPropertySet[h];var d=this._oPropertySet[H.dimensionName];if(d==null){d=o;}this._oRecursiveHierarchySet[d.name]=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy(e,o,H.parentNodeIDProperty,H.levelProperty,d);}},findPropertyByName:function(n){return this._oPropertySet[n];},getFilterablePropertyNames:function(){return this._aFilterablePropertyNames;},getSortablePropertyNames:function(){return this._aSortablePropertyNames;},getRequiredFilterPropertyNames:function(){return this._aRequiredFilterPropertyNames;},getAllHierarchyPropertyNames:function(){if(this._aHierarchyPropertyNames){return this._aHierarchyPropertyNames;}this._aHierarchyPropertyNames=[];for(var n in this._oRecursiveHierarchySet)this._aHierarchyPropertyNames.push(this._oRecursiveHierarchySet[n].getNodeValueProperty().name);return this._aHierarchyPropertyNames;},getHierarchy:function(n){if(this._oRecursiveHierarchySet[n]==undefined){return null;}return this._oRecursiveHierarchySet[n];},getQName:function(){return this._sQName;},getTypeDescription:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_sQName:null,_oPropertySet:null,_aFilterablePropertyNames:null,_aRequiredFilterPropertyNames:null,_aHierarchyPropertyNames:null,_oRecursiveHierarchySet:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy=function(e,n,p,N,o){this._init(e,n,p,N,o);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.RecursiveHierarchy.prototype={_init:function(e,n,p,N,o){this._oEntityType=e;this._oNodeIDProperty=n;this._oParentNodeIDProperty=p;this._oNodeLevelProperty=N;this._oNodeValueProperty=o;},isRecursiveHierarchy:function(){return true;},isLeveledHierarchy:function(){return false;},getNodeIDProperty:function(){return this._oNodeIDProperty;},getParentNodeIDProperty:function(){return this._oParentNodeIDProperty;},getNodeLevelProperty:function(){return this._oNodeLevelProperty;},getNodeValueProperty:function(){return this._oNodeValueProperty;},_oNodeIDProperty:null,_oParentNodeIDProperty:null,_oNodeLevelProperty:null,_oNodeValueProperty:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._aFilterCondition=[];},clear:function(){this._aFilterCondition=[];},addCondition:function(p,o,v,V){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(f.indexOf(p)===-1){throw"Cannot add filter condition for not filterable property name "+p;}this._aFilterCondition.push({property:P,op:o,val1:v,val2:V});return this._aFilterablePropertyNames;},addSetCondition:function(p,v){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(f.indexOf(p)===-1){throw"Cannot add filter condition for not filterable property name "+p;}for(var i=-1,V;V=v[++i];){this._aFilterCondition.push({property:P,op:sap.ui.model.FilterOperator.EQ,val1:V});}return this._aFilterablePropertyNames;},getExpressionAsUI5FilterArray:function(){var f=[];for(var i=-1,c;c=this._aFilterCondition[++i];){f.push(new sap.ui.model.Filter(c.property.name,c.op,c.val1,c.val2));}return f;},getURIFilterOptionValue:function(){if(this._aFilterCondition.length==0){return"";}this._aFilterCondition.sort(function(a,b){if(a.property.name==b.property.name){return 0;}if(a.property.name>b.property.name){return 1;}else{return-1;}});var p=this._aFilterCondition[0].property.name;var o="";var s="";for(var i=-1,c;c=this._aFilterCondition[++i];){if(p!=c.property.name){o+=(o==""?"":" and ")+"("+s+")";s="";p=c.property.name;}switch(c.op){case sap.ui.model.FilterOperator.BT:s+=(s==""?"":" or ")+"("+c.property.name+" "+sap.ui.model.FilterOperator.GE.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(c.val1,c.property.type)+" and "+c.property.name+" "+sap.ui.model.FilterOperator.LE.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(c.val2,c.property.type)+")";break;default:s+=(s==""?"":" or ")+"("+c.property.name+" "+c.op.toLowerCase()+" "+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyFilterValue(c.val1,c.property.type)+")";}}o+=(o==""?"":" and ")+"("+s+")";return o;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aFilterCondition:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortOrder={Ascending:"asc",Descending:"desc"};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression=function(m,s,e){this._init(m,s,e);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression.prototype={_init:function(m,s,e){this._oEntityType=e;this._oSchema=s;this._oModel=m;this._aSortCondition=[];},_containsSorter:function(p){var r=null;for(var i=-1,c;c=this._aSortCondition[++i];){if(c.property.name===p){r={sorter:c,index:i};break;}}return r;},_removeFromArray:function(a,f,t){var r=a.slice((t||f)+1||a.length);a.length=f<0?a.length+f:f;return a.push.apply(a,r);},clear:function(){this._aSortCondition=[];},addSorter:function(p,s){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add sort condition for unknown property name "+p;}if(this._containsSorter(p)!=null){throw"Sort condition for this property name is already defined "+p;}var S=this._oEntityType.getSortablePropertyNames();if(S.indexOf(p)===-1){throw"Cannot add sort condition for not sortable property name "+p;}this._aSortCondition.push({property:P,order:s});return this;},removeSorter:function(p){if(!p){return;}var s=this._containsSorter(p);if(s){this._removeFromArray(this._aSortCondition,s.index);}},getExpressionsAsUI5SorterArray:function(){var s=[];for(var i=-1,c;c=this._aSortCondition[++i];){s.push(new sap.ui.model.Sorter(c.property.name,c.order==sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortOrder.Descending));}return s;},getExpressionAsUI5Sorter:function(){var s=this.getExpressionsAsUI5SorterArray();if(s.length==0){return null;}else{return s[0];}},getURIOrderByOptionValue:function(){if(this._aSortCondition.length==0){return"";}var o="";for(var i=-1,c;c=this._aSortCondition[++i];){o+=c.property.name+" "+c.order;if(i<this._aSortCondition.length-1){o+=", ";}}return o;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aSortCondition:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterizationRequest=function(p){this._init(p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterizationRequest.prototype={_init:function(p){if(!p){throw"No parameterization given";}this._oParameterization=p;this._oParameterValueAssignment=[];},getParameterization:function(){return this._oParameterization;},setParameterValue:function(p,v,t){var P=this._oParameterization.findParameterByName(p);if(!P){throw"Invalid parameter name "+p;}if(t!=null){if(!P.isIntervalBoundary()){throw"Range value cannot be applied to parameter "+p+" accepting only single values";}if(!P.isLowerIntervalBoundary()){throw"Range value given, but parameter "+p+" does not hold the lower boundary";}}if(!P.isIntervalBoundary()){if(v==null){delete this._oParameterValueAssignment[p];}else{this._oParameterValueAssignment[p]=v;}}else{if(v==null&&t!=null){throw"Parameter "+p+": An upper boundary cannot be given without the lower boundary";}if(v==null){delete this._oParameterValueAssignment[p];t=null;}else{this._oParameterValueAssignment[p]=v;}var u=P.getPeerIntervalBoundaryParameter();if(t==null){t=v;}if(v==null){delete this._oParameterValueAssignment[u.getName()];}else{this._oParameterValueAssignment[u.getName()]=t;}}return;},getURIToParameterizationEntitySet:function(s){return(s?s:"")+"/"+this._oParameterization.getEntitySet().getQName();},getURIToParameterizationEntry:function(s){var d=this._oParameterization.getAllParameters();for(var D in d){if(this._oParameterValueAssignment[D]==undefined){throw"Parameter "+D+" has no value assigned";}}var k="",f=true;for(var p in this._oParameterValueAssignment){k+=(f?"":",")+p+"="+sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.helper.renderPropertyKeyValue(this._oParameterValueAssignment[p],d[p].getProperty().type);f=false;}return(s?s:"")+"/"+this._oParameterization.getEntitySet().getQName()+"("+k+")";},_oParameterization:null,_oParameterValueAssignment:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResultRequest=function(q,p){this._init(q);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.QueryResultRequest.prototype={_init:function(q,p){this._oQueryResult=q;this._oParameterizationRequest=p;this._oAggregationLevel={};this._oMeasures={};this._bIncludeEntityKey=false;this._oFilterExpression=null;},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},getQueryResult:function(){return this._oQueryResult;},setAggregationLevel:function(d){this._oAggregationLevel={};if(!d){d=this._oQueryResult.getAllDimensionNames();}this.addToAggregationLevel(d);},addToAggregationLevel:function(d){if(!d){return;}for(var i=-1,D;D=d[++i];){if(!this._oQueryResult.findDimensionByName(D)){throw D+" is not a valid dimension name";}this._oAggregationLevel[D]={key:true,text:false,attributes:null};}},removeFromAggregationLevel:function(d){if(!d){return;}for(var i=-1,D;D=d[++i];){if(!this._oQueryResult.findDimensionByName(D)){throw D+" is not a valid dimension name";}if(this._oAggregationLevel[D]!=undefined){delete this._oAggregationLevel[D];this.getSortExpression().removeSorter(D);}}},getAggregationLevel:function(){var d=[];for(var D in this._oAggregationLevel){d.push(D);}return d;},getAggregationLevelDetails:function(d){if(this._oAggregationLevel[d]==undefined){throw"Aggregation level does not include dimension "+d;}return this._oAggregationLevel[d];},setMeasures:function(m){if(!m){m=this._oQueryResult.getAllMeasureNames();}this._oMeasures={};for(var i=-1,M;M=m[++i];){if(!this._oQueryResult.findMeasureByName(M)){throw M+" is not a valid measure name";}this._oMeasures[M]={value:true,text:false,unit:false};}},getMeasureNames:function(){var m=[];for(var M in this._oMeasures){m.push(M);}return m;},includeDimensionKeyTextAttributes:function(d,I,b,a){var D=[];if(d){if(this._oAggregationLevel[d]==undefined){throw d+" is not included in the aggregation level";}D.push(d);}else{for(var n in this._oAggregationLevel){D.push(n);}a=null;}for(var i=-1,s;s=D[++i];){if(I!=null){this._oAggregationLevel[s].key=I;}if(b!=null){this._oAggregationLevel[s].text=b;}if(a!=null){this._oAggregationLevel[s].attributes=a;}}},includeMeasureRawFormattedValueUnit:function(m,I,b,a){var M=[];if(m){if(this._oMeasures[m]==undefined){throw m+" is not part of the query result";}M.push(m);}else{for(var n in this._oMeasures){M.push(n);}}for(var i=-1,s;s=M[++i];){if(I!=null){this._oMeasures[s].value=I;}if(b!=null){this._oMeasures[s].text=b;}if(a!=null){this._oMeasures[s].unit=a;}}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oQueryResult.getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},setRequestOptions:function(i,I){if(i){this._bIncludeEntityKey=i;}if(I){this._bIncludeCount=I;}},setResultPageBoundaries:function(s,e){if(s!=null&&typeof s!=="number"){throw"Start value must be null or numeric";}if(e!==null&&typeof e!=="number"){throw"End value must be null or numeric";}if(s==null){s=1;}if(s<1||s>(e==null?s:e)){throw"Invalid values for requested page boundaries";}this._iSkipRequestOption=(s>1)?s:null;this._iTopRequestOption=(e!=null)?(e-s+1):null;},getResultPageBoundaries:function(){return{start:(this._iSkipRequestOption==null)?1:this._iSkipRequestOption,end:(this._iTopRequestOption!=null)?(this._iSkipRequestOption==null)?1:this._iSkipRequestOption+this._iTopRequestOption:null};},getURIToQueryResultEntitySet:function(s){var u=null;if(this._oQueryResult.getParameterization()){if(!this._oParameterizationRequest){throw"Missing parameterization request";}else{u=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oQueryResult.getParameterization().getNavigationPropertyToQueryResult();}}else{u=(s?s:"")+"/"+this._oQueryResult.getEntitySet().getQName();}return u;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";for(var d in this._oAggregationLevel){var D=this._oQueryResult.findDimensionByName(d);var o=this._oAggregationLevel[d];if(o.key==true){s+=(s==""?"":",")+D.getKeyProperty().name;}if(o.text==true&&D.getTextProperty()){s+=(s==""?"":",")+D.getTextProperty().name;}if(o.attributes){for(var i=-1,a;a=o.attributes[++i];){s+=(s==""?"":",")+D.findAttributeByName(a).getName();}}}for(var m in this._oMeasures){var M=this._oQueryResult.findMeasureByName(m);var b=this._oMeasures[m];if(b.value==true){s+=(s==""?"":",")+M.getRawValueProperty().name;}if(b.text==true&&M.getFormattedValueProperty()){s+=(s==""?"":",")+M.getFormattedValueProperty().name;}if(b.unit==true&&M.getUnitProperty()){s+=(s==""?"":",")+M.getUnitProperty().name;}}if(this._bIncludeEntityKey){var k=this._oQueryResult.getEntityType().getTypeDescription().key.propertyRef;for(var i=-1,K;K=k[++i];){s+=(s==""?"":",")+K.name;}}Q=(s?s:null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f?f:null);break;}case"$orderby":{var S=null;if(this._oSortExpression){S=this._oSortExpression.getURIOrderByOptionValue();}Q=(S?S:null);break;}case"$top":{if(this._iTopRequestOption!==null){Q=this._iTopRequestOption;}break;}case"$skip":{Q=this._iSkipRequestOption;break;}default:break;}return Q;},getURIToQueryResultEntries:function(s){var r=this.getURIToQueryResultEntitySet(s);var S=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var a=this.getURIQueryOptionValue("$orderby");var t=this.getURIQueryOptionValue("$top");var b=this.getURIQueryOptionValue("$skip");var u=r;var q=false;if(S){u+="?$select="+S;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&a){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+a;}if(this._iTopRequestOption&&t){if(!q){u+="?";q=true;}else{u+="&";}u+="$top="+t;}if(this._iSkipRequestOption&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$skip="+b;}if(this._bIncludeCount){if(!q){u+="?";q=true;}else{u+="&";}u+="$inlinecount=allpages";}return u;},_oQueryResult:null,_oParameterizationRequest:null,_oAggregationLevel:null,_oMeasures:null,_bIncludeEntityKey:null,_bIncludeCount:null,_oFilterExpression:null,_oSortExpression:null,_iSkipRequestOption:0,_iTopRequestOption:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterValueSetRequest=function(p){this._init(p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.ParameterValueSetRequest.prototype={_init:function(p){this._oParameter=p;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;},includeParameterText:function(i){if(i!=null){this._oValueSetResult.text=i;}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oParameter.getContainingParameterization().getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";s+=(s==""?"":",")+this._oParameter.getProperty().name;if(this._oValueSetResult.text==true&&this._oParameter.getTextProperty()){s+=(s==""?"":",")+this._oParameter.getTextProperty().name;}Q=(s?s:null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f?f:null);break;}case"$orderby":{var S=null;if(this._oSortExpression){S=this._oSortExpression.getURIOrderByOptionValue();}Q=(S?S:null);break;}default:break;}return Q;},getURIToParameterValueSetEntries:function(s){var r=null;r=(s?s:"")+"/"+this._oParameter.getContainingParameterization().getEntitySet().getQName();var S=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var a=this.getURIQueryOptionValue("$orderby");var u=r;var q=false;if(S){u+="?$select="+S;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&a){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+a;}return u;},_oParameter:null,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionMemberSetRequest=function(d,p){this._init(d,p);};sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.DimensionMemberSetRequest.prototype={_init:function(d,p){this._oDimension=d;this._oParameterizationRequest=p;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},includeDimensionTextAttributes:function(i,a){if(i!=null){this._oValueSetResult.text=i;}if(a!=null){this._oValueSetResult.attributes=a;}},getFilterExpression:function(){if(this._oFilterExpression==null){var e=this._oDimension.getContainingQueryResult().getEntityType();this._oFilterExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.FilterExpression(e.getModel(),e.getSchema(),e);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var e=this._oQueryResult.getEntityType();this._oSortExpression=new sap.ushell.components.tiles.indicatorTileUtils.odata4analytics.SortExpression(e.getModel(),e.getSchema(),e);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},hasMasterDataAvailable:function(){return false;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";s+=(s==""?"":",")+this._oDimension.getKeyProperty().name;if(this._oValueSetResult.text==true&&this._oDimension.getTextProperty()){s+=(s==""?"":",")+this._oDimension.getTextProperty().name;}if(this._oValueSetResult.attributes){for(var i=-1,a;a=this._oValueSetResult.attributes[++i];){s+=(s==""?"":",")+this._oDimension.findAttributeByName(a).getName();}}Q=(s?s:null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f?f:null);break;}case"$orderby":{var S=null;if(this._oSortExpression){S=this._oSortExpression.getURIOrderByOptionValue();}Q=(S?S:null);break;}default:break;}return Q;},getURIToDimensionMemberEntries:function(s){var r=null;if(this._oDimension.getContainingQueryResult().getParameterization()){if(!this._oParameterizationRequest){throw"Missing parameterization request";}else{r=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oDimension.getContainingQueryResult().getParameterization().getNavigationPropertyToQueryResult();}}else{r=(s?s:"")+"/"+this._oDimension.getContainingQueryResult().getEntitySet().getQName();}var S=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var a=this.getURIQueryOptionValue("$orderby");var u=r;var q=false;if(S){u+="?$select="+S;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&a){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+a;}return u;},_oDimension:null,_oParameterizationRequest:null,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null};return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil',function(){"use strict";sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles.indicatorTileUtils=sap.ushell.components.tiles.indicatorTileUtils||{};sap.ushell.components.tiles.indicatorTileUtils.util=sap.ushell.components.tiles.indicatorTileUtils.util||{};sap.ushell.components.tiles.indicatorTileUtils.util=(function(g,$){var c={};var t={"ANN":"years","WEE":"weeks","DAY":"days","HUR":"hours","MIN":"minutes"};var a={};var b={};return{getScheduledJob:function(k){return a[k];},setScheduledJob:function(k,d){a[k]=d;},isCallInProgress:function(k){return b[k];},setUnsetCallInProgress:function(k,v){b[k]=v;},getTimeUnitMap:function(){return t;},getHanaUser:function(){return authObject.userName;},addSystemToServiceUrl:function(u,s){jQuery.sap.log.info("Hana Adapter --> Add System to Service Url");if(sap.ushell&&sap.ushell.Container){if(s){u=sap.ushell.Container.getService("URLParsing").addSystemToServiceUrl(u,s);}else{u=sap.ushell.Container.getService("URLParsing").addSystemToServiceUrl(u);}}return u;},getODataModelByServiceUri:function(s){s=this.addSystemToServiceUrl(s);if(!c[s]){var m=new sap.ui.model.odata.ODataModel(s,{loadMetadataAsync:true,json:true});c[s]=m;}return c[s];},getEdmType:function(u,p){var d=null;if(u instanceof sap.ui.model.odata.ODataModel){d=u;}else{d=this.getODataModelByServiceUri(u);}if(d&&d.getServiceMetadata()){var s=d.getServiceMetadata();var e=s.dataServices.schema[0].entityType;if(e){for(var i=0;i<e.length;i++){var f=e[i];var h=f.property;for(var j=0;j<h.length;j++){var k=h[j];if(k.name==p){return k.type;}}}}}return null;},getMillisecond:function(d,u){var r;switch(u){case"seconds":r=d*1000;break;case"minutes":r=d*60*1000;break;case"hours":r=d*60*60*1000;break;case"days":r=d*24*60*60*1000;break;case"weeks":r=d*7*24*60*60*1000;break;case"months":r=d*4*7*24*60*60*1000;break;case"years":r=d*12*4*7*24*60*60*1000;break;}return r;},getUTCDate:function(){var n=new Date();return n;},isCacheValid:function(d,e,f,h,i){var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(d);if(!j){return false;}else if(!(f&&Number(f))){return true;}else{var k=this.getMillisecond(f,t[h]);if(jQuery.type(j.CachedTime)=="date"){var l=j.CachedTime&&j.CachedTime.getTime();}else{var l=j.CachedTime&&parseInt(j.CachedTime.substr(6),10);}var m=this.getUTCDate();return(l>=e&&k>=(m-l)&&!i);}},getMantissaLength:function(n){var N=n.toString();var i=0;if(n<0){i=1;}return(N.indexOf('.')===-1)?(n<0?N.length-1:N.length):N.substring(i,N.indexOf('.')).length;},getLocaleFormattedValue:function(n,s,d,i,e){jQuery.sap.require("sap.ui.core.format.NumberFormat");i=i||false;e=e||null;if(i){return sap.ui.core.format.NumberFormat.getCurrencyInstance({style:"short",showMeasure:false}).format(n,e);}var D=2;var f={style:"short"};var N;if(!(d==-1||d==null)){f.shortDecimals=Number(d);f.minFractionDigits=Number(d);f.maxFractionDigits=Number(d);}var v=sap.ui.core.format.NumberFormat.getInstance(f);if(s==-2){if(n>9999){N="????";}else if((n>-0.001&&n<0)||(n<0.001&&n>0)){N="0";}else{if(n.toString().indexOf('.')!=-1){N=Number(n).toFixed(4-n.toString().indexOf('.'));}else{N=Number(n);}N=v.format(N);}}else if(d==-1||d==null){var m=this.getMantissaLength(n);if(!(m%3)){D=1;}if(m%3===1){D=3;}if(m%3===2){D=2;}if(Math.abs(n)%Math.pow(10,m-1)==0){D=0;}else if((Math.abs(n)%Math.pow(10,m-1))<6*Math.pow(10,m-4)){D=0;}v=sap.ui.core.format.NumberFormat.getInstance({style:"short",shortDecimals:D});N=v.format(n);}else{N=v.format(n);}return N;},getPlatform:function(p){return(jQuery.sap.getUriParameters().get("sb_metadata")||p||"HANA").toUpperCase();},getTileTitleSubtitle:function(C){var d={};if(C.bag&&C.bag.getBagIds()&&C.bag.getBagIds().length){d.title=C.bag.getBag("sb_tileProperties").getText("title")||C.bag.getBag("sb_tileProperties").getProperty("title")||C.preview.getTitle();d.subTitle=C.bag.getBag("sb_tileProperties").getText("description")||C.bag.getBag("sb_tileProperties").getProperty("description")||C.preview.getDescription();}else{d.title=C.preview.getTitle();d.subTitle=C.preview.getDescription();}return d;},scheduleFetchDataJob:function(i){var d;if(this.getView().getViewName().indexOf("DualTile")!==-1){d=this.oKpiTileView.oConfig;}else{d=this.oConfig;}var k=d.TILE_PROPERTIES.id+"data";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeUnitMap();var e=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTime(d);var f=sap.ushell.components.tiles.indicatorTileUtils.util.getCachingTimeUnit(d);var h=sap.ushell.components.tiles.indicatorTileUtils.util.getMillisecond(e,t[f]);if(jQuery.type(this.cacheTime)=="date"){var j=this.cacheTime;}else{var j=new Date(parseInt(this.cacheTime.substr(6),10));}var l=h-(sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate()-j);if(l<=0){l=0;}else if(l>2147483646){l=2147483646;}if(!i){l=300000;}if(this.getView().getViewName().indexOf("DualTile")!==-1){r=setTimeout(this.refreshPress.bind(this),l);}else{r=setTimeout(this.refreshHandler.bind(this,false,true),l);sap.ushell.components.tiles.indicatorTileUtils.util.setScheduledJob(k,r);}this.updateDatajobScheduled=true;},scheduleTimeStampJob:function(i){var k=this.oConfig.TILE_PROPERTIES.id+"time";var r=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(k);if(r){clearTimeout(r);r=undefined;}if(jQuery.type(this.cacheTime)=="date"){var d=this.cacheTime;}else{var d=new Date(parseInt(this.cacheTime.substr(6),10),13);}var e=sap.ushell.components.tiles.indicatorTileUtils.util.getTimeDifference(sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate()-d);r=setTimeout(this.setTimeStamp.bind(this,this.cacheTime),e.timer);sap.ushell.components.tiles.indicatorTileUtils.util.setScheduledJob(k,r);this.updateTimeStampjobScheduled=true;},getBoolValue:function(v){var r=false;if(typeof v=="boolean"&&v){r=true;}return r;},getSeconds:function(d){return(d/1000);},getMinutes:function(d){return(this.getSeconds(d)/60);},getHours:function(d){return(this.getMinutes(d)/60);},getDays:function(d){return(this.getHours(d)/24);},getWeeks:function(d){return(this.getDays(d)/7);},getMonths:function(d){return(this.getWeeks(d)/4);},getYears:function(d){return(this.getMonths(d)/12);},getTimeDifference:function(d){var r={};if(d){var m=this.getMinutes(d);var h=this.getHours(d);var e=this.getDays(d);if(m<5){r.time=0;r.unit="minutes";r.timer=Math.round(this.getMillisecond(5-m,"minutes"));}else if(m>=5&&m<60){if(m<10){r.time=5;}else{r.time=(m-(m%10));}r.unit="minutes";r.timer=Math.round(this.getMillisecond(10-(m%10),"minutes"));}else if(h>=1&&h<24){r.unit="hours";r.time=(h-(h%1));r.timer=Math.round(this.getMillisecond(1-(h%1),"hours"));}else if(e>=1&&e<2){r.unit="days";r.time=(e-(e%1));r.timer=Math.round(this.getMillisecond(1-(e%1),"days"));}else{r.unit="days";r.time=(e-(e%1));r.timer=this.getMillisecond(2,"days");}}else{r.timer=6000;r.unit="days";r.timer=2000;}return r;},getCachingTime:function(C){return((C.CACHINGTIME&&Number(C.CACHINGTIME))||(C.TILE_PROPERTIES.cachingTime&&Number(C.TILE_PROPERTIES.cachingTime)));},getCachingTimeUnit:function(C){return(C.CACHINGUNIT||C.TILE_PROPERTIES.cachingTimeUnit);},getFrontendCacheQuery:function(d,u,p,T){var e;try{var f=T.url.addSystemToServiceUrl('/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV');f=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(f);e=this.getODataModelByServiceUri(f);var f="/CacheParameters(P_CacheType=1)/Results";return{oModel:e,uri:f};}catch(h){jQuery.sap.log.error("FrontEnd cache Metadata failed");return null;}},isDualTile:function(C){var d=C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.tileType;if(d.indexOf("DT-")==-1){return false;}return true;},writeFrontendCacheByChipAndUserId:function(T,d,e,u,f){var s=function(e){jQuery.sap.log.info("cache write successFully");f(e);};var h=function(){jQuery.sap.log.error("cache update failed");f(null);};try{var i=T.url.addSystemToServiceUrl("/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV/");i=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(i);var j=this.getODataModelByServiceUri(i);var k="/CacheData";j.create(k,e,{async:true,success:s,error:h});}catch(l){jQuery.sap.log.error(l);}},getKpiChipsOnPage:function(d,e){var f=[];var l=sap.ushell.Container.getService("LaunchPage");l.getGroups().done(function(G){if(G&&G instanceof Array&&G.length){jQuery.sap.log.info("Group Chip fetch");}e(d,f);});},getFrontendCache:function(C,T){var d=this;var o=sap.ushell.components.tiles.indicatorTileUtils.cache.getFrontEndCacheDeferredObject(T.url.getApplicationSystem());var e;if(o){e=o;}else{e=jQuery.Deferred();}var f=C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.id;var h=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(f);if(h){o.resolve(true);}else if(o){return o.promise();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setFrontEndCacheDefferedObject(T.url.getApplicationSystem(),e);o=e;this.getKpiChipsOnPage(f,function(f,p){if(p){var i=d.getFrontendCacheQuery(p,sap.ushell.Container.getUser().getId(),p,T);if(i){var j=i.oModel;var k=i.uri;var l=false;var m=j.read(k,null,null,true,function(n){if(n&&n.results&&n.results instanceof Array&&n.results.length){jQuery.each(n.results,function(q,r){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(r.ChipId,r);});}if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(f)){l=true;}o.resolve(l);},function(n){if(n&&n.response){jQuery.sap.log.error(n.message+" : "+n.request.requestUri);}o.reject();});}else{o.reject();}}else{o.resolve(false);}});}return o.promise();},getModelerRuntimeServiceModel:function(){var u="/sap/hba/r/sb/core/odata/runtime/SMART_BUSINESS.xsodata";u=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(u);return this.getODataModelByServiceUri(u);},getSapFontErrorCode:function(){return String.fromCharCode(0xe0b1);},getSapFontBusyCode:function(){return String.fromCharCode(0xe1f2);},prepareFilterStructure:function(f,d){var v=[];if(d){f=f.concat(d);}for(var i=0;i<f.length;i++){var p={};p.comparator=f[i].OPERATOR;p.filterPropertyName=f[i].NAME;if(f[i].ID){p.id=f[i].ID;}p.type=f[i].TYPE;p.value=f[i].VALUE_1;p.valueTo=f[i].VALUE_2;v.push(p);}return v;},getODataModelByServiceUriFromChipAPI:function(s,T){s=T.url.addSystemToServiceUrl(s);if(!c[s]){var m=new sap.ui.model.odata.ODataModel(s,true);c[s]=m;}return c[s];},cacheBustingMechanism:function(u){if(window["sap-ushell-config"].cacheBusting.cacheBusterToken){var d=window["sap-ushell-config"].cacheBusting&&window["sap-ushell-config"].cacheBusting.cacheBusterToken;u=u+"?_="+d;}return u;},getRunTimeUri:function(p){var u="/sap/hba/r/sb/core/odata/runtime/SMART_BUSINESS.xsodata";var d="/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV";if(p.toUpperCase()=="HANA"){if(window["sap-ushell-config"].cacheBusting){u=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(u);}return u;}if(window["sap-ushell-config"].cacheBusting){d=sap.ushell.components.tiles.indicatorTileUtils.util.cacheBustingMechanism(d);}return d;},getFilterFromRunTimeService:function(C,T,s,e){var p=C.TILE_PROPERTIES.sb_metadata;var K=this.getODataModelByServiceUriFromChipAPI(this.getRunTimeUri(p),T);var f="ID eq '#EVALUATIONID'".replace("#EVALUATIONID",C.EVALUATION.ID);var k=K.read("/EVALUATION_FILTERS",null,{"$filter":f},true,function(d){var h=[];if(d.results.length){h=d.results;}s.call(this,h);},e);return k;},_getOData4AnalyticsObject:function(u){var m=null;if(u instanceof sap.ui.model.odata.ODataModel){m=u;}else if(typeof u=="string"){m=this.getODataModelByServiceUri(u);}else{throw new Error("Invalid Input to Create ODataModel Object : "+u);}var O=new sap.ui.model.analytics.odata4analytics.Model(sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(m));return O;},findTextPropertyForDimension:function(u,d,f){try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);var D=q.findDimensionByName(f);if(D.getTextProperty()){return D.getTextProperty().name;}else{return f;}}catch(e){$.sap.log.error("Error Fetching Text Property for "+f+" : "+e.toString());}},getEvalValueMeasureName:function(C,d,r){var e=C.EVALUATION_VALUES;for(var i=0;i<e.length;i++){if(e[i].TYPE==d){if(r==="FIXED"){return e[i].FIXED;}else{return e[i].COLUMN_NAME;}}}},getSemanticColorName:function(d){var s="";if(d=="Error"){s="sb.error";}if(d=="Neutral"){s="sb.neutral";}if(d=="Critical"){s="sb.critical";}if(d=="Good"){s="sb.good";}return s;},setTooltipInTile:function(C,d,v){var e="";var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();if(d=="NT"||d=="DT"){if(v.status){e+=r.getText("sb.status")+": "+r.getText(v.status)+"\n";}if(v.actual){e+=r.getText("sb.actual")+": "+v.actual+"\n";}if(v.target){e+=r.getText("sb.target")+": "+v.target+"\n";}if(v.cH){e+=r.getText("sb.ch")+": "+v.cH+"\n";}if(v.wH){e+=r.getText("sb.wh")+": "+v.wH+"\n";}if(v.wL){e+=r.getText("sb.wl")+": "+v.wL+"\n";}if(v.cL){e+=r.getText("sb.cl")+": "+v.cL+"\n";}}if(d=="CONT"||d=="COMP"){if(v.measure&&d=="CONT"){if(v&&v.contributionTile.contributionTile&&v.contributionTile.contributionTile[1]==="asc"){e+=r.getText("sb.bottomn")+": "+v.contributionTile[0]+"\n";}else if(v&&v.contributionTile.contributionTile&&v.contributionTile.contributionTile.length){e+=r.getText("sb.topn")+": "+v.contributionTile[0]+"\n";}}if(v.m1&&((v.v1==undefined||v.v1==null)?false:v.v1.toString())&&v.c1){e+=v.m1+": "+v.v1+" "+r.getText(v.c1)+"\n";}if(v.m2&&((v.v2==undefined||v.v2==null)?false:v.v2.toString())&&v.c2){e+=v.m2+": "+v.v2+" "+r.getText(v.c2)+"\n";}if(v.m3&&((v.v3==undefined||v.v3==null)?false:v.v3.toString())&&v.c3){e+=v.m3+": "+v.v3+" "+r.getText(v.c3)+"\n";}}C&&C.setTooltip&&C.setTooltip(e);},_getFormattedTileProperties:function(d){d=d||{};var p=["sb_metadata","sb_navigation","sb_catalog"];var e=false;for(var i=0;!e&&i<p.length;i++){e=e||jQuery.sap.getUriParameters().get(p[i])||d[p[i]];}d.sb_metadata=(jQuery.sap.getUriParameters().get("sb_metadata")||d.sb_metadata||"HANA").toLowerCase();d.sb_navigation=(jQuery.sap.getUriParameters().get("sb_navigation")||d.sb_navigation||"abap").toLowerCase();d.sb_catalog=(jQuery.sap.getUriParameters().get("sb_catalog")||d.sb_catalog||"HANA").toLowerCase();d.isPlatformInfoPresent=e;return d;},getEvaluationDetailsFromRunTimeService:function(e,p,i,d){var K=this.getODataModelByServiceUri(this.getRunTimeUri(p));var f="ID eq '#EVALUATIONID'".replace("#EVALUATIONID",i);var k=K.read(e,null,{"$filter":f},true,function(h){var j=[];if(h.results.length){j=h.results;}d.call(this,j);});},getParsedChip:function(C,i,d){try{var p={};var e=JSON.parse(C);var f=JSON.parse(e.TILE_PROPERTIES).evaluationId||"";if(e.TILE_PROPERTIES){var h=JSON.parse(e.TILE_PROPERTIES);if(h&&(h.instanceId||h.catalogId)){return false;}}var j=this;if(e.blankTile){p["BLANKTILE"]=e.blankTile;}if(e.cachingTime){p["CACHINGTIME"]=e.cachingTime;}if(e.cachingTimeUnit){p["CACHINGUNIT"]=e.cachingTimeUnit;}if(e.TAGS){p["TAGS"]=JSON.parse(e.TAGS);}if(e.ADDITIONAL_FILTERS){p["ADDITIONAL_FILTERS"]=JSON.parse(e.ADDITIONAL_FILTERS);}if(e.ADDITIONAL_APP_PARAMETERS){p["ADDITIONAL_APP_PARAMETERS"]=JSON.parse(e.ADDITIONAL_APP_PARAMETERS);}p.TILE_PROPERTIES=this._getFormattedTileProperties(JSON.parse(e.TILE_PROPERTIES));var P=p.TILE_PROPERTIES.sb_metadata;if(e.EVALUATION_FILTERS){p["EVALUATION_FILTERS"]=JSON.parse(e.EVALUATION_FILTERS);if(e.EVALUATION_VALUES){p["EVALUATION_VALUES"]=JSON.parse(e.EVALUATION_VALUES);if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{if(!i){j.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",P,f,function(l){p.EVALUATION=l;if(d){d(p);}else{return p;}});}else{if(d){d(p);}else{return p;}}}}else{if(!i){j.getEvaluationDetailsFromRunTimeService("/EVALUATION_VALUES",P,f,function(l){p["EVALUATION_VALUES"]=l;if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",P,f,function(l){p.EVALUATION=l;if(d){d(p);}else{return p;}});}});}else{if(d){d(p);}else{return p;}}}}else if(i){if(d){d(p);}else{return p;}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATION_FILTERS",P,f,function(l){p["EVALUATION_FILTERS"]=l;if(e.EVALUATION_VALUES){p["EVALUATION_VALUES"]=JSON.parse(e.EVALUATION_VALUES);if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",P,f,function(l){p.EVALUATION=l;if(d){d(p);}else{return p;}});}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATION_VALUES",P,f,function(l){p["EVALUATION_VALUES"]=l;if(e.EVALUATION){p.EVALUATION=JSON.parse(e.EVALUATION);if(d){d(p);}else{return p;}}else{j.getEvaluationDetailsFromRunTimeService("/EVALUATIONS",P,f,function(l){p.EVALUATION=l;if(d){d(p);}else{return p;}});}});}});}}catch(k){return false;}},getNavigationTarget:function(C,s){var f=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService;var o=f&&f("CrossApplicationNavigation");var e;var p={};p["evaluationId"]=C.EVALUATION.ID;p["chipId"]=C.TILE_PROPERTIES.id;if(s){p["sap-system"]=s;}p["tileType"]=C.TILE_PROPERTIES.tileType;if(C.TILE_PROPERTIES.dimension){p["dimension"]=C.TILE_PROPERTIES.dimension;}if(C.TILE_PROPERTIES.storyId){p["storyId"]=C.TILE_PROPERTIES.storyId;}if(C.TILE_PROPERTIES.apfConfId){p["sap-apf-configuration-id"]=C.TILE_PROPERTIES.apfConfId;}if(C.TILE_PROPERTIES.isPlatformInfoPresent){p["sb_metadata"]=C.TILE_PROPERTIES.sb_metadata;p["sb_navigation"]=C.TILE_PROPERTIES.sb_navigation;p["sb_catalog"]=C.TILE_PROPERTIES.sb_catalog;}if(C.ADDITIONAL_APP_PARAMETERS){for(e in C.ADDITIONAL_APP_PARAMETERS){if(C.ADDITIONAL_APP_PARAMETERS.hasOwnProperty(e)){if(C.ADDITIONAL_APP_PARAMETERS[e].constructor==Array){var d=C.ADDITIONAL_APP_PARAMETERS[e];for(var i=0;i<d.length;i++){p[e]=d[i];}}else{p[e]=C.ADDITIONAL_APP_PARAMETERS[e];}}}}var h=o&&o.hrefForExternal({target:{semanticObject:C.TILE_PROPERTIES.semanticObject,action:C.TILE_PROPERTIES.semanticAction},params:p})||"";if(C.ADDITIONAL_FILTERS){var k=C.ADDITIONAL_FILTERS;var l="&";for(var j=0;j<k.length;j++){if(k[j].OPERATOR==="EQ"){l=l+"/"+k[j].NAME+"="+k[j].VALUE_1;}}h+=l;}return h;},getChipTitle:function(C){var d="";if(C){var e=C.EVALUATION||{};d=e.INDICATOR_TITLE||"";}return d;},getstringifyTileConfig:function(C){var s={};s.EVALUATION=JSON.stringify(C.EVALUATION);s.EVALUATION_FILTERS=JSON.stringify(C.EVALUATION_FILTERS);s.EVALUATION_VALUES=JSON.stringify(C.EVALUATION_VALUES);s.TILE_PROPERTIES=JSON.stringify(C.TILE_PROPERTIES);return JSON.stringify(s);},getChipSubTitle:function(C){var T="";if(C){var d=C.EVALUATION||{};T=d.TITLE||"";}return T;},getAllMeasures:function(u,d){var m=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);m=q.getAllMeasureNames();}catch(e){$.sap.log.error("Error Fetching All Measures : "+e.toString());}return m;},getFormattingMetadata:function(u,e,p){var f={};f._hasCurrency=false;f._hasSapText=false;var m=null;if(u instanceof sap.ui.model.odata.ODataModel){m=sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(u);}else{var d=this.getODataModelByServiceUri(u);m=sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(d);}var O=new sap.ui.model.analytics.odata4analytics.Model(m);var q=O.findQueryResultByName(e);var h=q.getAllMeasures();if(h[p]){var s=(h[p]._oTextProperty&&h[p]._oTextProperty.name)?h[p]._oTextProperty.name:"";if(s!=""){f._hasSapText=true;f._sapTextColumn=s;}else if(h[p].hasOwnProperty("_oUnitProperty")){var j=h[p]._oUnitProperty.extensions;for(var i=0;i<h[p]._oUnitProperty.extensions.length;i++){if(j[i].name==="semantics"&&j[i].value==="currency-code"){f._hasCurrency=true;f._currencyColumn=h[p]._oUnitProperty.name;}}}}return f;},getAllDimensions:function(u,d){function i(j,k){var l=0,m=0;var r=[];while(l<j.length&&m<k.length){if(j[l]<k[m]){l++;}else if(j[l]>k[m]){m++;}else{r.push(j[l]);l++;m++;}}return r;}var f=[];var F=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);var h=q.getEntityType();F=h.getFilterablePropertyNames();f=q.getAllDimensionNames();if(F&&F.length){f=i(F.sort(),f.sort());}}catch(e){$.sap.log.error("Error Fetching All Dimesions : "+e.toString());}return f;},prepareQueryServiceUri:function(u,d,m,f,v,o,h){function _(S){return S.replace(/'/g,"''");}var n=null;var p=function(){};var q=function(){};try{var r=null;if(u instanceof sap.ui.model.odata.ODataModel){r=sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(u);}else{var s=this.getODataModelByServiceUri(u);r=sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(s);}var O=new sap.ui.model.analytics.odata4analytics.Model(r);var Q=O.findQueryResultByName(d);var w=new sap.ui.model.analytics.odata4analytics.QueryResultRequest(Q);if(m){w.setMeasures(m.split(","));w.includeMeasureRawFormattedValueUnit(null,true,true,true);}if(f){if(typeof f=="string"){n=f;n=n.split(",");}for(var i=0;i<n.length;i++){w.addToAggregationLevel([n[i]]);var x=Q.getAllDimensions();if(x[n[i]].getTextProperty()!=null){w.includeDimensionKeyTextAttributes([n[i]],true,true,null);}}}if(v&&v.length){var A=[];var B=[];for(var i=0,l=v.length;i<l;i++){var C=v[i];if(C.type==="PA"){B.push(C);}else if(C.type==="FI"){A.push(C);}}p=function(S){var T=S.toJSON();var U=T.charAt(T.length-1).toUpperCase();if(U.charCodeAt(0)>=65&&U.charCodeAt(0)<=90){T=T.slice(0,-1);}return T;};q=function(S){if(S){try{if(S==+S){S=window.parseInt(S);}var T=new Date(S);var U=T.getTime();if(isNaN(U)){return S;}else{return p(T);}}catch(e){}}return S;};if(A.length){var F=w.getFilterExpression();for(var i=0,l=A.length;i<l;i++){var C=A[i];if(this.getEdmType(u,C.filterPropertyName)=="Edm.DateTime"){C.value=q(C.value);C.valueTo=q(C.valueTo);}if(C.comparator==sap.ui.model.FilterOperator.BT){F.addCondition(C.filterPropertyName,C.comparator,_(C.value),C.valueTo);}else{var D=C.value.split(",");for(var j=0,k=D.length;j<k;j++){F.addCondition(C.filterPropertyName,C.comparator,_(D[j].replace(/\^\|/g,",")),null);}}}}if(B.length){if(Q.getParameterization()){var P=new sap.ui.model.analytics.odata4analytics.ParameterizationRequest(Q.getParameterization());var E=Q.getParameterization();var G,H,I,J,K;for(var y=0,z=B.length;y<z;y++){G=B[y];H=E.findParameterByName(G.filterPropertyName);if(H.isIntervalBoundary()===true&&H.isLowerIntervalBoundary()===true){K=H.getPeerIntervalBoundaryParameter();for(var i=0,l=B.length;i<l;i++){if(B[i].filterPropertyName===K.getName()){J=_(B[i].value);break;}}I=_(G.value);if(J){P.setParameterValue(G.filterPropertyName,I,J);}}else if(H.isIntervalBoundary()===true&&H.isLowerIntervalBoundary()===false){jQuery.sap.log.info("Future development");}else{P.setParameterValue(G.filterPropertyName,_(G.value));}}w.setParameterizationRequest(P);}}}var L=w.getURIToQueryResultEntries();if(o&&o.length){L=L+"&$orderby=";for(var y=0,z=o.length;y<z;y++){var M=o[y].sortOrder||"asc";if(M){L+=o[y].element+" "+M+",";}}L=L.slice(0,L.length-1);}if(h){L=L+"&$top="+h;}var N=Q.getAllMeasures();var R=[];for(var i=0;i<m.split(",").length;i++){R.push(N[m.split(",")[i]].getUnitProperty());}return{uri:L,model:O.getODataModel(),unit:R};}catch(e){$.sap.log.error("Error Preparing Query Service Uri using OData4Analytics Library : "+e.toString());if(arguments.length){$.sap.log.error("Arguments Passed to this function");$.sap.log.error(arguments[0]+","+arguments[1]+","+arguments[2]+","+arguments[3]);}else{$.sap.log.error("NO Arguments passed to this function");}return null;}},getAllEntitySet:function(u){var d=[];try{var o=this._getOData4AnalyticsObject(u);d=o.getAllQueryResultNames();}catch(e){$.sap.log.error("Error fetching Enity Set : "+e.toString());}return d;},getAllMeasuresWithLabelText:function(u,d){var m=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);var f=q.getAllMeasureNames();for(var i=0;i<f.length;i++){var h=f[i];g.oMeasure=q.findMeasureByName(h);m.push({key:h,value:oMeasure.getLabelText()});}}catch(e){$.sap.log.error("Error Fetching All Measures : "+e.toString());}return m;},getAllDimensionsWithLabelText:function(u,d){var f=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);var h=q.getAllDimensionNames();for(var i=0;i<h.length;i++){var j=h[i];var D=q.findDimensionByName(j);var k=null;if(D.getTextProperty()!=null){k=D.getTextProperty().name;}f.push({key:j,value:D.getLabelText(),textProperty:k});}}catch(e){$.sap.log.error("Error Fetching All Dimesions : "+e.toString());}return f;},getAllInputParams:function(u,d){var i=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);if(q.getParameterization()){var p=q.getParameterization();i=p.getAllParameterNames();}}catch(e){$.sap.log.error("Error Fetching Input Params : "+e.toString());}return i;},getAllInputParamsWithFlag:function(u,d){var f=[];try{var o=this._getOData4AnalyticsObject(u);var q=o.findQueryResultByName(d);if(q.getParameterization()){var p=q.getParameterization();var h=p.getAllParameterNames();for(var i=0;i<h.length;i++){var j=h[i];var k=p.findParameterByName(j);f.push({name:j,optional:k.isOptional()});}}}catch(e){$.sap.log.error("Error Fetching Input Params : "+e.toString());}return f;},formatOdataObjectToString:function(v){if(v&&v.constructor==Object){if(v.__edmType=="Edm.Time"){var m=v.ms;var s=Math.floor((m/1000)%60);var d=Math.floor((m/60000)%60);var h=Math.floor((m/3600000)%24);return h+"H"+d+"M"+s+"S";}}return v;},generateCombinations:function(d){function e(h,s){while(s.length<h){s='0'+s;}return s;}var m=Math.pow(2,d.length);var r=[];var f=0;while(m>1){var s=(m-1).toString(2);s=e(d.length,s);r[f]=[];for(var i=0;i<s.length;i++){if(Number(s[i])){r[f].push(d[i]);}}m--;f++;}return r;},logError:function(e,C){if(e=="no data"&&C){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();C.setFailedText(r.getText("sb.noData"));}jQuery.sap.log.error(e.toString());},numberOfLeadingZeros:function(n){n=String(n);var d=0;var e=n.indexOf('.');if(e==-1){return 0;}if(Number(n.split('.')[0])!=0){return 0;}var i=e+1;while(n[i++]=='0'){++d;}return d;},formatValue:function(v,s,M){M=M||3;var u={3:"K",6:"M",9:"B",12:"T",0:""};u["-3"]="m";u["-6"]="u";u["-9"]="n";u["-12"]="t";u["-2"]="%";var d,p,e;d=Number(v).toPrecision(M);var z=this.numberOfLeadingZeros(d);if(z>0&&s<0){p=d*Math.pow(10,z+M);e=-(z+M);}else{p=Number(d.split("e")[0]);e=Number(d.split("e")[1])||0;}if(!v&&v!=0){return{value:"",unitPrefix:""};}if(s>=0){if(e%3!=0){if(e%3==2){if(e+1==s){e=e+1;p=p/10;}else{e=e-2;p=p*100;}}else{if(e+2==s){e=e+2;p=p/100;}else{e--;p=p*10;}}}else if(e==15){p=p*1000;e=12;}}else{if(s=="-2"){var x=this.formatValue((v*100),0);}else if(e>=0&&v<10&&s=="-3"){p=v*Math.pow(10,3);e=-3;}else if(e>=0){return this.formatValue(v,0);}else{e=Math.abs(e);s=Math.abs(s);if(s>e){p=p/(Math.pow(10,e%3));e=e-(e%3);}else{var f=e-s;p=p/(Math.pow(10,f));e=e-f;}e=0-e;}}p+="";if(s=="-2"){var h=(x.unitPrefix=="")?Number(x.value+"").toFixed(4-(x.value+"").indexOf('.')):Number(x.value+"").toFixed(3-(x.value+"").indexOf('.'));return{value:Number(h),unitPrefix:(x.unitPrefix)+u[-2]};}p=Number(p).toFixed(4-p.indexOf('.'));return{value:Number(p),unitPrefix:u[e]};},isSmartbusinessChipAndCachable:function(d){var C=this.getParsedChip(d&&d.getConfigurationParameter("tileConfiguration"));return(C&&C.TILE_PROPERTIES&&C.TILE_PROPERTIES.tileType&&this.getCachingTime(C));},getHanaClient:function(){var e;var f=function(d,s,x){e=d.sessionClient;sap.ushell.components.tiles.indicatorTileUtils.cache.setCacheHanaClient(e);sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.resolve(e);};var h=function(d,k,l){jQuery.sap.log.error(d.responseText);jQuery.sap.log.error("session client call failed");sap.ushell.components.tiles.indicatorTileUtils.cache.setCacheHanaClient(null);sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.reject();};var i=sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED||jQuery.Deferred();var j=sap.ushell.components.tiles.indicatorTileUtils.cache.getCacheHanaClient();if(j!=undefined){e=j;sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.resolve(e);}else if(sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED){return sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.promise();}else{sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED=i;jQuery.ajax({type:"GET",async:false,dataType:"json",url:"/sap/hba/r/sb/core/logic/GetSessionClient.xsjs",success:f,error:h});}return sap.ushell.components.tiles.indicatorTileUtils.util.HANA_CLIENT_DEFERRED.promise();},abortPendingODataCalls:function(d){try{if(d){d.abort();}}catch(e){this.logError(e);}}};})(window,jQuery);sap.ushell.components.tiles.indicatorTileUtils.cache=(function(){var B={};var K={};var s="HANA_CLIENT";return{getCacheHanaClient:function(){return B[s];},setCacheHanaClient:function(d){B[s]=d;},getEvaluationByChipId:function(k){if(B[k]){return B[k];}return null;},getEvaluationById:function(k){return this.getEvaluationByChipId(k);},setEvaluationById:function(k,d){B[k]=d;},getFrontEndCacheDeferredObject:function(k){if(B[k]){return B[k];}return null;},setFrontEndCacheDefferedObject:function(k,d){B[k]=d;},getKpivalueById:function(k){if(K[k]){return K[k];}return null;},setKpivalueById:function(k,d){K[k]=d;}};})();return{};},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorcomparison/ComparisonTile.controller',['sap/ushell/components/tiles/generic'],function(g){"use strict";var C=g.extend("sap.ushell.components.tiles.indicatorcomparison.ComparisonTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},_processDataForComparisonChart:function(d,m,u){var f=[],L={},i,t,l;var a;var T=[];var b=this;var e=null;for(i=0;i<d.results.length;i++){var h=d.results[i];}T=sap.ushell.components.tiles.indicatorTileUtils.util.getAllMeasuresWithLabelText(this.oTileApi.url.addSystemToServiceUrl(this.oConfig.EVALUATION.ODATA_URL),this.oConfig.EVALUATION.ODATA_ENTITYSET);for(i=0,l=T.length;i<l;i++){t=T[i];L[t.key]=t.value;}var j=b.oConfig.TILE_PROPERTIES.COLUMN_NAMES||b.oConfig.EVALUATION.COLUMN_NAMES;for(i=0;i<j.length;i++){var k={};var n=j[i];k.value=Number(h[n.COLUMN_NAME]);var o=Number(h[n.COLUMN_NAME]);var p=false;var s=0;var q=b._getEvaluationThresholdMeasures();var I=jQuery.inArray(n.COLUMN_NAME,q);if(I>-1){p=true;s=b.oConfig.EVALUATION.SCALING;}if(b.oConfig.EVALUATION.SCALING==-2&&p){o*=100;}var c=b.isCurrencyMeasure(n.COLUMN_NAME);if(u&&u[i]&&h[u[i].name]){e=h[u[i].name];}a=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(o,s,b.oConfig.EVALUATION.SCALING,b.oConfig.EVALUATION.DECIMAL_PRECISION,c,e);if(b.oConfig.EVALUATION.SCALING==-2&&p){a+=" %";}k.displayValue=a.toString();if(u){if(u[i]&&h[u[i].name]){k.displayValue+=" "+h[u[i].name];}}k.color=n.semanticColor;k.title=L[n.COLUMN_NAME]||n.COLUMN_NAME;k.measure=n.COLUMN_NAME;k.isCurM=c;f.push(k);}return f;},fetchChartData:function(r,a,s,E){function c(w,x){var y=false;if(w&&w.results&&w.results.length){for(var i=0,l=x.length;i<l&&!y;i++){y=w.results[0][x[i].COLUMN_NAME]!==null;}}return y;}var t=this;try{var b=this.oConfig.EVALUATION.ODATA_ENTITYSET;var m=this.oConfig.EVALUATION.COLUMN_NAME;var d=m;if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES){for(var j=0;j<this.oConfig.TILE_PROPERTIES.COLUMN_NAMES.length;j++){if(this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){d=d+","+this.oConfig.TILE_PROPERTIES.COLUMN_NAMES[j].COLUMN_NAME;}}}else{for(var j=0;j<this.oConfig.EVALUATION.COLUMN_NAMES.length;j++){if(this.oConfig.EVALUATION.COLUMN_NAMES[j].COLUMN_NAME!=this.oConfig.EVALUATION.COLUMN_NAME){d=d+","+this.oConfig.EVALUATION.COLUMN_NAMES[j].COLUMN_NAME;}}}var f=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var h=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(h){var k=h.Data&&JSON.parse(h.Data);}}var n=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var o=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,n,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);if((k&&!k.rightData)||!h||(!o&&t.oTileApi.visible.isVisible())||f||(a&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var p=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,b,d,null,v,3);this.comparisionChartODataRef=p.model.read(p.uri,null,null,true,function(i){t.kpiValueFetchDeferred=true;var w={};if(p.unit){w.unit=p.unit;}if(c(i,t.oConfig.TILE_PROPERTIES.COLUMN_NAMES||t.oConfig.EVALUATION.COLUMN_NAMES)){t.oConfig.TILE_PROPERTIES.FINALVALUE=i;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,d.split(",")[0],p.unit);w.data=t.oConfig.TILE_PROPERTIES.FINALVALUE;var l={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();l.ChipId=t.oConfig.TILE_PROPERTIES.id;l.Data=JSON.stringify(w);l.CacheMaxAge=Number(t.chipCacheTime);l.CacheMaxAgeUnit=t.chipCacheTimeUnit;l.CacheType=1;var x=t.getLocalCache(l);t.updateDatajobScheduled=false;var y=t.oConfig.TILE_PROPERTIES.id+"data";var z=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(y);if(z){clearTimeout(z);z=undefined;}if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);var U=false;if(h){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,l,U,function(i){if(i){t.cacheTime=i&&i.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,i);t.setTimeStamp();}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var A=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(A){if(!A.CachedTime){A.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}var B=A.Data;if(B){B=JSON.parse(B);B.rightData=w;}A.Data=JSON.stringify(B);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,A);}else{var B={};B.rightData=w;x.Data=JSON.stringify(B);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);}t.cacheWriteData=w;}s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(i.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=i;if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id)){w=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);w.data=i;}else{w.data=i;}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,w);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(i){t.kpiValueFetchDeferred=true;if(i&&i.response){jQuery.sap.log.error(i.message+" : "+i.request.requestUri);E.call(t,i);}});}}else{if(h&&h.Data){var q;var u=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(u.indexOf("DT-")==-1){q=h.Data&&JSON.parse(h.Data);}else{q=h.Data&&JSON.parse(h.Data);q=q.rightData;}t.cacheTime=h.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}if(q.data&&q.data.length){t.oConfig.TILE_PROPERTIES.FINALVALUE=q.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else{t.oConfig.TILE_PROPERTIES.FINALVALUE=q.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}}else{t.setNoData();}}}catch(e){t.kpiValueFetchDeferred=true;E.call(t,e);}},doProcess:function(r,i){var t=this;this.setTextInTile();this.fetchChartData(r,i,function(k){this.CALCULATED_KPI_VALUE=k;this._updateTileModel({data:this.CALCULATED_KPI_VALUE});if(t.oConfig.TILE_PROPERTIES.frameType==sap.m.FrameType.TwoByOne){t.oKpiTileView.oGenericTile.setFrameType(sap.m.FrameType.TwoByOne);t.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());var c={};c.data=this.CALCULATED_KPI_VALUE;t.getView().getViewData().deferredObj.resolve();}else{t.oKpiTileView.oGenericTile.setFrameType(sap.m.FrameType.OneByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.oKpiTileView.oGenericTile.addTileContent(t.oKpiTileView.oNVConfS);this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}this.setToolTip(null,this.CALCULATED_KPI_VALUE,"COMP");if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},this.logError);},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({value:8888,size:sap.m.Size.Auto,frameType:sap.m.FrameType.OneByOne,state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Error,indicator:sap.m.DeviationIndicator.None,title:"Liquidity Structure",footer:"Current Quarter",description:"Apr 1st 2013 (B$)",data:[{title:"Measure 1",value:1.2,color:"Good"},{title:"Measure 2",value:0.78,color:"Good"},{title:"Measure 3",value:1.4,color:"Error"}]});this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}});return C;});
sap.ui.predefine('sap/ushell/components/tiles/indicatorcontribution/ContributionTile.controller',['sap/ushell/components/tiles/generic'],function(g){"use strict";var C=g.extend("sap.ushell.components.tiles.indicatorcontribution.ContributionTile",{onInit:function(){this.KPI_VALUE_REQUIRED=false;},_processDataForComparisonChart:function(d,m,a,u){var s=this.oConfig.TILE_PROPERTIES.semanticColorContribution;var f=[];var t;var b;for(var i=0;i<d.results.length;i++){var h=d.results[i];var j={};try{j.title=h[a].toString();}catch(e){j.title="";}j.value=Number(h[m]);var k=Number(h[m]);if(this.oConfig.EVALUATION.SCALING==-2){k*=100;}var c=this.isCurrencyMeasure(m);b=h[u];t=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(k,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,b);j.displayValue=t.toString();if(typeof s==='undefined'){j.color="Neutral";}else{j.color=s;}if(j&&u){j[u]=b;}f.push(j);}return f;},fetchChartData:function(r,i,s,E){var t=this;try{var u=this.oConfig.EVALUATION.ODATA_URL;var a=this.oConfig.EVALUATION.ODATA_ENTITYSET;t.setThresholdValues();if(this.oConfig.TILE_PROPERTIES.semanticMeasure){var m=this.oConfig.EVALUATION.COLUMN_NAME+","+this.oConfig.TILE_PROPERTIES.semanticMeasure;}else{var m=this.oConfig.EVALUATION.COLUMN_NAME;}var b=null;var d=this.oConfig.TILE_PROPERTIES.dimension;this.oConfig.EVALUATION_VALUES;var c=sap.ushell.components.tiles.indicatorTileUtils.util.getBoolValue(r);var f=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){if(f){var h=f.Data&&JSON.parse(f.Data);}}var j=t.oTileApi.configuration.getParameterValueAsString("timeStamp");var k=sap.ushell.components.tiles.indicatorTileUtils.util.isCacheValid(t.oConfig.TILE_PROPERTIES.id,j,t.chipCacheTime,t.chipCacheTimeUnit,t.tilePressed);if((h&&!h.rightData)||!f||(!k&&t.oTileApi.visible.isVisible())||c||(i&&t.oTileApi.visible.isVisible())||t.getView().getViewData().refresh){if(t.kpiValueFetchDeferred){t.kpiValueFetchDeferred=false;var v=sap.ushell.components.tiles.indicatorTileUtils.util.prepareFilterStructure(this.oConfig.EVALUATION_FILTERS,this.oConfig.ADDITIONAL_FILTERS);var o={};o["0"]=m+",asc";o["1"]=m+",desc";o["2"]=d+",asc";o["3"]=d+",desc";var l=o[this.oConfig.TILE_PROPERTIES.sortOrder||"0"].split(",");var n=sap.ushell.components.tiles.indicatorTileUtils.util.prepareQueryServiceUri(t.oRunTimeODataModel,a,m,d,v,3);if(this.oConfig.TILE_PROPERTIES.semanticMeasure){n.uri+="&$top=3&$orderby="+l[0]+" "+l[2];}else{n.uri+="&$top=3&$orderby="+l[0]+" "+l[1];}this.comparisionChartODataRef=n.model.read(n.uri,null,null,true,function(w){t.kpiValueFetchDeferred=true;var x={};if(w&&w.results&&w.results.length){if(n.unit[0]){t._updateTileModel({unit:w.results[0][n.unit[0].name]});b=n.unit[0].name;x.unit=n.unit[0];x.unit.name=n.unit[0].name;}d=sap.ushell.components.tiles.indicatorTileUtils.util.findTextPropertyForDimension(t.oRunTimeODataModel,a,d);x.dimension=d;t.oConfig.TILE_PROPERTIES.FINALVALUE=w;t.oConfig.TILE_PROPERTIES.FINALVALUE=t._processDataForComparisonChart(t.oConfig.TILE_PROPERTIES.FINALVALUE,m.split(",")[0],d,b);x.data=t.oConfig.TILE_PROPERTIES.FINALVALUE;x.isCurM=t.isACurrencyMeasure(t.oConfig.EVALUATION.COLUMN_NAME);var y={};t.cacheTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();y.ChipId=t.oConfig.TILE_PROPERTIES.id;y.Data=JSON.stringify(x);y.CacheMaxAge=Number(t.chipCacheTime);y.CacheMaxAgeUnit=t.chipCacheTimeUnit;y.CacheType=1;var z=t.getLocalCache(y);t.updateDatajobScheduled=false;var A=t.oConfig.TILE_PROPERTIES.id+"data";var B=sap.ushell.components.tiles.indicatorTileUtils.util.getScheduledJob(A);if(B){clearTimeout(B);B=undefined;}if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,z);var U=false;if(f){U=true;}if(t.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.writeFrontendCacheByChipAndUserId(t.oTileApi,t.oConfig.TILE_PROPERTIES.id,y,U,function(w){if(w){t.cacheTime=w&&w.CachedTime;sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,w);}if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}});}}else{var D=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);if(D){if(!D.CachedTime){D.CachedTime=sap.ushell.components.tiles.indicatorTileUtils.util.getUTCDate();}var F=D.Data;if(F){F=JSON.parse(F);if(t.oKpiTileView.getViewName()=="tiles.indicatornumeric.NumericTile"){F.leftData=x;}else{F.rightData=x;}}D.Data=JSON.stringify(F);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,D);}else{var F={};F.rightData=x;z.Data=JSON.stringify(F);sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,z);}t.cacheWriteData=x;}s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(w.results.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=w;if(sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id)){x=sap.ushell.components.tiles.indicatorTileUtils.cache.getKpivalueById(t.oConfig.TILE_PROPERTIES.id);x.data=w;}else{x.data=w;}sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,x);s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{sap.ushell.components.tiles.indicatorTileUtils.cache.setKpivalueById(t.oConfig.TILE_PROPERTIES.id,{empty:"empty"});t.setNoData();}},function(w){t.kpiValueFetchDeferred=true;if(w&&w.response){jQuery.sap.log.error(w.message+" : "+w.request.requestUri);E.call(t,w);}});}}else{if(f&&f.Data){var p;var q=t.oConfig&&t.oConfig.TILE_PROPERTIES&&t.oConfig.TILE_PROPERTIES.tileType;if(q.indexOf("DT-")==-1){p=f.Data&&JSON.parse(f.Data);}else{p=f.Data&&JSON.parse(f.Data);p=p.rightData;}t.cacheTime=f.CachedTime;if(t.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(t.oConfig)){jQuery.proxy(t.setTimeStamp(t.cacheTime),t);}if(p.data&&p.data.length){if(p.unit){t._updateTileModel({unit:p.data[0][p.unit.name]});}d=p.dimension;t.oConfig.TILE_PROPERTIES.FINALVALUE=p.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);}else if(p&&p.data&&p.data instanceof Array&&p.data.length==0){t.oConfig.TILE_PROPERTIES.FINALVALUE=p.data;s.call(t,t.oConfig.TILE_PROPERTIES.FINALVALUE);t.setNoData();}else{t.setNoData();}}else{t.setNoData();}}}catch(e){t.kpiValueFetchDeferred=true;E.call(t,e);}},doProcess:function(r,i){var t=this;this.DEFINITION_DATA=this.oConfig;this._updateTileModel(this.DEFINITION_DATA);this.setTextInTile();this.fetchChartData(r,i,function(k){this.CALCULATED_KPI_VALUE=k;this._updateTileModel({data:this.CALCULATED_KPI_VALUE});if(t.oConfig.TILE_PROPERTIES.frameType==sap.m.FrameType.TwoByOne){t.oKpiTileView.oGenericTile.setFrameType(sap.m.FrameType.TwoByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());t.getView().getViewData().deferredObj.resolve();}else{t.oKpiTileView.oGenericTile.setFrameType(sap.m.FrameType.OneByOne);t.oKpiTileView.oGenericTile.removeAllTileContent();t.oKpiTileView.oGenericTile.addTileContent(t.oKpiTileView.oNVConfS);this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}this.setToolTip(null,this.CALCULATED_KPI_VALUE,"CONT");if(this.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}},this.logError);},doDummyProcess:function(){var t=this;t.setTextInTile();t._updateTileModel({value:8888,size:sap.m.Size.Auto,frameType:sap.m.FrameType.OneByOne,state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Error,indicator:sap.m.DeviationIndicator.None,title:"US Profit Margin",footer:"Current Quarter",description:"Maximum deviation",data:[{title:"Americas",value:10,color:"Neutral"},{title:"EMEA",value:50,color:"Neutral"},{title:"APAC",value:-20,color:"Neutral"}]});this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}});return C;});
sap.ui.predefine('sap/ushell/components/tiles/indicatordeviation/DeviationTile.controller',['sap/ushell/components/tiles/generic'],function(g){"use strict";var D=g.extend("sap.ushell.components.tiles.indicatordeviation.DeviationTile",{onInit:function(){this.KPI_VALUE_REQUIRED=true;},doProcess:function(k,t){var a=this;var f,b;f=t.targetValue;var d=Number(k);var e=this.setThresholdValues();if(this.oConfig.EVALUATION.SCALING==-2){d*=100;}var c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);b=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(d),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);this.CALCULATED_KPI_VALUE=Number(k);var h={};var i=this.getThresholdsObjAndColor(t).returnColor;var j={value:Number(k),color:i};h.actualValueLabel=b.toString();h.actual=j;h.thresholds=[];h.thresholds=this.getThresholdsObjAndColor(t).arrObj;var l=this.DEFINITION_DATA.EVALUATION_VALUES;if(this.DEFINITION_DATA.EVALUATION.VALUES_SOURCE=="MEASURE"){var m=Number(f);if(this.oConfig.EVALUATION.SCALING==-2){m*=100;}c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(m,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);h.targetValue=Number(m);h.targetValueLabel=f.toString();}else{for(var n=0;n<l.length;n++){if(l[n].TYPE==="TA"){var m=Number(f);if(this.oConfig.EVALUATION.SCALING==-2){m*=100;}c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);f=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(m,this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);h.targetValue=Number(m);h.targetValueLabel=f.toString();}}}if(this.oConfig.EVALUATION.SCALING==-2){h.scale="%";}this._updateTileModel(h);if(this.DEFINITION_DATA.TILE_PROPERTIES.frameType==sap.m.FrameType.TwoByOne){a.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());a.getView().getViewData().deferredObj.resolve();sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(a.oConfig.TILE_PROPERTIES.id+"defferedRight",false);}else{this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}this.setToolTip(i,d,"DT");if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){if(a.chipCacheTime&&!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,this.oTileApi.visible.isVisible());}}},getThresholdsObjAndColor:function(t){try{var T={};T.arrObj=[];T.returnColor=sap.m.ValueColor.Neutral;var i=this.DEFINITION_DATA.EVALUATION.GOAL_TYPE;var w,c,a,b;if(i==="MI"){a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;if(a&&b){a=window.parseFloat(a);b=window.parseFloat(b);T.arrObj.push({value:a,color:sap.m.ValueColor.Error});T.arrObj.push({value:b,color:sap.m.ValueColor.Critical});if(this.CALCULATED_KPI_VALUE<b){T.returnColor=sap.m.ValueColor.Good;}else if(this.CALCULATED_KPI_VALUE<=a){T.returnColor=sap.m.ValueColor.Critical;}else{T.returnColor=sap.m.ValueColor.Error;}}}else if(i==="MA"){c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(c&&w){c=window.parseFloat(c);w=window.parseFloat(w);T.arrObj.push({value:c,color:sap.m.ValueColor.Error});T.arrObj.push({value:w,color:sap.m.ValueColor.Critical});if(this.CALCULATED_KPI_VALUE<c){T.returnColor=sap.m.ValueColor.Error;}else if(this.CALCULATED_KPI_VALUE<=w){T.returnColor=sap.m.ValueColor.Critical;}else{T.returnColor=sap.m.ValueColor.Good;}}}else{a=Number(t.criticalHighValue)||0;b=Number(t.warningHighValue)||0;c=Number(t.criticalLowValue)||0;w=Number(t.warningLowValue)||0;if(w&&b&&c&&c){a=window.parseFloat(a);b=window.parseFloat(b);w=window.parseFloat(w);c=window.parseFloat(c);T.arrObj.push({value:a,color:sap.m.ValueColor.Error});T.arrObj.push({value:b,color:sap.m.ValueColor.Critical});T.arrObj.push({value:w,color:sap.m.ValueColor.Critical});T.arrObj.push({value:c,color:sap.m.ValueColor.Error});if(this.CALCULATED_KPI_VALUE<c||this.CALCULATED_KPI_VALUE>a){T.returnColor=sap.m.ValueColor.Error;}else if((this.CALCULATED_KPI_VALUE>=c&&this.CALCULATED_KPI_VALUE<=w)||(this.CALCULATED_KPI_VALUE>=b&&this.CALCULATED_KPI_VALUE<=a)){T.returnColor=sap.m.ValueColor.Critical;}else{T.returnColor=sap.m.ValueColor.Good;}}}return T;}catch(e){this.logError(e);}},doDummyProcess:function(){var t=this;this.setTextInTile();t._updateTileModel({actual:{value:120,color:sap.m.ValueColor.Good},targetValue:100,thresholds:[{value:0,color:sap.m.ValueColor.Error},{value:50,color:sap.m.ValueColor.Critical},{value:150,color:sap.m.ValueColor.Critical},{value:200,color:sap.m.ValueColor.Error}],showActualValue:true,showTargetValue:true});this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}});return D;});
sap.ui.predefine('sap/ushell/components/tiles/indicatornumeric/NumericTile.controller',['sap/ushell/components/tiles/generic'],function(g){"use strict";var N=g.extend("sap.ushell.components.tiles.indicatornumeric.NumericTile",{onInit:function(){this.KPI_VALUE_REQUIRED=true;},doProcess:function(k,t){var a=this;this.CALCULATED_KPI_VALUE=k;this.DEFINITION_DATA.EVALUATION_VALUES;var b=this.getTrendColor(t);var d=this.getTrendIndicator(t.trendValue);var s="";var e=this.CALCULATED_KPI_VALUE;if(this.oConfig.EVALUATION.SCALING==-2){e*=100;this.getView().oNVConfContS.setFormatterValue(false);}var c=this.isCurrencyMeasure(this.oConfig.EVALUATION.COLUMN_NAME);s=sap.ushell.components.tiles.indicatorTileUtils.util.getLocaleFormattedValue(Number(e),this.oConfig.EVALUATION.SCALING,this.oConfig.EVALUATION.DECIMAL_PRECISION,c,this.CURRENCY_CODE);if(this.oConfig.EVALUATION.SCALING==-2){this._updateTileModel({scale:"%"});}this._updateTileModel({value:s.toString(),valueColor:b,indicator:d});if(a.oConfig.TILE_PROPERTIES.frameType==sap.m.FrameType.OneByOne){this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);this.setToolTip(b,e,"NT");}else{a.getView().getViewData().parentController._updateTileModel(this.getTile().getModel().getData());a.getView().getViewData().deferredObj.resolve();sap.ushell.components.tiles.indicatorTileUtils.util.setUnsetCallInProgress(a.oConfig.TILE_PROPERTIES.id+"defferedLeft",false);}this.setToolTip(b,e,"NT");if(!sap.ushell.components.tiles.indicatorTileUtils.util.isDualTile(this.oConfig)){if(a.chipCacheTime){sap.ushell.components.tiles.indicatorTileUtils.util.scheduleFetchDataJob.call(this,a.oTileApi.visible.isVisible());}}},doDummyProcess:function(){var t=this;this.setTextInTile();if(!(t.oConfig.BLANKTILE||t.oConfig.TILE_PROPERTIES.blankTile)){t._updateTileModel({value:"10.34",scale:"M",valueColor:sap.m.ValueColor.Neutral,indicator:sap.m.DeviationIndicator.None});}else{this.oKpiTileView.oNVConfContS.setIcon('sap-icon://BusinessSuiteInAppSymbols/icon-multiple-charts');}this.oKpiTileView.oGenericTile.setState(sap.m.LoadState.Loaded);}});return N;});
sap.ui.predefine('sap/ushell/components/tiles/indicatornumeric/NumericTile.view',['sap/ui/core/mvc/JSView','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("sap.ushell.components.tiles.indicatornumeric.NumericTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatornumeric.NumericTile";},createContent:function(c){var h="Lorem ipsum";var a="Lorem ipsum";var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;a=t.subTitle;}var g={subheader:a,header:h,footerNum:"",footerComp:"",scale:"",unit:"",value:"",size:"Auto",frameType:"OneByOne",state:sap.m.LoadState.Loading,valueColor:sap.m.ValueColor.Neutral,indicator:sap.m.DeviationIndicator.None,title:"",footer:"",description:""};this.oNVConfContS=new sap.m.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",valueColor:"{/valueColor}",size:"{/size}",formatterValue:true,truncateValueTo:5,nullifyValue:false});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oNVConfContS});this.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var G=new sap.ui.model.json.JSONModel();G.setData(g);this.oGenericTile.setModel(G);return this.oGenericTile;}});},true);
// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncher/Component',["sap/ui/core/UIComponent"],function(U){"use strict";return U.extend("sap.ushell.components.tiles.cdm.applauncher.Component",{metadata:{},createContent:function(){var c=this.getComponentData();var p=c.properties.tilePersonalization||{};var s=c.startupParameters;if(s&&s["sap-system"]){p["sap-system"]=s["sap-system"][0];}var t=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.tiles.cdm.applauncher.StaticTile",viewData:{properties:c.properties,configuration:p},async:true});t.loaded().then(function(v){this._oController=t.getController();}.bind(this));return t;},tileSetVisualProperties:function(n){if(this._oController){this._oController.updatePropertiesHandler(n);}},tileRefresh:function(){},tileSetVisible:function(i){},exit:function(){this._oController=null;}});});
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncher/StaticTile.controller',['sap/ui/core/mvc/Controller','sap/ushell/components/applicationIntegration/AppLifeCycle','sap/ushell/Config'],function(C,A,a){"use strict";return C.extend("sap.ushell.components.tiles.cdm.applauncher.StaticTile",{_aDoableObject:{},_getConfiguration:function(){var c=this.getView().getViewData();c.properties.sizeBehavior=a.last("/core/home/sizeBehavior");c.properties.wrappingType=a.last("/core/home/wrappingType");return c;},onInit:function(){var v=this.getView();var m=new sap.ui.model.json.JSONModel();m.setData(this._getConfiguration());v.setModel(m);this._aDoableObject=a.on("/core/home/sizeBehavior").do(function(s){m.setProperty("/properties/sizeBehavior",s);});},onExit:function(){this._aDoableObject.off();},onPress:function(e){var c=this.getView().getViewData().properties,r={},R=sap.ushell.Container.getRenderer("fiori2");if(e.getSource().getScope&&e.getSource().getScope()===sap.m.GenericTileScope.Display){var t=this._createTargetUrl();if(!t){return;}if(t[0]==='#'){hasher.setHash(t);}else{r.title=c.title;r.appType="App";r.url=c.targetURL;r.appId=c.targetURL;R.logRecentActivity(r);window.open(t,'_blank');}}},updatePropertiesHandler:function(n){var t=this.getView().getContent()[0],T=t.getTileContent()[0];if(typeof n.title!=='undefined'){t.setHeader(n.title);}if(typeof n.subtitle!=='undefined'){t.setSubheader(n.subtitle);}if(typeof n.icon!=='undefined'){T.getContent().setSrc(n.icon);}if(typeof n.info!=='undefined'){T.setFooter(n.info);}},_createTargetUrl:function(){var t=this.getView().getViewData().properties.targetURL,s=this.getView().getViewData().configuration["sap-system"],u,h;if(t&&s){u=sap.ushell.Container.getService("URLParsing");if(u.isIntentUrl(t)){h=u.parseShellHash(t);if(!h.params){h.params={};}h.params["sap-system"]=s;t="#"+u.constructShellHash(h);}else{t+=((t.indexOf("?")<0)?"?":"&")+"sap-system="+s;}}return t;},_getCurrentProperties:function(){var t=this.getView().getContent()[0],T=t.getTileContent()[0],s=a.last("/core/home/sizeBehavior");return{title:t.getHeader(),subtitle:t.getSubheader(),info:T.getFooter(),icon:T.getContent().getSrc(),sizeBehavior:s};}});},true);
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncher/StaticTile.view',["sap/m/GenericTile","sap/m/ImageContent","sap/m/TileContent","sap/ui/core/mvc/JSView"],function(G,I,T){"use strict";sap.ui.jsview("sap.ushell.components.tiles.cdm.applauncher.StaticTile",{getControllerName:function(){return"sap.ushell.components.tiles.cdm.applauncher.StaticTile";},createContent:function(c){var v=this.getViewData().properties;this.setHeight('100%');this.setWidth('100%');return new G({header:v.title,subheader:v.subtitle,size:'Auto',sizeBehavior:'{/properties/sizeBehavior}',wrappingType:'{/properties/wrappingType}',tileContent:new T({size:"Auto",footer:v.info,content:new I({src:v.icon})}),press:[c.onPress,c]});}});});
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncherdynamic/Component',["sap/ui/core/UIComponent"],function(U){"use strict";return U.extend("sap.ushell.components.tiles.cdm.applauncherdynamic.Component",{metadata:{},createContent:function(){var c=this.getComponentData();var p=c.properties||{};var P=p.tilePersonalization||{};var i=p.indicatorDataSource;if(i&&i.path){P.serviceUrl=i.path;P.serviceRefreshInterval=i.refresh;}var s=c.startupParameters;if(s&&s["sap-system"]&&s["sap-system"][0]){P["sap-system"]=s["sap-system"][0];}if(P.serviceUrl&&P.serviceUrl.charAt(0)!=="/"&&p.dataSource&&p.dataSource.uri){var S=p.dataSource.uri;if(P["sap-system"]){if(S.charAt(S.length-1)==="/"){S=S.slice(0,S.length-1);}S+=";o="+P["sap-system"];}if(S.charAt(S.length-1)!=="/"){S+="/";}S+=P.serviceUrl;P.serviceUrl=S;}var t=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile",viewData:{properties:p,configuration:P},async:true});t.loaded().then(function(v){this._oController=t.getController();this.tileRefresh();}.bind(this));return t;},tileSetVisualProperties:function(n){if(this._oController){this._oController.updateVisualPropertiesHandler(n);}},tileRefresh:function(){if(this._oController){this._oController.refreshHandler();}},tileSetVisible:function(i){if(this._oController){this._oController.visibleHandler(i);}},exit:function(){this._oController=null;}});});
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncherdynamic/DynamicTile.controller',['sap/ui/core/mvc/Controller','sap/ushell/components/tiles/utils','sap/ui/core/format/NumberFormat','sap/ushell/Config','sap/ui/thirdparty/datajs'],function(C,u,N,a,O){"use strict";return C.extend("sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile",{timer:null,_aDoableObject:{},oDataRequest:null,_getConfiguration:function(){var v=this.getView().getViewData(),c={},U,h;c.configuration=v.configuration;c.properties=v.properties;c.properties.info=c.properties.info||"";c.properties.number_value='...';c.properties.number_value_state='Neutral';c.properties.number_state_arrow='None';c.properties.number_factor='';c.properties.number_unit='';var s=c.configuration["sap-system"];var t=c.properties.targetURL;if(t&&s){U=sap.ushell.Container.getService("URLParsing");if(U.isIntentUrl(t)){h=U.parseShellHash(t);if(!h.params){h["params"]={};}h.params["sap-system"]=s;t="#"+U.constructShellHash(h);}else{t+=((t.indexOf("?")<0)?"?":"&")+"sap-system="+s;}c.properties.targetURL=t;}c.properties.sizeBehavior=a.last("/core/home/sizeBehavior");c.properties.wrappingType=a.last("/core/home/wrappingType");return c;},onInit:function(){var v=this.getView();var m=new sap.ui.model.json.JSONModel();m.setData(this._getConfiguration());v.setModel(m);this._aDoableObject=a.on("/core/home/sizeBehavior").do(function(s){m.setProperty("/properties/sizeBehavior",s);});},refreshHandler:function(){this.loadData(0);},visibleHandler:function(i){if(i){if(!this.oDataRequest){this.refreshHandler(this);}}else{this.stopRequests();}},updateVisualPropertiesHandler:function(n){var p=this.getView().getModel().getProperty("/properties");var c=false;if(typeof n.title!=='undefined'){p.title=n.title;c=true;}if(typeof n.subtitle!=='undefined'){p.subtitle=n.subtitle;c=true;}if(typeof n.icon!=='undefined'){p.icon=n.icon;c=true;}if(typeof n.targetURL!=='undefined'){p.targetURL=n.targetURL;c=true;}if(typeof n.info!=='undefined'){p.info=n.info;c=true;}if(c){this.getView().getModel().setProperty("/properties",p);}},stopRequests:function(){if(this.timer){clearTimeout(this.timer);}if(this.oDataRequest){try{this.oDataRequest.abort();}catch(e){jQuery.sap.log.warning(e.name,e.message);}}},onPress:function(e){var r={},R=sap.ushell.Container.getRenderer("fiori2");if(e.getSource().getScope&&e.getSource().getScope()===sap.m.GenericTileScope.Display){var t=this.getView().getModel().getProperty("/properties/targetURL"),T=this.getView().getModel().getProperty("/properties/title");if(!t){return;}else if(t[0]==='#'){hasher.setHash(t);}else{r.title=T;r.appType="App";r.url=t;r.appId=t;R.logRecentActivity(r);window.open(t,'_blank');}}},initUpdateDynamicData:function(){var v=this.getView(),s=v.getModel().getProperty("/configuration/serviceUrl"),S=v.getModel().getProperty("/configuration/serviceRefreshInterval");if(!S){S=0;}else if(S<10){jQuery.sap.log.warning("Refresh Interval "+S+" seconds for service URL "+s+" is less than 10 seconds, which is not supported. Increased to 10 seconds automatically.",null,"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile.controller");S=10;}if(s){this.loadData(S);}},extractData:function(d){var n,k=["results","icon","title","number","numberUnit","info","infoState","infoStatus","targetParams","subtitle","stateArrow","numberState","numberDigits","numberFactor"];if(typeof d==="object"&&Object.keys(d).length===1){n=Object.keys(d)[0];if(jQuery.inArray(n,k)===-1){return d[n];}}return d;},successHandleFn:function(r){var c=this.getView().getModel().getProperty("/configuration");var d=r;this.oDataRequest=undefined;if(typeof r==="object"){var b=jQuery.sap.getUriParameters(c.serviceUrl).get("$inlinecount");if(b&&b==="allpages"){d={number:r.__count};}else{d=this.extractData(d);}}else if(typeof r==="string"){d={number:r};}this.updatePropertiesHandler(d);},errorHandlerFn:function(m){this.oDataRequest=undefined;var M=m&&m.message?m.message:m,r=u.getResourceBundleModel().getResourceBundle(),U=this.getView().getModel().getProperty("/configuration/serviceUrl");if(m.response){M+=" - "+m.response.statusCode+" "+m.response.statusText;}jQuery.sap.log.error("Failed to update data via service "+U+": "+M,null,"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile");this.updatePropertiesHandler({number:"???",info:r.getText("dynamic_data.error")});},loadData:function(s){var U=this.getView().getModel().getProperty("/configuration/serviceUrl"),l,S;if(!U){return;}if(s>0){jQuery.sap.log.info("Wait "+s+" seconds before calling "+U+" again",null,"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile.controller");this.timer=setTimeout(this.loadData.bind(this,s,false),(s*1000));}if(!this.oDataRequest){if(sap.ushell.Container){l=sap.ushell.Container.getUser().getLanguage();S=sap.ushell.Container.getLogonSystem()?sap.ushell.Container.getLogonSystem().getClient():"";}if((l)&&(U.indexOf("sap-language=")==-1)){U=U+(U.indexOf("?")>=0?"&":"?")+"sap-language="+l;}this.oDataRequest=O.read({requestUri:U,headers:{"Cache-Control":"no-cache, no-store, must-revalidate","Pragma":"no-cache","Expires":"0","Accept-Language":(sap.ui&&sap.ui.getCore().getConfiguration().getLanguage())||"","sap-client":(S||""),"sap-language":(l||"")}},this.successHandleFn.bind(this),this.errorHandlerFn.bind(this));}},onExit:function(){this.stopRequests();this._aDoableObject.off();},addParamsToUrl:function(U,t){var p="",b=U.indexOf("?")!==-1,i;if(t&&t.length>0){for(i=0;i<t.length;i=i+1){p+=t[i];if(i<t.length-1){p+="&";}}}if(p.length>0){if(!b){U+="?";}else{U+="&";}U+=p;}return U;},_normalizeNumber:function(n,m,b,i){var c;if(isNaN(n)){c=n;}else{var o=sap.ui.core.format.NumberFormat.getFloatInstance({maxFractionDigits:i});if(!b){var d=Math.abs(n);if(d>=1000000000){b='B';n/=1000000000;}else if(d>=1000000){b='M';n/=1000000;}else if(d>=1000){b='K';n/=1000;}}c=o.format(n);}var e=c;var f=e[m-1];m-=(f==='.'||f===',')?1:0;e=e.substring(0,m);return{displayNumber:e,numberFactor:b};},updatePropertiesHandler:function(d){var e=u.getResourceBundleModel().getResourceBundle().getText("dynamic_data.error");var b=0,i,n,c,s,p=this.getView().getModel().getProperty("/properties"),U={title:d.title||p.title||"",subtitle:d.subtitle||p.subtitle||"",icon:d.icon||p.icon||"",targetURL:d.targetURL||p.targetURL||"",number_value:!isNaN(d.number)?d.number:"...",number_digits:d.numberDigits>=0?d.numberDigits:4,info:p.info==e?d.info||"":d.info||p.info||"",number_unit:d.numberUnit||p.number_unit||"",number_state_arrow:d.stateArrow||p.number_state_arrow||"None",number_value_state:d.numberState||p.number_value_state||"Neutral",number_factor:d.numberFactor||p.number_factor||""};var t=[];if(d.targetParams){t.push(d.targetParams);}if(d.results){for(i=0,n=d.results.length;i<n;i=i+1){c=d.results[i].number||0;if(typeof c==="string"){c=parseInt(c,10);}b=b+c;s=d.results[i].targetParams;if(s){t.push(s);}}U.number_value=b;}if(t.length>0){U.targetURL=this.addParamsToUrl(U.targetURL,t);}if(!isNaN(d.number)){if(typeof d.number==="string"){d.number=d.number.trim();}var S=this._shouldProcessDigits(d.number,d.numberDigits),m=U.icon?4:5;if(d.number&&d.number.length>=m||S){var o=this._normalizeNumber(d.number,m,d.numberFactor,d.numberDigits);U.number_factor=o.numberFactor;U.number_value=o.displayNumber;}else{var f=N.getFloatInstance({maxFractionDigits:m});U.number_value=f.format(d.number);}}if(U.number_value_state){switch(U.number_value_state){case"Positive":U.number_value_state="Good";break;case"Negative":U.number_value_state="Error";break;}}U.sizeBehavior=a.last("/core/home/sizeBehavior");this.getView().getModel().setProperty("/properties",U);},_shouldProcessDigits:function(d,D){var n;d=typeof(d)!=='string'?d.toString():d;if(d.indexOf('.')!==-1){n=d.split(".")[1].length;if(n>D){return true;}}return false;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/cdm/applauncherdynamic/DynamicTile.view',['sap/m/GenericTile','sap/m/TileContent','sap/m/NumericContent'],function(G,T,N){"use strict";sap.ui.jsview("sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile",{getControllerName:function(){return"sap.ushell.components.tiles.cdm.applauncherdynamic.DynamicTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');return new G({size:'Auto',header:'{/properties/title}',subheader:'{/properties/subtitle}',sizeBehavior:'{/properties/sizeBehavior}',wrappingType:'{/properties/wrappingType}',tileContent:[new T({size:'Auto',footer:'{/properties/info}',footerColor:{path:"/data/display_info_state",formatter:function(f){if(!sap.m.ValueColor[f]){f=sap.m.ValueColor.Neutral;}return f;}},unit:'{/properties/number_unit}',content:[new N({truncateValueTo:5,scale:'{/properties/number_factor}',value:'{/properties/number_value}',indicator:'{/properties/number_state_arrow}',valueColor:{path:"/data/display_number_state",formatter:function(v){if(!sap.m.ValueColor[v]){v=sap.m.ValueColor.Neutral;}return v;}},icon:'{/properties/icon}',width:'100%'})]})],press:[c.onPress,c]});}});});
sap.ui.predefine('sap/ushell/components/tiles/indicatorArea/AreaChartTile.view',['sap/ui/core/mvc/JSView','sap/ushell/components/tiles/indicatorTileUtils/oData4Analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatorArea.AreaChartTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorArea.AreaChartTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var h="Lorem ipsum";var a="Lorem ipsum";var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;a=t.subTitle;}var b=function(n){return new sap.suite.ui.microchart.AreaMicroChartItem({color:"Good",points:{path:"/"+n+"/data",template:new sap.suite.ui.microchart.AreaMicroChartPoint({x:"{day}",y:"{balance}"})}});};var d=function(n){return new sap.suite.ui.microchart.AreaMicroChartLabel({label:"{/"+n+"/label}",color:"{/"+n+"/color}"});};var g={subheader:a,header:h,footerNum:"",footerComp:"",scale:"",unit:"",value:8888,size:"Auto",frameType:"OneByOne",state:sap.m.LoadState.Loading};this.oNVConfContS=new sap.suite.ui.microchart.AreaMicroChart({width:"{/width}",height:"{/height}",size:"{/size}",target:b("target"),innerMinThreshold:b("innerMinThreshold"),innerMaxThreshold:b("innerMaxThreshold"),minThreshold:b("minThreshold"),maxThreshold:b("maxThreshold"),chart:b("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:d("firstXLabel"),lastXLabel:d("lastXLabel"),firstYLabel:d("firstYLabel"),lastYLabel:d("lastYLabel"),minLabel:d("minLabel"),maxLabel:d("maxLabel")});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oNVConfContS});this.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var G=new sap.ui.model.json.JSONModel();G.setData(g);this.oGenericTile.setModel(G);return this.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualComparison/DualComparison.view',['sap/ui/core/mvc/JSView','sap/ca/ui/model/format/NumberFormat','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,N,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("tiles.indicatorDualComparison.DualComparison",{getControllerName:function(){return"tiles.indicatorDualComparison.DualComparison";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.tileData;t.oGenericTileData={};t.oNumericContent=new sap.m.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new sap.m.TileContent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});t.oCmprsDataTmpl=new sap.suite.ui.microchart.ComparisonMicroChartData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new sap.suite.ui.microchart.ComparisonMicroChart({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oComparisonTile=new sap.m.TileContent({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,t.oComparisonTile]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualContribution/DualContribution.view',['sap/ui/core/mvc/JSView','sap/ca/ui/model/format/NumberFormat','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,N,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("tiles.indicatorDualContribution.DualContribution",{getControllerName:function(){return"tiles.indicatorDualContribution.DualContribution";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.oGenericTileData={};t.oNumericContent=new sap.m.NumericContent({value:"{/value}",scale:"{/scale}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new sap.m.TileContent({unit:"{/unitNumeric}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});t.oCmprsDataTmpl=new sap.suite.ui.microchart.ComparisonMicroChartData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new sap.suite.ui.microchart.ComparisonMicroChart({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oComparisonTile=new sap.m.TileContent({unit:"{/unitContribution}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,t.oComparisonTile]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualDeviation/DualDeviation.view',['sap/ui/core/mvc/JSView','sap/ca/ui/model/format/NumberFormat','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,N,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("tiles.indicatorDualDeviation.DualDeviation",{getControllerName:function(){return"tiles.indicatorDualDeviation.DualDeviation";},createContent:function(c){var t=this;this.setHeight('100%');this.setWidth('100%');var h="Lorem ipsum";var a="Lorem ipsum";var b=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(b.title&&b.subTitle){h=b.title;a=b.subTitle;}var d={subheader:a,header:h,footerNum:"",footerComp:"",frameType:"TwoByOne",state:sap.m.LoadState.Loading,scale:""};t.oNumericContent=new sap.m.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});t.oNumericTile=new sap.m.TileContent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});var B=new sap.suite.ui.microchart.BulletMicroChartData({value:"{value}",color:"{color}"});t.oBCTmpl=new sap.suite.ui.microchart.BulletMicroChart({size:sap.m.Size.Auto,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:B,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});var n=new sap.m.TileContent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oBCTmpl});t.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNumericTile,n]});var g=new sap.ui.model.json.JSONModel();g.setData(d);t.oGenericTile.setModel(g);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorDualTrend/DualTrend.view',['sap/ui/core/mvc/JSView','sap/ca/ui/model/format/NumberFormat','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,N,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("tiles.indicatorDualTrend.DualTrend",{getControllerName:function(){return"tiles.indicatorDualTrend.DualTrend";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var b=function(h){return new sap.suite.ui.microchart.AreaMicroChartItem({color:"Good",points:{path:"/"+h+"/data",template:new sap.suite.ui.microchart.AreaMicroChartPoint({x:"{day}",y:"{balance}"})}});};var a=function(h){return new sap.suite.ui.microchart.AreaMicroChartLabel({label:"{/"+h+"/label}",color:"{/"+h+"/color}"});};var g={footer:"",header:"",subheader:""};var n=new sap.suite.ui.microchart.AreaMicroChart({width:"{/width}",height:"{/height}",size:"{/size}",target:b("target"),innerMinThreshold:b("innerMinThreshold"),innerMaxThreshold:b("innerMaxThreshold"),minThreshold:b("minThreshold"),maxThreshold:b("maxThreshold"),chart:b("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:a("firstXLabel"),lastXLabel:a("lastXLabel"),firstYLabel:a("firstYLabel"),lastYLabel:a("lastYLabel"),minLabel:a("minLabel"),maxLabel:a("maxLabel")});var d=new sap.m.TileContent({unit:"{/unit}",size:"{/size}",content:n});var e=new sap.m.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:true,truncateValueTo:6,valueColor:"{/valueColor}"});var f=new sap.m.TileContent({unit:"{/unit}",size:"{/size}",content:e});this.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"TwoByOne",size:"{/size}",header:"{/header}",tileContent:[f,d]});var G=new sap.ui.model.json.JSONModel();G.setData(g);this.oGenericTile.setModel(G);return this.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorcomparison/ComparisonTile.view',['sap/ui/core/mvc/JSView','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatorcomparison.ComparisonTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorcomparison.ComparisonTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.tileData;t.oGenericTileData={};t.oCmprsDataTmpl=new sap.suite.ui.microchart.ComparisonMicroChartData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new sap.suite.ui.microchart.ComparisonMicroChart({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNVConfS]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatorcontribution/ContributionTile.view',['sap/ui/core/mvc/JSView','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatorcontribution.ContributionTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorcontribution.ContributionTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.oGenericTileData={};t.oCmprsDataTmpl=new sap.suite.ui.microchart.ComparisonMicroChartData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oCmprsChrtTmpl=new sap.suite.ui.microchart.ComparisonMicroChart({size:"{/size}",scale:"{/scale}",data:{template:t.oCmprsDataTmpl,path:"/data"}});t.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerComp}",content:t.oCmprsChrtTmpl});t.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t.oNVConfS]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/indicatordeviation/DeviationTile.view',['sap/ui/core/mvc/JSView','sap/ui/model/analytics/odata4analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil'],function(J,o,s){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatordeviation.DeviationTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatordeviation.DeviationTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var h="Lorem ipsum";var a="Lorem ipsum";var t=sap.ushell.components.tiles.indicatorTileUtils.util.getTileTitleSubtitle(this.getViewData().chip);if(t.title&&t.subTitle){h=t.title;a=t.subTitle;}var d={subheader:a,header:h,footerNum:"",footerComp:"",frameType:"OneByOne",state:sap.m.LoadState.Loading,scale:""};var b=new sap.suite.ui.microchart.BulletMicroChartData({value:"{value}",color:"{color}"});this.oBCTmpl=new sap.suite.ui.microchart.BulletMicroChart({size:sap.m.Size.Auto,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:b,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});this.oNVConfS=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:this.oBCTmpl});this.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[this.oNVConfS]});var g=new sap.ui.model.json.JSONModel();g.setData(d);this.oGenericTile.setModel(g);return this.oGenericTile;}});},true);
sap.ui.predefine('sap/ushell/components/tiles/utils',["sap/ushell/components/tiles/utilsRT","sap/ushell/resources","sap/ui/thirdparty/datajs"],function(u,r,O){"use strict";var U={};U.isInitial=function(T){return T==="App Launcher – Static"||T==="App Launcher – Dynamic"||T==="Target Mapping";};U.getResourceBundleModel=function(){return r.i18nModel;};U.getEmptyRowObj=function(e){return{name:"",mandatory:false,value:"",isRegularExpression:false,defaultValue:"",valEnabled:false||!e,defValEnabled:true,editable:e};};U.getEmptyTileActionsRowObj=function(e){var R=U.getResourceBundleModel().getResourceBundle();return{menu_title:"",target_type:R.getText("configuration.tile_actions.table.target_type.url"),navigation_target:"",action:"",icon:"",isTargetTypeIntent:false,editable:e};};U.getTileNavigationActionsRows=function(T,e){var a=[],b=[];b=this.getTileNavigationActions(T);if(b.length){for(var i=0;i<b.length;i++){a.push(t(b[i],e));}}else{a=[this.getEmptyTileActionsRowObj(e)];}return a;};U.getTileNavigationActions=function(T){var a=[],s='';var b=T.bag.getBag('tileNavigationActions');if(b.getPropertyNames().indexOf('tile_navigation_actions')>=0){a=JSON.parse(b.getProperty('tile_navigation_actions'));for(var i=0;i<a.length;i++){if(a[i].text){if(b.getTextNames().indexOf('action_tile_'+(i+1))>=0){s=b.getText('action_tile_'+(i+1));}a[i].text=s;}}}return a;};var t=function(T,e){var a={},R=U.getResourceBundleModel().getResourceBundle();a.menu_title=T.text;a.icon=T.icon;if((T.targetURL).charAt(0)==="#"){a.target_type=R.getText("configuration.tile_actions.table.target_type.intent");var n=T.targetURL.split("-");a.navigation_target=n[0].substring(1,n[0].length);a.action=n[1];a.isTargetTypeIntent=true;}else{a.target_type=R.getText("configuration.tile_actions.table.target_type.url");a.navigation_target=T.targetURL;a.action="";a.isTargetTypeIntent=false;}a.editable=e;return a;};U.tileActionsRows2TileActionsArray=function(T){var a=[];for(var i=0;i<T.length;i++){if(T[i].menu_title){a.push(c(T[i]));}}return a;};var c=function(T){var o={};o.text=T.menu_title;o.icon=T.icon;if(T.action){o.targetURL="#"+T.navigation_target+"-"+T.action;}else{o.targetURL=T.navigation_target;}return o;};U.populateTileNavigationActionsBag=function(a,n){a.setProperty('tile_navigation_actions',JSON.stringify(n));for(var i=0;i<n.length;i++){var A=n[i].text;a.setText('action_tile_'+(i+1),A);}};U.getDefaultFormFactors=function(){return{"appDefault":false,"manual":{"desktop":true,"tablet":true,"phone":true},"defaultParam":true};};U.buildFormFactorsObject=function(m){return{"appDefault":m.getProperty("/config/appFormFactor"),"manual":{"desktop":m.getProperty("/config/desktopChecked"),"tablet":m.getProperty("/config/tabletChecked"),"phone":m.getProperty("/config/phoneChecked")}};};U.tableHasDuplicateParameterNames=function(T){var p={};for(var i=0;i<T.length;i++){var a=T[i].name;if(a!==""){if(p[a]){return true;}else{p[a]=true;}}}return false;};U.getMappingSignatureString=function(a,b){var m="";for(var i=0;i<a.length;i++){if(a[i].name){m+=(g(a[i])+"&");}}return b?m+"*=*":m.substring(0,m.length-1);};var g=function(a){var p="";if(a.mandatory){if(a.isRegularExpression){p="{"+a.name+"="+encodeURIComponent(a.value)+"}";}else{p=a.name+"="+encodeURIComponent(a.value);}}else{p="["+a.name+"="+encodeURIComponent(a.defaultValue)+"]";}return p;};U.getMappingSignatureTableData=function(m,e){var p=[];var a=m.split("&");for(var i=0;i<a.length;i++){var b=a[i];if(b!=="*=*"){p.push(d(a[i],e));}}return p;};var d=function(p,e){var a={};if(p.charAt(0)==="["){a.mandatory=false;a.isRegularExpression=false;a.value="";p=p.substring(1,p.length-1);a.name=p.substring(0,p.indexOf("="));a.defaultValue=decodeURIComponent(p.substring(p.indexOf("=")+1));}else{a.mandatory=true;a.defaultValue="";if(p.charAt(0)==="{"){a.isRegularExpression=true;p=p.substring(1,p.length-1);}else{a.isRegularExpression=false;}a.name=p.substring(0,p.indexOf("="));a.value=decodeURIComponent(p.substring(p.indexOf("=")+1));}a.editable=e;if(e){a.valEnabled=a.mandatory;a.defValEnabled=!a.mandatory;}else{a.valEnabled=true;a.defValEnabled=true;}return a;};U.getAllowUnknownParametersValue=function(m){if(m&&(m.substring(m.length-3,m.length)==="*=*")){return true;}else{return false;}};U.getMappingSignature=function(R,a){var A=a?"allowed":"ignored";var o=new RegExp("%%UserDefault[.].+%%");var m=[];var M={"parameters":{},"additional_parameters":A};R.forEach(function(b){M.parameters[b.name]={"required":b.mandatory,"rename_to":b.rename_to};if(b.defaultValue){m=o.exec(b.defaultValue);if(m){b.defaultValue=m[0];}M.parameters[b.name].defaultValue={"value":b.defaultValue};}if(b.value){m=o.exec(b.value);if(m){b.value=m[0];}M.parameters[b.name].filter={"value":b.value};if(b.isRegularExpression){M.parameters[b.name].filter.format="regexp";}}});return M;};U.getSignatureTableData=function(s,e){var p=[];var R={};var P={};var o=s.parameters;for(var k in o){P=o[k];R={};R.editable=e;R.name=k;R.mandatory=P.required;P.rename_to?R.rename_to=P.rename_to:R.rename_to=P.renameTo;if(e){R.valEnabled=R.mandatory;R.defValEnabled=!R.mandatory;}else{R.valEnabled=true;R.defValEnabled=true;}if(P.filter){R.value=P.filter.value;if(P.filter.format&&P.filter.format==="regexp"){R.isRegularExpression=true;}}if(P.defaultValue){R.defaultValue=P.defaultValue.value;}p.push(R);}return p;};U.getTranslatedTitle=function(T){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf("display_title_text")>=0){return b.getText('display_title_text');}}if(T.title){return T.title.getTitle();}if(T.preview){return T.preview.getTitle();}return"";};U.getTranslatedSubtitle=function(T,C){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf("display_subtitle_text")>=0){return b.getText('display_subtitle_text');}}if(typeof C['display_subtitle_text']==="string"){return C['display_subtitle_text'];}if(T.preview&&T.preview.getDescription&&T.preview.getDescription()){return T.preview.getDescription();}return'';};U.getTranslatedProperty=function(T,o,p){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf(p)>=0){return b.getText(p);}}return o[p];};U.getActionConfiguration=function(T,a){var C=T.configuration.getParameterValueAsString('tileConfiguration');var o=JSON.parse(C||"{}"),R;if(typeof a=="undefined"){a=T.configurationUi.isEnabled();}if(a){R=U.getResourceBundleModel().getResourceBundle();}o.semantic_object=o.semantic_object||(a?"["+R.getText("configuration.semantic_object")+"]":"");o.semantic_action=o.semantic_action||(a?"["+R.getText("configuration.semantic_action")+"]":"");o.navigation_provider=o.navigation_provider||"";o.navigation_provider_role=o.navigation_provider_role||"";o.navigation_provider_instance=o.navigation_provider_instance||"";o.target_application_id=o.target_application_id||"";o.target_application_alias=o.target_application_alias||"";o.display_info_text=o.display_info_text||"";o.editable=true;if(T.configurationUi&&T.configurationUi.isReadOnly){if(T.configurationUi.isReadOnly()){o.editable=false;}}return o;};U.getConfiguration=function(v){var V=v.getViewData();var T=V.chip;var u=sap.ui.require("sap/ushell/components/tiles/utilsRT");var C=u.getConfiguration(T,true,true);return C;};U.getConfigurationUi=function(v,V){var C,s,R,i,a,A;var o=v.getViewData();var b=U.getConfiguration(v);var e=new sap.ui.model.json.JSONModel({config:b,tileModel:v.getModel()});C=new sap.ui.view({type:sap.ui.core.mvc.ViewType.XML,viewData:o,viewName:V});C.setModel(e);s=C.byId("navigation_semantic_objectInput")||C.byId("semantic_objectInput");if(s){s.getModel().setProperty("/enabled",b.navigation_use_semantic_object);s.getModel().setProperty("/value",b.semantic_object||b.navigation_semantic_object);}R=C.byId("navigation_provider_roleInput");if(R){R.getModel().setProperty("/value",b.navigation_provider_role);}i=C.byId("navigation_provider_instanceInput");if(i){i.getModel().setProperty("/value",b.navigation_provider_instance);}a=C.byId("target_application_aliasInput");if(a){a.getModel().setProperty("/value",b.target_application_alias);}A=C.byId("targetTypeInput");if(A){if(!C.getModel().getProperty("/config/transaction")){C.getModel().setProperty("/config/transaction",{});}if(!C.getModel().getProperty("/config/web_dynpro")){C.getModel().setProperty("/config/web_dynpro",{});}if(v.getModel().getProperty('/config/navigation_provider')=="LPD"){U.displayLpdCustApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="WCF"){A.setSelectedKey("WCF");U.displayWCFApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="SAPUI5"||v.getModel().getProperty('/config/navigation_provider')==''){A.setSelectedKey("SAPUI5");U.displaySapui5ApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="TR"){U.displayTransactionApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="WDA"){U.displayWebDynproApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="URL"){U.displayURLApplicationTypeFields(C);}}return C;};U._updateTilePropertiesTexts=function(v,T){var a=T.getTextNames(),m=v.getModel();a.forEach(function(p){m.setProperty('/data/'+p,T.getText(p));m.setProperty('/config/'+p,T.getText(p));});};U._updateTileConfiguration=function(v,T){var m=v.getModel();jQuery.each(JSON.parse(T),function(p,P){m.setProperty('/data/'+p,P);m.setProperty('/config/'+p,P);if(p==="navigation_target_url"){m.setProperty('/nav/'+p,P);}});};U.aData=[];U.aActionData=[];U.aRoleData=[];U.aAliasData=[];U.objectSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),i,s,a;if(v!==undefined){i=e.getParameter("itemsBinding");s=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);a=new sap.ui.model.Filter("obj",sap.ui.model.FilterOperator.Contains,v);f.push(a);f.push(s);i.filter(new sap.ui.model.Filter(f,false));}};U.actionSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),i,s;if(v!==undefined){i=e.getParameter("itemsBinding");s=new sap.ui.model.Filter("text",sap.ui.model.FilterOperator.Contains,v);f.push(s);i.filter(new sap.ui.model.Filter(f,false));}};U.roleSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),i,s,a;if(v!==undefined){i=e.getParameter("itemsBinding");s=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.Contains,v);a=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.Contains,v);f.push(s);f.push(a);i.filter(new sap.ui.model.Filter(f,false));}};U.instanceSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),a,R,i,s,b;a=e.getSource().getCustomData();R=a[0].getValue();if(v!==undefined){i=e.getParameter("itemsBinding");if(v!=""){b=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.Contains,v);f.push(b);}if(R!=""){s=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.EQ,R);f.push(s);}if(f.length>0){i.filter(new sap.ui.model.Filter(f,true));}}};U.instanceSuggest=function(C,e){var v=C.getView(),f=[],V=e.getParameter("value"),R,s,a,b,h;R=v.byId("navigation_provider_roleInput");s=R.getValue();V=e.getParameter("suggestValue");if(V!=""){h=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.Contains,V);f.push(h);}if(s!=""){b=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.EQ,s);f.push(b);}if(f.length>0){a=e.oSource.getBinding("suggestionItems");a.filter(new sap.ui.model.Filter(f,true));}};U.aliasSuggest=function(C,e){var v=C.getView(),f=[],V=e.getParameter("value"),i,I,s,a,b;i=v.byId("navigation_provider_instanceInput");I=i.getValue();V=e.getParameter("suggestValue");if(V!=""){b=new sap.ui.model.Filter("alias",sap.ui.model.FilterOperator.Contains,V);f.push(b);}if(I!=""){a=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.EQ,I);f.push(a);}if(f.length>0){s=e.oSource.getBinding("suggestionItems");s.filter(new sap.ui.model.Filter(f,true));}};U.aliasSelectDoSearch=function(e){var f=[],v=e.getParameter("value"),a,i,b,s,h;a=e.getSource().getCustomData();i=a[0].getValue();if(v!==undefined){b=e.getParameter("itemsBinding");s=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.EQ,i);if(v!=""){h=new sap.ui.model.Filter("alias",sap.ui.model.FilterOperator.Contains,v);f.push(h);}f.push(s);b.filter(new sap.ui.model.Filter(f,true));}};U.objectSelectUpdateDialog=function(s,v){var f=[],i=s.getBinding("items"),a;if(v!==undefined){a=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);f.push(a);i.filter(f);}};U.actionSelectUpdateDialog=function(s,v){var f=[],i=s.getBinding("items"),a;if(v!==undefined){a=new sap.ui.model.Filter("text",sap.ui.model.FilterOperator.Contains,v);f.push(a);i.filter(f);}};U.roleSelectUpdateDialog=function(s,v){var f=[],i=s.getBinding("items"),a;if(v!==undefined){a=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.Contains,v);f.push(a);i.filter(f);}};U.instanceSelectUpdateDialog=function(s,v){var f=[],a,i=s.getBinding("items"),b,R,e;a=s.getCustomData();R=a[0].getValue();if(v!==undefined){b=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.Contains,v);f.push(b);}if(R!==""){e=new sap.ui.model.Filter("role",sap.ui.model.FilterOperator.EQ,R);f.push(e);}if(f.length>0){i.filter(f,true);}};U.aliasSelectUpdateDialog=function(s,v){var f=[],a,i,b=s.getBinding("items"),e,h;a=s.getCustomData();i=a[0].getValue();if(v!==undefined){h=new sap.ui.model.Filter("alias",sap.ui.model.FilterOperator.Contains,v);f.push(h);}if(i!==""){e=new sap.ui.model.Filter("instance",sap.ui.model.FilterOperator.EQ,i);f.push(e);}if(f.length>0){b.filter(f,true);}};U.sSelectedColor=(jQuery(".sapMStdTileIconDiv").css('color')||"#007cc0").split(" ").join("");U.sDeselectedColor=(jQuery(".sapMLabel:not(.sapFioriDropZoneText )").css('color')||"#666666").split(" ").join("");U.iconSelect=function(i,s){i.setColor(s?U.sSelectedColor:U.sDeselectedColor);i.setActiveColor(s?U.sDeselectedColor:U.sSelectedColor);};U.onSelectIcon=function(C,i,T,o){var m=C.getView().getModel(),s;if(i){s=m.getProperty("/config/tile_actions_selected_icon");}else{s=m.getProperty("/config/selected_icon");}if(s){U.iconSelect(s,false);}s=o.getSource();U.iconSelect(s,true);m.setProperty("/config/ok.enabled",true);if(i){m.setProperty("/config/tile_actions_selected_icon",s);}else{m.setProperty("/config/selected_icon",s);}C.byId("selectIconDialog").setTitle(s.getSrc());};U.onSelectIconClose=function(v){v.byId("selectIconDialog").close();};U.onSelectIconOk=function(v,T){var s=v.getModel().getProperty("/config/selected_icon");if(!T){v.getModel().setProperty("/config/display_icon_url",s.getSrc());v.byId("iconInput").setValueState(sap.ui.core.ValueState.None);}else{s=v.getModel().getProperty("/config/tile_actions_selected_icon");if(s){T.setValue(s.getSrc());T.setValueState(sap.ui.core.ValueState.None);}}U.onSelectIconClose(v);};U.iconSelectOnValueHelpRequest=function(C,e,a){var m=C.getView().getModel();var R=C.getView().byId("icons");var b=sap.ui.core.IconPool.getIconCollectionNames();var D=C.getView().byId("selectIconDialog");var o=C.getView().byId("ok");var f,I,T,h,i,j,s,B=false;R.destroyContent();if(a){T=sap.ui.getCore().byId(e.getParameter('id'));I=T.getValue();}else{I=m.getProperty("/config/display_icon_url");}o.attachEventOnce("press",function(){U.onSelectIconOk(C.getView(),T);});b.sort();b=jQuery.grep(b,function(v){if(v==="BusinessSuiteInAppSymbols"){B=true;return false;}return true;});if(B){b.push("BusinessSuiteInAppSymbols");}for(i=0;i<b.length;i+=1){h=sap.ui.core.IconPool.getIconNames(b[i]);h.sort();for(j=0;j<h.length;j+=1){s=sap.ui.core.IconPool.getIconURI(h[j],b[i]);R.addContent(new sap.ui.core.Icon({height:"38px",press:U.onSelectIcon.bind(null,C,a,T),size:"2rem",src:s,tooltip:s,width:"38px"}));}}f=R.getContent();m.setProperty("/config/ok.enabled",false);D.bindProperty("title",{model:"i18n",path:"configuration.select_icon"});for(i=0;i<f.length;i+=1){if(f[i].getSrc()===I){if(a){m.setProperty("/config/tile_actions_selected_icon",f[i]);}else{m.setProperty("/config/selected_icon",f[i]);}U.iconSelect(f[i],true);m.setProperty("/config/ok.enabled",true);D.setTitle(I);}else{U.iconSelect(f[i],false);}}D.open();};U.objectSelectOnValueHelpRequest=function(C,e,i){var v=C.getView(),T=U.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_object"),s,V,S=new sap.ui.model.json.JSONModel(),o=new sap.m.SelectDialog("semantic_object_select_dialog",{title:T,search:U.objectSelectDoSearch,liveChange:U.objectSelectDoSearch}),a=new sap.m.StandardListItem({title:"{obj}"});if(i){s=sap.ui.getCore().byId(e.getParameter('id'));}else{s=v.byId("semantic_objectInput")||v.byId("navigation_semantic_objectInput");}V=s.getValue();o.open(V);S.setData(C.aDefaultObjects.concat(U.aData));o.bindAggregation("items","/",a);o.setModel(S);U.objectSelectUpdateDialog(o,V);o.attachCancel(function(b){s.setValue(V);if(!i){s.fireChange();}o.destroy();o=null;});o.attachConfirm(function(b){var f=b.getParameter("selectedItem");if(f){s.setValue(f.getTitle());if(!i){s.fireChange();}}o.destroy();o=null;});};U.actionSelectOnValueHelpRequest=function(C,e,i){var v=C.getView(),T=U.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_action"),a,V,s=new sap.ui.model.json.JSONModel(),S=new sap.m.SelectDialog("semantic_action_select_dialog",{title:T,search:U.actionSelectDoSearch,liveChange:U.actionSelectDoSearch}),b=new sap.m.StandardListItem({title:"{text}"});if(i){a=sap.ui.getCore().byId(e.getParameter('id'));}else{a=v.byId("semantic_actionInput")||v.byId("navigation_semantic_actionInput");}V=a.getValue();S.open(V);s.setData(U.aActionData);S.bindAggregation("items","/items",b);S.setModel(s);U.actionSelectUpdateDialog(S,V);S.attachCancel(function(f){a.setValue(V);if(!i){a.fireChange();}S.destroy();S=null;});S.attachConfirm(function(f){var h=f.getParameter("selectedItem");if(h){a.setValue(h.getTitle());if(!i){a.fireChange();a.fireLiveChange({"newValue":h.getTitle()});}}S.destroy();S=null;});};U.roleSelectOnValueHelpRequest=function(C,e){var v=C.getView(),T=U.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_role"),R,i,V,s=new sap.ui.model.json.JSONModel(),S=new sap.m.TableSelectDialog("role_select_dialog",{title:T,search:U.roleSelectDoSearch,liveChange:U.roleSelectDoSearch,columns:[new sap.m.Column({header:[new sap.m.Text({text:U.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_role")})]}),new sap.m.Column({header:[new sap.m.Text({text:U.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_instance")})]})]}),a=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"{role}"}),new sap.m.Text({text:"{instance}"})]});R=v.byId("navigation_provider_roleInput");i=v.byId("navigation_provider_instanceInput");V=R.getValue();S.open(V);s.setData(C.aDefaultObjects.concat(U.aRoleData));S.bindAggregation("items","/",a);S.setModel(s);U.roleSelectUpdateDialog(S,V);S.attachCancel(function(b){R.setValue(V);R.fireChange();S.destroy();S=null;});S.attachConfirm(function(b){var f=b.getParameter("selectedItem");if(f){R.setValue(f.getCells()[0].getText());i.setValue(f.getCells()[1].getText());R.fireChange();i.fireChange();}S.destroy();S=null;});};U.instanceSelectOnValueHelpRequest=function(C,e){var v=C.getView(),R,T=U.getResourceBundleModel().getResourceBundle().getText("configuration.navigation_provider_instance"),i,V,s=new sap.ui.model.json.JSONModel(),S=new sap.m.SelectDialog("instance_select_dialog",{title:T,search:U.instanceSelectDoSearch,liveChange:U.instanceSelectDoSearch}),a=new sap.m.StandardListItem({title:"{instance}"});i=v.byId("navigation_provider_instanceInput");V=i.getValue();R=v.byId("navigation_provider_roleInput").getValue();S.addCustomData(new sap.ui.core.CustomData({key:"role",value:R}));S.open(V);s.setData(C.aDefaultObjects.concat(U.aRoleData));S.bindAggregation("items","/",a);S.setModel(s);U.instanceSelectUpdateDialog(S,V);S.attachCancel(function(b){i.setValue(V);i.fireChange();S.destroy();S=null;});S.attachConfirm(function(b){var f=b.getParameter("selectedItem");if(f){i.setValue(f.getTitle());i.fireChange();}S.destroy();S=null;});};U.applicationAliasSelectOnValueHelpRequest=function(C,e){var v=C.getView(),T=U.getResourceBundleModel().getResourceBundle().getText("configuration.target_application_alias"),a,V,i,s=new sap.ui.model.json.JSONModel(),S=new sap.m.SelectDialog("alias_select_dialog",{title:T,search:U.aliasSelectDoSearch,liveChange:U.aliasSelectDoSearch}),b=new sap.m.StandardListItem({title:"{alias}"});a=v.byId("target_application_aliasInput");V=a.getValue();i=v.byId("navigation_provider_instanceInput").getValue();S.addCustomData(new sap.ui.core.CustomData({key:"instance",value:i}));S.open(V);s.setData(C.aDefaultObjects.concat(U.aAliasData));S.bindAggregation("items","/",b);S.setModel(s);U.aliasSelectUpdateDialog(S,V);S.attachCancel(function(f){a.setValue(V);a.fireChange();S.destroy();S=null;});S.attachConfirm(function(f){var h=f.getParameter("selectedItem");if(h){a.setValue(h.getTitle());a.fireChange();}S.destroy();S=null;});};U.onTargetTypeChange=function(T){var i=T.getParameter('id');var p=sap.ui.getCore().byId(i).getParent().getCells();var s=T.getSource().getSelectedKey();if(s=="INT"){p[3].setEnabled(true);p[2].setShowValueHelp(true);p[2].setValue("");}else{p[2].setShowValueHelp(false);p[2].setValue("");p[3].setEnabled(false);p[3].setValue("");}};U.addTileActionsRow=function(C){var m=C.getModel();var a=m.getProperty('/config/tile_actions_rows');var n=this.getEmptyTileActionsRowObj();a.push(n);m.setProperty('/config/tile_actions_rows',a);};U.deleteTileActionsRow=function(C){var m=C.getModel();var e=m.getProperty('/config/tile_actions_rows');var f=C.byId("tileActions");var s=f.getSelectedIndices();var S=s.sort(function(a,b){return b-a;}).slice();for(var i=0;i<S.length;i++){f.removeSelectionInterval(S[i],S[i]);e.splice(S[i],1);}m.setProperty('/config/tile_actions_rows',e);};U.checkInput=function(C,o){var T=U.getResourceBundleModel().getResourceBundle(),i=C.byId("iconInput"),a=C.byId("useLpdCheckbox"),s=C.byId("navigation_semantic_objectInput")||C.byId("semantic_objectInput"),S=C.byId("navigation_semantic_actionInput")||C.byId("semantic_actionInput"),n=jQuery.trim(o.getParameter("newValue")),v=sap.ui.core.ValueState.None,V=null;switch(o.getSource()){case i:if(n!=""&&n.substring(0,11)!=="sap-icon://"){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.display_icon_url.warning");}break;case a:if(!a.getSelected()){S.setValueState(sap.ui.core.ValueState.None);s.setValueState(sap.ui.core.ValueState.None);}break;case s:if(/[\-#&? ]/.test(n)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_object.error_invalid_chars");}else if(n==""){v=sap.ui.core.ValueState.Error;}break;case S:if(/[\-#&? ]/.test(n)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_action.error_invalid_chars");}else if(n==""){v=sap.ui.core.ValueState.Error;}break;default:break;}if(v){o.getSource().setValueState(v);if(V!==null){o.getSource().setValueStateText(V||"");}}};U.checkInputOnSaveConfig=function(C){var i=C.byId("iconInput");var s=C.byId("navigation_semantic_objectInput");var S=C.byId("navigation_semantic_actionInput");var o=C.byId("useLpdCheckbox");var T=U.getResourceBundleModel().getResourceBundle();var R=false;if(i.getValue()!=""&&!U.isIconURIValid(i.getValue())){i.setValueState(sap.ui.core.ValueState.Error);i.setValueStateText(T.getText("configuration.display_icon_url.warning"));R=true;}if(o.getSelected()&&/[\-#&? ]/.test(s.getValue())){s.setValueState(sap.ui.core.ValueState.Error);s.setValueStateText(T.getText("configuration.semantic_object.error_invalid_chars"));R=true;}else if(o.getSelected()&&s.getValue()==""){s.setValueState(sap.ui.core.ValueState.Error);R=true;}if(/[\-#&? ]/.test(S.getValue())){S.setValueState(sap.ui.core.ValueState.Error);S.setValueStateText(T.getText("configuration.semantic_action.error_invalid_chars"));R=true;}else if(o.getSelected()&&S.getValue()==""){S.setValueState(sap.ui.core.ValueState.Error);R=true;}return R;};U.checkTileActions=function(C){var T=C.getModel().getProperty("/config/tile_actions_rows");var o=U.getResourceBundleModel().getResourceBundle();var R=false;for(var i=0;i<T.length;i++){if(!T[i].menu_title&&(T[i].navigation_target||T.length>1)){T[i].valueState=sap.ui.core.ValueState.Error;R=true;}else{T[i].valueState=sap.ui.core.ValueState.None;}if(T[i].icon){if(!U.isIconURIValid(T[i].icon)){T[i].iconValueState=sap.ui.core.ValueState.Error;T[i].iconValueStateText=o.getText("configuration.display_icon_url.warning");R=true;}}}C.getModel().setProperty("/config/tile_actions_rows",T);return R;};U.isIconURIValid=function(i){var R=[];var C="";var I="";var v="";R=/sap-icon:\/\/(.+)\//.exec(i);if(R){C=R[1];R=/\/\/.+\/(.+)/.exec(i);R?I=R[1]:I="";v=sap.ui.core.IconPool.getIconURI(I,C);if(v!=i){return false;}}else{R=/sap-icon:\/\/(.+)/.exec(i);if(R){I=R[1];if(!sap.ui.core.IconPool.getIconInfo(I)){return false;}}else{return false;}}return true;};U.checkTMInput=function(C,o){var T=U.getResourceBundleModel().getResourceBundle(),s=C.byId("semantic_objectInput"),S=C.byId("semantic_actionInput"),a=C.byId("target_application_descriptionInput"),b=C.byId("target_application_urlInput"),e=C.byId("target_application_componentInput"),n=C.byId("navigation_provider_roleInput"),N=C.byId("navigation_provider_instanceInput"),f=C.byId("target_application_aliasInput"),h=C.byId("target_application_idInput"),i=jQuery.trim(o.getParameter("newValue")),v=sap.ui.core.ValueState.None,V=null;switch(o.getSource()){case s:if(/[\-#&? ]/.test(i)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_object.error_invalid_chars");}if(S.getValue()==""){S.setValueState(sap.ui.core.ValueState.Error);}break;case S:if(/[\-#&? ]/.test(i)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_action.error_invalid_chars");}else if(i==""){v=sap.ui.core.ValueState.Error;}break;case a:if(i==""){v=sap.ui.core.ValueState.Error;}break;case b:if(i!=""&&!(/^[-~+,;:?%&#=/.\w]+$/.test(i))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.url.error_invalid_chars");}break;case e:if(i==""){v=sap.ui.core.ValueState.Error;}else if(i.substring(0,17)=="SAPUI5.Component="){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.component.error_invalid_input");}break;case n:if(i==""){v=sap.ui.core.ValueState.Error;}else if(!(/^[\w/]+$/.test(i))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.role.error_invalid_chars");}break;case N:if(i==""){v=sap.ui.core.ValueState.Error;}else if(!(/^[\w/]+$/.test(i))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.instance.error_invalid_chars");}break;case f:if(i==""&&h.getValue()==""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");}else if(i!=""&&h.getValue()!=""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");h.setValueState(v);h.setValueStateText(V);}else{h.setValueState(sap.ui.core.ValueState.None);}break;case h:if(i==""&&f.getValue()==""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");}else if(i!=""&&f.getValue()!=""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");f.setValueState(v);f.setValueStateText(V);}else if(i!=""&&!(/^[A-Fa-f0-9]+$/.test(i))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.error_invalid_chars");}else{f.setValueState(sap.ui.core.ValueState.None);}break;default:break;}if(v){o.getSource().setValueState(v);if(V!==null){o.getSource().setValueStateText(V||"");}}};U.checkTMInputOnSaveConfig=function(C){var T=U.getResourceBundleModel().getResourceBundle();var s=C.byId("semantic_objectInput");var S=C.byId("semantic_actionInput");var o=C.byId("target_application_descriptionInput");var a=C.byId("target_application_urlInput");var b=C.byId("target_application_componentInput");var n=C.byId("navigation_provider_roleInput");var N=C.byId("navigation_provider_instanceInput");var e=C.byId("target_application_aliasInput");var f=C.byId("target_application_idInput");var h=C.byId("targetTypeInput");var i=C.byId("target_transactionInput");var w=C.byId("target_web_dynpro_applicationInput");var W=C.byId("target_wcf_application_idInput");var F=C.byId("desktopCB");var j=C.byId("tabletCB");var k=C.byId("phoneCB");var R=false;s.setValue(s.getValue().trim());if(/[\-#&? ]/.test(s.getValue())){s.setValueState(sap.ui.core.ValueState.Error);s.setValueStateText(T.getText("configuration.semantic_object.error_invalid_chars"));R=true;}S.setValue(S.getValue().trim());if(/[\-#&? ]/.test(S.getValue())){S.setValueState(sap.ui.core.ValueState.Error);S.setValueStateText(T.getText("configuration.semantic_action.error_invalid_chars"));R=true;}else if(S.getValue()==""){S.setValueState(sap.ui.core.ValueState.Error);R=true;}var l=C.getModel().getProperty("/config/navigation_provider");if(l==="SAPUI5"){if(o.getValue()==""){o.setValueState(sap.ui.core.ValueState.Error);R=true;}if(a.getValue()!=""&&!(/^[-~+,;:?%&#=/.\w]+$/.test(a.getValue()))){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText(T.getText("configuration.target_application.url.error_invalid_chars"));R=true;}if(b.getValue()==""){b.setValueState(sap.ui.core.ValueState.Error);R=true;}else if(b.getValue().substring(0,17)=="SAPUI5.Component="){b.setValueState(sap.ui.core.ValueState.Error);b.setValueStateText(T.getText("configuration.target_application.component.error_invalid_input"));R=true;}}else if(l==="LPD"){if(n.getValue()==""){n.setValueState(sap.ui.core.ValueState.Error);R=true;}if(!(/^[\w]+$/.test(n.getValue()))){n.setValueState(sap.ui.core.ValueState.Error);var v=T.getText("configuration.target_application.role.error_invalid_chars");n.setValueStateText(v);R=true;}if(N.getValue()==""){N.setValueState(sap.ui.core.ValueState.Error);R=true;}if(!(/^[\w]+$/.test(N.getValue()))){N.setValueState(sap.ui.core.ValueState.Error);var v=T.getText("configuration.target_application.instance.error_invalid_chars");N.setValueStateText(v);R=true;}if(e.getValue()==""&&f.getValue()==""){var v=T.getText("configuration.target_application.alias_id.warning");e.setValueState(sap.ui.core.ValueState.Error);e.setValueStateText(v);f.setValueState(sap.ui.core.ValueState.Error);f.setValueStateText(v);R=true;}if(e.getValue()!=""&&f.getValue()!=""){var v=T.getText("configuration.target_application.alias_id.warning");e.setValueState(sap.ui.core.ValueState.Error);e.setValueStateText(v);f.setValueState(sap.ui.core.ValueState.Error);f.setValueStateText(v);R=true;}if(f.getValue()!=""&&!(/^[A-Fa-f0-9]+$/.test(f.getValue()))){f.setValueState(sap.ui.core.ValueState.Error);f.setValueStateText(T.getText("configuration.target_application.alias_id.error_invalid_chars"));R=true;}}else if(l==="TR"){if(i.getValue()==""){i.setValueState(sap.ui.core.ValueState.Error);R=true;}}else if(l==="WDA"){if(w.getValue()==""){w.setValueState(sap.ui.core.ValueState.Error);R=true;}}else if(l==="WCF"){if(W.getValue()==""){W.setValueState(sap.ui.core.ValueState.Error);R=true;}}else if(l==="URL"){if(a.getValue()==""){a.setValueState(sap.ui.core.ValueState.Error);R=true;}else if(!(/^[-~+,;:?%&#=/.\w]+$/.test(a.getValue()))){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText(T.getText("configuration.target_application.url.error_invalid_chars"));R=true;}}else{h.setValueState(sap.ui.core.ValueState.Error);h.setValueStateText(T.getText("configuration.navigation_provider.error_invalid_provider"));R=true;}if(!F.getSelected()&&!j.getSelected()&&!k.getSelected()){var v=T.getText("configuration.form_factor.warning");F.setValueState(sap.ui.core.ValueState.Error);F.setValueStateText(v);j.setValueState(sap.ui.core.ValueState.Error);j.setValueStateText(v);k.setValueState(sap.ui.core.ValueState.Error);k.setValueStateText(v);R=true;}return R;};U.updateTooltipForDisabledProperties=function(C){var m=C.getModel();var i=m.getProperty("/config/isLocaleSuitable");if(!i){var a=U.getResourceBundleModel().getResourceBundle();var b=a.getText("edit_configuration.original_locale_not_fit_tooltip",[m.getProperty("/config/userLocale"),m.getProperty("/config/orgLocale")]);C.byId("titleInput").setTooltip(b);C.byId("subtitleInput").setTooltip(b);C.byId("keywordsInput").setTooltip(b);C.byId("infoInput").setTooltip(b);}};U.updateMessageStripForOriginalLanguage=function(C){var m=C.getModel();if(m.getProperty("/config/isLocaleSuitable")===false){var M=U.getResourceBundleModel().getResourceBundle().getText("edit_configuration.original_locale_not_fit_message",[m.getProperty("/config/orgLocale").toUpperCase(),m.getProperty("/config/userLocale").toUpperCase()]);var o=C.byId("messageStrip");o.setVisible(true);o.setText(M);o.setType(sap.ui.core.MessageType.Warning);}};U.createSemanticObjectModel=function(C,s,D){var v=C.getView(),a="/sap/opu/odata/UI2/INTEROP/SemanticObjects",b=[{obj:"",name:""},{obj:"*",name:"*"}],e=(D||b).slice(0),S=new sap.ui.model.json.JSONModel();S.setSizeLimit(999999);S.setProperty("/value","");S.setProperty("/enabled",true);s.bindAggregation("suggestionItems","suggest>/items",new sap.ui.core.Item({text:"{suggest>obj}"}));s.setModel(S,"suggest");if(U.aData.length>0){S.setData({items:e.concat(U.aData)},true);return;}O.read({requestUri:a,headers:{"Accept":"application/json"}},function(o,R){var I,T,i;for(i=0;i<o.results.length;i=i+1){I=o.results[i].id;T=o.results[i].text;U.aData.push({obj:I,name:T||I});}S.setData({items:e.concat(U.aData)},true);},function(E){var m=E&&E.message?E.message:E;if(E.response){m+=" - "+E.response.statusCode+" "+E.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+a+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};U.createRoleModel=function(C,R,I){var v=C.getView(),s="/sap/opu/odata/UI2/INTEROP/GetLPDInstances",S=new sap.ui.model.json.JSONModel(),o=new sap.ui.model.json.JSONModel();S.setSizeLimit(999999);o.setSizeLimit(999999);S.setProperty("/value","");S.setProperty("/enabled",true);o.setProperty("/value","");o.setProperty("/enabled",true);var a=new sap.m.ColumnListItem({cells:[new sap.m.Label({text:"{role}"}),new sap.m.Label({text:"{instance}"})]});R.bindAggregation("suggestionRows","/items",a);I.bindAggregation("suggestionItems","/items",new sap.ui.core.Item({text:"{instance}"}));I.setModel(o);R.setModel(S);R.attachSuggestionItemSelected(function(e){I.setValue(e.getParameter("selectedRow").getCells()[1].getText());I.fireChange();});if(U.aRoleData.length>0){S.setData({items:U.aRoleData},false);o.setData({items:U.aRoleData},false);return;}O.read({requestUri:s,headers:{"Accept":"application/json"}},function(D,b){var e,f,i;for(i=0;i<D.results.length;i=i+1){e=D.results[i].lpdRole;f=D.results[i].instance;U.aRoleData.push({role:e,instance:f});}S.setData({items:U.aRoleData},true);o.setData({items:U.aRoleData},true);},function(e){var m=e&&e.message?e.message:e;if(e.response){m+=" - "+e.response.statusCode+" "+e.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+s+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};U.createAliasModel=function(C,a){var v=C.getView(),o,s="/sap/opu/odata/UI2/INTEROP/GetLPDAppAlias",S=new sap.ui.model.json.JSONModel();var u=sap.ui.require("sap/ushell/components/tiles/utilsRT");S.setSizeLimit(999999);S.setProperty("/value","");S.setProperty("/enabled",true);a.bindAggregation("suggestionItems","/items",new sap.ui.core.Item({text:"{alias}"}));a.setModel(S);o=u.getConfiguration(v.oViewData.chip,true,true);if(o&&o.navigation_provider_role&&o.navigation_provider_instance){if(o.navigation_provider_role!=""&&o.navigation_provider_instance!=""){s=s+"?role='"+o.navigation_provider_role+"'&instance='"+o.navigation_provider_instance+"'";}}O.read({requestUri:s,headers:{"Accept":"application/json"}},function(D,R){var A,b,I,i,m;U.aAliasData=[];for(i=0;i<D.results.length;i=i+1){A=D.results[i].lpdApplicationAlias;b=D.results[i].lpdRole;I=D.results[i].lpdInstance;U.aAliasData.push({role:b,instance:I,alias:A});}m=S.getData();if(m){m.items=U.aAliasData;}else{m={items:U.aAliasData};}S.setData(m,false);},function(e){var m=e&&e.message?e.message:e;if(e.response){m+=" - "+e.response.statusCode+" "+e.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+s+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};U.updateAliasModel=function(v,a){var s,I,R,S=a.getModel();I=v.byId("navigation_provider_instanceInput").getValue();R=v.byId("navigation_provider_roleInput").getValue();s="/sap/opu/odata/UI2/INTEROP/GetLPDAppAlias?role='"+R+"'&instance='"+I+"'";O.read({requestUri:s,headers:{"Accept":"application/json"}},function(D,o){var A,R,I,i,m;U.aAliasData=[];for(i=0;i<D.results.length;i=i+1){A=D.results[i].lpdApplicationAlias;R=D.results[i].lpdRole;I=D.results[i].lpdInstance;U.aAliasData.push({role:R,instance:I,alias:A});}m=S.getData();if(m){m.items=U.aAliasData;}else{m={items:U.aAliasData};}S.setData(m,false);},function(e){var m=e&&e.message?e.message:e;if(e.response){m+=" - "+e.response.statusCode+" "+e.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+s+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};U.createActionModel=function(C,a){var i=new sap.ui.model.json.JSONModel();var v=C.getView(),o,A;var u=sap.ui.require("sap/ushell/components/tiles/utilsRT");i.setData({"items":[{"text":"display"},{"text":"approve"},{"text":"displayFactSheet"},{"text":"manage"},{"text":"create"},{"text":"monitor"},{"text":"track"},{"text":"change"},{"text":"register"},{"text":"release"},{"text":"analyzeKPIDetails"},{"text":"lookup"},{"text":"manageLineItems"}]});U.aActionData=i.getData();o=u.getConfiguration(v.oViewData.chip,true,true);A=o.navigation_semantic_action||o.semantic_action;if(A){if(!i.getData().items.some(function(I){return I.text===A;})){i.getData().items.push({"text":A});}}a.bindAggregation("suggestionItems","items>/items",new sap.ui.core.Item({text:"{items>text}"}));a.setModel(i,"items");a.getBinding("suggestionItems").sort(new sap.ui.model.Sorter("text",false));};U.createNavigationProviderModel=function(C,T){var i=new sap.ui.model.json.JSONModel();var R=U.getResourceBundleModel().getResourceBundle();var I=[{"key":"SAPUI5","text":R.getText('configuration.target_application.sapui5')},{"key":"LPD","text":R.getText('configuration.target_application.lpd_cust')},{"key":"TR","text":R.getText('configuration.target_application.transaction')},{"key":"WDA","text":R.getText('configuration.target_application.web_dynpro')},{"key":"URL","text":R.getText('configuration.target_application.url')}];var o=U.getConfiguration(C.getView());var b=o.navigation_provider==="WCF";if(b){I.push({"key":"WCF","text":R.getText('configuration.target_application.wcf')});}i.setData({"items":I});T.bindItems("items>/items",new sap.ui.core.Item({key:"{items>key}",text:"{items>text}"}));T.setModel(i,"items");T.getBinding("items").sort(new sap.ui.model.Sorter("text",false));};U.displayApplicationTypeFields=function(a,C){switch(a){case'LPD':U.displayLpdCustApplicationTypeFields(C);break;case'SAPUI5':U.displaySapui5ApplicationTypeFields(C);break;case'TR':U.displayTransactionApplicationTypeFields(C);break;case'WDA':U.displayWebDynproApplicationTypeFields(C);break;case'URL':U.displayURLApplicationTypeFields(C);break;case'WCF':U.displayWCFApplicationTypeFields(C);break;}};U.displayWCFApplicationTypeFields=function(C){C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(false);C.byId('target_application_urlInput').setVisible(false);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_wcf_application_id').setVisible(true);C.byId('target_wcf_application_idInput').setVisible(true);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(true);C.byId('target_system_aliasInput').setVisible(true);};U.displaySapui5ApplicationTypeFields=function(C){C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(true);C.byId('target_application_urlInput').setVisible(true);C.byId('application_component').setVisible(true);C.byId('target_application_componentInput').setVisible(true);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_wcf_application_id').setVisible(false);C.byId('target_wcf_application_idInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(false);C.byId('target_system_aliasInput').setVisible(false);};U.displayLpdCustApplicationTypeFields=function(C){C.byId('application_description').setVisible(false);C.byId('target_application_descriptionInput').setVisible(false);C.byId('application_url').setVisible(false);C.byId('target_application_urlInput').setVisible(false);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('navigation_provider_role').setVisible(true);C.byId('navigation_provider_roleInput').setVisible(true);C.byId('navigation_provider_instance').setVisible(true);C.byId('navigation_provider_instanceInput').setVisible(true);C.byId('target_application_alias').setVisible(true);C.byId('target_application_aliasInput').setVisible(true);C.byId('target_application_id').setVisible(true);C.byId('target_application_idInput').setVisible(true);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_wcf_application_id').setVisible(false);C.byId('target_wcf_application_idInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(false);C.byId('target_system_aliasInput').setVisible(false);};U.displayTransactionApplicationTypeFields=function(C){C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(false);C.byId('target_application_urlInput').setVisible(false);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('target_transaction').setVisible(true);C.byId('target_transactionInput').setVisible(true);C.byId('target_wcf_application_id').setVisible(false);C.byId('target_wcf_application_idInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(true);C.byId('target_system_aliasInput').setVisible(true);};U.displayWebDynproApplicationTypeFields=function(C){C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(false);C.byId('target_application_urlInput').setVisible(false);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_wcf_application_id').setVisible(false);C.byId('target_wcf_application_idInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(true);C.byId('target_web_dynpro_applicationInput').setVisible(true);C.byId('target_web_dynpro_configuration').setVisible(true);C.byId('target_web_dynpro_configurationInput').setVisible(true);C.byId('target_system_alias').setVisible(true);C.byId('target_system_aliasInput').setVisible(true);};U.displayURLApplicationTypeFields=function(C){C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(true);C.byId('target_application_urlInput').setVisible(true);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('target_transaction').setVisible(false);C.byId('target_transactionInput').setVisible(false);C.byId('target_wcf_application_id').setVisible(false);C.byId('target_wcf_application_idInput').setVisible(false);C.byId('target_web_dynpro_application').setVisible(false);C.byId('target_web_dynpro_applicationInput').setVisible(false);C.byId('target_web_dynpro_configuration').setVisible(false);C.byId('target_web_dynpro_configurationInput').setVisible(false);C.byId('target_system_alias').setVisible(true);C.byId('target_system_aliasInput').setVisible(true);};return U;},true);
sap.ui.predefine('sap/ushell/components/tiles/utilsRT',["sap/ushell/components/tiles/utils","sap/ui/core/format/NumberFormat"],function(u,N){"use strict";var a={};a.getConfiguration=function(t,A,E){var r;var c=t.configuration.getParameterValueAsString('tileConfiguration');try{var C=JSON.parse(c||"{}");}catch(e){jQuery.sap.log.error("Error while trying to parse tile configuration",e,"sap.ushell.components.tiles.utilsRT");return{};}var U=sap.ui.require("sap/ushell/components/tiles/utils");C.editable=true;if(t.configurationUi&&t.configurationUi.isReadOnly){if(t.configurationUi.isReadOnly()){C.editable=false;}}var T=U.getTranslatedTitle(t);var s=U.getTranslatedSubtitle(t,C);var i=U.getTranslatedProperty(t,C,'display_info_text');var k=U.getTranslatedProperty(t,C,'display_search_keywords');if(A){r=U.getResourceBundleModel().getResourceBundle();if(E&&t.bag){var o=t.bag.getOriginalLanguage();var l=sap.ui.getCore().getConfiguration().getLocale().getSAPLogonLanguage();var b=sap.ui.getCore().getConfiguration().getLanguage();C.isLocaleSuitable=o===""||o.toLowerCase()===l.toLowerCase()||o.toLowerCase()===b.toLowerCase();C.orgLocale=o;C.userLocale=l;}}C.display_icon_url=C.display_icon_url||"";if(i!==undefined){C.display_info_text=i;}else if(C.display_info_text===undefined){if(A&&!E){C.display_info_text="["+r.getText("configuration.display_info_text")+"]";}else{C.display_info_text="";}}C.navigation_semantic_object=C.navigation_semantic_object||"";C.navigation_semantic_action=C.navigation_semantic_action||"";C.navigation_semantic_parameters=C.navigation_semantic_parameters||"";C.display_number_unit=C.display_number_unit||"";C.display_number_factor=C.display_number_factor||"";C.service_refresh_interval=C.service_refresh_interval?parseInt(C.service_refresh_interval,10):0;C.service_url=C.service_url||"";C.navigation_target_url=C.navigation_target_url||"";if(A&&U.isInitial(T)){C.display_title_text=E?"":"["+r.getText("configuration.display_title_text")+"]";C.display_subtitle_text=E?"":"["+r.getText("configuration.display_subtitle_text")+"]";}else{C.display_title_text=T||C.display_title_text||"";if(s!==undefined){C.display_subtitle_text=s;}else if(C.display_subtitle_text===undefined){C.display_subtitle_text="";}}C.navigation_use_semantic_object=(C.navigation_use_semantic_object===false?false:true);C.display_search_keywords=k||C.display_search_keywords||"";if(A){C.display_number_value=C.display_number_value||1234;}C.form_factors=C.form_factors?C.form_factors:U.getDefaultFormFactors();C.desktopChecked=C.form_factors.manual.desktop;C.tabletChecked=C.form_factors.manual.tablet;C.phoneChecked=C.form_factors.manual.phone;C.manualFormFactor=!(C.form_factors.appDefault)&&C.editable;C.appFormFactor=C.form_factors.appDefault;C.formFactorConfigDefault=C.form_factors.defaultParam?true:false;if(C.signature){C.rows=U.getSignatureTableData(C.signature,E&&C.editable);}else{C.rows=(C.mapping_signature&&C.mapping_signature!=="*=*")?U.getMappingSignatureTableData(C.mapping_signature,E&&C.editable):[U.getEmptyRowObj(C.editable)];}if(C.signature){C.isUnknownAllowed=(C.signature.additional_parameters==="allowed"||C.signature.additionalParameters==="allowed");}else{C.isUnknownAllowed=(C.mapping_signature!==undefined)?U.getAllowUnknownParametersValue(C.mapping_signature):true;}if(A){C.tile_actions_rows=U.getTileNavigationActionsRows(t,C.editable);}else{if(!C.actions){C.actions=U.getTileNavigationActions(t);}}return C;};a.getDataToDisplay=function(c,d){var b=0,i,n,C,s,D={display_icon_url:d.icon||c.display_icon_url||"",display_title_text:d.title||c.display_title_text||"",display_number_value:!isNaN(d.number)?d.number:"...",display_number_unit:d.numberUnit||c.display_number_unit||"",display_info_text:d.info||c.display_info_text||"",display_info_state:d.infoState||"Neutral",display_subtitle_text:d.subtitle||c.display_subtitle_text||"",display_state_arrow:d.stateArrow||"None",display_number_state:d.numberState||"Neutral",display_number_digits:d.numberDigits>=0?d.numberDigits:4,display_number_factor:d.numberFactor||"",display_search_keyword:d.keywords||c.display_search_keyword||"",targetParams:[]};if(d.infoStatus){D.display_info_state=d.infoStatus;}if(d.targetParams){D.targetParams.push(d.targetParams);}if(d.results){for(i=0,n=d.results.length;i<n;i=i+1){C=d.results[i].number||0;if(typeof C==="string"){C=parseFloat(C,10);}b=b+C;s=d.results[i].targetParams;if(s){D.targetParams.push(s);}}D.display_number_value=b;}if(!isNaN(d.number)){if(typeof d.number==="string"){d.number=d.number.trim();}if(d.number===""){D.display_number_value="...";}else{var S=this._shouldProcessDigits(d.number,d.numberDigits),m=D.display_icon_url?4:5;if(d.number&&d.number.length>=m||S){var o=this._normalizeNumber(d.number,m,d.numberFactor,d.numberDigits);D.display_number_factor=o.numberFactor;D.display_number_value=o.displayNumber;}else{var e=N.getFloatInstance({maxFractionDigits:m});D.display_number_value=e.format(d.number);}}}if(D&&D.display_number_state){switch(D.display_number_state){case"Positive":D.display_number_state="Good";break;case"Negative":D.display_number_state="Error";break;}}return D;};a.getTileSettingsAction=function(m,s,t){var u=sap.ui.require("sap/ushell/components/tiles/utils");var r=u.getResourceBundleModel().getResourceBundle();return{text:(!t||t=="tile")?r.getText('tileSettingsBtn'):r.getText('linkSettingsBtn'),press:function(){sap.ui.require(["sap/ui/layout/form/SimpleForm","sap/ui/layout/form/SimpleFormLayout","sap/m/Button","sap/m/Dialog"],function(S,b,B,D){var A={showGroupSelection:false,title:m.getProperty('/config/display_title_text'),subtitle:m.getProperty('/config/display_subtitle_text')};if(!t||t=='tile'){A.info=m.getProperty('/config/display_info_text');A.icon=m.getProperty('/config/display_icon_url');A.keywords=m.getProperty('/config/display_search_keywords');}else if(t=='link'){A.showInfo=false;A.showIcon=false;A.showPreview=false;}var c=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.ui.footerbar.SaveAsTile",viewData:{appData:A}});var o=new S({id:'tileSettings',layout:b.GridLayout,content:[c]}).addStyleClass("sapUshellAddBookmarkForm");var d=new B('bookmarkOkBtn',{text:r.getText('okBtn'),press:function(){s(c);g.close();},enabled:true}),e=new B('bookmarkCancelBtn',{text:r.getText('cancelBtn'),press:function(){g.close();}});var f=function(h){d.setEnabled(h.trim()?true:false);};c.getTitleInput().attachLiveChange(function(){f(this.getValue());});var g=new D({id:'settingsDialog',title:(!t||t=="tile")?r.getText('tileSettingsDialogTitle'):r.getText('linkSettingsDialogTitle'),contentWidth:'400px',content:o,beginButton:d,endButton:e,horizontalScrolling:false,afterClose:function(){g.destroy();}});g.open();});}};};a.getSemanticNavigationUrl=function(c){var U="#"+jQuery.trim(c.navigation_semantic_object);U+="-"+jQuery.trim(c.navigation_semantic_action);if(c.navigation_semantic_parameters&&jQuery.trim(c.navigation_semantic_parameters).length>0){U+="?"+jQuery.trim(c.navigation_semantic_parameters);}return U;};a.addParamsToUrl=function(U,d){var p="",b=U.indexOf("?")!==-1,t=d.targetParams,i;if(t&&t.length>0){for(i=0;i<t.length;i=i+1){p+=t[i];if(i<t.length-1){p+="&";}}}if(p.length>0){if(!b){U+="?";}else{U+="&";}U+=p;}return U;};a._normalizeNumber=function(n,m,b,i){var c;if(isNaN(n)){c=n;}else{var o=N.getFloatInstance({maxFractionDigits:i});if(!b){var d=Math.abs(n);if(d>=1000000000){b='B';n/=1000000000;}else if(d>=1000000){b='M';n/=1000000;}else if(d>=1000){b='K';n/=1000;}}c=o.format(n);}var e=c;var f=e[m-1];m-=(f==='.'||f===',')?1:0;e=e.substring(0,m);return{displayNumber:e,numberFactor:b};};a._shouldProcessDigits=function(d,D){var n;d=typeof(d)!=='string'?d.toString():d;if(d.indexOf('.')!==-1){n=d.split(".")[1].length;if(n>D){return true;}}return false;};return a;},true);
sap.ui.predefine('sap/ushell/services/CrossApplicationNavigation',["sap/ushell/services/AppConfiguration","sap/ushell/services/_CrossApplicationNavigation/utils","sap/ushell/utils/type","sap/ushell/TechnicalParameters","sap/ushell/components/applicationIntegration/AppLifeCycle"],function(a,u,t,T,A){"use strict";function C(c,p,s){var o,S;if(s&&s.config){S=s.config;}function g(v,d){var r,e,f;if(typeof v!=="string"&&!jQuery.isPlainObject(v)&&v!==undefined){jQuery.sap.log.error("Unexpected input type",null,"sap.ushell.services.CrossApplicationNavigation");return undefined;}if(v===undefined){return undefined;}var n;if(d){if(typeof d.getComponentData!=="function"||!jQuery.isPlainObject(d.getComponentData())||!d.getComponentData().startupParameters||!jQuery.isPlainObject(d.getComponentData().startupParameters)){jQuery.sap.log.error("Cannot call getComponentData on component","the component should be an application root component","sap.ushell.services.CrossApplicationNavigation");}else{f=d.getComponentData().startupParameters;if(f.hasOwnProperty("sap-system")){e=f["sap-system"][0];}if(f.hasOwnProperty("sap-ushell-next-navmode")){n=f["sap-ushell-next-navmode"][0];}}}else{r=a.getCurrentApplication();if(r&&r["sap-system"]){e=r["sap-system"];}else if(r&&r.url){e=jQuery.sap.getUriParameters(r.url).get("sap-system");}if(r&&r["sap-ushell-next-navmode"]){n=r["sap-ushell-next-navmode"];}else if(r&&r.url){n=jQuery.sap.getUriParameters(r.url).get("sap-ushell-next-navmode");}}var i=u._injectParameters({type:t,inject:{"sap-system":e,"sap-ushell-navmode":n},args:v});return i;}function b(v){var d,e,f;if(localStorage&&localStorage["sap-ushell-enc-test"]==="false"){return v;}if(!S||!S["sap-ushell-enc-test"]){if(localStorage&&localStorage["sap-ushell-enc-test"]!=="true"){return v;}}if(typeof v!=="string"&&!jQuery.isPlainObject(v)&&v!==undefined){jQuery.sap.log.error("Unexpected input type",null,"sap.ushell.services.CrossApplicationNavigation");return undefined;}if(v===undefined){return undefined;}if(jQuery.isPlainObject(v)){e=jQuery.extend(true,{},v);if(e.target&&e.target.shellHash){if(typeof e.target.shellHash==="string"){if(e.target.shellHash!=="#"&&e.target.shellHash!==""){e.target.shellHash=b(e.target.shellHash);}}return e;}e.params=e.params||{};e.params["sap-ushell-enc-test"]=["A B%20C"];return e;}else{f=v;if(!/[?&]sap-system=/.test(f)){d=(f.indexOf("?")>-1)?"&":"?";f+=d+"sap-ushell-enc-test="+encodeURIComponent("A B%20C");}return f;}}this._extractInnerAppRoute=function(i){var d=this,P,I;if(typeof i==="string"){P=i.split("&/");I=P.shift();return{intent:I,innerAppRoute:P.length>0?"&/"+P.join("&/"):""};}if(Object.prototype.toString.apply(i)==="[object Object]"){var e=jQuery.sap.getObject("target.shellHash",undefined,i);if(typeof e==="string"){var r=d._extractInnerAppRoute(e);i.target.shellHash=r.intent;return{intent:i,innerAppRoute:r.innerAppRoute};}if(i.hasOwnProperty("appSpecificRoute")){var v=i.appSpecificRoute;delete i.appSpecificRoute;var f=typeof v==="string"&&v.indexOf("&/")!==0&&v.length>0;return{innerAppRoute:f?"&/"+v:v,intent:i};}return{intent:i,innerAppRoute:""};}jQuery.sap.log.error("Invalid input parameter","expected string or object","sap.ushell.services.CrossApplicationNavigation");return{intent:i};};this._injectInnerAppRoute=function(i,I){var d,e=this;if(!I){return i;}if(typeof i==="string"){return i+I;}if(Object.prototype.toString.apply(i)==="[object Object]"){d=jQuery.sap.getObject("target.shellHash",undefined,i);if(typeof d==="string"){i.target.shellHash=e._injectInnerAppRoute(d,I);return i;}i.appSpecificRoute=I;}return i;};this.hrefForExternal=function(d,e,f){var h,E,i;if(sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){h=jQuery.sap.extend(true,{},d);E=this._extractInnerAppRoute(h);i=E.intent;u.addXAppStateFromParameter(i,"sap-xapp-state-data");h=g(i,e);h=u._injectStickyParameters({args:h,appLifeCycle:A,technicalParameters:T,type:t});h=b(h);h=this._injectInnerAppRoute(h,E.innerAppRoute);return sap.ushell.Container.getService("ShellNavigation").hrefForExternal(h,undefined,e,f);}jQuery.sap.log.debug("Shell not available, no Cross App Navigation");if(f){return(new jQuery.Deferred()).resolve("").promise();}return"";};this.expandCompactHash=function(h){return sap.ushell.Container.getService("NavTargetResolution").expandCompactHash(h);};this.backToPreviousApp=function(){if(this.isInitialNavigation()){this.toExternal({target:{shellHash:"#"},writeHistory:false});return;}this.historyBack();};this.historyBack=function(i){var d=-1;if(i&&typeof i==="number"){if(i<=0){jQuery.sap.log.warning("historyBack called with an argument <= 0 and will result in a forward navigation or refresh","expected was an argument > 0","sap.ushell.services.CrossApplicationNavigation#historyBack");}d=i*-1;}window.history.go(d);};this.isInitialNavigation=function(){var d=sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation");if(!d){jQuery.sap.log.debug("ShellNavigation service not available","This will be treated as the initial navigation","sap.ushell.services.CrossApplicationNavigation");return true;}var i=d.isInitialNavigation();if(typeof i==="undefined"){return true;}return i;};this.toExternal=function(d,e){var f,E,i,w=d.writeHistory;if(sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){f=jQuery.sap.extend(true,{},d);E=this._extractInnerAppRoute(f);i=E.intent;u.addXAppStateFromParameter(i,"sap-xapp-state-data");f=g(i,e);f=u._injectStickyParameters({args:f,appLifeCycle:A,technicalParameters:T,type:t});f=b(f);delete f.writeHistory;f=this._injectInnerAppRoute(f,E.innerAppRoute);sap.ushell.Container.getService("ShellNavigation").toExternal(f,e,w);return;}jQuery.sap.log.debug("Shell not avialable, no Cross App Navigation");return;};this.hrefForAppSpecificHash=function(d){if(sap.ushell&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){return sap.ushell.Container.getService("ShellNavigation").hrefForAppSpecificHash(d);}jQuery.sap.log.debug("Shell not available, no Cross App Navigation; fallback to app-specific part only");return"#"+encodeURI(d);};this.getPrimaryIntent=function(d,P){var q={};var f;var r=/^#\w+-displayFactSheet(?:$|\?.)/;q.tags=["primaryAction"];q.semanticObject=d;if(P){q.params=P;}return this.getLinks(q).then(function(l){if(l.length===0){delete q.tags;q.action="displayFactSheet";f=function(L,O){var e;if(L.intent===O.intent){return 0;}e=r.test(L.intent)^r.test(O.intent);if(e){return r.test(L.intent)?-1:1;}return L.intent<O.intent?-1:1;};return this.getLinks(q);}f=function(L,O){if(L.intent===O.intent){return 0;}return L.intent<O.intent?-1:1;};return l;}.bind(this)).then(function(l){return l.length===0?null:l.sort(f)[0];});};this.getSemanticObjectLinks=function(d,P,i,e,f,h){var m,j,E;m=u._injectStickyParameters({args:{params:P},appLifeCycle:A,technicalParameters:T,type:t});m=g(m,e).params;m=b({params:m}).params;j=sap.ushell.Container.getService("NavTargetResolution");var v;if(jQuery.isArray(d)){v=[];d.forEach(function(k){v.push([{semanticObject:k[0],params:k[1],ignoreFormFactor:!!k[2],ui5Component:k[3],appStateKey:k[4],compactIntents:!!(k[5])}]);});}else{v={semanticObject:d,params:m,ignoreFormFactor:i,ui5Component:e,appStateKey:f,compactIntents:!!h};}E=sap.ushell.utils.invokeUnfoldingArrayArguments(j.getLinks.bind(j),[v]);return E;};this.getLinks=function(v){var e;e=sap.ushell.utils.invokeUnfoldingArrayArguments(this._getLinks.bind(this),[v]);return e;};this._getLinks=function(n){var N,P,m,d=sap.ushell.Container.getService("NavTargetResolution");if(typeof n==="undefined"){n={};}N=jQuery.extend(true,{},n);N.compactIntents=!!N.compactIntents;N.action=N.action||undefined;N.paramsOptions=u.extractGetLinksParameterOptions(N.params);N=u._injectStickyParameters({args:N,appLifeCycle:A,technicalParameters:T,type:t});P=N.params?u.extractGetLinksParameterDefinition(N.params):N.params;m=g({params:P},N.ui5Component).params;m=b({params:m}).params;if(N.appStateKey){m["sap-xapp-state"]=[N.appStateKey];delete N.appStateKey;}N.params=m;return d.getLinks(N);};this.getDistinctSemanticObjects=function(){var d=sap.ushell.Container.getService("NavTargetResolution");return d.getDistinctSemanticObjects();};this.isIntentSupported=function(i,d){var D=new jQuery.Deferred(),O={},e=i.map(function(I){var f=g(I,d);O[f]=I;return f;});sap.ushell.Container.getService("NavTargetResolution").isIntentSupported(e).done(function(I){var m={};Object.keys(I).forEach(function(k){m[O[k]]=I[k];});D.resolve(m);}).fail(D.reject.bind(D));return D.promise();};this.isNavigationSupported=function(i,d){var e=i.map(function(I){return g(I,d);});return sap.ushell.Container.getService("NavTargetResolution").isNavigationSupported(e);};this.isUrlSupported=function(U){var d=new jQuery.Deferred(),e,h;if(typeof U!=="string"){d.reject();return d.promise();}e=sap.ushell.Container.getService("URLParsing");if(e.isIntentUrl(U)){h=e.getHash(U);this.isIntentSupported(["#"+h]).done(function(r){if(r["#"+h]&&r["#"+h].supported){d.resolve();}else{d.reject();}}).fail(function(){d.reject();});}else{d.resolve();}return d.promise();};this.createComponentInstance=function(i,d,O){var e,U,f,h;if(!d){d={};}else{h=Object.keys(d).length;if(h>1||(h===1&&!d.componentData)){throw"`oConfig` argument should either be an empty object or contain only the `componentData` property.";}}if(d.componentData){delete d.componentData.startupParameters;delete d.componentData.config;delete d.componentData["sap-xapp-state"];}e=sap.ushell.Container;U=e.getService("URLParsing");f=U.constructShellHash(U.parseShellHash(i));if(!f){return new jQuery.Deferred(function(D){D.reject("Navigation intent invalid!");}).promise();}return e.getService("NavTargetResolution").resolveHashFragment("#"+f).then(function(r){if(r.applicationType!==sap.ushell.components.container.ApplicationType.URL&&!(/^SAPUI5\.Component=/.test(r.additionalInformation))){return new jQuery.Deferred(function(D){D.reject("The resolved target mapping is not of type UI5 component.");}).promise();}r=jQuery.extend(true,{},r,d);if(!r.ui5ComponentName&&r.additionalInformation){r.ui5ComponentName=r.additionalInformation.replace(/^SAPUI5\.Component=/,"");}return new jQuery.Deferred(function(D){var j=e.getService("Ui5ComponentLoader");if(O){O.runAsOwner(function(){k(r);});}else{k(r);}function k(l){l.loadDefaultDependencies=false;j.createComponent(l).then(function(m){D.resolve(m.componentHandle.getInstance());},function(E){E=E||"";jQuery.sap.log.error("Cannot create UI5 component: "+E,E.stack,"sap.ushell.services.CrossApplicationNavigation");D.reject(E);});}}).promise();});};this.createEmptyAppState=function(d,e){if(!o){o=sap.ushell.Container.getService("AppState");}if(!(d instanceof sap.ui.core.UIComponent)){throw new Error("oAppComponent passed must be a UI5 Component");}return o.createEmptyAppState(d,e);};this.getStartupAppState=function(d){this._checkComponent(d);var e=d.getComponentData()&&d.getComponentData()["sap-xapp-state"]&&d.getComponentData()["sap-xapp-state"][0];return this.getAppState(d,e);};this._checkComponent=function(d){if(!(d instanceof sap.ui.core.UIComponent)){throw new Error("oComponent passed must be a UI5 Component");}};this.getAppState=function(d,e){var f,D=new jQuery.Deferred();this._checkComponent(d);if(!o){o=sap.ushell.Container.getService("AppState");}if(typeof e!=="string"){if(e!==undefined){jQuery.sap.log.error("Illegal Argument sAppStateKey ");}setTimeout(function(){f=o.createEmptyUnmodifiableAppState(d);D.resolve(f);},0);return D.promise();}return o.getAppState(e);};this.getAppStateData=function(d){return sap.ushell.utils.invokeUnfoldingArrayArguments(this._getAppStateData.bind(this),[d]);};this._getAppStateData=function(d){var D=new jQuery.Deferred();if(!o){o=sap.ushell.Container.getService("AppState");}if(typeof d!=="string"){if(d!==undefined){jQuery.sap.log.error("Illegal Argument sAppStateKey ");}setTimeout(function(){D.resolve(undefined);},0);}else{o.getAppState(d).done(function(e){D.resolve(e.getData());}).fail(D.resolve.bind(D,undefined));}return D.promise();};this.saveMultipleAppStates=function(d){var r=[],D=new jQuery.Deferred();d.forEach(function(e){r.push(e.save());});jQuery.when.apply(this,r).done(function(){D.resolve(r);}).fail(function(){D.reject("save failed");});return D.promise();};}C.hasNoAdapter=true;return C;},true);
sap.ui.predefine('sap/ushell/services/_CrossApplicationNavigation/utils',[],function(){"use strict";var U={};U.extractGetLinksParameterOptions=function(g){return U.parseGetLinksParameters(g).filter(function(p){return Object.keys(p.options).length>0;}).map(function(p){return{name:p.name,options:p.options};});};U.extractGetLinksParameterDefinition=function(g){return U.parseGetLinksParameters(g).reduce(function(r,p){r[p.name]=p.value;return r;},{});};U.parseGetLinksParameters=function(g){if(Object.prototype.toString.apply(g)!=="[object Object]"){return[];}var p=JSON.parse(JSON.stringify(g));return Object.keys(p).map(function(P){var v=p[P];var o={};if(Object.prototype.toString.apply(v)==="[object Object]"){v=v.value;delete p[P].value;o=p[P];}return{name:P,value:v,options:o};});};U.safeParseToObject=function(o){try{return JSON.parse(o);}catch(e){jQuery.sap.log.error("Cannot parse the given string to object",o,"sap.ushell.services.CrossApplicationNavigation");}return null;};U.createAppStateFromData=function(d){var a=sap.ushell.Container.getService("AppState");var A=a.createEmptyAppState(null);A.setData(d);A.save();return A.getKey();};U.extractParameter=function(i,p){var I,P=null,u;if(typeof i==="string"){if(i.indexOf(p+"=")===-1){return{intent:i,data:null};}u=sap.ushell.Container.getService("URLParsing");var o=u.parseShellHash(i);if(!o){return{intent:i,data:null};}P=o.params[p];delete o.params[p];I=u.constructShellHash(o);return{intent:I,data:P};}if(Object.prototype.toString.apply(i)==="[object Object]"){var s=jQuery.sap.getObject("target.shellHash",undefined,i);if(typeof s==="string"){var r=U.extractParameter(s,p);i.target.shellHash=r.intent;return{intent:i,data:r.data};}var a=i.params;if(a&&a[p]){P=typeof a[p]==="string"?[a[p]]:a[p];delete a[p];}return{intent:i,data:P};}jQuery.sap.log.error("Invalid input parameter","expected string or object","sap.ushell.services.CrossApplicationNavigation");return{intent:i};};U.addXAppStateFromParameter=function(i,s){var I,x,a,X,A;x=U.extractParameter(i,s);I=x.intent;X=x.data&&x.data[0];if(!X){return;}a=U.safeParseToObject(X);if(!a){return;}A=U.createAppStateFromData(a);U.injectParameter(I,"sap-xapp-state",A);};U.injectParameter=function(i,p,P){if(typeof i==="string"){var u=sap.ushell.Container.getService("URLParsing");var o=u.parseShellHash(i);o.params[p]=P;return u.constructShellHash(o);}if(Object.prototype.toString.apply(i)==="[object Object]"){var s=jQuery.sap.getObject("target.shellHash",undefined,i);if(typeof s==="string"){i.target.shellHash=U.injectParameter(s,p,P);return i;}if(!i.params){i.params={};}i.params[p]=P;}return i;};U._injectParameters=function(p){var P=p.inject,t=p.type,a=p.args;if(t.isPlainObject(a)){if(a.target&&a.target.shellHash){if(typeof a.target.shellHash==="string"){a.target.shellHash=U._injectParameters({inject:P,type:p.type,args:a.target.shellHash});}return a;}var n=Object.keys(P).reduce(function(i,b){var v=P[b];if(v&&!i.hasOwnProperty(b)){i[b]=v;}return i;},a.params||{});if(n&&Object.keys(n).length>0){a.params=n;}return a;}var s=a;if(s){Object.keys(P).forEach(function(b){var v=P[b];var r=new RegExp("[?&]"+b);var h=!r.test(s);if(v&&h){var S=s.indexOf("?")>-1?"&":"?";s+=S+b+"="+v;}});}return s;};U._injectStickyParameters=function(p){var a=sap.ushell.Container.getService("AppLifeCycle");if(!a||Object.keys(a).length<=0){return p.args;}var c=a.getCurrentApplication();if(!c||Object.keys(c).length<=0){return p.args;}var A=p.appLifeCycle;var t=p.technicalParameters;var s=t.getParameters({sticky:true}).reduce(function(S,n){var N=n.name;var C=c.componentInstance;var b=c.applicationType;var d;if(b==="UI5"){d={};}else{d=A.getCurrentApplication().container;}var e=t.getParameterValueSync(N,C,d,b);var f=n.stickyName||N;S[f]=e;return S;},{});var o={type:p.type,inject:s,args:p.args};return U._injectParameters(o);};return U;});
//Copyright (c) 2013 SAP AG, All Rights Reserved
sap.ui.predefine('sap/ushell/components/tiles/indicatorDual/DualTile.view',['sap/ui/core/mvc/JSView','sap/ushell/components/tiles/indicatorTileUtils/oData4Analytics','sap/ushell/components/tiles/indicatorTileUtils/smartBusinessUtil','sap/ushell/components/tiles/sbtilecontent'],function(J,d,s,a){"use strict";sap.ui.getCore().loadLibrary("sap.suite.ui.microchart");sap.ui.jsview("sap.ushell.components.tiles.indicatorDual.DualTile",{getControllerName:function(){return"sap.ushell.components.tiles.indicatorDual.DualTile";},createContent:function(c){this.setHeight('100%');this.setWidth('100%');var t=this;t.tileData;t.oGenericTileData={};sap.ushell.components.tiles.indicatorTileUtils.util.getParsedChip(t.getViewData().chip.configuration.getParameterValueAsString("tileConfiguration"),t.getViewData().chip.preview.isEnabled(),function(g){t.oConfig=g;});t.tileType=t.oConfig.TILE_PROPERTIES.tileType;t.oNumericContent=new sap.m.NumericContent({value:"{/value}",scale:"{/scale}",unit:"{/unit}",indicator:"{/indicator}",size:"{/size}",formatterValue:"{/isFormatterValue}",truncateValueTo:5,valueColor:"{/valueColor}",nullifyValue:false});t.oLeftTileContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oNumericContent});switch(t.tileType){case"DT-CM":var C=new sap.suite.ui.microchart.ComparisonMicroChartData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oComparisionContent=new sap.suite.ui.microchart.ComparisonMicroChart({size:"{/size}",scale:"{/scale}",data:{template:C,path:"/data"}});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oComparisionContent});break;case"DT-CT":var C=new sap.suite.ui.microchart.ComparisonMicroChartData({title:"{title}",value:"{value}",color:"{color}",displayValue:"{displayValue}"});t.oContributionContent=new sap.suite.ui.microchart.ComparisonMicroChart({size:"{/size}",scale:"{/scale}",data:{template:C,path:"/data"}});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:t.oContributionContent});break;case"DT-TT":var b=function(n){return new sap.suite.ui.microchart.AreaMicroChartItem({color:"Good",points:{path:"/"+n+"/data",template:new sap.suite.ui.microchart.AreaMicroChartPoint({x:"{day}",y:"{balance}"})}});};var e=function(n){return new sap.suite.ui.microchart.AreaMicroChartLabel({label:"{/"+n+"/label}",color:"{/"+n+"/color}"});};var f=new sap.suite.ui.microchart.AreaMicroChart({width:"{/width}",height:"{/height}",size:"{/size}",target:b("target"),innerMinThreshold:b("innerMinThreshold"),innerMaxThreshold:b("innerMaxThreshold"),minThreshold:b("minThreshold"),maxThreshold:b("maxThreshold"),chart:b("chart"),minXValue:"{/minXValue}",maxXValue:"{/maxXValue}",minYValue:"{/minYValue}",maxYValue:"{/maxYValue}",firstXLabel:e("firstXLabel"),lastXLabel:e("lastXLabel"),firstYLabel:e("firstYLabel"),lastYLabel:e("lastYLabel"),minLabel:e("minLabel"),maxLabel:e("maxLabel")});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",content:f});break;case"DT-AT":var B=new sap.suite.ui.microchart.BulletMicroChartData({value:"{value}",color:"{color}"});var o=new sap.suite.ui.microchart.BulletMicroChart({size:sap.m.Size.Auto,scale:"{/scale}",actual:{value:"{/actual/value}",color:"{/actual/color}"},targetValue:"{/targetValue}",actualValueLabel:"{/actualValueLabel}",targetValueLabel:"{/targetValueLabel}",thresholds:{template:B,path:"/thresholds"},state:"{/state}",showActualValue:"{/showActualValue}",showTargetValue:"{/showTargetValue}"});t.oRightContent=new sap.ushell.components.tiles.sbtilecontent({unit:"{/unit}",size:"{/size}",footer:"{/footerNum}",content:o});break;}t.oGenericTile=new sap.m.GenericTile({subheader:"{/subheader}",frameType:"TwoByOne",size:"{/size}",header:"{/header}",tileContent:[t.oLeftTileContent,t.oRightContent]});t.oGenericTileModel=new sap.ui.model.json.JSONModel();t.oGenericTileModel.setData(t.oGenericTileData);t.oGenericTile.setModel(t.oGenericTileModel);return t.oGenericTile;}});},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine('sap/ui/model/analytics/AnalyticalVersionInfo',["sap/base/Log"],function(L){"use strict";var A={NONE:null,V1:1,V2:2,getVersion:function(o){var v;var O;if(o&&o.getMetadata){O=o.getMetadata().getName();}switch(O){case"sap.ui.model.odata.ODataModel":v=this.V1;break;case"sap.ui.model.odata.v2.ODataModel":v=this.V2;break;default:v=this.NONE;L.info("AnalyticalVersionInfo.getVersion(...) - The given object is no instance of ODataModel V1 or V2!");break;}return v;}};return A;},true);
sap.ui.predefine('sap/ui/model/analytics/odata4analytics',['sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/ui/model/Sorter','./AnalyticalVersionInfo',"sap/base/security/encodeURL"],function(F,c,S,A,e){"use strict";var o=o||{},d=/^\d+$/;o.constants={};o.constants["SAP_NAMESPACE"]="http://www.sap.com/Protocols/SAPData";o.constants["VERSION"]="0.7";o.helper={tokenizeNametoLabelText:function(n){var l="";l=n.replace(/^P_(.*)/,"$1");l=l.replace(/([^A-Z0-9_]+)([A-Z0-9_])/g,"$1 $2");l=l.replace(/([A-Z0-9_]{2,})([A-Z0-9_])([^A-Z0-9_]+)/g,"$1 $2$3");l=l.replace(/(.*) _E$/,"$1");l=l.replace(/(.*) _(.*)/g,"$1 $2");return l;}};o.Model=function(m,p){this._init(m,p);};o.Model.ReferenceByURI=function(u){return{sServiceURI:u};};o.Model.ReferenceByModel=function(m){return{oModel:m};};o.Model.ReferenceWithWorkaround=function(m,w){return{oModelReference:m,aWorkaroundID:w};};o.Model.prototype={_init:function(m,p){if(typeof p=="string"){throw"Deprecated second argument: Adjust your invocation by passing an object with a property sAnnotationJSONDoc as a second argument instead";}this._mParameter=p;var t=this;this._oActivatedWorkarounds={};if(m&&m.aWorkaroundID){for(var i=-1,I;(I=m.aWorkaroundID[++i])!==undefined;){this._oActivatedWorkarounds[I]=true;}m=m.oModelReference;}if(!m||(!m.sServiceURI&&!m.oModel)){throw"Usage with oModelReference being an instance of Model.ReferenceByURI or Model.ReferenceByModel";}if(m.oModel){this._oModel=m.oModel;this._iVersion=A.getVersion(this._oModel);a();}else if(p&&p.modelVersion===A.V2){var V=sap.ui.requireSync("sap/ui/model/odata/v2/ODataModel");this._oModel=new V(m.sServiceURI);this._iVersion=A.V2;a();}else{var O=sap.ui.requireSync("sap/ui/model/odata/ODataModel");this._oModel=new O(m.sServiceURI);this._iVersion=A.V1;a();}if(this._oModel.getServiceMetadata()&&this._oModel.getServiceMetadata().dataServices==undefined){throw"Model could not be loaded";}function a(){if(!t._oModel.getServiceMetadata()){t._oModel.attachMetadataLoaded(b);}else{b();}}function b(){if(t.bIsInitialized){return;}t.bIsInitialized=true;if(p&&p.sAnnotationJSONDoc){t.mergeV2Annotations(p.sAnnotationJSONDoc);}t._interpreteMetadata(t._oModel.getServiceMetadata().dataServices);}},_interpreteMetadata:function(M){this._oQueryResultSet={};this._oParameterizationSet={};this._oEntityTypeSet={};this._oEntitySetSet={};this._oEntityTypeNameToEntitySetMap={};var a=this._oModel.getServiceMetadata().dataServices.schema[0];for(var j=-1,C;(C=a.entityContainer[++j])!==undefined;){if(C.isDefaultEntityContainer=="true"){this._oDefaultEntityContainer=C;break;}}var E=a.entityType;var q=[],P=[],u=[];for(var k=-1,T;(T=E[++k])!==undefined;){var b=false;if(T.extensions!=undefined){for(var l=-1,f;(f=T.extensions[++l])!==undefined;){if(f.namespace==o.constants.SAP_NAMESPACE&&f.name=="semantics"){b=true;switch(f.value){case"aggregate":q.push(T);break;case"parameters":P.push(T);break;default:u.push(T);}}if(b){continue;}}if(!b){u.push(T);}}else{u.push(T);}}for(var m=-1,g;(g=u[++m])!==undefined;){var h=new o.EntityType(this._oModel.getServiceMetadata(),a,g);this._oEntityTypeSet[h.getQName()]=h;var i=this._getEntitySetsOfType(a,h.getQName());if(i.length==0){throw"Invalid consumption model: No entity set for entity type "+h.getQName()+" found";}if(i.length>1){throw"Unsupported consumption model: More than one entity set for entity type "+h.getQName()+" found";}var v=new o.EntitySet(this._oModel.getServiceMetadata(),a,i[0][0],i[0][1],h);this._oEntitySetSet[v.getQName()]=v;this._oEntityTypeNameToEntitySetMap[h.getQName()]=v;}var w={};for(var n=-1,x;(x=P[++n])!==undefined;){var y=new o.EntityType(this._oModel.getServiceMetadata(),a,x);this._oEntityTypeSet[y.getQName()]=y;var z=this._getEntitySetsOfType(a,y.getQName());if(z.length==0){throw"Invalid consumption model: No entity set for parameter entity type "+y.getQName()+" found";}if(z.length>1){throw"Unsupported consumption model: More than one entity set for parameter entity type "+y.getQName()+" found";}var B=new o.EntitySet(this._oModel.getServiceMetadata(),a,z[0][0],z[0][1],y);this._oEntitySetSet[B.getQName()]=B;this._oEntityTypeNameToEntitySetMap[y.getQName()]=B;var D=new o.Parameterization(y,B);this._oParameterizationSet[D.getName()]=D;w[y.getQName()]=D;var G=y.getQName();if(a.association!=undefined){for(var p=-1,H;(H=a.association[++p])!==undefined;){if(H.referentialConstraint==undefined){continue;}var I=null;if(H.end[0].type==G&&H.end[0].multiplicity=="*"&&H.end[1].multiplicity=="1"){I=H.end[1].type;}else if(H.end[1].type==G&&H.end[1].multiplicity=="*"&&H.end[0].multiplicity=="1"){I=H.end[0].type;}if(!I){continue;}if(H.referentialConstraint.dependent.propertyRef.length!=1){continue;}var J=D.findParameterByName(H.referentialConstraint.dependent.propertyRef[0].name);if(J==null){continue;}var V=this._oEntityTypeSet[I];var K=this._oEntityTypeNameToEntitySetMap[I];J.setValueSetEntity(V,K);}}}for(var r=-1,L;(L=q[++r])!==undefined;){var N=new o.EntityType(this._oModel.getServiceMetadata(),a,L);this._oEntityTypeSet[N.getQName()]=N;var Q=N.getQName();var O=null;var R=null;if(a.association!=undefined){for(var s=-1,U;(U=a.association[++s])!==undefined;){var W=null;if(U.end[0].type==Q){W=U.end[1].type;}else if(U.end[1].type==Q){W=U.end[0].type;}else{continue;}var X=null;X=w[W];if(X!=null){if(O!=null){throw"LIMITATION: Unable to handle multiple parameter entity types of query entity "+N.name;}else{O=X;R=U;}}}}var Y=this._getEntitySetsOfType(a,N.getQName());if(Y.length!=1){throw"Invalid consumption model: There must be exactly one entity set for an entity type annotated with aggregating semantics";}var Z=new o.EntitySet(this._oModel.getServiceMetadata(),a,Y[0][0],Y[0][1],N);this._oEntitySetSet[Z.getQName()]=Z;this._oEntityTypeNameToEntitySetMap[N.getQName()]=Z;var $=new o.QueryResult(this,N,Z,O);this._oQueryResultSet[$.getName()]=$;if(O){O.setTargetQueryResult($,R);}if(a.association!=undefined){for(var t=-1,_;(_=a.association[++t])!==undefined;){if(_.referentialConstraint==undefined){continue;}var a1=null;if(_.end[0].type==Q&&_.end[0].multiplicity=="*"&&_.end[1].multiplicity=="1"){a1=_.end[1].type;}else if(_.end[1].type==Q&&_.end[1].multiplicity=="*"&&_.end[0].multiplicity=="1"){a1=_.end[0].type;}if(!a1){continue;}if(_.referentialConstraint.dependent.propertyRef.length!=1){continue;}var b1=$.findDimensionByName(_.referentialConstraint.dependent.propertyRef[0].name);if(b1==null){continue;}var c1=this._oEntityTypeNameToEntitySetMap[a1];b1.setMembersEntitySet(c1);}}}},oUI5ODataModelAnnotatableObject:{objectName:"schema",keyPropName:"namespace",extensions:true,aSubObject:[{objectName:"entityType",keyPropName:"name",extensions:true,aSubObject:[{objectName:"property",keyPropName:"name",aSubObject:[],extensions:true}]},{objectName:"entityContainer",keyPropName:"name",extensions:false,aSubObject:[{objectName:"entitySet",keyPropName:"name",extensions:true,aSubObject:[]}]}]},mergeV2Annotations:function(a){var b=null;try{b=JSON.parse(a);}catch(f){return;}var m;try{m=this._oModel.getServiceMetadata().dataServices;}catch(f){return;}for(var p in b){if(!(this.oUI5ODataModelAnnotatableObject.objectName==p)){continue;}if(!(b[p]instanceof Array)){continue;}this.mergeV2AnnotationLevel(m[this.oUI5ODataModelAnnotatableObject.objectName],b[this.oUI5ODataModelAnnotatableObject.objectName],this.oUI5ODataModelAnnotatableObject);break;}return;},mergeV2AnnotationLevel:function(M,a,u){for(var i=-1,b;(b=a[++i])!==undefined;){for(var j=-1,f;(f=M[++j])!==undefined;){if(!(b[u.keyPropName]==f[u.keyPropName])){continue;}if(b["extensions"]!=undefined){if(f["extensions"]==undefined){f["extensions"]=[];}for(var l=-1,g;(g=b["extensions"][++l])!==undefined;){var h=false;for(var m=-1,n;(n=f["extensions"][++m])!==undefined;){if(g.name==n.name&&g.namespace==n.namespace){n.value=g.value;h=true;break;}}if(!h){f["extensions"].push(g);}}}for(var k=-1,U;(U=u.aSubObject[++k])!==undefined;){for(var p in b){if(!(U.objectName==p)){continue;}if(!(b[U.objectName]instanceof Array)){continue;}if((f[U.objectName]==undefined)||(!(f[U.objectName]instanceof Array))){continue;}this.mergeV2AnnotationLevel(f[U.objectName],b[U.objectName],U);break;}}}}return;},findQueryResultByName:function(n){var q=this._oQueryResultSet[n];if(!q&&this._oDefaultEntityContainer){var Q=this._oDefaultEntityContainer.name+"."+n;q=this._oQueryResultSet[Q];}return q;},getAllQueryResultNames:function(){if(this._aQueryResultNames){return this._aQueryResultNames;}this._aQueryResultNames=new Array(0);for(var n in this._oQueryResultSet){this._aQueryResultNames.push(this._oQueryResultSet[n].getName());}return this._aQueryResultNames;},getAllQueryResults:function(){return this._oQueryResultSet;},getODataModel:function(){return this._oModel;},_getEntitySetsOfType:function(s,q){var E=[];for(var i=-1,a;(a=s.entityContainer[++i])!==undefined;){for(var j=-1,b;(b=a.entitySet[++j])!==undefined;){if(b.entityType==q){E.push([a,b]);}}}return E;},_mParameter:null,_oModel:null,_oDefaultEntityContainer:null,_aQueryResultNames:null,_oQueryResultSet:null,_oParameterizationSet:null,_oEntityTypeSet:null,_oEntitySetSet:null,_oEntityTypeNameToEntitySetMap:null,_oActivatedWorkarounds:null};o.QueryResult=function(m,E,a,p){this._init(m,E,a,p);};o.QueryResult.prototype={_init:function(m,E,a,p,b){this._oModel=m;this._oEntityType=E;this._oEntitySet=a;this._oParameterization=p;this._oDimensionSet={};this._oMeasureSet={};var P=E.getTypeDescription().property;var f={};for(var i=-1,g;(g=P[++i])!==undefined;){if(g.extensions==undefined){continue;}for(var j=-1,h;(h=g.extensions[++j])!==undefined;){if(!h.namespace==o.constants.SAP_NAMESPACE){continue;}switch(h.name){case"aggregation-role":switch(h.value){case"dimension":{var D=new o.Dimension(this,g);this._oDimensionSet[D.getName()]=D;break;}case"measure":{var M=new o.Measure(this,g);this._oMeasureSet[M.getName()]=M;break;}case"totaled-properties-list":this._oTotaledPropertyListProperty=g;break;default:}break;case"attribute-for":{var k=new o.DimensionAttribute(this,g);var K=k.getKeyProperty();f[K.name]=k;break;}default:}}}for(var s in f){var l=f[s];l.getDimension().addAttribute(l);}if(m._oActivatedWorkarounds.IdentifyTextPropertiesByName){var n=[];for(var q in this._oDimensionSet){var r=this._oDimensionSet[q];if(!r.getTextProperty()){var T=null;T=E.findPropertyByName(q+"Name");if(!T){T=E.findPropertyByName(q+"Text");}if(!T){T=E.findPropertyByName(q+"Desc");}if(!T){T=E.findPropertyByName(q+"Description");}if(T){r.setTextProperty(T);n.push(T.name);}}}for(var t=-1,u;(u=n[++t])!==undefined;){delete this._oDimensionSet[u];}}},getName:function(){return this.getEntitySet().getQName();},getParameterization:function(){return this._oParameterization;},getAllDimensionNames:function(){if(this._aDimensionNames){return this._aDimensionNames;}this._aDimensionNames=[];for(var n in this._oDimensionSet){this._aDimensionNames.push(this._oDimensionSet[n].getName());}return this._aDimensionNames;},getAllDimensions:function(){return this._oDimensionSet;},getAllMeasureNames:function(){if(this._aMeasureNames){return this._aMeasureNames;}this._aMeasureNames=[];for(var n in this._oMeasureSet){this._aMeasureNames.push(this._oMeasureSet[n].getName());}return this._aMeasureNames;},getAllMeasures:function(){return this._oMeasureSet;},findDimensionByName:function(n){return this._oDimensionSet[n];},findDimensionByPropertyName:function(n){if(this._oDimensionSet[n]){return this._oDimensionSet[n];}for(var D in this._oDimensionSet){var a=this._oDimensionSet[D];var t=a.getTextProperty();if(t&&t.name==n){return a;}if(a.findAttributeByName(n)){return a;}}return null;},getTotaledPropertiesListProperty:function(){return this._oTotaledPropertyListProperty;},findMeasureByName:function(n){return this._oMeasureSet[n];},findMeasureByPropertyName:function(n){if(this._oMeasureSet[n]){return this._oMeasureSet[n];}for(var m in this._oMeasureSet){var M=this._oMeasureSet[m];var f=M.getFormattedValueProperty();if(f&&f.name==n){return M;}}return null;},getModel:function(){return this._oModel;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oModel:null,_oEntityType:null,_oEntitySet:null,_oParameterization:null,_aDimensionNames:null,_oDimensionSet:null,_aMeasureNames:null,_oMeasureSet:null,_oTotaledPropertyListProperty:null};o.Parameterization=function(E,a){this._init(E,a);};o.Parameterization.prototype={_init:function(E,a){this._oEntityType=E;this._oEntitySet=a;this._oParameterSet={};var p=E.getTypeDescription().property;for(var i=-1,P;(P=p[++i])!==undefined;){if(P.extensions==undefined){continue;}for(var j=-1,b;(b=P.extensions[++j])!==undefined;){if(!b.namespace==o.constants.SAP_NAMESPACE){continue;}switch(b.name){case"parameter":{var f=new o.Parameter(this,P);this._oParameterSet[f.getName()]=f;break;}default:}}}},setTargetQueryResult:function(q,a){this._oQueryResult=q;var Q=this._oEntityType.getSchema().namespace+"."+a.name;var n=this._oEntityType.getTypeDescription().navigationProperty;if(!n){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}for(var i=-1,N;(N=n[++i])!==undefined;){if(N.relationship==Q){this._oNavPropToQueryResult=N.name;}}if(!this._oNavPropToQueryResult){throw"Invalid consumption model: Parameters entity type lacks navigation property for association to query result entity type";}},getTargetQueryResult:function(){if(!this._oQueryResult){throw"No target query result set";}return this._oQueryResult;},getName:function(){return this.getEntitySet().getQName();},getAllParameterNames:function(){if(this._aParameterNames){return this._aParameterNames;}this._aParameterNames=[];for(var n in this._oParameterSet){this._aParameterNames.push(this._oParameterSet[n].getName());}return this._aParameterNames;},getAllParameters:function(){return this._oParameterSet;},findParameterByName:function(n){return this._oParameterSet[n];},getNavigationPropertyToQueryResult:function(){return this._oNavPropToQueryResult;},getEntityType:function(){return this._oEntityType;},getEntitySet:function(){return this._oEntitySet;},_oEntityType:null,_oEntitySet:null,_oQueryResult:null,_oNavPropToQueryResult:null,_aParameterNames:null,_oParameterSet:null};o.Parameter=function(p,P){this._init(p,P);};o.Parameter.prototype={_init:function(p,P){this._oParameterization=p;this._oProperty=P;var E=p.getEntityType();if(P.extensions!=undefined){for(var i=-1,a;(a=P.extensions[++i])!==undefined;){if(!a.namespace==o.constants.SAP_NAMESPACE){continue;}switch(a.name){case"parameter":switch(a.value){case"mandatory":this._bRequired=true;break;case"optional":this._bRequired=false;break;default:throw"Invalid annotation value for parameter property";}break;case"label":this._sLabelText=a.value;break;case"text":this._oTextProperty=E.findPropertyByName(a.value);break;case"upper-boundary":this._bIntervalBoundaryParameter=true;this._oUpperIntervalBoundaryParameterProperty=E.findPropertyByName(a.value);break;case"lower-boundary":this._bIntervalBoundaryParameter=true;this._oLowerIntervalBoundaryParameterProperty=E.findPropertyByName(a.value);break;default:}}}if(!this._sLabelText){this._sLabelText="";}},setValueSetEntity:function(E,a){this._oValueSetEntityType=E;this._oValueSetEntitySet=a;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){if(!this._sLabelText&&this._oParameterization._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=o.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},isOptional:function(){return(!this._bRequired);},isIntervalBoundary:function(){return this._bIntervalBoundaryParameter;},isLowerIntervalBoundary:function(){return(this._oUpperIntervalBoundaryParameterProperty?true:false);},getPeerIntervalBoundaryParameter:function(){var p=null;if(this._oLowerIntervalBoundaryParameterProperty){p=this._oLowerIntervalBoundaryParameterProperty.name;}else{p=this._oUpperIntervalBoundaryParameterProperty.name;}if(!p){throw"Parameter is not an interval boundary";}return this._oParameterization.findParameterByName(p);},isValueSetAvailable:function(){return(this._oValueSetEntityType?true:false);},getName:function(){return this._oProperty.name;},getProperty:function(){return this._oProperty;},getContainingParameterization:function(){return this._oParameterization;},getURIToValueEntitySet:function(s){var u=null;u=(s?s:"")+"/"+this._oValueSetEntitySet.getQName();return u;},_oParameterization:null,_oProperty:null,_sLabelText:null,_oTextProperty:null,_bRequired:false,_bIntervalBoundaryParameter:false,_oLowerIntervalBoundaryParameterProperty:null,_oUpperIntervalBoundaryParameterProperty:null,_oValueSetEntityType:null,_oValueSetEntitySet:null};o.Dimension=function(q,p){this._init(q,p);};o.Dimension.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;this._oAttributeSet={};},setMembersEntitySet:function(E){this._oMembersEntitySet=E;},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){if(!this._oTextProperty){this._oTextProperty=this._oQueryResult.getEntityType().getTextPropertyOfProperty(this.getName());}return this._oTextProperty;},setTextProperty:function(t){this._oTextProperty=t;},getLabelText:function(){if(!this._sLabelText){this._sLabelText=this._oQueryResult.getEntityType().getLabelOfProperty(this.getName());}if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=o.helper.tokenizeNametoLabelText(this.getName());}return(this._sLabelText==null?"":this._sLabelText);},getSuperOrdinateDimension:function(){if(!this._sSuperOrdinateDimension){var s=this._oQueryResult.getEntityType().getSuperOrdinatePropertyOfProperty(this.getName());if(s){this._sSuperOrdinateDimension=this._oQueryResult.findDimensionByName(s.name);}}return this._sSuperOrdinateDimension;},getHierarchy:function(){if(!this._oHierarchy){this._oHierarchy=this._oQueryResult.getEntityType().getHierarchy(this._oProperty.name);}return this._oHierarchy;},getAllAttributeNames:function(){if(this._aAttributeNames){return this._aAttributeNames;}this._aAttributeNames=[];for(var n in this._oAttributeSet){this._aAttributeNames.push(this._oAttributeSet[n].getName());}return this._aAttributeNames;},getAllAttributes:function(){return this._oAttributeSet;},findAttributeByName:function(n){return this._oAttributeSet[n];},addAttribute:function(D){this._oAttributeSet[D.getName()]=D;},getContainingQueryResult:function(){return this._oQueryResult;},hasMasterData:function(){return this._oMembersEntitySet!=null?true:false;},getMasterDataEntitySet:function(){return this._oMembersEntitySet;},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sSuperOrdinateDimension:null,_aAttributeNames:null,_oAttributeSet:null,_oMembersEntitySet:null,_oHierarchy:null};o.DimensionAttribute=function(q,p){this._init(q,p);};o.DimensionAttribute.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,E;(E=p.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}switch(E.name){case"attribute-for":this._sDimensionName=E.value;break;case"label":this._sLabelText=E.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(E.value);break;default:}}}},getName:function(){return this._oProperty.name;},getKeyProperty:function(){return this._oProperty;},getTextProperty:function(){return this._oTextProperty;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=o.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},getDimension:function(){return this._oQueryResult.findDimensionByName(this._sDimensionName);},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_sDimensionName:null};o.Measure=function(q,p){this._init(q,p);};o.Measure.prototype={_init:function(q,p){this._oQueryResult=q;this._oProperty=p;if(p.extensions!=undefined){for(var i=-1,E;(E=p.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}switch(E.name){case"label":this._sLabelText=E.value;break;case"text":this._oTextProperty=q.getEntityType().findPropertyByName(E.value);break;case"unit":this._oUnitProperty=q.getEntityType().findPropertyByName(E.value);break;default:}}}if(!this._sLabelText){this._sLabelText="";}},getName:function(){return this._oProperty.name;},getRawValueProperty:function(){return this._oProperty;},getFormattedValueProperty:function(){return this._oTextProperty;},getUnitProperty:function(){return this._oUnitProperty;},getLabelText:function(){if(!this._sLabelText&&this._oQueryResult._oModel._oActivatedWorkarounds.CreateLabelsFromTechnicalNames){this._sLabelText=o.helper.tokenizeNametoLabelText(this.getName());}return this._sLabelText;},isUpdatable:function(){if(this._bIsUpdatable!=null){return this._bIsUpdatable;}var u=this._oQueryResult.getEntitySet().getUpdatablePropertyNameSet();return(u[this.getName()]!=undefined);},_oQueryResult:null,_oProperty:null,_oTextProperty:null,_sLabelText:null,_oUnitProperty:null,_bIsUpdatable:null};o.EntitySet=function(m,s,C,E,a){this._init(m,s,C,E,a);};o.EntitySet.prototype={_init:function(m,s,C,E,a){this._oEntityType=a;this._oEntitySet=E;this._oContainer=C;this._oSchema=s;this._oModel=m;if(s.entityContainer.length>1){this._sQName=C.name+"."+E.name;}else{this._sQName=E.name;}},getQName:function(){return this._sQName;},getSetDescription:function(){return this._oEntitySet;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},getUpdatablePropertyNameSet:function(){if(this._oUpdatablePropertyNames){return this._oUpdatablePropertyNames;}this._oUpdatablePropertyNames={};var s=true;if(this._oEntitySet.extensions!=undefined){for(var j=-1,E;(E=this._oEntitySet.extensions[++j])!==undefined;){if(E.namespace==o.constants.SAP_NAMESPACE&&E.name=="updatable"){if(E.value=="false"){s=false;break;}}}}if(!s){return this._oUpdatablePropertyNames;}var p=this._oEntityType.getTypeDescription().property;for(var i=-1,P;(P=p[++i])!==undefined;){var b=true;if(P.extensions==undefined){continue;}for(var k=-1,a;(a=P.extensions[++k])!==undefined;){if(a.namespace!=o.constants.SAP_NAMESPACE){continue;}if(a.name=="updatable"){if(a.value=="false"){b=false;break;}}}if(b){this._oUpdatablePropertyNames[P.name]=true;}}return this._oUpdatablePropertyNames;},_oEntityType:null,_oEntitySet:null,_oContainer:null,_oSchema:null,_oModel:null,_sQName:null,_oUpdatablePropertyNames:null};o.EntityType=function(m,s,E){this._init(m,s,E);};o.EntityType.propertyFilterRestriction={SINGLE_VALUE:"single-value",MULTI_VALUE:"multi-value",INTERVAL:"interval"};o.EntityType.prototype={_init:function(m,s,E){this._oEntityType=E;this._oSchema=s;this._oModel=m;this._aKeyProperties=[];this._oPropertySet={};this._aFilterablePropertyNames=[];this._aSortablePropertyNames=[];this._aRequiredFilterPropertyNames=[];this._oPropertyFilterRestrictionSet={};this._oPropertyHeadingsSet={};this._oPropertyQuickInfosSet={};this._sQName=s.namespace+"."+E.name;var r={};function g(K){var R=r[K];if(!R){R=r[K]={};}return R;}for(var i=-1,p;(p=E.key.propertyRef[++i])!==undefined;){this._aKeyProperties.push(p.name);}for(var k=-1,P;(P=E.property[++k])!==undefined;){this._oPropertySet[P.name]=P;this._aFilterablePropertyNames.push(P.name);this._aSortablePropertyNames.push(P.name);if(P.extensions==undefined){continue;}for(var j=-1,a;(a=P.extensions[++j])!==undefined;){if(a.namespace!==o.constants.SAP_NAMESPACE){continue;}switch(a.name){case"filterable":if(a.value=="false"){this._aFilterablePropertyNames.pop(P.name);}break;case"sortable":if(a.value=="false"){this._aSortablePropertyNames.pop(P.name);}break;case"required-in-filter":if(a.value=="true"){this._aRequiredFilterPropertyNames.push(P.name);}break;case"filter-restriction":if(a.value==o.EntityType.propertyFilterRestriction.SINGLE_VALUE||a.value==o.EntityType.propertyFilterRestriction.MULTI_VALUE||a.value==o.EntityType.propertyFilterRestriction.INTERVAL){this._oPropertyFilterRestrictionSet[P.name]=a.value;}break;case"hierarchy-node-external-key-for":g(a.value).externalKeyProperty=P;break;case"hierarchy-node-for":g(P.name).dimensionName=a.value;break;case"hierarchy-parent-node-for":case"hierarchy-parent-nod":g(a.value).parentNodeIDProperty=P;break;case"hierarchy-level-for":g(a.value).levelProperty=P;break;case"hierarchy-drill-state-for":case"hierarchy-drill-stat":g(a.value).drillStateProperty=P;break;default:}}}this._oRecursiveHierarchySet={};for(var h in r){var H=r[h];var b=this._oPropertySet[h];var D=this._oPropertySet[H.dimensionName];if(D==null){D=b;}this._oRecursiveHierarchySet[D.name]=new o.RecursiveHierarchy(E,b,H.parentNodeIDProperty,H.levelProperty,D,H.externalKeyProperty);}},getProperties:function(){return this._oPropertySet;},findPropertyByName:function(p){return this._oPropertySet[p];},getKeyProperties:function(){return this._aKeyProperties;},getLabelOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}if(E.name=="label"){return E.value;}}}return null;},getHeadingOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}var s=null;if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}if(E.name=="heading"){return E.value;}if(E.name=="label"){s=E.value;}}}return s;},getQuickInfoOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}var s=null;if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(!E.namespace==o.constants.SAP_NAMESPACE){continue;}if(E.name=="quickinfo"){return E.value;}if(E.name=="label"){s=E.value;}}}return s;},getTextPropertyOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(E.name=="text"){return this.findPropertyByName(E.value);}}}return null;},getSuperOrdinatePropertyOfProperty:function(p){var P=this._oPropertySet[p];if(P==null){throw"no such property with name "+p;}if(P.extensions!=undefined){for(var i=-1,E;(E=P.extensions[++i])!==undefined;){if(E.name=="super-ordinate"){return this.findPropertyByName(E.value);}}}return null;},getFilterablePropertyNames:function(){return this._aFilterablePropertyNames;},getSortablePropertyNames:function(){return this._aSortablePropertyNames;},getRequiredFilterPropertyNames:function(){return this._aRequiredFilterPropertyNames;},getPropertiesWithFilterRestrictions:function(){return this._oPropertyFilterRestrictionSet;},getAllHierarchyPropertyNames:function(){if(this._aHierarchyPropertyNames){return this._aHierarchyPropertyNames;}this._aHierarchyPropertyNames=[];for(var n in this._oRecursiveHierarchySet){this._aHierarchyPropertyNames.push(this._oRecursiveHierarchySet[n].getNodeValueProperty().name);}return this._aHierarchyPropertyNames;},getHierarchy:function(n){if(this._oRecursiveHierarchySet[n]==undefined){return null;}return this._oRecursiveHierarchySet[n];},getQName:function(){return this._sQName;},getTypeDescription:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_sQName:null,_aKeyProperties:null,_oPropertySet:null,_aFilterablePropertyNames:null,_aRequiredFilterPropertyNames:null,_oPropertyFilterRestrictionSet:null,_aHierarchyPropertyNames:null,_oRecursiveHierarchySet:null};o.RecursiveHierarchy=function(E,n,p,N,a,b){this._init(E,n,p,N,a,b);};o.RecursiveHierarchy.prototype={_init:function(E,n,p,N,a,b){this._oEntityType=E;this._oNodeIDProperty=n;this._oParentNodeIDProperty=p;this._oNodeLevelProperty=N;this._oNodeValueProperty=a;this._oNodeExternalKeyProperty=b;},isRecursiveHierarchy:function(){return true;},isLeveledHierarchy:function(){return false;},getNodeExternalKeyProperty:function(){return this._oNodeExternalKeyProperty;},getNodeIDProperty:function(){return this._oNodeIDProperty;},getParentNodeIDProperty:function(){return this._oParentNodeIDProperty;},getNodeLevelProperty:function(){return this._oNodeLevelProperty;},getNodeValueProperty:function(){return this._oNodeValueProperty;},_oEntityType:null,_oNodeIDProperty:null,_oParentNodeIDProperty:null,_oNodeLevelProperty:null,_oNodeValueProperty:null,_oNodeExternalKeyProperty:null};o.FilterExpression=function(m,s,E){this._init(m,s,E);};o.FilterExpression.prototype={_init:function(m,s,E){this._oEntityType=E;this._oSchema=s;this._oModel=m;this._aConditionUI5Filter=[];this._aUI5FilterArray=[];},_renderPropertyFilterValue:function(f,p){if(p==="Edm.Time"&&d.test(f)){f={ms:parseInt(f),__edmType:"Edm.Time"};}return e(this._oModel.getODataModel().formatValue(f,p));},clear:function(){this._aConditionUI5Filter=[];this._aUI5FilterArray=[];},_addCondition:function(p,O,v,V){for(var i=-1,u;(u=this._aConditionUI5Filter[++i])!==undefined;){if(u.sPath==p&&u.sOperator==O&&u.oValue1==v&&u.oValue2==V){return;}}this._aConditionUI5Filter.push(new F(p,O,v,V));},_addUI5FilterArray:function(u){this._aUI5FilterArray.push(u);},addCondition:function(p,O,v,V){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(((f?Array.prototype.indexOf.call(f,p):-1))===-1){throw"Cannot add filter condition for not filterable property name "+p;}this._addCondition(p,O,v,V);return this;},removeConditions:function(p){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot remove filter conditions for unknown property name "+p;}for(var i=0;i<this._aConditionUI5Filter.length;i++){var u=this._aConditionUI5Filter[i];if(u.sPath==p){this._aConditionUI5Filter.splice(i--,1);}}return this;},addSetCondition:function(p,v){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add filter condition for unknown property name "+p;}var f=this._oEntityType.getFilterablePropertyNames();if(((f?Array.prototype.indexOf.call(f,p):-1))===-1){throw"Cannot add filter condition for not filterable property name "+p;}for(var i=-1,V;(V=v[++i])!==undefined;){this._addCondition(p,c.EQ,V);}return this;},addUI5FilterConditions:function(u){if(!Array.isArray(u)){throw"Argument is not an array";}if(u.length==0){return this;}var h=false;for(var i=0;i<u.length;i++){if(u[i].aFilters!=undefined){h=true;break;}}if(h){this._addUI5FilterArray(u);}else{for(var j=0;j<u.length;j++){this.addCondition(u[j].sPath,u[j].sOperator,u[j].oValue1,u[j].oValue2);}}return this;},getExpressionAsUI5FilterArray:function(){var f=this._aConditionUI5Filter.concat([]);for(var i=-1,a;(a=this._aUI5FilterArray[++i])!==undefined;){for(var j=-1,b;(b=a[++j])!==undefined;){f.push(b);}}return f;},getPropertiesReferencedByUI5FilterArray:function(u,r){for(var i=-1,U;(U=u[++i])!==undefined;){if(U.aFilters!=undefined){this.getPropertiesReferencedByUI5FilterArray(U.aFilters,r);}else{if(r[U.sPath]==undefined){r[U.sPath]=[];}r[U.sPath].push(U);}}},getReferencedProperties:function(){var r={};for(var i=-1,u;(u=this._aConditionUI5Filter[++i])!==undefined;){if(r[u.sPath]==undefined){r[u.sPath]=[];}r[u.sPath].push(u);}for(var j=-1,U;(U=this._aUI5FilterArray[++j])!==undefined;){this.getPropertiesReferencedByUI5FilterArray(U,r);}return r;},renderUI5Filter:function(u){var f=null,p=this._oEntityType.findPropertyByName(u.sPath);if(p==null){throw"Cannot add filter condition for unknown property name "+u.sPath;}switch(u.sOperator){case c.BT:f="("+u.sPath+" ge "+this._renderPropertyFilterValue(u.oValue1,p.type)+" and "+u.sPath+" le "+this._renderPropertyFilterValue(u.oValue2,p.type)+")";break;case c.NB:f="("+u.sPath+" lt "+this._renderPropertyFilterValue(u.oValue1,p.type)+" or "+u.sPath+" gt "+this._renderPropertyFilterValue(u.oValue2,p.type)+")";break;case c.Contains:case c.NotContains:f=(u.sOperator[0]==="N"?"not ":"")+"substringof("+this._renderPropertyFilterValue(u.oValue1,"Edm.String")+","+u.sPath+")";break;case c.StartsWith:case c.EndsWith:case c.NotStartsWith:case c.NotEndsWith:f=u.sOperator.toLowerCase().replace("not","not ")+"("+u.sPath+","+this._renderPropertyFilterValue(u.oValue1,"Edm.String")+")";break;default:f=u.sPath+" "+u.sOperator.toLowerCase()+" "+this._renderPropertyFilterValue(u.oValue1,p.type);}return f;},renderUI5MultiFilter:function(u){var U=[];var O="";var l=u.bAnd==true?" and ":" or ";for(var i=-1,a;(a=u.aFilters[++i])!==undefined;){if(a.aFilters!=undefined){U.push(a);continue;}O+=(O==""?"":l)+"("+this.renderUI5Filter(a)+")";}if(U.length>0){for(var j=-1,m;(m=U[++j])!==undefined;){O+=(O==""?"":l)+"("+this.renderUI5MultiFilter(m)+")";}}return O;},renderUI5FilterArray:function(u){if(u.length==0){return"";}var O="";u.sort(function(a,b){if(a.sPath==b.sPath){return 0;}if(a.sPath>b.sPath){return 1;}else{return-1;}});var p=u[0].sPath;var s="";var n=[],U=[];for(var i=-1,f;(f=u[++i])!==undefined;){if(f.aFilters!=undefined){U.push(f);continue;}if(p!=f.sPath){if(s!=""){O+=(O==""?"":" and ")+"("+s+")";}s="";if(n.length>0){for(var j=-1,N;(N=n[++j])!==undefined;){s+=(s==""?"":" and ")+this.renderUI5Filter(N);}O+=(O==""?"":" and ")+"("+s+")";s="";}p=f.sPath;n=[];}if(f.sOperator==c.NE){n.push(f);continue;}s+=(s==""?"":" or ")+this.renderUI5Filter(f);}if(s!=""){O+=(O==""?"":" and ")+"("+s+")";}if(n.length>0){s="";for(var k=-1,g;(g=n[++k])!==undefined;){s+=(s==""?"":" and ")+this.renderUI5Filter(g);}O+=(O==""?"":" and ")+"("+s+")";}if(U.length>0){for(var l=-1,m;(m=U[++l])!==undefined;){O+=(O==""?"":" and ")+"("+this.renderUI5MultiFilter(m)+")";}}return O;},getURIFilterOptionValue:function(){var O=this.renderUI5FilterArray(this._aConditionUI5Filter);for(var i=-1,u;(u=this._aUI5FilterArray[++i])!==undefined;){O+=(O==""?"":" and ")+"("+this.renderUI5FilterArray(u)+")";}return O;},checkValidity:function(){var r=this._oEntityType.getRequiredFilterPropertyNames();var p=this.getReferencedProperties();for(var i=-1,P;(P=r[++i])!==undefined;){if(p[P]==undefined){throw"filter expression does not contain required property "+P;}}var a=this._oEntityType.getPropertiesWithFilterRestrictions();for(var s in a){var f=a[s];if(f==o.EntityType.propertyFilterRestriction.SINGLE_VALUE){if(p[s]!=undefined){if(p[s].length>1){var t=p[s][0].oValue1;for(var j=0;j<p[s].length;j++){if(p[s][j].oValue1!=t||p[s][j].sOperator!=c.EQ){throw"filter expression may use "+s+" only with a single EQ condition";}}}}}}return true;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aFilterCondition:null};o.SortOrder={Ascending:"asc",Descending:"desc"};o.SortExpression=function(m,s,E){this._init(m,s,E);};o.SortExpression.prototype={_init:function(m,s,E){this._oEntityType=E;this._oSchema=s;this._oModel=m;this._aSortCondition=[];},_containsSorter:function(p){var r=null;for(var i=-1,C;(C=this._aSortCondition[++i])!==undefined;){if(C.property.name===p){r={sorter:C,index:i};break;}}return r;},_removeFromArray:function(a,f,t){var r=a.slice((t||f)+1||a.length);a.length=f<0?a.length+f:f;return a.push.apply(a,r);},clear:function(){this._aSortCondition=[];},addSorter:function(p,s){var P=this._oEntityType.findPropertyByName(p);if(P==null){throw"Cannot add sort condition for unknown property name "+p;}var E=this._containsSorter(p);if(E!=null){E.sorter.order=s;return this;}var a=this._oEntityType.getSortablePropertyNames();if(((a?Array.prototype.indexOf.call(a,p):-1))===-1){throw"Cannot add sort condition for not sortable property name "+p;}this._aSortCondition.push({property:P,order:s});return this;},removeSorter:function(p){if(!p){return;}var s=this._containsSorter(p);if(s){this._removeFromArray(this._aSortCondition,s.index);}},getExpressionsAsUI5SorterArray:function(){var s=[];for(var i=-1,C;(C=this._aSortCondition[++i])!==undefined;){s.push(new S(C.property.name,C.order==o.SortOrder.Descending));}return s;},getExpressionAsUI5Sorter:function(){var s=this.getExpressionsAsUI5SorterArray();if(s.length==0){return null;}else{return s[0];}},getURIOrderByOptionValue:function(s){if(this._aSortCondition.length==0){return"";}var O="";for(var i=-1,C;(C=this._aSortCondition[++i])!==undefined;){if(!s[C.property.name]){continue;}O+=(O==""?"":",")+C.property.name+" "+C.order;}return O;},getEntityType:function(){return this._oEntityType;},getSchema:function(){return this._oSchema;},getModel:function(){return this._oModel;},_oEntityType:null,_oSchema:null,_oModel:null,_aSortCondition:null};o.ParameterizationRequest=function(p){this._init(p);};o.ParameterizationRequest.prototype={_init:function(p){if(!p){throw"No parameterization given";}this._oParameterization=p;this._oParameterValueAssignment=[];},_renderParameterKeyValue:function(k,p){return e(this._oParameterization.getTargetQueryResult().getModel().getODataModel().formatValue(k,p));},getParameterization:function(){return this._oParameterization;},setParameterValue:function(p,v,t){var P=this._oParameterization.findParameterByName(p);if(!P){throw"Invalid parameter name "+p;}if(t!=null){if(!P.isIntervalBoundary()){throw"Range value cannot be applied to parameter "+p+" accepting only single values";}if(!P.isLowerIntervalBoundary()){throw"Range value given, but parameter "+p+" does not hold the lower boundary";}}if(!P.isIntervalBoundary()){if(v==null){delete this._oParameterValueAssignment[p];}else{this._oParameterValueAssignment[p]=v;}}else{if(v==null&&t!=null){throw"Parameter "+p+": An upper boundary cannot be given without the lower boundary";}if(v==null){delete this._oParameterValueAssignment[p];t=null;}else{this._oParameterValueAssignment[p]=v;}var u=P.getPeerIntervalBoundaryParameter();if(t==null){t=v;}if(v==null){delete this._oParameterValueAssignment[u.getName()];}else{this._oParameterValueAssignment[u.getName()]=t;}}return;},getURIToParameterizationEntitySet:function(s){return(s?s:"")+"/"+this._oParameterization.getEntitySet().getQName();},getURIToParameterizationEntry:function(s){var D=this._oParameterization.getAllParameters();for(var a in D){if(this._oParameterValueAssignment[a]==undefined){throw"Parameter "+a+" has no value assigned";}}var k="",f=true;for(var p in this._oParameterValueAssignment){k+=(f?"":",")+p+"="+this._renderParameterKeyValue(this._oParameterValueAssignment[p],D[p].getProperty().type);f=false;}return(s?s:"")+"/"+this._oParameterization.getEntitySet().getQName()+"("+k+")";},_oParameterization:null,_oParameterValueAssignment:null};o.QueryResultRequest=function(q,p){this._init(q,p);};o.QueryResultRequest.prototype={_init:function(q,p){this._oQueryResult=q;this._oParameterizationRequest=p;this._oAggregationLevel={};this._oDimensionHierarchies={};this._oMeasures={};this._bIncludeEntityKey=false;this._oFilterExpression=null;this._oSortExpression=null;this._oSelectedPropertyNames=null;},addRecursiveHierarchy:function(h,i,I){var D;if(!h){return;}D=this._oQueryResult.findDimensionByName(h);if(!D){throw new Error("'"+h+"' is not a dimension property");}if(!D.getHierarchy()){throw new Error("Dimension '"+h+"' does not have a hierarchy");}this._oSelectedPropertyNames=null;this._oDimensionHierarchies[h]={externalKey:i,id:true,text:I};},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},setResourcePath:function(r){this._sResourcePath=r;if(this._sResourcePath.indexOf("/")!=0){throw"Missing leading / (slash) for resource path";}if(this._oQueryResult.getParameterization()){var l=r.lastIndexOf("/");if(l==-1){throw"Missing navigation from parameter entity set to query result in resource path";}var n=r.substring(l+1);if(n!=this._oQueryResult.getParameterization().getNavigationPropertyToQueryResult()){throw"Invalid navigation property from parameter entity set to query result in resource path";}}},getParameterizationRequest:function(){return this._oParameterizationRequest;},getQueryResult:function(){return this._oQueryResult;},setAggregationLevel:function(D){this._oAggregationLevel={};if(!D){D=this._oQueryResult.getAllDimensionNames();}this.addToAggregationLevel(D);this._oSelectedPropertyNames=null;},addToAggregationLevel:function(D){if(!D){return;}this._oSelectedPropertyNames=null;for(var i=-1,s;(s=D[++i])!==undefined;){if(!this._oQueryResult.findDimensionByName(s)){throw s+" is not a valid dimension name";}this._oAggregationLevel[s]={key:true,text:false,attributes:null};}},removeFromAggregationLevel:function(D){if(!D){return;}this._oSelectedPropertyNames=null;for(var i=-1,s;(s=D[++i])!==undefined;){if(!this._oQueryResult.findDimensionByName(s)){throw s+" is not a valid dimension name";}if(this._oAggregationLevel[s]!=undefined){delete this._oAggregationLevel[s];this.getSortExpression().removeSorter(s);}}},getAggregationLevel:function(){var D=[];for(var s in this._oAggregationLevel){D.push(s);}return D;},getAggregationLevelDetails:function(D){if(this._oAggregationLevel[D]==undefined){throw"Aggregation level does not include dimension "+D;}return this._oAggregationLevel[D];},setMeasures:function(m){if(!m){m=this._oQueryResult.getAllMeasureNames();}this._oSelectedPropertyNames=null;this._oMeasures={};for(var i=-1,M;(M=m[++i])!==undefined;){if(!this._oQueryResult.findMeasureByName(M)){throw M+" is not a valid measure name";}this._oMeasures[M]={value:true,text:false,unit:false};}},getMeasureNames:function(){var m=[];for(var M in this._oMeasures){m.push(M);}return m;},includeDimensionKeyTextAttributes:function(D,I,b,a){this._oSelectedPropertyNames=null;var f=[];if(D){if(this._oAggregationLevel[D]==undefined){throw D+" is not included in the aggregation level";}f.push(D);}else{for(var n in this._oAggregationLevel){f.push(n);}a=null;}for(var i=-1,s;(s=f[++i])!==undefined;){if(I!=null){this._oAggregationLevel[s].key=I;}if(b!=null){this._oAggregationLevel[s].text=b;}if(a!=null){this._oAggregationLevel[s].attributes=a;}}},includeMeasureRawFormattedValueUnit:function(m,I,b,a){this._oSelectedPropertyNames=null;var M=[];if(m){if(this._oMeasures[m]==undefined){throw m+" is not part of the query result";}M.push(m);}else{for(var n in this._oMeasures){M.push(n);}}for(var i=-1,s;(s=M[++i])!==undefined;){if(I!=null){this._oMeasures[s].value=I;}if(b!=null){this._oMeasures[s].text=b;}if(a!=null){this._oMeasures[s].unit=a;}}},getFilterExpression:function(){if(this._oFilterExpression==null){var E=this._oQueryResult.getEntityType();this._oFilterExpression=new o.FilterExpression(this._oQueryResult.getModel(),E.getSchema(),E);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var E=this._oQueryResult.getEntityType();this._oSortExpression=new o.SortExpression(E.getModel(),E.getSchema(),E);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},setRequestOptions:function(i,I,r){if(i!=null){this._bIncludeEntityKey=i;}if(I!=null){this._bIncludeCount=I;}if(r!=null){this._bReturnNoEntities=r;}},setResultPageBoundaries:function(s,a){if(s!=null&&typeof s!=="number"){throw"Start value must be null or numeric";}if(a!==null&&typeof a!=="number"){throw"End value must be null or numeric";}if(s==null){s=1;}if(s<1||s>(a==null?s:a)){throw"Invalid values for requested page boundaries";}this._iSkipRequestOption=(s>1)?s-1:null;this._iTopRequestOption=(a!=null)?(a-s+1):null;},getResultPageBoundaries:function(){var E=null;if(this._iTopRequestOption!=null){if(this._iSkipRequestOption==null){E=1;}else{E=this._iSkipRequestOption+this._iTopRequestOption;}}return{start:(this._iSkipRequestOption==null)?1:this._iSkipRequestOption,end:E};},getURIToQueryResultEntitySet:function(s){var u=null;if(this._sResourcePath!=null){u=(s?s:"")+this._sResourcePath;}else if(this._oQueryResult.getParameterization()){if(!this._oParameterizationRequest){throw"Missing parameterization request";}else{u=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oQueryResult.getParameterization().getNavigationPropertyToQueryResult();}}else{u=(s?s:"")+"/"+this._oQueryResult.getEntitySet().getQName();}return u;},getURIOrderByOptionValue:function(){var a,C,O=null,s=this._oSortExpression?this._oSortExpression._aSortCondition:[],i,n=s.length;if(n){a=this._oQueryResult.getAllMeasureNames();for(i=0;i<n;i+=1){C=s[i];if(!this._oSelectedPropertyNames[C.property.name]&&a.indexOf(C.property.name)<0){continue;}O=(O?O+",":"")+C.property.name+" "+C.order;}}return O;},getURIQueryOptionValue:function(q){var n,Q=null,s,t=this;function a(p){var P;if(!p){return;}P=typeof p==="string"?p:p.name;if(!t._oSelectedPropertyNames[P]){s+=(s==""?"":",")+P;t._oSelectedPropertyNames[P]=true;}}switch(q){case"$select":{s="";this._oSelectedPropertyNames={};for(n in this._oAggregationLevel){var D=this._oQueryResult.findDimensionByName(n);var b=this._oAggregationLevel[n];if(b.key==true){a(D.getKeyProperty());}if(b.text==true){a(D.getTextProperty());}if(b.attributes){for(var i=-1,f;(f=b.attributes[++i])!==undefined;){a(D.findAttributeByName(f).getName());}}}for(n in this._oMeasures){var m=this._oQueryResult.findMeasureByName(n);var M=this._oMeasures[n];if(M.value==true){a(m.getRawValueProperty());}if(M.text==true){a(m.getFormattedValueProperty());}if(M.unit==true){a(m.getUnitProperty());}}for(n in this._oDimensionHierarchies){var h=this._oQueryResult.findDimensionByName(n).getHierarchy();var H=this._oDimensionHierarchies[n];if(H.id){a(h.getNodeIDProperty());}if(H.externalKey){a(h.getNodeExternalKeyProperty());}if(H.text){a(this._oQueryResult.getEntityType().getTextPropertyOfProperty(h.getNodeIDProperty().name));}}if(this._bIncludeEntityKey){var k=this._oQueryResult.getEntityType().getTypeDescription().key.propertyRef;for(var j=-1,K;(K=k[++j])!==undefined;){s+=(s==""?"":",")+K.name;}}Q=(s?s:null);break;}case"$filter":{var g=null;if(this._oFilterExpression){g=this._oFilterExpression.getURIFilterOptionValue();}Q=(g?g:null);break;}case"$orderby":{Q=this.getURIOrderByOptionValue();break;}case"$top":{Q=null;if(this._bReturnNoEntities){Q=0;}else if(this._iTopRequestOption!==null){Q=this._iTopRequestOption;}break;}case"$skip":{Q=null;if(!this._bReturnNoEntities){Q=this._iSkipRequestOption;}break;}case"$inlinecount":{Q=(this._bIncludeCount==true?"allpages":null);break;}default:break;}return Q;},getURIToQueryResultEntries:function(s,r){if(!r){r=this.getURIToQueryResultEntitySet(s);}this.getFilterExpression().checkValidity();var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var t=this.getURIQueryOptionValue("$top");var g=this.getURIQueryOptionValue("$skip");var i=this.getURIQueryOptionValue("$inlinecount");var u=r;var q=false;if(a!==null){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}if((this._iTopRequestOption||this._bReturnNoEntities)&&t!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$top="+t;}if(this._iSkipRequestOption&&g!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$skip="+g;}if(this._bIncludeCount&&i!==null){if(!q){u+="?";q=true;}else{u+="&";}u+="$inlinecount="+i;}return u;},_oQueryResult:null,_oParameterizationRequest:null,_sResourcePath:null,_oAggregationLevel:null,_oDimensionHierarchies:null,_oMeasures:null,_bIncludeEntityKey:null,_bIncludeCount:null,_bReturnNoEntities:null,_oFilterExpression:null,_oSortExpression:null,_iSkipRequestOption:null,_iTopRequestOption:null};o.ParameterValueSetRequest=function(p){this._init(p);};o.ParameterValueSetRequest.prototype={_init:function(p){this._oParameter=p;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;},includeParameterText:function(i){if(i!=null){this._oValueSetResult.text=i;}},getFilterExpression:function(){if(this._oFilterExpression==null){var E=this._oParameter.getContainingParameterization().getEntityType();var m=this._oParameter.getContainingParameterization().getTargetQueryResult().getModel();this._oFilterExpression=new o.FilterExpression(m,E.getSchema(),E);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){var E=this._oParameter.getContainingParameterization().getEntityType();this._oSortExpression=new o.SortExpression(E.getModel(),E.getSchema(),E);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";s+=(s==""?"":",")+this._oParameter.getProperty().name;if(this._oValueSetResult.text==true&&this._oParameter.getTextProperty()){s+=(s==""?"":",")+this._oParameter.getTextProperty().name;}Q=(s?s:null);break;}case"$filter":{var f=null;if(this._oFilterExpression){f=this._oFilterExpression.getURIFilterOptionValue();}Q=(f?f:null);break;}case"$orderby":{var a=null;if(this._oSortExpression){a=this._oSortExpression.getURIOrderByOptionValue();}Q=(a?a:null);break;}default:break;}return Q;},getURIToParameterValueSetEntries:function(s){var r=null;r=(s?s:"")+"/"+this._oParameter.getContainingParameterization().getEntitySet().getQName();this.getFilterExpression().checkValidity();var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var u=r;var q=false;if(a){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}return u;},_oParameter:null,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null};o.DimensionMemberSetRequest=function(D,p,u){this._init(D,p,u);};o.DimensionMemberSetRequest.prototype={_init:function(D,p,u){this._oDimension=D;this._oParameterizationRequest=p;this._bUseMasterData=u;this._oValueSetResult={};this._oFilterExpression=null;this._oSortExpression=null;if(this._oParameterizationRequest!=null&&this._bUseMasterData==true){throw"LIMITATION: parameterized master data entity sets are not yet implemented";}if(this._bUseMasterData){this._oEntitySet=this._oDimension.getMasterDataEntitySet();}else{this._oEntitySet=this._oDimension.getContainingQueryResult().getEntitySet();if(this._oDimension.getContainingQueryResult().getParameterization()&&!this._oParameterizationRequest){throw"Missing parameterization request";}}},setParameterizationRequest:function(p){this._oParameterizationRequest=p;},includeDimensionTextAttributes:function(i,I){this._oValueSetResult.text={text:false,attributes:false};if(i==true){this._oValueSetResult.text=true;}if(I==true){this._oValueSetResult.attributes=true;}},getFilterExpression:function(){if(this._oFilterExpression==null){var E=this._oEntitySet.getEntityType();var m=this._oDimension.getContainingQueryResult().getModel();this._oFilterExpression=new o.FilterExpression(m,E.getSchema(),E);}return this._oFilterExpression;},setFilterExpression:function(f){this._oFilterExpression=f;},getSortExpression:function(){if(this._oSortExpression==null){this._oSortExpression=new o.SortExpression(this._oEntityType.getModel(),this._oEntityType.getSchema(),this._oEntityType);}return this._oSortExpression;},setSortExpression:function(s){this._oSortExpression=s;},setRequestOptions:function(i){if(i!=null){this._bIncludeCount=i;}},setResultPageBoundaries:function(s,a){if(s!=null&&typeof s!=="number"){throw"Start value must be null or numeric";}if(a!==null&&typeof a!=="number"){throw"End value must be null or numeric";}if(s==null){s=1;}if(s<1||s>(a==null?s:a)){throw"Invalid values for requested page boundaries";}this._iSkipRequestOption=(s>1)?s-1:null;this._iTopRequestOption=(a!=null)?(a-s+1):null;},getResultPageBoundaries:function(){var E=null;if(this._iTopRequestOption!=null){if(this._iSkipRequestOption==null){E=1;}else{E=this._iSkipRequestOption+this._iTopRequestOption;}}return{start:(this._iSkipRequestOption==null)?1:this._iSkipRequestOption,end:E};},getURIQueryOptionValue:function(q){var Q=null;switch(q){case"$select":{var s="";var E=this._oEntitySet.getEntityType();var K=E.getKeyProperties();var a=[];if(this._bUseMasterData){for(var i=-1,b;(b=K[++i])!==undefined;){s+=(s==""?"":",")+b;var f=E.getTextPropertyOfProperty(b);if(f){if(this._oValueSetResult.text==true){s+=","+f.name;}a.push(f.name);}}}else{s+=(s==""?"":",")+this._oDimension.getKeyProperty().name;if(this._oValueSetResult.text==true&&this._oDimension.getTextProperty()){s+=(s==""?"":",")+this._oDimension.getTextProperty().name;}}if(this._oValueSetResult.attributes){if(this._bUseMasterData){var g=E.getProperties();for(var p in g){var I=false;for(var j=-1,h;(h=K[++j])!==undefined;){if(p==h){I=true;break;}}if(I){continue;}for(var k=-1,m;(m=a[++k])!==undefined;){if(p==m){I=true;break;}}if(!I){s+=","+p;}}}else{var n=this._oDimension.getAllAttributeNames();for(var l=-1,r;(r=n[++l])!==undefined;){s+=(s==""?"":",")+this._oDimension.findAttributeByName(r).getName();}}}Q=(s?s:null);break;}case"$filter":{var t=null;if(this._oFilterExpression){t=this._oFilterExpression.getURIFilterOptionValue();}Q=(t?t:null);break;}case"$orderby":{var u=null;if(this._oSortExpression){u=this._oSortExpression.getURIOrderByOptionValue();}Q=(u?u:null);break;}case"$top":{if(this._iTopRequestOption!==null){Q=this._iTopRequestOption;}break;}case"$skip":{Q=this._iSkipRequestOption;break;}case"$inlinecount":{Q=(this._bIncludeCount==true?"allpages":null);break;}default:break;}return Q;},getURIToDimensionMemberEntitySet:function(s){var r=null;if(!this._bUseMasterData&&this._oParameterizationRequest){r=this._oParameterizationRequest.getURIToParameterizationEntry(s)+"/"+this._oDimension.getContainingQueryResult().getParameterization().getNavigationPropertyToQueryResult();}else{r=(s?s:"")+"/"+this._oEntitySet.getQName();}return r;},getURIToDimensionMemberEntries:function(s){var r=this.getURIToDimensionMemberEntitySet(s);this.getFilterExpression().checkValidity();var a=this.getURIQueryOptionValue("$select");var f=this.getURIQueryOptionValue("$filter");var b=this.getURIQueryOptionValue("$orderby");var t=this.getURIQueryOptionValue("$top");var g=this.getURIQueryOptionValue("$skip");var i=this.getURIQueryOptionValue("$inlinecount");var u=r;var q=false;if(a){u+="?$select="+a;q=true;}if(this._oFilterExpression&&f){if(!q){u+="?";q=true;}else{u+="&";}u+="$filter="+f;}if(this._oSortExpression&&b){if(!q){u+="?";q=true;}else{u+="&";}u+="$orderby="+b;}if(this._iTopRequestOption&&t){if(!q){u+="?";q=true;}else{u+="&";}u+="$top="+t;}if(this._iSkipRequestOption&&g){if(!q){u+="?";q=true;}else{u+="&";}u+="$skip="+g;}if(this._bIncludeCount&&i){if(!q){u+="?";q=true;}else{u+="&";}u+="$inlinecount="+i;}return u;},_oDimension:null,_oParameterizationRequest:null,_oEntitySet:null,_bUseMasterData:false,_oFilterExpression:null,_oSortExpression:null,_oValueSetResult:null,_bIncludeCount:null,_iSkipRequestOption:0,_iTopRequestOption:null};return o;},true);
sap.ui.predefine('sap/ui/model/odata/ODataContextBinding',['sap/ui/model/ContextBinding','sap/ui/model/ChangeReason'],function(C,a){"use strict";var O=C.extend("sap.ui.model.odata.ODataContextBinding",{constructor:function(m,p,c,P,e){C.call(this,m,p,c,P,e);}});O.prototype.initialize=function(){var t=this,r=this.oModel.resolve(this.sPath,this.oContext),d=this.oModel._getObject(this.sPath,this.oContext),R=this.oModel._isReloadNeeded(r,d,this.mParameters);if(this.oModel.oMetadata.isLoaded()){if(r&&R){this.fireDataRequested();}this.oModel.createBindingContext(this.sPath,this.oContext,this.mParameters,function(c){t.oElementContext=c;t._fireChange({reason:a.Context});if(r&&R){t.fireDataReceived();}},R);}};O.prototype.refresh=function(f,c){var t=this,k,s,b=false,r=this.oModel.resolve(this.sPath,this.oContext);if(c){s=this.oModel._getObject(this.sPath,this.oContext);if(s){k=this.oModel._getKey(s);if(k in c){b=true;}}}else{b=true;}if(f||b){if(r){this.fireDataRequested();}this.oModel.createBindingContext(this.sPath,this.oContext,this.mParameters,function(o){if(t.oElementContext===o){if(f){t._fireChange({reason:a.Context});}}else{t.oElementContext=o;t._fireChange({reason:a.Context});}if(r){t.fireDataReceived();}},true);}};O.prototype.setContext=function(c){var t=this,r,d,R;if(this.oContext!==c&&this.isRelative()){this.oContext=c;r=this.oModel.resolve(this.sPath,this.oContext);d=this.oModel._getObject(this.sPath,this.oContext);R=this.oModel._isReloadNeeded(r,d,this.mParameters);if(r&&R){this.fireDataRequested();}this.oModel.createBindingContext(this.sPath,this.oContext,this.mParameters,function(c){t.oElementContext=c;t._fireChange({reason:a.Context});if(r&&R){t.fireDataReceived();}},R);}};return O;});
sap.ui.predefine('sap/ui/model/odata/ODataListBinding',['sap/ui/model/ChangeReason','sap/ui/model/Filter','sap/ui/model/odata/Filter','sap/ui/model/FilterType','sap/ui/model/FilterProcessor','sap/ui/model/ListBinding','sap/ui/model/Sorter','./ODataUtils','./CountMode','sap/base/util/deepEqual','sap/base/util/merge','sap/base/Log','sap/base/assert','sap/ui/thirdparty/jquery'],function(C,F,O,a,b,L,S,c,d,e,m,f,g,q){"use strict";var h=L.extend("sap.ui.model.odata.ODataListBinding",{constructor:function(M,p,o,s,i,P){L.apply(this,arguments);this.sFilterParams=null;this.sSortParams=null;this.sRangeParams=null;this.sCustomParams=this.oModel.createCustomParams(this.mParameters);this.iStartIndex=0;this.bPendingChange=false;this.aKeys=[];this.bInitial=true;this.sCountMode=(P&&P.countMode)||this.oModel.sDefaultCountMode;this.bRefresh=false;this.bNeedsUpdate=false;this.bDataAvailable=false;this.bIgnoreSuspend=false;this.oCombinedFilter=null;this.oModel.checkFilterOperation(this.aApplicationFilters);if(!this.oModel.getServiceMetadata()){var t=this,j=function(E){t.bInitial=false;t._initSortersFilters();t.oModel.detachMetadataLoaded(j);};this.oModel.attachMetadataLoaded(this,j);}else{this.bInitial=false;this._initSortersFilters();}var r=this.oModel._getObject(this.sPath,this.oContext);this.aExpandRefs=r;if(Array.isArray(r)&&!s&&!i){this.aKeys=r;this.iLength=r.length;this.bLengthFinal=true;this.bDataAvailable=true;}else if(r===null&&this.oModel.resolve(this.sPath,this.oContext)){this.aKeys=[];this.iLength=0;this.bLengthFinal=true;this.bDataAvailable=true;}else{if(this.oModel.getServiceMetadata()){this.resetData();}}}});h.prototype.getContexts=function(s,l,t){if(this.bInitial){return[];}this.iLastLength=l;this.iLastStartIndex=s;this.iLastThreshold=t;if(!s){s=0;}if(!l){l=this.oModel.iSizeLimit;if(this.bLengthFinal&&this.iLength<l){l=this.iLength;}}if(!t){t=0;}var j=true,k=this._getContexts(s,l),o={},n;n=this.calculateSection(s,l,t,k);j=k.length!=l&&!(this.bLengthFinal&&k.length>=this.iLength-s);if(this.oModel.getServiceMetadata()){if(!this.bPendingRequest&&n.length>0&&(j||l<n.length)){this.loadData(n.startIndex,n.length);k.dataRequested=true;}}if(this.bRefresh){if(this.bLengthFinal&&this.iLength==0){this.loadData(n.startIndex,n.length,true);k.dataRequested=true;}this.bRefresh=false;}else{for(var i=0;i<k.length;i++){o[k[i].getPath()]=k[i].getObject();}if(this.bUseExtendedChangeDetection){if(this.aLastContexts&&s<this.iLastEndIndex){var p=this;var D=q.sap.arrayDiff(this.aLastContexts,k,function(r,N){return e(r&&p.oLastContextData&&p.oLastContextData[r.getPath()],N&&o&&o[N.getPath()]);},true);k.diff=D;}}this.iLastEndIndex=s+l;this.aLastContexts=k.slice(0);this.oLastContextData=m({},o);}return k;};h.prototype.getCurrentContexts=function(){return this.aLastContexts||[];};h.prototype._getContexts=function(s,l){var j=[],o,k;if(!s){s=0;}if(!l){l=this.oModel.iSizeLimit;if(this.bLengthFinal&&this.iLength<l){l=this.iLength;}}for(var i=s;i<s+l;i++){k=this.aKeys[i];if(!k){break;}o=this.oModel.getContext('/'+k);j.push(o);}return j;};h.prototype.calculateSection=function(s,l,t,k){var n,o,p,P,r,u={},K;o=s;n=0;for(var i=s;i>=Math.max(s-t,0);i--){K=this.aKeys[i];if(!K){P=i+1;break;}}for(var j=s+l;j<s+l+t;j++){K=this.aKeys[j];if(!K){p=j;break;}}r=s-P;if(P&&s>t&&r<t){if(k.length!=l){o=s-t;}else{o=P-t;}n=t;}o=Math.max(o,0);if(o==s){o+=k.length;}if(k.length!=l){n+=l-k.length;}r=p-s-l;if(r==0){n+=t;}if(p&&r<t&&r>0){if(o>s){o=p;n+=t;}}if(this.bLengthFinal&&this.iLength<(n+o)){n=this.iLength-o;}u.startIndex=o;u.length=n;return u;};h.prototype.setContext=function(o){if(this.oContext!=o){this.oContext=o;if(this.isRelative()){this._initSortersFilters();if(!this.bInitial){var r=this.oModel._getObject(this.sPath,this.oContext);this.aExpandRefs=r;if(Array.isArray(r)&&!this.aSorters.length>0&&!this.aFilters.length>0){this.aKeys=r;this.iLength=r.length;this.bLengthFinal=true;this._fireChange({reason:C.Context});}else if(!this.oModel.resolve(this.sPath,this.oContext)||r===null){this.aKeys=[];this.iLength=0;this.bLengthFinal=true;this._fireChange({reason:C.Context});}else{this.refresh();}}}}};h.prototype.getDownloadUrl=function(s){var p=[],P;if(s){p.push("$format="+encodeURIComponent(s));}if(this.sSortParams){p.push(this.sSortParams);}if(this.sFilterParams){p.push(this.sFilterParams);}if(this.sCustomParams){p.push(this.sCustomParams);}P=this.oModel.resolve(this.sPath,this.oContext);if(P){return this.oModel._createRequestUrl(P,null,p);}};h.prototype.loadData=function(s,l,p){var t=this,I=false;if(s||l){this.sRangeParams="$skip="+s+"&$top="+l;this.iStartIndex=s;}else{s=this.iStartIndex;}var P=[];if(this.sRangeParams){P.push(this.sRangeParams);}if(this.sSortParams){P.push(this.sSortParams);}if(this.sFilterParams){P.push(this.sFilterParams);}if(this.sCustomParams){P.push(this.sCustomParams);}if(!this.bLengthFinal&&(this.sCountMode==d.Inline||this.sCountMode==d.Both)){P.push("$inlinecount=allpages");I=true;}function j(D){q.each(D.results,function(i,r){t.aKeys[s+i]=t.oModel._getKey(r);});if(I&&D.__count){t.iLength=parseInt(D.__count);t.bLengthFinal=true;}if(t.iLength<s+D.results.length){t.iLength=s+D.results.length;t.bLengthFinal=false;}if(D.results.length<l||l===undefined){t.iLength=s+D.results.length;t.bLengthFinal=true;}if(s==0&&D.results.length==0){t.iLength=0;t.bLengthFinal=true;}t.oRequestHandle=null;t.bPendingRequest=false;t.bNeedsUpdate=true;t.bIgnoreSuspend=true;}function k(D){t.fireDataReceived({data:D});}function E(i,A){t.oRequestHandle=null;t.bPendingRequest=false;if(!A){t.aKeys=[];t.iLength=0;t.bLengthFinal=true;t.bDataAvailable=true;t._fireChange({reason:C.Change});}t.fireDataReceived();}function u(H){t.oRequestHandle=H;}var n=this.sPath,o=this.oContext;if(this.isRelative()){n=this.oModel.resolve(n,o);}if(n){if(p){var U=this.oModel._createRequestUrl(n,null,P);this.fireDataRequested();this.oModel.fireRequestSent({url:U,method:"GET",async:true});setTimeout(function(){t.bNeedsUpdate=true;t.checkUpdate();t.oModel.fireRequestCompleted({url:U,method:"GET",async:true,success:true});t.fireDataReceived({data:{}});},0);}else{this.bPendingRequest=true;this.fireDataRequested();this.oModel._loadData(n,P,j,E,false,u,k);}}};h.prototype.getLength=function(){if(this.bLengthFinal||this.iLength==0){return this.iLength;}else{var A=this.iLastThreshold||this.iLastLength||10;return this.iLength+A;}};h.prototype.isLengthFinal=function(){return this.bLengthFinal;};h.prototype._getLength=function(){var t=this;var p=[];if(this.sFilterParams){p.push(this.sFilterParams);}if(this.mParameters&&this.mParameters.custom){var o={custom:{}};q.each(this.mParameters.custom,function(s,v){o.custom[s]=v;});p.push(this.oModel.createCustomParams(o));}function _(D){t.iLength=parseInt(D);t.bLengthFinal=true;}function i(E){var s="Request for $count failed: "+E.message;if(E.response){s+=", "+E.response.statusCode+", "+E.response.statusText+", "+E.response.body;}f.warning(s);}var P=this.oModel.resolve(this.sPath,this.oContext);if(P){var u=this.oModel._createRequestUrl(P+"/$count",null,p);var r=this.oModel._createRequest(u,"GET",false);r.headers["Accept"]="text/plain, */*;q=0.5";this.oModel._request(r,_,i,undefined,undefined,this.oModel.getServiceMetadata());}};h.prototype.refresh=function(j,k,E){var l=false;if(!j){if(E){var r=this.oModel.resolve(this.sPath,this.oContext);var o=this.oModel.oMetadata._getEntityTypeByPath(r);if(o&&(o.entityType in E)){l=true;}}if(k&&!l){q.each(this.aKeys,function(i,K){if(K in k){l=true;return false;}});}if(!k&&!E){l=true;}}if(j||l){this.abortPendingRequest();this.resetData();this._fireRefresh({reason:C.Refresh});}};h.prototype._fireRefresh=function(A){if(this.oModel.resolve(this.sPath,this.oContext)){this.bRefresh=true;this.fireEvent("refresh",A);}};h.prototype.initialize=function(){if(this.oModel.oMetadata.isLoaded()){if(this.bDataAvailable){this._fireChange({reason:C.Change});}else{this._fireRefresh({reason:C.Refresh});}}};h.prototype.checkUpdate=function(j,k){var l=this.sChangeReason?this.sChangeReason:C.Change,n=false,o,p,t=this,r,R;if(this.bSuspended&&!this.bIgnoreSuspend){return;}if(!j&&!this.bNeedsUpdate){r=this.oModel._getObject(this.sPath,this.oContext);R=Array.isArray(r)&&!e(r,this.aExpandRefs);this.aExpandRefs=r;if(R){if(this.aSorters.length>0||this.aFilters.length>0){this.refresh();return;}else{this.aKeys=r;this.iLength=r.length;this.bLengthFinal=true;n=true;}}else if(k){q.each(this.aKeys,function(i,K){if(K in k){n=true;return false;}});}else{n=true;}if(n&&this.aLastContexts){n=false;var s=this._getContexts(this.iLastStartIndex,this.iLastLength,this.iLastThreshold);if(this.aLastContexts.length!=s.length){n=true;}else{q.each(this.aLastContexts,function(i,u){o=t.oLastContextData[u.getPath()];p=s[i].getObject();if(!e(o,p,true)){n=true;return false;}});}}}if(j||n||this.bNeedsUpdate){this.bNeedsUpdate=false;this._fireChange({reason:l});}this.sChangeReason=undefined;this.bIgnoreSuspend=false;};h.prototype.resetData=function(){this.aKeys=[];this.iLength=0;this.bLengthFinal=false;this.sChangeReason=undefined;this.bDataAvailable=false;if(this.oModel.isCountSupported()&&(this.sCountMode==d.Request||this.sCountMode==d.Both)){this._getLength();}};h.prototype.abortPendingRequest=function(){if(this.oRequestHandle){this.oRequestHandle.abort();this.oRequestHandle=null;this.bPendingRequest=false;}};h.prototype.sort=function(s,r){var i=false;if(!s){s=[];}if(s instanceof S){s=[s];}this.aSorters=s;this.createSortParams(s);if(!this.bInitial){this.aKeys=[];this.abortPendingRequest();this.sChangeReason=C.Sort;this._fireRefresh({reason:this.sChangeReason});this._fireSort({sorter:s});i=true;}if(r){return i;}else{return this;}};h.prototype.createSortParams=function(s){this.sSortParams=c.createSortParams(s);};h.prototype.filter=function(i,s,r){var j=false;if(!i){i=[];}if(i instanceof F){i=[i];}this.oModel.checkFilterOperation(i);if(s==a.Application){this.aApplicationFilters=i;}else{this.aFilters=i;}if(!i||!Array.isArray(i)||i.length==0){this.aFilters=[];}if(!this.aApplicationFilters||!Array.isArray(this.aApplicationFilters)||this.aApplicationFilters.length===0){this.aApplicationFilters=[];}this.convertFilters();this.oCombinedFilter=b.combineFilters(this.aFilters,this.aApplicationFilters);this.createFilterParams(this.oCombinedFilter);if(!this.bInitial){this.resetData();this.abortPendingRequest();this.sChangeReason=C.Filter;this._fireRefresh({reason:this.sChangeReason});if(s==a.Application){this._fireFilter({filters:this.aApplicationFilters});}else{this._fireFilter({filters:this.aFilters});}j=true;}if(r){return j;}else{return this;}};h.prototype.convertFilters=function(){this.aFilters=this.aFilters.map(function(o){return o instanceof O?o.convert():o;});this.aApplicationFilters=this.aApplicationFilters.map(function(o){return o instanceof O?o.convert():o;});};h.prototype.createFilterParams=function(o){this.sFilterParams=c.createFilterParams(o,this.oModel.oMetadata,this.oEntityType);};h.prototype._initSortersFilters=function(){var r=this.oModel.resolve(this.sPath,this.oContext);if(!r){return;}this.oEntityType=this._getEntityType();this.convertFilters();this.oCombinedFilter=b.combineFilters(this.aFilters,this.aApplicationFilters);this.createSortParams(this.aSorters);this.createFilterParams(this.oCombinedFilter);};h.prototype._getEntityType=function(){var r=this.oModel.resolve(this.sPath,this.oContext);if(r){var E=this.oModel.oMetadata._getEntityTypeByPath(r);g(E,"EntityType for path "+r+" could not be found!");return E;}return undefined;};h.prototype.resume=function(){this.bIgnoreSuspend=false;L.prototype.resume.apply(this,arguments);};return h;});
sap.ui.predefine('sap/ui/model/odata/ODataModel',['sap/ui/model/BindingMode','sap/ui/model/Context','sap/ui/model/Model','./ODataUtils','./CountMode','./ODataContextBinding','./ODataListBinding','./ODataMetadata','./ODataPropertyBinding','./ODataTreeBinding','sap/ui/model/FilterProcessor','sap/ui/model/odata/ODataMetaModel','sap/ui/thirdparty/URI','sap/ui/thirdparty/datajs',"sap/base/util/uid","sap/base/util/merge","sap/base/Log","sap/base/assert","sap/base/security/encodeURL","sap/ui/thirdparty/jquery","sap/base/util/isPlainObject"],function(B,C,M,O,a,b,c,d,e,f,F,g,U,h,u,m,L,n,o,q,p){"use strict";var r=M.extend("sap.ui.model.odata.ODataModel",{constructor:function(s,j,i,P,H,t,w,l){M.apply(this,arguments);var k,R,v,A=null,x,y,D,S,z,E,G=this;if(typeof(s)==="object"){j=s;s=j.serviceUrl;}if(typeof j==="object"){i=j.user;P=j.password;H=j.headers;t=j.tokenHandling;l=j.loadMetadataAsync;w=j.withCredentials;v=j.maxDataServiceVersion;k=j.useBatch;R=j.refreshAfterChange;A=j.annotationURI;x=j.loadAnnotationsJoined;D=j.defaultCountMode;y=j.metadataNamespaces;S=j.serviceUrlParams;z=j.metadataUrlParams;E=j.skipMetadataAnnotationParsing;j=j.json;}this.oServiceData={};this.sDefaultBindingMode=B.OneWay;this.mSupportedBindingModes={"OneWay":true,"OneTime":true,"TwoWay":true};this.mUnsupportedFilterOperators={"Any":true,"All":true};this.bCountSupported=true;this.bJSON=j;this.bCache=true;this.aPendingRequestHandles=[];this.oRequestQueue={};this.aBatchOperations=[];this.oHandler;this.bTokenHandling=t!==false;this.bWithCredentials=w===true;this.bUseBatch=k===true;this.bRefreshAfterChange=R!==false;this.sMaxDataServiceVersion=v;this.bLoadMetadataAsync=!!l;this.bLoadAnnotationsJoined=x===undefined?true:x;this.sAnnotationURI=A;this.sDefaultCountMode=D||a.Both;this.oMetadataLoadEvent=null;this.oMetadataFailedEvent=null;this.bSkipMetadataAnnotationParsing=E;this.oHeaders={};this.setHeaders(H);this.oData={};this.oMetadata=null;this.oAnnotations=null;this.aUrlParams=[];if(s.indexOf("?")==-1){this.sServiceUrl=s;}else{var I=s.split("?");this.sServiceUrl=I[0];if(I[1]){this.aUrlParams.push(I[1]);}}if(sap.ui.getCore().getConfiguration().getStatistics()){this.aUrlParams.push("sap-statistics=true");}this.sServiceUrl=this.sServiceUrl.replace(/\/$/,"");var J=this._createRequestUrl("$metadata",undefined,z);if(!r.mServiceData[J]){r.mServiceData[J]={};}this.oServiceData=r.mServiceData[J];if(this.bTokenHandling&&this.oServiceData.securityToken){this.oHeaders["x-csrf-token"]=this.oServiceData.securityToken;}this.sUser=i;this.sPassword=P;this.oHeaders["Accept-Language"]=sap.ui.getCore().getConfiguration().getLanguageTag();if(!this.oServiceData.oMetadata){this.oServiceData.oMetadata=new d(J,{async:this.bLoadMetadataAsync,user:this.sUser,password:this.sPassword,headers:this.mCustomHeaders,namespaces:y,withCredentials:this.bWithCredentials});}this.oMetadata=this.oServiceData.oMetadata;this.pAnnotationsLoaded=this.oMetadata.loaded();if(this.sAnnotationURI||!this.bSkipMetadataAnnotationParsing){var K=this._getAnnotationParser();if(!this.bSkipMetadataAnnotationParsing){if(!this.bLoadMetadataAsync){this.addAnnotationXML(this.oMetadata.sMetadataBody,!!this.sAnnotationURI);}else{this.pAnnotationsLoaded=this.oMetadata.loaded().then(function(N,Q){if(this.bDestroyed){return Promise.reject();}return this.addAnnotationXML(Q["metadataString"],N);}.bind(this,!!this.sAnnotationURI));}}if(this.sAnnotationURI){if(this.bLoadMetadataAsync){this.pAnnotationsLoaded=this.pAnnotationsLoaded.then(K.addUrl.bind(K,this.sAnnotationURI));}else{this.pAnnotationsLoaded=Promise.all([this.pAnnotationsLoaded,K.addUrl(this.sAnnotationURI)]);}}}if(S){this.aUrlParams=this.aUrlParams.concat(O._createUrlParamsArray(S));}this.onMetadataLoaded=function(N){G._initializeMetadata();G.initialize();};this.onMetadataFailed=function(N){G.fireMetadataFailed(N.getParameters());};if(!this.oMetadata.isLoaded()){this.oMetadata.attachLoaded(this.onMetadataLoaded);this.oMetadata.attachFailed(this.onMetadataFailed);}if(this.oMetadata.isFailed()){this.refreshMetadata();}if(this.oMetadata.isLoaded()){this._initializeMetadata(true);}if(this.bJSON){if(this.sMaxDataServiceVersion==="3.0"){this.oHeaders["Accept"]="application/json;odata=fullmetadata";}else{this.oHeaders["Accept"]="application/json";}this.oHandler=h.jsonHandler;}else{this.oHeaders["Accept"]="application/atom+xml,application/atomsvc+xml,application/xml";this.oHandler=h.atomHandler;}this.oHeaders["MaxDataServiceVersion"]="2.0";if(this.sMaxDataServiceVersion){this.oHeaders["MaxDataServiceVersion"]=this.sMaxDataServiceVersion;}this.oHeaders["DataServiceVersion"]="2.0";},metadata:{publicMethods:["create","remove","update","submitChanges","getServiceMetadata","read","hasPendingChanges","refresh","refreshMetadata","resetChanges","isCountSupported","setCountSupported","setDefaultCountMode","getDefaultCountMode","forceNoCache","setProperty","getSecurityToken","refreshSecurityToken","setHeaders","getHeaders","setUseBatch"]}});r.M_EVENTS={RejectChange:"rejectChange",MetadataLoaded:"metadataLoaded",MetadataFailed:"metadataFailed",AnnotationsLoaded:"annotationsLoaded",AnnotationsFailed:"annotationsFailed"};r.mServiceData={};r.prototype.fireRejectChange=function(A){this.fireEvent("rejectChange",A);return this;};r.prototype.attachRejectChange=function(D,i,l){this.attachEvent("rejectChange",D,i,l);return this;};r.prototype.detachRejectChange=function(i,l){this.detachEvent("rejectChange",i,l);return this;};r.prototype._initializeMetadata=function(D){var t=this;this.bUseBatch=this.bUseBatch||this.oMetadata.getUseBatch();var i=function(j){if(!!j){t.metadataLoadEvent=setTimeout(i.bind(t),0);}else{if(t.oMetadata){t.fireMetadataLoaded({metadata:t.oMetadata});L.debug("ODataModel fired metadataloaded");}}};if(this.sAnnotationURI&&this.bLoadAnnotationsJoined){if(this.oAnnotations&&(this.oAnnotations.bInitialized||this.oAnnotations.isFailed())){i(!this.bLoadMetadataAsync);}else{this.oAnnotations.attachEventOnce("loaded",function(){i(true);});}}else{i(D);}};r.prototype.fireAnnotationsLoaded=function(A){if(!this.bLoadMetadataAsync){setTimeout(this.fireEvent.bind(this,"annotationsLoaded",A),0);}else{this.fireEvent("annotationsLoaded",A);}return this;};r.prototype.attachAnnotationsLoaded=function(D,i,l){this.attachEvent("annotationsLoaded",D,i,l);return this;};r.prototype.detachAnnotationsLoaded=function(i,l){this.detachEvent("annotationsLoaded",i,l);return this;};r.prototype.fireAnnotationsFailed=function(A){if(!this.bLoadMetadataAsync){setTimeout(this.fireEvent.bind(this,"annotationsFailed",A),0);}else{this.fireEvent("annotationsFailed",A);}L.debug("ODataModel fired annotationsfailed");return this;};r.prototype.attachAnnotationsFailed=function(D,i,l){this.attachEvent("annotationsFailed",D,i,l);return this;};r.prototype.detachAnnotationsFailed=function(i,l){this.detachEvent("annotationsFailed",i,l);return this;};r.prototype.fireMetadataLoaded=function(A){this.fireEvent("metadataLoaded",A);return this;};r.prototype.attachMetadataLoaded=function(D,i,l){this.attachEvent("metadataLoaded",D,i,l);return this;};r.prototype.detachMetadataLoaded=function(i,l){this.detachEvent("metadataLoaded",i,l);return this;};r.prototype.fireMetadataFailed=function(A){this.fireEvent("metadataFailed",A);return this;};r.prototype.attachMetadataFailed=function(D,i,l){this.attachEvent("metadataFailed",D,i,l);return this;};r.prototype.detachMetadataFailed=function(i,l){this.detachEvent("metadataFailed",i,l);return this;};r.prototype.refreshMetadata=function(){if(this.oMetadata&&this.oMetadata.refresh){this.oMetadata.refresh();}};r.prototype._createRequestUrl=function(P,i,j,k,l){var s,R,t,v="";if(P&&P.indexOf('?')!=-1){t=P.substr(P.indexOf('?')+1);P=P.substr(0,P.indexOf('?'));}R=this._normalizePath(P,i);if(!k){v=this.sServiceUrl+R;}else{v=R.substr(R.indexOf('/')+1);}s=O._createUrlParamsArray(j);if(this.aUrlParams){s=s.concat(this.aUrlParams);}if(t){s.push(t);}if(s.length>0){v+="?"+s.join("&");}if(l===undefined){l=true;}if(l===false){var w=q.now();var x=v.replace(/([?&])_=[^&]*/,"$1_="+w);v=x+((x===v)?(/\?/.test(v)?"&":"?")+"_="+w:"");}return v;};r.prototype._loadData=function(P,i,s,E,j,H,k){var R,l,t=this;function _(D,z){var A=D,G={};if(z.statusCode==204){if(s){s(null);}if(k){k(null);}t.fireRequestCompleted({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+t.oHeaders["Accept"],infoObject:{acceptHeaders:t.oHeaders["Accept"]},success:true});return;}if(!A){L.fatal("The following problem occurred: No data was retrieved by service: "+z.requestUri);t.fireRequestCompleted({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+t.oHeaders["Accept"],infoObject:{acceptHeaders:t.oHeaders["Accept"]},success:false});return false;}if(t.bUseBatch){var I=t._getBatchErrors(D);if(I.length>0){v(I[0]);return false;}if(A.__batchResponses&&A.__batchResponses.length>0){A=A.__batchResponses[0].data;}else{L.fatal("The following problem occurred: No data was retrieved by service: "+z.requestUri);}}x=x.concat(A.results);if(A.__next){var J=new U(A.__next);l.requestUri=J.absoluteTo(z.requestUri).toString();w(l);}else{if(A.results){var V,K;for(K in x){V=x[K];if(x===V){continue;}A.results[K]=V;}}if(A.results&&!Array.isArray(A.results)){A=A.results;}t._importData(A,G);if(t.sChangeKey&&G){var N=t.sChangeKey.substr(t.sChangeKey.lastIndexOf('/')+1);if(G[N]){delete t.oRequestQueue[t.sChangeKey];t.sChangeKey=null;}}if(s){s(A);}t.checkUpdate(false,false,G);if(k){k(A);}t.fireRequestCompleted({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+t.oHeaders["Accept"],infoObject:{acceptHeaders:t.oHeaders["Accept"]},success:true});}}function v(z){if(t.bTokenHandling&&z.response){var T=t._getHeader("x-csrf-token",z.response.headers);if(!l.bTokenReset&&z.response.statusCode=='403'&&T&&T.toLowerCase()=="required"){t.resetSecurityToken();l.bTokenReset=true;w();return;}}var A=t._handleError(z);if(E){E(z,R&&R.bAborted);}t.fireRequestCompleted({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+t.oHeaders["Accept"],infoObject:{acceptHeaders:t.oHeaders["Accept"]},success:false,errorobject:A});if(!R||!R.bAborted){A.url=l.requestUri;t.fireRequestFailed(A);}}function w(){if(t.bUseBatch){t.updateSecurityToken();var z=U.parse(l.requestUri).query;var A=t._createRequestUrl(P,null,z,t.bUseBatch);l=t._createRequest(A,"GET",true);var D=t._createBatchRequest([l],true);R=t._request(D,_,v,h.batchHandler,undefined,t.getServiceMetadata());}else{R=t._request(l,_,v,t.oHandler,undefined,t.getServiceMetadata());}if(H){var W={abort:function(){R.bAborted=true;R.abort();}};H(W);}}var x=[];var y=this._createRequestUrl(P,null,i,null,j||this.bCache);l=this._createRequest(y,"GET",true);this.fireRequestSent({url:l.requestUri,type:"GET",async:l.async,info:"Accept headers:"+this.oHeaders["Accept"],infoObject:{acceptHeaders:this.oHeaders["Accept"]}});w();};r.prototype._importData=function(D,k){var t=this,l,K,R,E;if(D.results){l=[];q.each(D.results,function(i,j){l.push(t._importData(j,k));});return l;}else{K=this._getKey(D);E=this.oData[K];if(!E){E=D;this.oData[K]=E;}q.each(D,function(N,P){if(P&&(P.__metadata&&P.__metadata.uri||P.results)&&!P.__deferred){R=t._importData(P,k);if(Array.isArray(R)){E[N]={__list:R};}else{E[N]={__ref:R};}}else if(!P||!P.__deferred){E[N]=P;}});k[K]=true;return K;}};r.prototype._removeReferences=function(D){var t=this,l;if(D.results){l=[];q.each(D.results,function(i,j){l.push(t._removeReferences(j));});return l;}else{q.each(D,function(P,i){if(i){if(i["__ref"]||i["__list"]){delete D[P];}}});return D;}};r.prototype._restoreReferences=function(D){var t=this,l,R=[];if(D.results){l=[];q.each(D.results,function(i,j){l.push(t._restoreReferences(j));});return l;}else{q.each(D,function(P,i){if(i&&i["__ref"]){var k=t._getObject("/"+i["__ref"]);n(k,"ODataModel inconsistent: "+i["__ref"]+" not found!");if(k){delete i["__ref"];D[P]=k;t._restoreReferences(k);}}else if(i&&i["__list"]){q.each(i["__list"],function(j,E){var k=t._getObject("/"+i["__list"][j]);n(k,"ODataModel inconsistent: "+i["__list"][j]+" not found!");if(k){R.push(k);t._restoreReferences(k);}});delete i["__list"];i.results=R;R=[];}});return D;}};r.prototype.removeData=function(){this.oData={};};r.prototype.initialize=function(){var i=this.getBindings();q.each(i,function(I,j){j.initialize();});};r.prototype.refresh=function(i,R){if(R){this.removeData();}this._refresh(i);};r.prototype._refresh=function(i,j,E){var k=this.getBindings();q.each(k,function(I,l){l.refresh(i,j,E);});};r.prototype.checkUpdate=function(i,A,j,k){if(A){if(!this.sUpdateTimer){this.sUpdateTimer=setTimeout(function(){this.checkUpdate(i,false,j);}.bind(this),0);}return;}if(this.sUpdateTimer){clearTimeout(this.sUpdateTimer);this.sUpdateTimer=null;}var l=this.getBindings();q.each(l,function(I,s){if(!k||this.isMetaModelPath(s.getPath())){s.checkUpdate(i,j);}}.bind(this));};r.prototype.bindProperty=function(P,i,j){var k=new e(this,P,i,j);return k;};r.prototype.bindList=function(P,i,s,j,k){var l=new c(this,P,i,s,j,k);return l;};r.prototype.bindTree=function(P,i,j,k){var l=new f(this,P,i,j,k);return l;};r.prototype.createBindingContext=function(P,i,j,k,R){var R=!!R,s=this.resolve(P,i);if(typeof i=="function"){k=i;i=null;}if(typeof j=="function"){k=j;j=null;}if(!s){if(k){k(null);}return null;}var D=this._getObject(P,i),K,N,t=this;if(!R){R=this._isReloadNeeded(s,D,j);}if(!R){K=this._getKey(D);N=this.getContext('/'+K);if(k){k(N);}return N;}if(k){var I=!P.startsWith("/");if(s){var l=[],v=this.createCustomParams(j);if(v){l.push(v);}this._loadData(s,l,function(D){K=D?t._getKey(D):undefined;if(K&&i&&I){var w=i.getPath();w=w.substr(1);if(t.oData[w]){t.oData[w][P]={__ref:K};}}N=t.getContext('/'+K);k(N);},function(){k(null);});}else{k(null);}}};r.prototype._isReloadNeeded=function(s,D,P){var N,j=[],S,k=[];if(!s){return false;}if(!D){return true;}if(P&&P["expand"]){N=P["expand"].replace(/\s/g,"");j=N.split(',');}if(j){for(var i=0;i<j.length;i++){var l=j[i].indexOf("/");if(l!==-1){var t=j[i].slice(0,l);var v=j[i].slice(l+1);j[i]=[t,v];}}}for(var i=0;i<j.length;i++){var w=j[i];if(Array.isArray(w)){var x=D[w[0]];var y=w[1];if(!x||(x&&x.__deferred)){return true;}else{if(x){if(x.__list&&x.__list.length>0){for(var z=0;z<x.__list.length;z++){var A="/"+x.__list[z];var E=this.getObject(A);var R=this._isReloadNeeded(A,E,{expand:y});if(R){return true;}}}else if(x.__ref){var A="/"+x.__ref;var E=this.getObject(A);var R=this._isReloadNeeded(A,E,{expand:y});if(R){return true;}}}}}else{if(D[w]===undefined||(D[w]&&D[w].__deferred)){return true;}}}if(P&&P["select"]){S=P["select"].replace(/\s/g,"");k=S.split(',');}for(var i=0;i<k.length;i++){if(D[k[i]]===undefined){return true;}}if(k.length==0){var G=this.oMetadata._getEntityTypeByPath(s);if(!G){return false;}else{for(var i=0;i<G.property.length;i++){if(D[G.property[i].name]===undefined){return true;}}}}return false;};r.prototype.destroyBindingContext=function(i){};r.prototype.createCustomParams=function(P){var i=[],j,s={expand:true,select:true};for(var N in P){if(N in s){i.push("$"+N+"="+o(P[N]));}if(N=="custom"){j=P[N];for(var N in j){if(N.indexOf("$")==0){L.warning("Trying to set OData parameter "+N+" as custom query option!");}else{i.push(N+"="+o(j[N]));}}}}return i.join("&");};r.prototype.bindContext=function(P,i,j){var k=new b(this,P,i,j);return k;};r.prototype.setCountSupported=function(i){this.bCountSupported=i;};r.prototype.isCountSupported=function(){return this.bCountSupported;};r.prototype.setDefaultCountMode=function(s){this.sDefaultCountMode=s;};r.prototype.getDefaultCountMode=function(){return this.sDefaultCountMode;};r.prototype._getKey=function(i,D){var k,s;if(i instanceof C){k=i.getPath().substr(1);}else if(i&&i.__metadata&&i.__metadata.uri){s=i.__metadata.uri;k=s.substr(s.lastIndexOf("/")+1);}if(D){k=decodeURIComponent(k);}return k;};r.prototype.getKey=function(i,D){return this._getKey(i,D);};r.prototype.createKey=function(s,k,D){var E=this.oMetadata._getEntityTypeByPath(s),K=s,t=this,N,v,P;n(E,"Could not find entity type of collection \""+s+"\" in service metadata!");K+="(";if(E.key.propertyRef.length==1){N=E.key.propertyRef[0].name;n(N in k,"Key property \""+N+"\" is missing in object!");P=this.oMetadata._getPropertyMetadata(E,N);v=O.formatValue(k[N],P.type);K+=D?v:encodeURIComponent(v);}else{q.each(E.key.propertyRef,function(i,j){if(i>0){K+=",";}N=j.name;n(N in k,"Key property \""+N+"\" is missing in object!");P=t.oMetadata._getPropertyMetadata(E,N);v=O.formatValue(k[N],P.type);K+=N;K+="=";K+=D?v:encodeURIComponent(v);});}K+=")";return K;};r.prototype.getProperty=function(P,i,I){var v=this._getObject(P,i);if(I==null||I==undefined){return v;}if(!p(v)){return v;}v=m({},v);if(I==true){return this._restoreReferences(v);}else{return this._removeReferences(v);}};r.prototype._getObject=function(P,i){var N=this.isLegacySyntax()?this.oData:null,R=this.resolve(P,i),s,D,j,k,K,l;if(this.oMetadata&&R&&R.indexOf('/#')>-1){if(this.isMetaModelPath(R)){s=R.indexOf('/##');l=this.getMetaModel();if(!this.bMetaModelLoaded){return null;}D=R.substr(0,s);j=R.substr(s+3);k=l.getMetaContext(D);N=l.getProperty(j,k);}else{N=this.oMetadata._getAnnotation(R);}}else{if(i){K=i.getPath();K=K.substr(1);N=this.oData[K];}if(!P){return N;}var t=P.split("/"),I=0;if(!t[0]){N=this.oData;I++;}while(N&&t[I]){N=N[t[I]];if(N){if(N.__ref){N=this.oData[N.__ref];}else if(N.__list){N=N.__list;}else if(N.__deferred){N=undefined;}}I++;}}return N;};r.prototype.updateSecurityToken=function(){if(this.bTokenHandling){if(!this.oServiceData.securityToken){this.refreshSecurityToken();}if(this.bTokenHandling){this.oHeaders["x-csrf-token"]=this.oServiceData.securityToken;}}};r.prototype.resetSecurityToken=function(){delete this.oServiceData.securityToken;delete this.oHeaders["x-csrf-token"];};r.prototype.getSecurityToken=function(){var t=this.oServiceData.securityToken;if(!t){this.refreshSecurityToken();t=this.oServiceData.securityToken;}return t;};r.prototype.refreshSecurityToken=function(s,E,A){var t=this,i,T;A=A===true;i=this._createRequestUrl("/");var R=this._createRequest(i,"GET",A);R.headers["x-csrf-token"]="Fetch";function _(D,k){if(k){T=t._getHeader("x-csrf-token",k.headers);if(T){t.oServiceData.securityToken=T;t.oHeaders["x-csrf-token"]=T;}else{t.resetSecurityToken();t.bTokenHandling=false;}}if(s){s(D,k);}}function j(k){t.resetSecurityToken();t.bTokenHandling=false;t._handleError(k);if(E){E(k);}}return this._request(R,_,j,undefined,undefined,this.getServiceMetadata());};r.prototype._submitRequest=function(R,i,s,E,H,I){var t=this,j,k={};function _(D,w){if(i&&H){var x=t._getBatchErrors(D);if(x.length>0){l(x[0]);return false;}if(D.__batchResponses&&D.__batchResponses.length>0){j=D.__batchResponses[0].data;if(!j&&D.__batchResponses[0].__changeResponses){j=D.__batchResponses[0].__changeResponses[0].data;}}D=j;}if(I){if(D&&D.__batchResponses){q.each(D.__batchResponses,function(y,w){if(w&&w.data){t._importData(w.data,k);}});}}t._handleETag(R,w,i);t._updateRequestQueue(R,i);if(t._isRefreshNeeded(R,w)){t._refresh(false,R.keys,R.entityTypes);}if(s){s(D,w);}}function l(w){if(t.bTokenHandling&&w.response){var T=t._getHeader("x-csrf-token",w.response.headers);if(!R.bTokenReset&&w.response.statusCode=='403'&&T&&T.toLowerCase()=="required"){t.resetSecurityToken();R.bTokenReset=true;v();return;}}t._handleError(w);if(E){E(w);}}function v(){if(t.bTokenHandling&&R.method!=="GET"){t.updateSecurityToken();if(t.bTokenHandling){R.headers["x-csrf-token"]=t.oServiceData.securityToken;}}if(i){return t._request(R,_,l,h.batchHandler,undefined,t.getServiceMetadata());}else{return t._request(R,_,l,t.oHandler,undefined,t.getServiceMetadata());}}return v();};r.prototype._createBatchRequest=function(s,A){var t,R,v={},P={},K={},E={};P.__batchRequests=s;t=this.sServiceUrl+"/$batch";if(this.aUrlParams.length>0){t+="?"+this.aUrlParams.join("&");}q.extend(v,this.mCustomHeaders,this.oHeaders);delete v["Content-Type"];R={headers:v,requestUri:t,method:"POST",data:P,user:this.sUser,password:this.sPassword,async:A};if(A){R.withCredentials=this.bWithCredentials;}q.each(s,function(i,w){if(w["__changeRequests"]){q.each(w["__changeRequests"],function(j,x){if(x.keys&&x.method!="POST"){q.each(x.keys,function(k,l){K[k]=l;});}else if(x.entityTypes&&x.method=="POST"){q.each(x.entityTypes,function(l,k){E[l]=k;});}});}});R.keys=K;R.entityTypes=E;return R;};r.prototype._handleETag=function(R,k,l){var s,E,t,v,w,x;if(l){w=R.data.__batchRequests;x=k.data.__batchResponses;if(x&&w){for(var i=0;i<w.length;i++){t=w[i].__changeRequests;if(x[i]){v=x[i].__changeResponses;if(t&&v){for(var j=0;j<t.length;j++){if(t[j].method=="MERGE"||t[j].method=="PUT"){s=t[j].requestUri.replace(this.sServiceUrl+'/','');if(!s.startsWith("/")){s="/"+s;}E=this._getObject(s);if(E&&E.__metadata&&v[j].headers&&v[j].headers.ETag){E.__metadata.etag=v[j].headers.ETag;}}}}}else{L.warning("could not update ETags for batch request: corresponding response for request missing");}}}else{L.warning("could not update ETags for batch request: no batch responses/requests available");}}else{s=R.requestUri.replace(this.sServiceUrl+'/','');if(!s.startsWith("/")){s="/"+s;}E=this._getObject(s);if(E&&E.__metadata&&k.headers.ETag){E.__metadata.etag=k.headers.ETag;}}};r.prototype._handleBatchErrors=function(R,D){this._getBatchErrors(D);this._handleETag();};r.prototype._getBatchErrors=function(D){var E=[],s;q.each(D.__batchResponses,function(i,j){if(j.message){s="The following problem occurred: "+j.message;if(j.response){s+=j.response.statusCode+","+j.response.statusText+","+j.response.body;}E.push(j);L.fatal(s);}if(j.__changeResponses){q.each(j.__changeResponses,function(i,k){if(k.message){s="The following problem occurred: "+k.message;if(k.response){s+=k.response.statusCode+","+k.response.statusText+","+k.response.body;}E.push(k);L.fatal(s);}});}});return E;};r.prototype._handleError=function(E){var P={},t;var s="The following problem occurred: "+E.message;P.message=E.message;if(E.response){if(this.bTokenHandling){t=this._getHeader("x-csrf-token",E.response.headers);if(E.response.statusCode=='403'&&t&&t.toLowerCase()=="required"){this.resetSecurityToken();}}s+=E.response.statusCode+","+E.response.statusText+","+E.response.body;P.statusCode=E.response.statusCode;P.statusText=E.response.statusText;P.responseText=E.response.body;}L.fatal(s);return P;};r.prototype.getData=function(P,i,I){return this.getProperty(P,i,I);};r.prototype._getETag=function(P,i,E){var s,j,I;if(E){s=E;}else{if(i&&i.__metadata){s=i.__metadata.etag;}else if(P){j=P.replace(this.sServiceUrl+'/','');I=j.indexOf("?");if(I>-1){j=j.substr(0,I);}if(this.oData.hasOwnProperty(j)){s=this.getProperty('/'+j+'/__metadata/etag');}}}return s;};r.prototype._createRequest=function(s,i,A,P,E){var j={},k;q.extend(j,this.mCustomHeaders,this.oHeaders);k=this._getETag(s,P,E);if(k&&i!="GET"){j["If-Match"]=k;}if(this.bJSON&&i!="DELETE"&&this.sMaxDataServiceVersion==="2.0"){j["Content-Type"]="application/json";}if(i=="MERGE"&&!this.bUseBatch){j["x-http-method"]="MERGE";i="POST";}var R={headers:j,requestUri:s,method:i,user:this.sUser,password:this.sPassword,async:A};if(P){R.data=P;}if(A){R.withCredentials=this.bWithCredentials;}return R;};r.prototype._isRefreshNeeded=function(R,i){var j=false,E,k=[],t=this;if(!this.bRefreshAfterChange){return j;}if(R.data&&Array.isArray(R.data.__batchRequests)){if(i){k=t._getBatchErrors(i.data);q.each(k,function(I,l){if(l.response&&l.response.statusCode=="412"){E=l.response.statusCode;return false;}});if(!!E){return false;}}q.each(R.data.__batchRequests,function(I,l){if(Array.isArray(l.__changeRequests)){q.each(l.__changeRequests,function(I,s){j=j||t._isRefreshNeeded(s);return!j;});}return!j;});}else{if(R.method==="GET"){return false;}else{if(i&&i.statusCode=="412"){j=false;}else{j=true;}}}return j;};r.prototype.update=function(P,D,i){var s,E,j,R,k,l,t,v,w,S,K,x,A=false;if(i instanceof C||arguments.length>3){l=i;s=arguments[3];E=arguments[4];j=arguments[5];}else{l=i.context||i.oContext;s=i.success||i.fnSuccess;E=i.error||i.fnError;t=i.eTag||i.sETag;j=typeof(i.merge)=="undefined"?i.bMerge===true:i.merge===true;A=typeof(i.async)=="undefined"?i.bAsync===true:i.async===true;x=i.urlParameters;}k=this._createRequestUrl(P,l,x,this.bUseBatch);if(j){R=this._createRequest(k,"MERGE",A,D,t);}else{R=this._createRequest(k,"PUT",A,D,t);}P=this._normalizePath(P,l);S=this._getObject(P);R.keys={};if(S){K=this._getKey(S);R.keys[K]=true;}if(this.bUseBatch){w=this._createBatchRequest([{__changeRequests:[R]}],A);v=this._submitRequest(w,this.bUseBatch,s,E,true);}else{v=this._submitRequest(R,this.bUseBatch,s,E);}return v;};r.prototype.create=function(P,D,i){var R,j,s,k,E,l,S,t,A=false,v;if(i&&typeof(i)=="object"&&!(i instanceof C)){l=i.context;S=i.success;v=i.urlParameters;t=i.error;A=i.async===true;}else{l=i;S=arguments[3];t=arguments[4];}s=this._createRequestUrl(P,l,v,this.bUseBatch);R=this._createRequest(s,"POST",A,D);P=this._normalizePath(P,l);E=this.oMetadata._getEntityTypeByPath(P);R.entityTypes={};if(E){R.entityTypes[E.entityType]=true;}if(this.bUseBatch){j=this._createBatchRequest([{__changeRequests:[R]}],A);k=this._submitRequest(j,this.bUseBatch,S,t,true);}else{k=this._submitRequest(R,this.bUseBatch,S,t);}return k;};r.prototype.remove=function(P,i){var j,E,s,S,k,R,l,t,K,v,_,w,x,y,A=false,z=this;if((i instanceof C)||arguments[2]){j=i;S=arguments[2];k=arguments[3];}else if(i){j=i.context||i.oContext;S=i.success||i.fnSuccess;k=i.error||i.fnError;t=i.eTag||i.sETag;v=i.payload||i.oPayload;A=typeof(i.async)=="undefined"?i.bAsync===true:i.async===true;y=i.urlParameters;}_=function(D,G){E=l.substr(l.lastIndexOf('/')+1);if(E.indexOf('?')!=-1){E=E.substr(0,E.indexOf('?'));}delete z.oData[E];delete z.mContexts["/"+E];if(S){S(D,G);}};l=this._createRequestUrl(P,j,y,this.bUseBatch);R=this._createRequest(l,"DELETE",A,v,t);P=this._normalizePath(P,j);s=this._getObject(P);R.keys={};if(s){K=this._getKey(s);R.keys[K]=true;}if(this.bUseBatch){w=this._createBatchRequest([{__changeRequests:[R]}],A);x=this._submitRequest(w,this.bUseBatch,_,k,true);}else{x=this._submitRequest(R,this.bUseBatch,_,k);}return x;};r.prototype.callFunction=function(s,P){var R,i,j,k,l,t,v,S,E,A,w="GET",x={},y=this;if(P&&typeof(P)=="object"){w=P.method?P.method:w;t=P.urlParameters;v=P.context;S=P.success;E=P.error;A=P.async===true;}else{w=P;t=arguments[2];v=arguments[3];S=arguments[4];E=arguments[5];A=arguments[6]===true;}l=this.oMetadata._getFunctionImportMetadata(s,w);n(l,"Function "+s+" not found in the metadata !");if(l){j=this._createRequestUrl(s,v,null,this.bUseBatch);var z=U(j);if(l.parameter!=null){q.each(t,function(D,G){var H=l.parameter.filter(function(J){return J.name==D&&J.mode=="In";});if(H.length>0){var I=H[0];x[D]=O.formatValue(G,I.type);}else{L.warning("Parameter "+D+" is not defined for function call "+s+"!");}});}if(w==="GET"){return y.read(s,v,x,true,S,E);}else{q.each(x,function(D,G){z.addQuery(D,G);});R=this._createRequest(z.toString(),w,A);if(this.bUseBatch){i=this._createBatchRequest([{__changeRequests:[R]}],A);k=this._submitRequest(i,this.bUseBatch,S,E,true);}else{k=this._submitRequest(R,this.bUseBatch,S,E);}return k;}}};r.prototype.read=function(P,i){var R,s,j,k,l,t,A,S,E,v,w,x,y,z,D,G,H;if(i&&typeof(i)=="object"&&!(i instanceof C)){l=i.context;t=i.urlParameters;A=i.async!==false;S=i.success;E=i.error;v=i.filters;w=i.sorters;}else{l=i;t=arguments[2];A=arguments[3]!==false;S=arguments[4];E=arguments[5];}A=A!==false;H=O._createUrlParamsArray(t);y=O.createSortParams(w);if(y){H.push(y);}if(v&&!this.oMetadata){L.fatal("Tried to use filters in read method before metadata is available.");}else{G=this._normalizePath(P,l);D=this.oMetadata&&this.oMetadata._getEntityTypeByPath(G);z=F.groupFilters(v);x=O.createFilterParams(z,this.oMetadata,D);if(x){H.push(x);}}s=this._createRequestUrl(P,l,H,this.bUseBatch);R=this._createRequest(s,"GET",A);if(this.bUseBatch){k=this._createBatchRequest([R],A);j=this._submitRequest(k,this.bUseBatch,S,E,true);}else{j=this._submitRequest(R,this.bUseBatch,S,E);}return j;};r.prototype.createBatchOperation=function(P,s,D,i){var j={},E,S,k,l;q.extend(j,this.mCustomHeaders,this.oHeaders);if(P.startsWith("/")){P=P.substr(1);}if(i){E=i.sETag;}if(s!="GET"){E=this._getETag(P,D,E);if(E){j["If-Match"]=E;}}if(this.bJSON){if(s!="DELETE"&&s!="GET"&&this.sMaxDataServiceVersion==="2.0"){j["Content-Type"]="application/json";}}else{j["Content-Type"]="application/atom+xml";}var R={requestUri:P,method:s.toUpperCase(),headers:j};if(D){R.data=D;}if(s!="GET"&&s!="POST"){if(P&&P.indexOf("/")!=0){P='/'+P;}S=this._getObject(P);if(S){k=this._getKey(S);R.keys={};R.keys[k]=true;}}else if(s=="POST"){var N=P;if(P.indexOf('?')!=-1){N=P.substr(0,P.indexOf('?'));}l=this.oMetadata._getEntityTypeByPath(N);if(l){R.entityTypes={};R.entityTypes[l.entityType]=true;}}return R;};r.prototype.addBatchReadOperations=function(R){if(!Array.isArray(R)||R.length<=0){L.warning("No array with batch operations provided!");return false;}var t=this;q.each(R,function(i,j){if(j.method!="GET"){L.warning("Batch operation should be a GET operation!");return false;}t.aBatchOperations.push(j);});};r.prototype.addBatchChangeOperations=function(i){if(!Array.isArray(i)||i.length<=0){return false;}q.each(i,function(I,j){if(j.method!="POST"&&j.method!="PUT"&&j.method!="MERGE"&&j.method!="DELETE"){L.warning("Batch operation should be a POST/PUT/MERGE/DELETE operation!");return false;}});this.aBatchOperations.push({__changeRequests:i});};r.prototype.clearBatch=function(){this.aBatchOperations=[];};r.prototype.submitBatch=function(s,E,A,i){var R,j,t=this;function _(D,v){if(s){s(D,v,t._getBatchErrors(D));}}if(!(typeof(s)=="function")){var k=A;var l=E;A=s;s=l;E=k;}A=A!==false;if(this.aBatchOperations.length<=0){L.warning("No batch operations in batch. No request will be triggered!");return false;}R=this._createBatchRequest(this.aBatchOperations,A);j=this._submitRequest(R,true,_,E,false,i);this.clearBatch();return j;};r.prototype.getServiceMetadata=function(){if(this.oMetadata&&this.oMetadata.isLoaded()){return this.oMetadata.getServiceMetadata();}};r.prototype.getServiceAnnotations=function(){if(this.oAnnotations&&this.oAnnotations.getAnnotationsData){return this.oAnnotations.getAnnotationsData();}};r.prototype.submitChanges=function(s,E,P){var R,i,t=this,j,k,T,l,S,K;if(this.sChangeKey){j=this.sChangeKey.replace(this.sServiceUrl,'');S=this._getObject(j);i=S;if(p(S)){i=m({},S);if(i.__metadata){T=i.__metadata.type;l=i.__metadata.etag;delete i.__metadata;if(T||l){i.__metadata={};}if(T){i.__metadata.type=T;}if(!!l){i.__metadata.etag=l;}}q.each(i,function(x,y){if(y&&y.__deferred){delete i[x];}});var v=this.oMetadata._getEntityTypeByPath(j);if(v){var N=this.oMetadata._getNavigationPropertyNames(v);q.each(N,function(I,x){delete i[x];});}i=this._removeReferences(i);}if(P&&P.sETag){k=P.sETag;}R=this._createRequest(this.sChangeKey,"MERGE",true,i,k);if(this.sUrlParams){R.requestUri+="?"+this.sUrlParams;}R.keys={};if(S){K=this._getKey(S);R.keys[K]=true;}this.oRequestQueue[this.sChangeKey]=R;}if(q.isEmptyObject(this.oRequestQueue)){return undefined;}if(this.bUseBatch){var w=[];q.each(this.oRequestQueue,function(K,x){delete x._oRef;var y=m({},x);x._oRef=y;y.requestUri=y.requestUri.replace(t.sServiceUrl+'/','');y.data._bCreate?delete y.data._bCreate:false;w.push(y);});R=this._createBatchRequest([{__changeRequests:w}],true);this._submitRequest(R,this.bUseBatch,s,E,true);}else{q.each(this.oRequestQueue,function(K,x){delete x._oRef;var y=m({},x);x._oRef=y;if(y.data&&y.data._bCreate){delete y.data._bCreate;}t._submitRequest(y,this.bUseBatch,s,E,true);});}return undefined;};r.prototype._updateRequestQueue=function(R,k){var l,s,t,v=this;if(k){l=R.data.__batchRequests;if(l){for(var i=0;i<l.length;i++){s=l[i].__changeRequests;if(s){for(var j=0;j<s.length;j++){t=s[j];q.each(this.oRequestQueue,function(K,w){if(w._oRef===t&&K!==v.sChangeKey){delete v.oRequestQueue[K];delete v.oData[K];delete v.mContexts["/"+K];}else if(v.sChangeKey&&K===v.sChangeKey){delete v.oRequestQueue[K];v.sChangeKey=null;}});}}}}}else{q.each(this.oRequestQueue,function(K,w){if(w._oRef===R&&K!==v.sChangeKey){delete v.oRequestQueue[K];delete v.oData[K];delete v.mContexts["/"+K];}else if(v.sChangeKey&&K===v.sChangeKey){delete v.oRequestQueue[K];v.sChangeKey=null;}});}};r.prototype.resetChanges=function(s,E){var P;if(this.sChangeKey){P=this.sChangeKey.replace(this.sServiceUrl,'');this._loadData(P,null,s,E);}};r.prototype.setProperty=function(P,v,j,A){var s,E={},D={},k=this._createRequestUrl(P,j),l=P.substring(0,P.lastIndexOf("/")),K,t,w={},x=false;if(!this.resolve(P,j)){return false;}k=k.replace(this.sServiceUrl+'/','');k=k.substring(0,k.indexOf("/"));k=this.sServiceUrl+'/'+k;s=P.substr(P.lastIndexOf("/")+1);D=this._getObject(l,j);if(!D){return false;}t=l.split("/");for(var i=t.length-1;i>=0;i--){E=this._getObject(t.join("/"),j);if(E){K=this._getKey(E);if(K){break;}}t.splice(i-1,1);}if(!K){K=this._getKey(j);}if(K){w[K]=true;}if(D._bCreate){D[s]=v;x=true;this.checkUpdate(false,A,w);}else{if(!this.sChangeKey){this.sChangeKey=k;}if(this.sChangeKey==k){D[s]=v;x=true;this.checkUpdate(false,A,w);}else{this.fireRejectChange({rejectedValue:v,oldValue:D[s]});}}return x;};r.prototype._isHeaderPrivate=function(H){switch(H.toLowerCase()){case"accept":case"accept-language":case"maxdataserviceversion":case"dataserviceversion":return true;case"x-csrf-token":return this.bTokenHandling;default:return false;}};r.prototype.setHeaders=function(H){var i={},t=this;if(H){q.each(H,function(s,j){if(t._isHeaderPrivate(s)){L.warning("Not allowed to modify private header: "+s);}else{i[s]=j;}});this.mCustomHeaders=i;}else{this.mCustomHeaders={};}if(this.oAnnotations){this.oAnnotations.setHeaders(this.mCustomHeaders);}};r.prototype.getHeaders=function(){return q.extend({},this.mCustomHeaders,this.oHeaders);};r.prototype._getHeader=function(s,H){var i;for(i in H){if(i.toLowerCase()===s.toLowerCase()){return H[i];}}return null;};r.prototype.hasPendingChanges=function(){return this.sChangeKey!=null;};r.prototype.updateBindings=function(i){this.checkUpdate(i);};r.prototype.forceNoCache=function(i){this.bCache=!i;};r.prototype.setTokenHandlingEnabled=function(t){this.bTokenHandling=t;};r.prototype.setUseBatch=function(i){this.bUseBatch=i;};r.prototype.formatValue=function(v,t){return O.formatValue(v,t);};r.prototype.deleteCreatedEntry=function(i){if(i){var P=i.getPath();delete this.mContexts[P];if(P.startsWith("/")){P=P.substr(1);}delete this.oRequestQueue[P];delete this.oData[P];}};r.prototype.createEntry=function(P,v){var E={},k,s,R;if(!P.startsWith("/")){P="/"+P;}var j=this.oMetadata._getEntityTypeByPath(P);if(!j){n(j,"No Metadata for collection "+P+" found");return undefined;}if(typeof v==="object"&&!Array.isArray(v)){E=v;}else{for(var i=0;i<j.property.length;i++){var l=j.property[i];var t=v&&v.indexOf(l.name)>-1;if(!v||t){E[l.name]=this._createPropertyValue(l.type);if(t){v.splice(v.indexOf(l.name),1);}}}if(v){n(v.length===0,"No metadata for the following properties found: "+v.join(","));}}E._bCreate=true;k=P.substring(1)+"('"+u()+"')";this.oData[k]=E;E.__metadata={type:""+j.entityType};s=this._createRequestUrl(P);R=this._createRequest(s,"POST",true,E);R.entityTypes={};R.entityTypes[j.entityType]=true;this.oRequestQueue[k]=R;return this.getContext("/"+k);};r.prototype._createPropertyValue=function(t){var T=this.oMetadata._splitName(t);var N=T.namespace;var s=T.name;if(N.toUpperCase()!=='EDM'){var j={};var k=this.oMetadata._getObjectMetadata("complexType",s,N);n(k,"Complex type "+t+" not found in the metadata !");for(var i=0;i<k.property.length;i++){var P=k.property[i];j[P.name]=this._createPropertyValue(P.type);}return j;}else{return this._getDefaultPropertyValue(s,N);}};r.prototype._getDefaultPropertyValue=function(t,N){return undefined;};r.prototype._normalizePath=function(P,i){if(P&&P.indexOf('?')!=-1){P=P.substr(0,P.indexOf('?'));}if(!i&&!P.startsWith("/")){P='/'+P;L.warning(this+" path "+P+" should be absolute if no Context is set");}return this.resolve(P,i);};r.prototype.setRefreshAfterChange=function(R){this.bRefreshAfterChange=R;};r.prototype.isList=function(P,i){var P=this.resolve(P,i);return P&&P.substr(P.lastIndexOf("/")).indexOf("(")===-1;};r.prototype.isMetaModelPath=function(P){return P.indexOf("##")==0||P.indexOf("/##")>-1;};r.prototype._request=function(R,s,E,H,i,j){if(this.bDestroyed){return{abort:function(){}};}var t=this;function w(l){return function(){if(t.aPendingRequestHandles){var I=t.aPendingRequestHandles.indexOf(k);if(I>-1){t.aPendingRequestHandles.splice(I,1);}}if(!(k&&k.bSuppressErrorHandlerCall)){l.apply(this,arguments);}};}var k=h.request(R,w(s||h.defaultSuccess),w(E||h.defaultError),H,i,j);if(R.async!==false){this.aPendingRequestHandles.push(k);}return k;};r.prototype.destroy=function(){this.bDestroyed=true;if(this.aPendingRequestHandles){for(var i=this.aPendingRequestHandles.length-1;i>=0;i--){var R=this.aPendingRequestHandles[i];if(R&&R.abort){R.bSuppressErrorHandlerCall=true;R.abort();}}delete this.aPendingRequestHandles;}if(!!this.oMetadataLoadEvent){clearTimeout(this.oMetadataLoadEvent);}if(!!this.oMetadataFailedEvent){clearTimeout(this.oMetadataFailedEvent);}if(this.oMetadata){this.oMetadata.detachLoaded(this.onMetadataLoaded);this.oMetadata.detachFailed(this.onMetadataFailed);if(!this.oMetadata.isLoaded()&&!this.oMetadata.hasListeners("loaded")){this.oMetadata.destroy();delete this.oServiceData.oMetadata;}delete this.oMetadata;}if(this.oAnnotations){this.oAnnotations.detachFailed(this.onAnnotationsFailed);this.oAnnotations.detachLoaded(this.onAnnotationsLoaded);this.oAnnotations.destroy();delete this.oAnnotations;delete this.pAnnotationsLoaded;}M.prototype.destroy.apply(this,arguments);};r.prototype._getAnnotationParser=function(A){if(!this.oAnnotations){var i=sap.ui.requireSync("sap/ui/model/odata/ODataAnnotations");this.oAnnotations=new i({annotationData:A,url:null,metadata:this.oMetadata,async:this.bLoadMetadataAsync,headers:this.mCustomHeaders});this.oAnnotations.attachFailed(this.onAnnotationsFailed,this);this.oAnnotations.attachLoaded(this.onAnnotationsLoaded,this);}return this.oAnnotations;};r.prototype.onAnnotationsFailed=function(E){this.fireAnnotationsFailed(E.getParameters());};r.prototype.onAnnotationsLoaded=function(E){this.fireAnnotationsLoaded(E.getParameters());};r.prototype.addAnnotationUrl=function(v){var j=[].concat(v),k=[],A=[],E=[],t=this;q.each(j,function(i,s){var I=s.indexOf("$metadata");if(I>=0){if(I==0){s=t.sServiceUrl+'/'+s;}k.push(s);}else{A.push(s);}});return this.oMetadata._addUrl(k).then(function(P){return Promise.all(q.map(P,function(i){E=E.concat(i.entitySets);return t.addAnnotationXML(i["metadataString"]);}));}).then(function(){return t._getAnnotationParser().addUrl(A);}).then(function(P){return{annotations:P.annotations,entitySets:E};});};r.prototype.addAnnotationXML=function(x,s){return new Promise(function(i,j){this._getAnnotationParser().setXML(null,x,{success:i,error:j,fireEvents:!s});}.bind(this));};r.prototype.getMetaModel=function(){var t=this;if(!this.oMetaModel){this.oMetaModel=new g(this.oMetadata,this.oAnnotations,{addAnnotationUrl:this.addAnnotationUrl.bind(this),annotationsLoadedPromise:this.oMetadata.isLoaded()&&(!this.oAnnotations||this.oAnnotations.isLoaded())?null:this.pAnnotationsLoaded});this.oMetaModel.loaded().then(function(){t.bMetaModelLoaded=true;t.checkUpdate(false,false,null,true);});}return this.oMetaModel;};return r;});
sap.ui.predefine('sap/ui/model/odata/ODataTreeBinding',['sap/ui/model/TreeBinding','./CountMode',"sap/base/Log","sap/ui/thirdparty/jquery"],function(T,C,L,q){"use strict";var O=T.extend("sap.ui.model.odata.ODataTreeBinding",{constructor:function(m,p,c,f,P){T.apply(this,arguments);this.bPendingRequest=false;this.oFinalLengths={};this.oLengths={};this.oKeys={};this.bNeedsUpdate=false;this.bHasTreeAnnotations=this._hasTreeAnnotations();this.oRootContext=null;this.iNumberOfExpandedLevels=P&&P.numberOfExpandedLevels;this.sCountMode=(P&&P.countMode)||this.oModel.sDefaultCountMode;if(!this.bHasTreeAnnotations){if(!P||!P.navigation){L.error("A navigation paths parameter object has to be defined");this.oNavigationPaths={};}else{this.oNavigationPaths=P.navigation;}}else{L.warning("Tree hierarchy annotations are deprecated and may not work correctly with the sap.ui.model.odata.ODataModel."+" Please use the sap.ui.model.odata.v2.ODataModel (since version 1.28) instead which fully supports hierarchy annotations.");}}});O.prototype.getRootContexts=function(s,l,t){var n=null,r={numberOfExpandedLevels:this.iNumberOfExpandedLevels},R=[],b=true,a=this;if(this.bHasTreeAnnotations){r.level=0;if(!this.bDisplayRootNode){r.level=1;}}else{n=this.oModel.resolve(this.getPath(),this.getContext());r.navPath=this._getNavPath(this.getPath());if(r.numberOfExpandedLevels>0){var A=n;for(var i=0;i<r.numberOfExpandedLevels;i++){var N=this._getNavPath(A);r.navPath+="/"+N;A+="/"+N;}}var I=this.oModel.isList(this.sPath,this.getContext());if(I){this.bDisplayRootNode=true;}else{b=false;this.oModel.createBindingContext(n,null,{expand:r.navPath},function(o){R=[o];if(a.oRootContext!==o){a.oRootContext=o;a._processODataObject(o.getObject(),n,r.navPath);a.bNeedsUpdate=true;}},this.bRefresh);this.bRefresh=false;}}if(b){if(!this.bDisplayRootNode){R=this._getContextsForNodeId(n,0,1,0,r);}else{R=this._getContextsForNodeId(n,s,l,t,r);}}if(!this.bDisplayRootNode&&R.length>0){this.oRootContext=R[0];R=this.getNodeContexts(R[0],s,l,t);}return R;};O.prototype.getNodeContexts=function(c,s,l,t){var n,r={};if(this.bHasTreeAnnotations){var d=c.getProperty(this.oTreeProperties["hierarchy-drill-state-for"]);if(d=="leaf"){return[];}n=c.getProperty(this.oTreeProperties["hierarchy-node-for"]);r.level=parseInt(c.getProperty(this.oTreeProperties["hierarchy-level-for"]))+1;}else{var N=this._getNavPath(c.getPath());if(!N){return[];}n=this.oModel.resolve(N,c);r.navPath=this.oNavigationPaths[N];}return this._getContextsForNodeId(n,s,l,t,r);};O.prototype.hasChildren=function(c){if(!c){return false;}if(this.bHasTreeAnnotations){var d=c.getProperty(this.oTreeProperties["hierarchy-drill-state-for"]);return d==="expanded"||d==="collapsed";}else{var n=this._getNavPath(c.getPath());var p=c.getPath()+"/"+n;return n&&this.oLengths[p]>0;}};O.prototype.getChildCount=function(c){if(this.bHasTreeAnnotations){var h;if(!c){if(this.oRootContext){h=this.oRootContext.getProperty(this.oTreeProperties["hierarchy-node-for"]);}else{h="000000";}}else{h=c.getProperty(this.oTreeProperties["hierarchy-node-for"]);}return this.oLengths[h];}else{if(!c){return this.oLengths[this.getPath()];}return this.oLengths[c.getPath()+"/"+this._getNavPath(c.getPath())];}};O.prototype._getContextsForNodeId=function(n,s,l,t,p){var c=[],b,k;if(!s){s=0;}if(!l){l=this.oModel.iSizeLimit;}if(!t){t=0;}if(this.bHasTreeAnnotations){if(n==null){n="000000";}if(p.level==0){p.level++;}}if(this.oFinalLengths[n]&&this.oLengths[n]<l){l=this.oLengths[n];}if(this.oKeys[n]){for(var i=s;i<s+l;i++){k=this.oKeys[n][i];if(!k){break;}c.push(this.oModel.getContext('/'+k));}}b=c.length!=l&&!(this.oFinalLengths[n]&&c.length>=this.oLengths[n]);if(this.oModel.getServiceMetadata()){if(!this.bPendingRequest&&b){var P=[];if(this.bHasTreeAnnotations){if(p.numberOfExpandedLevels>0){var a=p.level+p.numberOfExpandedLevels;P.push("$filter="+this.oTreeProperties["hierarchy-level-for"]+" le '0"+a+"'");}else{P.push("$filter="+this.oTreeProperties["hierarchy-level-for"]+" eq '0"+p.level+"' and "+this.oTreeProperties["hierarchy-parent-node-for"]+" eq '"+n+"'");}}else{if(p.navPath){P.push("$expand="+p.navPath);}}this._loadSubNodes(n,s,l,t,P,p);}}return c;};O.prototype._getCountForNodeId=function(n,s,l,t,p){var a=this;var P=[];function _(d){a.oFinalLengths[n]=true;a.oLengths[n]=parseInt(d);}function b(e){var E="Request for $count failed: "+e.message;if(e.response){E+=", "+e.response.statusCode+", "+e.response.statusText+", "+e.response.body;}L.warning(E);}var c;if(this.bHasTreeAnnotations){c=this.oModel.resolve(this.getPath(),this.getContext());P.push("$filter="+this.oTreeProperties["hierarchy-parent-node-for"]+" eq '"+n+"'");}else{c=n;}if(c){var u=this.oModel._createRequestUrl(c+"/$count",null,P);var r=this.oModel._createRequest(u,"GET",false);r.headers["Accept"]="text/plain, */*;q=0.5";this.oModel._request(r,_,b,undefined,undefined,this.oModel.getServiceMetadata());}};O.prototype._loadSubNodes=function(n,s,l,t,p,P){var a=this,I=false;if(s||l){p.push("$skip="+s+"&$top="+l);}if(!a.bHasTreeAnnotations&&!this.oFinalLengths[n]&&(this.sCountMode==C.Inline||this.sCountMode==C.Both)){p.push("$inlinecount=allpages");I=true;}function S(d){if(d.results){if(!a.bHasTreeAnnotations){if(I&&d.__count){a.oLengths[n]=parseInt(d.__count);a.oFinalLengths[n]=true;}else{if(a.oModel.isCountSupported()){a._getCountForNodeId(n);}}a.oKeys[n]=[];for(var i=0;i<d.results.length;i++){var E=d.results[i];var k=a.oModel._getKey(E);a._processODataObject(E,"/"+k,P.navPath);a.oKeys[n][i+s]=k;}}else{var m={};for(var i=0;i<d.results.length;i++){var E=d.results[i];n=E[a.oTreeProperties["hierarchy-parent-node-for"]];if(i==0){m[n]=s;}else if(m[n]==undefined){m[n]=0;}if(!(n in a.oKeys)){a.oKeys[n]=[];a._getCountForNodeId(n);}a.oKeys[n][m[n]]=a.oModel._getKey(E);m[n]++;}}}else{a.oKeys[null]=a.oModel._getKey(d);if(!a.bHasTreeAnnotations){a._processODataObject(d,n,P.navPath);}}a.oRequestHandle=null;a.bPendingRequest=false;a.bNeedsUpdate=true;}function c(){a.fireDataReceived();}function e(d){a.oRequestHandle=null;a.bPendingRequest=false;a.fireDataReceived();}function u(h){a.oRequestHandle=h;}if(n){if(!this.oFinalLengths[n]){this.bPendingRequest=true;this.fireDataRequested();var A;if(this.bHasTreeAnnotations){A=this.oModel.resolve(this.getPath(),this.getContext());}else{A=n;}this.oModel._loadData(A,p,S,e,false,u,c);}}};O.prototype.resetData=function(c){if(c){var p=c.getPath();delete this.oKeys[p];delete this.oLengths[p];delete this.oFinalLengths[p];}else{this.oKeys={};this.oLengths={};this.oFinalLengths={};this.oRootContext=null;}};O.prototype.refresh=function(f,c,e){var b=false;if(!f){if(e){var r=this.oModel.resolve(this.sPath,this.oContext);var E=this.oModel.oMetadata._getEntityTypeByPath(r);if(E&&(E.entityType in e)){b=true;}}if(c&&!b){q.each(this.oKeys,function(i,n){q.each(n,function(i,k){if(k in c){b=true;return false;}});if(b){return false;}});}if(!c&&!e){b=true;}}if(f||b){this.resetData();this.bNeedsUpdate=false;this.bRefresh=true;this._fireChange();}};O.prototype.filter=function(f){L.warning("Filtering is currently not possible in the ODataTreeBinding");return this;};O.prototype.checkUpdate=function(f,c){var b=false;if(!f){if(this.bNeedsUpdate||!c){b=true;}else{q.each(this.oKeys,function(i,n){q.each(n,function(i,k){if(k in c){b=true;return false;}});if(b){return false;}});}}if(f||b){this.bNeedsUpdate=false;this._fireChange();}};O.prototype._getNavPath=function(p){var a=this.oModel.resolve(p,this.getContext());if(!a){return;}var P=a.split("/"),e=P[P.length-1],n;var c=e.split("(")[0];if(c&&this.oNavigationPaths[c]){n=this.oNavigationPaths[c];}return n;};O.prototype._processODataObject=function(o,p,n){var N=[],t=this;if(n&&n.indexOf("/")>-1){N=n.split("/");n=N[0];N.splice(0,1);}var r=this.oModel._getObject(p);if(Array.isArray(r)){this.oKeys[p]=r;this.oLengths[p]=r.length;this.oFinalLengths[p]=true;}if(n&&o[n]){if(Array.isArray(r)){r.forEach(function(R){var o=t.getModel().getData("/"+R);t._processODataObject(o,"/"+R+"/"+n,N.join("/"));});}else if(typeof r==="object"){t._processODataObject(o,p+"/"+n,N.join("/"));}}};O.prototype._hasTreeAnnotations=function(){var m=this.oModel,M=m.oMetadata,a=m.resolve(this.getPath(),this.getContext()),e=M._getEntityTypeByPath(a),t=M.mNamespaces["sap"],b=this;this.oTreeProperties={"hierarchy-level-for":false,"hierarchy-parent-node-for":false,"hierarchy-node-for":false,"hierarchy-drill-state-for":false};if(!e){L.fatal("EntityType for path "+a+" could not be found.");return false;}q.each(e.property,function(i,p){if(!p.extensions){return true;}q.each(p.extensions,function(i,E){var n=E.name;if(E.namespace===t&&n in b.oTreeProperties&&!b.oTreeProperties[n]){b.oTreeProperties[n]=p.name;}});});var c=false;q.each(this.oTreeProperties,function(i,o){if(!o){c=true;return false;}});return!c;};return O;});
sap.ui.require.preload({
	"sap/ushell/components/tiles/indicatorArea/AreaChartTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n            <viewName>sap.ushell.components.tiles.indicatorArea.AreaChartTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatorDual/DualTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t\n\t\t\t<basePath>../../../../../</basePath>\n            <viewName>sap.ushell.components.tiles.indicatorDual.DualTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t\n\t\t<title />\n\t\t<description />\n\t\t\n\t</appearance>\n\n\t<contracts>\n\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t\t\n\t\t\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatorDualComparison/DualComparisonChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<!-- <basePath>../../</basePath>\n\t\t\t<componentName>tiles.indicatorDualComparison</componentName> -->\n\t\t\t<basePath>../../</basePath>\n            <viewName>tiles/indicatorDualComparison.DualComparison.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t\n\t\t<title />\n\t\t<description />\n\t\t\n\t</appearance>\n\n\t<contracts>\n\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatorDualContribution/DualContributionChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<!-- <basePath>../../</basePath>\n\t\t\t<componentName>tiles.indicatorDualComparison</componentName> -->\n\t\t\t<basePath>../../</basePath>\n            <viewName>tiles/indicatorDualComparison.DualComparison.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t\n\t\t<title />\n\t\t<description />\n\t\t\n\t</appearance>\n\n\t<contracts>\n\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatorDualDeviation/DualDeviationChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../</basePath>\n            <viewName>tiles/indicatorDualDeviation.DualDeviation.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\n\t\t<title />\n\t\t<description />\n\t\t\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatorDualTrend/DualTrendChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../</basePath>\n            <viewName>tiles/indicatorDualTrend.DualTrend.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">2</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatorHarveyBall/HarveyBallTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<!-- <basePath>../../</basePath>\n\t\t\t<componentName>tiles.indicatornumeric</componentName> -->\n\t\t\t<basePath>../../</basePath>\n            <viewName>tiles/indicatorHarveyBall.HarveyBallTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatorcomparison/ComparisonTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n            <viewName>sap.ushell.components.tiles.indicatorcomparison.ComparisonTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatorcontribution/ContributionTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t<basePath>../../../../../</basePath>\n            <viewName>sap.ushell.components.tiles.indicatorcontribution.ContributionTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatordeviation/DeviationTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n\t\t\t\n\t\t\t<basePath>../../../../../</basePath>\n            <viewName>sap.ushell.components.tiles.indicatordeviation.DeviationTile.view.js</viewName>\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t\n\t\t<title />\n\t\t<description />\n\t\t\n\t</appearance>\n\n\t<contracts>\n\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t\t<parameter name="row">1</parameter>\n\t\t\t\t<parameter name="col">1</parameter>\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t\t\n\t\t\n\t</contracts>\n</chip>\n',
	"sap/ushell/components/tiles/indicatornumeric/NumericTileChip.xml":'<?xml version="1.0" encoding="UTF-8"?>\n<chip xmlns="http://schemas.sap.com/sapui2/services/Chip/1">\n\t<implementation>\n\t\t<sapui5>\n<!-- \t\t\t<componentName>tiles.indicatornumeric</componentName> --> \n\t\t\t<basePath>../../../../../</basePath>\n            <viewName>sap.ushell.components.tiles.indicatornumeric.NumericTile.view.js</viewName>\n<!--             <basePath>../../</basePath> -->\n<!--             <viewName>tiles.indicatornumeric.NumericTile.view.js</viewName> -->\n\t\t</sapui5>\n\t</implementation>\n\t<appearance>\n\t\t<title />\n\t\t<description />\n\t</appearance>\n\t<contracts>\n\t\t<consume id="configuration">\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguration" />\n\t\t\t\t<parameter name="isSufficient" />\n\t\t\t\t<parameter name="timeStamp" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id=\'writeConfiguration\'>\n\t\t\t<parameters>\n\t\t\t\t<parameter name="tileConfiguation" />\n\t\t\t\t<parameter name="cacheTimeStamp" />\n\t\t\t</parameters>\n\t\t</consume>\n\t\t<consume id="visible" />\n\t\t<consume id="url" />\n\t\t<consume id="preview" />\n\t\t<consume id="search" />\n\t\t<consume id="bag" />\n\t</contracts>\n</chip>',
	"sap/ushell/components/tiles/indicatorHarveyBall/HarveyBallTile.controller.js":function(){
/* the subsequent text seems not to contain a copyright or license statement */
(function(){"use strict";sap.ui.controller("tiles.indicatorHarveyBall.HarveyBallTile",{onInit:function(){this.getView().setModel(new sap.ui.model.json.JSONModel());this.initializeVariables();this.attachHandlers();this.getVariable("tile").setState(sap.suite.ui.commons.LoadState.Loading);this.readChipConfiguration();},attachHandlers:function(){var t=this;var c=this.getVariable("chip");if(c.visible){c.visible.attachVisible(function(v){if(v){t.onVisible();}else{t.abortAllOpenODataRequests();}});}this.getVariable("tile").attachPress(function(){t.abortAllOpenODataRequests();var i=t.getVariable("indicatorUtils");t.getVariable("cache").setKpivalueById(t.getVariable("chipId"),null);window.location.hash=i.getNavigationTarget(t.getVariable("evalData"),t.getVariable("system"));});},initializeVariables:function(){this._variables={};this._oDataRequests={};var v=this.getView();var V=v.getViewData();var t=v.oTile;var c=V.chip;this.setVariable("indicatorUtils",sap.ushell.components.tiles.indicatorTileUtils.util);this.setVariable("cache",sap.ushell.components.tiles.indicatorTileUtils.cache);this.setVariable("hasAppeared",false);this.setVariable("chip",c);this.setVariable("tile",t);this.setVariable("tileControl",t.getTileContent()[0].getContent());this.setVariable("configurationString",c.configuration.getParameterValueAsString("tileConfiguration"));this.setVariable("system",c.url.getApplicationSystem());},getVariable:function(k){return this._variables[k];},setVariable:function(k,v){this._variables[k]=v;},readChipConfiguration:function(){var t=this;var c=this.getVariable("chip");var u=this.getVariable("indicatorUtils");u.getParsedChip(this.getVariable("configurationString"),function(e){t.setVariable("evalData",e);t.setVariable("chipId",e.TILE_PROPERTIES.id);t.setVariable("tileProperties",e.TILE_PROPERTIES);if(c.preview){c.preview.setTargetUrl(u.getNavigationTarget(e,t.getVariable("system")));t.loadPreviewData();if(c.preview.isEnabled()){t.getVariable("tile").setState(sap.suite.ui.commons.LoadState.Loaded);}else{t.loadActualData();}}});},loadPreviewData:function(){var t=this.getVariable("indicatorUtils").getTileTitleSubtitle(this.getVariable("chip"));this.getView().getModel().setData({fractionValue:34,value:100,size:sap.suite.ui.commons.InfoTileSize.Auto,frameType:"OneByOne",color:"Good",state:sap.suite.ui.commons.LoadState.Loading,header:t.title||this.getVariable("indicatorUtils").getChipTitle(this.getVariable("evalData")),subheader:t.subTitle||this.getVariable("indicatorUtils").getChipSubTitle(this.getVariable("evalData"))});},loadActualData:function(){if(Number(this.getVariable("chip").configuration.getParameterValueAsString("isSufficient"))){this.getVariable("cache").setEvaluationById(this.getVariable("chipId"),this.getVariable("evalData"));this.onEvalFiltersFetched();}else{this.fetchEvalFilters(this.onEvalFiltersFetched);}},registerOpenODataRequest:function(k,r){this._oDataRequests[k]=r;},deregisterOpenODataRequest:function(k){delete this._oDataRequests[k];},abortAllOpenODataRequests:function(){for(var a in this._oDataRequests){try{this.getVariable("indicatorUtils").abortPendingODataCalls(this._oDataRequests[a]);delete this._oDataRequests[a];}catch(e){}}},fetchKpiValue:function(p){function m(o,u,C,S,g){var D=o.read(u,null,null,true,function(h){t.deregisterOpenODataRequest(C.type);if(h&&h.results&&h.results.length){try{if(C.thresholds&&C.thresholds.length){t._setThresholdValues(h.results[0]);}k[C.type]=h.results[0][C.measure];k.unit=k.unit||h.results[0][C.unit]||"";if(--d==0){t.getVariable("cache").setKpivalueById(t.getVariable("chipId"),k);S.call(t,k);}}catch(e){t.logError(e);}}else{g.call(t,"no data");}},function(e){t.deregisterOpenODataRequest(C.type);if(e&&e.response){g.call(t,e.message);}});t.registerOpenODataRequest(C.type,D);}var t=this;var i=this.getVariable("indicatorUtils");var c=this.getVariable("cache").getKpivalueById(this.getVariable("chipId"));if(c){p.fnS.call(t,c);}else{var M=p.measure1,s=p.measure2;var u=p.url,E=p.entitySet;var v=p.filters;var f=p.fractionFilters.concat(v);var q,Q;var a,b,k;var d=2;f.forEach(function(e){e.value=e.value+"";e.valueTo=e.valueTo+"";});if(p.thresholds&&p.thresholds.length){q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,M+","+p.thresholds,null,v);}else{q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,M,null,v);}Q=i.prepareQueryServiceUri(this.getVariable("chip").url.addSystemToServiceUrl(u),E,s,null,f);a=q.unit[0];b=Q.unit[0];k={kpiValue:null,fractionValue:null,unit:""};if(q){m(q.model,q.uri,{measure:M,type:"kpiValue",unit:a,thresholds:p.thresholds},p.fnS,p.fnE);}if(Q){m(Q.model,Q.uri,{measure:s,type:"fractionValue",unit:b},p.fnS,p.fnE);}if(!(q&&Q)){p.fnE.call(t,"Error Preparing Query Service URI");}}},_setThresholdValues:function(d){var t=this.getVariable("oThreshold");if(t){if(this.getVariable("evalData").EVALUATION.VALUES_SOURCE=="RELATIVE"){if(t["TA"].COLUMN_NAME){t["TA"].VALUE=parseFloat(d[t["TA"].COLUMN_NAME]);for(var e in t){if(!t[e].COLUMN_NAME){t[e].VALUE=t["TA"].VALUE*t[e].VALUE/100;}}}}else{for(var e in t){if(t[e].COLUMN_NAME){t[e].VALUE=parseFloat(d[t[e].COLUMN_NAME]);}}}}this.setVariable("oThreshold",t);},getThresholdObject:function(){var t=this.getVariable("oThreshold");if(!t){var T=this.getVariable("evalData").EVALUATION_VALUES;var t={};for(var i=0,l=T.length;i<l;i++){t[T[i].TYPE]={VALUE:parseFloat(T[i].FIXED),COLUMN_NAME:T[i].COLUMN_NAME};}this.setVariable("oThreshold",t);}return t;},hasSomeValue:function(){var f=true;if(arguments.length){for(var i=0,l=arguments.length;i<l;i++){if(!(arguments[i]||arguments[i]=="0")){f=false;break;}}}else{f=false;}return f;},getTrendColor:function(k){var c="Neutral";var t,g,W,a,C,b;if(this.getVariable("tileProperties").isFractionMeasure){t=this.getThresholdObject();g=this.getVariable("evalData").EVALUATION.GOAL_TYPE;if(g=="MA"){W=t.WL;C=t.CL;if(this.hasSomeValue(W,C)){c="Good";if(k<C.VALUE){c="Error";}else if(k<=W.VALUE){c="Critical";}}}else if(g=='MI'){a=t.WH;b=t.CH;if(this.hasSomeValue(a,b)){c="Error";if(k<a.VALUE){c="Good";}else if(k<=b.VALUE){c="Critical";}}}else{W=t.WL;C=t.CL;a=t.WH;b=t.CH;if(this.hasSomeValue(a,b,C,W)){if(k<=C.VALUE||k>=a.VALUE){c="Error";}else if((W.VALUE>=k&&k>=C.VALUE)||(b.VALUE>=k&&k>=a.VALUE)){c="Critical";}else{c="Good";}}}}return sap.suite.ui.commons.InfoTileValueColor[c];},_getThresholdMeasures:function(){var t=[];var T=this.getThresholdObject();for(var e in T){if(T[e].COLUMN_NAME){t.push(T[e].COLUMN_NAME);}}return t;},onEvalFiltersFetched:function(){var t=this;if(this.getVariable("chip").visible.isVisible()&&!this.getVariable("hasAppeared")){try{var k=this.getVariable("evalData");var u=k.EVALUATION.ODATA_URL;var E=k.EVALUATION.ODATA_ENTITYSET;var a=this.getVariable("tileProperties");var h=[];var v=this.getVariable("indicatorUtils").prepareFilterStructure(k.EVALUATION_FILTERS,k.ADDITIONAL_FILTERS);var f=k.EVALUATION.COLUMN_NAME;var b=f;var c=[];if(a.isFractionMeasure){b=a.harveyTotalMeasure;c=this._getThresholdMeasures();}else{h=this.getVariable("indicatorUtils").prepareFilterStructure(a.harveyFilters||h);}this.setVariable("totalMeasure",b);this.setVariable("fractionMeasure",f);this.fetchKpiValue({measure1:b,measure2:f,entitySet:E,thresholds:c,url:u,filters:v,fractionFilters:h,fnS:function(d){d.kpiValue=Number(d.kpiValue);d.fractionValue=Number(d.fractionValue);t.setVariable("kpiValue",d.kpiValue);t.setVariable("fractionValue",d.fractionValue);t.onKpiValueFetched(d.kpiValue,d.unit,d.fractionValue);},fnE:this.logError});t.setVariable("hasAppeared",true);}catch(e){this.logError(e);}}},fetchEvalFilters:function(s){var t=this;try{var a=this.getVariable("cache").getEvaluationById(this.getVariable("chipId"));if(a){this.getVariable("evalData").EVALUATION_FILTERS=a.EVALUATION_FILTERS;s();}else{var d=this.getVariable("indicatorUtils").getFilterFromRunTimeService(this.getVariable("evalData"),function(f){t.deregisterOpenODataRequest("kpiFilterRequest");t.getVariable("evalData").EVALUATION_FILTERS=f;t.getVariable("cache").setEvaluationById(t.getVariable("chipId"),t.getVariable("evalData"));s.call(t);},function(e){this.logError(e);t.deregisterOpenODataRequest("kpiFilterRequest");});this.registerOpenODataRequest("kpiFilterRequest",d);}}catch(e){this.logError(e);}},onKpiValueFetched:function(k,a,f,b){var i=this.getVariable("indicatorUtils");var s=k;var d=f;var e=this.getVariable("evalData");var g=e.EVALUATION.SCALING;if(g==-2){s*=100;d*=100;}var c=this.isACurrencyMeasure(this.getVariable("totalMeasure"));s=i.getLocaleFormattedValue(Number(s),g,null,c,a);c=this.isACurrencyMeasure(this.getVariable("fractionMeasure"));d=i.getLocaleFormattedValue(Number(d),g,null,c,a);this.getView().getModel().setProperty("/totalLabel",s+" "+a);this.getView().getModel().setProperty("/fractionLabel",d+" "+b);this.getView().getModel().setProperty("/color",this.getTrendColor(f));this.getView().getModel().setProperty("/value",k);this.getView().getModel().setProperty("/fractionValue",f);var n=i.getNavigationTarget(this.getVariable("evalData"),this.getVariable("system"));this.getVariable("tile").$().wrap("<a href ='"+n+"'/>");this.getVariable("tile").setState(sap.suite.ui.commons.LoadState.Loaded);},logError:function(e){this.getVariable("tile").setState(sap.suite.ui.commons.LoadState.Failed);this.getVariable("indicatorUtils").logError(e,this.getVariable("tile"));},onVisible:function(i){if(!this.getVariable("hasAppeared")){if(Number(this.getVariable("chip").configuration.getParameterValueAsString("isSufficient"))){this.onEvalFiltersFetched();}else{this.fetchEvalFilters(this.onEvalFiltersFetched);}}},onExit:function(){this.abortAllOpenODataRequests();}});}());
},
	"sap/ushell/components/tiles/indicatorHarveyBall/HarveyBallTile.view.js":function(){(function(){"use strict";jQuery.sap.require("sap.ushell.components.tiles.indicatorTileUtils.smartBusinessUtil");jQuery.sap.require("sap.ui.model.analytics.odata4analytics");jQuery.sap.require("sap.ca.ui.model.format.NumberFormat");sap.ui.getCore().loadLibrary("sap.suite.ui.commons");sap.ui.jsview("tiles.indicatorHarveyBall.HarveyBallTile",{getControllerName:function(){},createContent:function(c){var m=new sap.suite.ui.commons.HarveyBallMicroChart({total:"{/value}",size:"{/size}",totalLabel:"{/totalLabel}",items:[new sap.suite.ui.commons.HarveyBallMicroChartItem({fraction:"{/fractionValue}",fractionLabel:"{/fractionLabel}",color:"{/color}"})]});var t=new sap.suite.ui.commons.TileContent({size:"{/size}",content:m});this.oTile=new sap.suite.ui.commons.GenericTile({subheader:"{/subheader}",frameType:"{/frameType}",size:"{/size}",header:"{/header}",tileContent:[t]});}});}());
},
	"sap/ushell/components/tiles/indicatorTileUtils/indicatorTileHelper.js":function(){(function(){"use strict";jQuery.sap.declare("sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper");sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper=function(t){this.tile=t;};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setErrorState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Failed);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setLoadingState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Loading);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setLoadedState=function(){this.getTile().setState(sap.suite.ui.commons.LoadState.Loaded);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendDown=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.Down);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendUp=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.Up);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTrendNeutral=function(){this.getTile().setIndicator(sap.suite.ui.commons.DeviationIndicator.None);};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdGood=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdBad=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdCritical=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setThresholdNeutral=function(){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.calculateThreshold=function(a,v,i){};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.setTile=function(t){this.tile=t;};sap.ushell.components.tiles.indicatorTileUtils.indicatorTileHelper.prototype.getTile=function(){return this.tile;};}());
},
	"sap/ushell/components/tiles/sbtilecontent.js":function(){jQuery.sap.declare("sap.ushell.components.tiles.sbtilecontent");sap.ui.define(["sap/m/TileContent","sap/m/TileContentRenderer","sap/ui/core/Control"],function(T,R,C){"use strict";var t=C.extend("numeric.TileContent_Timestamp",{ontap:function(e){if(this.getParent().getRefreshOption()){e.preventDefault();e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation();}this.getParent().fireRefresh();}},renderer:function(r,c){r.write("<div");r.writeElementData(c);r.addClass("sapMTileCntFtrTxt");if(c.getParent().getRefreshOption()){r.addClass("sapMLnk");}r.writeClasses();r.addStyle("position","absolute");r.addStyle("z-index","2");r.addStyle(r.getConfiguration().getRTL()?"left":"right","auto");r.writeStyles();r.write(">");var a=c.getParent().getTimestamp();if(a){if(!c.getParent().getRefreshOption()){r.writeEscaped(a);}else if(r.getConfiguration().getRTL()){r.writeEscaped(a+"\u2009");r.writeIcon("sap-icon://refresh","sapMCmpTileUnitInner");}else{r.writeIcon("sap-icon://refresh","sapMCmpTileUnitInner");r.writeEscaped("\u2009"+a);}}r.write("</div>");}});return T.extend("sap.ushell.components.tiles.sbtilecontent",{metadata:{properties:{timestamp:{type:"string"},refreshOption:{type:"boolean"}},events:{refresh:{}}},init:function(){this.addDependent(this._oTimestamp=new t());},getAltText:function(){var a=T.prototype.getAltText.apply(this,arguments);if(this.getTimestamp()){a+=(a===""?"":"\n")+this.getTimestamp();}return a;},renderer:{_renderFooter:function(r,c){R._renderFooter.apply(this,arguments);r.renderControl(c._oTimestamp);}}});},true);
},
/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
	"sap/ca/ui/model/format/FormatHelper.js":function(){jQuery.sap.declare("sap.ca.ui.model.format.FormatHelper");jQuery.sap.require("sap.ui.core.format.NumberFormat");jQuery.sap.require("sap.ui.core.LocaleData");sap.ui.base.Object.extend("sap.ca.ui.model.format.FormatHelper",{});
sap.ca.ui.model.format.FormatHelper.stringToNumeric=function(s){var h=/^\s*[\+-]?0[xX]/;if(h.test(s)){return parseInt(s,16);}else{return parseFloat(s);}};
sap.ca.ui.model.format.FormatHelper.toNumeric=function(o){if((o===null)||(o===undefined)){return NaN;}var t=typeof o;var r;switch(t){case"number":r=o;break;case"string":r=sap.ca.ui.model.format.FormatHelper.stringToNumeric(o);break;case"object":var v=o.valueOf();if(typeof v==="number"){r=v;}else if(Array.isArray(o)){r=NaN;}else{r=sap.ca.ui.model.format.FormatHelper.stringToNumeric(o.toString());}break;default:r=NaN;break;}return r;};
sap.ca.ui.model.format.FormatHelper.isNumeric=function(o){return isFinite(sap.ca.ui.model.format.FormatHelper.toNumeric(o));};
sap.ca.ui.model.format.FormatHelper.getFormatOptions=function(o,l){var f={};f.locale=l;var t=typeof o;switch(t){case"number":f.decimals=o;break;case"object":if(typeof o.locale==="string"){f.locale=new sap.ui.core.Locale(o.locale);}else if(o.locale){f.locale=o.locale;}f.decimals=o.decimals;f.rounding=o.rounding;f.formatStyle=o.formatStyle;f.shortDecimals=o.shortDecimals;f.shortRounding=o.shortRounding;break;}if(!f.locale){if(sap.ui.getCore().getConfiguration().getLanguage()=="ZH"){f.locale=new sap.ui.core.Locale("zh_CN");}else{f.locale=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();}}return f;};
sap.ca.ui.model.format.FormatHelper.hasRounding=function(o){var r;if(o!==undefined){if(typeof o==="number"){r=true;}else{if(o.formatStyle==="short"){r=(o.shortDecimals!==undefined)||(o.shortRounding!==undefined);}else{r=(o.decimals!==undefined)||(o.rounding!==undefined);}}}else{r=false;}return r;};
sap.ca.ui.model.format.FormatHelper.roundNumber=function(n,o){o=o||{};var r;var R,d;if(o.formatStyle==="short"){R=o.shortRounding;d=o.shortDecimals;}else{R=o.rounding;d=o.decimals;}if(R){r=R(n);}else if(d!==undefined){var a=sap.ca.ui.model.format.FormatHelper._getDecimals(d,n);r=n.toFixed(a);}else{r=n;}return r;};
sap.ca.ui.model.format.FormatHelper._getDecimals=function(d,n){var a;if(typeof d==="function"){a=d(n);}else{a=d;}return a;};
sap.ca.ui.model.format.FormatHelper._getUi5DecimalsFormatOptions=function(f,n,a){var u={};var d=null;if(f.formatStyle==="short"){d=f.shortDecimals;}else if(f.decimals||f.decimals===0){d=f.decimals;}if(d!==null){var D=sap.ca.ui.model.format.FormatHelper._getDecimals(d,n);u.minFractionDigits=D;u.maxFractionDigits=D;}else if(typeof a==="string"){var b=a.indexOf(".");var i=(b>-1)?Math.max(a.length-b-1,0):0;u.minFractionDigits=i;u.maxFractionDigits=i;}return u;};
sap.ca.ui.model.format.FormatHelper.formatNumber=function(n,o){var a=sap.ca.ui.model.format.FormatHelper.toNumeric(n);if(!isFinite(a)){return"";}var f=sap.ca.ui.model.format.FormatHelper.getFormatOptions(o);var u=sap.ca.ui.model.format.FormatHelper._getUi5DecimalsFormatOptions(f,a,n);var b=sap.ui.core.format.NumberFormat.getFloatInstance(u,f.locale);if(sap.ca.ui.model.format.FormatHelper.hasRounding(o)){a=sap.ca.ui.model.format.FormatHelper.roundNumber(a,f);return b.format(a);}else{return b.format(n);}};
sap.ca.ui.model.format.FormatHelper.getMagnitude=function(n){var _=[{value:1e3,suffix:"Kilo"},{value:1e6,suffix:"Mega"},{value:1e9,suffix:"Giga"},{value:1e12,suffix:"Tera"},{value:1e15,suffix:"Peta"},{value:1e18,suffix:"Exa"},{value:1e21,suffix:"Zetta"},{value:1e24,suffix:"Yotta"}];var a=(n>=0?n:-n);for(var i=_.length-1;i>=0;--i){var m=_[i];if(a>=m.value){return m;}}return{value:1,suffix:""};};
},
	"sap/ca/ui/model/format/NumberFormat.js":function(){jQuery.sap.declare("sap.ca.ui.model.format.NumberFormat");jQuery.sap.require("sap.ui.core.LocaleData");jQuery.sap.require("sap.ca.ui.model.format.FormatHelper");jQuery.sap.require("sap.ca.ui.utils.resourcebundle");
sap.ca.ui.model.format.NumberFormat=function(){throw new Error();};
sap.ca.ui.model.format.NumberFormat.oValueInfo={oDefaultFormatOptions:{style:"standard"}};
sap.ca.ui.model.format.NumberFormat.getInstance=function(f,l){return this.createInstance(f,l,this.oValueInfo);};
sap.ca.ui.model.format.NumberFormat.createInstance=function(f,l,i){var F=jQuery.sap.newObject(this.prototype);if(f instanceof sap.ui.core.Locale){l=f;f=undefined;}if(!l){l=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();}F.oLocale=l;F.oLocaleData=sap.ui.core.LocaleData.getInstance(l);F.oFormatOptions=jQuery.extend(false,{},i.oDefaultFormatOptions,f);F.oFormatOptions.formatStyle="standard";F.init();return F;};
sap.ca.ui.model.format.NumberFormat.prototype.init=function(){};
sap.ca.ui.model.format.NumberFormat.prototype.format=function(v){var r="";var f="format_"+this.oFormatOptions.style;if(this[f]){r=this[f](v);}else{r=this.format_standard(v);}return r;};
sap.ca.ui.model.format.NumberFormat.prototype.format_standard=function(v){var f=sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions,this.oLocale);return sap.ca.ui.model.format.FormatHelper.formatNumber(v,f);};
sap.ca.ui.model.format.NumberFormat.prototype.format_short=function(v){var f;var s;var a;function g(d){var a;if(!s){s=sap.ui.core.LocaleData.getInstance(f.locale)._get("decimalFormat-short");if(!s){var e=new sap.ui.core.Locale("en");s=sap.ui.core.LocaleData.getInstance(e)._get("decimalFormat-short");}}if(s){var k=1;while(Math.abs(d)>=(k*10)&&k<1e14){k=k*10;}var h=s[k.toString()+"-other"];a={};if(!h||h=="0"){a.magnitude=1;}else{a.formatString=h;var m=h.match(/0+\.*0*/);if(m){a.valueSubString=m[0];var i=a.valueSubString.indexOf(".");if(i==-1){a.decimals=0;a.magnitude=k*Math.pow(10,1-a.valueSubString.length);}else{a.decimals=a.valueSubString.length-i-1;a.magnitude=k*Math.pow(10,1-i);}}else{a.magnitude=1;}}}return a;}var n=sap.ca.ui.model.format.FormatHelper.toNumeric(v);if(!isFinite(n)){return"";}var r="";f=sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions,this.oLocale);a=g(n);if(!a){return this.format_standard(v);}var b=n/a.magnitude;var c={};c.shortRounding=f.shortRounding;c.rounding=f.rounding;if(a.magnitude==1){c.formatStyle="standard";c.decimals=f.decimals;}else if(f.shortDecimals){c.formatStyle="short";c.shortDecimals=f.shortDecimals;}else{c.formatStyle="short";c.shortDecimals=a.decimals;}b=sap.ca.ui.model.format.FormatHelper.roundNumber(b,c);a=g(b*a.magnitude);if(!a||a.magnitude==1){r=this.format_standard(v);}else{b=sap.ca.ui.model.format.FormatHelper.roundNumber(n/a.magnitude,c);if(!f.shortDecimals){f.shortDecimals=a.decimals;}f.formatStyle="short";r=sap.ca.ui.model.format.FormatHelper.formatNumber(b,f);r=a.formatString.replace(a.valueSubString,r);r=r.replace(/'.'/g,".");}return r;};
sap.ca.ui.model.format.NumberFormat.prototype.parse=function(v){var f=sap.ui.core.format.NumberFormat.getInstance(this.oFormatOptions,this.oLocale);if(f.oFormatOptions.groupingSeparator=="\u00a0"){v=v.replace(/ /g,f.oFormatOptions.groupingSeparator);}return f.parse(v);};
sap.ca.ui.model.format.NumberFormat.prototype.format_percentage=function(v){var r,s;if(this.oFormatOptions.decimals===undefined){this.oFormatOptions.decimals=0;}var n=sap.ca.ui.model.format.FormatHelper.toNumeric(v);n=n*100.0;var f=this.format_standard(n);var p=sap.ui.core.LocaleData.getInstance(this.oLocale)._get("percentFormat");if(!p){s=new sap.ui.core.Locale("en");p=sap.ui.core.LocaleData.getInstance(s)._get("percentFormat");}var a=p["standard"];if(a===undefined||a==""){r=f;jQuery.sap.log.error("no percent format available for the current locale");}else{var b=/[\.0,#]+/;var t=a.replace(b,f);var c=sap.ui.core.LocaleData.getInstance(this.oLocale)._get("symbols-latn-percentSign");if(!c){s=new sap.ui.core.Locale("en");c=sap.ui.core.LocaleData.getInstance(s)._get("symbols-latn-percentSign");}r=t.replace(/\u0025/,c);}return r;};
},
	"sap/ca/ui/utils/resourcebundle.js":function(){jQuery.sap.declare("sap.ca.ui.utils.resourcebundle");jQuery.sap.require("sap.ui.model.resource.ResourceModel");sap.ca.ui.utils.resourcebundle=(function(){var i=new sap.ui.model.resource.ResourceModel({bundleUrl:jQuery.sap.getModulePath("sap.ca.ui.i18n.i18n",".properties"),});sap.ui.getCore().setModel(i,"sap.ca.ui.i18n");return i.getResourceBundle();}());
}
},"sap/fiori/indicator-tiles"
);
//# sourceMappingURL=indicator-tiles.js.map